import{b as dc}from"./chunk-DMPMDD2A.js";import{yg as gc}from"./chunk-ESE62B67.js";import{a as xc,b as Ks}from"./chunk-SOYPA3PZ.js";import{a as pc,b as mc,c as js}from"./chunk-XIRLSLUI.js";import{a as Us,b as Gs}from"./chunk-5QDLLTGU.js";import{f as Ys}from"./chunk-ZIWCRGVR.js";import{b as Ul,e as Gl,k as oc,m as lc,p as cc,q as hc,r as uc,s as fc}from"./chunk-4EIXSAPM.js";import{i as ln}from"./chunk-E2A6ZCMF.js";import{a as vi,b as Ur}from"./chunk-YETWNNB4.js";import{Aa as _i,Ba as yi,E as qn,Ea as on,F as Wl,Fa as ti,Ha as ri,I as Za,J as Ws,Ja as ii,Ka as to,L as Vi,Ma as ro,P as Qa,Q as Ja,Ra as sc,S as $l,Sa as ac,T as sn,_ as $s,b as qa,ba as Cr,c as Hl,ca as Nt,fa as xi,h as Ns,ha as zr,i as Vl,ia as zl,j as Bs,ja as eo,k as Hs,m as Vs,ma as Xl,na as an,p as Kn,pa as jl,q as Hi,qa as Yl,r as wr,ra as Kl,sa as zs,va as ur,wa as ql,za as Zl}from"./chunk-IDZOVNAK.js";import{c as Ql,f as Jl,g as ec,h as Xs,j as tc,k as rc,n as ic,v as wi,w as nc}from"./chunk-RSWLFW5Q.js";import{l as Ls,m as Rs,p as nn}from"./chunk-AR7LHXST.js";import{Aa as Fs,Ab as nt,Bb as tt,C as Fl,Ca as Ml,Cb as Ie,Da as S,Db as Fe,Fc as Ps,Gb as Jt,Gc as Rl,Ha as Li,Hb as ct,Hc as gi,Ia as We,Ib as Xa,Ic as Rt,Jb as kt,Kb as Te,Lb as ce,Mb as Ne,Mc as Bi,Nb as rt,Nc as Jr,O as ks,Oa as Oe,Ob as ja,Oc as Nl,P as zn,Pa as Mr,Qa as Un,Qb as As,Qc as Bl,R as Ol,Ra as Pr,Rb as Ds,S as Al,Sb as Ms,T as Is,Ta as he,U as ar,Uc as Be,V as Or,Va as ye,Vb as or,Wa as Gn,Wb as vr,X as Dl,Xb as lr,Yb as _r,Yc as ei,Z as Et,a as El,bb as Ae,c as $n,ca as J,da as ee,db as gt,dc as yr,ea as Pi,eb as xt,ec as Yn,f as tn,fb as Ga,fc as mi,g as za,gb as Pl,h as Es,hb as Ri,hc as cr,i as kl,ia as Ua,ib as Ni,jb as M,jc as Ll,kb as U,la as Wr,lb as X,lc as rn,mb as xe,mc as Ya,nb as ke,oa as Ar,ob as Me,oc as Ka,pa as Dr,pb as Qr,pc as er,qb as qt,ra as Zr,rb as Zt,sb as zt,sc as $r,tb as Se,ub as Os,uc as Ue,vb as Ce,vc as hr,w as Il,wb as Qt,xb as E,yb as Xn,za as pi,zb as jn}from"./chunk-53IN4TFO.js";import{a as T,b as B,g as Tt}from"./chunk-GAL4ENT6.js";var tr=class{constructor(){this.widget={id:"",x:0,y:0,cols:1,rows:1,position:{x:0,y:0,cols:1,rows:1},config:{options:{}}}}setId(t){return this.widget.id=t,this}setPosition(t){return this.widget.position=t,this}setComponent(t){return this.widget.config.component=t,this}setInitialState(t){return this.widget.config.initialState=t,this}setState(t){return this.widget.config.state=t,this}setHeader(t,e){return this.widget.config.header={title:t,options:e},this}setSize(t){return this.widget.config.size=t,this}setEChartsOptions(t){return this.widget.config.options=t,this}setFilterOptions(t){return this.widget.config.options=t,this}setTileOptions(t){return this.widget.config.options=t,this}setMarkdownCellOptions(t){return this.widget.config.options=t,this}setCodeCellOptions(t){return this.widget.config.options=t,this}setTableOptions(t){return this.widget.config.options=t,this}setEvents(t){return console.log("\u{1F525} WidgetBuilder.setEvents called with callback:",!!t),this.widget.config.events={onChartOptions:t},console.log("\u{1F525} Event handler stored in widget config:",!!this.widget.config.events),this}setEventChartOptions(t){return this.widget.config.events={onChartOptions:t},this}setSeries(t){return this.widget.series=t,this}setData(t){return this.widget.data=t,this}setChartInstance(t){return this.widget.chartInstance=t,this}setHeightFromGridster(t=30,e=10){let i=this.widget.position?.rows||this.widget.rows||1,n=50,s=Math.max(i*n,i*t+(i-1)*e);return this.widget.height=s,console.log("\u{1F527} Widget height calculation:",{rows:i,cellHeight:t,margin:e,minHeightPerRow:n,calculatedHeight:this.widget.height,position:this.widget.position}),this}setEChartsTitle(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.title=t,this}setEChartsGrid(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.grid=t,this}setEChartsTooltip(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.tooltip=t,this}setEChartsLegend(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.legend=t,this}setEChartsXAxis(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.xAxis=t,this}setEChartsYAxis(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.yAxis=t,this}setEChartsSeries(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.series=t,this}build(){return this.widget}static setData(t,e){if(t.data=e,t.config.options&&"series"in t.config.options){let i=t.config.options;i.series&&Array.isArray(i.series)&&i.series.forEach(n=>{n&&typeof n=="object"&&"data"in n&&(n.data=e)}),t.chartInstance&&t.chartInstance.setOption(i)}if(t.config.component==="table"&&t.config.options){let i=t.config.options;i.data&&(i.data=e)}if(t.config.component==="tile"&&t.config.options){let i=t.config.options;e&&typeof e=="object"&&Object.assign(i,e)}}static exportTableData(t){let e=t.config?.options;return!e?.data||!e?.columns?[]:e.data.map(i=>e.columns.map(n=>i[n]||""))}static getTableExportHeaders(t){return t.config?.options?.columns||[]}static getTableExportSheetName(t){return`${(t.config?.header?.title||"Table").replace(/[^\w\s]/gi,"").substring(0,20)} (Table)`}static exportTileData(t){let e=t.config?.options;return e?[[t.config?.header?.title||"Metric",e.value||"",e.change||"",e.changeType||"neutral",e.description||""]]:[]}static getTileExportHeaders(t){return["Metric","Value","Change","Change Type","Description"]}static getTileExportSheetName(t){return`${(t.config?.header?.title||"Tile").replace(/[^\w\s]/gi,"").substring(0,20)} (Tile)`}};var It=[];for(let r=0;r<256;++r)It.push((r+256).toString(16).slice(1));function vc(r,t=0){return(It[r[t+0]]+It[r[t+1]]+It[r[t+2]]+It[r[t+3]]+"-"+It[r[t+4]]+It[r[t+5]]+"-"+It[r[t+6]]+It[r[t+7]]+"-"+It[r[t+8]]+It[r[t+9]]+"-"+It[r[t+10]]+It[r[t+11]]+It[r[t+12]]+It[r[t+13]]+It[r[t+14]]+It[r[t+15]]).toLowerCase()}var io,Bu=new Uint8Array(16);function no(){if(!io){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");io=crypto.getRandomValues.bind(crypto)}return io(Bu)}var Hu=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),so={randomUUID:Hu};function Vu(r,t,e){if(so.randomUUID&&!t&&!r)return so.randomUUID();r=r||{};let i=r.random??r.rng?.()??no();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){if(e=e||0,e<0||e+16>t.length)throw new RangeError(`UUID byte range ${e}:${e+15} is out of buffer bounds`);for(let n=0;n<16;++n)t[e+n]=i[n];return t}return vc(i)}var cn=Vu;var ve=class{constructor(){this.data=[],this.customFilters=new Map,this.widgetBuilder=new tr().setId(cn()).setComponent("echart"),this.chartOptions=this.getDefaultOptions()}static exportData(t){throw new Error("exportData must be implemented by subclass")}static getExportHeaders(t){throw new Error("getExportHeaders must be implemented by subclass")}static getExportSheetName(t){throw new Error("getExportSheetName must be implemented by subclass")}setData(t){return this.data=Array.isArray(t)?t:[t],this.widgetBuilder.setData(t),this}setId(t){return this.widgetBuilder.setId(t),this}setConfig(t){let e=this.widgetBuilder.build();return e.config=e.config||{},Object.assign(e.config,t),this}setSkipDefaultFiltering(t){let e=this.widgetBuilder.build();return e.config=e.config||{},e.config.skipDefaultFiltering=t,this}setFilterChangeCallback(t){return this.filterChangeCallback=t,this}addCustomFilter(t,e){return this.customFilters.set(t,e),this}removeCustomFilter(t){return this.customFilters.delete(t),this}getCustomFilter(t){return this.customFilters.get(t)}triggerFilterChange(t){console.log("Filter change event triggered:",t),this.filterChangeCallback?this.filterChangeCallback(t):console.warn("Filter change callback not set"),typeof window<"u"&&window.handleChartFilterChange&&window.handleChartFilterChange(t)}createGlobalFilterFunction(){typeof window<"u"&&!window.handleChartFilterChange&&(window.handleChartFilterChange=t=>{console.log("Global chart filter change:",t),this.filterChangeCallback&&this.filterChangeCallback(t)})}setLabelFormatter(t){return this.seriesOptions.label||(this.seriesOptions.label={}),this.seriesOptions.label.formatter=t,this}setLabelShow(t){return this.seriesOptions.label||(this.seriesOptions.label={}),this.seriesOptions.label.show=t,this}setLabelPosition(t){return this.seriesOptions.label||(this.seriesOptions.label={}),this.seriesOptions.label.position=t,this}setColors(t){return this.getChartType()==="pie"?this.seriesOptions.color=t:(this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.color=t),this}setBorderRadius(t){return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.borderRadius=t,this}setBorder(t,e=1){return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.borderColor=t,this.seriesOptions.itemStyle.borderWidth=e,this}setEmphasis(t=10,e=0,i="rgba(0, 0, 0, 0.5)"){return this.seriesOptions.emphasis={itemStyle:{shadowBlur:t,shadowOffsetX:e,shadowColor:i}},this}setTitle(t,e){return this.chartOptions.title={text:t,subtext:e,left:"center",top:"10",textStyle:{fontSize:16,color:"#333"}},this}setTitleOptions(t){return this.chartOptions.title=T(T({},this.chartOptions.title),t),this}setTooltip(t,e){return this.chartOptions.tooltip=B(T({},this.chartOptions.tooltip),{trigger:t,formatter:e||"{b}: {c}"}),this}setTooltipOptions(t){return this.chartOptions.tooltip=T(T({},this.chartOptions.tooltip),t),this}setLegend(t="vertical",e="left"){return this.chartOptions.legend={show:!0,orient:t,left:e==="left"?"left":e==="right"?"right":"center",top:t==="horizontal"?"bottom":"middle",bottom:t==="horizontal"?"10":void 0},this}setLegendOptions(t){return this.chartOptions.legend=T(T({},this.chartOptions.legend),t),this}setShowLegend(t){return this.chartOptions.legend||(this.chartOptions.legend={}),this.chartOptions.legend.show=t,this}setGrid(t){return this.chartOptions.grid=T(T({},this.chartOptions.grid),t),this}setXAxis(t){return this.chartOptions.xAxis=t,this}setYAxis(t){return this.chartOptions.yAxis=t,this}setSeries(t){return this.chartOptions.series=t,this}addSeries(t){return this.chartOptions.series||(this.chartOptions.series=[]),this.chartOptions.series.push(t),this}setAnimation(t){return this.chartOptions.animation=t,this}setBackgroundColor(t){return this.chartOptions.backgroundColor=t,this}setHeader(t,e){return this.widgetBuilder.setHeader(t,e),this}setPosition(t){return this.widgetBuilder.setPosition(t),this}setCustomOptions(t){return this.widgetBuilder.setEChartsOptions(t),this}setEvents(t){return this.widgetBuilder.setEvents(t),this}setClickEvent(t){return this.widgetBuilder.setEvents((e,i)=>{i&&(i.off("click"),i.on("click",n=>{t(n,e,i)}))}),this}setDoubleClickEvent(t){return this.widgetBuilder.setEvents((e,i)=>{i&&(i.off("dblclick"),i.on("dblclick",n=>{t(n,e,i)}))}),this}setMouseDownEvent(t){return this.widgetBuilder.setEvents((e,i)=>{i&&(i.off("mousedown"),i.on("mousedown",n=>{t(n,e,i)}))}),this}setMouseUpEvent(t){return this.widgetBuilder.setEvents((e,i)=>{i&&(i.off("mouseup"),i.on("mouseup",n=>{t(n,e,i)}))}),this}setMouseOverEvent(t){return this.widgetBuilder.setEvents((e,i)=>{i&&(i.off("mouseover"),i.on("mouseover",n=>{t(n,e,i)}))}),this}setMouseOutEvent(t){return this.widgetBuilder.setEvents((e,i)=>{i&&(i.off("mouseout"),i.on("mouseout",n=>{t(n,e,i)}))}),this}setMultipleEvents(t){return this.widgetBuilder.setEvents((e,i)=>{i&&(i.off("click"),i.off("dblclick"),i.off("mousedown"),i.off("mouseup"),i.off("mouseover"),i.off("mouseout"),t.click&&i.on("click",n=>t.click(n,e,i)),t.dblclick&&i.on("dblclick",n=>t.dblclick(n,e,i)),t.mousedown&&i.on("mousedown",n=>t.mousedown(n,e,i)),t.mouseup&&i.on("mouseup",n=>t.mouseup(n,e,i)),t.mouseover&&i.on("mouseover",n=>t.mouseover(n,e,i)),t.mouseout&&i.on("mouseout",n=>t.mouseout(n,e,i)))}),this}setStockNavigationEvents(t,e="symbol",i="dblclick"){let n=(s,a,o)=>{if(console.log(`Stock ${i} event:`,s),s.componentType==="series"&&s.data){let c=s.data[e]||s.data[0];c&&(console.log(`Stock ${i}ed:`,c),t(c))}};switch(i){case"click":this.setClickEvent(n);break;case"dblclick":this.setDoubleClickEvent(n);break;case"mousedown":this.setMouseDownEvent(n);break}return this}setChartInstance(t){return this.widgetBuilder.setChartInstance(t),this}setHeightFromGridster(t=30,e=10){return this.widgetBuilder.setHeightFromGridster(t,e),this}build(){return this.widgetBuilder.setEChartsOptions(this.chartOptions).build()}getChartOptions(){return T({},this.chartOptions)}getWidgetBuilder(){return this.widgetBuilder}static updateData(t,e,i){if(tr.setData(t,e),t.chartInstance)try{t.chartInstance.setOption(t.config?.options,!0)}catch(n){console.error("Error updating chart:",n)}else this.retryChartUpdate(t,i)}static retryChartUpdate(t,e){let i=e?.maxAttempts||10,n=e?.baseDelay||100,s=0,a=()=>{if(s++,t.chartInstance)try{t.chartInstance.setOption(t.config?.options,!0);return}catch(o){console.error("Error updating chart on retry:",o)}if(s<i){let o=Math.min(n*Math.pow(1.5,s-1),2e3);setTimeout(a,o)}};setTimeout(a,n)}static isChartType(t,e){return t.config.component==="echart"&&t.config.options?.series?.[0]?.type===e}static getChartType(t){return t.config.component==="echart"&&t.config.options?.series?.[0]?.type?t.config.options.series[0].type:null}static transformData(t,e){return t}static applyFilters(t,e){return!e||e.length===0?t:t.filter(i=>e.every(n=>{let s=n.column||n.property;if(!s)return!0;let a=this.getNestedProperty(i,s);return this.matchesFilter(a,n)}))}static getNestedProperty(t,e){return e.split(".").reduce((i,n)=>i?.[n],t)}static matchesFilter(t,e){switch(e.operator){case"equals":return t===e.value;case"contains":return String(t).toLowerCase().includes(String(e.value).toLowerCase());case"greaterThan":return Number(t)>Number(e.value);case"lessThan":return Number(t)<Number(e.value);case"greaterThanOrEqual":return Number(t)>=Number(e.value);case"lessThanOrEqual":return Number(t)<=Number(e.value);case"in":return Array.isArray(e.value)&&e.value.includes(t);default:return!0}}static generateSampleData(t,e){return t.map(i=>{let n=T({},i);return e?.randomizeNumericFields&&Object.keys(n).forEach(s=>{if(typeof n[s]=="number"){let a=(Math.random()-.5)*2*(e.variationPercentage||.2);n[s]=Math.max(0,n[s]*(1+a))}}),n})}setCurrencyFormatter(t="USD",e="en-US"){let i=n=>new Intl.NumberFormat(e,{style:"currency",currency:t}).format(n);return this.setTooltip(this.chartOptions.tooltip?.trigger||"item",n=>Array.isArray(n)?n.map(s=>`${s.seriesName}<br/>${s.name}: ${i(s.value)}`).join("<br/>"):`${n.name}: ${i(n.value)}`),this}setPercentageFormatter(t=1){let e=i=>`${i.toFixed(t)}%`;return this.setTooltip(this.chartOptions.tooltip?.trigger||"item",i=>Array.isArray(i)?i.map(n=>`${n.seriesName}<br/>${n.name}: ${e(n.value)}`).join("<br/>"):`${i.name}: ${e(i.value)}`),this}setNumberFormatter(t="en-US",e){let i=n=>new Intl.NumberFormat(t,e).format(n);return this.setTooltip(this.chartOptions.tooltip?.trigger||"item",n=>Array.isArray(n)?n.map(s=>`${s.seriesName}<br/>${s.name}: ${i(s.value)}`).join("<br/>"):`${n.name}: ${i(n.value)}`),this}setFilterColumn(t,e=br.Value){let i=this.widgetBuilder.build();return i.config&&(i.config.filterColumn=t,i.config.filterBy=e),this}static createFilterFromChartData(t,e,i=br.Value){if(!t||!e)return null;let n,s;return i===br.Category?(n=e,s=e):(n=t.name||t.value,s=t.name||String(t.value)),{property:e,operator:"equals",value:n,displayValue:s}}setAccessor(t){let e=this.widgetBuilder.build();return e.config&&(e.config.accessor=t),this}static createGlobalFilterFromChartData(t,e,i=br.Value){if(!t||!e)return null;let n,s;if(i===br.Category)n=e,s=e;else if(n=t.name||t.value,s=String(n),!n)return null;return{accessor:e,operator:"equals",value:n,displayValue:s,[e]:n}}setGradientColors(t,e,i="vertical"){let n={type:"linear",x:0,y:i==="vertical"?0:1,x2:i==="vertical"?0:1,y2:i==="vertical"?1:0,colorStops:[{offset:0,color:t},{offset:1,color:e}]};return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.color=n,this}setPredefinedPalette(t){let e={business:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],finance:["#2E8B57","#4682B4","#DAA520","#DC143C","#9370DB","#20B2AA","#FF6347","#4169E1","#32CD32"],modern:["#667eea","#764ba2","#f093fb","#f5576c","#4facfe","#00f2fe","#43e97b","#38f9d7","#ffecd2"],pastel:["#FFB6C1","#87CEEB","#98FB98","#F0E68C","#DDA0DD","#F5DEB3","#FFE4E1","#E0FFFF","#FAFAD2"],dark:["#2c3e50","#34495e","#7f8c8d","#95a5a6","#bdc3c7","#ecf0f1","#f39c12","#e67e22","#e74c3c"]};return this.setColors(e[t]||e.business)}getPaletteColors(t){let e={business:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],finance:["#2E8B57","#4682B4","#DAA520","#DC143C","#9370DB","#20B2AA","#FF6347","#4169E1","#32CD32"],modern:["#667eea","#764ba2","#f093fb","#f5576c","#4facfe","#00f2fe","#43e97b","#38f9d7","#ffecd2"],pastel:["#FFB6C1","#87CEEB","#98FB98","#F0E68C","#DDA0DD","#F5DEB3","#FFE4E1","#E0FFFF","#FAFAD2"],dark:["#2c3e50","#34495e","#7f8c8d","#95a5a6","#bdc3c7","#ecf0f1","#f39c12","#e67e22","#e74c3c"]};return e[t]||e.business}createCurrencyFormatter(t="USD",e="en-US"){return i=>new Intl.NumberFormat(e,{style:"currency",currency:t}).format(i)}createPercentageFormatter(t=1){return e=>`${e.toFixed(t)}%`}createNumberFormatter(t=0,e="en-US"){return i=>new Intl.NumberFormat(e,{minimumFractionDigits:t,maximumFractionDigits:t}).format(i)}setValueFormatter(t){return this.setTooltip(this.chartOptions.tooltip?.trigger||"item",e=>Array.isArray(e)?e.map(i=>`${i.seriesName}<br/>${i.name}: ${t(i.value)}`).join("<br/>"):`${e.name}: ${t(e.value)}`),this}},br=function(r){return r.Value="value",r.Category="category",r}(br||{});var hn=class r extends ve{constructor(){super(),this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"5%",right:"5%",bottom:"15%",height:"70%"},tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{show:!0,orient:"vertical",left:"left",top:"middle"}}}getChartType(){return"pie"}getDefaultSeriesOptions(){return{name:"Pie Chart",type:"pie",radius:["30%","60%"],center:["50%","50%"],itemStyle:{borderRadius:2},label:{formatter:`{b}
{c}%
({d})%`,show:!0},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setRadius(t){return this.seriesOptions.radius=t,this}setCenter(t){return this.seriesOptions.center=t,this}setShowLegend(t){return this.chartOptions.legend||(this.chartOptions.legend={}),this.chartOptions.legend.show=t,this}build(){let t=B(T({},this.chartOptions),{series:[B(T({},this.seriesOptions),{type:"pie"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e,i){ve.updateData(t,e,i)}static transformData(t,e){if(!t||t.length===0)return[];let i=e?.valueField||"value",n=e?.nameField||"name",s=t.map(a=>({value:Number(a[i])||0,name:String(a[n])||"Unknown"}));return e?.sortBy==="value"?s.sort((a,o)=>o.value-a.value):e?.sortBy==="name"&&s.sort((a,o)=>a.name.localeCompare(o.name)),s}static addPercentages(t){let e=t.reduce((i,n)=>i+n.value,0);return t.map(i=>B(T({},i),{percentage:e>0?i.value/e*100:0}))}static createFilterFromPieClick(t,e){return!t||!t.name?null:{accessor:e,filterColumn:e,[e]:t.name,value:t.name,percentage:t.value?.toString()||"0"}}setFilterColumn(t,e=br.Value){return this.filterColumn=t,super.setFilterColumn(t,e)}createFilterFromChartData(){if(!this.filterColumn||!this.data)return null;let t=this.filterColumn,e=[...new Set(this.data.map(i=>i[t]))];return{column:this.filterColumn,operator:"in",value:e}}setDonutStyle(t="40%",e="70%"){return this.seriesOptions.radius=[t,e],this}setPercentageLabels(t=!0,e=1){return t&&(this.seriesOptions.label=B(T({},this.seriesOptions.label),{formatter:"{b}: {c} ({d}%)"})),this}setFinancialDisplay(t="USD",e="en-US"){return this.setCurrencyFormatter(t,e),this.seriesOptions.label=B(T({},this.seriesOptions.label),{formatter:i=>{let n=new Intl.NumberFormat(e,{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0});return`${i.data.name}
${n.format(i.data.value)}
(${i.percent}%)`}}),this}static isPieChart(t){return ve.isChartType(t,"pie")}static createPieChartWidget(t){let e=r.create();t&&e.setData(t);let i=B(T({},e.chartOptions),{series:[B(T({},e.seriesOptions),{type:"pie"})]});return e.widgetBuilder.setEChartsOptions(i).setData(t||[])}static exportData(t){let e=t.config?.options?.series?.[0];return e?.data?e.data.map(i=>[i.name||"Unknown",i.value||0,r.calculatePercentage(i.value,e.data)]):(console.warn("PieChartBuilder.exportData - No series data found"),[])}static getExportHeaders(t){return["Category","Value","Percentage"]}static getExportSheetName(t){return(t.config?.header?.title||"Sheet").replace(/[^\w\s]/gi,"").substring(0,31).trim()}static calculatePercentage(t,e){let i=e.reduce((n,s)=>n+(s.value||0),0);return i===0?"0%":`${(t/i*100).toFixed(2)}%`}};var un=class r extends ve{constructor(){super(),this.categories=[],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"3%",right:"4%",bottom:"15%"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{show:!0,orient:"horizontal",top:"10"},xAxis:{type:"category",data:[]},yAxis:{type:"value"}}}getChartType(){return"bar"}getDefaultSeriesOptions(){return{name:"Bar Chart",type:"bar",itemStyle:{borderRadius:2},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",aggregateBy:n,sortBy:s,sortOrder:a="desc",limit:o}=t;try{let c=this.data.map(l=>({name:l[e]||"Unknown",value:parseFloat(l[i])||0}));if(n){let l=new Map;c.forEach(h=>{let u=h.name;l.set(u,(l.get(u)||0)+h.value)}),c=Array.from(l.entries()).map(([h,u])=>({name:h,value:u}))}s==="name"?c.sort((l,h)=>a==="asc"?l.name.localeCompare(h.name):h.name.localeCompare(l.name)):s==="value"&&c.sort((l,h)=>a==="asc"?l.value-h.value:h.value-l.value),o&&o>0&&(c=c.slice(0,o)),this.seriesOptions.data=c,this.categories.length===0&&(this.categories=c.map(l=>l.name),this.setCategories(this.categories))}catch(c){console.error("Error transforming bar chart data:",c)}return this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setCategories(t){return this.categories=t,this.chartOptions.xAxis=B(T({},this.chartOptions.xAxis),{data:t}),this}setColors(t){return this.seriesOptions.color=t,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return this.setColors(e)}setBarWidth(t){return this.seriesOptions.barWidth=t,this}setBarBorderRadius(t){return this.seriesOptions.itemStyle=B(T({},this.seriesOptions.itemStyle),{borderRadius:t}),this}setYAxisName(t){return this.chartOptions.yAxis=B(T({},this.chartOptions.yAxis),{name:t,nameLocation:"middle",nameGap:30}),this}setXAxisName(t){return this.chartOptions.xAxis=B(T({},this.chartOptions.xAxis),{name:t,nameLocation:"middle",nameGap:30}),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setValueFormatter(i),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setValueFormatter(e),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setValueFormatter(i),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=5){let e=[],i=["Q1","Q2","Q3","Q4","Q5"];for(let n=0;n<Math.min(t,i.length);n++)e.push({name:i[n],value:Math.floor(Math.random()*100)+10,category:i[n],department:["Sales","Marketing","Operations"][Math.floor(Math.random()*3)]});return this.setData(e)}setSalesRevenueConfiguration(){return this.setBarWidth("60%").setBarBorderRadius(4).setYAxisName("Revenue ($)").setXAxisName("Time Period").setPredefinedPalette("finance").setTooltip("axis","{b}: ${c}")}setPerformanceConfiguration(){return this.setBarWidth("70%").setBarBorderRadius(6).setYAxisName("Performance Score").setXAxisName("Metrics").setPredefinedPalette("business").setTooltip("axis","{b}: {c}%")}setComparisonConfiguration(){return this.setBarWidth("50%").setBarBorderRadius(2).setYAxisName("Value").setXAxisName("Categories").setPredefinedPalette("modern").setTooltip("axis","{b}: {c}")}build(){let t=B(T({},this.chartOptions),{series:[B(T({},this.seriesOptions),{type:"bar"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>({name:l.name||l.category||"Unknown",value:parseFloat(l.value)||0})));let o=t.chartInstance.getOption(),c=B(T({},o),{series:[B(T({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating bar chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isBarChart(t){return ve.isChartType(t,"bar")}static exportData(t){let e=[];if(t.echart_options?.series?.[0]?.data&&t.echart_options?.xAxis?.data){let i=t.echart_options.series[0].data,n=t.echart_options.xAxis.data;for(let s=0;s<i.length;s++){let a=i[s],o=n[s]||`Category ${s+1}`;typeof a=="object"&&a!==null?e.push(T({Category:a.name||o,Value:a.value||0},a)):e.push({Category:o,Value:a||0})}}return e}static getExportHeaders(t){return["Category","Value"]}static getExportSheetName(t){return"Bar Chart Data"}};var _c=class r extends ve{constructor(){super(),this.categories=[],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"3%",right:"4%",bottom:"15%"},tooltip:{trigger:"item",axisPointer:{type:"shadow"}},legend:{show:!0,orient:"horizontal",top:"10"},xAxis:{type:"value"},yAxis:{type:"category",data:[],axisLabel:{show:!0,interval:0,rotate:0,margin:8,fontSize:12,color:"#666"},axisTick:{show:!0,alignWithLabel:!0},axisLine:{show:!0,lineStyle:{color:"#ccc"}}}}}getChartType(){return"horizontal-bar"}getDefaultSeriesOptions(){return{name:"Horizontal Bar Chart",type:"bar",itemStyle:{borderRadius:2},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},label:{show:!0,position:"insideRight",formatter:t=>typeof t.value=="number"?t.value.toLocaleString():t.value,fontSize:12,fontWeight:"normal",color:"#fff"}}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",aggregateBy:n,sortBy:s,sortOrder:a="desc",limit:o}=t;try{let c=this.data.map(l=>({name:l[e]||"Unknown",value:parseFloat(l[i])||0}));if(n){let l=new Map;c.forEach(h=>{let u=h.name;l.set(u,(l.get(u)||0)+h.value)}),c=Array.from(l.entries()).map(([h,u])=>({name:h,value:u}))}s==="name"?c.sort((l,h)=>a==="asc"?l.name.localeCompare(h.name):h.name.localeCompare(l.name)):s==="value"&&c.sort((l,h)=>a==="asc"?l.value-h.value:h.value-l.value),o&&o>0&&(c=c.slice(0,o)),this.seriesOptions.data=c,this.categories.length===0&&(this.categories=c.map(l=>l.name),this.setCategories(this.categories))}catch(c){console.error("Error transforming horizontal bar chart data:",c)}return this}setData(t){return super.setData(t),t&&Array.isArray(t)&&t.length>0&&this.categories.length===0&&this.autoExtractCategories(t),this}autoExtractCategories(t){try{if(this.filterColumn&&t[0]&&t[0][this.filterColumn]){let i=[...new Set(t.map(n=>n[this.filterColumn]))];this.setCategories(i);return}let e=["name","category","industry","sector","product","label"];for(let i of e)if(t[0]&&t[0][i]){let n=[...new Set(t.map(s=>s[i]))];this.setCategories(n);return}this.setCategories(t.map((i,n)=>`Item ${n+1}`))}catch(e){console.error("Error auto-extracting categories for horizontal bar chart:",e)}}setCategories(t){return this.categories=t,this.chartOptions.yAxis&&(this.chartOptions.yAxis.data=t),this}setDatasetSource(t){return this.chartOptions.dataset={source:t},this}setEncode(t){return this.seriesOptions.encode=t,this}setVisualMap(t){return this.chartOptions.visualMap={orient:t.orient||"horizontal",left:t.left||"center",min:t.min||0,max:t.max||100,text:t.text||["High","Low"],dimension:t.dimension||0,inRange:{color:t.colors||["#65B581","#FFCE34","#FD665F"]}},this}setColors(t){return this.seriesOptions.itemStyle&&(this.seriesOptions.itemStyle.color=t),this}setPredefinedPalette(t){return super.setPredefinedPalette(t),this}setBarWidth(t){return this.seriesOptions.barWidth=t,this}setBarBorderRadius(t){return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.borderRadius=t,this}setXAxisName(t){return this.chartOptions.xAxis||(this.chartOptions.xAxis={}),this.chartOptions.xAxis.name=t,this.chartOptions.xAxis.nameLocation="middle",this.chartOptions.xAxis.nameGap=30,this}setYAxisName(t){return this.chartOptions.yAxis||(this.chartOptions.yAxis={}),this.chartOptions.yAxis.name=t,this.chartOptions.yAxis.nameLocation="middle",this.chartOptions.yAxis.nameGap=50,this}setCurrencyFormatter(t="USD",e="en-US"){return super.setCurrencyFormatter(t,e),this}setPercentageFormatter(t=1){return super.setPercentageFormatter(t),this}setCustomNumberFormatter(t=0,e="en-US"){return super.setNumberFormatter(e,{minimumFractionDigits:t,maximumFractionDigits:t}),this}setFilterColumn(t,e=br.Value){return this.filterColumn=t,super.setFilterColumn(t,e)}createFilterFromChartData(){if(!this.filterColumn||!this.data)return null;let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return{column:this.filterColumn,operator:"in",value:t}}generateSampleData(t=5){let e=Array.from({length:t},(i,n)=>({name:`Category ${n+1}`,value:Math.floor(Math.random()*1e3)+100}));return this.setData(e),this}setSalesRevenueConfiguration(){return this.setXAxisName("Revenue").setYAxisName("Products").setCurrencyFormatter("USD","en-US").setPredefinedPalette("finance"),this}setPerformanceConfiguration(){return this.setXAxisName("Performance Score").setYAxisName("Metrics").setPercentageFormatter(1).setPredefinedPalette("business"),this}setComparisonConfiguration(){return this.setXAxisName("Value").setYAxisName("Categories").setCustomNumberFormatter(0,"en-US").setPredefinedPalette("modern"),this}setDatasetEncodeConfiguration(){return this.setEncode({x:"amount",y:"product"}),this.setVisualMap({orient:"horizontal",left:"center",min:10,max:100,text:["High Score","Low Score"],dimension:0,colors:["#65B581","#FFCE34","#FD665F"]}),this.setXAxisName("amount"),this.chartOptions.yAxis&&delete this.chartOptions.yAxis.data,this.chartOptions.tooltip={trigger:"item",formatter:function(t){return`${t.name}: ${t.value[1]}`}},this}build(){return this.chartOptions.series||(this.chartOptions.series=[]),this.chartOptions.series=[this.seriesOptions],super.build()}static updateData(t,e){if(!t||!t.chartOptions)return;let i=(n=1)=>{try{let s=e.map(a=>({name:a.name||a.category||"Unknown",value:parseFloat(a.value||a.amount||a.count)||0}));t.chartOptions.series&&t.chartOptions.series[0]&&(t.chartOptions.series[0].data=s),t.chartOptions.yAxis&&(t.chartOptions.yAxis.data=s.map(a=>a.name)),t.chartInstance&&typeof t.chartInstance.setOption=="function"&&t.chartInstance.setOption(t.chartOptions,!0)}catch(s){console.error(`Error updating horizontal bar chart data (attempt ${n}):`,s),n<3&&setTimeout(()=>i(n+1),100*n)}};i()}static isHorizontalBarChart(t){return t?.type==="horizontal-bar"||t?.chartType==="horizontal-bar"}static exportData(t){if(!t?.chartOptions?.series?.[0]?.data)return[];let e=t.chartOptions.series[0].data;return Array.isArray(e)?e.map(i=>typeof i=="object"&&i.name&&i.value!==void 0?{Category:i.name,Value:i.value}:{Value:i}):[]}static getExportHeaders(t){return["Category","Value"]}static getExportSheetName(t){return t?.header||"Horizontal Bar Chart Data"}};var fn=class r extends ve{constructor(){super(),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"item",formatter:"{b}: ({c})"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"value",nameLocation:"middle",scale:!0,axisLabel:{color:"#666"}},yAxis:{type:"value",nameLocation:"middle",scale:!0,axisLabel:{color:"#666"}}}}getChartType(){return"scatter"}getDefaultSeriesOptions(){return{name:"Scatter Chart",type:"scatter",symbolSize:8,symbol:"circle",itemStyle:{color:"#5470c6",opacity:.8},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},large:!1,largeThreshold:2e3}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{xField:e="x",yField:i="y",nameField:n="name",sizeField:s,sortBy:a,sortOrder:o="asc",limit:c}=t;try{let l=this.data.map((h,u)=>({value:[parseFloat(h[e])||0,parseFloat(h[i])||0],name:h[n]||`Point ${u+1}`,symbolSize:s&&parseFloat(h[s])||8,originalItem:h}));a==="x"?l.sort((h,u)=>o==="asc"?h.value[0]-u.value[0]:u.value[0]-h.value[0]):a==="y"&&l.sort((h,u)=>o==="asc"?h.value[1]-u.value[1]:u.value[1]-h.value[1]),c&&c>0&&(l=l.slice(0,c)),this.seriesOptions.data=l}catch(l){console.error("Error transforming scatter chart data:",l)}return this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisName(t){return this.chartOptions.xAxis=B(T({},this.chartOptions.xAxis),{name:t}),this}setYAxisName(t){return this.chartOptions.yAxis=B(T({},this.chartOptions.yAxis),{name:t}),this}setSymbol(t,e=8){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setSymbolSizeFunction(t){return this.seriesOptions.symbolSize=t,this}setItemStyle(t,e=.8,i,n){return this.seriesOptions.itemStyle={color:t,opacity:e,borderColor:i,borderWidth:n},this}setLargeScatter(t,e=2e3){return this.seriesOptions.large=t,this.seriesOptions.largeThreshold=e,this}setProgressive(t,e=3e3){return this.seriesOptions.progressive=t,this.seriesOptions.progressiveThreshold=e,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&this.setItemStyle(e[0]),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setValueFormatter(i),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setValueFormatter(e),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setValueFormatter(i),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=20){let e=[];for(let i=0;i<t;i++)e.push({x:Math.random()*100,y:Math.random()*100,name:`Point ${i+1}`,size:Math.random()*15+5,category:["A","B","C"][Math.floor(Math.random()*3)],department:["Sales","Marketing","Operations"][Math.floor(Math.random()*3)]});return this.setData(e)}setCorrelationAnalysisConfiguration(){return this.setSymbol("circle",6).setItemStyle("#5470c6",.7).setLargeScatter(!0,1e3).setXAxisName("X Variable").setYAxisName("Y Variable").setPredefinedPalette("finance").setTooltip("item","{b}: ({c})")}setPerformanceAnalysisConfiguration(){return this.setSymbol("diamond",8).setItemStyle("#91cc75",.8).setXAxisName("Performance Score").setYAxisName("Efficiency Rating").setPredefinedPalette("business").setTooltip("item","{b}: Performance {c}")}setRiskAnalysisConfiguration(){return this.setSymbol("triangle",7).setItemStyle("#ee6666",.7).setXAxisName("Risk Level").setYAxisName("Return Potential").setPredefinedPalette("modern").setTooltip("item","Risk: {c}")}build(){let t=B(T({},this.chartOptions),{series:[B(T({},this.seriesOptions),{type:"scatter"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>({value:[parseFloat(l.x)||0,parseFloat(l.y)||0],name:l.name||"Point"})));let o=t.chartInstance.getOption(),c=B(T({},o),{series:[B(T({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating scatter chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isScatterChart(t){return ve.isChartType(t,"scatter")}static createScatterChartWidget(t){let e=r.create();return t&&e.setData(t),e.getWidgetBuilder()}static exportData(t){let e=[];return t.echart_options?.series?.[0]?.data&&t.echart_options.series[0].data.forEach((n,s)=>{n&&n.value&&Array.isArray(n.value)&&e.push({Name:n.name||`Point ${s+1}`,"X Value":n.value[0]||0,"Y Value":n.value[1]||0,"Symbol Size":n.symbolSize||8})}),e}static getExportHeaders(t){return["Name","X Value","Y Value","Symbol Size"]}static getExportSheetName(t){return"Scatter Chart Data"}};var dn=class r extends ve{constructor(){super(),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{tooltip:{trigger:"item",formatter:"{b}: {c}"}}}getChartType(){return"gauge"}getDefaultSeriesOptions(){return{name:"Gauge Chart",type:"gauge",min:0,max:100,startAngle:180,endAngle:0,radius:"75%",center:["50%","60%"],axisLine:{lineStyle:{width:30,color:[[.3,"#ff6e76"],[.7,"#fddd60"],[1,"#58d9f9"]]}},progress:{show:!0,width:8},pointer:{show:!0,length:"60%",width:8},axisTick:{show:!0,splitNumber:5,length:8,lineStyle:{width:2,color:"#999"}},splitLine:{show:!0,length:30,lineStyle:{width:4,color:"#999"}},axisLabel:{show:!0,distance:5,color:"#999",fontSize:12},title:{show:!0,offsetCenter:[0,70],color:"#464646",fontSize:14},detail:{show:!0,offsetCenter:[0,40],color:"#464646",fontSize:30,formatter:"{value}%"}}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",sortBy:n,sortOrder:s="desc",limit:a}=t;try{let o=this.data.map(c=>({value:parseFloat(c[i])||0,name:c[e]||"Gauge",originalItem:c}));n==="value"?o.sort((c,l)=>s==="asc"?c.value-l.value:l.value-c.value):n==="name"&&o.sort((c,l)=>s==="asc"?c.name.localeCompare(l.name):l.name.localeCompare(c.name)),a&&a>0&&(o=o.slice(0,a)),this.seriesOptions.data=o.length>0?[o[0]]:[]}catch(o){console.error("Error transforming gauge chart data:",o)}return this}setData(t){return this.seriesOptions.data=Array.isArray(t)?t:[t],super.setData(t),this}setRange(t,e){return this.seriesOptions.min=t,this.seriesOptions.max=e,this}setAngles(t,e){return this.seriesOptions.startAngle=t,this.seriesOptions.endAngle=e,this}setRadius(t){return this.seriesOptions.radius=t,this}setCenter(t){return this.seriesOptions.center=t,this}setAxisLine(t,e){return this.seriesOptions.axisLine={lineStyle:{width:t,color:e}},this}setProgress(t,e=8){return this.seriesOptions.progress={show:t,width:e},this}setPointer(t,e="60%",i=8){return this.seriesOptions.pointer={show:t,length:e,width:i},this}setAxisTick(t,e=5,i=8,n=2,s="#999"){return this.seriesOptions.axisTick={show:t,splitNumber:e,length:i,lineStyle:{width:n,color:s}},this}setSplitLine(t,e=30,i=4,n="#999"){return this.seriesOptions.splitLine={show:t,length:e,lineStyle:{width:i,color:n}},this}setAxisLabel(t,e=5,i="#999",n=12){return this.seriesOptions.axisLabel={show:t,distance:e,color:i,fontSize:n},this}setGaugeTitle(t,e=[0,70],i="#464646",n=14){return this.seriesOptions.title={show:t,offsetCenter:e,color:i,fontSize:n},this}setDetail(t,e=[0,40],i="#464646",n=30,s="{value}%"){return this.seriesOptions.detail={show:t,offsetCenter:e,color:i,fontSize:n,formatter:s},this}setPredefinedPalette(t){let e=this.getPaletteColors(t),i=[];for(let n=0;n<e.length&&n<3;n++)i.push([(n+1)/3,e[n]]);return i.length===0&&i.push([.3,"#ff6e76"],[.7,"#fddd60"],[1,"#58d9f9"]),this.setAxisLine(30,i),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setDetail(!0,[0,40],"#464646",30,`{value | ${i.name}}`),this}setPercentageFormatter(t=1){return this.setDetail(!0,[0,40],"#464646",30,"{value}%"),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setDetail(!0,[0,40],"#464646",30,"{value}"),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=1){let e=[];for(let i=0;i<t;i++)e.push({value:Math.floor(Math.random()*100),name:`Gauge ${i+1}`,progress:Math.floor(Math.random()*100),target:100,category:["Performance","Efficiency","Quality"][Math.floor(Math.random()*3)]});return this.setData(e)}setKPIMonitoringConfiguration(){return this.setRange(0,100).setRadius("70%").setCenter(["50%","55%"]).setProgress(!0,10).setPointer(!0,"70%",6).setPredefinedPalette("business").setDetail(!0,[0,70],"#333",24,"{value}%").setGaugeTitle(!0,[0,-30],"#666",16)}setPerformanceTrackingConfiguration(){return this.setRange(0,100).setRadius("80%").setCenter(["50%","60%"]).setProgress(!0,15).setPointer(!1).setPredefinedPalette("finance").setDetail(!0,[0,10],"#333",32,"{value}%").setGaugeTitle(!0,[0,-40],"#666",18)}setProgressIndicatorConfiguration(){return this.setRange(0,100).setRadius("60%").setCenter(["50%","50%"]).setProgress(!0,8).setPointer(!0,"60%",4).setPredefinedPalette("modern").setDetail(!0,[0,60],"#333",20,"{value}%").setGaugeTitle(!0,[0,-50],"#666",14)}build(){let t=B(T({},this.chartOptions),{series:[B(T({},this.seriesOptions),{type:"gauge"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"?a=e.map(l=>({value:parseFloat(l.value)||0,name:l.name||"Gauge"})):typeof e=="number"&&(a=[{value:e,name:"Gauge"}]);let o=t.chartInstance.getOption(),c=B(T({},o),{series:[B(T({},o.series[0]),{data:Array.isArray(a)?a:[a]})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating gauge chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isGaugeChart(t){return ve.isChartType(t,"gauge")}static createGaugeChartWidget(t){let e=r.create();return t&&e.setData(t),e.getWidgetBuilder()}static exportData(t){let e=[];return t.echart_options?.series?.[0]?.data&&t.echart_options.series[0].data.forEach(n=>{n&&e.push({Name:n.name||"Gauge",Value:n.value||0,Percentage:this.calculatePercentage(n.value||0,t.echart_options.series[0].max||100)})}),e}static getExportHeaders(t){return["Name","Value","Percentage"]}static getExportSheetName(t){return"Gauge Chart Data"}static calculatePercentage(t,e){return`${(t/e*100).toFixed(1)}%`}};var pn=class r extends ve{constructor(){super(),this.xAxisData=[],this.yAxisData=[],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"15%",bottom:"15%"},tooltip:{trigger:"item",formatter:"{b}: {c}"},xAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{color:"#666"}},visualMap:{show:!0,min:0,max:10,calculable:!0,orient:"horizontal",left:"center",top:"5%",inRange:{color:["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffcc","#fee090","#fdae61","#f46d43","#d73027","#a50026"]},text:["High","Low"]}}}getChartType(){return"heatmap"}getDefaultSeriesOptions(){return{name:"Heatmap Chart",type:"heatmap",itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},progressive:1e3,progressiveThreshold:3e3,animation:!0}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{xField:e="x",yField:i="y",valueField:n="value",nameField:s="name",sortBy:a,sortOrder:o="desc",limit:c}=t;try{let l=[],h=new Set,u=new Set,f=this.data;t.filters&&t.filters.length>0&&(f=ve.applyFilters(this.data,t.filters)),f.forEach((g,I)=>{let O=g[e]||I%10,A=g[i]||Math.floor(I/10),V=parseFloat(g[n])||0,q=g[s]||`${O}-${A}`,ie=typeof O=="string"?this.getAxisIndex(O,h):O,D=typeof A=="string"?this.getAxisIndex(A,u):A;l.push({value:[ie,D,V],name:q,originalItem:g}),typeof O=="string"&&h.add(O),typeof A=="string"&&u.add(A)}),a==="value"&&l.sort((g,I)=>o==="asc"?g.value[2]-I.value[2]:I.value[2]-g.value[2]),c&&c>0&&(l=l.slice(0,c)),this.seriesOptions.data=l,h.size>0&&this.setXAxisData(Array.from(h).sort()),u.size>0&&this.setYAxisData(Array.from(u).sort());let p=l.map(g=>g.value[2]),x=Math.min(...p),d=Math.max(...p);this.setVisualMap(x,d)}catch(l){console.error("Error transforming heatmap chart data:",l)}return this}getAxisIndex(t,e){let i=Array.from(e).sort(),n=i.indexOf(t);return n!==-1?n:i.length}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis=B(T({},this.chartOptions.xAxis),{data:t}),this}setYAxisData(t){return this.yAxisData=t,this.chartOptions.yAxis=B(T({},this.chartOptions.yAxis),{data:t}),this}setXAxisName(t){return this.chartOptions.xAxis=B(T({},this.chartOptions.xAxis),{name:t}),this}setYAxisName(t){return this.chartOptions.yAxis=B(T({},this.chartOptions.yAxis),{name:t}),this}setVisualMap(t,e,i,n=["High","Low"]){return this.chartOptions.visualMap=B(T({},this.chartOptions.visualMap),{min:t,max:e,inRange:{color:i||["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffcc","#fee090","#fdae61","#f46d43","#d73027","#a50026"]},text:n}),this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&(this.chartOptions.visualMap=B(T({},this.chartOptions.visualMap),{inRange:{color:e}})),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("item",n=>{let[s,a,o]=n.data.value;return`${n.data.name||`(${s}, ${a})`}: ${i(o)}`}),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("item",i=>{let[n,s,a]=i.data.value;return`${i.data.name||`(${n}, ${s})`}: ${e(a)}`}),this}setCustomNumberFormatter(t=1,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("item",n=>{let[s,a,o]=n.data.value;return`${n.data.name||`(${s}, ${a})`}: ${i(o)}`}),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=7,e=5){let i=[],n=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].slice(0,t),s=["Morning","Afternoon","Evening","Night","Late Night"].slice(0,e);for(let a=0;a<t;a++)for(let o=0;o<e;o++)i.push({x:n[a],y:s[o],value:Math.floor(Math.random()*100),category:["High","Medium","Low"][Math.floor(Math.random()*3)],department:["Sales","Marketing","Operations"][Math.floor(Math.random()*3)]});return this.setData(i)}setActivityAnalysisConfiguration(){return this.setPredefinedPalette("business").setCustomNumberFormatter(0,"en-US").setXAxisName("Time Period").setYAxisName("Activity Type").setVisualMapPosition("horizontal","center","5%")}setCorrelationAnalysisConfiguration(){return this.setPredefinedPalette("modern").setPercentageFormatter(2).setXAxisName("Variable X").setYAxisName("Variable Y").setVisualMapPosition("vertical","right","center")}setPerformanceMatrixConfiguration(){return this.setPredefinedPalette("finance").setCurrencyFormatter("USD","en-US").setXAxisName("Time").setYAxisName("Metrics").setVisualMapPosition("horizontal","center","bottom")}setVisualMapPosition(t="horizontal",e="center",i="5%"){return this.chartOptions.visualMap=B(T({},this.chartOptions.visualMap),{orient:t,left:e,top:i}),this}setItemStyle(t="#fff",e=1){return this.seriesOptions.itemStyle={borderColor:t,borderWidth:e},this}setProgressive(t,e=3e3){return this.seriesOptions.progressive=t,this.seriesOptions.progressiveThreshold=e,this}setAnimation(t){return this.seriesOptions.animation=t,this}build(){let t=B(T({},this.chartOptions),{series:[B(T({},this.seriesOptions),{type:"heatmap"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map((l,h)=>T({value:[l.x||h%10,l.y||Math.floor(h/10),parseFloat(l.value)||0],name:l.name||`${l.x||h%10}-${l.y||Math.floor(h/10)}`},l)));let o=t.chartInstance.getOption(),c=B(T({},o),{series:[B(T({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating heatmap chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isHeatmapChart(t){return ve.isChartType(t,"heatmap")}static createHeatmapChartWidget(t,e,i){let n=r.create();return t&&n.setData(t),e&&n.setXAxisData(e),i&&n.setYAxisData(i),n.getWidgetBuilder()}static exportData(t){let e=[];if(t.echart_options?.series?.[0]?.data){let i=t.echart_options.series[0].data,n=t.echart_options?.xAxis?.data||[],s=t.echart_options?.yAxis?.data||[];i.forEach(a=>{if(a&&a.value){let[o,c,l]=a.value;e.push({X:n[o]||o,Y:s[c]||c,Value:l,Name:a.name||`${o}-${c}`})}})}return e}static getExportHeaders(t){return["X","Y","Value","Name"]}static getExportSheetName(t){return"Heatmap Chart Data"}};var Zn={MOBILE:480,TABLET:768,DESKTOP:1024,LARGE_DESKTOP:1440},vt={MOBILE:{COLS:.5,ROWS:.8,WIDTH:.6,HEIGHT:1.2},TABLET:{COLS:.75,ROWS:.9,WIDTH:.8,HEIGHT:1},DESKTOP:{COLS:1,ROWS:1,WIDTH:1,HEIGHT:1},LARGE_DESKTOP:{COLS:1.33,ROWS:1.1,WIDTH:1.2,HEIGHT:.9}},we={MAX_COLS:12,MIN_COLS:1,MAX_ROWS:100,MIN_ROWS:1,FIXED_COL_WIDTH:100,FIXED_ROW_HEIGHT:50,MOBILE_BREAKPOINT:640},ao={MAX_COLS:Math.round(we.MAX_COLS*vt.MOBILE.COLS),MIN_COLS:Math.round(we.MIN_COLS*vt.MOBILE.COLS),MAX_ROWS:Math.round(we.MAX_ROWS*vt.MOBILE.ROWS),MIN_ROWS:Math.round(we.MIN_ROWS*vt.MOBILE.ROWS),FIXED_COL_WIDTH:Math.round(we.FIXED_COL_WIDTH*vt.MOBILE.WIDTH),FIXED_ROW_HEIGHT:Math.round(we.FIXED_ROW_HEIGHT*vt.MOBILE.HEIGHT),MOBILE_BREAKPOINT:Zn.MOBILE},oo={MAX_COLS:Math.round(we.MAX_COLS*vt.TABLET.COLS),MIN_COLS:Math.round(we.MIN_COLS*vt.TABLET.COLS),MAX_ROWS:Math.round(we.MAX_ROWS*vt.TABLET.ROWS),MIN_ROWS:Math.round(we.MIN_ROWS*vt.TABLET.ROWS),FIXED_COL_WIDTH:Math.round(we.FIXED_COL_WIDTH*vt.TABLET.WIDTH),FIXED_ROW_HEIGHT:Math.round(we.FIXED_ROW_HEIGHT*vt.TABLET.HEIGHT),MOBILE_BREAKPOINT:Zn.TABLET},lo={MAX_COLS:Math.round(we.MAX_COLS*vt.LARGE_DESKTOP.COLS),MIN_COLS:Math.round(we.MIN_COLS*vt.LARGE_DESKTOP.COLS),MAX_ROWS:Math.round(we.MAX_ROWS*vt.LARGE_DESKTOP.ROWS),MIN_ROWS:Math.round(we.MIN_ROWS*vt.LARGE_DESKTOP.ROWS),FIXED_COL_WIDTH:Math.round(we.FIXED_COL_WIDTH*vt.LARGE_DESKTOP.WIDTH),FIXED_ROW_HEIGHT:Math.round(we.FIXED_ROW_HEIGHT*vt.LARGE_DESKTOP.HEIGHT),MOBILE_BREAKPOINT:Zn.LARGE_DESKTOP},Wi={COMPACT:{FIXED_COL_WIDTH:80,FIXED_ROW_HEIGHT:40,OUTER_MARGIN:!1},STANDARD:{FIXED_COL_WIDTH:we.FIXED_COL_WIDTH,FIXED_ROW_HEIGHT:we.FIXED_ROW_HEIGHT,OUTER_MARGIN:!0},SPACIOUS:{FIXED_COL_WIDTH:120,FIXED_ROW_HEIGHT:80,OUTER_MARGIN:!0}};function wc(r){switch(r){case"MOBILE":return ao;case"TABLET":return oo;case"DESKTOP":return we;case"LARGE_DESKTOP":return lo;default:return we}}var Bt=function(r){return r.DENSITY_BLUE="density_blue",r.DENSITY_GREEN="density_green",r.DENSITY_RED="density_red",r.DENSITY_PURPLE="density_purple",r.DENSITY_ORANGE="density_orange",r.RAINBOW="rainbow",r.DIVERGING="diverging",r.CATEGORICAL="categorical",r.GRAYSCALE="grayscale",r.PROFIT_LOSS="profit_loss",r.PERFORMANCE="performance",r}(Bt||{}),yc={[Bt.DENSITY_BLUE]:["#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],[Bt.DENSITY_GREEN]:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],[Bt.DENSITY_RED]:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],[Bt.DENSITY_PURPLE]:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],[Bt.DENSITY_ORANGE]:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],[Bt.RAINBOW]:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],[Bt.DIVERGING]:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],[Bt.CATEGORICAL]:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],[Bt.GRAYSCALE]:["#f7f7f7","#cccccc","#969696","#636363","#252525"],[Bt.PROFIT_LOSS]:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91d47c","#4575b4"],[Bt.PERFORMANCE]:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#41ab5d"]},co=function(r){return r.DENSITY_MAP="map",r.HEATMAP="heatmap",r.LINE="line",r.BAR="bar",r.PIE="pie",r.SCATTER="scatter",r.AREA="area",r.GAUGE="gauge",r.SANKEY="sankey",r.TREEMAP="treemap",r.SUNBURST="sunburst",r.POLAR="polar",r}(co||{}),ho=function(r){return r.WORLD="world",r.USA="usa",r.CHINA="china",r.JAPAN="japan",r.UK="uk",r.FRANCE="france",r.GERMANY="germany",r.ITALY="italy",r.SPAIN="spain",r.RUSSIA="russia",r.CANADA="canada",r.AUSTRALIA="australia",r.BRAZIL="brazil",r.INDIA="india",r}(ho||{});var Cc={WORLD:[0,30],NORTH_AMERICA:[-100,45],EUROPE:[10,50],ASIA:[100,30],AFRICA:[20,0],SOUTH_AMERICA:[-60,-15],OCEANIA:[140,-25]};function qs(r){return yc[r]||yc[Bt.DENSITY_BLUE]}var mn=class r extends ve{constructor(){super(),this.mapName="world",this.roamEnabled=!1,this.zoomLevel=1,this.centerCoords=[0,0],this.visualMapRange=[0,100],this.visualMapColors=qs(Bt.DENSITY_BLUE),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}static registerMap(t,e){try{gc(t,e)}catch{}}static getAvailableMaps(){return Object.values(ho)}getDefaultOptions(){return{tooltip:{trigger:"item",formatter:"{b}: {c}"},legend:{show:!1},visualMap:{type:"continuous",min:0,max:100,left:"left",top:"bottom",text:["High","Low"],calculable:!0,inRange:{color:[...qs(Bt.DENSITY_BLUE)]},textStyle:{color:"#333"}}}}getChartType(){return co.DENSITY_MAP}getDefaultSeriesOptions(){return{name:"Density Map",type:"map",map:"world",roam:!1,zoom:1,center:[0,0],label:{show:!1,position:"inside",formatter:"{b}",fontSize:12,color:"#333"},itemStyle:{areaColor:"#eee",borderColor:"#999",borderWidth:.5,shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.3)"},emphasis:{itemStyle:{areaColor:"#b8e186",shadowBlur:20,shadowColor:"rgba(0, 0, 0, 0.5)"}},select:{itemStyle:{areaColor:"#b8e186"}}}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setMap(t){return this.mapName=t,this.seriesOptions.map=t,this}setMapType(t){return this.setMap(t)}setRoam(t){return this.roamEnabled=t,this.seriesOptions.roam=t,this}setZoom(t){return this.zoomLevel=t,this.seriesOptions.zoom=t,this}setCenter(t){return this.centerCoords=t,this.seriesOptions.center=t,this}setVisualMap(t,e,i){return this.visualMapRange=[t,e],i&&(this.visualMapColors=i),this.chartOptions.visualMap={type:"continuous",min:t,max:e,left:"left",top:"bottom",text:["High","Low"],calculable:!0,inRange:{color:[...this.visualMapColors]},textStyle:{color:"#333"}},this}setColorScheme(t,e=0,i=100){return this.visualMapColors=qs(t),this.setVisualMap(e,i)}setLabelShow(t,e="inside",i){return this.seriesOptions.label={show:t,position:e,formatter:i||"{b}",fontSize:12,color:"#333"},this}setConditionalLabels(t=!0,e="inside",i,n=!0){return n?this.seriesOptions.label={show:!0,position:e,formatter:s=>typeof s.value=="number"&&isFinite(s.value)?i?i.replace("{b}",s.name).replace("{c}",s.value.toString()):`${s.name}
${s.value}`:"",fontSize:12,color:"#333"}:this.seriesOptions.label={show:t,position:e,formatter:i||`{b}
{c}`,fontSize:12,color:"#333"},this}setAreaColor(t){return this.seriesOptions.itemStyle=B(T({},this.seriesOptions.itemStyle),{areaColor:t}),this}setBorderColor(t,e=.5){return this.seriesOptions.itemStyle=B(T({},this.seriesOptions.itemStyle),{borderColor:t,borderWidth:e}),this}setEmphasisColor(t){return this.seriesOptions.emphasis={itemStyle:{areaColor:t,shadowBlur:20,shadowColor:"rgba(0, 0, 0, 0.5)"}},this}setShadow(t=10,e="rgba(0, 0, 0, 0.3)"){return this.seriesOptions.itemStyle=B(T({},this.seriesOptions.itemStyle),{shadowBlur:t,shadowColor:e}),this}setVisualMapOptions(t){return this.chartOptions.visualMap=T(T({},this.chartOptions.visualMap),t),this}setGeoOptions(t){return this.chartOptions.geo=T(T({},this.chartOptions.geo),t),this}setPosition(t){super.setPosition(t);let e=this.calculateMapCenter(t.cols,t.rows);return this.setCenter(e),this}autoAdjustMapSettings(){let t=this.widgetBuilder.build().position;if(t){let e=this.calculateMapCenter(t.cols,t.rows),i=this.calculateMapZoom(t.cols,t.rows);this.setCenter(e)}return this}build(){return this.autoAdjustMapSettings(),this.seriesOptions=B(T({},this.seriesOptions),{map:this.mapName,roam:this.roamEnabled,zoom:this.zoomLevel,center:this.centerCoords}),this.chartOptions.series=[this.seriesOptions],this.widgetBuilder.setEChartsOptions(this.chartOptions).build()}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",regionField:n="region",sortBy:s,sortOrder:a="desc",limit:o}=t;try{let c=[],l=this.data;t.filters&&t.filters.length>0&&(l=ve.applyFilters(this.data,t.filters)),l.forEach(p=>{let x=p[e]||p[n]||"Unknown",d=parseFloat(p[i])||0;c.push({name:x,value:d,originalItem:p})}),s==="value"?c.sort((p,x)=>a==="asc"?p.value-x.value:x.value-p.value):s==="name"&&c.sort((p,x)=>a==="asc"?p.name.localeCompare(x.name):x.name.localeCompare(p.name)),o&&o>0&&(c=c.slice(0,o)),this.seriesOptions.data=c;let h=c.map(p=>p.value),u=Math.min(...h),f=Math.max(...h);this.setVisualMap(u,f)}catch(c){console.error("Error transforming density map data:",c)}return this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&this.setVisualMap(this.visualMapRange[0],this.visualMapRange[1],e),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("item",n=>`${n.name}: ${i(n.value)}`),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("item",i=>`${i.name}: ${e(i.value)}`),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("item",n=>`${n.name}: ${i(n.value)}`),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=10,e="world"){let i=[],n=e==="world"?["China","United States","India","Brazil","Russia","Japan","Germany","United Kingdom","France","Italy"]:["Region 1","Region 2","Region 3","Region 4","Region 5","Region 6","Region 7","Region 8","Region 9","Region 10"];for(let s=0;s<Math.min(t,n.length);s++)i.push({name:n[s],value:Math.floor(Math.random()*1e3)+100,density:Math.floor(Math.random()*500)+50,population:Math.floor(Math.random()*1e6)+1e5,category:["High","Medium","Low"][Math.floor(Math.random()*3)]});return this.setData(i)}setPopulationDensityConfiguration(){return this.setMap("world").setPredefinedPalette("business").setCustomNumberFormatter(0,"en-US").setVisualMapOptions({text:["High Density","Low Density"],orient:"vertical",left:"left",top:"center"})}setEconomicIndicatorsConfiguration(){return this.setMap("world").setPredefinedPalette("finance").setCurrencyFormatter("USD","en-US").setVisualMapOptions({text:["Highest","Lowest"],orient:"horizontal",left:"center",bottom:"10%"})}setRiskAssessmentConfiguration(){return this.setMap("world").setPredefinedPalette("modern").setPercentageFormatter(1).setVisualMapOptions({text:["High Risk","Low Risk"],orient:"vertical",right:"10%",top:"center"})}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>B(T({},l),{name:l.name||"Unknown",value:typeof l.value=="number"?l.value:parseFloat(l.value)||0})));let o=t.chartInstance.getOption(),c=B(T({},o),{series:[B(T({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating density map data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static updateMapSettings(t,e){if(t.chartInstance)try{let i=t.chartInstance.getOption(),n=B(T({},i),{series:i.series?.map(s=>B(T({},s),{zoom:e?.zoom??s.zoom,center:e?.center??s.center,roam:e?.roam??s.roam}))});t.chartInstance.setOption(n,!0)}catch(i){console.error("Error updating density map settings:",i)}}static isDensityMap(t){return ve.isChartType(t,"map")}static isDensityMapEnhanced(t){if(ve.isChartType(t,"map"))return!0;let e=t.config?.options;if(e?.series?.[0]){let i=e.series[0];return i.type==="map"||i.map!==void 0}return!!e?.visualMap}static getDefaultData(){return[{name:"United States",value:100},{name:"China",value:85},{name:"Japan",value:70},{name:"Germany",value:65},{name:"United Kingdom",value:60},{name:"France",value:55},{name:"Canada",value:50},{name:"Australia",value:45},{name:"Brazil",value:40},{name:"India",value:35}]}static exportData(t){let e=t.config?.options?.series?.[0];return e?.data?e.data.map(i=>[i.name||"Unknown Region",i.value||0]):[]}static getExportHeaders(t){return["Region","Value"]}static getExportSheetName(t){return(t.config?.header?.title||"Sheet").replace(/[^\w\s]/gi,"").substring(0,31).trim()}static createDensityMapWidget(t,e){let i=r.create();return t&&i.setData(t),e&&i.setMap(e),i.getWidgetBuilder()}calculateMapCenter(t,e){let[i,n]=Cc.WORLD,s=t/e,a=s>1?(s-1)*5:0,o=s<1?(1/s-1)*2:0;return[i+a,n+o]}calculateMapZoom(t,e){let n=t*e,s=Math.log(n)/Math.log(2),a=t/e,o=Math.abs(1-a)*.5;return 4-s*.1-o}};var Tc=["*"];function Wu(r,t){if(r&1&&xe(0,"div",0),r&2){let e=t.$index,i=E();M("ngStyle",i.gridRenderer.getGridColumnStyle(e))}}function $u(r,t){if(r&1&&xe(0,"div",1),r&2){let e=t.$index,i=E();M("ngStyle",i.gridRenderer.getGridRowStyle(e))}}function zu(r,t){if(r&1){let e=Se();ke(0,"div",8),Qt("mousedown",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))})("touchstart",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))}),Me()}}function Uu(r,t){if(r&1){let e=Se();ke(0,"div",9),Qt("mousedown",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))})("touchstart",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))}),Me()}}function Gu(r,t){if(r&1){let e=Se();ke(0,"div",10),Qt("mousedown",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))})("touchstart",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))}),Me()}}function Xu(r,t){if(r&1){let e=Se();ke(0,"div",11),Qt("mousedown",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))})("touchstart",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))}),Me()}}function ju(r,t){if(r&1){let e=Se();ke(0,"div",12),Qt("mousedown",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))})("touchstart",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))}),Me()}}function Yu(r,t){if(r&1){let e=Se();ke(0,"div",13),Qt("mousedown",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))})("touchstart",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))}),Me()}}function Ku(r,t){if(r&1){let e=Se();ke(0,"div",14),Qt("mousedown",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))})("touchstart",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))}),Me()}}function qu(r,t){if(r&1){let e=Se();ke(0,"div",15),Qt("mousedown",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))})("touchstart",function(n){J(e);let s=E();return ee(s.resize.dragStartDelay(n))}),Me()}}var Pe=function(r){return r.Fit="fit",r.ScrollVertical="scrollVertical",r.ScrollHorizontal="scrollHorizontal",r.Fixed="fixed",r.VerticalFixed="verticalFixed",r.HorizontalFixed="horizontalFixed",r}(Pe||{}),Ci=function(r){return r.Always="always",r.OnDragAndResize="onDrag&Resize",r.None="none",r}(Ci||{}),Qe=function(r){return r.None="none",r.CompactUp="compactUp",r.CompactLeft="compactLeft",r.CompactUpAndLeft="compactUp&Left",r.CompactLeftAndUp="compactLeft&Up",r.CompactRight="compactRight",r.CompactUpAndRight="compactUp&Right",r.CompactRightAndUp="compactRight&Up",r.CompactDown="compactDown",r.CompactDownAndLeft="compactDown&Left",r.CompactLeftAndDown="compactLeft&Down",r.CompactDownAndRight="compactDown&Right",r.CompactRightAndDown="compactRight&Down",r}(Qe||{}),Ft=function(r){return r.LTR="ltr",r.RTL="rtl",r}(Ft||{}),uo=class{gridster;constructor(t){this.gridster=t}destroy(){this.gridster=null}checkCompact(){this.gridster.$options.compactType!==Qe.None&&(this.gridster.$options.compactType===Qe.CompactUp?this.checkCompactMovement("y",-1):this.gridster.$options.compactType===Qe.CompactLeft?this.checkCompactMovement("x",-1):this.gridster.$options.compactType===Qe.CompactUpAndLeft?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===Qe.CompactLeftAndUp?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===Qe.CompactRight?this.checkCompactMovement("x",1):this.gridster.$options.compactType===Qe.CompactUpAndRight?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===Qe.CompactRightAndUp?(this.checkCompactMovement("x",1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===Qe.CompactDown?this.checkCompactMovement("y",1):this.gridster.$options.compactType===Qe.CompactDownAndLeft?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===Qe.CompactDownAndRight?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===Qe.CompactLeftAndDown?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",1)):this.gridster.$options.compactType===Qe.CompactRightAndDown&&(this.checkCompactMovement("x",1),this.checkCompactMovement("y",1)))}checkCompactItem(t){this.gridster.$options.compactType!==Qe.None&&(this.gridster.$options.compactType===Qe.CompactUp?this.moveTillCollision(t,"y",-1):this.gridster.$options.compactType===Qe.CompactLeft?this.moveTillCollision(t,"x",-1):this.gridster.$options.compactType===Qe.CompactUpAndLeft?(this.moveTillCollision(t,"y",-1),this.moveTillCollision(t,"x",-1)):this.gridster.$options.compactType===Qe.CompactLeftAndUp?(this.moveTillCollision(t,"x",-1),this.moveTillCollision(t,"y",-1)):this.gridster.$options.compactType===Qe.CompactUpAndRight?(this.moveTillCollision(t,"y",-1),this.moveTillCollision(t,"x",1)):this.gridster.$options.compactType===Qe.CompactDown?this.moveTillCollision(t,"y",1):this.gridster.$options.compactType===Qe.CompactDownAndLeft?(this.moveTillCollision(t,"y",1),this.moveTillCollision(t,"x",-1)):this.gridster.$options.compactType===Qe.CompactLeftAndDown?(this.moveTillCollision(t,"x",-1),this.moveTillCollision(t,"y",1)):this.gridster.$options.compactType===Qe.CompactDownAndRight?(this.moveTillCollision(t,"y",1),this.moveTillCollision(t,"x",1)):this.gridster.$options.compactType===Qe.CompactRightAndDown&&(this.moveTillCollision(t,"x",1),this.moveTillCollision(t,"y",1)))}checkCompactMovement(t,e){let i=!1;this.gridster.grid.forEach(n=>{n.$item.compactEnabled!==!1&&this.moveTillCollision(n.$item,t,e)&&(i=!0,n.item[t]=n.$item[t],n.itemChanged())}),i&&this.checkCompact()}moveTillCollision(t,e,i){return t[e]+=i,this.gridster.checkCollision(t)?(t[e]-=i,!1):(this.moveTillCollision(t,e,i),!0)}},Zu={gridType:Pe.Fit,scale:1,fixedColWidth:250,fixedRowHeight:250,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,setGridSize:!1,compactType:Qe.None,mobileBreakpoint:640,useBodyForBreakpoint:!1,allowMultiLayer:!1,defaultLayerIndex:0,maxLayerIndex:2,baseLayerIndex:1,minCols:1,maxCols:100,minRows:1,maxRows:100,defaultItemCols:1,defaultItemRows:1,itemAspectRatio:void 0,maxItemCols:50,maxItemRows:50,minItemCols:1,minItemRows:1,minItemArea:1,maxItemArea:2500,addEmptyRowsCount:0,rowHeightRatio:1,margin:10,outerMargin:!0,outerMarginTop:null,outerMarginRight:null,outerMarginBottom:null,outerMarginLeft:null,useTransformPositioning:!0,scrollSensitivity:10,scrollSpeed:20,initCallback:void 0,destroyCallback:void 0,gridSizeChangedCallback:void 0,itemChangeCallback:void 0,itemResizeCallback:void 0,itemInitCallback:void 0,itemRemovedCallback:void 0,itemValidateCallback:void 0,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,enableOccupiedCellDrop:!1,emptyCellClickCallback:void 0,emptyCellContextMenuCallback:void 0,emptyCellDropCallback:void 0,emptyCellDragCallback:void 0,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,draggable:{delayStart:0,enabled:!1,ignoreContentClass:"gridster-item-content",ignoreContent:!1,dragHandleClass:"drag-handler",stop:void 0,start:void 0,dropOverItems:!1,dropOverItemsCallback:void 0},resizable:{delayStart:0,enabled:!1,handles:{s:!0,e:!0,n:!0,w:!0,se:!0,ne:!0,sw:!0,nw:!0},stop:void 0,start:void 0},swap:!0,swapWhileDragging:!1,pushItems:!1,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushResizeItems:!1,displayGrid:Ci.OnDragAndResize,disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1,disableScrollHorizontal:!1,disableScrollVertical:!1,enableBoundaryControl:!1,disableAutoPositionOnConflict:!1,dirType:Ft.LTR},Ht=class r{static merge(t,e,i){for(let n in e)e[n]!==void 0&&i.hasOwnProperty(n)&&(typeof e[n]=="object"?(n in t||(t[n]={}),t[n]=r.merge(t[n],e[n],i[n])):t[n]=e[n]);return t}static checkTouchEvent(t){t.clientX===void 0&&t.touches&&(t.touches&&t.touches.length?(t.clientX=t.touches[0].clientX,t.clientY=t.touches[0].clientY):t.changedTouches&&t.changedTouches.length&&(t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY))}static checkContentClassForEvent(t,e){if(t.$options.draggable.ignoreContent){if(!r.checkDragHandleClass(e.target,e.currentTarget,t.$options.draggable.dragHandleClass,t.$options.draggable.ignoreContentClass))return!0}else if(r.checkContentClass(e.target,e.currentTarget,t.$options.draggable.ignoreContentClass))return!0;return!1}static checkContentClassForEmptyCellClickEvent(t,e){return r.checkContentClass(e.target,e.currentTarget,t.$options.draggable.ignoreContentClass)||r.checkContentClass(e.target,e.currentTarget,t.$options.draggable.dragHandleClass)}static checkDragHandleClass(t,e,i,n){if(!t||t===e)return!1;if(t.hasAttribute("class")){let s=t.getAttribute("class").split(" ");if(s.indexOf(i)>-1)return!0;if(s.indexOf(n)>-1)return!1}return r.checkDragHandleClass(t.parentNode,e,i,n)}static checkContentClass(t,e,i){return!t||t===e?!1:t.hasAttribute("class")&&t.getAttribute("class").split(" ").indexOf(i)>-1?!0:r.checkContentClass(t.parentNode,e,i)}static compareItems(t,e){return t.y>e.y?-1:t.y<e.y?1:t.x>e.x?-1:1}},fo=class{gridster;initialItem;removeEmptyCellClickListenerFn;removeEmptyCellTouchendListenerFn;removeEmptyCellContextMenuListenerFn;removeEmptyCellDropListenerFn;removeEmptyCellMousedownListenerFn;removeEmptyCellTouchstartListenerFn;removeWindowMousemoveListenerFn;removeWindowTouchmoveListenerFn;removeWindowMouseupListenerFn;removeWindowTouchendListenerFn;removeEmptyCellDragoverListenerFn;removeDocumentDragendListenerFn;constructor(t){this.gridster=t}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(),this.gridster.movingItem=null,this.initialItem=this.gridster=null,this.removeDocumentDragendListenerFn&&(this.removeDocumentDragendListenerFn(),this.removeDocumentDragendListenerFn=null)}updateOptions(){this.gridster.$options.enableEmptyCellClick&&!this.removeEmptyCellClickListenerFn&&this.gridster.options.emptyCellClickCallback?(this.removeEmptyCellClickListenerFn=this.gridster.renderer.listen(this.gridster.el,"click",this.emptyCellClickCb),this.removeEmptyCellTouchendListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchend",this.emptyCellClickCb)):!this.gridster.$options.enableEmptyCellClick&&this.removeEmptyCellClickListenerFn&&this.removeEmptyCellTouchendListenerFn&&(this.removeEmptyCellClickListenerFn(),this.removeEmptyCellTouchendListenerFn(),this.removeEmptyCellClickListenerFn=null,this.removeEmptyCellTouchendListenerFn=null),this.gridster.$options.enableEmptyCellContextMenu&&!this.removeEmptyCellContextMenuListenerFn&&this.gridster.options.emptyCellContextMenuCallback?this.removeEmptyCellContextMenuListenerFn=this.gridster.renderer.listen(this.gridster.el,"contextmenu",this.emptyCellContextMenuCb):!this.gridster.$options.enableEmptyCellContextMenu&&this.removeEmptyCellContextMenuListenerFn&&(this.removeEmptyCellContextMenuListenerFn(),this.removeEmptyCellContextMenuListenerFn=null),this.gridster.$options.enableEmptyCellDrop&&!this.removeEmptyCellDropListenerFn&&this.gridster.options.emptyCellDropCallback?(this.removeEmptyCellDropListenerFn=this.gridster.renderer.listen(this.gridster.el,"drop",this.emptyCellDragDrop),this.gridster.zone.runOutsideAngular(()=>{this.removeEmptyCellDragoverListenerFn=this.gridster.renderer.listen(this.gridster.el,"dragover",this.emptyCellDragOver)}),this.removeDocumentDragendListenerFn=this.gridster.renderer.listen("document","dragend",()=>{this.gridster.movingItem=null,this.gridster.previewStyle()})):!this.gridster.$options.enableEmptyCellDrop&&this.removeEmptyCellDropListenerFn&&this.removeEmptyCellDragoverListenerFn&&this.removeDocumentDragendListenerFn&&(this.removeEmptyCellDropListenerFn(),this.removeEmptyCellDragoverListenerFn(),this.removeDocumentDragendListenerFn(),this.removeEmptyCellDragoverListenerFn=null,this.removeEmptyCellDropListenerFn=null,this.removeDocumentDragendListenerFn=null),this.gridster.$options.enableEmptyCellDrag&&!this.removeEmptyCellMousedownListenerFn&&this.gridster.options.emptyCellDragCallback?(this.removeEmptyCellMousedownListenerFn=this.gridster.renderer.listen(this.gridster.el,"mousedown",this.emptyCellMouseDown),this.removeEmptyCellTouchstartListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchstart",this.emptyCellMouseDown)):!this.gridster.$options.enableEmptyCellDrag&&this.removeEmptyCellMousedownListenerFn&&this.removeEmptyCellTouchstartListenerFn&&(this.removeEmptyCellMousedownListenerFn(),this.removeEmptyCellTouchstartListenerFn(),this.removeEmptyCellMousedownListenerFn=null,this.removeEmptyCellTouchstartListenerFn=null)}emptyCellClickCb=t=>{if(!this.gridster||this.gridster.movingItem||Ht.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;let e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellClickCallback&&this.gridster.options.emptyCellClickCallback(t,e),this.gridster.cdRef.markForCheck())};emptyCellContextMenuCb=t=>{if(this.gridster.movingItem||Ht.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellContextMenuCallback&&this.gridster.options.emptyCellContextMenuCallback(t,e),this.gridster.cdRef.markForCheck())};emptyCellDragDrop=t=>{let e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellDropCallback&&this.gridster.options.emptyCellDropCallback(t,e),this.gridster.cdRef.markForCheck())};emptyCellDragOver=t=>{t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t);e?(t.dataTransfer&&(t.dataTransfer.dropEffect="move"),this.gridster.movingItem=e):(t.dataTransfer&&(t.dataTransfer.dropEffect="none"),this.gridster.movingItem=null),this.gridster.previewStyle()};emptyCellMouseDown=t=>{if(Ht.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t);!e||t.buttons!==1&&!(t instanceof TouchEvent)||(this.initialItem=e,this.gridster.movingItem=e,this.gridster.previewStyle(),this.gridster.zone.runOutsideAngular(()=>{this.removeWindowMousemoveListenerFn=this.gridster.renderer.listen("window","mousemove",this.emptyCellMouseMove),this.removeWindowTouchmoveListenerFn=this.gridster.renderer.listen("window","touchmove",this.emptyCellMouseMove)}),this.removeWindowMouseupListenerFn=this.gridster.renderer.listen("window","mouseup",this.emptyCellMouseUp),this.removeWindowTouchendListenerFn=this.gridster.renderer.listen("window","touchend",this.emptyCellMouseUp))};emptyCellMouseMove=t=>{t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t,this.initialItem);e&&(this.gridster.movingItem=e,this.gridster.previewStyle())};emptyCellMouseUp=t=>{this.removeWindowMousemoveListenerFn(),this.removeWindowTouchmoveListenerFn(),this.removeWindowMouseupListenerFn(),this.removeWindowTouchendListenerFn();let e=this.getValidItemFromEvent(t,this.initialItem);e&&(this.gridster.movingItem=e),this.gridster.options.emptyCellDragCallback&&this.gridster.movingItem&&this.gridster.options.emptyCellDragCallback(t,this.gridster.movingItem),setTimeout(()=>{this.initialItem=null,this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())}),this.gridster.cdRef.markForCheck()};getPixelsX(t,e){let i=this.gridster.options.scale;return i?(t.clientX-e.left)/i+this.gridster.el.scrollLeft-this.gridster.gridRenderer.getLeftMargin():t.clientX+this.gridster.el.scrollLeft-e.left-this.gridster.gridRenderer.getLeftMargin()}getPixelsY(t,e){let i=this.gridster.options.scale;return i?(t.clientY-e.top)/i+this.gridster.el.scrollTop-this.gridster.gridRenderer.getTopMargin():t.clientY+this.gridster.el.scrollTop-e.top-this.gridster.gridRenderer.getTopMargin()}getValidItemFromEvent(t,e){t.preventDefault(),t.stopPropagation(),Ht.checkTouchEvent(t);let i=this.gridster.el.getBoundingClientRect(),n=this.getPixelsX(t,i),s=this.getPixelsY(t,i),a={x:this.gridster.pixelsToPositionX(n,Math.floor,!0),y:this.gridster.pixelsToPositionY(s,Math.floor,!0),cols:this.gridster.$options.defaultItemCols,rows:this.gridster.$options.defaultItemRows};if(e&&(a.cols=Math.min(Math.abs(e.x-a.x)+1,this.gridster.$options.emptyCellDragMaxCols),a.rows=Math.min(Math.abs(e.y-a.y)+1,this.gridster.$options.emptyCellDragMaxRows),e.x<a.x?a.x=e.x:e.x-a.x>this.gridster.$options.emptyCellDragMaxCols-1&&(a.x=this.gridster.movingItem?this.gridster.movingItem.x:0),e.y<a.y?a.y=e.y:e.y-a.y>this.gridster.$options.emptyCellDragMaxRows-1&&(a.y=this.gridster.movingItem?this.gridster.movingItem.y:0)),!(!this.gridster.$options.enableOccupiedCellDrop&&this.gridster.checkCollision(a)))return a}},po=class{gridster;lastGridColumnStyles={};lastGridRowStyles={};constructor(t){this.gridster=t}destroy(){this.gridster=null}updateItem(t,e,i){if(this.gridster.mobile)this.clearCellPosition(i,t),this.gridster.$options.keepFixedHeightInMobile?i.setStyle(t,"height",(e.rows-1)*this.gridster.$options.margin+e.rows*this.gridster.$options.fixedRowHeight+"px"):i.setStyle(t,"height",e.rows*this.gridster.curWidth/e.cols+"px"),this.gridster.$options.keepFixedWidthInMobile?i.setStyle(t,"width",this.gridster.$options.fixedColWidth+"px"):i.setStyle(t,"width",""),i.setStyle(t,"margin-bottom",this.gridster.$options.margin+"px"),i.setStyle(t,Ft.LTR?"margin-right":"margin-left","");else{let n=Math.round(this.gridster.curColWidth*e.x),s=Math.round(this.gridster.curRowHeight*e.y),a=this.gridster.curColWidth*e.cols-this.gridster.$options.margin,o=this.gridster.curRowHeight*e.rows-this.gridster.$options.margin;this.setCellPosition(i,t,n,s),i.setStyle(t,"width",a+"px"),i.setStyle(t,"height",o+"px");let c=null,l=null;this.gridster.$options.outerMargin&&(this.gridster.rows===e.rows+e.y&&(this.gridster.$options.outerMarginBottom!==null?c=this.gridster.$options.outerMarginBottom+"px":c=this.gridster.$options.margin+"px"),this.gridster.columns===e.cols+e.x&&(this.gridster.$options.outerMarginBottom!==null?l=this.gridster.$options.outerMarginRight+"px":l=this.gridster.$options.margin+"px")),i.setStyle(t,"margin-bottom",c),i.setStyle(t,Ft.LTR?"margin-right":"margin-left",l)}}updateGridster(){let t="",e="",i="",n="";if(this.gridster.$options.gridType===Pe.Fit)t=Pe.Fit,e=Pe.ScrollVertical,i=Pe.ScrollHorizontal,n=Pe.Fixed;else if(this.gridster.$options.gridType===Pe.ScrollVertical)this.gridster.curRowHeight=this.gridster.curColWidth*this.gridster.$options.rowHeightRatio,t=Pe.ScrollVertical,e=Pe.Fit,i=Pe.ScrollHorizontal,n=Pe.Fixed;else if(this.gridster.$options.gridType===Pe.ScrollHorizontal){let s=this.gridster.$options.rowHeightRatio,a=s>=1?s:s+1;this.gridster.curColWidth=this.gridster.curRowHeight*a,t=Pe.ScrollHorizontal,e=Pe.Fit,i=Pe.ScrollVertical,n=Pe.Fixed}else this.gridster.$options.gridType===Pe.Fixed?(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),t=Pe.Fixed,e=Pe.Fit,i=Pe.ScrollVertical,n=Pe.ScrollHorizontal):this.gridster.$options.gridType===Pe.VerticalFixed?(this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),t=Pe.ScrollVertical,e=Pe.Fit,i=Pe.ScrollHorizontal,n=Pe.Fixed):this.gridster.$options.gridType===Pe.HorizontalFixed&&(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),t=Pe.ScrollHorizontal,e=Pe.Fit,i=Pe.ScrollVertical,n=Pe.Fixed);this.gridster.mobile||this.gridster.$options.setGridSize&&this.gridster.$options.gridType!==Pe.Fit?this.gridster.renderer.removeClass(this.gridster.el,t):this.gridster.renderer.addClass(this.gridster.el,t),this.gridster.renderer.removeClass(this.gridster.el,e),this.gridster.renderer.removeClass(this.gridster.el,i),this.gridster.renderer.removeClass(this.gridster.el,n)}getGridColumnStyle(t){let e={left:this.gridster.curColWidth*t,width:this.gridster.curColWidth-this.gridster.$options.margin,height:this.gridster.gridRows.length*this.gridster.curRowHeight-this.gridster.$options.margin,style:{}};e.style=B(T({},this.getLeftPosition(e.left)),{width:e.width+"px",height:e.height+"px"});let i=this.lastGridColumnStyles[t];return i&&i.left===e.left&&i.width===e.width&&i.height===e.height?i.style:(this.lastGridColumnStyles[t]=e,e.style)}getGridRowStyle(t){let e={top:this.gridster.curRowHeight*t,width:this.gridster.gridColumns.length*this.gridster.curColWidth+this.gridster.$options.margin,height:this.gridster.curRowHeight-this.gridster.$options.margin,style:{}};e.style=B(T({},this.getTopPosition(e.top)),{width:e.width+"px",height:e.height+"px"});let i=this.lastGridRowStyles[t];return i&&i.top===e.top&&i.width===e.width&&i.height===e.height?i.style:(this.lastGridRowStyles[t]=e,e.style)}getLeftPosition(t){let e=this.gridster.$options.dirType===Ft.RTL?-t:t;return this.gridster.$options.useTransformPositioning?{transform:"translateX("+e+"px)"}:{left:this.getLeftMargin()+e+"px"}}getTopPosition(t){return this.gridster.$options.useTransformPositioning?{transform:"translateY("+t+"px)"}:{top:this.getTopMargin()+t+"px"}}clearCellPosition(t,e){this.gridster.$options.useTransformPositioning?t.setStyle(e,"transform",""):(t.setStyle(e,"top",""),t.setStyle(e,"left",""))}setCellPosition(t,e,i,n){let s=this.gridster.$options.dirType===Ft.RTL?-i:i;if(this.gridster.$options.useTransformPositioning){let a="translate3d("+s+"px, "+n+"px, 0)";t.setStyle(e,"transform",a)}else t.setStyle(e,"left",this.getLeftMargin()+s+"px"),t.setStyle(e,"top",this.getTopMargin()+n+"px")}getLeftMargin(){return this.gridster.$options.outerMargin?this.gridster.$options.outerMarginLeft!==null?this.gridster.$options.outerMarginLeft:this.gridster.$options.margin:0}getTopMargin(){return this.gridster.$options.outerMargin?this.gridster.$options.outerMarginTop!==null?this.gridster.$options.outerMarginTop:this.gridster.$options.margin:0}},Qu=(()=>{class r{renderer;previewStyle$;gridRenderer;el;sub;constructor(e,i){this.renderer=i,this.el=e.nativeElement}ngOnInit(){this.sub=this.previewStyle$.subscribe(e=>this.previewStyle(e))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}previewStyle(e){e?(this.renderer.setStyle(this.el,"display","block"),this.gridRenderer.updateItem(this.el,e,this.renderer)):this.renderer.setStyle(this.el,"display","")}static \u0275fac=function(i){return new(i||r)(We(Zr),We(Li))};static \u0275cmp=Oe({type:r,selectors:[["gridster-preview"]],inputs:{previewStyle$:"previewStyle$",gridRenderer:"gridRenderer"},decls:0,vars:0,template:function(i,n){},styles:[`gridster-preview{position:absolute;display:none;background:#00000026}
`],encapsulation:2})}return r})(),Qs=(()=>{class r{renderer;cdRef;zone;options;movingItem;el;$options;mobile;curWidth;curHeight;grid;columns=0;rows=0;curColWidth;curRowHeight;gridColumns=[];gridRows=[];windowResize;dragInProgress;emptyCell;compact;gridRenderer;previewStyle$=new ye;calculateLayout$=new tn;resize$=new tn;destroy$=new tn;constructor(e,i,n,s){this.renderer=i,this.cdRef=n,this.zone=s,this.el=e.nativeElement,this.$options=JSON.parse(JSON.stringify(Zu)),this.mobile=!1,this.curWidth=0,this.curHeight=0,this.grid=[],this.curColWidth=0,this.curRowHeight=0,this.dragInProgress=!1,this.emptyCell=new fo(this),this.compact=new uo(this),this.gridRenderer=new po(this)}static checkCollisionTwoItemsForSwaping(e,i){let n=e.cols===1?0:1,s=i.cols===1?0:1,a=e.rows===1?0:1,o=i.rows===1?0:1;return e.x+n<i.x+i.cols&&e.x+e.cols>i.x+s&&e.y+a<i.y+i.rows&&e.y+e.rows>i.y+o}checkCollisionTwoItems(e,i){if(!(e.x<i.x+i.cols&&e.x+e.cols>i.x&&e.y<i.y+i.rows&&e.y+e.rows>i.y))return!1;if(!this.$options.allowMultiLayer)return!0;let s=this.$options.defaultLayerIndex,a=e.layerIndex===void 0?s:e.layerIndex,o=i.layerIndex===void 0?s:i.layerIndex;return a===o}ngOnInit(){this.options.initCallback&&this.options.initCallback(this),this.calculateLayout$.pipe(Fl(0),zn(this.destroy$)).subscribe(()=>this.calculateLayout()),this.resize$.pipe(ks(()=>Il(100)),zn(this.destroy$)).subscribe(()=>this.resize())}ngOnChanges(e){e.options&&(this.setOptions(),this.options.api={optionsChanged:this.optionsChanged,resize:this.onResize,getNextPossiblePosition:this.getNextPossiblePosition,getFirstPossiblePosition:this.getFirstPossiblePosition,getLastPossiblePosition:this.getLastPossiblePosition,getItemComponent:i=>this.getItemComponent(i)},this.columns=this.$options.minCols,this.rows=this.$options.minRows+this.$options.addEmptyRowsCount,this.setGridSize(),this.calculateLayout())}resize(){let e,i;this.$options.gridType==="fit"&&!this.mobile?(i=this.el.offsetWidth,e=this.el.offsetHeight):(i=this.el.clientWidth,e=this.el.clientHeight),(i!==this.curWidth||e!==this.curHeight)&&this.checkIfToResize()&&this.onResize()}setOptions(){this.$options=Ht.merge(this.$options,this.options,this.$options),!this.$options.disableWindowResize&&!this.windowResize?this.windowResize=this.renderer.listen("window","resize",this.onResize):this.$options.disableWindowResize&&this.windowResize&&(this.windowResize(),this.windowResize=null),this.emptyCell.updateOptions()}optionsChanged=()=>{this.setOptions();let e=this.grid.length-1,i;for(;e>=0;e--)i=this.grid[e],i.updateOptions();this.calculateLayout()};ngOnDestroy(){this.destroy$.next(),this.previewStyle$.complete(),this.windowResize&&this.windowResize(),this.options&&this.options.destroyCallback&&this.options.destroyCallback(this),this.options&&this.options.api&&(this.options.api.resize=void 0,this.options.api.optionsChanged=void 0,this.options.api.getNextPossiblePosition=void 0,this.options.api=void 0),this.emptyCell.destroy(),this.emptyCell=null,this.compact.destroy(),this.compact=null}onResize=()=>{this.el.clientWidth&&(this.options.setGridSize&&(this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.setGridSize(),this.calculateLayout())};checkIfToResize(){let e=this.el.clientWidth,i=this.el.offsetWidth,n=this.el.scrollWidth,s=this.el.clientHeight,a=this.el.offsetHeight,o=this.el.scrollHeight,c=e<i&&o>a&&o-a<i-e,l=s<a&&n>i&&n-i<a-s;return c?!1:!l}checkIfMobile(){return this.$options.useBodyForBreakpoint?this.$options.mobileBreakpoint>document.body.clientWidth:this.$options.mobileBreakpoint>this.curWidth}setGridSize(){let e=this.el,i,n;this.$options.setGridSize||this.$options.gridType===Pe.Fit&&!this.mobile?(i=e.offsetWidth,n=e.offsetHeight):(i=e.clientWidth,n=e.clientHeight),this.curWidth=i,this.curHeight=n}setGridDimensions(){this.setGridSize(),!this.mobile&&this.checkIfMobile()?(this.mobile=!this.mobile,this.renderer.addClass(this.el,"mobile")):this.mobile&&!this.checkIfMobile()&&(this.mobile=!this.mobile,this.renderer.removeClass(this.el,"mobile"));let e=this.$options.minRows,i=this.$options.minCols,n=this.grid.length-1,s;for(;n>=0;n--)s=this.grid[n],s.notPlaced||(e=Math.max(e,s.$item.y+s.$item.rows),i=Math.max(i,s.$item.x+s.$item.cols));e+=this.$options.addEmptyRowsCount,(this.columns!==i||this.rows!==e)&&(this.columns=i,this.rows=e,this.options.gridSizeChangedCallback&&this.options.gridSizeChangedCallback(this))}calculateLayout(){if(this.compact&&this.compact.checkCompact(),this.setGridDimensions(),this.$options.outerMargin){let n=-this.$options.margin;this.$options.outerMarginLeft!==null?(n+=this.$options.outerMarginLeft,this.renderer.setStyle(this.el,"padding-left",this.$options.outerMarginLeft+"px")):(n+=this.$options.margin,this.renderer.setStyle(this.el,"padding-left",this.$options.margin+"px")),this.$options.outerMarginRight!==null?(n+=this.$options.outerMarginRight,this.renderer.setStyle(this.el,"padding-right",this.$options.outerMarginRight+"px")):(n+=this.$options.margin,this.renderer.setStyle(this.el,"padding-right",this.$options.margin+"px")),this.curColWidth=(this.curWidth-n)/this.columns;let s=-this.$options.margin;this.$options.outerMarginTop!==null?(s+=this.$options.outerMarginTop,this.renderer.setStyle(this.el,"padding-top",this.$options.outerMarginTop+"px")):(s+=this.$options.margin,this.renderer.setStyle(this.el,"padding-top",this.$options.margin+"px")),this.$options.outerMarginBottom!==null?(s+=this.$options.outerMarginBottom,this.renderer.setStyle(this.el,"padding-bottom",this.$options.outerMarginBottom+"px")):(s+=this.$options.margin,this.renderer.setStyle(this.el,"padding-bottom",this.$options.margin+"px")),this.curRowHeight=(this.curHeight-s)/this.rows*this.$options.rowHeightRatio}else this.curColWidth=(this.curWidth+this.$options.margin)/this.columns,this.curRowHeight=(this.curHeight+this.$options.margin)/this.rows*this.$options.rowHeightRatio,this.renderer.setStyle(this.el,"padding-left","0px"),this.renderer.setStyle(this.el,"padding-right","0px"),this.renderer.setStyle(this.el,"padding-top","0px"),this.renderer.setStyle(this.el,"padding-bottom","0px");this.gridRenderer.updateGridster(),this.$options.setGridSize?(this.renderer.addClass(this.el,"gridSize"),this.mobile||(this.renderer.setStyle(this.el,"width",this.columns*this.curColWidth+this.$options.margin+"px"),this.renderer.setStyle(this.el,"height",this.rows*this.curRowHeight+this.$options.margin+"px"))):(this.renderer.removeClass(this.el,"gridSize"),this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.updateGrid();let e=this.grid.length-1,i;for(;e>=0;e--)i=this.grid[e],i.setSize(),i.drag.toggle(),i.resize.toggle();this.resize$.next()}updateGrid(){this.$options.displayGrid==="always"&&!this.mobile?this.renderer.addClass(this.el,"display-grid"):this.$options.displayGrid==="onDrag&Resize"&&this.dragInProgress?this.renderer.addClass(this.el,"display-grid"):(this.$options.displayGrid==="none"||!this.dragInProgress||this.mobile)&&this.renderer.removeClass(this.el,"display-grid"),this.setGridDimensions(),this.gridColumns.length=r.getNewArrayLength(this.columns,this.curWidth,this.curColWidth),this.gridRows.length=r.getNewArrayLength(this.rows,this.curHeight,this.curRowHeight),this.cdRef.markForCheck()}addItem(e){e.$item.cols===void 0&&(e.$item.cols=this.$options.defaultItemCols,e.item.cols=e.$item.cols,e.itemChanged()),e.$item.rows===void 0&&(e.$item.rows=this.$options.defaultItemRows,e.item.rows=e.$item.rows,e.itemChanged()),e.$item.x===-1||e.$item.y===-1?this.autoPositionItem(e):this.checkCollision(e.$item)&&(this.$options.disableWarnings||(e.notPlaced=!0,console.warn("Can't be placed in the bounds of the dashboard, trying to auto position!/n"+JSON.stringify(e.item,["cols","rows","x","y"]))),this.$options.disableAutoPositionOnConflict?e.notPlaced=!0:this.autoPositionItem(e)),this.grid.push(e),this.calculateLayout$.next()}removeItem(e){this.grid.splice(this.grid.indexOf(e),1),this.calculateLayout$.next(),this.options.itemRemovedCallback&&this.options.itemRemovedCallback(e.item,e)}checkCollision(e,i){let n=!1;if(this.options.itemValidateCallback&&(n=!this.options.itemValidateCallback(e)),!n&&this.checkGridCollision(e,i)&&(n=!0),!n){let s=this.findItemWithItem(e);s&&(n=s)}return n}checkGridCollision(e,i=!1){let n=e.y>-1&&e.x>-1,s=e.cols+e.x<=this.$options.maxCols,a=e.rows+e.y<=this.$options.maxRows,o=e.maxItemCols===void 0?this.$options.maxItemCols:e.maxItemCols,c=e.minItemCols===void 0?this.$options.minItemCols:e.minItemCols,l=e.maxItemRows===void 0?this.$options.maxItemRows:e.maxItemRows,h=e.minItemRows===void 0?this.$options.minItemRows:e.minItemRows,u=e.cols<=o&&e.cols>=c,f=e.rows<=l&&e.rows>=h,p=!0;if(i){let A=e.itemAspectRatio||this.$options.itemAspectRatio;A&&(p=e.cols/e.rows===A)}let x=e.minItemArea===void 0?this.$options.minItemArea:e.minItemArea,d=e.maxItemArea===void 0?this.$options.maxItemArea:e.maxItemArea,g=e.cols*e.rows,I=x<=g,O=d>=g;return!(n&&s&&a&&p&&u&&f&&I&&O)}findItemWithItem(e){let i=0,n;for(;i<this.grid.length;i++)if(n=this.grid[i],n.$item!==e&&this.checkCollisionTwoItems(n.$item,e))return n;return!1}findItemsWithItem(e){let i=[],n=0,s;for(;n<this.grid.length;n++)s=this.grid[n],s.$item!==e&&this.checkCollisionTwoItems(s.$item,e)&&i.push(s);return i}autoPositionItem(e){this.getNextPossiblePosition(e.$item)?(e.notPlaced=!1,e.item.x=e.$item.x,e.item.y=e.$item.y,e.itemChanged()):(e.notPlaced=!0,this.$options.disableWarnings||console.warn("Can't be placed in the bounds of the dashboard!/n"+JSON.stringify(e.item,["cols","rows","x","y"])))}getNextPossiblePosition=(e,i={})=>{e.cols===-1&&(e.cols=this.$options.defaultItemCols),e.rows===-1&&(e.rows=this.$options.defaultItemRows),this.setGridDimensions();let n=i.y||0,s;for(;n<this.rows;n++)for(e.y=n,s=i.x||0;s<this.columns;s++)if(e.x=s,!this.checkCollision(e))return!0;let a=this.$options.maxRows>=this.rows+e.rows,o=this.$options.maxCols>=this.columns+e.cols;return!(this.rows<=this.columns&&a)&&o?(e.x=this.columns,e.y=0,!0):a?(e.y=this.rows,e.x=0,!0):!1};getFirstPossiblePosition=e=>{let i=Object.assign({},e);return this.getNextPossiblePosition(i),i};getLastPossiblePosition=e=>{let i={y:0,x:0};i=this.grid.reduce((s,a)=>{let o={y:a.$item.y+a.$item.rows-1,x:a.$item.x+a.$item.cols-1};return Ht.compareItems(s,o)===1?o:s},i);let n=Object.assign({},e);return this.getNextPossiblePosition(n,i),n};pixelsToPositionX(e,i,n){let s=i(e/this.curColWidth);return n?s:Math.max(s,0)}pixelsToPositionY(e,i,n){let s=i(e/this.curRowHeight);return n?s:Math.max(s,0)}positionXToPixels(e){return e*this.curColWidth}positionYToPixels(e){return e*this.curRowHeight}getItemComponent(e){return this.grid.find(i=>i.item===e)}checkCollisionForSwaping(e){let i=!1;if(this.options.itemValidateCallback&&(i=!this.options.itemValidateCallback(e)),!i&&this.checkGridCollision(e)&&(i=!0),!i){let n=this.findItemWithItemForSwapping(e);n&&(i=n)}return i}findItemWithItemForSwapping(e){let i=this.grid.length-1,n;for(;i>-1;i--)if(n=this.grid[i],n.$item!==e&&r.checkCollisionTwoItemsForSwaping(n.$item,e))return n;return!1}previewStyle(e=!1){this.movingItem?(this.compact&&e&&this.compact.checkCompactItem(this.movingItem),this.previewStyle$.next(this.movingItem)):this.previewStyle$.next(null)}static getNewArrayLength(e,i,n){let s=Math.max(e,Math.floor(i/n));return s<0?0:Number.isFinite(s)?Math.floor(s):0}static \u0275fac=function(i){return new(i||r)(We(Zr),We(Li),We($r),We(Gn))};static \u0275cmp=Oe({type:r,selectors:[["gridster"]],inputs:{options:"options"},features:[Ar],ngContentSelectors:Tc,decls:6,vars:2,consts:[[1,"gridster-column",3,"ngStyle"],[1,"gridster-row",3,"ngStyle"],[1,"gridster-preview",3,"gridRenderer","previewStyle$"]],template:function(i,n){i&1&&(Xn(),Ri(0,Wu,1,1,"div",0,Ga),Ri(2,$u,1,1,"div",1,Ga),jn(4),xe(5,"gridster-preview",2)),i&2&&(Ni(n.gridColumns),S(2),Ni(n.gridRows),S(3),M("gridRenderer",n.gridRenderer)("previewStyle$",n.previewStyle$))},dependencies:[Bi,Qu],styles:[`gridster{position:relative;box-sizing:border-box;background:gray;width:100%;height:100%;-webkit-user-select:none;user-select:none;display:block}gridster.fit{overflow-x:hidden;overflow-y:hidden}gridster.scrollVertical{overflow-x:hidden;overflow-y:auto}gridster.scrollHorizontal{overflow-x:auto;overflow-y:hidden}gridster.fixed{overflow:auto}gridster.mobile{overflow-x:hidden;overflow-y:auto}gridster.mobile gridster-item{position:relative}gridster.gridSize{height:initial;width:initial}gridster.gridSize.fit{height:100%;width:100%}gridster .gridster-column,gridster .gridster-row{position:absolute;display:none;transition:.3s;box-sizing:border-box}gridster.display-grid .gridster-column,gridster.display-grid .gridster-row{display:block}gridster .gridster-column{border-left:1px solid white;border-right:1px solid white}gridster .gridster-row{border-top:1px solid white;border-bottom:1px solid white}
`],encapsulation:2})}return r})(),Zs=class{fromSouth;fromNorth;fromEast;fromWest;pushedItems;pushedItemsTemp;pushedItemsTempPath;pushedItemsPath;gridsterItem;gridster;pushedItemsOrder;tryPattern;iteration=0;constructor(t){this.pushedItems=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],this.pushedItemsPath=[],this.gridsterItem=t,this.gridster=t.gridster,this.tryPattern={fromEast:[this.tryWest,this.trySouth,this.tryNorth,this.tryEast],fromWest:[this.tryEast,this.trySouth,this.tryNorth,this.tryWest],fromNorth:[this.trySouth,this.tryEast,this.tryWest,this.tryNorth],fromSouth:[this.tryNorth,this.tryEast,this.tryWest,this.trySouth]},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(t,e){if(this.gridster.$options.pushItems&&!e){this.pushedItemsOrder=[],this.iteration=0;let i=this.push(this.gridsterItem,t);return i||this.restoreTempItems(),this.pushedItemsOrder=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],i}else return!1}restoreTempItems(){let t=this.pushedItemsTemp.length-1;for(;t>-1;t--)this.removeFromTempPushed(this.pushedItemsTemp[t])}restoreItems(){let t=0,e=this.pushedItems.length,i;for(;t<e;t++)i=this.pushedItems[t],i.$item.x=i.item.x||0,i.$item.y=i.item.y||0,i.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let t=0,e=this.pushedItems.length,i;for(;t<e;t++)i=this.pushedItems[t],i.checkItemChanges(i.$item,i.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let t=this.pushedItems.length-1,e=!1;for(;t>-1;t--)this.checkPushedItem(this.pushedItems[t],t)&&(e=!0);e&&this.checkPushBack()}push(t,e){if(this.iteration>100)return console.warn("max iteration reached"),!1;if(this.gridster.checkGridCollision(t.$item)||e==="")return!1;let i=this.gridster.findItemsWithItem(t.$item),n=e===this.fromNorth||e===this.fromWest;i.sort((l,h)=>n?h.$item.y-l.$item.y||h.$item.x-l.$item.x:l.$item.y-h.$item.y||l.$item.x-h.$item.x);let s=0,a,o=!0,c=[];for(;s<i.length;s++){if(a=i[s],a===this.gridsterItem)continue;if(!a.canBeDragged()){o=!1;break}let l=this.pushedItemsTemp.indexOf(a);if(l>-1&&this.pushedItemsTempPath[l].length>10){o=!1;break}if(this.tryPattern[e][0].call(this,a,t))this.pushedItemsOrder.push(a),c.push(a);else if(this.tryPattern[e][1].call(this,a,t))this.pushedItemsOrder.push(a),c.push(a);else if(this.tryPattern[e][2].call(this,a,t))this.pushedItemsOrder.push(a),c.push(a);else if(this.tryPattern[e][3].call(this,a,t))this.pushedItemsOrder.push(a),c.push(a);else{o=!1;break}}if(!o&&(s=this.pushedItemsOrder.lastIndexOf(c[0]),s>-1)){let l=this.pushedItemsOrder.length-1;for(;l>=s;l--)a=this.pushedItemsOrder[l],this.pushedItemsOrder.pop(),this.removeFromTempPushed(a),this.removeFromPushedItem(a)}return this.iteration++,o}trySouth(t,e){return this.gridster.$options.pushDirections.south?(this.addToTempPushed(t),t.$item.y=e.$item.y+e.$item.rows,this.push(t,this.fromNorth)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1)):!1}tryNorth(t,e){return this.gridster.$options.pushDirections.north?(this.addToTempPushed(t),t.$item.y=e.$item.y-t.$item.rows,this.push(t,this.fromSouth)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1)):!1}tryEast(t,e){return this.gridster.$options.pushDirections.east?(this.addToTempPushed(t),t.$item.x=e.$item.x+e.$item.cols,this.push(t,this.fromWest)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1)):!1}tryWest(t,e){return this.gridster.$options.pushDirections.west?(this.addToTempPushed(t),t.$item.x=e.$item.x-t.$item.cols,this.push(t,this.fromEast)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1)):!1}addToTempPushed(t){let e=this.pushedItemsTemp.indexOf(t);e===-1&&(e=this.pushedItemsTemp.push(t)-1,this.pushedItemsTempPath[e]=[]),this.pushedItemsTempPath[e].push({x:t.$item.x,y:t.$item.y})}removeFromTempPushed(t){let e=this.pushedItemsTemp.indexOf(t),i=this.pushedItemsTempPath[e].pop();i&&(t.$item.x=i.x,t.$item.y=i.y,t.setSize(),this.pushedItemsTempPath[e].length||(this.pushedItemsTemp.splice(e,1),this.pushedItemsTempPath.splice(e,1)))}addToPushed(t){if(this.pushedItems.indexOf(t)<0)this.pushedItems.push(t),this.pushedItemsPath.push([{x:t.item.x||0,y:t.item.y||0},{x:t.$item.x,y:t.$item.y}]);else{let e=this.pushedItems.indexOf(t);this.pushedItemsPath[e].push({x:t.$item.x,y:t.$item.y})}}removeFromPushed(t){t>-1&&(this.pushedItems.splice(t,1),this.pushedItemsPath.splice(t,1))}removeFromPushedItem(t){let e=this.pushedItems.indexOf(t);e>-1&&(this.pushedItemsPath[e].pop(),this.pushedItemsPath.length||(this.pushedItems.splice(e,1),this.pushedItemsPath.splice(e,1)))}checkPushedItem(t,e){let i=this.pushedItemsPath[e],n=i.length-2,s,a,o,c=!1;for(;n>-1;n--)s=i[n],a=t.$item.x,o=t.$item.y,t.$item.x=s.x,t.$item.y=s.y,this.gridster.findItemWithItem(t.$item)?(t.$item.x=a,t.$item.y=o):(t.setSize(),i.splice(n+1,i.length-n-1),c=!0);return i.length<2&&this.removeFromPushed(e),c}},Qn,$i,Ec=50,Sr,Jn,ni,es,ts,rs,is;function kc(r,t,e,i,n,s,a,o,c,l){Qn=r.$options.scrollSensitivity,$i=r.$options.scrollSpeed,Sr=r.el,Jn=c,ni=l;let h=Sr.offsetWidth,u=Sr.offsetHeight,f=Sr.scrollLeft,p=Sr.scrollTop,x=e-p,d=u+p-e-n,{clientX:g,clientY:I}=s;if(!r.$options.disableScrollVertical)if(a.clientY<I&&d<Qn){if(Dc(),Jn&&ni&&!ni.south||is)return;is=bc(1,o,a)}else if(a.clientY>I&&p>0&&x<Qn){if(Ac(),Jn&&ni&&!ni.north||rs)return;rs=bc(-1,o,a)}else a.clientY!==I&&yo();let O=f+h-t-i,A=t-f;if(!r.$options.disableScrollHorizontal)if(a.clientX<g&&O<=Qn){if(Oc(),Jn&&ni&&!ni.east||es)return;es=Sc(1,o,a)}else if(a.clientX>g&&f>0&&A<Qn){if(Fc(),Jn&&ni&&!ni.west||ts)return;ts=Sc(-1,o,a)}else a.clientX!==g&&_o()}function bc(r,t,e){let i=e.clientY;return window.setInterval(()=>{(!Sr||r===-1&&Sr.scrollTop-$i<0)&&yo(),Sr.scrollTop+=r*$i,i+=r*$i,t({clientX:e.clientX,clientY:i})},Ec)}function Sc(r,t,e){let i=e.clientX;return window.setInterval(()=>{(!Sr||r===-1&&Sr.scrollLeft-$i<0)&&_o(),Sr.scrollLeft+=r*$i,i+=r*$i,t({clientX:i,clientY:e.clientY})},Ec)}function Ic(){_o(),yo(),Sr=null}function _o(){Fc(),Oc()}function yo(){Dc(),Ac()}function Fc(){es&&(clearInterval(es),es=0)}function Oc(){ts&&(clearInterval(ts),ts=0)}function Ac(){is&&(clearInterval(is),is=0)}function Dc(){rs&&(clearInterval(rs),rs=0)}var mo=class{swapedItem;gridsterItem;gridster;constructor(t){this.gridsterItem=t,this.gridster=t.gridster}destroy(){this.gridster=this.gridsterItem=this.swapedItem=null}swapItems(){this.gridster.$options.swap&&(this.checkSwapBack(),this.checkSwap(this.gridsterItem))}checkSwapBack(){if(this.swapedItem){let t=this.swapedItem.$item.x,e=this.swapedItem.$item.y;this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.gridster.checkCollision(this.swapedItem.$item)?(this.swapedItem.$item.x=t,this.swapedItem.$item.y=e):(this.swapedItem.setSize(),this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.swapedItem=void 0)}}restoreSwapItem(){this.swapedItem&&(this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.swapedItem.setSize(),this.swapedItem=void 0)}setSwapItem(){this.swapedItem&&(this.swapedItem.checkItemChanges(this.swapedItem.$item,this.swapedItem.item),this.swapedItem=void 0)}checkSwap(t){let e;if(this.gridster.$options.swapWhileDragging?e=this.gridster.checkCollisionForSwaping(t.$item):e=this.gridster.checkCollision(t.$item),e&&e!==!0&&e.canBeDragged()){let i=e,n=i.$item.x,s=i.$item.y,a=t.$item.x,o=t.$item.y,c=a-n,l=o-s;i.$item.x=t.item.x-c,i.$item.y=t.item.y-l,t.$item.x=i.item.x+c,t.$item.y=i.item.y+l,this.gridster.checkCollision(i.$item)||this.gridster.checkCollision(t.$item)?(t.$item.x=a,t.$item.y=o,i.$item.x=n,i.$item.y=s):(i.setSize(),this.swapedItem=i,this.gridster.$options.swapWhileDragging&&(this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.setSwapItem()))}}},Ju="gridster-item-resizable-handler",fr=function(r){return r.UP="UP",r.DOWN="DOWN",r.LEFT="LEFT",r.RIGHT="RIGHT",r}(fr||{}),go=class{zone;gridsterItem;gridster;lastMouse;offsetLeft;offsetTop;margin;outerMarginTop;outerMarginRight;outerMarginBottom;outerMarginLeft;diffTop;diffLeft;originalClientX;originalClientY;top;left;height;width;positionX;positionY;positionXBackup;positionYBackup;enabled;mousemove;mouseup;mouseleave;cancelOnBlur;touchmove;touchend;touchcancel;mousedown;touchstart;push;swap;path;collision=!1;constructor(t,e,i){this.zone=i,this.gridsterItem=t,this.gridster=e,this.lastMouse={clientX:0,clientY:0},this.path=[]}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(!0),this.gridsterItem=this.gridster=this.collision=null,this.mousedown&&(this.mousedown(),this.touchstart())}dragStart(t){t.which&&t.which!==1||(this.gridster.options.draggable&&this.gridster.options.draggable.start&&this.gridster.options.draggable.start(this.gridsterItem.item,this.gridsterItem,t),t.stopPropagation(),t.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-moving"),this.margin=this.gridster.$options.margin,this.outerMarginTop=this.gridster.$options.outerMarginTop,this.outerMarginRight=this.gridster.$options.outerMarginRight,this.outerMarginBottom=this.gridster.$options.outerMarginBottom,this.outerMarginLeft=this.gridster.$options.outerMarginLeft,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.left=this.gridsterItem.left-this.margin,this.top=this.gridsterItem.top-this.margin,this.originalClientX=t.clientX,this.originalClientY=t.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.gridster.$options.dirType===Ft.RTL?this.diffLeft=t.clientX-this.gridster.el.scrollWidth+this.gridsterItem.left:this.diffLeft=t.clientX+this.offsetLeft-this.margin-this.left,this.diffTop=t.clientY+this.offsetTop-this.margin-this.top,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(!0),this.push=new Zs(this.gridsterItem),this.swap=new mo(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid(),this.path.push({x:this.gridsterItem.item.x||0,y:this.gridsterItem.item.y||0}))}dragMove=t=>{t.stopPropagation(),t.preventDefault(),Ht.checkTouchEvent(t);let e=this.getDirections(t);this.gridster.options.enableBoundaryControl&&(e.includes(fr.UP)&&this.gridsterItem.el.getBoundingClientRect().top<this.gridster.el.getBoundingClientRect().top+(this.outerMarginTop??this.margin)&&(e=e.filter(i=>i!=fr.UP),t=new MouseEvent(t.type,{clientX:t.clientX,clientY:this.lastMouse.clientY})),e.includes(fr.LEFT)&&this.gridsterItem.el.getBoundingClientRect().left<this.gridster.el.getBoundingClientRect().left+(this.outerMarginLeft??this.margin)&&(e=e.filter(i=>i!=fr.LEFT),t=new MouseEvent(t.type,{clientX:this.lastMouse.clientX,clientY:t.clientY})),e.includes(fr.RIGHT)&&this.gridsterItem.el.getBoundingClientRect().right>this.gridster.el.getBoundingClientRect().right-(this.outerMarginRight??this.margin)&&(e=e.filter(i=>i!=fr.RIGHT),t=new MouseEvent(t.type,{clientX:this.lastMouse.clientX,clientY:t.clientY})),e.includes(fr.DOWN)&&this.gridsterItem.el.getBoundingClientRect().bottom>this.gridster.el.getBoundingClientRect().bottom-(this.outerMarginBottom??this.margin)&&(e=e.filter(i=>i!=fr.DOWN),t=new MouseEvent(t.type,{clientX:t.clientX,clientY:this.lastMouse.clientY}))),e.length&&(this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,kc(this.gridster,this.left,this.top,this.width,this.height,t,this.lastMouse,this.calculateItemPositionFromMousePosition),this.calculateItemPositionFromMousePosition(t))};calculateItemPositionFromMousePosition=t=>{this.gridster.options.scale?this.calculateItemPositionWithScale(t,this.gridster.options.scale):this.calculateItemPositionWithoutScale(t),this.calculateItemPosition(),this.lastMouse.clientX=t.clientX,this.lastMouse.clientY=t.clientY,this.zone.run(()=>{this.gridster.updateGrid()})};calculateItemPositionWithScale(t,e){this.gridster.$options.dirType===Ft.RTL?this.left=this.gridster.el.scrollWidth-this.originalClientX+(t.clientX-this.originalClientX)/e+this.diffLeft:this.left=this.originalClientX+(t.clientX-this.originalClientX)/e+this.offsetLeft-this.diffLeft,this.top=this.originalClientY+(t.clientY-this.originalClientY)/e+this.offsetTop-this.diffTop}calculateItemPositionWithoutScale(t){this.gridster.$options.dirType===Ft.RTL?this.left=this.gridster.el.scrollWidth-t.clientX+this.diffLeft:this.left=t.clientX+this.offsetLeft-this.diffLeft,this.top=t.clientY+this.offsetTop-this.diffTop}dragStop=t=>{t.stopPropagation(),t.preventDefault(),Ic(),this.cancelOnBlur(),this.mousemove(),this.mouseup(),this.mouseleave(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-moving"),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.path=[],this.gridster.options.draggable&&this.gridster.options.draggable.stop?Promise.resolve(this.gridster.options.draggable.stop(this.gridsterItem.item,this.gridsterItem,t)).then(this.makeDrag,this.cancelDrag):this.makeDrag(),setTimeout(()=>{this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle(!0))})};cancelDrag=()=>{this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push&&this.push.restoreItems(),this.swap&&this.swap.restoreSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)};makeDrag=()=>{this.gridster.$options.draggable.dropOverItems&&this.gridster.options.draggable&&this.gridster.options.draggable.dropOverItemsCallback&&this.collision&&this.collision!==!0&&this.collision.$item&&this.gridster.options.draggable.dropOverItemsCallback(this.gridsterItem.item,this.collision.item,this.gridster),this.collision=!1,this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push&&this.push.setPushedItems(),this.swap&&this.swap.setSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)};calculateItemPosition(){if(this.gridster.movingItem=this.gridsterItem.$item,this.positionX=this.gridster.pixelsToPositionX(this.left,Math.round),this.positionY=this.gridster.pixelsToPositionY(this.top,Math.round),this.positionXBackup=this.gridsterItem.$item.x,this.positionYBackup=this.gridsterItem.$item.y,this.gridsterItem.$item.x=this.positionX,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.x=this.positionXBackup),this.gridsterItem.$item.y=this.positionY,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.y=this.positionYBackup),this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,this.top),this.positionXBackup!==this.gridsterItem.$item.x||this.positionYBackup!==this.gridsterItem.$item.y){let t=this.path[this.path.length-1],e="";t.x<this.gridsterItem.$item.x?e=this.push.fromWest:t.x>this.gridsterItem.$item.x?e=this.push.fromEast:t.y<this.gridsterItem.$item.y?e=this.push.fromNorth:t.y>this.gridsterItem.$item.y&&(e=this.push.fromSouth),this.push.pushItems(e,this.gridster.$options.disablePushOnDrag),this.swap.swapItems(),this.collision=this.gridster.checkCollision(this.gridsterItem.$item),this.collision?(this.gridsterItem.$item.x=this.positionXBackup,this.gridsterItem.$item.y=this.positionYBackup,this.gridster.$options.draggable.dropOverItems&&this.collision!==!0&&this.collision.$item&&(this.gridster.movingItem=null)):this.path.push({x:this.gridsterItem.$item.x,y:this.gridsterItem.$item.y}),this.push.checkPushBack()}else this.collision=!1;this.gridster.previewStyle(!0)}toggle(){let t=this.gridsterItem.canBeDragged();!this.enabled&&t?(this.enabled=!this.enabled,this.mousedown=this.gridsterItem.renderer.listen(this.gridsterItem.el,"mousedown",this.dragStartDelay),this.touchstart=this.gridsterItem.renderer.listen(this.gridsterItem.el,"touchstart",this.dragStartDelay)):this.enabled&&!t&&(this.enabled=!this.enabled,this.mousedown(),this.touchstart())}dragStartDelay=t=>{if(t.target.classList.contains(Ju)||Ht.checkContentClassForEvent(this.gridster,t))return;if(Ht.checkTouchEvent(t),!this.gridster.$options.draggable.delayStart){this.dragStart(t);return}let i=setTimeout(()=>{this.dragStart(t),u()},this.gridster.$options.draggable.delayStart),n=this.gridsterItem.renderer.listen("document","mouseup",u),s=this.gridsterItem.renderer.listen("document","mouseleave",u),a=this.gridsterItem.renderer.listen("window","blur",u),o=this.gridsterItem.renderer.listen("document","touchmove",h),c=this.gridsterItem.renderer.listen("document","touchend",u),l=this.gridsterItem.renderer.listen("document","touchcancel",u);function h(f){Ht.checkTouchEvent(f),(Math.abs(f.clientX-t.clientX)>9||Math.abs(f.clientY-t.clientY)>9)&&u()}function u(){clearTimeout(i),a(),n(),s(),o(),c(),l()}};getDirections(t){let e=[];return this.lastMouse.clientX===0&&this.lastMouse.clientY===0&&(this.lastMouse.clientY=t.clientY,this.lastMouse.clientX=t.clientX),this.lastMouse.clientY>t.clientY&&e.push(fr.UP),this.lastMouse.clientY<t.clientY&&e.push(fr.DOWN),this.lastMouse.clientX<t.clientX&&e.push(fr.RIGHT),this.lastMouse.clientX>t.clientX&&e.push(fr.LEFT),e}},xo=class{fromSouth;fromNorth;fromEast;fromWest;pushedItems;pushedItemsPath;gridsterItem;gridster;tryPattern;constructor(t){this.pushedItems=[],this.pushedItemsPath=[],this.gridsterItem=t,this.gridster=t.gridster,this.tryPattern={fromEast:this.tryWest,fromWest:this.tryEast,fromNorth:this.trySouth,fromSouth:this.tryNorth},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(t){return this.gridster.$options.pushResizeItems?this.push(this.gridsterItem,t):!1}restoreItems(){let t=0,e=this.pushedItems.length,i;for(;t<e;t++)i=this.pushedItems[t],i.$item.x=i.item.x||0,i.$item.y=i.item.y||0,i.$item.cols=i.item.cols||1,i.$item.row=i.item.row||1,i.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let t=0,e=this.pushedItems.length,i;for(;t<e;t++)i=this.pushedItems[t],i.checkItemChanges(i.$item,i.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let t=this.pushedItems.length-1,e=!1;for(;t>-1;t--)this.checkPushedItem(this.pushedItems[t],t)&&(e=!0);e&&this.checkPushBack()}push(t,e){let i=this.gridster.checkCollision(t.$item);if(i&&i!==!0&&i!==this.gridsterItem&&i.canBeResized()){if(this.tryPattern[e].call(this,i,t,e))return!0}else if(i===!1)return!0;return!1}trySouth(t,e,i){let n=t.$item.y,s=t.$item.rows;return t.$item.y=e.$item.y+e.$item.rows,t.$item.rows=s+n-t.$item.y,!this.gridster.checkCollisionTwoItems(t.$item,e.$item)&&!this.gridster.checkGridCollision(t.$item)?(t.setSize(),this.addToPushed(t),this.push(e,i),!0):(t.$item.y=n,t.$item.rows=s,!1)}tryNorth(t,e,i){let n=t.$item.rows;return t.$item.rows=e.$item.y-t.$item.y,!this.gridster.checkCollisionTwoItems(t.$item,e.$item)&&!this.gridster.checkGridCollision(t.$item)?(t.setSize(),this.addToPushed(t),this.push(e,i),!0):(t.$item.rows=n,!1)}tryEast(t,e,i){let n=t.$item.x,s=t.$item.cols;return t.$item.x=e.$item.x+e.$item.cols,t.$item.cols=s+n-t.$item.x,!this.gridster.checkCollisionTwoItems(t.$item,e.$item)&&!this.gridster.checkGridCollision(t.$item)?(t.setSize(),this.addToPushed(t),this.push(e,i),!0):(t.$item.x=n,t.$item.cols=s,!1)}tryWest(t,e,i){let n=t.$item.cols;return t.$item.cols=e.$item.x-t.$item.x,!this.gridster.checkCollisionTwoItems(t.$item,e.$item)&&!this.gridster.checkGridCollision(t.$item)?(t.setSize(),this.addToPushed(t),this.push(e,i),!0):(t.$item.cols=n,!1)}addToPushed(t){if(this.pushedItems.indexOf(t)<0)this.pushedItems.push(t),this.pushedItemsPath.push([{x:t.item.x||0,y:t.item.y||0,cols:t.item.cols||0,rows:t.item.rows||0},{x:t.$item.x,y:t.$item.y,cols:t.$item.cols,rows:t.$item.rows}]);else{let e=this.pushedItems.indexOf(t);this.pushedItemsPath[e].push({x:t.$item.x,y:t.$item.y,cols:t.$item.cols,rows:t.$item.rows})}}removeFromPushed(t){t>-1&&(this.pushedItems.splice(t,1),this.pushedItemsPath.splice(t,1))}checkPushedItem(t,e){let i=this.pushedItemsPath[e],n=i.length-2,s,a,o,c,l;for(;n>-1;n--)s=i[n],a=t.$item.x,o=t.$item.y,c=t.$item.cols,l=t.$item.rows,t.$item.x=s.x,t.$item.y=s.y,t.$item.cols=s.cols,t.$item.rows=s.rows,this.gridster.findItemWithItem(t.$item)?(t.$item.x=a,t.$item.y=o,t.$item.cols=c,t.$item.rows=l):(t.setSize(),i.splice(n+1,i.length-1-n));return i.length<2?(this.removeFromPushed(e),!0):!1}},vo=class{zone;gridsterItem;gridster;lastMouse;itemBackup;resizeEventScrollType;directionFunction=null;resizeEnabled;resizableHandles;mousemove;mouseup;mouseleave;cancelOnBlur;touchmove;touchend;touchcancel;push;pushResize;minHeight;minWidth;offsetTop;offsetLeft;diffTop;diffLeft;diffRight;diffBottom;margin;outerMarginTop;outerMarginRight;outerMarginBottom;outerMarginLeft;originalClientX;originalClientY;top;left;bottom;right;width;height;newPosition;constructor(t,e,i){this.zone=i,this.gridsterItem=t,this.gridster=e,this.lastMouse={clientX:0,clientY:0},this.itemBackup=[0,0,0,0],this.resizeEventScrollType={west:!1,east:!1,north:!1,south:!1}}destroy(){this.gridster?.previewStyle(),this.gridster=this.gridsterItem=null}dragStart(t){if(t.which&&t.which!==1)return;this.gridster.options.resizable&&this.gridster.options.resizable.start&&this.gridster.options.resizable.start(this.gridsterItem.item,this.gridsterItem,t),t.stopPropagation(),t.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-resizing"),this.lastMouse.clientX=t.clientX,this.lastMouse.clientY=t.clientY,this.left=this.gridsterItem.left,this.top=this.gridsterItem.top,this.originalClientX=t.clientX,this.originalClientY=t.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.bottom=this.gridsterItem.top+this.gridsterItem.height,this.right=this.gridsterItem.left+this.gridsterItem.width,this.margin=this.gridster.$options.margin,this.outerMarginTop=this.gridster.$options.outerMarginTop,this.outerMarginRight=this.gridster.$options.outerMarginRight,this.outerMarginBottom=this.gridster.$options.outerMarginBottom,this.outerMarginLeft=this.gridster.$options.outerMarginLeft,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.diffLeft=t.clientX+this.offsetLeft-this.left,this.diffRight=t.clientX+this.offsetLeft-this.right,this.diffTop=t.clientY+this.offsetTop-this.top,this.diffBottom=t.clientY+this.offsetTop-this.bottom,this.minHeight=this.gridster.positionYToPixels(this.gridsterItem.$item.minItemRows||this.gridster.$options.minItemRows)-this.margin,this.minWidth=this.gridster.positionXToPixels(this.gridsterItem.$item.minItemCols||this.gridster.$options.minItemCols)-this.margin,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(),this.push=new Zs(this.gridsterItem),this.pushResize=new xo(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid();let{classList:e}=t.target;e.contains("handle-n")?(this.resizeEventScrollType.north=!0,this.directionFunction=this.handleNorth):e.contains("handle-w")?this.gridster.$options.dirType===Ft.RTL?(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):e.contains("handle-s")?(this.resizeEventScrollType.south=!0,this.directionFunction=this.handleSouth):e.contains("handle-e")?this.gridster.$options.dirType===Ft.RTL?(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):e.contains("handle-nw")?this.gridster.$options.dirType===Ft.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):e.contains("handle-ne")?this.gridster.$options.dirType===Ft.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):e.contains("handle-sw")?this.gridster.$options.dirType===Ft.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):e.contains("handle-se")&&(this.gridster.$options.dirType===Ft.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast))}dragMove=t=>{if(this.directionFunction===null)throw new Error("The `directionFunction` has not been set before calling `dragMove`.");t.stopPropagation(),t.preventDefault(),Ht.checkTouchEvent(t),this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,kc(this.gridster,this.left,this.top,this.width,this.height,t,this.lastMouse,this.directionFunction,!0,this.resizeEventScrollType);let e=this.gridster.options.scale||1;this.directionFunction({clientX:this.originalClientX+(t.clientX-this.originalClientX)/e,clientY:this.originalClientY+(t.clientY-this.originalClientY)/e}),this.lastMouse.clientX=t.clientX,this.lastMouse.clientY=t.clientY,this.zone.run(()=>{this.gridster.updateGrid()})};dragStop=t=>{t.stopPropagation(),t.preventDefault(),Ic(),this.mousemove(),this.mouseup(),this.mouseleave(),this.cancelOnBlur(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.gridster.options.resizable&&this.gridster.options.resizable.stop?Promise.resolve(this.gridster.options.resizable.stop(this.gridsterItem.item,this.gridsterItem,t)).then(this.makeResize,this.cancelResize):this.makeResize(),setTimeout(()=>{this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-resizing"),this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())})};cancelResize=()=>{this.gridsterItem.$item.cols=this.gridsterItem.item.cols||1,this.gridsterItem.$item.rows=this.gridsterItem.item.rows||1,this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push.restoreItems(),this.pushResize.restoreItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null};makeResize=()=>{this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push.setPushedItems(),this.pushResize.setPushedItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null};handleNorth=(t,e=!0)=>{this.top=t.clientY+this.offsetTop-this.diffTop,this.height=this.bottom-this.top,this.minHeight>this.height?(this.height=this.minHeight,this.top=this.bottom-this.minHeight):this.gridster.options.enableBoundaryControl&&(this.top=Math.max(0,this.top),this.height=this.bottom-this.top);let i=this.gridster.options.pushItems?this.margin:0;if(this.newPosition=this.gridster.pixelsToPositionY(this.top+i,Math.floor),this.gridsterItem.$item.y!==this.newPosition){if(this.itemBackup[1]=this.gridsterItem.$item.y,this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows+=this.gridsterItem.$item.y-this.newPosition,this.gridsterItem.$item.y=this.newPosition,this.pushResize.pushItems(this.pushResize.fromSouth),this.push.pushItems(this.push.fromSouth,this.gridster.$options.disablePushOnResize),!e)return;if(this.gridster.checkCollision(this.gridsterItem.$item,!0)){this.resetNorth();return}this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemTop(this.top),this.setItemHeight(this.height)};handleWest=(t,e=!0)=>{let i=this.gridster.$options.dirType===Ft.RTL?this.originalClientX+(this.originalClientX-t.clientX):t.clientX;this.left=i+this.offsetLeft-this.diffLeft,this.width=this.right-this.left,this.minWidth>this.width?(this.width=this.minWidth,this.left=this.right-this.minWidth):this.gridster.options.enableBoundaryControl&&(this.left=Math.max(0,this.left),this.width=this.right-this.left);let n=this.gridster.options.pushItems?this.margin:0;if(this.newPosition=this.gridster.pixelsToPositionX(this.left+n,Math.floor),this.gridsterItem.$item.x!==this.newPosition){if(this.itemBackup[0]=this.gridsterItem.$item.x,this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols+=this.gridsterItem.$item.x-this.newPosition,this.gridsterItem.$item.x=this.newPosition,this.pushResize.pushItems(this.pushResize.fromEast),this.push.pushItems(this.push.fromEast,this.gridster.$options.disablePushOnResize),!e)return;if(this.gridster.checkCollision(this.gridsterItem.$item,!0)){this.resetWest();return}this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemLeft(this.left),this.setItemWidth(this.width)};handleSouth=(t,e=!0)=>{if(this.height=t.clientY+this.offsetTop-this.diffBottom-this.top,this.minHeight>this.height&&(this.height=this.minHeight),this.bottom=this.top+this.height,this.gridster.options.enableBoundaryControl){let n=this.outerMarginBottom??this.margin,s=this.gridster.el.getBoundingClientRect();this.bottom=Math.min(this.bottom,s.bottom-s.top-2*n),this.height=this.bottom-this.top}let i=this.gridster.options.pushItems?0:this.margin;if(this.newPosition=this.gridster.pixelsToPositionY(this.bottom+i,Math.ceil),this.gridsterItem.$item.y+this.gridsterItem.$item.rows!==this.newPosition){if(this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows=this.newPosition-this.gridsterItem.$item.y,this.pushResize.pushItems(this.pushResize.fromNorth),this.push.pushItems(this.push.fromNorth,this.gridster.$options.disablePushOnResize),!e)return;if(this.gridster.checkCollision(this.gridsterItem.$item,!0)){this.resetSouth();return}this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemHeight(this.height)};handleEast=(t,e=!0)=>{let i=this.gridster.$options.dirType===Ft.RTL?this.originalClientX+(this.originalClientX-t.clientX):t.clientX;if(this.width=i+this.offsetLeft-this.diffRight-this.left,this.minWidth>this.width&&(this.width=this.minWidth),this.right=this.left+this.width,this.gridster.options.enableBoundaryControl){let s=this.outerMarginRight??this.margin,a=this.gridster.el.getBoundingClientRect();this.right=Math.min(this.right,a.right-a.left-2*s),this.width=this.right-this.left}let n=this.gridster.options.pushItems?0:this.margin;if(this.newPosition=this.gridster.pixelsToPositionX(this.right+n,Math.ceil),this.gridsterItem.$item.x+this.gridsterItem.$item.cols!==this.newPosition){if(this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols=this.newPosition-this.gridsterItem.$item.x,this.pushResize.pushItems(this.pushResize.fromWest),this.push.pushItems(this.push.fromWest,this.gridster.$options.disablePushOnResize),!e)return;if(this.gridster.checkCollision(this.gridsterItem.$item,!0)){this.resetEast();return}this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemWidth(this.width)};handleNorthWest=t=>{this.handleNorth(t,!1),this.handleWest(t,!1);let e=!!(this.gridster.$options.itemAspectRatio||this.gridsterItem.$item.itemAspectRatio);if(e&&(this.setItemTop(this.top),this.setItemHeight(this.height),this.setItemLeft(this.left),this.setItemWidth(this.width)),this.gridster.checkCollision(this.gridsterItem.$item,!0)){this.resetNorth(e),this.resetWest(e);return}this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()};handleNorthEast=t=>{this.handleNorth(t,!1),this.handleEast(t,!1);let e=!!(this.gridster.$options.itemAspectRatio||this.gridsterItem.$item.itemAspectRatio);if(e&&(this.setItemTop(this.top),this.setItemHeight(this.height),this.setItemWidth(this.width)),this.gridster.checkCollision(this.gridsterItem.$item,!0)){this.resetNorth(e),this.resetEast(e);return}this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()};handleSouthWest=t=>{this.handleSouth(t,!1),this.handleWest(t,!1);let e=!!(this.gridster.$options.itemAspectRatio||this.gridsterItem.$item.itemAspectRatio);if(e&&(this.setItemLeft(this.left),this.setItemHeight(this.height),this.setItemWidth(this.width)),this.gridster.checkCollision(this.gridsterItem.$item,!0)){this.resetSouth(e),this.resetWest(e);return}this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()};handleSouthEast=t=>{this.handleSouth(t,!1),this.handleEast(t,!1);let e=!!(this.gridster.$options.itemAspectRatio||this.gridsterItem.$item.itemAspectRatio);if(e&&(this.setItemHeight(this.height),this.setItemWidth(this.width)),this.gridster.checkCollision(this.gridsterItem.$item,!0)){this.resetSouth(e),this.resetEast(e);return}this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()};resetNorth(t=!1){this.gridsterItem.$item.y=this.itemBackup[1],this.gridsterItem.$item.rows=this.itemBackup[3],t||(this.top=this.gridster.positionYToPixels(this.gridsterItem.$item.y),this.setItemTop(this.gridster.positionYToPixels(this.gridsterItem.$item.y)),this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin))}resetEast(t=!1){this.gridsterItem.$item.cols=this.itemBackup[2],t||this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin)}resetSouth(t=!1){this.gridsterItem.$item.rows=this.itemBackup[3],t||this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin)}resetWest(t=!1){this.gridsterItem.$item.x=this.itemBackup[0],this.gridsterItem.$item.cols=this.itemBackup[2],t||(this.left=this.gridster.positionXToPixels(this.gridsterItem.$item.x),this.setItemLeft(this.gridster.positionXToPixels(this.gridsterItem.$item.x)),this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin))}toggle(){this.resizeEnabled=this.gridsterItem.canBeResized(),this.resizableHandles=this.gridsterItem.getResizableHandles()}dragStartDelay(t){if(Ht.checkTouchEvent(t),!this.gridster.$options.resizable.delayStart){this.dragStart(t);return}let e=setTimeout(()=>{this.dragStart(t),h()},this.gridster.$options.resizable.delayStart),{cancelMouse:i,cancelMouseLeave:n,cancelOnBlur:s,cancelTouchMove:a,cancelTouchEnd:o,cancelTouchCancel:c}=this.zone.runOutsideAngular(()=>{let u=this.gridsterItem.renderer.listen("document","mouseup",h),f=this.gridsterItem.renderer.listen("document","mouseleave",h),p=this.gridsterItem.renderer.listen("window","blur",h),x=this.gridsterItem.renderer.listen("document","touchmove",l),d=this.gridsterItem.renderer.listen("document","touchend",h),g=this.gridsterItem.renderer.listen("document","touchcancel",h);return{cancelMouse:u,cancelMouseLeave:f,cancelOnBlur:p,cancelTouchMove:x,cancelTouchEnd:d,cancelTouchCancel:g}});function l(u){Ht.checkTouchEvent(u),(Math.abs(u.clientX-t.clientX)>9||Math.abs(u.clientY-t.clientY)>9)&&h()}function h(){clearTimeout(e),s(),i(),n(),a(),o(),c()}}setItemTop(t){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,t)}setItemLeft(t){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,t,this.top)}setItemHeight(t){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"height",t+"px")}setItemWidth(t){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"width",t+"px")}},Mc=(()=>{class r{renderer;zone;item;itemInit=new ye;itemChange=new ye;itemResize=new ye;$item;el;gridster;top;left;width;height;drag;resize;notPlaced;init;get zIndex(){return this.getLayerIndex()+this.gridster.$options.baseLayerIndex}constructor(e,i,n,s){this.renderer=n,this.zone=s,this.el=e.nativeElement,this.$item={cols:-1,rows:-1,x:-1,y:-1},this.gridster=i,this.drag=new go(this,i,this.zone),this.resize=new vo(this,i,this.zone)}ngOnInit(){this.gridster.addItem(this)}ngOnChanges(e){e.item&&(this.updateOptions(),this.init||this.gridster.calculateLayout$.next()),e.item&&e.item.previousValue&&this.setSize()}updateOptions(){this.$item=Ht.merge(this.$item,this.item,{cols:void 0,rows:void 0,x:void 0,y:void 0,layerIndex:void 0,dragEnabled:void 0,resizeEnabled:void 0,compactEnabled:void 0,itemAspectRatio:void 0,maxItemRows:void 0,minItemRows:void 0,maxItemCols:void 0,minItemCols:void 0,maxItemArea:void 0,minItemArea:void 0,resizableHandles:{s:void 0,e:void 0,n:void 0,w:void 0,se:void 0,ne:void 0,sw:void 0,nw:void 0}})}ngOnDestroy(){this.gridster.removeItem(this),this.drag.destroy(),this.resize.destroy(),this.gridster=this.drag=this.resize=null}setSize(){this.renderer.setStyle(this.el,"display",this.notPlaced?"":"block"),this.gridster.gridRenderer.updateItem(this.el,this.$item,this.renderer),this.updateItemSize()}updateItemSize(){let e=this.$item.y*this.gridster.curRowHeight,i=this.$item.x*this.gridster.curColWidth,n=this.$item.cols*this.gridster.curColWidth-this.gridster.$options.margin,s=this.$item.rows*this.gridster.curRowHeight-this.gridster.$options.margin;this.top=e,this.left=i,!this.init&&n>0&&s>0&&(this.init=!0,this.item.initCallback&&this.item.initCallback(this.item,this),this.gridster.options.itemInitCallback&&this.gridster.options.itemInitCallback(this.item,this),this.itemInit.next({item:this.item,itemComponent:this}),this.gridster.$options.scrollToNewItems&&this.el.scrollIntoView(!1)),(n!==this.width||s!==this.height)&&(this.width=n,this.height=s,this.gridster.options.itemResizeCallback&&this.gridster.options.itemResizeCallback(this.item,this),this.itemResize.next({item:this.item,itemComponent:this}))}itemChanged(){this.gridster.options.itemChangeCallback&&this.gridster.options.itemChangeCallback(this.item,this),this.itemChange.next({item:this.item,itemComponent:this})}checkItemChanges(e,i){e.rows===i.rows&&e.cols===i.cols&&e.x===i.x&&e.y===i.y||(this.gridster.checkCollision(this.$item)?(this.$item.x=i.x||0,this.$item.y=i.y||0,this.$item.cols=i.cols||1,this.$item.rows=i.rows||1,this.setSize()):(this.item.cols=this.$item.cols,this.item.rows=this.$item.rows,this.item.x=this.$item.x,this.item.y=this.$item.y,this.gridster.calculateLayout$.next(),this.itemChanged()))}canBeDragged(){let e=this.gridster.$options.draggable.enabled,i=this.$item.dragEnabled===void 0?e:this.$item.dragEnabled;return!this.gridster.mobile&&e&&i}canBeResized(){let e=this.gridster.$options.resizable.enabled,i=this.$item.resizeEnabled===void 0?e:this.$item.resizeEnabled;return!this.gridster.mobile&&e&&i}getResizableHandles(){let e=this.gridster.$options.resizable.handles,i=this.$item.resizableHandles;return i===void 0?e:T(T({},e),i)}bringToFront(e){if(e&&e<=0)return;let i=this.getLayerIndex(),n=this.gridster.$options.maxLayerIndex;if(i<n){let s=e?i+e:n;this.item.layerIndex=this.$item.layerIndex=s>n?n:s}}sendToBack(e){if(e&&e<=0)return;let i=this.getLayerIndex();if(i>0){let n=e?i-e:0;this.item.layerIndex=this.$item.layerIndex=n<0?0:n}}getLayerIndex(){return this.item.layerIndex!==void 0?this.item.layerIndex:this.gridster.$options.defaultLayerIndex!==void 0?this.gridster.$options.defaultLayerIndex:0}static \u0275fac=function(i){return new(i||r)(We(Zr),We(Qs),We(Li),We(Gn))};static \u0275cmp=Oe({type:r,selectors:[["gridster-item"]],hostVars:2,hostBindings:function(i,n){i&2&&ct("z-index",n.zIndex)},inputs:{item:"item"},outputs:{itemInit:"itemInit",itemChange:"itemChange",itemResize:"itemResize"},features:[Ar],ngContentSelectors:Tc,decls:9,vars:8,consts:[[1,"gridster-item-resizable-handler","handle-s"],[1,"gridster-item-resizable-handler","handle-e"],[1,"gridster-item-resizable-handler","handle-n"],[1,"gridster-item-resizable-handler","handle-w"],[1,"gridster-item-resizable-handler","handle-se"],[1,"gridster-item-resizable-handler","handle-ne"],[1,"gridster-item-resizable-handler","handle-sw"],[1,"gridster-item-resizable-handler","handle-nw"],[1,"gridster-item-resizable-handler","handle-s",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-e",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-n",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-w",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-se",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-ne",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-sw",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-nw",3,"mousedown","touchstart"]],template:function(i,n){i&1&&(Xn(),jn(0),gt(1,zu,1,0,"div",0),gt(2,Uu,1,0,"div",1),gt(3,Gu,1,0,"div",2),gt(4,Xu,1,0,"div",3),gt(5,ju,1,0,"div",4),gt(6,Yu,1,0,"div",5),gt(7,Ku,1,0,"div",6),gt(8,qu,1,0,"div",7)),i&2&&(S(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.s&&n.resize.resizeEnabled?1:-1),S(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.e&&n.resize.resizeEnabled?2:-1),S(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.n&&n.resize.resizeEnabled?3:-1),S(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.w&&n.resize.resizeEnabled?4:-1),S(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.se&&n.resize.resizeEnabled?5:-1),S(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.ne&&n.resize.resizeEnabled?6:-1),S(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.sw&&n.resize.resizeEnabled?7:-1),S(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.nw&&n.resize.resizeEnabled?8:-1))},styles:[`gridster-item{box-sizing:border-box;z-index:1;position:absolute;overflow:hidden;transition:.3s;display:none;background:#fff;-webkit-user-select:text;user-select:text}gridster-item.gridster-item-moving{cursor:move}gridster-item.gridster-item-resizing,gridster-item.gridster-item-moving{transition:0s;z-index:2;box-shadow:0 0 5px 5px #0003,0 6px 10px #00000024,0 1px 18px #0000001f}.gridster-item-resizable-handler{position:absolute;z-index:2}.gridster-item-resizable-handler.handle-n{cursor:ns-resize;height:10px;right:0;top:0;left:0}.gridster-item-resizable-handler.handle-e{cursor:ew-resize;width:10px;bottom:0;right:0;top:0}.gridster-item-resizable-handler.handle-s{cursor:ns-resize;height:10px;right:0;bottom:0;left:0}.gridster-item-resizable-handler.handle-w{cursor:ew-resize;width:10px;left:0;top:0;bottom:0}.gridster-item-resizable-handler.handle-ne{cursor:ne-resize;width:10px;height:10px;right:0;top:0}.gridster-item-resizable-handler.handle-nw{cursor:nw-resize;width:10px;height:10px;left:0;top:0}.gridster-item-resizable-handler.handle-se{cursor:se-resize;width:0;height:0;right:0;bottom:0;border-style:solid;border-width:0 0 10px 10px;border-color:transparent}.gridster-item-resizable-handler.handle-sw{cursor:sw-resize;width:10px;height:10px;left:0;bottom:0}gridster-item:hover .gridster-item-resizable-handler.handle-se{border-color:transparent transparent #ccc}
`],encapsulation:2})}return r})();function ef(r){r||(r=Et(Ua));let t=new $n(e=>{if(r.destroyed){e.next();return}return r.onDestroy(e.next.bind(e))});return e=>e.pipe(zn(t))}var wo=class{source;destroyed=!1;destroyRef=Et(Ua);constructor(t){this.source=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}subscribe(t){if(this.destroyed)throw new Al(953,!1);let e=this.source.pipe(ef(this.destroyRef)).subscribe({next:i=>t(i)});return{unsubscribe:()=>e.unsubscribe()}}};function Le(r,t){return new wo(r)}function Pc(r){let t=Ll(r);return new $n(e=>{let i=t?.onDestroy(()=>e.complete()),n=r.subscribe(s=>e.next(s));return()=>{n.unsubscribe(),i?.()}})}var Lc=new Dl("NGX_ECHARTS_CONFIG"),Co=class{constructor(){this.subject=new Es(1),this.subscriptions=new El}doFilter(t){this.subject.next(t)}dispose(){this.subscriptions.unsubscribe()}notEmpty(t,e){this.subscriptions.add(this.subject.subscribe(i=>{if(i[t]){let n=i[t].currentValue;n!=null&&e(n)}}))}has(t,e){this.subscriptions.add(this.subject.subscribe(i=>{if(i[t]){let n=i[t].currentValue;e(n)}}))}notFirst(t,e){this.subscriptions.add(this.subject.subscribe(i=>{if(i[t]&&!i[t].isFirstChange()){let n=i[t].currentValue;e(n)}}))}notFirstAndEmpty(t,e){this.subscriptions.add(this.subject.subscribe(i=>{if(i[t]&&!i[t].isFirstChange()){let n=i[t].currentValue;n!=null&&e(n)}}))}},Rc=(()=>{let t=class t{constructor(){this.el=Et(Zr),this.ngZone=Et(Gn),this.config=Et(Lc),this.options=er(null),this.theme=er(this.config.theme??null),this.initOpts=er(null),this.merge=er(null),this.autoResize=er(!0),this.loading=er(!1),this.loadingType=er("default"),this.loadingOpts=er(null),this.chartInit=Ka(),this.optionsError=Ka(),this.chartClick=Le(this.createLazyEvent("click")),this.chartDblClick=Le(this.createLazyEvent("dblclick")),this.chartMouseDown=Le(this.createLazyEvent("mousedown")),this.chartMouseMove=Le(this.createLazyEvent("mousemove")),this.chartMouseUp=Le(this.createLazyEvent("mouseup")),this.chartMouseOver=Le(this.createLazyEvent("mouseover")),this.chartMouseOut=Le(this.createLazyEvent("mouseout")),this.chartGlobalOut=Le(this.createLazyEvent("globalout")),this.chartContextMenu=Le(this.createLazyEvent("contextmenu")),this.chartHighlight=Le(this.createLazyEvent("highlight")),this.chartDownplay=Le(this.createLazyEvent("downplay")),this.chartSelectChanged=Le(this.createLazyEvent("selectchanged")),this.chartLegendSelectChanged=Le(this.createLazyEvent("legendselectchanged")),this.chartLegendSelected=Le(this.createLazyEvent("legendselected")),this.chartLegendUnselected=Le(this.createLazyEvent("legendunselected")),this.chartLegendLegendSelectAll=Le(this.createLazyEvent("legendselectall")),this.chartLegendLegendInverseSelect=Le(this.createLazyEvent("legendinverseselect")),this.chartLegendScroll=Le(this.createLazyEvent("legendscroll")),this.chartDataZoom=Le(this.createLazyEvent("datazoom")),this.chartDataRangeSelected=Le(this.createLazyEvent("datarangeselected")),this.chartGraphRoam=Le(this.createLazyEvent("graphroam")),this.chartGeoRoam=Le(this.createLazyEvent("georoam")),this.chartTreeRoam=Le(this.createLazyEvent("treeroam")),this.chartTimelineChanged=Le(this.createLazyEvent("timelinechanged")),this.chartTimelinePlayChanged=Le(this.createLazyEvent("timelineplaychanged")),this.chartRestore=Le(this.createLazyEvent("restore")),this.chartDataViewChanged=Le(this.createLazyEvent("dataviewchanged")),this.chartMagicTypeChanged=Le(this.createLazyEvent("magictypechanged")),this.chartGeoSelectChanged=Le(this.createLazyEvent("geoselectchanged")),this.chartGeoSelected=Le(this.createLazyEvent("geoselected")),this.chartGeoUnselected=Le(this.createLazyEvent("geounselected")),this.chartAxisAreaSelected=Le(this.createLazyEvent("axisareaselected")),this.chartBrush=Le(this.createLazyEvent("brush")),this.chartBrushEnd=Le(this.createLazyEvent("brushend")),this.chartBrushSelected=Le(this.createLazyEvent("brushselected")),this.chartGlobalCursorTaken=Le(this.createLazyEvent("globalcursortaken")),this.chartRendered=Le(this.createLazyEvent("rendered")),this.chartFinished=Le(this.createLazyEvent("finished")),this.animationFrameID=null,this.chart$=new Es(1),this.resize$=new tn,this.changeFilter=new Co,this.resizeObFired=!1,this.echarts=this.config.echarts}ngOnChanges(i){this.changeFilter.doFilter(i)}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe(Ol(100,kl,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize()&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(i=>{for(let n of i)n.target===this.el.nativeElement&&(this.resizeObFired?this.animationFrameID=window.requestAnimationFrame(()=>{this.resize$.next()}):this.resizeObFired=!0)})),this.resizeOb.observe(this.el.nativeElement)),this.changeFilter.notFirstAndEmpty("options",i=>this.onOptionsChange(i)),this.changeFilter.notFirstAndEmpty("merge",i=>this.setOption(i)),this.changeFilter.has("loading",i=>this.toggleLoading(!!i)),this.changeFilter.notFirst("theme",()=>this.refreshChart())}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.loadingSub&&this.loadingSub.unsubscribe(),this.changeFilter.dispose(),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(i){this.chart?i?this.chart.showLoading(this.loadingType(),this.loadingOpts()):this.chart.hideLoading():this.loadingSub=this.chart$.subscribe(n=>i?n.showLoading(this.loadingType(),this.loadingOpts()):n.hideLoading())}setOption(i,n){if(this.chart)try{this.chart.setOption(i,n)}catch(s){console.error(s),this.optionsError.emit(s)}}refreshChart(){return Tt(this,null,function*(){this.dispose(),yield this.initChart()})}createChart(){let i=this.el.nativeElement;if(window&&window.getComputedStyle){let n=window.getComputedStyle(i,null).getPropertyValue("height");(!n||n==="0px")&&(!i.style.height||i.style.height==="0px")&&(i.style.height="400px")}return this.ngZone.runOutsideAngular(()=>(typeof this.echarts=="function"?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:s})=>s(i,this.theme()??this.config?.theme,this.initOpts())))}initChart(){return Tt(this,null,function*(){yield this.onOptionsChange(this.options());let i=this.merge();i&&this.chart&&this.setOption(i)})}onOptionsChange(i){return Tt(this,null,function*(){i&&(this.chart?this.setOption(this.options(),!0):(this.chart=yield this.createChart(),this.chart$.next(this.chart),this.chartInit.emit(this.chart),this.setOption(this.options(),!0)))})}createLazyEvent(i){return Pc(this.chartInit).pipe(ks(n=>new $n(s=>(n.on(i,a=>this.ngZone.run(()=>s.next(a))),()=>{this.chart&&(this.chart.isDisposed()||n.off(i))}))))}};t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=Un({type:t,selectors:[["echarts"],["","echarts",""]],inputs:{options:[1,"options"],theme:[1,"theme"],initOpts:[1,"initOpts"],merge:[1,"merge"],autoResize:[1,"autoResize"],loading:[1,"loading"],loadingType:[1,"loadingType"],loadingOpts:[1,"loadingOpts"]},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartHighlight:"chartHighlight",chartDownplay:"chartDownplay",chartSelectChanged:"chartSelectChanged",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendLegendSelectAll:"chartLegendLegendSelectAll",chartLegendLegendInverseSelect:"chartLegendLegendInverseSelect",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartGraphRoam:"chartGraphRoam",chartGeoRoam:"chartGeoRoam",chartTreeRoam:"chartTreeRoam",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartGeoSelectChanged:"chartGeoSelectChanged",chartGeoSelected:"chartGeoSelected",chartGeoUnselected:"chartGeoUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartGlobalCursorTaken:"chartGlobalCursorTaken",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],features:[Ar]});let r=t;return r})();function Js(r){return{provide:Lc,useValue:r}}var tf=["chart"],ea=(()=>{let t=class t{constructor(i){this.cdr=i,this.isSingleClick=!0}get chartOptions(){return this.widget?.config?.options}onChartInit(i){this.widget.chartInstance=i,console.log("\u{1F527} ECharts component initialized:",{widgetHeight:this.widget?.height,widgetId:this.widget?.id,widgetPosition:this.widget?.position,chartInstance:!!i}),this.widget.config?.events?.onChartOptions?(console.log("\u{1F525} Setting up event handler from widget config"),this.widget.config.events.onChartOptions(this.widget,i)):console.log("\u{1F525} No event handler found in widget config"),setTimeout(()=>{this.onDataLoad?.emit(this.widget),setTimeout(()=>{this.forceChartResize()},100)})}onChartDblClick(i){this.isSingleClick=!1}onClick(i){this.isSingleClick=!0,setTimeout(()=>{let n=i.data;if(i.seriesType==="scatter"){let a=i.data.find(o=>o.name===this.widget.config.state?.accessor);n=T(T({},n),a)}let s=this.createFilterValueFromClickData(n,i);s?(s.widgetId=this.widget.id,this.widget.config?.header?.title&&(s.widgetTitle=this.widget.config.header.title),this.onUpdateFilter.emit({value:n,widget:this.widget,filterValue:s})):this.onUpdateFilter.emit({value:n,widget:this.widget})},250)}createFilterValueFromClickData(i,n){if(!i||typeof i!="object")return null;let s=this.widget.config?.filterColumn||this.widget.config?.accessor||"unknown",a={accessor:"unknown",filterColumn:s};if(i&&typeof i=="object"&&i.name&&n.seriesType==="pie")a={accessor:"category",filterColumn:s,category:i.name,value:i.name,percentage:i.value?.toString()||"0"};else if(n.seriesType==="bar"){let o,c;if(i&&typeof i=="object"&&i.name)o=i.name,c=i.value||i.name;else{c=i;let l=this.widget.config?.options,h=[];if(l?.xAxis&&(Array.isArray(l.xAxis)?h=l.xAxis[0]?.data||[]:h=l.xAxis.data||[]),h.length===0&&l?.series?.[0]?.data){let u=l.series[0].data;Array.isArray(u)&&u.length>0&&typeof u[0]=="object"&&u[0].name&&(h=u.map(f=>f.name))}h&&Array.isArray(h)&&n.dataIndex!==void 0?o=h[n.dataIndex]:o=c?.toString()||"Unknown"}a={accessor:"category",filterColumn:s,category:o,value:c,seriesName:n.seriesName}}else if(n.seriesType==="line")a={accessor:"series",filterColumn:s,series:n.seriesName||(i&&typeof i=="object"?i.name:null),value:i&&typeof i=="object"?i.value:i,xAxis:i&&Array.isArray(i)?i[0]?.toString():null,yAxis:i&&Array.isArray(i)?i[1]?.toString():null};else if(n.seriesType==="scatter"&&i&&typeof i=="object"&&i.value&&Array.isArray(i.value))a={accessor:"coordinates",filterColumn:s,x:i.value[0]?.toString(),y:i.value[1]?.toString(),value:`(${i.value[0]}, ${i.value[1]})`,seriesName:n.seriesName};else if(i&&typeof i=="object"){let o=Object.keys(i);if(o.length>0){let c=o[0];a={accessor:c,filterColumn:s,[c]:i[c],value:i[c]?.toString(),seriesName:n.seriesName}}}else return null;return a.accessor!=="unknown"?a:null}forceChartUpdate(){this.widget.chartInstance&&this.widget.chartInstance.setOption(this.chartOptions),this.cdr.detectChanges()}forceChartResize(){this.widget.chartInstance&&(console.log("\u{1F527} Forcing chart resize to height:",this.widget?.height),this.widget.chartInstance.resize())}};t.\u0275fac=function(n){return new(n||t)(We($r))},t.\u0275cmp=Oe({type:t,selectors:[["vis-echart"]],viewQuery:function(n,s){if(n&1&&tt(tf,5),n&2){let a;Ie(a=Fe())&&(s.chart=a.first)}},inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},features:[or([Js({echarts:()=>import("./chunk-6WF3YY7L.js")})])],decls:2,vars:5,consts:[["chart",""],["echarts","",3,"chartInit","chartClick","chartDblClick","options"]],template:function(n,s){if(n&1){let a=Se();U(0,"div",1,0),Ce("chartInit",function(c){return J(a),ee(s.onChartInit(c))})("chartClick",function(c){return J(a),ee(s.onClick(c))})("chartDblClick",function(c){return J(a),ee(s.onChartDblClick(c))}),X()}n&2&&(ct("height",s.widget.height||400,"px")("width",100,"%"),M("options",s.chartOptions))},dependencies:[Be,Rc],encapsulation:2});let r=t;return r})();function rf(r,t){if(r&1&&(ke(0,"span",11),ce(1),yr(2,"uppercase"),Me(),ke(3,"span",12),ce(4,":"),Me(),ke(5,"span",13),ce(6),Me()),r&2){let e=E().$implicit;S(),Ne(Yn(2,2,e.filterColumn||e.accessor)),S(5),Ne(e.value)}}function nf(r,t){if(r&1&&(ke(0,"span",11),ce(1),Me(),ke(2,"span",12),ce(3,":"),Me(),ke(4,"span",13),ce(5),Me()),r&2){let e=E().$implicit;S(),Ne(e.widgetTitle),S(4),Ne(e.value)}}function sf(r,t){if(r&1&&(ke(0,"span",11),ce(1),yr(2,"uppercase"),Me(),ke(3,"span",12),ce(4,"="),Me(),ke(5,"span",13),ce(6),Me()),r&2){let e=E().$implicit;S(),Ne(Yn(2,2,e.accessor)),S(5),Ne(e.value)}}function af(r,t){if(r&1){let e=Se();ke(0,"button",8),Qt("click",function(){let n=J(e).$implicit,s=E(2);return ee(s.clearFilter(n))}),Qr(1,"i",9),gt(2,rf,7,4)(3,nf,6,2)(4,sf,7,4),Qr(5,"i",10),Me()}if(r&2){let e=t.$implicit;Os("title","Remove "+(e.filterColumn||e.accessor||e.widgetTitle)+" filter"),S(2),xt(e.filterColumn||e.accessor?2:e.widgetTitle?3:4)}}function of(r,t){if(r&1){let e=Se();ke(0,"div",0)(1,"span",2),ce(2,"Applied Filters"),Me(),ke(3,"div",3),Ri(4,af,6,2,"button",4,Pl),Me(),ke(6,"div",5)(7,"button",6),Qt("click",function(){J(e);let n=E();return ee(n.clearAllFilters(!0))}),Qr(8,"i",7),ke(9,"span"),ce(10,"Clear All"),Me()()()()}if(r&2){let e=E();S(4),Ni(e.filterValues)}}function lf(r,t){r&1&&(ke(0,"div",1)(1,"div",14),Qr(2,"i",15),ke(3,"div",16)(4,"p",17),ce(5,"No Filters Applied"),Me(),ke(6,"p",18),ce(7," Click on any chart element to slice and dice data. You can use annotations to save a specific state of dashboard after applying filters. "),Me()()()())}var Nc=(()=>{let t=class t{get filterValues(){let i=this.widget?.config?.options;return i&&i.values&&Array.isArray(i.values)&&i.values.length>0?i.values:[]}set filterValues(i){i&&i.length>0&&(this.widget.config?this.widget.config.options||(this.widget.config.options={values:[]}):this.widget.config={options:{values:[]}},this.widget.config.options.values=i)}clearAllFilters(i){i&&(this.filterValues=[],this.widget?.config?.options&&(this.widget.config.options.values=[]),this.onUpdateFilter.emit([]))}clearFilter(i){if(JSON.stringify(i).length>0){let n=this.filterValues.splice(this.filterValues.indexOf(i),1);this.widget?.config?.options&&(this.widget.config.options.values=this.filterValues),this.onUpdateFilter.emit(this.filterValues)}}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-filters"]],inputs:{widget:"widget",onUpdateFilter:"onUpdateFilter",onDataLoad:"onDataLoad"},decls:2,vars:1,consts:[[1,"filter-component"],[1,"filter-component","empty-state"],[1,"filter-label"],[1,"filter-badges"],[1,"btn-wide","btn","btn-outline-primary","btn-sm","chip",3,"title"],[1,"filter-actions"],["title","Clear all applied filters",1,"btn-wide","btn","btn-outline-warning","btn-sm","chip","clear-all-btn",3,"click"],[1,"pi","pi-trash"],[1,"btn-wide","btn","btn-outline-primary","btn-sm","chip",3,"click","title"],[1,"pi","pi-tag","filter-badge-icon"],["title","Remove filter",1,"pi","pi-times","close-icon"],[1,"filter-key"],[1,"filter-separator"],[1,"filter-value"],[1,"empty-state-content"],[1,"pi","pi-info-circle","empty-state-icon"],[1,"empty-state-text"],[1,"empty-state-title"],[1,"empty-state-description"]],template:function(n,s){n&1&&gt(0,of,11,0,"div",0)(1,lf,8,0,"div",1),n&2&&xt(s.filterValues&&s.filterValues.length>0?0:1)},dependencies:[Be,Nl],styles:[".filter-component[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:1rem;margin:0;padding:.5rem;font-size:.8rem;font-weight:500;background:linear-gradient(135deg,var(--p-surface-0) 0%,var(--p-surface-100) 100%);border-radius:8px;border:1px solid var(--p-surface-300);box-shadow:0 2px 4px #0000000d;transition:all .3s ease-in-out;flex-wrap:nowrap;overflow-x:auto;white-space:nowrap}.filter-component[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #0000001a;transform:translateY(-1px)}.filter-label[_ngcontent-%COMP%]{font-weight:700;color:var(--p-primary-700);font-size:.8rem;text-transform:uppercase;letter-spacing:.3px;margin:0;white-space:nowrap;flex-shrink:0}.filter-badges[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;gap:.5rem;align-items:center;overflow-x:auto;flex:1}.filter-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:0;border:none;flex-shrink:0}.clear-all-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.3rem;padding:.3rem .6rem;font-size:.8rem}.chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem;border-radius:16px;font-size:.8rem;font-weight:600;text-transform:uppercase;letter-spacing:.2px;border:none;cursor:pointer;transition:all .2s ease-in-out;position:relative;min-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex-shrink:0}.filter-badge-icon[_ngcontent-%COMP%]{font-size:.8rem;opacity:.8;color:var(--p-primary-600)}.filter-key[_ngcontent-%COMP%]{font-weight:700;color:var(--p-primary-800);font-size:.8rem}.filter-separator[_ngcontent-%COMP%]{color:var(--p-primary-800);font-weight:400;font-size:.8rem}.filter-value[_ngcontent-%COMP%]{font-weight:600;color:var(--p-primary-800);font-size:.8rem}.btn-outline-primary.chip[_ngcontent-%COMP%]{background:var(--p-surface-0);color:var(--p-primary-800);border:1px solid var(--p-primary-300)}.btn-outline-primary.chip[_ngcontent-%COMP%]:hover{background:var(--p-primary-50);color:var(--p-primary-900);border:1px solid var(--p-primary-400);transform:translateY(-1px);box-shadow:0 3px 6px var(--p-primary-200)}.btn-outline-warning.chip[_ngcontent-%COMP%]{background:var(--p-surface-0);color:var(--p-orange-700);border:1px solid var(--p-orange-300)}.btn-outline-warning.chip[_ngcontent-%COMP%]:hover{background:var(--p-orange-50);color:var(--p-orange-900);border:1px solid var(--p-orange-400);transform:translateY(-1px);box-shadow:0 3px 6px var(--p-orange-200)}.close-icon[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:14px;height:14px;border-radius:50%;background-color:var(--p-primary-100);color:var(--p-primary-700);font-size:.8rem;transition:all .2s ease-in-out;flex-shrink:0}.empty-state[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--p-surface-0) 0%,var(--p-surface-100) 100%);border:2px dashed var(--p-surface-300);box-shadow:none;justify-content:center}.empty-state[_ngcontent-%COMP%]:hover{transform:none;box-shadow:none}.empty-state-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:0;width:100%;overflow:hidden}.empty-state-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--p-surface-600);opacity:.6;flex-shrink:0}.empty-state-text[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex:1;overflow:hidden;white-space:nowrap}.empty-state-title[_ngcontent-%COMP%]{font-weight:700;color:var(--p-surface-700);margin:0;font-size:1rem;white-space:nowrap;flex-shrink:0}.empty-state-description[_ngcontent-%COMP%]{color:var(--p-surface-600);margin:0;font-size:1rem;line-height:1.2;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1}@media (max-width: 768px){.filter-component[_ngcontent-%COMP%]{padding:.4rem .6rem;gap:.3rem;font-size:.7rem}.filter-badges[_ngcontent-%COMP%]{gap:.2rem}.chip[_ngcontent-%COMP%]{font-size:.65rem;padding:.25rem .4rem;max-width:120px;min-height:20px}.empty-state-content[_ngcontent-%COMP%]{gap:.3rem}.empty-state-icon[_ngcontent-%COMP%]{font-size:1rem}.empty-state-title[_ngcontent-%COMP%]{font-size:.7rem}.empty-state-description[_ngcontent-%COMP%]{font-size:.65rem}}@keyframes _ngcontent-%COMP%_filterSlideIn{0%{opacity:0;transform:translateY(-5px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.chip[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_filterSlideIn .2s ease-out}.chip[_ngcontent-%COMP%]:focus{outline:2px solid var(--p-primary-500);outline-offset:1px}.chip[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none!important;background:var(--p-surface-200);color:var(--p-surface-500);border-color:var(--p-surface-300)}"]});let r=t;return r})();function cf(r,t){if(r&1&&(U(0,"th"),ce(1),X()),r&2){let e=t.$implicit;S(),Ne(e)}}function hf(r,t){if(r&1&&(U(0,"td"),ce(1),X()),r&2){let e=t.$implicit,i=E().$implicit;S(),Ne(i[e])}}function uf(r,t){if(r&1&&(U(0,"tr"),he(1,hf,2,1,"td",2),X()),r&2){let e=E();S(),M("ngForOf",e.tableOptions.columns)}}var Bc=(()=>{let t=class t{get tableOptions(){return this.widget?.config?.options}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-table"]],inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},decls:7,vars:2,consts:[[1,"table-container"],[1,"data-table"],[4,"ngFor","ngForOf"]],template:function(n,s){n&1&&(U(0,"div",0)(1,"table",1)(2,"thead")(3,"tr"),he(4,cf,2,1,"th",2),X()(),U(5,"tbody"),he(6,uf,2,1,"tr",2),X()()()),n&2&&(S(4),M("ngForOf",s.tableOptions.columns),S(2),M("ngForOf",s.tableOptions.data))},dependencies:[Be,gi],styles:[".table-container[_ngcontent-%COMP%]{padding:1rem;overflow-x:auto}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.875rem}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem;text-align:left;border-bottom:1px solid #e5e7eb}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f9fafb;font-weight:600}.data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9fafb}"]});let r=t;return r})();function ff(r,t){if(r&1&&(U(0,"div",9),ce(1),X()),r&2){let e=E();ct("color",e.tileOptions.color),S(),Ne(e.tileOptions.subtitle)}}var Hc=(()=>{let t=class t{get tileOptions(){return this.widget?.config?.options}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-tile"]],inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},decls:13,vars:20,consts:[[1,"tile-container"],[1,"tile-content"],[1,"tile-left"],[1,"tile-value"],[1,"tile-description"],["class","tile-subtitle",3,"color",4,"ngIf"],[1,"tile-right"],[1,"tile-change"],[1,"tile-icon"],[1,"tile-subtitle"]],template:function(n,s){n&1&&(U(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),ce(4),X(),U(5,"div",4),ce(6),X(),he(7,ff,2,3,"div",5),X(),U(8,"div",6)(9,"div",7),ce(10),X(),U(11,"div",8),xe(12,"i"),X()()()()),n&2&&(ct("background-color",s.tileOptions.backgroundColor||s.tileOptions.color)("opacity",s.tileOptions.backgroundOpacity||1),S(3),ct("color",s.tileOptions.color),S(),Ne(s.tileOptions.value),S(),ct("color",s.tileOptions.color),S(),Ne(s.tileOptions.description),S(),M("ngIf",s.tileOptions.subtitle),S(2),Te("change-"+s.tileOptions.changeType),ct("color",s.tileOptions.color),S(),rt(" ",s.tileOptions.change," "),S(),ct("color",s.tileOptions.color),S(),Te(s.tileOptions.icon))},dependencies:[Be,Rt],styles:[".tile-container[_ngcontent-%COMP%]{padding:1.5rem;border-radius:.5rem;color:#fff;height:100%;display:flex;align-items:center;min-height:120px}.tile-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%;gap:1rem}.tile-left[_ngcontent-%COMP%]{flex:1}.tile-right[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:.5rem}.tile-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin-bottom:.25rem}.tile-description[_ngcontent-%COMP%]{font-size:1.2rem;opacity:.8}.tile-subtitle[_ngcontent-%COMP%]{font-size:.875rem;opacity:.7;margin-top:.25rem}.tile-change[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#fff}.tile-icon[_ngcontent-%COMP%]{font-size:1.5rem;opacity:.9;color:#fff}.change-positive[_ngcontent-%COMP%]{color:#10b981!important}.change-negative[_ngcontent-%COMP%]{color:#ef4444!important}.change-neutral[_ngcontent-%COMP%]{color:#6b7280!important}"]});let r=t;return r})();var Vc=(()=>{let t=class t{constructor(i){this.cdr=i}ngOnChanges(i){i.widget&&this.widget&&(this.cdr.markForCheck(),this.cdr.detectChanges())}get stockTileOptions(){return this.widget?.config?.options}};t.\u0275fac=function(n){return new(n||t)(We($r))},t.\u0275cmp=Oe({type:t,selectors:[["vis-stock-tile"]],inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},features:[Ar],decls:21,vars:21,consts:[[1,"stock-tile-container"],[1,"stock-tile-content"],[1,"stock-tile-symbol"],[1,"stock-tile-main-section"],[1,"stock-tile-price-line"],[1,"stock-tile-price"],[1,"stock-tile-change"],[1,"stock-tile-high-low-section"],[1,"stock-tile-high"],[1,"stock-tile-high-label"],[1,"stock-tile-high-value"],[1,"stock-tile-low"],[1,"stock-tile-low-label"],[1,"stock-tile-low-value"]],template:function(n,s){n&1&&(ke(0,"div",0)(1,"div",1)(2,"div",2),ce(3),Me(),ke(4,"div",3)(5,"div",4)(6,"div",5),ce(7),Me(),ke(8,"div",6),ce(9),Me()()(),ke(10,"div",7)(11,"div",8)(12,"span",9),ce(13,"High:"),Me(),ke(14,"span",10),ce(15),Me()(),ke(16,"div",11)(17,"span",12),ce(18,"Low:"),Me(),ke(19,"span",13),ce(20),Me()()()()()),n&2&&(ct("background-color",s.stockTileOptions.backgroundColor||s.stockTileOptions.color)("opacity",s.stockTileOptions.backgroundOpacity||1),S(2),ct("color",s.stockTileOptions.color),S(),rt(" ",s.stockTileOptions.description," "),S(3),ct("color",s.stockTileOptions.color),S(),rt(" ",s.stockTileOptions.value," "),S(),Te("change-"+s.stockTileOptions.changeType),ct("color",s.stockTileOptions.color),S(),rt(" ",s.stockTileOptions.change," "),S(5),ct("color",s.stockTileOptions.color),S(),rt(" ",s.stockTileOptions.highValue||"0"," "),S(4),ct("color",s.stockTileOptions.color),S(),rt(" ",s.stockTileOptions.lowValue||"0"," "))},dependencies:[Be],styles:[".stock-tile-container[_ngcontent-%COMP%]{padding-top:.25rem!important;padding:1rem;border-radius:.5rem;color:#fff;height:100%;display:flex;align-items:center;min-height:120px}.stock-tile-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;justify-content:space-between;min-height:100%}.stock-tile-symbol[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;opacity:.9;text-align:center;padding-top:.5rem}.stock-tile-main-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center;gap:.5rem;flex:1;justify-content:center}.stock-tile-price-line[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:.5rem}.stock-tile-price[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;line-height:1}.stock-tile-change[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;line-height:1}.stock-tile-high-low-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%;padding-top:.5rem}.stock-tile-high[_ngcontent-%COMP%], .stock-tile-low[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.stock-tile-high-label[_ngcontent-%COMP%], .stock-tile-low-label[_ngcontent-%COMP%]{font-size:.625rem;opacity:.8;font-weight:500}.stock-tile-high-value[_ngcontent-%COMP%], .stock-tile-low-value[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600}.change-positive[_ngcontent-%COMP%]{color:#10b981!important}.change-negative[_ngcontent-%COMP%]{color:#ef4444!important}.change-neutral[_ngcontent-%COMP%]{color:#6b7280!important}"],changeDetection:0});let r=t;return r})();var Wc=(()=>{let t=class t{get markdownOptions(){return this.widget?.config?.options}get markdownContent(){return this.markdownOptions?.content||""}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-markdown-cell"]],inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},decls:2,vars:1,consts:[[1,"markdown-container"],[1,"markdown-content",3,"innerHTML"]],template:function(n,s){n&1&&(ke(0,"div",0),Qr(1,"div",1),Me()),n&2&&(S(),Os("innerHTML",s.markdownContent,pi))},dependencies:[Be],styles:[".markdown-container[_ngcontent-%COMP%]{padding:1rem;height:100%;overflow-y:auto}.markdown-content[_ngcontent-%COMP%]{line-height:1.6;color:#374151}.markdown-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin-top:1.5rem;margin-bottom:.5rem;font-weight:600;color:#111827}.markdown-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.875rem}.markdown-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem}.markdown-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem}.markdown-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:1rem}.markdown-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin-bottom:1rem;padding-left:1.5rem}.markdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.25rem}.markdown-content[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background-color:#f3f4f6;padding:.125rem .25rem;border-radius:.25rem;font-family:Courier New,monospace;font-size:.875rem}.markdown-content[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{background-color:#f3f4f6;padding:1rem;border-radius:.5rem;overflow-x:auto;margin-bottom:1rem}.markdown-content[_ngcontent-%COMP%]   blockquote[_ngcontent-%COMP%]{border-left:4px solid #d1d5db;padding-left:1rem;margin:1rem 0;font-style:italic;color:#6b7280}"]});let r=t;return r})();var $c=(()=>{let t=class t{get codeOptions(){return this.widget?.config?.options}get codeContent(){return this.widget?.data||"// Code content will be displayed here"}get codeLanguage(){let i=this.codeOptions?.accessor||"";return i.endsWith(".ts")?"typescript":i.endsWith(".js")?"javascript":i.endsWith(".py")?"python":i.endsWith(".java")?"java":i.endsWith(".cpp")?"cpp":i.endsWith(".cs")?"csharp":"text"}copyCode(){navigator.clipboard.writeText(this.codeContent).then(()=>{}).catch(i=>{})}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-code-cell"]],inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},decls:9,vars:2,consts:[[1,"code-container"],[1,"code-header"],[1,"code-language"],["title","Copy code",1,"copy-button",3,"click"],[1,"fas","fa-copy"],[1,"code-content"]],template:function(n,s){n&1&&(ke(0,"div",0)(1,"div",1)(2,"span",2),ce(3),Me(),ke(4,"button",3),Qt("click",function(){return s.copyCode()}),Qr(5,"i",4),Me()(),ke(6,"pre",5)(7,"code"),ce(8),Me()()()),n&2&&(S(3),Ne(s.codeLanguage),S(5),Ne(s.codeContent))},dependencies:[Be],styles:[".code-container[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;background-color:#1f2937;border-radius:.5rem;overflow:hidden}.code-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem 1rem;background-color:#374151;border-bottom:1px solid #4b5563}.code-language[_ngcontent-%COMP%]{color:#d1d5db;font-size:.875rem;font-weight:500;text-transform:uppercase}.copy-button[_ngcontent-%COMP%]{background:none;border:none;color:#9ca3af;cursor:pointer;padding:.25rem;border-radius:.25rem;transition:color .2s}.copy-button[_ngcontent-%COMP%]:hover{color:#d1d5db;background-color:#4b5563}.code-content[_ngcontent-%COMP%]{flex:1;margin:0;padding:1rem;overflow:auto;font-family:Courier New,Monaco,Menlo,monospace;font-size:.875rem;line-height:1.5;color:#e5e7eb;background-color:#1f2937}.code-content[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:none;padding:0;border-radius:0;font-family:inherit;font-size:inherit;color:inherit}"]});let r=t;return r})();var df=["stockTooltipTemplate"],pf=()=>["symbol","companyName","industry","sector"],zc=(r,t)=>({"text-green-500":r,"text-red-500":t});function mf(r,t){r&1&&(U(0,"tr")(1,"th",5),ce(2," Symbol "),xe(3,"p-sortIcon",6),X(),U(4,"th",7),ce(5," Last Price "),xe(6,"p-sortIcon",8),X(),U(7,"th",9),ce(8," Change "),xe(9,"p-sortIcon",10),X(),U(10,"th",11),ce(11," Change % "),xe(12,"p-sortIcon",12),X()())}function gf(r,t){if(r&1){let e=Se();U(0,"tr",13),Ce("click",function(){let n=J(e).$implicit,s=E();return ee(s.onRowClick(n))})("mouseenter",function(){let n=J(e).$implicit,s=E();return ee(s.setHoveredStock(n))})("mouseleave",function(){J(e);let n=E();return ee(n.clearHoveredStock())}),U(1,"td")(2,"span"),ce(3),X()(),U(4,"td",14)(5,"span"),ce(6),yr(7,"number"),X()(),U(8,"td",14)(9,"span",15),ce(10),yr(11,"number"),X()(),U(12,"td",14)(13,"span",15),ce(14),yr(15,"number"),X()()()}if(r&2){let e=t.$implicit;E();let i=Jt(6);M("pTooltip",i),S(3),Ne(e.symbol),S(3),rt("\u20B9",mi(7,9,e.lastPrice,"1.2-2")),S(3),M("ngClass",_r(18,zc,e.priceChange>=0,e.priceChange<0)),S(),ja(" ",e.priceChange>=0?"+":"","\u20B9",mi(11,12,e.priceChange,"1.2-2")," "),S(3),M("ngClass",_r(21,zc,e.percentChange>=0,e.percentChange<0)),S(),ja(" ",e.percentChange>=0?"+":"","",mi(15,15,e.percentChange,"1.2-2"),"% ")}}function xf(r,t){if(r&1){let e=Se();U(0,"tr")(1,"td",16)(2,"div",17),xe(3,"i",18),U(4,"span",19),ce(5,"No stock data available"),X(),U(6,"p-button",20),Ce("onClick",function(){J(e);let n=E();return ee(n.loadSampleData())}),X()()()()}}function vf(r,t){if(r&1&&(U(0,"div",26),ce(1),X()),r&2){let e=E(2);S(),rt(" ",e.hoveredStock==null?null:e.hoveredStock.companyName," ")}}function _f(r,t){if(r&1&&(U(0,"span",30),ce(1,"Industry: "),U(2,"strong"),ce(3),X()()),r&2){let e=E(3);S(3),Ne(e.hoveredStock==null?null:e.hoveredStock.industry)}}function yf(r,t){if(r&1&&(U(0,"span",31),ce(1,"Sector: "),U(2,"strong"),ce(3),X()()),r&2){let e=E(3);S(3),Ne(e.hoveredStock==null?null:e.hoveredStock.sector)}}function wf(r,t){if(r&1&&(U(0,"div",27),he(1,_f,4,1,"span",28)(2,yf,4,1,"span",29),X()),r&2){let e=E(2);S(),M("ngIf",e.hoveredStock==null?null:e.hoveredStock.industry),S(),M("ngIf",e.hoveredStock==null?null:e.hoveredStock.sector)}}function Cf(r,t){r&1&&xe(0,"div",32)}function bf(r,t){if(r&1&&(U(0,"div",38)(1,"span",39),ce(2,"Open:"),X(),U(3,"span",40),ce(4),yr(5,"number"),X()()),r&2){let e=E(4);S(4),rt("\u20B9",mi(5,1,e.hoveredStock==null?null:e.hoveredStock.openPrice,"1.2-2"))}}function Sf(r,t){if(r&1&&(U(0,"div",38)(1,"span",39),ce(2,"Prev Close:"),X(),U(3,"span",40),ce(4),yr(5,"number"),X()()),r&2){let e=E(4);S(4),rt("\u20B9",mi(5,1,e.hoveredStock==null?null:e.hoveredStock.previousClose,"1.2-2"))}}function Tf(r,t){if(r&1&&(U(0,"div",36),he(1,bf,6,4,"div",37)(2,Sf,6,4,"div",37),X()),r&2){let e=E(3);S(),M("ngIf",e.hoveredStock==null?null:e.hoveredStock.openPrice),S(),M("ngIf",e.hoveredStock==null?null:e.hoveredStock.previousClose)}}function Ef(r,t){if(r&1&&(U(0,"div",38)(1,"span",39),ce(2,"Day High:"),X(),U(3,"span",40),ce(4),yr(5,"number"),X()()),r&2){let e=E(4);S(4),rt("\u20B9",mi(5,1,e.hoveredStock==null?null:e.hoveredStock.dayHigh,"1.2-2"))}}function kf(r,t){if(r&1&&(U(0,"div",38)(1,"span",39),ce(2,"Day Low:"),X(),U(3,"span",40),ce(4),yr(5,"number"),X()()),r&2){let e=E(4);S(4),rt("\u20B9",mi(5,1,e.hoveredStock==null?null:e.hoveredStock.dayLow,"1.2-2"))}}function If(r,t){if(r&1&&(U(0,"div",36),he(1,Ef,6,4,"div",37)(2,kf,6,4,"div",37),X()),r&2){let e=E(3);S(),M("ngIf",e.hoveredStock==null?null:e.hoveredStock.dayHigh),S(),M("ngIf",e.hoveredStock==null?null:e.hoveredStock.dayLow)}}function Ff(r,t){if(r&1&&(U(0,"div",41)(1,"div",38)(2,"span",39),ce(3,"Volume:"),X(),U(4,"span",40),ce(5),yr(6,"number"),X()()()),r&2){let e=E(3);S(5),Ne(Yn(6,1,e.hoveredStock==null?null:e.hoveredStock.volume))}}function Of(r,t){if(r&1&&(U(0,"div",33),he(1,Tf,3,2,"div",34)(2,If,3,2,"div",34)(3,Ff,7,3,"div",35),X()),r&2){let e=E(2);S(),M("ngIf",(e.hoveredStock==null?null:e.hoveredStock.openPrice)||(e.hoveredStock==null?null:e.hoveredStock.previousClose)),S(),M("ngIf",(e.hoveredStock==null?null:e.hoveredStock.dayHigh)||(e.hoveredStock==null?null:e.hoveredStock.dayLow)),S(),M("ngIf",e.hoveredStock==null?null:e.hoveredStock.volume)}}function Af(r,t){if(r&1&&(U(0,"div",21),he(1,vf,2,1,"div",22)(2,wf,3,2,"div",23)(3,Cf,1,0,"div",24)(4,Of,4,3,"div",25),X()),r&2){let e=E();S(),M("ngIf",e.hoveredStock==null?null:e.hoveredStock.companyName),S(),M("ngIf",(e.hoveredStock==null?null:e.hoveredStock.industry)||(e.hoveredStock==null?null:e.hoveredStock.sector)),S(),M("ngIf",((e.hoveredStock==null?null:e.hoveredStock.industry)||(e.hoveredStock==null?null:e.hoveredStock.sector))&&e.hasNumericalData(e.hoveredStock)),S(),M("ngIf",e.hasNumericalData(e.hoveredStock))}}var To=(()=>{let t=class t{constructor(i){this.cdr=i,this.stocks=[],this.isLoadingStocks=!1,this.stockSelected=new ye,this.refreshRequested=new ye,this.searchQuery="",this.isSearching=!1,this.searchResults=[],this.globalFilterValue="",this.hoveredStock=null,this.previousStocksLength=0,this.previousIsLoading=!1}ngOnInit(){this.updateStocksFromWidget()}ngOnChanges(){this.updateStocksFromWidget()}ngDoCheck(){let i=this.widget?.data?.stocks?.length||0,n=this.widget?.data?.isLoadingStocks||!1;(i!==this.previousStocksLength||n!==this.previousIsLoading)&&(this.previousStocksLength=i,this.previousIsLoading=n,this.updateStocksFromWidget(),this.cdr.detectChanges())}updateStocksFromWidget(){this.widget?.data?.stocks&&this.widget.data.stocks.length>0?(this.stocks=this.widget.data.stocks,this.isLoadingStocks=this.widget.data.isLoadingStocks||!1):(!this.stocks||this.stocks.length===0)&&(this.stocks=[])}trackBySymbol(i,n){return n.symbol||""}searchStocks(i){if(!i||i.trim()===""){this.searchResults=[];return}this.isSearching=!0;let n=i.toLowerCase().trim();this.searchResults=this.stocks.filter(s=>s.symbol?.toLowerCase().includes(n)||s.companyName?.toLowerCase().includes(n)).map(s=>T({},s)),this.isSearching=!1}addStockFromSearch(i){this.stocks.some(s=>s.symbol===i.symbol)||(this.stocks.push(i),this.searchResults=[],this.searchQuery="")}onRowClick(i){let n={id:i.symbol||"unknown",symbol:i.symbol||"",name:i.companyName||i.symbol||"",lastPrice:i.lastPrice||0,priceChange:i.priceChange||0,percentChange:i.percentChange||0,volume:i.volume,dayHigh:i.dayHigh,dayLow:i.dayLow,industry:i.industry,sector:i.sector};this.stockSelected.emit(n)}refreshStocks(){this.refreshRequested.emit()}setHoveredStock(i){this.hoveredStock=i}clearHoveredStock(){this.hoveredStock=null}hasNumericalData(i){return i?i.volume!==void 0&&i.volume!==null||i.dayHigh!==void 0&&i.dayHigh!==null||i.dayLow!==void 0&&i.dayLow!==null||i.openPrice!==void 0&&i.openPrice!==null||i.previousClose!==void 0&&i.previousClose!==null:!1}loadSampleData(){let i=[{symbol:"RELIANCE",companyName:"Reliance Industries Limited",lastPrice:2456.75,priceChange:23.5,percentChange:.97,volume:1234567,dayHigh:2478.9,dayLow:2445.2,openPrice:2450,previousClose:2433.25,industry:"Oil & Gas",sector:"Energy"},{symbol:"TCS",companyName:"Tata Consultancy Services Limited",lastPrice:3567.8,priceChange:-15.25,percentChange:-.43,volume:987654,dayHigh:3590,dayLow:3555.5,openPrice:3580,previousClose:3583.05,industry:"Information Technology",sector:"IT"},{symbol:"INFY",companyName:"Infosys Limited",lastPrice:1456.3,priceChange:8.75,percentChange:.6,volume:2345678,dayHigh:1465,dayLow:1445.8,openPrice:1450,previousClose:1447.55,industry:"Information Technology",sector:"IT"},{symbol:"HDFC",companyName:"HDFC Bank Limited",lastPrice:1678.9,priceChange:12.4,percentChange:.74,volume:1876543,dayHigh:1685.5,dayLow:1665.2,openPrice:1670,previousClose:1666.5,industry:"Banking",sector:"Financial Services"},{symbol:"ICICI",companyName:"ICICI Bank Limited",lastPrice:987.65,priceChange:-5.3,percentChange:-.53,volume:3456789,dayHigh:995,dayLow:982.5,openPrice:990,previousClose:992.95,industry:"Banking",sector:"Financial Services"}];this.stocks=i,this.isLoadingStocks=!1,this.widget?.data&&(this.widget.data.stocks=i,this.widget.data.isLoadingStocks=!1)}};t.\u0275fac=function(n){return new(n||t)(We($r))},t.\u0275cmp=Oe({type:t,selectors:[["app-stock-list-table"]],viewQuery:function(n,s){if(n&1&&tt(df,5),n&2){let a;Ie(a=Fe())&&(s.stockTooltipTemplate=a.first)}},inputs:{widget:"widget",stocks:"stocks",isLoadingStocks:"isLoadingStocks"},outputs:{stockSelected:"stockSelected",refreshRequested:"refreshRequested"},features:[Ar],decls:7,vars:4,consts:[["stockTooltipTemplate",""],["scrollHeight","90vh","styleClass","p-datatable-sm","selectionMode","single",3,"value","globalFilterFields","scrollable"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pSortableColumn","symbol",2,"min-width","120px"],["field","symbol"],["pSortableColumn","lastPrice",1,"text-right",2,"min-width","100px"],["field","lastPrice"],["pSortableColumn","priceChange",1,"text-right",2,"min-width","100px"],["field","priceChange"],["pSortableColumn","percentChange",1,"text-right",2,"min-width","100px"],["field","percentChange"],["tooltipPosition","top","tooltipStyleClass","stock-tooltip",1,"stock-row","cursor-pointer",3,"click","mouseenter","mouseleave","pTooltip"],[1,"text-right"],[3,"ngClass"],["colspan","9",1,"text-center","p-4"],[1,"flex","flex-column","align-items-center","gap-3"],[1,"pi","pi-chart-line","text-4xl","text-400"],[1,"text-lg","text-600"],["label","Load Sample Data","icon","pi pi-plus","size","small",3,"onClick"],[1,"stock-tooltip-content"],["class","tooltip-header",4,"ngIf"],["class","tooltip-industry-sector",4,"ngIf"],["class","tooltip-separator",4,"ngIf"],["class","tooltip-data-section",4,"ngIf"],[1,"tooltip-header"],[1,"tooltip-industry-sector"],["class","industry",4,"ngIf"],["class","sector",4,"ngIf"],[1,"industry"],[1,"sector"],[1,"tooltip-separator"],[1,"tooltip-data-section"],["class","tooltip-data-row",4,"ngIf"],["class","tooltip-data-row single-item",4,"ngIf"],[1,"tooltip-data-row"],["class","data-item",4,"ngIf"],[1,"data-item"],[1,"label"],[1,"value"],[1,"tooltip-data-row","single-item"]],template:function(n,s){n&1&&(U(0,"p-card")(1,"p-table",1),he(2,mf,13,0,"ng-template",2)(3,gf,16,24,"ng-template",3)(4,xf,7,0,"ng-template",4),X()(),he(5,Af,5,4,"ng-template",null,0,cr)),n&2&&(S(),M("value",s.stocks)("globalFilterFields",vr(3,pf))("scrollable",!0))},dependencies:[Be,Ps,Rt,wi,ac,sc,Cr,yi,_i,fc,cc,hc,uc,dc,ln,oc,pc,js,Ys,Ur,vi,Bl],styles:[".category-row[_ngcontent-%COMP%]{background-color:#f8f9fa}.stock-row[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.p-card[_ngcontent-%COMP%]{margin-bottom:1rem}.p-datatable[_ngcontent-%COMP%]   .p-datatable-tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{padding:.75rem}.text-green-600[_ngcontent-%COMP%]{color:#16a34a}.text-red-600[_ngcontent-%COMP%]{color:#dc2626}.p-inputgroup[_ngcontent-%COMP%]{display:flex!important;flex-wrap:nowrap!important;align-items:stretch!important;width:100%!important}.p-inputgroup[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{min-width:0!important;flex:1 1 auto!important}[_nghost-%COMP%]     .stock-tooltip{max-width:none!important;opacity:1!important;border:none!important;transform:translate(-50px)!important}[_nghost-%COMP%]     .stock-tooltip .p-tooltip-text{width:420px!important;min-width:420px!important;max-width:420px!important;padding:0!important;margin:0!important;font-size:.875rem!important;line-height:1.4!important;background:#fafafa!important;background-color:#fafafa!important;border:none!important;border-width:0!important;border-style:none!important;outline:none!important;border-radius:8px!important;box-shadow:0 3px 12px #0000001f!important;color:#333!important;overflow:visible!important}[_nghost-%COMP%]     .stock-tooltip .p-tooltip-arrow{border-top-color:#fafafa!important;border-color:#fafafa transparent transparent transparent!important;border-left:none!important;border-right:none!important;border-bottom:none!important}[_nghost-%COMP%]     .p-tooltip{border:none!important;outline:none!important}[_nghost-%COMP%]     .p-tooltip *{border:none!important;outline:none!important;box-shadow:none!important;border-radius:0!important;margin:0!important;padding:0!important}[_nghost-%COMP%]     [class*=tooltip]{border:none!important;outline:none!important;box-shadow:none!important;border-radius:0!important;margin:0!important;padding:0!important}.stock-tooltip-content[_ngcontent-%COMP%]{padding:18px;background-color:#fafafa;border-radius:8px;width:360px;box-sizing:border-box}.stock-tooltip-content[_ngcontent-%COMP%]   .tooltip-header[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem;color:#1f2937;margin-bottom:8px;text-align:center}.stock-tooltip-content[_ngcontent-%COMP%]   .tooltip-industry-sector[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;padding:8px 12px;background-color:#f8fafc;border-radius:4px}.stock-tooltip-content[_ngcontent-%COMP%]   .tooltip-industry-sector[_ngcontent-%COMP%]   .industry[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.stock-tooltip-content[_ngcontent-%COMP%]   .tooltip-industry-sector[_ngcontent-%COMP%]   .sector[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500;text-align:right}.stock-tooltip-content[_ngcontent-%COMP%]   .tooltip-separator[_ngcontent-%COMP%]{height:1px;background-color:#e5e7eb;margin:12px 0}.stock-tooltip-content[_ngcontent-%COMP%]   .tooltip-data-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.stock-tooltip-content[_ngcontent-%COMP%]   .tooltip-data-section[_ngcontent-%COMP%]   .tooltip-data-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:24px;padding:8px 0}.stock-tooltip-content[_ngcontent-%COMP%]   .tooltip-data-section[_ngcontent-%COMP%]   .tooltip-data-row[_ngcontent-%COMP%]:not(:last-child){border-bottom:1px solid #f1f5f9;padding-bottom:10px}.stock-tooltip-content[_ngcontent-%COMP%]   .tooltip-data-section[_ngcontent-%COMP%]   .tooltip-data-row.single-item[_ngcontent-%COMP%]{grid-template-columns:1fr;justify-items:center;padding:10px;background-color:#f8fafc;border-radius:4px;border-bottom:none!important}.stock-tooltip-content[_ngcontent-%COMP%]   .tooltip-data-section[_ngcontent-%COMP%]   .tooltip-data-row[_ngcontent-%COMP%]   .data-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px;white-space:nowrap}.stock-tooltip-content[_ngcontent-%COMP%]   .tooltip-data-section[_ngcontent-%COMP%]   .tooltip-data-row[_ngcontent-%COMP%]   .data-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.65rem;color:#6b7280;font-weight:600;text-transform:uppercase;letter-spacing:.05em}.stock-tooltip-content[_ngcontent-%COMP%]   .tooltip-data-section[_ngcontent-%COMP%]   .tooltip-data-row[_ngcontent-%COMP%]   .data-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:.85rem;color:#333;font-weight:600;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}"]});let r=t;return r})();function Df(r,t){r&1&&zt(0)}var Gc=r=>{switch(r?.config?.component){case"echart":return ea;case"filter":return Nc;case"table":return Bc;case"tile":return Hc;case"stock-tile":return Vc;case"markdownCell":return Wc;case"codeCell":return $c;case"stock-list-table":return To;default:return ea}},Xc=(()=>{let t=class t{constructor(){this.viewMode="chart",this.onDataLoad=new ye,this.onUpdateFilter=new ye,this.originalWidget=null,this.tableWidget=null,this.cachedCurrentWidget=null,this.lastWidgetId=null,this.lastViewMode=null}get currentWidget(){let i=this.widget?.id,n=this.viewMode;if(this.cachedCurrentWidget&&this.lastWidgetId===i&&this.lastViewMode===n)return this.cachedCurrentWidget;let s=this.getWidgetForCurrentMode();return this.cachedCurrentWidget={component:Gc(s),inputs:{widget:s,onDataLoad:this.onDataLoad,onUpdateFilter:this.onUpdateFilter}},this.lastWidgetId=i,this.lastViewMode=n,this.cachedCurrentWidget}get isEchartComponent(){let i=this.getWidgetForCurrentMode();return Gc(i)===ea}getWidgetForCurrentMode(){return this.viewMode==="table"?this.getTableWidget():this.getOriginalWidget()}getOriginalWidget(){return this.originalWidget||(this.originalWidget=T({},this.widget)),this.originalWidget}getTableWidget(){return this.tableWidget||(this.tableWidget=this.createTableWidget()),this.tableWidget}createTableWidget(){let i=this.getOriginalWidget(),n=this.getDataExtractor(i),s=[],a=[];n?(s=n.getHeaders(i),a=n.extractData(i).map((l,h)=>{let u={};return s.forEach((f,p)=>{u[f]=l[p]||""}),u})):(s=["Property","Value"],a=[{Property:"Widget ID",Value:i.id},{Property:"Component Type",Value:i.config?.component||"Unknown"},{Property:"Title",Value:i.config?.header?.title||"Untitled"}]);let o={columns:s,data:a};return B(T({},i),{config:B(T({},i.config),{component:"table",options:o})})}getDataExtractor(i){let n=i.config?.component;if(n==="echart"){let s=this.getChartType(i);if(s)return this.getChartDataExtractor(s)}else return n==="table"?{extractData:s=>s.config?.options?.data||[],getHeaders:s=>s.config?.options?.columns||[],getSheetName:s=>this.getWidgetSheetName(s,"Table")}:n==="tile"?{extractData:s=>{let a=s.config?.options;return[[a?.value||"",a?.change||"",a?.changeType||"",a?.description||""]]},getHeaders:()=>["Value","Change","Type","Description"],getSheetName:s=>this.getWidgetSheetName(s,"Tile")}:this.getGenericDataExtractor()}getChartType(i){return i.config?.component==="echart"&&i.config?.options?.series?.[0]?.type?i.config.options.series[0].type:null}getChartDataExtractor(i){switch(i){case"pie":return{extractData:n=>{let s=n.config?.options?.series?.[0];return s?.data?s.data.map(a=>[a.name||"Unknown",a.value||0,this.calculatePercentage(a.value,s.data)]):[]},getHeaders:()=>["Category","Value","Percentage"],getSheetName:n=>this.getWidgetSheetName(n,"PieChart")};case"bar":return{extractData:n=>{let s=n.config?.options?.series?.[0],a=n.config?.options?.xAxis;if(!s?.data)return[];let o=[];return a&&(Array.isArray(a)?o=a[0]?.data||[]:a.data&&(o=a.data)),o.length===0&&(o=s.data.map((c,l)=>`Category ${l+1}`)),s.data.map((c,l)=>[o[l]||`Category ${l+1}`,c||0])},getHeaders:()=>["Category","Value"],getSheetName:n=>this.getWidgetSheetName(n,"BarChart")};case"line":return{extractData:n=>{let s=n.config?.options?.series,a=n.config?.options?.xAxis;if(!s||s.length===0)return[];let o=[];a&&(Array.isArray(a)?o=a[0]?.data||[]:a.data&&(o=a.data)),o.length===0&&s[0]?.data&&(o=s[0].data.map((l,h)=>`Point ${h+1}`));let c=[];return s.forEach((l,h)=>{l.data&&l.data.forEach((u,f)=>{h===0&&(c[f]=[o[f]||`Point ${f+1}`]),c[f]&&c[f].push(u||0)})}),c},getHeaders:n=>{let s=n.config?.options?.series;return!s||s.length===0?["Category"]:["Category",...s.map(a=>a.name||"Series")]},getSheetName:n=>this.getWidgetSheetName(n,"LineChart")};case"scatter":return{extractData:n=>{let s=n.config?.options?.series?.[0];return s?.data?s.data.map(a=>[a.name||"Point",Array.isArray(a.value)?a.value[0]||0:a.value||0,Array.isArray(a.value)?a.value[1]||0:""]):[]},getHeaders:()=>["Name","X","Y"],getSheetName:n=>this.getWidgetSheetName(n,"ScatterChart")};default:return this.getGenericDataExtractor()}}getGenericDataExtractor(){return{extractData:i=>{let n=[];if(n.push(["Widget ID",i.id]),n.push(["Component Type",i.config?.component||"Unknown"]),n.push(["Title",i.config?.header?.title||"Untitled"]),i.config?.options){let s=i.config.options;Object.keys(s).forEach(a=>{(typeof s[a]!="object"||s[a]===null)&&n.push([a,s[a]])})}return i.series&&i.series.length>0&&n.push(["Series Data",JSON.stringify(i.series)]),n},getHeaders:()=>["Property","Value"],getSheetName:i=>this.getWidgetSheetName(i,"Widget")}}getWidgetSheetName(i,n){let s=i.config?.header?.title||i.id;return`${n}_${s}`.replace(/[^a-zA-Z0-9_]/g,"_").substring(0,31)}calculatePercentage(i,n){let s=n.reduce((a,o)=>a+(o.value||0),0);return s===0?"0%":`${(i/s*100).toFixed(1)}%`}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-widget"]],inputs:{widget:"widget",viewMode:"viewMode"},outputs:{onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},features:[or([Js({echarts:()=>import("./chunk-6WF3YY7L.js")})])],decls:2,vars:4,consts:[[4,"ngComponentOutlet","ngComponentOutletInputs"]],template:function(n,s){n&1&&(U(0,"div"),he(1,Df,1,0,"ng-container",0),X()),n&2&&(ct("height",s.widget.height,"px"),S(),M("ngComponentOutlet",s.currentWidget.component)("ngComponentOutletInputs",s.currentWidget.inputs))},dependencies:[Rl],encapsulation:2});let r=t;return r})();var jc=`
    .p-drawer {
        display: flex;
        flex-direction: column;
        transform: translate3d(0px, 0px, 0px);
        position: relative;
        transition: transform 0.3s;
        background: dt('drawer.background');
        color: dt('drawer.color');
        border: 1px solid dt('drawer.border.color');
        box-shadow: dt('drawer.shadow');
    }

    .p-drawer-content {
        overflow-y: auto;
        flex-grow: 1;
        padding: dt('drawer.content.padding');
    }

    .p-drawer-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-shrink: 0;
        padding: dt('drawer.header.padding');
    }

    .p-drawer-footer {
        padding: dt('drawer.footer.padding');
    }

    .p-drawer-title {
        font-weight: dt('drawer.title.font.weight');
        font-size: dt('drawer.title.font.size');
    }

    .p-drawer-full .p-drawer {
        transition: none;
        transform: none;
        width: 100vw !important;
        height: 100vh !important;
        max-height: 100%;
        top: 0px !important;
        left: 0px !important;
        border-width: 1px;
    }

    .p-drawer-left .p-drawer-enter-from,
    .p-drawer-left .p-drawer-leave-to {
        transform: translateX(-100%);
    }

    .p-drawer-right .p-drawer-enter-from,
    .p-drawer-right .p-drawer-leave-to {
        transform: translateX(100%);
    }

    .p-drawer-top .p-drawer-enter-from,
    .p-drawer-top .p-drawer-leave-to {
        transform: translateY(-100%);
    }

    .p-drawer-bottom .p-drawer-enter-from,
    .p-drawer-bottom .p-drawer-leave-to {
        transform: translateY(100%);
    }

    .p-drawer-full .p-drawer-enter-from,
    .p-drawer-full .p-drawer-leave-to {
        opacity: 0;
    }

    .p-drawer-full .p-drawer-enter-active,
    .p-drawer-full .p-drawer-leave-active {
        transition: opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1);
    }

    .p-drawer-left .p-drawer {
        width: 20rem;
        height: 100%;
        border-inline-end-width: 1px;
    }

    .p-drawer-right .p-drawer {
        width: 20rem;
        height: 100%;
        border-inline-start-width: 1px;
    }

    .p-drawer-top .p-drawer {
        height: 10rem;
        width: 100%;
        border-block-end-width: 1px;
    }

    .p-drawer-bottom .p-drawer {
        height: 10rem;
        width: 100%;
        border-block-start-width: 1px;
    }

    .p-drawer-left .p-drawer-content,
    .p-drawer-right .p-drawer-content,
    .p-drawer-top .p-drawer-content,
    .p-drawer-bottom .p-drawer-content {
        width: 100%;
        height: 100%;
    }

    .p-drawer-open {
        display: flex;
    }

    .p-drawer-mask:dir(rtl) {
        flex-direction: row-reverse;
    }
`;var Mf=["header"],Pf=["footer"],Lf=["content"],Rf=["closeicon"],Nf=["headless"],Bf=["container"],Hf=["closeButton"],Vf=["*"],Wf=(r,t)=>({transform:r,transition:t}),$f=r=>({value:"visible",params:r});function zf(r,t){r&1&&zt(0)}function Uf(r,t){if(r&1&&he(0,zf,1,0,"ng-container",4),r&2){let e=E(2);M("ngTemplateOutlet",e.headlessTemplate||e._headlessTemplate)}}function Gf(r,t){r&1&&zt(0)}function Xf(r,t){if(r&1&&(U(0,"div"),ce(1),X()),r&2){let e=E(3);Te(e.cx("title")),S(),Ne(e.header)}}function jf(r,t){r&1&&(Pi(),xe(0,"svg",11)),r&2&&Ae("data-pc-section","closeicon")}function Yf(r,t){}function Kf(r,t){r&1&&he(0,Yf,0,0,"ng-template")}function qf(r,t){if(r&1&&he(0,jf,1,1,"svg",10)(1,Kf,1,0,null,4),r&2){let e=E(4);M("ngIf",!e.closeIconTemplate&&!e._closeIconTemplate),S(),M("ngTemplateOutlet",e.closeIconTemplate||e._closeIconTemplate)}}function Zf(r,t){if(r&1){let e=Se();U(0,"p-button",9),Ce("onClick",function(n){J(e);let s=E(3);return ee(s.close(n))})("keydown.enter",function(n){J(e);let s=E(3);return ee(s.close(n))}),he(1,qf,2,2,"ng-template",null,1,cr),X()}if(r&2){let e=E(3);M("ngClass",e.cx("pcCloseButton"))("buttonProps",e.closeButtonProps)("ariaLabel",e.ariaCloseLabel),Ae("data-pc-section","closebutton")("data-pc-group-section","iconcontainer")}}function Qf(r,t){r&1&&zt(0)}function Jf(r,t){r&1&&zt(0)}function ed(r,t){if(r&1&&(qt(0),U(1,"div",5),he(2,Jf,1,0,"ng-container",4),X(),Zt()),r&2){let e=E(3);S(),M("ngClass",e.cx("footer")),Ae("data-pc-section","footer"),S(),M("ngTemplateOutlet",e.footerTemplate||e._footerTemplate)}}function td(r,t){if(r&1&&(U(0,"div",5),he(1,Gf,1,0,"ng-container",4)(2,Xf,2,3,"div",6)(3,Zf,3,5,"p-button",7),X(),U(4,"div",5),jn(5),he(6,Qf,1,0,"ng-container",4),X(),he(7,ed,3,3,"ng-container",8)),r&2){let e=E(2);M("ngClass",e.cx("header")),Ae("data-pc-section","header"),S(),M("ngTemplateOutlet",e.headerTemplate||e._headerTemplate),S(),M("ngIf",e.header),S(),M("ngIf",e.showCloseIcon&&e.closable),S(),M("ngClass",e.cx("content")),Ae("data-pc-section","content"),S(2),M("ngTemplateOutlet",e.contentTemplate||e._contentTemplate),S(),M("ngIf",e.footerTemplate||e._footerTemplate)}}function rd(r,t){if(r&1){let e=Se();U(0,"div",3,0),Ce("@panelState.start",function(n){J(e);let s=E();return ee(s.onAnimationStart(n))})("@panelState.done",function(n){J(e);let s=E();return ee(s.onAnimationEnd(n))})("keydown",function(n){J(e);let s=E();return ee(s.onKeyDown(n))}),gt(2,Uf,1,1,"ng-container")(3,td,8,9),X()}if(r&2){let e=E();kt(e.style),Te(e.cn(e.cx("root"),e.styleClass)),M("@panelState",lr(11,$f,_r(8,Wf,e.transformOptions,e.transitionOptions))),Ae("data-pc-name","sidebar")("data-pc-section","root"),S(2),xt(e.headlessTemplate||e._headlessTemplate?2:3)}}var id=`
    ${jc}

    /** For PrimeNG **/
    .p-drawer {
        position: fixed;
        display: flex;
        flex-direction: column;
    }

    .p-drawer-left {
        top: 0;
        left: 0;
        width: 20rem;
        height: 100%;
    }

    .p-drawer-right {
        top: 0;
        right: 0;
        width: 20rem;
        height: 100%;
    }

    .p-drawer-top {
        top: 0;
        left: 0;
        width: 100%;
        height: 10rem;
    }

    .p-drawer-bottom {
        bottom: 0;
        left: 0;
        width: 100%;
        height: 10rem;
    }

    .p-drawer-full {
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        -webkit-transition: none;
        transition: none;
    }

    .p-overlay-mask-enter {
        animation: p-overlay-mask-enter-animation 150ms forwards;
    }

    .p-overlay-mask-leave {
        animation: p-overlay-mask-leave-animation 150ms forwards;
    }

    @keyframes p-overlay-mask-enter-animation {
        from {
            background-color: transparent;
        }
        to {
            background-color: rgba(0, 0, 0, 0.4);
        }
    }
    @keyframes p-overlay-mask-leave-animation {
        from {
            background-color: rgba(0, 0, 0, 0.4);
        }
        to {
            background-color: transparent;
        }
    }
`,nd={mask:({instance:r})=>["p-drawer-mask",{"p-overlay-mask p-overlay-mask-enter":r.modal},{"p-drawer-full":r.fullScreen}],root:({instance:r})=>["p-drawer p-component",{"p-drawer-full":r.fullScreen,"p-drawer-open":r.visible},`p-drawer-${r.position}`],header:"p-drawer-header",title:"p-drawer-title",pcCloseButton:"p-drawer-close-button",content:"p-drawer-content",footer:"p-drawer-footer"},Yc=(()=>{class r extends xi{name="drawer";theme=id;classes=nd;static \u0275fac=(()=>{let e;return function(n){return(e||(e=Dr(r)))(n||r)}})();static \u0275prov=ar({token:r,factory:r.\u0275fac})}return r})();var sd=to([ri({transform:"{{transform}}",opacity:0}),ti("{{transition}}")]),ad=to([ti("{{transition}}",ri({transform:"{{transform}}",opacity:0}))]),Eo=(()=>{class r extends zr{appendTo="body";blockScroll=!1;style;styleClass;ariaCloseLabel;autoZIndex=!0;baseZIndex=0;modal=!0;closeButtonProps={severity:"secondary",text:!0,rounded:!0};dismissible=!0;showCloseIcon=!0;closeOnEscape=!0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";get visible(){return this._visible}set visible(e){this._visible=e}get position(){return this._position}set position(e){if(this._position=e,e==="full"){this.transformOptions="none";return}switch(e){case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break}}get fullScreen(){return this._fullScreen}set fullScreen(e){this._fullScreen=e,e&&(this.transformOptions="none")}header;maskStyle;closable=!0;onShow=new ye;onHide=new ye;visibleChange=new ye;containerViewChild;closeButtonViewChild;initialized;_visible;_position="left";_fullScreen=!1;container;transformOptions="translate3d(-100%, 0px, 0px)";mask;maskClickListener;documentEscapeListener;animationEndListener;_componentStyle=Et(Yc);ngAfterViewInit(){super.ngAfterViewInit(),this.initialized=!0}headerTemplate;footerTemplate;contentTemplate;closeIconTemplate;headlessTemplate;_headerTemplate;_footerTemplate;_contentTemplate;_closeIconTemplate;_headlessTemplate;templates;ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this._contentTemplate=e.template;break;case"header":this._headerTemplate=e.template;break;case"footer":this._footerTemplate=e.template;break;case"closeicon":this._closeIconTemplate=e.template;break;case"headless":this._headlessTemplate=e.template;break;default:this._contentTemplate=e.template;break}})}onKeyDown(e){e.code==="Escape"&&this.hide(!1)}show(){this.container.setAttribute(this.attrSelector,""),this.autoZIndex&&ur.set("modal",this.container,this.baseZIndex||this.config.zIndex.modal),this.modal&&this.enableModality(),this.onShow.emit({}),this.visibleChange.emit(!0)}hide(e=!0){e&&this.onHide.emit({}),this.modal&&this.disableModality()}close(e){this.hide(),this.visibleChange.emit(!1),e.preventDefault()}enableModality(){let e=this.document.querySelectorAll(".p-drawer-open"),i=e.length,n=i==1?String(parseInt(this.container.style.zIndex)-1):String(parseInt(e[i-1].style.zIndex)-1);this.mask||(this.mask=this.renderer.createElement("div"),Za(this.mask,"style",this.getMaskStyle()),Za(this.mask,"style",`z-index: ${n}`),qa(this.mask,this.cx("mask")),this.dismissible&&(this.maskClickListener=this.renderer.listen(this.mask,"click",s=>{this.dismissible&&this.close(s)})),this.renderer.appendChild(this.document.body,this.mask),this.blockScroll&&Yl())}getMaskStyle(){return this.maskStyle?Object.entries(this.maskStyle).map(([e,i])=>`${e}: ${i}`).join("; "):""}disableModality(){this.mask&&(Hl(this.mask,"p-overlay-mask-enter"),qa(this.mask,"p-overlay-mask-leave"),this.animationEndListener=this.renderer.listen(this.mask,"animationend",this.destroyModal.bind(this)))}destroyModal(){this.unbindMaskClickListener(),this.mask&&this.renderer.removeChild(this.document.body,this.mask),this.blockScroll&&Kl(),this.unbindAnimationEndListener(),this.mask=null}onAnimationStart(e){switch(e.toState){case"visible":this.container=e.element,this.appendContainer(),this.show(),this.closeOnEscape&&this.bindDocumentEscapeListener();break}}onAnimationEnd(e){switch(e.toState){case"void":this.hide(!1),ur.clear(this.container),this.unbindGlobalListeners();break}}appendContainer(){this.appendTo&&(this.appendTo==="body"?this.renderer.appendChild(this.document.body,this.container):Vs(this.appendTo,this.container))}bindDocumentEscapeListener(){let e=this.el?this.el.nativeElement.ownerDocument:this.document;this.documentEscapeListener=this.renderer.listen(e,"keydown",i=>{i.which==27&&parseInt(this.container.style.zIndex)===ur.get(this.container)&&this.close(i)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}unbindGlobalListeners(){this.unbindMaskClickListener(),this.unbindDocumentEscapeListener()}unbindAnimationEndListener(){this.animationEndListener&&this.mask&&(this.animationEndListener(),this.animationEndListener=null)}ngOnDestroy(){this.initialized=!1,this.visible&&this.modal&&this.destroyModal(),this.appendTo&&this.container&&this.renderer.appendChild(this.el.nativeElement,this.container),this.container&&this.autoZIndex&&ur.clear(this.container),this.container=null,this.unbindGlobalListeners(),this.unbindAnimationEndListener()}static \u0275fac=(()=>{let e;return function(n){return(e||(e=Dr(r)))(n||r)}})();static \u0275cmp=Oe({type:r,selectors:[["p-drawer"]],contentQueries:function(i,n,s){if(i&1&&(nt(s,Mf,4),nt(s,Pf,4),nt(s,Lf,4),nt(s,Rf,4),nt(s,Nf,4),nt(s,Cr,4)),i&2){let a;Ie(a=Fe())&&(n.headerTemplate=a.first),Ie(a=Fe())&&(n.footerTemplate=a.first),Ie(a=Fe())&&(n.contentTemplate=a.first),Ie(a=Fe())&&(n.closeIconTemplate=a.first),Ie(a=Fe())&&(n.headlessTemplate=a.first),Ie(a=Fe())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&(tt(Bf,5),tt(Hf,5)),i&2){let s;Ie(s=Fe())&&(n.containerViewChild=s.first),Ie(s=Fe())&&(n.closeButtonViewChild=s.first)}},inputs:{appendTo:"appendTo",blockScroll:[2,"blockScroll","blockScroll",Ue],style:"style",styleClass:"styleClass",ariaCloseLabel:"ariaCloseLabel",autoZIndex:[2,"autoZIndex","autoZIndex",Ue],baseZIndex:[2,"baseZIndex","baseZIndex",hr],modal:[2,"modal","modal",Ue],closeButtonProps:"closeButtonProps",dismissible:[2,"dismissible","dismissible",Ue],showCloseIcon:[2,"showCloseIcon","showCloseIcon",Ue],closeOnEscape:[2,"closeOnEscape","closeOnEscape",Ue],transitionOptions:"transitionOptions",visible:"visible",position:"position",fullScreen:"fullScreen",header:"header",maskStyle:"maskStyle",closable:[2,"closable","closable",Ue]},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange"},features:[or([Yc]),Pr],ngContentSelectors:Vf,decls:1,vars:1,consts:[["container",""],["icon",""],["role","complementary",3,"class","style","keydown",4,"ngIf"],["role","complementary",3,"keydown"],[4,"ngTemplateOutlet"],[3,"ngClass"],[3,"class",4,"ngIf"],[3,"ngClass","buttonProps","ariaLabel","onClick","keydown.enter",4,"ngIf"],[4,"ngIf"],[3,"onClick","keydown.enter","ngClass","buttonProps","ariaLabel"],["data-p-icon","times",4,"ngIf"],["data-p-icon","times"]],template:function(i,n){i&1&&(Xn(),he(0,rd,4,13,"div",2)),i&2&&M("ngIf",n.visible)},dependencies:[Be,Ps,Rt,Jr,_i,Xl,Nt],encapsulation:2,data:{animation:[on("panelState",[ii("void => visible",[ro(sd)]),ii("visible => void",[ro(ad)])])]},changeDetection:0})}return r})(),Kc=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=Mr({type:r});static \u0275inj=Or({imports:[Eo,Nt,Nt]})}return r})();var hd=()=>({height:"85vh",width:"100%","overflow-x":"hidden",overflow:"auto"}),qc=(()=>{let t=class t{constructor(){this.sidebarVisible=!0,this.onUpdate=new ye,this.formModel={},this.items=[{label:"Positions",value:0},{label:"Options",value:1},{label:"Data Options",value:2}],this.activeItem=this.items[0],this.formWidgetOptions=new Xs({}),this.form=new Xs({}),this.formSeriesOptions=new Xs({})}set widget(i){this._widget=i,setTimeout(()=>{this.formWidgetOptions.patchValue({position:i?.position,config:i?.config})},1e3)}get title(){return this.widget?.config?.header?.title}ngOnInit(){this.formModel={}}onActiveTabItemChange(i){this.activeItem=i}onWidgetSave(){let i=T(T({},this._widget),this.formModel);i.config.options.series=this.formModel.series,this.onUpdate.emit(i),this._widget&&this._widget.series&&this._widget.series?.push({})}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-widget-config"]],inputs:{selectedDashboardId:"selectedDashboardId",widget:"widget"},outputs:{onUpdate:"onUpdate"},decls:11,vars:7,consts:[["id","panelId",2,"height","100%","overflow-y","visible"],[3,"ngSubmit","formGroup"],[1,"form-buttons"],[1,"form-button"],["type","button","label","Save",3,"click","outlined"],["type","button","label","Edit",1,"ui-button-warning","ml-2","mr-2",3,"outlined"],["type","reset","label","Reset",1,"ui-button-danger",3,"outlined"],["position","bottom-right","key","br"]],template:function(n,s){n&1&&(U(0,"div",0)(1,"p-scrollPanel")(2,"form",1),Ce("ngSubmit",function(){return s.onWidgetSave()}),X()(),U(3,"div",2)(4,"div",3)(5,"p-button",4),Ce("click",function(){return s.onWidgetSave()}),X()(),U(6,"div",3),xe(7,"p-button",5),X(),U(8,"div",3),xe(9,"p-button",6),X()()(),xe(10,"p-toast",7)),n&2&&(S(),kt(vr(6,hd)),S(),M("formGroup",s.form),S(3),M("outlined",!0),S(2),M("outlined",!0),S(2),M("outlined",!0))},dependencies:[Be,wi,rc,ec,nc,ic,yi,_i,js,mc,Ks,Ys,ln,Gs,Us],styles:[".form-buttons[_ngcontent-%COMP%]{display:flex;justify-content:end;margin-top:2rem;padding:1.2rem;align-items:end;position:absolute;bottom:0;right:0}  .p-sidebar .p-sidebar-header .p-sidebar-close, .p-sidebar[_ngcontent-%COMP%]   .p-sidebar-header[_ngcontent-%COMP%]   .p-sidebar-icon[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-top-left-radius:5px;border-bottom-left-radius:5px;background:#fff;position:absolute;top:.625rem;padding:.4166666667rem!important;box-shadow:0 .125rem .25rem #00000014;z-index:20;left:-39px;height:3rem;width:3.25rem;color:red}  .form-alignment{margin-left:1rem;margin-right:1rem;width:86.2%}"]});let r=t;return r})();var Zc=`
    .p-menu {
        background: dt('menu.background');
        color: dt('menu.color');
        border: 1px solid dt('menu.border.color');
        border-radius: dt('menu.border.radius');
        min-width: 12.5rem;
    }

    .p-menu-list {
        margin: 0;
        padding: dt('menu.list.padding');
        outline: 0 none;
        list-style: none;
        display: flex;
        flex-direction: column;
        gap: dt('menu.list.gap');
    }

    .p-menu-item-content {
        transition:
            background dt('menu.transition.duration'),
            color dt('menu.transition.duration');
        border-radius: dt('menu.item.border.radius');
        color: dt('menu.item.color');
    }

    .p-menu-item-link {
        cursor: pointer;
        display: flex;
        align-items: center;
        text-decoration: none;
        overflow: hidden;
        position: relative;
        color: inherit;
        padding: dt('menu.item.padding');
        gap: dt('menu.item.gap');
        user-select: none;
        outline: 0 none;
    }

    .p-menu-item-label {
        line-height: 1;
    }

    .p-menu-item-icon {
        color: dt('menu.item.icon.color');
    }

    .p-menu-item.p-focus .p-menu-item-content {
        color: dt('menu.item.focus.color');
        background: dt('menu.item.focus.background');
    }

    .p-menu-item.p-focus .p-menu-item-icon {
        color: dt('menu.item.icon.focus.color');
    }

    .p-menu-item:not(.p-disabled) .p-menu-item-content:hover {
        color: dt('menu.item.focus.color');
        background: dt('menu.item.focus.background');
    }

    .p-menu-item:not(.p-disabled) .p-menu-item-content:hover .p-menu-item-icon {
        color: dt('menu.item.icon.focus.color');
    }

    .p-menu-overlay {
        box-shadow: dt('menu.shadow');
    }

    .p-menu-submenu-label {
        background: dt('menu.submenu.label.background');
        padding: dt('menu.submenu.label.padding');
        color: dt('menu.submenu.label.color');
        font-weight: dt('menu.submenu.label.font.weight');
    }

    .p-menu-separator {
        border-block-start: 1px solid dt('menu.separator.border.color');
    }
`;var fd=["pMenuItemContent",""],ra=r=>({$implicit:r}),dd=()=>({exact:!1}),pd=r=>({item:r});function md(r,t){r&1&&zt(0)}function gd(r,t){if(r&1&&(U(0,"a",6),he(1,md,1,0,"ng-container",7),X()),r&2){let e=E(2),i=Jt(4);Te(e.cx("itemLink")),M("target",e.item.target),Ae("title",e.item.title)("href",e.item.url||null,Fs)("data-automationid",e.item.automationId)("tabindex",-1)("data-pc-section","action"),S(),M("ngTemplateOutlet",i)("ngTemplateOutletContext",lr(10,ra,e.item))}}function xd(r,t){r&1&&zt(0)}function vd(r,t){if(r&1&&(U(0,"a",8),he(1,xd,1,0,"ng-container",7),X()),r&2){let e=E(2),i=Jt(4);Te(e.cx("itemLink")),M("routerLink",e.item.routerLink)("queryParams",e.item.queryParams)("routerLinkActiveOptions",e.item.routerLinkActiveOptions||vr(18,dd))("target",e.item.target)("fragment",e.item.fragment)("queryParamsHandling",e.item.queryParamsHandling)("preserveFragment",e.item.preserveFragment)("skipLocationChange",e.item.skipLocationChange)("replaceUrl",e.item.replaceUrl)("state",e.item.state),Ae("data-automationid",e.item.automationId)("tabindex",-1)("data-pc-section","action")("title",e.item.title),S(),M("ngTemplateOutlet",i)("ngTemplateOutletContext",lr(19,ra,e.item))}}function _d(r,t){if(r&1&&(qt(0),he(1,gd,2,12,"a",4)(2,vd,2,21,"a",5),Zt()),r&2){let e=E();S(),M("ngIf",!(e.item!=null&&e.item.routerLink)),S(),M("ngIf",e.item==null?null:e.item.routerLink)}}function yd(r,t){}function wd(r,t){r&1&&he(0,yd,0,0,"ng-template")}function Cd(r,t){if(r&1&&(qt(0),he(1,wd,1,0,null,7),Zt()),r&2){let e=E();S(),M("ngTemplateOutlet",e.itemTemplate)("ngTemplateOutletContext",lr(2,ra,e.item))}}function bd(r,t){if(r&1&&xe(0,"span"),r&2){let e=E(2);kt(e.item.iconStyle),Te(e.cx("itemIcon",lr(4,pd,e.item)))}}function Sd(r,t){if(r&1&&(U(0,"span"),ce(1),X()),r&2){let e=E(2);Te(e.cx("itemLabel")),S(),Ne(e.item.label)}}function Td(r,t){if(r&1&&xe(0,"span",12),r&2){let e=E(2);M("innerHTML",e.sanitizeHtml(e.item.label),pi)}}function Ed(r,t){if(r&1&&xe(0,"p-badge",13),r&2){let e=E(2);M("styleClass",e.item.badgeStyleClass)("value",e.item.badge)}}function kd(r,t){if(r&1&&he(0,bd,1,6,"span",9)(1,Sd,2,3,"span",10)(2,Td,1,1,"ng-template",null,1,cr)(4,Ed,1,2,"p-badge",11),r&2){let e=Jt(3),i=E();M("ngIf",i.item.icon),S(),M("ngIf",i.item.escape!==!1)("ngIfElse",e),S(3),M("ngIf",i.item.badge)}}var Id=["start"],Fd=["end"],Od=["header"],Ad=["item"],Dd=["submenuheader"],Md=["list"],Pd=["container"],Ld=(r,t)=>({showTransitionParams:r,hideTransitionParams:t}),Rd=r=>({value:"visible",params:r}),Qc=(r,t)=>({item:r,id:t});function Nd(r,t){r&1&&zt(0)}function Bd(r,t){if(r&1&&(U(0,"div"),he(1,Nd,1,0,"ng-container",8),X()),r&2){let e=E(2);Te(e.cx("start")),Ae("data-pc-section","start"),S(),M("ngTemplateOutlet",e.startTemplate??e._startTemplate)}}function Hd(r,t){if(r&1&&xe(0,"li",12),r&2){let e=E(4);Te(e.cx("separator"))}}function Vd(r,t){if(r&1&&(U(0,"span"),ce(1),X()),r&2){let e=E(3).$implicit;S(),Ne(e.label)}}function Wd(r,t){if(r&1&&xe(0,"span",16),r&2){let e=E(3).$implicit,i=E(3);M("innerHTML",i.sanitizeHtml(e.label),pi)}}function $d(r,t){if(r&1&&(qt(0),he(1,Vd,2,1,"span",15)(2,Wd,1,1,"ng-template",null,2,cr),Zt()),r&2){let e=Jt(3),i=E(2).$implicit;S(),M("ngIf",i.escape!==!1)("ngIfElse",e)}}function zd(r,t){r&1&&zt(0)}function Ud(r,t){if(r&1&&(U(0,"li",13),he(1,$d,4,2,"ng-container",7)(2,zd,1,0,"ng-container",14),X()),r&2){let e=E(),i=e.$implicit,n=e.index,s=E(3);Te(s.cx("submenuLabel")),M("tooltipOptions",i.tooltipOptions),Ae("data-automationid",i.automationId)("id",s.menuitemId(i,s.id,n)),S(),M("ngIf",!s.submenuHeaderTemplate&&!s._submenuHeaderTemplate),S(),M("ngTemplateOutlet",s.submenuHeaderTemplate??s._submenuHeaderTemplate)("ngTemplateOutletContext",lr(8,ra,i))}}function Gd(r,t){if(r&1&&xe(0,"li",12),r&2){let e=E(5);Te(e.cx("separator"))}}function Xd(r,t){if(r&1){let e=Se();U(0,"li",18),Ce("onMenuItemClick",function(n){J(e);let s=E(),a=s.$implicit,o=s.index,c=E().index,l=E(3);return ee(l.itemClick(n,l.menuitemId(a,l.id,c,o)))}),X()}if(r&2){let e=E(),i=e.$implicit,n=e.index,s=E().index,a=E(3);kt(i.style),Te(a.cn(a.cx("item",_r(13,Qc,i,a.menuitemId(i,a.id,s,n))),i==null?null:i.styleClass)),M("pMenuItemContent",i)("itemTemplate",a.itemTemplate??a._itemTemplate)("tooltipOptions",i.tooltipOptions),Ae("data-pc-section","menuitem")("aria-label",a.label(i.label))("data-p-focused",a.isItemFocused(a.menuitemId(i,a.id,s,n)))("data-p-disabled",a.disabled(i.disabled))("aria-disabled",a.disabled(i.disabled))("id",a.menuitemId(i,a.id,s,n))}}function jd(r,t){if(r&1&&he(0,Gd,1,2,"li",10)(1,Xd,1,16,"li",17),r&2){let e=t.$implicit,i=E().$implicit;M("ngIf",e.separator&&(e.visible!==!1||i.visible!==!1)),S(),M("ngIf",!e.separator&&e.visible!==!1&&(e.visible!==void 0||i.visible!==!1))}}function Yd(r,t){if(r&1&&he(0,Hd,1,2,"li",10)(1,Ud,3,10,"li",11)(2,jd,2,2,"ng-template",9),r&2){let e=t.$implicit;M("ngIf",e.separator&&e.visible!==!1),S(),M("ngIf",!e.separator),S(),M("ngForOf",e.items)}}function Kd(r,t){if(r&1&&he(0,Yd,3,3,"ng-template",9),r&2){let e=E(2);M("ngForOf",e.model)}}function qd(r,t){if(r&1&&xe(0,"li",12),r&2){let e=E(4);Te(e.cx("separator"))}}function Zd(r,t){if(r&1){let e=Se();U(0,"li",20),Ce("onMenuItemClick",function(n){J(e);let s=E(),a=s.$implicit,o=s.index,c=E(3);return ee(c.itemClick(n,c.menuitemId(a,c.id,o)))}),X()}if(r&2){let e=E(),i=e.$implicit,n=e.index,s=E(3);Te(s.cn(s.cx("item",_r(12,Qc,i,s.menuitemId(i,s.id,n))),i==null?null:i.styleClass)),M("pMenuItemContent",i)("itemTemplate",s.itemTemplate??s._itemTemplate)("ngStyle",i.style)("tooltipOptions",i.tooltipOptions),Ae("data-pc-section","menuitem")("aria-label",s.label(i.label))("data-p-focused",s.isItemFocused(s.menuitemId(i,s.id,n)))("data-p-disabled",s.disabled(i.disabled))("aria-disabled",s.disabled(i.disabled))("id",s.menuitemId(i,s.id,n))}}function Qd(r,t){if(r&1&&he(0,qd,1,2,"li",10)(1,Zd,1,15,"li",19),r&2){let e=t.$implicit;M("ngIf",e.separator&&e.visible!==!1),S(),M("ngIf",!e.separator&&e.visible!==!1)}}function Jd(r,t){if(r&1&&he(0,Qd,2,2,"ng-template",9),r&2){let e=E(2);M("ngForOf",e.model)}}function ep(r,t){r&1&&zt(0)}function tp(r,t){if(r&1&&(U(0,"div"),he(1,ep,1,0,"ng-container",8),X()),r&2){let e=E(2);Te(e.cx("end")),Ae("data-pc-section","end"),S(),M("ngTemplateOutlet",e.endTemplate??e._endTemplate)}}function rp(r,t){if(r&1){let e=Se();U(0,"div",4,0),Ce("click",function(n){J(e);let s=E();return ee(s.onOverlayClick(n))})("@overlayAnimation.start",function(n){J(e);let s=E();return ee(s.onOverlayAnimationStart(n))})("@overlayAnimation.done",function(n){J(e);let s=E();return ee(s.onOverlayAnimationEnd(n))}),he(2,Bd,2,4,"div",5),U(3,"ul",6,1),Ce("focus",function(n){J(e);let s=E();return ee(s.onListFocus(n))})("blur",function(n){J(e);let s=E();return ee(s.onListBlur(n))})("keydown",function(n){J(e);let s=E();return ee(s.onListKeyDown(n))}),he(5,Kd,1,1,null,7)(6,Jd,1,1,null,7),X(),he(7,tp,2,4,"div",5),X()}if(r&2){let e=E();kt(e.sx("root")),Te(e.cn(e.cx("root"),e.styleClass)),M("ngStyle",e.style)("@overlayAnimation",lr(24,Rd,_r(21,Ld,e.showTransitionOptions,e.hideTransitionOptions)))("@.disabled",e.popup!==!0),Ae("data-pc-name","menu")("id",e.id),S(2),M("ngIf",e.startTemplate??e._startTemplate),S(),Te(e.cx("list")),Ae("id",e.id+"_list")("tabindex",e.getTabIndexValue())("data-pc-section","menu")("aria-activedescendant",e.activedescendant())("aria-label",e.ariaLabel)("aria-labelledBy",e.ariaLabelledBy),S(2),M("ngIf",e.hasSubMenu()),S(),M("ngIf",!e.hasSubMenu()),S(),M("ngIf",e.endTemplate??e._endTemplate)}}var ip={root:({instance:r})=>({position:r.popup?"absolute":"relative"})},np={root:({instance:r})=>["p-menu p-component",{"p-menu-overlay":r.popup}],start:"p-menu-start",list:"p-menu-list",submenuLabel:"p-menu-submenu-label",separator:"p-menu-separator",end:"p-menu-end",item:({instance:r,item:t,id:e})=>["p-menu-item",{"p-focus":r.focusedOptionId()&&e===r.focusedOptionId(),"p-disabled":r.disabled(t.disabled)},t.styleClass],itemContent:"p-menu-item-content",itemLink:"p-menu-item-link",itemIcon:({item:r})=>["p-menu-item-icon",r.icon,r.iconClass],itemLabel:"p-menu-item-label"},ta=(()=>{class r extends xi{name="menu";theme=Zc;classes=np;inlineStyles=ip;static \u0275fac=(()=>{let e;return function(n){return(e||(e=Dr(r)))(n||r)}})();static \u0275prov=ar({token:r,factory:r.\u0275fac})}return r})();var sp=(()=>{class r extends zr{item;itemTemplate;onMenuItemClick=new ye;menu;_componentStyle=Et(ta);constructor(e){super(),this.menu=e}onItemClick(e,i){this.onMenuItemClick.emit({originalEvent:e,item:i})}static \u0275fac=function(i){return new(i||r)(We(Is(()=>gn)))};static \u0275cmp=Oe({type:r,selectors:[["","pMenuItemContent",""]],inputs:{item:[0,"pMenuItemContent","item"],itemTemplate:"itemTemplate"},outputs:{onMenuItemClick:"onMenuItemClick"},features:[or([ta]),Pr],attrs:fd,decls:5,vars:5,consts:[["itemContent",""],["htmlLabel",""],[3,"click"],[4,"ngIf"],["pRipple","",3,"class","target",4,"ngIf"],["routerLinkActive","p-menu-item-link-active","pRipple","",3,"routerLink","queryParams","routerLinkActiveOptions","class","target","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state",4,"ngIf"],["pRipple","",3,"target"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["routerLinkActive","p-menu-item-link-active","pRipple","",3,"routerLink","queryParams","routerLinkActiveOptions","target","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state"],[3,"class","style",4,"ngIf"],[3,"class",4,"ngIf","ngIfElse"],[3,"styleClass","value",4,"ngIf"],[1,"p-menu-item-label",3,"innerHTML"],[3,"styleClass","value"]],template:function(i,n){if(i&1){let s=Se();U(0,"div",2),Ce("click",function(o){return J(s),ee(n.onItemClick(o,n.item))}),he(1,_d,3,2,"ng-container",3)(2,Cd,2,4,"ng-container",3)(3,kd,5,4,"ng-template",null,0,cr),X()}i&2&&(Te(n.cx("itemContent")),Ae("data-pc-section","content"),S(),M("ngIf",!n.itemTemplate),S(),M("ngIf",n.itemTemplate))},dependencies:[Be,Rt,Jr,nn,Ls,Rs,an,Ur,eo,zl,Nt],encapsulation:2})}return r})(),gn=(()=>{class r extends zr{overlayService;model;popup;style;styleClass;autoZIndex=!0;baseZIndex=0;showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)";hideTransitionOptions=".1s linear";ariaLabel;ariaLabelledBy;id;tabindex=0;appendTo=er(void 0);onShow=new ye;onHide=new ye;onBlur=new ye;onFocus=new ye;listViewChild;containerViewChild;$appendTo=rn(()=>this.appendTo()||this.config.overlayAppendTo());container;scrollHandler;documentClickListener;documentResizeListener;preventDocumentDefault;target;visible;focusedOptionId=rn(()=>this.focusedOptionIndex()!==-1?this.focusedOptionIndex():null);focusedOptionIndex=Wr(-1);selectedOptionIndex=Wr(-1);focused=!1;overlayVisible=!1;relativeAlign;_componentStyle=Et(ta);constructor(e){super(),this.overlayService=e,this.id=this.id||sn("pn_id_")}toggle(e){this.visible?this.hide():this.show(e),this.preventDocumentDefault=!0}show(e){this.target=e.currentTarget,this.relativeAlign=e.relativeAlign,this.visible=!0,this.preventDocumentDefault=!0,this.overlayVisible=!0,this.cd.markForCheck()}ngOnInit(){super.ngOnInit(),this.popup||this.bindDocumentClickListener()}startTemplate;_startTemplate;endTemplate;_endTemplate;headerTemplate;_headerTemplate;itemTemplate;_itemTemplate;submenuHeaderTemplate;_submenuHeaderTemplate;templates;ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"start":this._startTemplate=e.template;break;case"end":this._endTemplate=e.template;break;case"item":this._itemTemplate=e.template;break;case"submenuheader":this._submenuHeaderTemplate=e.template;break;default:this._itemTemplate=e.template;break}})}getTabIndexValue(){return this.tabindex!==void 0?this.tabindex.toString():null}onOverlayAnimationStart(e){switch(e.toState){case"visible":this.popup&&(this.container=e.element,this.moveOnTop(),this.onShow.emit({}),this.attrSelector&&this.container.setAttribute(this.attrSelector,""),this.appendOverlay(),this.alignOverlay(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener(),wr(this.listViewChild.nativeElement));break;case"void":this.onOverlayHide(),this.onHide.emit({});break}}onOverlayAnimationEnd(e){switch(e.toState){case"void":this.autoZIndex&&ur.clear(e.element);break}}alignOverlay(){this.relativeAlign?Hs(this.container,this.target):Ns(this.container,this.target)}appendOverlay(){jl.appendOverlay(this.container,this.$appendTo()==="body"?this.document.body:this.$appendTo(),this.$appendTo())}restoreOverlayAppend(){this.container&&this.$appendTo()!=="self"&&this.renderer.appendChild(this.el.nativeElement,this.container)}moveOnTop(){this.autoZIndex&&ur.set("menu",this.container,this.baseZIndex+this.config.zIndex.menu)}hide(){this.visible=!1,this.relativeAlign=!1,this.cd.markForCheck()}onWindowResize(){this.visible&&!qn()&&this.hide()}menuitemId(e,i,n,s){return e?.id??`${i}_${n}${s!==void 0?"_"+s:""}`}isItemFocused(e){return this.focusedOptionId()===e}label(e){return typeof e=="function"?e():e}disabled(e){return typeof e=="function"?e():typeof e>"u"?!1:e}activedescendant(){return this.focused?this.focusedOptionId():void 0}onListFocus(e){this.focused||(this.focused=!0,!this.popup&&this.changeFocusedOptionIndex(0),this.onFocus.emit(e))}onListBlur(e){this.focused&&(this.focused=!1,this.changeFocusedOptionIndex(-1),this.selectedOptionIndex.set(-1),this.focusedOptionIndex.set(-1),this.onBlur.emit(e))}onListKeyDown(e){switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"Enter":this.onEnterKey(e);break;case"NumpadEnter":this.onEnterKey(e);break;case"Space":this.onSpaceKey(e);break;case"Escape":case"Tab":this.popup&&(wr(this.target),this.hide()),this.overlayVisible&&this.hide();break;default:break}}onArrowDownKey(e){let i=this.findNextOptionIndex(this.focusedOptionIndex());this.changeFocusedOptionIndex(i),e.preventDefault()}onArrowUpKey(e){if(e.altKey&&this.popup)wr(this.target),this.hide(),e.preventDefault();else{let i=this.findPrevOptionIndex(this.focusedOptionIndex());this.changeFocusedOptionIndex(i),e.preventDefault()}}onHomeKey(e){this.changeFocusedOptionIndex(0),e.preventDefault()}onEndKey(e){this.changeFocusedOptionIndex(Kn(this.containerViewChild.nativeElement,'li[data-pc-section="menuitem"][data-p-disabled="false"]').length-1),e.preventDefault()}onEnterKey(e){let i=Hi(this.containerViewChild.nativeElement,`li[id="${`${this.focusedOptionIndex()}`}"]`),n=i&&Hi(i,'a[data-pc-section="action"]');this.popup&&wr(this.target),n?n.click():i&&i.click(),e.preventDefault()}onSpaceKey(e){this.onEnterKey(e)}findNextOptionIndex(e){let n=[...Kn(this.containerViewChild.nativeElement,'li[data-pc-section="menuitem"][data-p-disabled="false"]')].findIndex(s=>s.id===e);return n>-1?n+1:0}findPrevOptionIndex(e){let n=[...Kn(this.containerViewChild.nativeElement,'li[data-pc-section="menuitem"][data-p-disabled="false"]')].findIndex(s=>s.id===e);return n>-1?n-1:0}changeFocusedOptionIndex(e){let i=Kn(this.containerViewChild.nativeElement,'li[data-pc-section="menuitem"][data-p-disabled="false"]');if(i.length>0){let n=e>=i.length?i.length-1:e<0?0:e;n>-1&&this.focusedOptionIndex.set(i[n].getAttribute("id"))}}itemClick(e,i){let{originalEvent:n,item:s}=e;if(this.focused||(this.focused=!0,this.onFocus.emit()),s.disabled){n.preventDefault();return}!s.url&&!s.routerLink&&n.preventDefault(),s.command&&s.command({originalEvent:n,item:s}),this.popup&&this.hide(),!this.popup&&this.focusedOptionIndex()!==i&&this.focusedOptionIndex.set(i)}onOverlayClick(e){this.popup&&this.overlayService.add({originalEvent:e,target:this.el.nativeElement}),this.preventDocumentDefault=!0}bindDocumentClickListener(){if(!this.documentClickListener&&ei(this.platformId)){let e=this.el?this.el.nativeElement.ownerDocument:"document";this.documentClickListener=this.renderer.listen(e,"click",i=>{let n=this.containerViewChild?.nativeElement&&!this.containerViewChild?.nativeElement.contains(i.target),s=!(this.target&&(this.target===i.target||this.target.contains(i.target)));!this.popup&&n&&s&&this.onListBlur(i),this.preventDocumentDefault&&this.overlayVisible&&n&&s&&(this.hide(),this.preventDocumentDefault=!1)})}}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){if(!this.documentResizeListener&&ei(this.platformId)){let e=this.document.defaultView;this.documentResizeListener=this.renderer.listen(e,"resize",this.onWindowResize.bind(this))}}unbindDocumentResizeListener(){this.documentResizeListener&&(this.documentResizeListener(),this.documentResizeListener=null)}bindScrollListener(){!this.scrollHandler&&ei(this.platformId)&&(this.scrollHandler=new zs(this.target,()=>{this.visible&&this.hide()})),this.scrollHandler?.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&(this.scrollHandler.unbindScrollListener(),this.scrollHandler=null)}onOverlayHide(){this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.preventDocumentDefault=!1,this.cd.destroyed||(this.target=null)}ngOnDestroy(){this.popup&&(this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.container&&this.autoZIndex&&ur.clear(this.container),this.restoreOverlayAppend(),this.onOverlayHide()),this.popup||this.unbindDocumentClickListener(),super.ngOnDestroy()}hasSubMenu(){return this.model?.some(e=>e.items)??!1}isItemHidden(e){return e.separator?e.visible===!1||e.items&&e.items.some(i=>i.visible!==!1):e.visible===!1}static \u0275fac=function(i){return new(i||r)(We($s))};static \u0275cmp=Oe({type:r,selectors:[["p-menu"]],contentQueries:function(i,n,s){if(i&1&&(nt(s,Id,4),nt(s,Fd,4),nt(s,Od,4),nt(s,Ad,4),nt(s,Dd,4),nt(s,Cr,4)),i&2){let a;Ie(a=Fe())&&(n.startTemplate=a.first),Ie(a=Fe())&&(n.endTemplate=a.first),Ie(a=Fe())&&(n.headerTemplate=a.first),Ie(a=Fe())&&(n.itemTemplate=a.first),Ie(a=Fe())&&(n.submenuHeaderTemplate=a.first),Ie(a=Fe())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&(tt(Md,5),tt(Pd,5)),i&2){let s;Ie(s=Fe())&&(n.listViewChild=s.first),Ie(s=Fe())&&(n.containerViewChild=s.first)}},inputs:{model:"model",popup:[2,"popup","popup",Ue],style:"style",styleClass:"styleClass",autoZIndex:[2,"autoZIndex","autoZIndex",Ue],baseZIndex:[2,"baseZIndex","baseZIndex",hr],showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",id:"id",tabindex:[2,"tabindex","tabindex",hr],appendTo:[1,"appendTo"]},outputs:{onShow:"onShow",onHide:"onHide",onBlur:"onBlur",onFocus:"onFocus"},features:[or([ta]),Pr],decls:1,vars:1,consts:[["container",""],["list",""],["htmlSubmenuLabel",""],[3,"class","style","ngStyle","click",4,"ngIf"],[3,"click","ngStyle"],[3,"class",4,"ngIf"],["role","menu",3,"focus","blur","keydown"],[4,"ngIf"],[4,"ngTemplateOutlet"],["ngFor","",3,"ngForOf"],["role","separator",3,"class",4,"ngIf"],["pTooltip","","role","none",3,"class","tooltipOptions",4,"ngIf"],["role","separator"],["pTooltip","","role","none",3,"tooltipOptions"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngIf","ngIfElse"],[3,"innerHTML"],["pTooltip","","role","menuitem",3,"class","pMenuItemContent","itemTemplate","style","tooltipOptions","onMenuItemClick",4,"ngIf"],["pTooltip","","role","menuitem",3,"onMenuItemClick","pMenuItemContent","itemTemplate","tooltipOptions"],["pTooltip","","role","menuitem",3,"class","pMenuItemContent","itemTemplate","ngStyle","tooltipOptions","onMenuItemClick",4,"ngIf"],["pTooltip","","role","menuitem",3,"onMenuItemClick","pMenuItemContent","itemTemplate","ngStyle","tooltipOptions"]],template:function(i,n){i&1&&he(0,rp,8,26,"div",3),i&2&&M("ngIf",!n.popup||n.visible)},dependencies:[Be,gi,Rt,Jr,Bi,nn,sp,Ur,vi,eo,Nt],encapsulation:2,data:{animation:[on("overlayAnimation",[ii(":enter",[ri({opacity:0,transform:"scaleY(0.8)"}),ti("{{showTransitionParams}}")]),ii(":leave",[ti("{{hideTransitionParams}}",ri({opacity:0}))])])]},changeDetection:0})}return r})(),ia=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=Mr({type:r});static \u0275inj=Or({imports:[gn,Nt,Nt]})}return r})();var fs={};fs.version="0.18.5";var Ui=1200,kn=1252,ap=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],op={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},V0=function(r){ap.indexOf(r)!=-1&&(kn=op[0]=r)};function lp(){V0(1252)}var ds=function(r){Ui=r,V0(r)};function cp(){ds(1200),lp()}function hp(r){for(var t=[],e=0;e<r.length>>1;++e)t[e]=String.fromCharCode(r.charCodeAt(2*e+1)+(r.charCodeAt(2*e)<<8));return t.join("")}var na=function(t){return String.fromCharCode(t)},e0=function(t){return String.fromCharCode(t)},Ze;var jr=null,ns=!0,Ti="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ps(r){for(var t="",e=0,i=0,n=0,s=0,a=0,o=0,c=0,l=0;l<r.length;)e=r.charCodeAt(l++),s=e>>2,i=r.charCodeAt(l++),a=(e&3)<<4|i>>4,n=r.charCodeAt(l++),o=(i&15)<<2|n>>6,c=n&63,isNaN(i)?o=c=64:isNaN(n)&&(c=64),t+=Ti.charAt(s)+Ti.charAt(a)+Ti.charAt(o)+Ti.charAt(c);return t}function ci(r){var t="",e=0,i=0,n=0,s=0,a=0,o=0,c=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<r.length;)s=Ti.indexOf(r.charAt(l++)),a=Ti.indexOf(r.charAt(l++)),e=s<<2|a>>4,t+=String.fromCharCode(e),o=Ti.indexOf(r.charAt(l++)),i=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(i)),c=Ti.indexOf(r.charAt(l++)),n=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var $e=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ui=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Xi(r){return $e?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function t0(r){return $e?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Nr=function(t){return $e?ui(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function Ea(r){if(typeof ArrayBuffer>"u")return Nr(r);for(var t=new ArrayBuffer(r.length),e=new Uint8Array(t),i=0;i!=r.length;++i)e[i]=r.charCodeAt(i)&255;return t}function _s(r){if(Array.isArray(r))return r.map(function(i){return String.fromCharCode(i)}).join("");for(var t=[],e=0;e<r.length;++e)t[e]=String.fromCharCode(r[e]);return t.join("")}function up(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}var Dt=$e?function(r){return Buffer.concat(r.map(function(t){return Buffer.isBuffer(t)?t:ui(t)}))}:function(r){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<r.length;++t)e+=r[t].length;var i=new Uint8Array(e),n=0;for(t=0,e=0;t<r.length;e+=n,++t)if(n=r[t].length,r[t]instanceof Uint8Array)i.set(r[t],e);else{if(typeof r[t]=="string")throw"wtf";i.set(new Uint8Array(r[t]),e)}return i}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function fp(r){for(var t=[],e=0,i=r.length+250,n=Xi(r.length+255),s=0;s<r.length;++s){var a=r.charCodeAt(s);if(a<128)n[e++]=a;else if(a<2048)n[e++]=192|a>>6&31,n[e++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=r.charCodeAt(++s)&1023;n[e++]=240|a>>8&7,n[e++]=128|a>>2&63,n[e++]=128|o>>6&15|(a&3)<<4,n[e++]=128|o&63}else n[e++]=224|a>>12&15,n[e++]=128|a>>6&63,n[e++]=128|a&63;e>i&&(t.push(n.slice(0,e)),e=0,n=Xi(65535),i=65530)}return t.push(n.slice(0,e)),Dt(t)}var Cn=/\u0000/g,sa=/[\u0001-\u0006]/g;function bn(r){for(var t="",e=r.length-1;e>=0;)t+=r.charAt(e--);return t}function Br(r,t){var e=""+r;return e.length>=t?e:at("0",t-e.length)+e}function Ho(r,t){var e=""+r;return e.length>=t?e:at(" ",t-e.length)+e}function da(r,t){var e=""+r;return e.length>=t?e:e+at(" ",t-e.length)}function dp(r,t){var e=""+Math.round(r);return e.length>=t?e:at("0",t-e.length)+e}function pp(r,t){var e=""+r;return e.length>=t?e:at("0",t-e.length)+e}var r0=Math.pow(2,32);function xn(r,t){if(r>r0||r<-r0)return dp(r,t);var e=Math.round(r);return pp(e,t)}function pa(r,t){return t=t||0,r.length>=7+t&&(r.charCodeAt(t)|32)===103&&(r.charCodeAt(t+1)|32)===101&&(r.charCodeAt(t+2)|32)===110&&(r.charCodeAt(t+3)|32)===101&&(r.charCodeAt(t+4)|32)===114&&(r.charCodeAt(t+5)|32)===97&&(r.charCodeAt(t+6)|32)===108}var i0=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ko=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function mp(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',r}var ot={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},n0={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},gp={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ma(r,t,e){for(var i=r<0?-1:1,n=r*i,s=0,a=1,o=0,c=1,l=0,h=0,u=Math.floor(n);l<t&&(u=Math.floor(n),o=u*a+s,h=u*l+c,!(n-u<5e-8));)n=1/(n-u),s=a,a=o,c=l,l=h;if(h>t&&(l>t?(h=c,o=s):(h=l,o=a)),!e)return[0,i*o,h];var f=Math.floor(i*o/h);return[f,i*o-f*h,h]}function aa(r,t,e){if(r>2958465||r<0)return null;var i=r|0,n=Math.floor(86400*(r-i)),s=0,a=[],o={D:i,T:n,u:86400*(r-i)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(i+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++i,++o.D)),i===60)a=e?[1317,10,29]:[1900,2,29],s=3;else if(i===0)a=e?[1317,8,29]:[1900,1,0],s=6;else{i>60&&--i;var c=new Date(1900,0,1);c.setDate(c.getDate()+i-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),i<60&&(s=(s+6)%7),e&&(s=bp(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=s,o}var W0=new Date(1899,11,31,0,0,0),xp=W0.getTime(),vp=new Date(1900,2,1,0,0,0);function $0(r,t){var e=r.getTime();return t?e-=1461*24*60*60*1e3:r>=vp&&(e+=24*60*60*1e3),(e-(xp+(r.getTimezoneOffset()-W0.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Vo(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function _p(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function yp(r){var t=r<0?12:11,e=Vo(r.toFixed(12));return e.length<=t||(e=r.toPrecision(10),e.length<=t)?e:r.toExponential(5)}function wp(r){var t=Vo(r.toFixed(11));return t.length>(r<0?12:11)||t==="0"||t==="-0"?r.toPrecision(6):t}function Cp(r){var t=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),e;return t>=-4&&t<=-1?e=r.toPrecision(10+t):Math.abs(t)<=9?e=yp(r):t===10?e=r.toFixed(10).substr(0,12):e=wp(r),Vo(_p(e.toUpperCase()))}function Lo(r,t){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):Cp(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return ki(14,$0(r,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+r)}function bp(r,t){t[0]-=581;var e=r.getDay();return r<60&&(e=(e+6)%7),e}function Sp(r,t,e,i){var n="",s=0,a=0,o=e.y,c,l=0;switch(r){case 98:o=e.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(t.length){case 1:case 2:c=e.m,l=t.length;break;case 3:return ko[e.m-1][1];case 5:return ko[e.m-1][0];default:return ko[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=e.d,l=t.length;break;case 3:return i0[e.q][0];default:return i0[e.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(e.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=e.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=e.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?Br(e.S,t.length):(i>=2?a=i===3?1e3:100:a=i===1?10:1,s=Math.round(a*(e.S+e.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(n=Br(s,2+i),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=e.D*24+e.H;break;case"[m]":case"[mm]":c=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":c=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+t}l=t.length===3?1:2;break;case 101:c=o,l=1;break}var h=l>0?Br(c,l):"";return h}function Ei(r){var t=3;if(r.length<=t)return r;for(var e=r.length%t,i=r.substr(0,e);e!=r.length;e+=t)i+=(i.length>0?",":"")+r.substr(e,t);return i}var z0=/%/g;function Tp(r,t,e){var i=t.replace(z0,""),n=t.length-i.length;return ai(r,i,e*Math.pow(10,2*n))+at("%",n)}function Ep(r,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return ai(r,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function U0(r,t){var e,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+U0(r,-t);var n=r.indexOf(".");n===-1&&(n=r.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),e=(t/Math.pow(10,s)).toPrecision(i+1+(n+s)%n),e.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+s):e+="E+"+(a-s);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,n)+"."+e.substr(2+n),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,h){return c+l+h.substr(0,(n+s)%n)+"."+h.substr(s)+"E"})}else e=t.toExponential(i);return r.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),r.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var G0=/# (\?+)( ?)\/( ?)(\d+)/;function kp(r,t,e){var i=parseInt(r[4],10),n=Math.round(t*i),s=Math.floor(n/i),a=n-s*i,o=i;return e+(s===0?"":""+s)+" "+(a===0?at(" ",r[1].length+1+r[4].length):Ho(a,r[1].length)+r[2]+"/"+r[3]+Br(o,r[4].length))}function Ip(r,t,e){return e+(t===0?"":""+t)+at(" ",r[1].length+2+r[4].length)}var X0=/^#*0*\.([0#]+)/,j0=/\).*[0#]/,Y0=/\(###\) ###\\?-####/;function Ut(r){for(var t="",e,i=0;i!=r.length;++i)switch(e=r.charCodeAt(i)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function s0(r,t){var e=Math.pow(10,t);return""+Math.round(r*e)/e}function a0(r,t){var e=r-Math.floor(r),i=Math.pow(10,t);return t<(""+Math.round(e*i)).length?0:Math.round(e*i)}function Fp(r,t){return t<(""+Math.round((r-Math.floor(r))*Math.pow(10,t))).length?1:0}function Op(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function Tr(r,t,e){if(r.charCodeAt(0)===40&&!t.match(j0)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Tr("n",i,e):"("+Tr("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return Ep(r,t,e);if(t.indexOf("%")!==-1)return Tp(r,t,e);if(t.indexOf("E")!==-1)return U0(t,e);if(t.charCodeAt(0)===36)return"$"+Tr(r,t.substr(t.charAt(1)==" "?2:1),e);var n,s,a,o,c=Math.abs(e),l=e<0?"-":"";if(t.match(/^00+$/))return l+xn(c,t.length);if(t.match(/^[#?]+$/))return n=xn(e,0),n==="0"&&(n=""),n.length>t.length?n:Ut(t.substr(0,t.length-n.length))+n;if(s=t.match(G0))return kp(s,c,l);if(t.match(/^#+0+$/))return l+xn(c,t.length-t.indexOf("0"));if(s=t.match(X0))return n=s0(e,s[1].length).replace(/^([^\.]+)$/,"$1."+Ut(s[1])).replace(/\.$/,"."+Ut(s[1])).replace(/\.(\d*)$/,function(x,d){return"."+d+at("0",Ut(s[1]).length-d.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+s0(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+Ei(xn(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Tr(r,t,-e):Ei(""+(Math.floor(e)+Fp(e,s[1].length)))+"."+Br(a0(e,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Tr(r,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=bn(Tr(r,t.replace(/[\\-]/g,""),e)),a=0,bn(bn(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<n.length?n.charAt(a++):x==="0"?"0":""}));if(t.match(Y0))return n=Tr(r,"##########",e),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=ma(c,Math.pow(10,a)-1,!1),n=""+l,h=ai("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),n+=h+s[2]+"/"+s[3],h=da(o[2],a),h.length<s[4].length&&(h=Ut(s[4].substr(s[4].length-h.length))+h),n+=h,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=ma(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ho(o[1],a)+s[2]+"/"+s[3]+da(o[2],a):at(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=xn(e,0),t.length<=n.length?n:Ut(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var u=t.indexOf(".")-a,f=t.length-n.length-u;return Ut(t.substr(0,u)+n+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=a0(e,s[1].length),e<0?"-"+Tr(r,t,-e):Ei(Op(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Br(0,3-x.length):"")+x})+"."+Br(a,s[1].length);switch(t){case"###,##0.00":return Tr(r,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var p=Ei(xn(c,0));return p!=="0"?l+p:"";case"###,###.00":return Tr(r,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Tr(r,"#,##0.00",e).replace(/^0\./,".");default:}throw new Error("unsupported format |"+t+"|")}function Ap(r,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return ai(r,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function Dp(r,t,e){var i=t.replace(z0,""),n=t.length-i.length;return ai(r,i,e*Math.pow(10,2*n))+at("%",n)}function K0(r,t){var e,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+K0(r,-t);var n=r.indexOf(".");n===-1&&(n=r.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),e=(t/Math.pow(10,s)).toPrecision(i+1+(n+s)%n),!e.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+s):e+="E+"+(a-s),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,h){return c+l+h.substr(0,(n+s)%n)+"."+h.substr(s)+"E"})}else e=t.toExponential(i);return r.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),r.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Gr(r,t,e){if(r.charCodeAt(0)===40&&!t.match(j0)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Gr("n",i,e):"("+Gr("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return Ap(r,t,e);if(t.indexOf("%")!==-1)return Dp(r,t,e);if(t.indexOf("E")!==-1)return K0(t,e);if(t.charCodeAt(0)===36)return"$"+Gr(r,t.substr(t.charAt(1)==" "?2:1),e);var n,s,a,o,c=Math.abs(e),l=e<0?"-":"";if(t.match(/^00+$/))return l+Br(c,t.length);if(t.match(/^[#?]+$/))return n=""+e,e===0&&(n=""),n.length>t.length?n:Ut(t.substr(0,t.length-n.length))+n;if(s=t.match(G0))return Ip(s,c,l);if(t.match(/^#+0+$/))return l+Br(c,t.length-t.indexOf("0"));if(s=t.match(X0))return n=(""+e).replace(/^([^\.]+)$/,"$1."+Ut(s[1])).replace(/\.$/,"."+Ut(s[1])),n=n.replace(/\.(\d*)$/,function(x,d){return"."+d+at("0",Ut(s[1]).length-d.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+Ei(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Gr(r,t,-e):Ei(""+e)+"."+at("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Gr(r,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=bn(Gr(r,t.replace(/[\\-]/g,""),e)),a=0,bn(bn(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<n.length?n.charAt(a++):x==="0"?"0":""}));if(t.match(Y0))return n=Gr(r,"##########",e),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=ma(c,Math.pow(10,a)-1,!1),n=""+l,h=ai("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),n+=h+s[2]+"/"+s[3],h=da(o[2],a),h.length<s[4].length&&(h=Ut(s[4].substr(s[4].length-h.length))+h),n+=h,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=ma(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ho(o[1],a)+s[2]+"/"+s[3]+da(o[2],a):at(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+e,t.length<=n.length?n:Ut(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var u=t.indexOf(".")-a,f=t.length-n.length-u;return Ut(t.substr(0,u)+n+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Gr(r,t,-e):Ei(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Br(0,3-x.length):"")+x})+"."+Br(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Ei(""+c);return p!=="0"?l+p:"";default:if(t.match(/\.[0#?]*$/))return Gr(r,t.slice(0,t.lastIndexOf(".")),e)+Ut(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ai(r,t,e){return(e|0)===e?Gr(r,t,e):Tr(r,t,e)}function Mp(r){for(var t=[],e=!1,i=0,n=0;i<r.length;++i)switch(r.charCodeAt(i)){case 34:e=!e;break;case 95:case 42:case 92:++i;break;case 59:t[t.length]=r.substr(n,i-n),n=i+1}if(t[t.length]=r.substr(n),e===!0)throw new Error("Format |"+r+"| unterminated string ");return t}var q0=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Z0(r){for(var t=0,e="",i="";t<r.length;)switch(e=r.charAt(t)){case"G":pa(r,t)&&(t+=6),t++;break;case'"':for(;r.charCodeAt(++t)!==34&&t<r.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(r.charAt(t+1)==="1"||r.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(r.substr(t,3).toUpperCase()==="A/P"||r.substr(t,5).toUpperCase()==="AM/PM"||r.substr(t,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++t;break;case"[":for(i=e;r.charAt(t++)!=="]"&&t<r.length;)i+=r.charAt(t);if(i.match(q0))return!0;break;case".":case"0":case"#":for(;t<r.length&&("0#?.,E+-%".indexOf(e=r.charAt(++t))>-1||e=="\\"&&r.charAt(t+1)=="-"&&"0#".indexOf(r.charAt(t+2))>-1););break;case"?":for(;r.charAt(++t)===e;);break;case"*":++t,(r.charAt(t)==" "||r.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<r.length&&"0123456789".indexOf(r.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Pp(r,t,e,i){for(var n=[],s="",a=0,o="",c="t",l,h,u,f="H";a<r.length;)switch(o=r.charAt(a)){case"G":if(!pa(r,a))throw new Error("unrecognized character "+o+" in "+r);n[n.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(u=r.charCodeAt(++a))!==34&&a<r.length;)s+=String.fromCharCode(u);n[n.length]={t:"t",v:s},++a;break;case"\\":var p=r.charAt(++a),x=p==="("||p===")"?p:"t";n[n.length]={t:x,v:p},++a;break;case"_":n[n.length]={t:"t",v:" "},a+=2;break;case"@":n[n.length]={t:"T",v:t},++a;break;case"B":case"b":if(r.charAt(a+1)==="1"||r.charAt(a+1)==="2"){if(l==null&&(l=aa(t,e,r.charAt(a+1)==="2"),l==null))return"";n[n.length]={t:"X",v:r.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||l==null&&(l=aa(t,e),l==null))return"";for(s=o;++a<r.length&&r.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),n[n.length]={t:o,v:s},c=o;break;case"A":case"a":case"\u4E0A":var d={t:o,v:o};if(l==null&&(l=aa(t,e)),r.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(d.v=l.H>=12?"P":"A"),d.t="T",f="h",a+=3):r.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(d.v=l.H>=12?"PM":"AM"),d.t="T",a+=5,f="h"):r.substr(a,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(l!=null&&(d.v=l.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),d.t="T",a+=5,f="h"):(d.t="t",++a),l==null&&d.t==="T")return"";n[n.length]=d,c=o;break;case"[":for(s=o;r.charAt(a++)!=="]"&&a<r.length;)s+=r.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(q0)){if(l==null&&(l=aa(t,e),l==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Z0(r)||(n[n.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++a<r.length&&(o=r.charAt(a))==="0";)s+=o;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(a))>-1;)s+=o;n[n.length]={t:"n",v:s};break;case"?":for(s=o;r.charAt(++a)===o;)s+=o;n[n.length]={t:o,v:s},c=o;break;case"*":++a,(r.charAt(a)==" "||r.charAt(a)=="*")&&++a;break;case"(":case")":n[n.length]={t:i===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<r.length&&"0123456789".indexOf(r.charAt(++a))>-1;)s+=r.charAt(a);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:o,v:o},++a;break;case"$":n[n.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);n[n.length]={t:"t",v:o},++a;break}var g=0,I=0,O;for(a=n.length-1,c="t";a>=0;--a)switch(n[a].t){case"h":case"H":n[a].t=f,c="h",g<1&&(g=1);break;case"s":(O=n[a].v.match(/\.0+$/))&&(I=Math.max(I,O[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[a].t;break;case"m":c==="s"&&(n[a].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[a].v.match(/[Hh]/)&&(g=1),g<2&&n[a].v.match(/[Mm]/)&&(g=2),g<3&&n[a].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var A="",V;for(a=0;a<n.length;++a)switch(n[a].t){case"t":case"T":case" ":case"D":break;case"X":n[a].v="",n[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[a].v=Sp(n[a].t.charCodeAt(0),n[a].v,l,I),n[a].t="t";break;case"n":case"?":for(V=a+1;n[V]!=null&&((o=n[V].t)==="?"||o==="D"||(o===" "||o==="t")&&n[V+1]!=null&&(n[V+1].t==="?"||n[V+1].t==="t"&&n[V+1].v==="/")||n[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[V].v==="/"||n[V].v===" "&&n[V+1]!=null&&n[V+1].t=="?"));)n[a].v+=n[V].v,n[V]={v:"",t:";"},++V;A+=n[a].v,a=V-1;break;case"G":n[a].t="t",n[a].v=Lo(t,e);break}var q="",ie,D;if(A.length>0){A.charCodeAt(0)==40?(ie=t<0&&A.charCodeAt(0)===45?-t:t,D=ai("n",A,ie)):(ie=t<0&&i>1?-t:t,D=ai("n",A,ie),ie<0&&n[0]&&n[0].t=="t"&&(D=D.substr(1),n[0].v="-"+n[0].v)),V=D.length-1;var Y=n.length;for(a=0;a<n.length;++a)if(n[a]!=null&&n[a].t!="t"&&n[a].v.indexOf(".")>-1){Y=a;break}var z=n.length;if(Y===n.length&&D.indexOf("E")===-1){for(a=n.length-1;a>=0;--a)n[a]==null||"n?".indexOf(n[a].t)===-1||(V>=n[a].v.length-1?(V-=n[a].v.length,n[a].v=D.substr(V+1,n[a].v.length)):V<0?n[a].v="":(n[a].v=D.substr(0,V+1),V=-1),n[a].t="t",z=a);V>=0&&z<n.length&&(n[z].v=D.substr(0,V+1)+n[z].v)}else if(Y!==n.length&&D.indexOf("E")===-1){for(V=D.indexOf(".")-1,a=Y;a>=0;--a)if(!(n[a]==null||"n?".indexOf(n[a].t)===-1)){for(h=n[a].v.indexOf(".")>-1&&a===Y?n[a].v.indexOf(".")-1:n[a].v.length-1,q=n[a].v.substr(h+1);h>=0;--h)V>=0&&(n[a].v.charAt(h)==="0"||n[a].v.charAt(h)==="#")&&(q=D.charAt(V--)+q);n[a].v=q,n[a].t="t",z=a}for(V>=0&&z<n.length&&(n[z].v=D.substr(0,V+1)+n[z].v),V=D.indexOf(".")+1,a=Y;a<n.length;++a)if(!(n[a]==null||"n?(".indexOf(n[a].t)===-1&&a!==Y)){for(h=n[a].v.indexOf(".")>-1&&a===Y?n[a].v.indexOf(".")+1:0,q=n[a].v.substr(0,h);h<n[a].v.length;++h)V<D.length&&(q+=D.charAt(V++));n[a].v=q,n[a].t="t",z=a}}}for(a=0;a<n.length;++a)n[a]!=null&&"n?".indexOf(n[a].t)>-1&&(ie=i>1&&t<0&&a>0&&n[a-1].v==="-"?-t:t,n[a].v=ai(n[a].t,n[a].v,ie),n[a].t="t");var j="";for(a=0;a!==n.length;++a)n[a]!=null&&(j+=n[a].v);return j}var o0=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function l0(r,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(r==e)return!0;break;case">":if(r>e)return!0;break;case"<":if(r<e)return!0;break;case"<>":if(r!=e)return!0;break;case">=":if(r>=e)return!0;break;case"<=":if(r<=e)return!0;break}return!1}function Lp(r,t){var e=Mp(r),i=e.length,n=e[i-1].indexOf("@");if(i<4&&n>-1&&--i,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||n>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=n>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=n>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=n>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break;case 4:break}var s=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[i,s];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var a=e[0].match(o0),o=e[1].match(o0);return l0(t,a)?[i,e[0]]:l0(t,o)?[i,e[1]]:[i,e[a!=null&&o!=null?2:1]]}return[i,s]}function ki(r,t,e){e==null&&(e={});var i="";switch(typeof r){case"string":r=="m/d/yy"&&e.dateNF?i=e.dateNF:i=r;break;case"number":r==14&&e.dateNF?i=e.dateNF:i=(e.table!=null?e.table:ot)[r],i==null&&(i=e.table&&e.table[n0[r]]||ot[n0[r]]),i==null&&(i=gp[r]||"General");break}if(pa(i,0))return Lo(t,e);t instanceof Date&&(t=$0(t,e.date1904));var n=Lp(i,t);if(pa(n[1]))return Lo(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Pp(n[1],t,e,n[0])}function Q0(r,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(ot[e]==null){t<0&&(t=e);continue}if(ot[e]==r){t=e;break}}t<0&&(t=391)}return ot[t]=r,t}function ka(r){for(var t=0;t!=392;++t)r[t]!==void 0&&Q0(r[t],t)}function Ia(){ot=mp()}var J0=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Rp(r){var t=typeof r=="number"?ot[r]:r;return t=t.replace(J0,"(\\d+)"),new RegExp("^"+t+"$")}function Np(r,t,e){var i=-1,n=-1,s=-1,a=-1,o=-1,c=-1;(t.match(J0)||[]).forEach(function(u,f){var p=parseInt(e[f+1],10);switch(u.toLowerCase().charAt(0)){case"y":i=p;break;case"d":s=p;break;case"h":a=p;break;case"s":c=p;break;case"m":a>=0?o=p:n=p;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var l=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?l:i==-1&&n==-1&&s==-1?h:l+"T"+h}var Bp=function(){var r={};r.version="1.2.0";function t(){for(var D=0,Y=new Array(256),z=0;z!=256;++z)D=z,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,Y[z]=D;return typeof Int32Array<"u"?new Int32Array(Y):Y}var e=t();function i(D){var Y=0,z=0,j=0,Q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(j=0;j!=256;++j)Q[j]=D[j];for(j=0;j!=256;++j)for(z=D[j],Y=256+j;Y<4096;Y+=256)z=Q[Y]=z>>>8^D[z&255];var te=[];for(j=1;j!=16;++j)te[j-1]=typeof Int32Array<"u"?Q.subarray(j*256,j*256+256):Q.slice(j*256,j*256+256);return te}var n=i(e),s=n[0],a=n[1],o=n[2],c=n[3],l=n[4],h=n[5],u=n[6],f=n[7],p=n[8],x=n[9],d=n[10],g=n[11],I=n[12],O=n[13],A=n[14];function V(D,Y){for(var z=Y^-1,j=0,Q=D.length;j<Q;)z=z>>>8^e[(z^D.charCodeAt(j++))&255];return~z}function q(D,Y){for(var z=Y^-1,j=D.length-15,Q=0;Q<j;)z=A[D[Q++]^z&255]^O[D[Q++]^z>>8&255]^I[D[Q++]^z>>16&255]^g[D[Q++]^z>>>24]^d[D[Q++]]^x[D[Q++]]^p[D[Q++]]^f[D[Q++]]^u[D[Q++]]^h[D[Q++]]^l[D[Q++]]^c[D[Q++]]^o[D[Q++]]^a[D[Q++]]^s[D[Q++]]^e[D[Q++]];for(j+=15;Q<j;)z=z>>>8^e[(z^D[Q++])&255];return~z}function ie(D,Y){for(var z=Y^-1,j=0,Q=D.length,te=0,ge=0;j<Q;)te=D.charCodeAt(j++),te<128?z=z>>>8^e[(z^te)&255]:te<2048?(z=z>>>8^e[(z^(192|te>>6&31))&255],z=z>>>8^e[(z^(128|te&63))&255]):te>=55296&&te<57344?(te=(te&1023)+64,ge=D.charCodeAt(j++)&1023,z=z>>>8^e[(z^(240|te>>8&7))&255],z=z>>>8^e[(z^(128|te>>2&63))&255],z=z>>>8^e[(z^(128|ge>>6&15|(te&3)<<4))&255],z=z>>>8^e[(z^(128|ge&63))&255]):(z=z>>>8^e[(z^(224|te>>12&15))&255],z=z>>>8^e[(z^(128|te>>6&63))&255],z=z>>>8^e[(z^(128|te&63))&255]);return~z}return r.table=e,r.bstr=V,r.buf=q,r.str=ie,r}(),qe=function(){var t={};t.version="1.2.1";function e(m,y){for(var v=m.split("/"),_=y.split("/"),w=0,C=0,P=Math.min(v.length,_.length);w<P;++w){if(C=v[w].length-_[w].length)return C;if(v[w]!=_[w])return v[w]<_[w]?-1:1}return v.length-_.length}function i(m){if(m.charAt(m.length-1)=="/")return m.slice(0,-1).indexOf("/")===-1?m:i(m.slice(0,-1));var y=m.lastIndexOf("/");return y===-1?m:m.slice(0,y+1)}function n(m){if(m.charAt(m.length-1)=="/")return n(m.slice(0,-1));var y=m.lastIndexOf("/");return y===-1?m:m.slice(y+1)}function s(m,y){typeof y=="string"&&(y=new Date(y));var v=y.getHours();v=v<<6|y.getMinutes(),v=v<<5|y.getSeconds()>>>1,m.write_shift(2,v);var _=y.getFullYear()-1980;_=_<<4|y.getMonth()+1,_=_<<5|y.getDate(),m.write_shift(2,_)}function a(m){var y=m.read_shift(2)&65535,v=m.read_shift(2)&65535,_=new Date,w=v&31;v>>>=5;var C=v&15;v>>>=4,_.setMilliseconds(0),_.setFullYear(v+1980),_.setMonth(C-1),_.setDate(w);var P=y&31;y>>>=5;var W=y&63;return y>>>=6,_.setHours(y),_.setMinutes(W),_.setSeconds(P<<1),_}function o(m){pr(m,0);for(var y={},v=0;m.l<=m.length-4;){var _=m.read_shift(2),w=m.read_shift(2),C=m.l+w,P={};switch(_){case 21589:v=m.read_shift(1),v&1&&(P.mtime=m.read_shift(4)),w>5&&(v&2&&(P.atime=m.read_shift(4)),v&4&&(P.ctime=m.read_shift(4))),P.mtime&&(P.mt=new Date(P.mtime*1e3));break}m.l=C,y[_]=P}return y}var c;function l(){return c||(c={})}function h(m,y){if(m[0]==80&&m[1]==75)return Tl(m,y);if((m[0]|32)==109&&(m[1]|32)==105)return Du(m,y);if(m.length<512)throw new Error("CFB file size "+m.length+" < 512");var v=3,_=512,w=0,C=0,P=0,W=0,R=0,L=[],N=m.slice(0,512);pr(N,0);var re=u(N);switch(v=re[0],v){case 3:_=512;break;case 4:_=4096;break;case 0:if(re[1]==0)return Tl(m,y);default:throw new Error("Major Version: Expected 3 or 4 saw "+v)}_!==512&&(N=m.slice(0,_),pr(N,28));var ae=m.slice(0,_);f(N,v);var de=N.read_shift(4,"i");if(v===3&&de!==0)throw new Error("# Directory Sectors: Expected 0 saw "+de);N.l+=4,P=N.read_shift(4,"i"),N.l+=4,N.chk("00100000","Mini Stream Cutoff Size: "),W=N.read_shift(4,"i"),w=N.read_shift(4,"i"),R=N.read_shift(4,"i"),C=N.read_shift(4,"i");for(var oe=-1,ue=0;ue<109&&(oe=N.read_shift(4,"i"),!(oe<0));++ue)L[ue]=oe;var Ee=p(m,_);g(R,C,Ee,_,L);var Je=O(Ee,P,L,_);Je[P].name="!Directory",w>0&&W!==ge&&(Je[W].name="!MiniFAT"),Je[L[0]].name="!FAT",Je.fat_addrs=L,Je.ssz=_;var Kt={},lt=[],sr=[],Vn=[];A(P,Je,Ee,lt,w,Kt,sr,W),x(sr,Vn,lt),lt.shift();var Wn={FileIndex:sr,FullPaths:Vn};return y&&y.raw&&(Wn.raw={header:ae,sectors:Ee}),Wn}function u(m){if(m[m.l]==80&&m[m.l+1]==75)return[0,0];m.chk(ze,"Header Signature: "),m.l+=16;var y=m.read_shift(2,"u");return[m.read_shift(2,"u"),y]}function f(m,y){var v=9;switch(m.l+=2,v=m.read_shift(2)){case 9:if(y!=3)throw new Error("Sector Shift: Expected 9 saw "+v);break;case 12:if(y!=4)throw new Error("Sector Shift: Expected 12 saw "+v);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+v)}m.chk("0600","Mini Sector Shift: "),m.chk("000000000000","Reserved: ")}function p(m,y){for(var v=Math.ceil(m.length/y)-1,_=[],w=1;w<v;++w)_[w-1]=m.slice(w*y,(w+1)*y);return _[v-1]=m.slice(v*y),_}function x(m,y,v){for(var _=0,w=0,C=0,P=0,W=0,R=v.length,L=[],N=[];_<R;++_)L[_]=N[_]=_,y[_]=v[_];for(;W<N.length;++W)_=N[W],w=m[_].L,C=m[_].R,P=m[_].C,L[_]===_&&(w!==-1&&L[w]!==w&&(L[_]=L[w]),C!==-1&&L[C]!==C&&(L[_]=L[C])),P!==-1&&(L[P]=_),w!==-1&&_!=L[_]&&(L[w]=L[_],N.lastIndexOf(w)<W&&N.push(w)),C!==-1&&_!=L[_]&&(L[C]=L[_],N.lastIndexOf(C)<W&&N.push(C));for(_=1;_<R;++_)L[_]===_&&(C!==-1&&L[C]!==C?L[_]=L[C]:w!==-1&&L[w]!==w&&(L[_]=L[w]));for(_=1;_<R;++_)if(m[_].type!==0){if(W=_,W!=L[W])do W=L[W],y[_]=y[W]+"/"+y[_];while(W!==0&&L[W]!==-1&&W!=L[W]);L[_]=-1}for(y[0]+="/",_=1;_<R;++_)m[_].type!==2&&(y[_]+="/")}function d(m,y,v){for(var _=m.start,w=m.size,C=[],P=_;v&&w>0&&P>=0;)C.push(y.slice(P*te,P*te+te)),w-=te,P=zi(v,P*4);return C.length===0?H(0):Dt(C).slice(0,m.size)}function g(m,y,v,_,w){var C=ge;if(m===ge){if(y!==0)throw new Error("DIFAT chain shorter than expected")}else if(m!==-1){var P=v[m],W=(_>>>2)-1;if(!P)return;for(var R=0;R<W&&(C=zi(P,R*4))!==ge;++R)w.push(C);g(zi(P,_-4),y-1,v,_,w)}}function I(m,y,v,_,w){var C=[],P=[];w||(w=[]);var W=_-1,R=0,L=0;for(R=y;R>=0;){w[R]=!0,C[C.length]=R,P.push(m[R]);var N=v[Math.floor(R*4/_)];if(L=R*4&W,_<4+L)throw new Error("FAT boundary crossed: "+R+" 4 "+_);if(!m[N])break;R=zi(m[N],L)}return{nodes:C,data:g0([P])}}function O(m,y,v,_){var w=m.length,C=[],P=[],W=[],R=[],L=_-1,N=0,re=0,ae=0,de=0;for(N=0;N<w;++N)if(W=[],ae=N+y,ae>=w&&(ae-=w),!P[ae]){R=[];var oe=[];for(re=ae;re>=0;){oe[re]=!0,P[re]=!0,W[W.length]=re,R.push(m[re]);var ue=v[Math.floor(re*4/_)];if(de=re*4&L,_<4+de)throw new Error("FAT boundary crossed: "+re+" 4 "+_);if(!m[ue]||(re=zi(m[ue],de),oe[re]))break}C[ae]={nodes:W,data:g0([R])}}return C}function A(m,y,v,_,w,C,P,W){for(var R=0,L=_.length?2:0,N=y[m].data,re=0,ae=0,de;re<N.length;re+=128){var oe=N.slice(re,re+128);pr(oe,64),ae=oe.read_shift(2),de=Aa(oe,0,ae-L),_.push(de);var ue={name:de,type:oe.read_shift(1),color:oe.read_shift(1),L:oe.read_shift(4,"i"),R:oe.read_shift(4,"i"),C:oe.read_shift(4,"i"),clsid:oe.read_shift(16),state:oe.read_shift(4,"i"),start:0,size:0},Ee=oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2);Ee!==0&&(ue.ct=V(oe,oe.l-8));var Je=oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2);Je!==0&&(ue.mt=V(oe,oe.l-8)),ue.start=oe.read_shift(4,"i"),ue.size=oe.read_shift(4,"i"),ue.size<0&&ue.start<0&&(ue.size=ue.type=0,ue.start=ge,ue.name=""),ue.type===5?(R=ue.start,w>0&&R!==ge&&(y[R].name="!StreamData")):ue.size>=4096?(ue.storage="fat",y[ue.start]===void 0&&(y[ue.start]=I(v,ue.start,y.fat_addrs,y.ssz)),y[ue.start].name=ue.name,ue.content=y[ue.start].data.slice(0,ue.size)):(ue.storage="minifat",ue.size<0?ue.size=0:R!==ge&&ue.start!==ge&&y[R]&&(ue.content=d(ue,y[R].data,(y[W]||{}).data))),ue.content&&pr(ue.content,0),C[de]=ue,P.push(ue)}}function V(m,y){return new Date((_t(m,y+4)/1e7*Math.pow(2,32)+_t(m,y)/1e7-11644473600)*1e3)}function q(m,y){return l(),h(c.readFileSync(m),y)}function ie(m,y){var v=y&&y.type;switch(v||$e&&Buffer.isBuffer(m)&&(v="buffer"),v||"base64"){case"file":return q(m,y);case"base64":return h(Nr(ci(m)),y);case"binary":return h(Nr(m),y)}return h(m,y)}function D(m,y){var v=y||{},_=v.root||"Root Entry";if(m.FullPaths||(m.FullPaths=[]),m.FileIndex||(m.FileIndex=[]),m.FullPaths.length!==m.FileIndex.length)throw new Error("inconsistent CFB structure");m.FullPaths.length===0&&(m.FullPaths[0]=_+"/",m.FileIndex[0]={name:_,type:5}),v.CLSID&&(m.FileIndex[0].clsid=v.CLSID),Y(m)}function Y(m){var y="Sh33tJ5";if(!qe.find(m,"/"+y)){var v=H(4);v[0]=55,v[1]=v[3]=50,v[2]=54,m.FileIndex.push({name:y,type:2,content:v,size:4,L:69,R:69,C:69}),m.FullPaths.push(m.FullPaths[0]+y),z(m)}}function z(m,y){D(m);for(var v=!1,_=!1,w=m.FullPaths.length-1;w>=0;--w){var C=m.FileIndex[w];switch(C.type){case 0:_?v=!0:(m.FileIndex.pop(),m.FullPaths.pop());break;case 1:case 2:case 5:_=!0,isNaN(C.R*C.L*C.C)&&(v=!0),C.R>-1&&C.L>-1&&C.R==C.L&&(v=!0);break;default:v=!0;break}}if(!(!v&&!y)){var P=new Date(1987,1,19),W=0,R=Object.create?Object.create(null):{},L=[];for(w=0;w<m.FullPaths.length;++w)R[m.FullPaths[w]]=!0,m.FileIndex[w].type!==0&&L.push([m.FullPaths[w],m.FileIndex[w]]);for(w=0;w<L.length;++w){var N=i(L[w][0]);_=R[N],_||(L.push([N,{name:n(N).replace("/",""),type:1,clsid:pt,ct:P,mt:P,content:null}]),R[N]=!0)}for(L.sort(function(de,oe){return e(de[0],oe[0])}),m.FullPaths=[],m.FileIndex=[],w=0;w<L.length;++w)m.FullPaths[w]=L[w][0],m.FileIndex[w]=L[w][1];for(w=0;w<L.length;++w){var re=m.FileIndex[w],ae=m.FullPaths[w];if(re.name=n(ae).replace("/",""),re.L=re.R=re.C=-(re.color=1),re.size=re.content?re.content.length:0,re.start=0,re.clsid=re.clsid||pt,w===0)re.C=L.length>1?1:-1,re.size=0,re.type=5;else if(ae.slice(-1)=="/"){for(W=w+1;W<L.length&&i(m.FullPaths[W])!=ae;++W);for(re.C=W>=L.length?-1:W,W=w+1;W<L.length&&i(m.FullPaths[W])!=i(ae);++W);re.R=W>=L.length?-1:W,re.type=1}else i(m.FullPaths[w+1]||"")==i(ae)&&(re.R=w+1),re.type=2}}}function j(m,y){var v=y||{};if(v.fileType=="mad")return Mu(m,v);switch(z(m),v.fileType){case"zip":return Eu(m,v)}var _=function(de){for(var oe=0,ue=0,Ee=0;Ee<de.FileIndex.length;++Ee){var Je=de.FileIndex[Ee];if(Je.content){var Kt=Je.content.length;Kt>0&&(Kt<4096?oe+=Kt+63>>6:ue+=Kt+511>>9)}}for(var lt=de.FullPaths.length+3>>2,sr=oe+7>>3,Vn=oe+127>>7,Wn=sr+ue+lt+Vn,Mi=Wn+127>>7,$a=Mi<=109?0:Math.ceil((Mi-109)/127);Wn+Mi+$a+127>>7>Mi;)$a=++Mi<=109?0:Math.ceil((Mi-109)/127);var qr=[1,$a,Mi,Vn,lt,ue,oe,0];return de.FileIndex[0].size=oe<<6,qr[7]=(de.FileIndex[0].start=qr[0]+qr[1]+qr[2]+qr[3]+qr[4]+qr[5])+(qr[6]+7>>3),qr}(m),w=H(_[7]<<9),C=0,P=0;{for(C=0;C<8;++C)w.write_shift(1,_e[C]);for(C=0;C<8;++C)w.write_shift(2,0);for(w.write_shift(2,62),w.write_shift(2,3),w.write_shift(2,65534),w.write_shift(2,9),w.write_shift(2,6),C=0;C<3;++C)w.write_shift(2,0);for(w.write_shift(4,0),w.write_shift(4,_[2]),w.write_shift(4,_[0]+_[1]+_[2]+_[3]-1),w.write_shift(4,0),w.write_shift(4,4096),w.write_shift(4,_[3]?_[0]+_[1]+_[2]-1:ge),w.write_shift(4,_[3]),w.write_shift(-4,_[1]?_[0]-1:ge),w.write_shift(4,_[1]),C=0;C<109;++C)w.write_shift(-4,C<_[2]?_[1]+C:-1)}if(_[1])for(P=0;P<_[1];++P){for(;C<236+P*127;++C)w.write_shift(-4,C<_[2]?_[1]+C:-1);w.write_shift(-4,P===_[1]-1?ge:P+1)}var W=function(de){for(P+=de;C<P-1;++C)w.write_shift(-4,C+1);de&&(++C,w.write_shift(-4,ge))};for(P=C=0,P+=_[1];C<P;++C)w.write_shift(-4,mt.DIFSECT);for(P+=_[2];C<P;++C)w.write_shift(-4,mt.FATSECT);W(_[3]),W(_[4]);for(var R=0,L=0,N=m.FileIndex[0];R<m.FileIndex.length;++R)N=m.FileIndex[R],N.content&&(L=N.content.length,!(L<4096)&&(N.start=P,W(L+511>>9)));for(W(_[6]+7>>3);w.l&511;)w.write_shift(-4,mt.ENDOFCHAIN);for(P=C=0,R=0;R<m.FileIndex.length;++R)N=m.FileIndex[R],N.content&&(L=N.content.length,!(!L||L>=4096)&&(N.start=P,W(L+63>>6)));for(;w.l&511;)w.write_shift(-4,mt.ENDOFCHAIN);for(C=0;C<_[4]<<2;++C){var re=m.FullPaths[C];if(!re||re.length===0){for(R=0;R<17;++R)w.write_shift(4,0);for(R=0;R<3;++R)w.write_shift(4,-1);for(R=0;R<12;++R)w.write_shift(4,0);continue}N=m.FileIndex[C],C===0&&(N.start=N.size?N.start-1:ge);var ae=C===0&&v.root||N.name;if(L=2*(ae.length+1),w.write_shift(64,ae,"utf16le"),w.write_shift(2,L),w.write_shift(1,N.type),w.write_shift(1,N.color),w.write_shift(-4,N.L),w.write_shift(-4,N.R),w.write_shift(-4,N.C),N.clsid)w.write_shift(16,N.clsid,"hex");else for(R=0;R<4;++R)w.write_shift(4,0);w.write_shift(4,N.state||0),w.write_shift(4,0),w.write_shift(4,0),w.write_shift(4,0),w.write_shift(4,0),w.write_shift(4,N.start),w.write_shift(4,N.size),w.write_shift(4,0)}for(C=1;C<m.FileIndex.length;++C)if(N=m.FileIndex[C],N.size>=4096)if(w.l=N.start+1<<9,$e&&Buffer.isBuffer(N.content))N.content.copy(w,w.l,0,N.size),w.l+=N.size+511&-512;else{for(R=0;R<N.size;++R)w.write_shift(1,N.content[R]);for(;R&511;++R)w.write_shift(1,0)}for(C=1;C<m.FileIndex.length;++C)if(N=m.FileIndex[C],N.size>0&&N.size<4096)if($e&&Buffer.isBuffer(N.content))N.content.copy(w,w.l,0,N.size),w.l+=N.size+63&-64;else{for(R=0;R<N.size;++R)w.write_shift(1,N.content[R]);for(;R&63;++R)w.write_shift(1,0)}if($e)w.l=w.length;else for(;w.l<w.length;)w.write_shift(1,0);return w}function Q(m,y){var v=m.FullPaths.map(function(R){return R.toUpperCase()}),_=v.map(function(R){var L=R.split("/");return L[L.length-(R.slice(-1)=="/"?2:1)]}),w=!1;y.charCodeAt(0)===47?(w=!0,y=v[0].slice(0,-1)+y):w=y.indexOf("/")!==-1;var C=y.toUpperCase(),P=w===!0?v.indexOf(C):_.indexOf(C);if(P!==-1)return m.FileIndex[P];var W=!C.match(sa);for(C=C.replace(Cn,""),W&&(C=C.replace(sa,"!")),P=0;P<v.length;++P)if((W?v[P].replace(sa,"!"):v[P]).replace(Cn,"")==C||(W?_[P].replace(sa,"!"):_[P]).replace(Cn,"")==C)return m.FileIndex[P];return null}var te=64,ge=-2,ze="d0cf11e0a1b11ae1",_e=[208,207,17,224,161,177,26,225],pt="00000000000000000000000000000000",mt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ge,FREESECT:-1,HEADER_SIGNATURE:ze,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:pt,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function jt(m,y,v){l();var _=j(m,v);c.writeFileSync(y,_)}function $t(m){for(var y=new Array(m.length),v=0;v<m.length;++v)y[v]=String.fromCharCode(m[v]);return y.join("")}function bt(m,y){var v=j(m,y);switch(y&&y.type||"buffer"){case"file":return l(),c.writeFileSync(y.filename,v),v;case"binary":return typeof v=="string"?v:$t(v);case"base64":return ps(typeof v=="string"?v:$t(v));case"buffer":if($e)return Buffer.isBuffer(v)?v:ui(v);case"array":return typeof v=="string"?Nr(v):v}return v}var Yt;function b(m){try{var y=m.InflateRaw,v=new y;if(v._processChunk(new Uint8Array([3,0]),v._finishFlushFlag),v.bytesRead)Yt=m;else throw new Error("zlib does not expose bytesRead")}catch(_){console.error("cannot use native zlib: "+(_.message||_))}}function G(m,y){if(!Yt)return bl(m,y);var v=Yt.InflateRaw,_=new v,w=_._processChunk(m.slice(m.l),_._finishFlushFlag);return m.l+=_.bytesRead,w}function F(m){return Yt?Yt.deflateRawSync(m):xl(m)}var k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function be(m){var y=(m<<1|m<<11)&139536|(m<<5|m<<15)&558144;return(y>>16|y>>8|y)&255}for(var fe=typeof Uint8Array<"u",le=fe?new Uint8Array(256):[],Ke=0;Ke<256;++Ke)le[Ke]=be(Ke);function Re(m,y){var v=le[m&255];return y<=8?v>>>8-y:(v=v<<8|le[m>>8&255],y<=16?v>>>16-y:(v=v<<8|le[m>>16&255],v>>>24-y))}function St(m,y){var v=y&7,_=y>>>3;return(m[_]|(v<=6?0:m[_+1]<<8))>>>v&3}function He(m,y){var v=y&7,_=y>>>3;return(m[_]|(v<=5?0:m[_+1]<<8))>>>v&7}function Fr(m,y){var v=y&7,_=y>>>3;return(m[_]|(v<=4?0:m[_+1]<<8))>>>v&15}function it(m,y){var v=y&7,_=y>>>3;return(m[_]|(v<=3?0:m[_+1]<<8))>>>v&31}function pe(m,y){var v=y&7,_=y>>>3;return(m[_]|(v<=1?0:m[_+1]<<8))>>>v&127}function xr(m,y,v){var _=y&7,w=y>>>3,C=(1<<v)-1,P=m[w]>>>_;return v<8-_||(P|=m[w+1]<<8-_,v<16-_)||(P|=m[w+2]<<16-_,v<24-_)||(P|=m[w+3]<<24-_),P&C}function Kr(m,y,v){var _=y&7,w=y>>>3;return _<=5?m[w]|=(v&7)<<_:(m[w]|=v<<_&255,m[w+1]=(v&7)>>8-_),y+3}function Ai(m,y,v){var _=y&7,w=y>>>3;return v=(v&1)<<_,m[w]|=v,y+1}function en(m,y,v){var _=y&7,w=y>>>3;return v<<=_,m[w]|=v&255,v>>>=8,m[w+1]=v,y+8}function gl(m,y,v){var _=y&7,w=y>>>3;return v<<=_,m[w]|=v&255,v>>>=8,m[w+1]=v&255,m[w+2]=v>>>8,y+16}function Ba(m,y){var v=m.length,_=2*v>y?2*v:y+5,w=0;if(v>=y)return m;if($e){var C=t0(_);if(m.copy)m.copy(C);else for(;w<m.length;++w)C[w]=m[w];return C}else if(fe){var P=new Uint8Array(_);if(P.set)P.set(m);else for(;w<v;++w)P[w]=m[w];return P}return m.length=_,m}function Vr(m){for(var y=new Array(m),v=0;v<m;++v)y[v]=0;return y}function Ss(m,y,v){var _=1,w=0,C=0,P=0,W=0,R=m.length,L=fe?new Uint16Array(32):Vr(32);for(C=0;C<32;++C)L[C]=0;for(C=R;C<v;++C)m[C]=0;R=m.length;var N=fe?new Uint16Array(R):Vr(R);for(C=0;C<R;++C)L[w=m[C]]++,_<w&&(_=w),N[C]=0;for(L[0]=0,C=1;C<=_;++C)L[C+16]=W=W+L[C-1]<<1;for(C=0;C<R;++C)W=m[C],W!=0&&(N[C]=L[W+16]++);var re=0;for(C=0;C<R;++C)if(re=m[C],re!=0)for(W=Re(N[C],_)>>_-re,P=(1<<_+4-re)-1;P>=0;--P)y[W|P<<re]=re&15|C<<4;return _}var Ha=fe?new Uint16Array(512):Vr(512),Va=fe?new Uint16Array(32):Vr(32);if(!fe){for(var Di=0;Di<512;++Di)Ha[Di]=0;for(Di=0;Di<32;++Di)Va[Di]=0}(function(){for(var m=[],y=0;y<32;y++)m.push(5);Ss(m,Va,32);var v=[];for(y=0;y<=143;y++)v.push(8);for(;y<=255;y++)v.push(9);for(;y<=279;y++)v.push(7);for(;y<=287;y++)v.push(8);Ss(v,Ha,288)})();var Cu=function(){for(var y=fe?new Uint8Array(32768):[],v=0,_=0;v<me.length-1;++v)for(;_<me[v+1];++_)y[_]=v;for(;_<32768;++_)y[_]=29;var w=fe?new Uint8Array(259):[];for(v=0,_=0;v<Z.length-1;++v)for(;_<Z[v+1];++_)w[_]=v;function C(W,R){for(var L=0;L<W.length;){var N=Math.min(65535,W.length-L),re=L+N==W.length;for(R.write_shift(1,+re),R.write_shift(2,N),R.write_shift(2,~N&65535);N-- >0;)R[R.l++]=W[L++]}return R.l}function P(W,R){for(var L=0,N=0,re=fe?new Uint16Array(32768):[];N<W.length;){var ae=Math.min(65535,W.length-N);if(ae<10){for(L=Kr(R,L,+(N+ae==W.length)),L&7&&(L+=8-(L&7)),R.l=L/8|0,R.write_shift(2,ae),R.write_shift(2,~ae&65535);ae-- >0;)R[R.l++]=W[N++];L=R.l*8;continue}L=Kr(R,L,+(N+ae==W.length)+2);for(var de=0;ae-- >0;){var oe=W[N];de=(de<<5^oe)&32767;var ue=-1,Ee=0;if((ue=re[de])&&(ue|=N&-32768,ue>N&&(ue-=32768),ue<N))for(;W[ue+Ee]==W[N+Ee]&&Ee<250;)++Ee;if(Ee>2){oe=w[Ee],oe<=22?L=en(R,L,le[oe+1]>>1)-1:(en(R,L,3),L+=5,en(R,L,le[oe-23]>>5),L+=3);var Je=oe<8?0:oe-4>>2;Je>0&&(gl(R,L,Ee-Z[oe]),L+=Je),oe=y[N-ue],L=en(R,L,le[oe]>>3),L-=3;var Kt=oe<4?0:oe-2>>1;Kt>0&&(gl(R,L,N-ue-me[oe]),L+=Kt);for(var lt=0;lt<Ee;++lt)re[de]=N&32767,de=(de<<5^W[N])&32767,++N;ae-=Ee-1}else oe<=143?oe=oe+48:L=Ai(R,L,1),L=en(R,L,le[oe]),re[de]=N&32767,++N}L=en(R,L,0)-1}return R.l=(L+7)/8|0,R.l}return function(R,L){return R.length<8?C(R,L):P(R,L)}}();function xl(m){var y=H(50+Math.floor(m.length*1.1)),v=Cu(m,y);return y.slice(0,v)}var vl=fe?new Uint16Array(32768):Vr(32768),_l=fe?new Uint16Array(32768):Vr(32768),yl=fe?new Uint16Array(128):Vr(128),wl=1,Cl=1;function bu(m,y){var v=it(m,y)+257;y+=5;var _=it(m,y)+1;y+=5;var w=Fr(m,y)+4;y+=4;for(var C=0,P=fe?new Uint8Array(19):Vr(19),W=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],R=1,L=fe?new Uint8Array(8):Vr(8),N=fe?new Uint8Array(8):Vr(8),re=P.length,ae=0;ae<w;++ae)P[k[ae]]=C=He(m,y),R<C&&(R=C),L[C]++,y+=3;var de=0;for(L[0]=0,ae=1;ae<=R;++ae)N[ae]=de=de+L[ae-1]<<1;for(ae=0;ae<re;++ae)(de=P[ae])!=0&&(W[ae]=N[de]++);var oe=0;for(ae=0;ae<re;++ae)if(oe=P[ae],oe!=0){de=le[W[ae]]>>8-oe;for(var ue=(1<<7-oe)-1;ue>=0;--ue)yl[de|ue<<oe]=oe&7|ae<<3}var Ee=[];for(R=1;Ee.length<v+_;)switch(de=yl[pe(m,y)],y+=de&7,de>>>=3){case 16:for(C=3+St(m,y),y+=2,de=Ee[Ee.length-1];C-- >0;)Ee.push(de);break;case 17:for(C=3+He(m,y),y+=3;C-- >0;)Ee.push(0);break;case 18:for(C=11+pe(m,y),y+=7;C-- >0;)Ee.push(0);break;default:Ee.push(de),R<de&&(R=de);break}var Je=Ee.slice(0,v),Kt=Ee.slice(v);for(ae=v;ae<286;++ae)Je[ae]=0;for(ae=_;ae<30;++ae)Kt[ae]=0;return wl=Ss(Je,vl,286),Cl=Ss(Kt,_l,30),y}function Su(m,y){if(m[0]==3&&!(m[1]&3))return[Xi(y),2];for(var v=0,_=0,w=t0(y||1<<18),C=0,P=w.length>>>0,W=0,R=0;(_&1)==0;){if(_=He(m,v),v+=3,_>>>1)_>>1==1?(W=9,R=5):(v=bu(m,v),W=wl,R=Cl);else{v&7&&(v+=8-(v&7));var L=m[v>>>3]|m[(v>>>3)+1]<<8;if(v+=32,L>0)for(!y&&P<C+L&&(w=Ba(w,C+L),P=w.length);L-- >0;)w[C++]=m[v>>>3],v+=8;continue}for(;;){!y&&P<C+32767&&(w=Ba(w,C+32767),P=w.length);var N=xr(m,v,W),re=_>>>1==1?Ha[N]:vl[N];if(v+=re&15,re>>>=4,(re>>>8&255)===0)w[C++]=re;else{if(re==256)break;re-=257;var ae=re<8?0:re-4>>2;ae>5&&(ae=0);var de=C+Z[re];ae>0&&(de+=xr(m,v,ae),v+=ae),N=xr(m,v,R),re=_>>>1==1?Va[N]:_l[N],v+=re&15,re>>>=4;var oe=re<4?0:re-2>>1,ue=me[re];for(oe>0&&(ue+=xr(m,v,oe),v+=oe),!y&&P<de&&(w=Ba(w,de+100),P=w.length);C<de;)w[C]=w[C-ue],++C}}}return y?[w,v+7>>>3]:[w.slice(0,C),v+7>>>3]}function bl(m,y){var v=m.slice(m.l||0),_=Su(v,y);return m.l+=_[1],_[0]}function Sl(m,y){if(m)typeof console<"u"&&console.error(y);else throw new Error(y)}function Tl(m,y){var v=m;pr(v,0);var _=[],w=[],C={FileIndex:_,FullPaths:w};D(C,{root:y.root});for(var P=v.length-4;(v[P]!=80||v[P+1]!=75||v[P+2]!=5||v[P+3]!=6)&&P>=0;)--P;v.l=P+4,v.l+=4;var W=v.read_shift(2);v.l+=6;var R=v.read_shift(4);for(v.l=R,P=0;P<W;++P){v.l+=20;var L=v.read_shift(4),N=v.read_shift(4),re=v.read_shift(2),ae=v.read_shift(2),de=v.read_shift(2);v.l+=8;var oe=v.read_shift(4),ue=o(v.slice(v.l+re,v.l+re+ae));v.l+=re+ae+de;var Ee=v.l;v.l=oe+4,Tu(v,L,N,C,ue),v.l=Ee}return C}function Tu(m,y,v,_,w){m.l+=2;var C=m.read_shift(2),P=m.read_shift(2),W=a(m);if(C&8257)throw new Error("Unsupported ZIP encryption");for(var R=m.read_shift(4),L=m.read_shift(4),N=m.read_shift(4),re=m.read_shift(2),ae=m.read_shift(2),de="",oe=0;oe<re;++oe)de+=String.fromCharCode(m[m.l++]);if(ae){var ue=o(m.slice(m.l,m.l+ae));(ue[21589]||{}).mt&&(W=ue[21589].mt),((w||{})[21589]||{}).mt&&(W=w[21589].mt)}m.l+=ae;var Ee=m.slice(m.l,m.l+L);switch(P){case 8:Ee=G(m,N);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+P)}var Je=!1;C&8&&(R=m.read_shift(4),R==134695760&&(R=m.read_shift(4),Je=!0),L=m.read_shift(4),N=m.read_shift(4)),L!=y&&Sl(Je,"Bad compressed size: "+y+" != "+L),N!=v&&Sl(Je,"Bad uncompressed size: "+v+" != "+N),Wa(_,de,Ee,{unsafe:!0,mt:W})}function Eu(m,y){var v=y||{},_=[],w=[],C=H(1),P=v.compression?8:0,W=0,R=!1;R&&(W|=8);var L=0,N=0,re=0,ae=0,de=m.FullPaths[0],oe=de,ue=m.FileIndex[0],Ee=[],Je=0;for(L=1;L<m.FullPaths.length;++L)if(oe=m.FullPaths[L].slice(de.length),ue=m.FileIndex[L],!(!ue.size||!ue.content||oe=="Sh33tJ5")){var Kt=re,lt=H(oe.length);for(N=0;N<oe.length;++N)lt.write_shift(1,oe.charCodeAt(N)&127);lt=lt.slice(0,lt.l),Ee[ae]=Bp.buf(ue.content,0);var sr=ue.content;P==8&&(sr=F(sr)),C=H(30),C.write_shift(4,67324752),C.write_shift(2,20),C.write_shift(2,W),C.write_shift(2,P),ue.mt?s(C,ue.mt):C.write_shift(4,0),C.write_shift(-4,W&8?0:Ee[ae]),C.write_shift(4,W&8?0:sr.length),C.write_shift(4,W&8?0:ue.content.length),C.write_shift(2,lt.length),C.write_shift(2,0),re+=C.length,_.push(C),re+=lt.length,_.push(lt),re+=sr.length,_.push(sr),W&8&&(C=H(12),C.write_shift(-4,Ee[ae]),C.write_shift(4,sr.length),C.write_shift(4,ue.content.length),re+=C.l,_.push(C)),C=H(46),C.write_shift(4,33639248),C.write_shift(2,0),C.write_shift(2,20),C.write_shift(2,W),C.write_shift(2,P),C.write_shift(4,0),C.write_shift(-4,Ee[ae]),C.write_shift(4,sr.length),C.write_shift(4,ue.content.length),C.write_shift(2,lt.length),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(4,0),C.write_shift(4,Kt),Je+=C.l,w.push(C),Je+=lt.length,w.push(lt),++ae}return C=H(22),C.write_shift(4,101010256),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,ae),C.write_shift(2,ae),C.write_shift(4,Je),C.write_shift(4,re),C.write_shift(2,0),Dt([Dt(_),Dt(w),C])}var Ts={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ku(m,y){if(m.ctype)return m.ctype;var v=m.name||"",_=v.match(/\.([^\.]+)$/);return _&&Ts[_[1]]||y&&(_=(v=y).match(/[\.\\]([^\.\\])+$/),_&&Ts[_[1]])?Ts[_[1]]:"application/octet-stream"}function Iu(m){for(var y=ps(m),v=[],_=0;_<y.length;_+=76)v.push(y.slice(_,_+76));return v.join(`\r
`)+`\r
`}function Fu(m){var y=m.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(L){var N=L.charCodeAt(0).toString(16).toUpperCase();return"="+(N.length==1?"0"+N:N)});y=y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),y.charAt(0)==`
`&&(y="=0D"+y.slice(1)),y=y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var v=[],_=y.split(`\r
`),w=0;w<_.length;++w){var C=_[w];if(C.length==0){v.push("");continue}for(var P=0;P<C.length;){var W=76,R=C.slice(P,P+W);R.charAt(W-1)=="="?W--:R.charAt(W-2)=="="?W-=2:R.charAt(W-3)=="="&&(W-=3),R=C.slice(P,P+W),P+=W,P<C.length&&(R+="="),v.push(R)}}return v.join(`\r
`)}function Ou(m){for(var y=[],v=0;v<m.length;++v){for(var _=m[v];v<=m.length&&_.charAt(_.length-1)=="=";)_=_.slice(0,_.length-1)+m[++v];y.push(_)}for(var w=0;w<y.length;++w)y[w]=y[w].replace(/[=][0-9A-Fa-f]{2}/g,function(C){return String.fromCharCode(parseInt(C.slice(1),16))});return Nr(y.join(`\r
`))}function Au(m,y,v){for(var _="",w="",C="",P,W=0;W<10;++W){var R=y[W];if(!R||R.match(/^\s*$/))break;var L=R.match(/^(.*?):\s*([^\s].*)$/);if(L)switch(L[1].toLowerCase()){case"content-location":_=L[2].trim();break;case"content-type":C=L[2].trim();break;case"content-transfer-encoding":w=L[2].trim();break}}switch(++W,w.toLowerCase()){case"base64":P=Nr(ci(y.slice(W).join("")));break;case"quoted-printable":P=Ou(y.slice(W));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+w)}var N=Wa(m,_.slice(v.length),P,{unsafe:!0});C&&(N.ctype=C)}function Du(m,y){if($t(m.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var v=y&&y.root||"",_=($e&&Buffer.isBuffer(m)?m.toString("binary"):$t(m)).split(`\r
`),w=0,C="";for(w=0;w<_.length;++w)if(C=_[w],!!/^Content-Location:/i.test(C)&&(C=C.slice(C.indexOf("file")),v||(v=C.slice(0,C.lastIndexOf("/")+1)),C.slice(0,v.length)!=v))for(;v.length>0&&(v=v.slice(0,v.length-1),v=v.slice(0,v.lastIndexOf("/")+1),C.slice(0,v.length)!=v););var P=(_[1]||"").match(/boundary="(.*?)"/);if(!P)throw new Error("MAD cannot find boundary");var W="--"+(P[1]||""),R=[],L=[],N={FileIndex:R,FullPaths:L};D(N);var re,ae=0;for(w=0;w<_.length;++w){var de=_[w];de!==W&&de!==W+"--"||(ae++&&Au(N,_.slice(re,w),v),re=w)}return N}function Mu(m,y){var v=y||{},_=v.boundary||"SheetJS";_="------="+_;for(var w=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+_.slice(2)+'"',"","",""],C=m.FullPaths[0],P=C,W=m.FileIndex[0],R=1;R<m.FullPaths.length;++R)if(P=m.FullPaths[R].slice(C.length),W=m.FileIndex[R],!(!W.size||!W.content||P=="Sh33tJ5")){P=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ee){return"_x"+Ee.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ee){return"_u"+Ee.charCodeAt(0).toString(16)+"_"});for(var L=W.content,N=$e&&Buffer.isBuffer(L)?L.toString("binary"):$t(L),re=0,ae=Math.min(1024,N.length),de=0,oe=0;oe<=ae;++oe)(de=N.charCodeAt(oe))>=32&&de<128&&++re;var ue=re>=ae*4/5;w.push(_),w.push("Content-Location: "+(v.root||"file:///C:/SheetJS/")+P),w.push("Content-Transfer-Encoding: "+(ue?"quoted-printable":"base64")),w.push("Content-Type: "+ku(W,P)),w.push(""),w.push(ue?Fu(N):Iu(N))}return w.push(_+`--\r
`),w.join(`\r
`)}function Pu(m){var y={};return D(y,m),y}function Wa(m,y,v,_){var w=_&&_.unsafe;w||D(m);var C=!w&&qe.find(m,y);if(!C){var P=m.FullPaths[0];y.slice(0,P.length)==P?P=y:(P.slice(-1)!="/"&&(P+="/"),P=(P+y).replace("//","/")),C={name:n(y),type:2},m.FileIndex.push(C),m.FullPaths.push(P),w||qe.utils.cfb_gc(m)}return C.content=v,C.size=v?v.length:0,_&&(_.CLSID&&(C.clsid=_.CLSID),_.mt&&(C.mt=_.mt),_.ct&&(C.ct=_.ct)),C}function Lu(m,y){D(m);var v=qe.find(m,y);if(v){for(var _=0;_<m.FileIndex.length;++_)if(m.FileIndex[_]==v)return m.FileIndex.splice(_,1),m.FullPaths.splice(_,1),!0}return!1}function Ru(m,y,v){D(m);var _=qe.find(m,y);if(_){for(var w=0;w<m.FileIndex.length;++w)if(m.FileIndex[w]==_)return m.FileIndex[w].name=n(v),m.FullPaths[w]=v,!0}return!1}function Nu(m){z(m,!0)}return t.find=Q,t.read=ie,t.parse=h,t.write=bt,t.writeFile=jt,t.utils={cfb_new:Pu,cfb_add:Wa,cfb_del:Lu,cfb_mov:Ru,cfb_gc:Nu,ReadShift:ls,CheckField:fh,prep_blob:pr,bconcat:Dt,use_zlib:b,_deflateRaw:xl,_inflateRaw:bl,consts:mt},t}(),oa;function Hp(r){return typeof r=="string"?Ea(r):Array.isArray(r)?up(r):r}function ys(r,t,e){if(typeof oa<"u"&&oa.writeFileSync)return e?oa.writeFileSync(r,t,e):oa.writeFileSync(r,t);if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=Ea(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(r,t)}var i=e=="utf8"?si(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,r);if(typeof Blob<"u"){var n=new Blob([Hp(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,r);if(typeof saveAs<"u")return saveAs(n,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=r,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(r);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=_s(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+r)}function Lt(r){for(var t=Object.keys(r),e=[],i=0;i<t.length;++i)Object.prototype.hasOwnProperty.call(r,t[i])&&e.push(t[i]);return e}function c0(r,t){for(var e=[],i=Lt(r),n=0;n!==i.length;++n)e[r[i[n]][t]]==null&&(e[r[i[n]][t]]=i[n]);return e}function Wo(r){for(var t=[],e=Lt(r),i=0;i!==e.length;++i)t[r[e[i]]]=e[i];return t}function Fa(r){for(var t=[],e=Lt(r),i=0;i!==e.length;++i)t[r[e[i]]]=parseInt(e[i],10);return t}function Vp(r){for(var t=[],e=Lt(r),i=0;i!==e.length;++i)t[r[e[i]]]==null&&(t[r[e[i]]]=[]),t[r[e[i]]].push(e[i]);return t}var ga=new Date(1899,11,30,0,0,0);function ir(r,t){var e=r.getTime();t&&(e-=1462*24*60*60*1e3);var i=ga.getTime()+(r.getTimezoneOffset()-ga.getTimezoneOffset())*6e4;return(e-i)/(24*60*60*1e3)}var eh=new Date,Wp=ga.getTime()+(eh.getTimezoneOffset()-ga.getTimezoneOffset())*6e4,h0=eh.getTimezoneOffset();function th(r){var t=new Date;return t.setTime(r*24*60*60*1e3+Wp),t.getTimezoneOffset()!==h0&&t.setTime(t.getTime()+(t.getTimezoneOffset()-h0)*6e4),t}var u0=new Date("2017-02-19T19:06:09.000Z"),rh=isNaN(u0.getFullYear())?new Date("2/19/17"):u0,$p=rh.getFullYear()==2017;function Xt(r,t){var e=new Date(r);if($p)return t>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):t<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(r instanceof Date)return r;if(rh.getFullYear()==1917&&!isNaN(e.getFullYear())){var i=e.getFullYear();return r.indexOf(""+i)>-1||e.setFullYear(e.getFullYear()+100),e}var n=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Oa(r,t){if($e&&Buffer.isBuffer(r)){if(t){if(r[0]==255&&r[1]==254)return si(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return si(hp(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(r[0]==255&&r[1]==254)return si(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return si(new TextDecoder("utf-16be").decode(r.slice(2)))}var e={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(s){return e[s]||s})}catch{}for(var i=[],n=0;n!=r.length;++n)i.push(String.fromCharCode(r[n]));return i.join("")}function nr(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var t={};for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=nr(r[e]));return t}function at(r,t){for(var e="";e.length<t;)e+=r;return e}function oi(r){var t=Number(r);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(r))return t;var e=1,i=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(i))||(i=i.replace(/[(](.*)[)]/,function(n,s){return e=-e,s}),!isNaN(t=Number(i)))?t/e:t}var zp=["january","february","march","april","may","june","july","august","september","october","november","december"];function ms(r){var t=new Date(r),e=new Date(NaN),i=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return e;var a=r.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&zp.indexOf(a)==-1)return e}else if(a.match(/[a-z]/))return e;return i<0||i>8099?e:(n>0||s>1)&&i!=101?t:r.match(/[^-0-9:,\/\\]/)?e:t}function De(r,t,e){if(r.FullPaths){if(typeof e=="string"){var i;return $e?i=ui(e):i=fp(e),qe.utils.cfb_add(r,t,i)}qe.utils.cfb_add(r,t,e)}else r.file(t,e)}function $o(){return qe.utils.cfb_new()}var ft=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var Up={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},zo=Wo(Up);var Uo=/[&<>'"]/g,Gp=/[\u0000-\u0008\u000b-\u001f]/g;function je(r){var t=r+"";return t.replace(Uo,function(e){return zo[e]}).replace(Gp,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function f0(r){return je(r).replace(/ /g,"_x0020_")}var ih=/[\u0000-\u001f]/g;function Xp(r){var t=r+"";return t.replace(Uo,function(e){return zo[e]}).replace(/\n/g,"<br/>").replace(ih,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function jp(r){var t=r+"";return t.replace(Uo,function(e){return zo[e]}).replace(ih,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function Yp(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function Kp(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Io(r){for(var t="",e=0,i=0,n=0,s=0,a=0,o=0;e<r.length;){if(i=r.charCodeAt(e++),i<128){t+=String.fromCharCode(i);continue}if(n=r.charCodeAt(e++),i>191&&i<224){a=(i&31)<<6,a|=n&63,t+=String.fromCharCode(a);continue}if(s=r.charCodeAt(e++),i<240){t+=String.fromCharCode((i&15)<<12|(n&63)<<6|s&63);continue}a=r.charCodeAt(e++),o=((i&7)<<18|(n&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function d0(r){var t=Xi(2*r.length),e,i,n=1,s=0,a=0,o;for(i=0;i<r.length;i+=n)n=1,(o=r.charCodeAt(i))<128?e=o:o<224?(e=(o&31)*64+(r.charCodeAt(i+1)&63),n=2):o<240?(e=(o&15)*4096+(r.charCodeAt(i+1)&63)*64+(r.charCodeAt(i+2)&63),n=3):(n=4,e=(o&7)*262144+(r.charCodeAt(i+1)&63)*4096+(r.charCodeAt(i+2)&63)*64+(r.charCodeAt(i+3)&63),e-=65536,a=55296+(e>>>10&1023),e=56320+(e&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=e%256,t[s++]=e>>>8;return t.slice(0,s).toString("ucs2")}function p0(r){return ui(r,"binary").toString("utf8")}var la="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",os=$e&&(p0(la)==Io(la)&&p0||d0(la)==Io(la)&&d0)||Io,si=$e?function(r){return ui(r,"utf8").toString("binary")}:function(r){for(var t=[],e=0,i=0,n=0;e<r.length;)switch(i=r.charCodeAt(e++),!0){case i<128:t.push(String.fromCharCode(i));break;case i<2048:t.push(String.fromCharCode(192+(i>>6))),t.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,n=r.charCodeAt(e++)-56320+(i<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(i>>12))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)))}return t.join("")};var qp=function(){var r=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var i=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<r.length;++n)i=i.replace(r[n][0],r[n][1]);return i}}();var nh=/(^\s|\s$|\n)/;function Mt(r,t){return"<"+r+(t.match(nh)?' xml:space="preserve"':"")+">"+t+"</"+r+">"}function gs(r){return Lt(r).map(function(t){return" "+t+'="'+r[t]+'"'}).join("")}function ne(r,t,e){return"<"+r+(e!=null?gs(e):"")+(t!=null?(t.match(nh)?' xml:space="preserve"':"")+">"+t+"</"+r:"/")+">"}function Ro(r,t){try{return r.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function Zp(r,t){switch(typeof r){case"string":var e=ne("vt:lpwstr",je(r));return t&&(e=e.replace(/&quot;/g,"_x0022_")),e;case"number":return ne((r|0)==r?"vt:i4":"vt:r8",je(String(r)));case"boolean":return ne("vt:bool",r?"true":"false")}if(r instanceof Date)return ne("vt:filetime",Ro(r));throw new Error("Unable to serialize "+r)}var yt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Fn=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],mr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Qp(r,t){for(var e=1-2*(r[t+7]>>>7),i=((r[t+7]&127)<<4)+(r[t+6]>>>4&15),n=r[t+6]&15,s=5;s>=0;--s)n=n*256+r[t+s];return i==2047?n==0?e*(1/0):NaN:(i==0?i=-1022:(i-=1023,n+=Math.pow(2,52)),e*Math.pow(2,i-52)*n)}function Jp(r,t,e){var i=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,a=i?-t:t;isFinite(a)?a==0?n=s=0:(n=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)r[e+o]=s&255;r[e+6]=(n&15)<<4|s&15,r[e+7]=n>>4|i}var m0=function(r){for(var t=[],e=10240,i=0;i<r[0].length;++i)if(r[0][i])for(var n=0,s=r[0][i].length;n<s;n+=e)t.push.apply(t,r[0][i].slice(n,n+e));return t},g0=$e?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(t){return Buffer.isBuffer(t)?t:ui(t)})):m0(r)}:m0,x0=function(r,t,e){for(var i=[],n=t;n<e;n+=2)i.push(String.fromCharCode(as(r,n)));return i.join("").replace(Cn,"")},Aa=$e?function(r,t,e){return Buffer.isBuffer(r)?r.toString("utf16le",t,e).replace(Cn,""):x0(r,t,e)}:x0,v0=function(r,t,e){for(var i=[],n=t;n<t+e;++n)i.push(("0"+r[n].toString(16)).slice(-2));return i.join("")},sh=$e?function(r,t,e){return Buffer.isBuffer(r)?r.toString("hex",t,t+e):v0(r,t,e)}:v0,_0=function(r,t,e){for(var i=[],n=t;n<e;n++)i.push(String.fromCharCode(yn(r,n)));return i.join("")},On=$e?function(t,e,i){return Buffer.isBuffer(t)?t.toString("utf8",e,i):_0(t,e,i)}:_0,ah=function(r,t){var e=_t(r,t);return e>0?On(r,t+4,t+4+e-1):""},Go=ah,oh=function(r,t){var e=_t(r,t);return e>0?On(r,t+4,t+4+e-1):""},Xo=oh,lh=function(r,t){var e=2*_t(r,t);return e>0?On(r,t+4,t+4+e-1):""},jo=lh,ch=function(t,e){var i=_t(t,e);return i>0?Aa(t,e+4,e+4+i):""},Yo=ch,hh=function(r,t){var e=_t(r,t);return e>0?On(r,t+4,t+4+e):""},Ko=hh,uh=function(r,t){return Qp(r,t)},xa=uh,qo=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};$e&&(Go=function(t,e){if(!Buffer.isBuffer(t))return ah(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},Xo=function(t,e){if(!Buffer.isBuffer(t))return oh(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},jo=function(t,e){if(!Buffer.isBuffer(t))return lh(t,e);var i=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i-1)},Yo=function(t,e){if(!Buffer.isBuffer(t))return ch(t,e);var i=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i)},Ko=function(t,e){if(!Buffer.isBuffer(t))return hh(t,e);var i=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+i)},xa=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):uh(t,e)},qo=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function em(){Aa=function(r,t,e){return Ze.utils.decode(1200,r.slice(t,e)).replace(Cn,"")},On=function(r,t,e){return Ze.utils.decode(65001,r.slice(t,e))},Go=function(r,t){var e=_t(r,t);return e>0?Ze.utils.decode(kn,r.slice(t+4,t+4+e-1)):""},Xo=function(r,t){var e=_t(r,t);return e>0?Ze.utils.decode(Ui,r.slice(t+4,t+4+e-1)):""},jo=function(r,t){var e=2*_t(r,t);return e>0?Ze.utils.decode(1200,r.slice(t+4,t+4+e-1)):""},Yo=function(r,t){var e=_t(r,t);return e>0?Ze.utils.decode(1200,r.slice(t+4,t+4+e)):""},Ko=function(r,t){var e=_t(r,t);return e>0?Ze.utils.decode(65001,r.slice(t+4,t+4+e)):""}}typeof Ze<"u"&&em();var yn=function(r,t){return r[t]},as=function(r,t){return r[t+1]*256+r[t]},tm=function(r,t){var e=r[t+1]*256+r[t];return e<32768?e:(65535-e+1)*-1},_t=function(r,t){return r[t+3]*(1<<24)+(r[t+2]<<16)+(r[t+1]<<8)+r[t]},zi=function(r,t){return r[t+3]<<24|r[t+2]<<16|r[t+1]<<8|r[t]},rm=function(r,t){return r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3]};function ls(r,t){var e="",i,n,s=[],a,o,c,l;switch(t){case"dbcs":if(l=this.l,$e&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*r).toString("utf16le");else for(c=0;c<r;++c)e+=String.fromCharCode(as(this,l)),l+=2;r*=2;break;case"utf8":e=On(this,this.l,this.l+r);break;case"utf16le":r*=2,e=Aa(this,this.l,this.l+r);break;case"wstr":if(typeof Ze<"u")e=Ze.utils.decode(Ui,this.slice(this.l,this.l+2*r));else return ls.call(this,r,"dbcs");r=2*r;break;case"lpstr-ansi":e=Go(this,this.l),r=4+_t(this,this.l);break;case"lpstr-cp":e=Xo(this,this.l),r=4+_t(this,this.l);break;case"lpwstr":e=jo(this,this.l),r=4+2*_t(this,this.l);break;case"lpp4":r=4+_t(this,this.l),e=Yo(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+_t(this,this.l),e=Ko(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,e="";(a=yn(this,this.l+r++))!==0;)s.push(na(a));e=s.join("");break;case"_wstr":for(r=0,e="";(a=as(this,this.l+r))!==0;)s.push(na(a)),r+=2;r+=2,e=s.join("");break;case"dbcs-cont":for(e="",l=this.l,c=0;c<r;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=yn(this,l),this.l=l+1,o=ls.call(this,r-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(na(as(this,l))),l+=2}e=s.join(""),r*=2;break;case"cpstr":if(typeof Ze<"u"){e=Ze.utils.decode(Ui,this.slice(this.l,this.l+r));break}case"sbcs-cont":for(e="",l=this.l,c=0;c!=r;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=yn(this,l),this.l=l+1,o=ls.call(this,r-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(na(yn(this,l))),l+=1}e=s.join("");break;default:switch(r){case 1:return i=yn(this,this.l),this.l++,i;case 2:return i=(t==="i"?tm:as)(this,this.l),this.l+=2,i;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(i=(r>0?zi:rm)(this,this.l),this.l+=4,i):(n=_t(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return r==8?n=xa(this,this.l):n=xa([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;r=8;case 16:e=sh(this,this.l,r);break}}return this.l+=r,e}var im=function(r,t,e){r[e]=t&255,r[e+1]=t>>>8&255,r[e+2]=t>>>16&255,r[e+3]=t>>>24&255},nm=function(r,t,e){r[e]=t&255,r[e+1]=t>>8&255,r[e+2]=t>>16&255,r[e+3]=t>>24&255},sm=function(r,t,e){r[e]=t&255,r[e+1]=t>>>8&255};function am(r,t,e){var i=0,n=0;if(e==="dbcs"){for(n=0;n!=t.length;++n)sm(this,t.charCodeAt(n),this.l+2*n);i=2*t.length}else if(e==="sbcs"){if(typeof Ze<"u"&&kn==874)for(n=0;n!=t.length;++n){var s=Ze.utils.encode(kn,t.charAt(n));this[this.l+n]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;i=t.length}else if(e==="hex"){for(;n<r;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(e==="utf16le"){var a=Math.min(this.l+r,this.length);for(n=0;n<Math.min(t.length,r);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(r){case 1:i=1,this[this.l]=t&255;break;case 2:i=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:i=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:i=4,im(this,t,this.l);break;case 8:if(i=8,e==="f"){Jp(this,t,this.l);break}case 16:break;case-4:i=4,nm(this,t,this.l);break}return this.l+=i,this}function fh(r,t){var e=sh(this,this.l,r.length>>1);if(e!==r)throw new Error(t+"Expected "+r+" saw "+e);this.l+=r.length>>1}function pr(r,t){r.l=t,r.read_shift=ls,r.chk=fh,r.write_shift=am}function Yr(r,t){r.l+=t}function H(r){var t=Xi(r);return pr(t,0),t}function rr(){var r=[],t=$e?256:2048,e=function(l){var h=H(l);return pr(h,0),h},i=e(t),n=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&r.push(i),i=null)},s=function(l){return i&&l<i.length-i.l?i:(n(),i=e(Math.max(l+1,t)))},a=function(){return n(),Dt(r)},o=function(l){n(),i=l,i.l==null&&(i.l=i.length),s(t)};return{next:s,push:o,end:a,_bufs:r}}function K(r,t,e,i){var n=+t,s;if(!isNaN(n)){i||(i=J_[n].p||(e||[]).length||0),s=1+(n>=128?1:0)+1,i>=128&&++s,i>=16384&&++s,i>=2097152&&++s;var a=r.next(s);n<=127?a.write_shift(1,n):(a.write_shift(1,(n&127)+128),a.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(i>=128)a.write_shift(1,(i&127)+128),i>>=7;else{a.write_shift(1,i);break}i>0&&qo(e)&&r.push(e)}}function cs(r,t,e){var i=nr(r);if(t.s?(i.cRel&&(i.c+=t.s.c),i.rRel&&(i.r+=t.s.r)):(i.cRel&&(i.c+=t.c),i.rRel&&(i.r+=t.r)),!e||e.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function y0(r,t,e){var i=nr(r);return i.s=cs(i.s,t.s,e),i.e=cs(i.e,t.s,e),i}function hs(r,t){if(r.cRel&&r.c<0)for(r=nr(r);r.c<0;)r.c+=t>8?16384:256;if(r.rRel&&r.r<0)for(r=nr(r);r.r<0;)r.r+=t>8?1048576:t>5?65536:16384;var e=Ye(r);return!r.cRel&&r.cRel!=null&&(e=cm(e)),!r.rRel&&r.rRel!=null&&(e=om(e)),e}function Fo(r,t){return r.s.r==0&&!r.s.rRel&&r.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+Vt(r.s.c)+":"+(r.e.cRel?"":"$")+Vt(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(t.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Pt(r.s.r)+":"+(r.e.rRel?"":"$")+Pt(r.e.r):hs(r.s,t.biff)+":"+hs(r.e,t.biff)}function Zo(r){return parseInt(lm(r),10)-1}function Pt(r){return""+(r+1)}function om(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function lm(r){return r.replace(/\$(\d+)$/,"$1")}function Qo(r){for(var t=hm(r),e=0,i=0;i!==t.length;++i)e=26*e+t.charCodeAt(i)-64;return e-1}function Vt(r){if(r<0)throw new Error("invalid column "+r);var t="";for(++r;r;r=Math.floor((r-1)/26))t=String.fromCharCode((r-1)%26+65)+t;return t}function cm(r){return r.replace(/^([A-Z])/,"$$$1")}function hm(r){return r.replace(/^\$([A-Z])/,"$1")}function um(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function wt(r){for(var t=0,e=0,i=0;i<r.length;++i){var n=r.charCodeAt(i);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(e=26*e+(n-64))}return{c:e-1,r:t-1}}function Ye(r){for(var t=r.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(r.r+1)}function gr(r){var t=r.indexOf(":");return t==-1?{s:wt(r),e:wt(r)}:{s:wt(r.slice(0,t)),e:wt(r.slice(t+1))}}function ut(r,t){return typeof t>"u"||typeof t=="number"?ut(r.s,r.e):(typeof r!="string"&&(r=Ye(r)),typeof t!="string"&&(t=Ye(t)),r==t?r:r+":"+t)}function et(r){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,i=0,n=0,s=r.length;for(e=0;i<s&&!((n=r.charCodeAt(i)-64)<1||n>26);++i)e=26*e+n;for(t.s.c=--e,e=0;i<s&&!((n=r.charCodeAt(i)-48)<0||n>9);++i)e=10*e+n;if(t.s.r=--e,i===s||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++i,e=0;i!=s&&!((n=r.charCodeAt(i)-64)<1||n>26);++i)e=26*e+n;for(t.e.c=--e,e=0;i!=s&&!((n=r.charCodeAt(i)-48)<0||n>9);++i)e=10*e+n;return t.e.r=--e,t}function w0(r,t){var e=r.t=="d"&&t instanceof Date;if(r.z!=null)try{return r.w=ki(r.z,e?ir(t):t)}catch{}try{return r.w=ki((r.XF||{}).numFmtId||(e?14:0),e?ir(t):t)}catch{return""+t}}function hi(r,t,e){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&e&&e.dateNF&&(r.z=e.dateNF),r.t=="e"?ws[r.v]||r.v:t==null?w0(r,r.v):w0(r,t))}function Ki(r,t){var e=t&&t.sheet?t.sheet:"Sheet1",i={};return i[e]=r,{SheetNames:[e],Sheets:i}}function dh(r,t,e){var i=e||{},n=r?Array.isArray(r):i.dense;jr!=null&&n==null&&(n=jr);var s=r||(n?[]:{}),a=0,o=0;if(s&&i.origin!=null){if(typeof i.origin=="number")a=i.origin;else{var c=typeof i.origin=="string"?wt(i.origin):i.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=et(s["!ref"]);l.s.c=h.s.c,l.s.r=h.s.r,l.e.c=Math.max(l.e.c,h.e.c),l.e.r=Math.max(l.e.r,h.e.r),a==-1&&(l.e.r=a=h.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[u].length;++f)if(!(typeof t[u][f]>"u")){var p={v:t[u][f]},x=a+u,d=o+f;if(l.s.r>x&&(l.s.r=x),l.s.c>d&&(l.s.c=d),l.e.r<x&&(l.e.r=x),l.e.c<d&&(l.e.c=d),t[u][f]&&typeof t[u][f]=="object"&&!Array.isArray(t[u][f])&&!(t[u][f]instanceof Date))p=t[u][f];else if(Array.isArray(p.v)&&(p.f=t[u][f][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(i.nullError)p.t="e",p.v=0;else if(i.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=i.dateNF||ot[14],i.cellDates?(p.t="d",p.w=ki(p.z,ir(p.v))):(p.t="n",p.v=ir(p.v),p.w=ki(p.z,p.v))):p.t="s";if(n)s[x]||(s[x]=[]),s[x][d]&&s[x][d].z&&(p.z=s[x][d].z),s[x][d]=p;else{var g=Ye({c:d,r:x});s[g]&&s[g].z&&(p.z=s[g].z),s[g]=p}}}return l.s.c<1e7&&(s["!ref"]=ut(l)),s}function An(r,t){return dh(null,r,t)}function fm(r){return r.read_shift(4,"i")}function Hr(r,t){return t||(t=H(4)),t.write_shift(4,r),t}function Wt(r){var t=r.read_shift(4);return t===0?"":r.read_shift(t,"dbcs")}function Ct(r,t){var e=!1;return t==null&&(e=!0,t=H(4+2*r.length)),t.write_shift(4,r.length),r.length>0&&t.write_shift(0,r,"dbcs"),e?t.slice(0,t.l):t}function dm(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function pm(r,t){return t||(t=H(4)),t.write_shift(2,r.ich||0),t.write_shift(2,r.ifnt||0),t}function Jo(r,t){var e=r.l,i=r.read_shift(1),n=Wt(r),s=[],a={t:n,h:n};if((i&1)!==0){for(var o=r.read_shift(4),c=0;c!=o;++c)s.push(dm(r));a.r=s}else a.r=[{ich:0,ifnt:0}];return r.l=e+t,a}function mm(r,t){var e=!1;return t==null&&(e=!0,t=H(15+4*r.t.length)),t.write_shift(1,0),Ct(r.t,t),e?t.slice(0,t.l):t}var gm=Jo;function xm(r,t){var e=!1;return t==null&&(e=!0,t=H(23+4*r.t.length)),t.write_shift(1,1),Ct(r.t,t),t.write_shift(4,1),pm({ich:0,ifnt:0},t),e?t.slice(0,t.l):t}function kr(r){var t=r.read_shift(4),e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:t,iStyleRef:e}}function qi(r,t){return t==null&&(t=H(8)),t.write_shift(-4,r.c),t.write_shift(3,r.iStyleRef||r.s),t.write_shift(1,0),t}function Zi(r){var t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:t}}function Qi(r,t){return t==null&&(t=H(4)),t.write_shift(3,r.iStyleRef||r.s),t.write_shift(1,0),t}var vm=Wt,ph=Ct;function el(r){var t=r.read_shift(4);return t===0||t===4294967295?"":r.read_shift(t,"dbcs")}function va(r,t){var e=!1;return t==null&&(e=!0,t=H(127)),t.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&t.write_shift(0,r,"dbcs"),e?t.slice(0,t.l):t}var _m=Wt,No=el,tl=va;function mh(r){var t=r.slice(r.l,r.l+4),e=t[0]&1,i=t[0]&2;r.l+=4;var n=i===0?xa([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):zi(t,0)>>2;return e?n/100:n}function gh(r,t){t==null&&(t=H(4));var e=0,i=0,n=r*100;if(r==(r|0)&&r>=-(1<<29)&&r<1<<29?i=1:n==(n|0)&&n>=-(1<<29)&&n<1<<29&&(i=1,e=1),i)t.write_shift(-4,((e?n:r)<<2)+(e+2));else throw new Error("unsupported RkNumber "+r)}function xh(r){var t={s:{},e:{}};return t.s.r=r.read_shift(4),t.e.r=r.read_shift(4),t.s.c=r.read_shift(4),t.e.c=r.read_shift(4),t}function ym(r,t){return t||(t=H(16)),t.write_shift(4,r.s.r),t.write_shift(4,r.e.r),t.write_shift(4,r.s.c),t.write_shift(4,r.e.c),t}var Ji=xh,Dn=ym;function Mn(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function ji(r,t){return(t||H(8)).write_shift(8,r,"f")}function wm(r){var t={},e=r.read_shift(1),i=e>>>1,n=r.read_shift(1),s=r.read_shift(2,"i"),a=r.read_shift(1),o=r.read_shift(1),c=r.read_shift(1);switch(r.l++,i){case 0:t.auto=1;break;case 1:t.index=n;var l=Om[n];l&&(t.rgb=D0(l));break;case 2:t.rgb=D0([a,o,c]);break;case 3:t.theme=n;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function _a(r,t){if(t||(t=H(8)),!r||r.auto)return t.write_shift(4,0),t.write_shift(4,0),t;r.index!=null?(t.write_shift(1,2),t.write_shift(1,r.index)):r.theme!=null?(t.write_shift(1,6),t.write_shift(1,r.theme)):(t.write_shift(1,5),t.write_shift(1,0));var e=r.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),t.write_shift(2,e),!r.rgb||r.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var i=r.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),t.write_shift(1,parseInt(i.slice(0,2),16)),t.write_shift(1,parseInt(i.slice(2,4),16)),t.write_shift(1,parseInt(i.slice(4,6),16)),t.write_shift(1,255)}return t}function Cm(r){var t=r.read_shift(1);r.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function bm(r,t){t||(t=H(2));var e=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return t.write_shift(1,e),t.write_shift(1,0),t}var vh=2,dr=3,ca=11;var ya=19;var ha=64,Sm=65,Tm=71;var Em=4108,km=4126,At=80;var C0={1:{n:"CodePage",t:vh},2:{n:"Category",t:At},3:{n:"PresentationFormat",t:At},4:{n:"ByteCount",t:dr},5:{n:"LineCount",t:dr},6:{n:"ParagraphCount",t:dr},7:{n:"SlideCount",t:dr},8:{n:"NoteCount",t:dr},9:{n:"HiddenCount",t:dr},10:{n:"MultimediaClipCount",t:dr},11:{n:"ScaleCrop",t:ca},12:{n:"HeadingPairs",t:Em},13:{n:"TitlesOfParts",t:km},14:{n:"Manager",t:At},15:{n:"Company",t:At},16:{n:"LinksUpToDate",t:ca},17:{n:"CharacterCount",t:dr},19:{n:"SharedDoc",t:ca},22:{n:"HyperlinksChanged",t:ca},23:{n:"AppVersion",t:dr,p:"version"},24:{n:"DigSig",t:Sm},26:{n:"ContentType",t:At},27:{n:"ContentStatus",t:At},28:{n:"Language",t:At},29:{n:"Version",t:At},255:{},2147483648:{n:"Locale",t:ya},2147483651:{n:"Behavior",t:ya},1919054434:{}},b0={1:{n:"CodePage",t:vh},2:{n:"Title",t:At},3:{n:"Subject",t:At},4:{n:"Author",t:At},5:{n:"Keywords",t:At},6:{n:"Comments",t:At},7:{n:"Template",t:At},8:{n:"LastAuthor",t:At},9:{n:"RevNumber",t:At},10:{n:"EditTime",t:ha},11:{n:"LastPrinted",t:ha},12:{n:"CreatedDate",t:ha},13:{n:"ModifiedDate",t:ha},14:{n:"PageCount",t:dr},15:{n:"WordCount",t:dr},16:{n:"CharCount",t:dr},17:{n:"Thumbnail",t:Tm},18:{n:"Application",t:At},19:{n:"DocSecurity",t:dr},255:{},2147483648:{n:"Locale",t:ya},2147483651:{n:"Behavior",t:ya},1919054434:{}};function Im(r){return r.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Fm=Im([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Om=nr(Fm),ws={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var Am={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ua={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function _h(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function yh(r,t){var e=Vp(Am),i=[],n;i[i.length]=ft,i[i.length]=ne("Types",null,{xmlns:yt.CT,"xmlns:xsd":yt.xsd,"xmlns:xsi":yt.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ne("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){r[c]&&r[c].length>0&&(n=r[c][0],i[i.length]=ne("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:ua[c][t.bookType]||ua[c].xlsx}))},a=function(c){(r[c]||[]).forEach(function(l){i[i.length]=ne("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:ua[c][t.bookType]||ua[c].xlsx})})},o=function(c){(r[c]||[]).forEach(function(l){i[i.length]=ne("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:e[c][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var Ve={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function wh(r){var t=r.lastIndexOf("/");return r.slice(0,t+1)+"_rels/"+r.slice(t+1)+".rels"}function Sn(r){var t=[ft,ne("Relationships",null,{xmlns:yt.RELS})];return Lt(r["!id"]).forEach(function(e){t[t.length]=ne("Relationship",null,r["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Xe(r,t,e,i,n,s){if(n||(n={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),t<0)for(t=r["!idx"];r["!id"]["rId"+t];++t);if(r["!idx"]=t+1,n.Id="rId"+t,n.Type=i,n.Target=e,s?n.TargetMode=s:[Ve.HLINK,Ve.XPATH,Ve.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),r["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return r["!id"][n.Id]=n,r[("/"+n.Target).replace("//","/")]=n,t}function Dm(r){var t=[ft];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<r.length;++e)t.push('  <manifest:file-entry manifest:full-path="'+r[e][0]+'" manifest:media-type="'+r[e][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function S0(r,t,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Mm(r,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Pm(r){var t=[ft];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=r.length;++e)t.push(S0(r[e][0],r[e][1])),t.push(Mm("",r[e][0]));return t.push(S0("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Ch(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+fs.version+"</meta:generator></office:meta></office:document-meta>"}var Gi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Oo(r,t,e,i,n){n[r]!=null||t==null||t===""||(n[r]=t,t=je(t),i[i.length]=e?ne(r,t,e):Mt(r,t))}function bh(r,t){var e=t||{},i=[ft,ne("cp:coreProperties",null,{"xmlns:cp":yt.CORE_PROPS,"xmlns:dc":yt.dc,"xmlns:dcterms":yt.dcterms,"xmlns:dcmitype":yt.dcmitype,"xmlns:xsi":yt.xsi})],n={};if(!r&&!e.Props)return i.join("");r&&(r.CreatedDate!=null&&Oo("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:Ro(r.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,n),r.ModifiedDate!=null&&Oo("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:Ro(r.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,n));for(var s=0;s!=Gi.length;++s){var a=Gi[s],o=e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:r?r[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Oo(a[0],o,null,i,n)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var Tn=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Sh=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Th(r){var t=[],e=ne;return r||(r={}),r.Application="SheetJS",t[t.length]=ft,t[t.length]=ne("Properties",null,{xmlns:yt.EXT_PROPS,"xmlns:vt":yt.vt}),Tn.forEach(function(i){if(r[i[1]]!==void 0){var n;switch(i[2]){case"string":n=je(String(r[i[1]]));break;case"bool":n=r[i[1]]?"true":"false";break}n!==void 0&&(t[t.length]=e(i[0],n))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",r.SheetNames.map(function(i){return"<vt:lpstr>"+je(i)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Eh(r){var t=[ft,ne("Properties",null,{xmlns:yt.CUST_PROPS,"xmlns:vt":yt.vt})];if(!r)return t.join("");var e=1;return Lt(r).forEach(function(n){++e,t[t.length]=ne("property",Zp(r[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:je(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var T0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Lm(r,t){var e=[];return Lt(T0).map(function(i){for(var n=0;n<Gi.length;++n)if(Gi[n][1]==i)return Gi[n];for(n=0;n<Tn.length;++n)if(Tn[n][1]==i)return Tn[n];throw i}).forEach(function(i){if(r[i[1]]!=null){var n=t&&t.Props&&t.Props[i[1]]!=null?t.Props[i[1]]:r[i[1]];switch(i[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),e.push(Mt(T0[i[1]]||i[1],n))}}),ne("DocumentProperties",e.join(""),{xmlns:mr.o})}function Rm(r,t){var e=["Worksheets","SheetNames"],i="CustomDocumentProperties",n=[];return r&&Lt(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var a=0;a<Gi.length;++a)if(s==Gi[a][1])return;for(a=0;a<Tn.length;++a)if(s==Tn[a][1])return;for(a=0;a<e.length;++a)if(s==e[a])return;var o=r[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),n.push(ne(f0(s),o,{"dt:dt":c}))}}),t&&Lt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),n.push(ne(f0(s),a,{"dt:dt":o}))}}),"<"+i+' xmlns="'+mr.o+'">'+n.join("")+"</"+i+">"}function Nm(r){var t=typeof r=="string"?new Date(Date.parse(r)):r,e=t.getTime()/1e3+11644473600,i=e%Math.pow(2,32),n=(e-i)/Math.pow(2,32);i*=1e7,n*=1e7;var s=i/Math.pow(2,32)|0;s>0&&(i=i%Math.pow(2,32),n+=s);var a=H(8);return a.write_shift(4,i),a.write_shift(4,n),a}function E0(r,t){var e=H(4),i=H(4);switch(e.write_shift(4,r==80?31:r),r){case 3:i.write_shift(-4,t);break;case 5:i=H(8),i.write_shift(8,t,"f");break;case 11:i.write_shift(4,t?1:0);break;case 64:i=Nm(t);break;case 31:case 80:for(i=H(4+2*(t.length+1)+(t.length%2?0:2)),i.write_shift(4,t.length+1),i.write_shift(0,t,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+t)}return Dt([e,i])}var kh=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Bm(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function k0(r,t,e){var i=H(8),n=[],s=[],a=8,o=0,c=H(8),l=H(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),s.push(c),n.push(l),a+=8+c.length,!t){l=H(8),l.write_shift(4,0),n.unshift(l);var h=[H(4)];for(h[0].write_shift(4,r.length),o=0;o<r.length;++o){var u=r[o][0];for(c=H(8+2*(u.length+1)+(u.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,u.length+1),c.write_shift(0,u,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=Dt(h),s.unshift(c),a+=8+c.length}for(o=0;o<r.length;++o)if(!(t&&!t[r[o][0]])&&!(kh.indexOf(r[o][0])>-1||Sh.indexOf(r[o][0])>-1)&&r[o][1]!=null){var f=r[o][1],p=0;if(t){p=+t[r[o][0]];var x=e[p];if(x.p=="version"&&typeof f=="string"){var d=f.split(".");f=(+d[0]<<16)+(+d[1]||0)}c=E0(x.t,f)}else{var g=Bm(f);g==-1&&(g=31,f=String(f)),c=E0(g,f)}s.push(c),l=H(8),l.write_shift(4,t?p:2+o),n.push(l),a+=8+c.length}var I=8*(s.length+1);for(o=0;o<s.length;++o)n[o].write_shift(4,I),I+=s[o].length;return i.write_shift(4,a),i.write_shift(4,s.length),Dt([i].concat(n).concat(s))}function I0(r,t,e,i,n,s){var a=H(n?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,qe.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,n?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,n?68:48);var c=k0(r,e,i);if(o.push(c),n){var l=k0(n,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+c.length),o.push(l)}return Dt(o)}function Hm(r,t){t||(t=H(r));for(var e=0;e<r;++e)t.write_shift(1,0);return t}function Vm(r,t){return r.read_shift(t)===1}function Gt(r,t){return t||(t=H(2)),t.write_shift(2,+!!r),t}function Ih(r){return r.read_shift(2,"u")}function Er(r,t){return t||(t=H(2)),t.write_shift(2,r),t}function Fh(r,t,e){return e||(e=H(2)),e.write_shift(1,t=="e"?+r:+!!r),e.write_shift(1,t=="e"?1:0),e}function Oh(r,t,e){var i=r.read_shift(e&&e.biff>=12?2:1),n="sbcs-cont",s=Ui;if(e&&e.biff>=8&&(Ui=1200),!e||e.biff==8){var a=r.read_shift(1);a&&(n="dbcs-cont")}else e.biff==12&&(n="wstr");e.biff>=2&&e.biff<=5&&(n="cpstr");var o=i?r.read_shift(i,n):"";return Ui=s,o}function Wm(r){var t=r.t||"",e=1,i=H(3+(e>1?2:0));i.write_shift(2,t.length),i.write_shift(1,(e>1?8:0)|1),e>1&&i.write_shift(2,e);var n=H(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[i,n];return Dt(s)}function $m(r,t,e){var i;if(e){if(e.biff>=2&&e.biff<=5)return r.read_shift(t,"cpstr");if(e.biff>=12)return r.read_shift(t,"dbcs-cont")}var n=r.read_shift(1);return n===0?i=r.read_shift(t,"sbcs-cont"):i=r.read_shift(t,"dbcs-cont"),i}function zm(r,t,e){var i=r.read_shift(e&&e.biff==2?1:2);return i===0?(r.l++,""):$m(r,i,e)}function Um(r,t,e){if(e.biff>5)return zm(r,t,e);var i=r.read_shift(1);return i===0?(r.l++,""):r.read_shift(i,e.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function Ah(r,t,e){return e||(e=H(3+2*r.length)),e.write_shift(2,r.length),e.write_shift(1,1),e.write_shift(31,r,"utf16le"),e}function F0(r,t){t||(t=H(6+r.length*2)),t.write_shift(4,1+r.length);for(var e=0;e<r.length;++e)t.write_shift(2,r.charCodeAt(e));return t.write_shift(2,0),t}function Gm(r){var t=H(512),e=0,i=r.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var n=i.indexOf("#"),s=n>-1?31:23;switch(i.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(e=0;e<a.length;++e)t.write_shift(4,a[e]);if(s==28)i=i.slice(1),F0(i,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<a.length;++e)t.write_shift(1,parseInt(a[e],16));var o=n>-1?i.slice(0,n):i;for(t.write_shift(4,2*(o.length+1)),e=0;e<o.length;++e)t.write_shift(2,o.charCodeAt(e));t.write_shift(2,0),s&8&&F0(n>-1?i.slice(n+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<a.length;++e)t.write_shift(1,parseInt(a[e],16));for(var c=0;i.slice(c*3,c*3+3)=="../"||i.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,i.length-3*c+1),e=0;e<i.length-3*c;++e)t.write_shift(1,i.charCodeAt(e+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),e=0;e<6;++e)t.write_shift(4,0)}return t.slice(0,t.l)}function Yi(r,t,e,i){return i||(i=H(6)),i.write_shift(2,r),i.write_shift(2,t),i.write_shift(2,e||0),i}function Xm(r,t,e){var i=e.biff>8?4:2,n=r.read_shift(i),s=r.read_shift(i,"i"),a=r.read_shift(i,"i");return[n,s,a]}function jm(r){var t=r.read_shift(2),e=r.read_shift(2),i=r.read_shift(2),n=r.read_shift(2);return{s:{c:i,r:t},e:{c:n,r:e}}}function Dh(r,t){return t||(t=H(8)),t.write_shift(2,r.s.r),t.write_shift(2,r.e.r),t.write_shift(2,r.s.c),t.write_shift(2,r.e.c),t}function rl(r,t,e){var i=1536,n=16;switch(e.bookType){case"biff8":break;case"biff5":i=1280,n=8;break;case"biff4":i=4,n=6;break;case"biff3":i=3,n=6;break;case"biff2":i=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=H(n);return s.write_shift(2,i),s.write_shift(2,t),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Ym(r,t){var e=!t||t.biff==8,i=H(e?112:54);for(i.write_shift(t.biff==8?2:1,7),e&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(e?0:536870912));i.l<i.length;)i.write_shift(1,e?0:32);return i}function Km(r,t){var e=!t||t.biff>=8?2:1,i=H(8+e*r.name.length);i.write_shift(4,r.pos),i.write_shift(1,r.hs||0),i.write_shift(1,r.dt),i.write_shift(1,r.name.length),t.biff>=8&&i.write_shift(1,1),i.write_shift(e*r.name.length,r.name,t.biff<8?"sbcs":"utf16le");var n=i.slice(0,i.l);return n.l=i.l,n}function qm(r,t){var e=H(8);e.write_shift(4,r.Count),e.write_shift(4,r.Unique);for(var i=[],n=0;n<r.length;++n)i[n]=Wm(r[n],t);var s=Dt([e].concat(i));return s.parts=[e.length].concat(i.map(function(a){return a.length})),s}function Zm(){var r=H(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function Qm(r){var t=H(18),e=1718;return r&&r.RTL&&(e|=64),t.write_shift(2,e),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Jm(r,t){var e=r.name||"Arial",i=t&&t.biff==5,n=i?15+e.length:16+2*e.length,s=H(n);return s.write_shift(2,(r.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,e.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le"),s}function eg(r,t,e,i){var n=H(10);return Yi(r,t,i,n),n.write_shift(4,e),n}function tg(r,t,e,i,n){var s=!n||n.biff==8,a=H(8+ +s+(1+s)*e.length);return Yi(r,t,i,a),a.write_shift(2,e.length),s&&a.write_shift(1,1),a.write_shift((1+s)*e.length,e,s?"utf16le":"sbcs"),a}function rg(r,t,e,i){var n=e&&e.biff==5;i||(i=H(n?3+t.length:5+2*t.length)),i.write_shift(2,r),i.write_shift(n?1:2,t.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var s=i.length>i.l?i.slice(0,i.l):i;return s.l==null&&(s.l=s.length),s}function ig(r,t){var e=t.biff==8||!t.biff?4:2,i=H(2*e+6);return i.write_shift(e,r.s.r),i.write_shift(e,r.e.r+1),i.write_shift(2,r.s.c),i.write_shift(2,r.e.c+1),i.write_shift(2,0),i}function O0(r,t,e,i){var n=e&&e.biff==5;i||(i=H(n?16:20)),i.write_shift(2,0),r.style?(i.write_shift(2,r.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,r.numFmtId||0),i.write_shift(2,t<<4));var s=0;return r.numFmtId>0&&n&&(s|=1024),i.write_shift(4,s),i.write_shift(4,0),n||i.write_shift(4,0),i.write_shift(2,0),i}function ng(r){var t=H(8);return t.write_shift(4,0),t.write_shift(2,r[0]?r[0]+1:0),t.write_shift(2,r[1]?r[1]+1:0),t}function sg(r,t,e,i,n,s){var a=H(8);return Yi(r,t,i,a),Fh(e,s,a),a}function ag(r,t,e,i){var n=H(14);return Yi(r,t,i,n),ji(e,n),n}function og(r,t,e){if(e.biff<8)return lg(r,t,e);for(var i=[],n=r.l+t,s=r.read_shift(e.biff>8?4:2);s--!==0;)i.push(Xm(r,e.biff>8?12:6,e));if(r.l!=n)throw new Error("Bad ExternSheet: "+r.l+" != "+n);return i}function lg(r,t,e){r[r.l+1]==3&&r[r.l]++;var i=Oh(r,t,e);return i.charCodeAt(0)==3?i.slice(1):i}function cg(r){var t=H(2+r.length*8);t.write_shift(2,r.length);for(var e=0;e<r.length;++e)Dh(r[e],t);return t}function hg(r){var t=H(24),e=wt(r[0]);t.write_shift(2,e.r),t.write_shift(2,e.r),t.write_shift(2,e.c),t.write_shift(2,e.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(i[n],16));return Dt([t,Gm(r[1])])}function ug(r){var t=r[1].Tooltip,e=H(10+2*(t.length+1));e.write_shift(2,2048);var i=wt(r[0]);e.write_shift(2,i.r),e.write_shift(2,i.r),e.write_shift(2,i.c),e.write_shift(2,i.c);for(var n=0;n<t.length;++n)e.write_shift(2,t.charCodeAt(n));return e.write_shift(2,0),e}function fg(r){return r||(r=H(4)),r.write_shift(2,1),r.write_shift(2,1),r}function dg(r,t,e){if(!e.cellStyles)return Yr(r,t);var i=e&&e.biff>=12?4:2,n=r.read_shift(i),s=r.read_shift(i),a=r.read_shift(i),o=r.read_shift(i),c=r.read_shift(2);i==2&&(r.l+=2);var l={s:n,e:s,w:a,ixfe:o,flags:c};return(e.biff>=5||!e.biff)&&(l.level=c>>8&7),l}function pg(r,t){var e=H(12);e.write_shift(2,t),e.write_shift(2,t),e.write_shift(2,r.width*256),e.write_shift(2,0);var i=0;return r.hidden&&(i|=1),e.write_shift(1,i),i=r.level||0,e.write_shift(1,i),e.write_shift(2,0),e}function mg(r){for(var t=H(2*r),e=0;e<r;++e)t.write_shift(2,e+1);return t}function gg(r,t,e){var i=H(15);return bs(i,r,t),i.write_shift(8,e,"f"),i}function xg(r,t,e){var i=H(9);return bs(i,r,t),i.write_shift(2,e),i}var vg=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Wo({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(o,c){var l=[],h=Xi(1);switch(c.type){case"base64":h=Nr(ci(o));break;case"binary":h=Nr(o);break;case"buffer":case"array":h=o;break}pr(h,0);var u=h.read_shift(1),f=!!(u&136),p=!1,x=!1;switch(u){case 2:break;case 3:break;case 48:p=!0,f=!0;break;case 49:p=!0,f=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var d=0,g=521;u==2&&(d=h.read_shift(2)),h.l+=3,u!=2&&(d=h.read_shift(4)),d>1048576&&(d=1e6),u!=2&&(g=h.read_shift(2));var I=h.read_shift(2),O=c.codepage||1252;u!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(O=r[h[h.l]]),h.l+=1,h.l+=2),x&&(h.l+=36);for(var A=[],V={},q=Math.min(h.length,u==2?521:g-10-(p?264:0)),ie=x?32:11;h.l<q&&h[h.l]!=13;)switch(V={},V.name=Ze.utils.decode(O,h.slice(h.l,h.l+ie)).replace(/[\u0000\r\n].*$/g,""),h.l+=ie,V.type=String.fromCharCode(h.read_shift(1)),u!=2&&!x&&(V.offset=h.read_shift(4)),V.len=h.read_shift(1),u==2&&(V.offset=h.read_shift(2)),V.dec=h.read_shift(1),V.name.length&&A.push(V),u!=2&&(h.l+=x?13:14),V.type){case"B":(!p||V.len!=8)&&c.WTF&&console.log("Skipping "+V.name+":"+V.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+V.name+":"+V.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+V.type)}if(h[h.l]!==13&&(h.l=g-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=g;var D=0,Y=0;for(l[0]=[],Y=0;Y!=A.length;++Y)l[0][Y]=A[Y].name;for(;d-- >0;){if(h[h.l]===42){h.l+=I;continue}for(++h.l,l[++D]=[],Y=0,Y=0;Y!=A.length;++Y){var z=h.slice(h.l,h.l+A[Y].len);h.l+=A[Y].len,pr(z,0);var j=Ze.utils.decode(O,z);switch(A[Y].type){case"C":j.trim().length&&(l[D][Y]=j.replace(/\s+$/,""));break;case"D":j.length===8?l[D][Y]=new Date(+j.slice(0,4),+j.slice(4,6)-1,+j.slice(6,8)):l[D][Y]=j;break;case"F":l[D][Y]=parseFloat(j.trim());break;case"+":case"I":l[D][Y]=x?z.read_shift(-4,"i")^2147483648:z.read_shift(4,"i");break;case"L":switch(j.trim().toUpperCase()){case"Y":case"T":l[D][Y]=!0;break;case"N":case"F":l[D][Y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+j+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));l[D][Y]="##MEMO##"+(x?parseInt(j.trim(),10):z.read_shift(4));break;case"N":j=j.replace(/\u0000/g,"").trim(),j&&j!="."&&(l[D][Y]=+j||0);break;case"@":l[D][Y]=new Date(z.read_shift(-8,"f")-621356832e5);break;case"T":l[D][Y]=new Date((z.read_shift(4)-2440588)*864e5+z.read_shift(4));break;case"Y":l[D][Y]=z.read_shift(4,"i")/1e4+z.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[D][Y]=-z.read_shift(-8,"f");break;case"B":if(p&&A[Y].len==8){l[D][Y]=z.read_shift(8,"f");break}case"G":case"P":z.l+=A[Y].len;break;case"0":if(A[Y].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[Y].type)}}}if(u!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=A,l}function i(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var h=An(e(o,l),l);return h["!cols"]=l.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete l.DBF,h}function n(o,c){try{return Ki(i(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var l=c||{};if(+l.codepage>=0&&ds(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var h=rr(),u=Ta(o,{header:1,raw:!0,cellDates:!0}),f=u[0],p=u.slice(1),x=o["!cols"]||[],d=0,g=0,I=0,O=1;for(d=0;d<f.length;++d){if(((x[d]||{}).DBF||{}).name){f[d]=x[d].DBF.name,++I;continue}if(f[d]!=null){if(++I,typeof f[d]=="number"&&(f[d]=f[d].toString(10)),typeof f[d]!="string")throw new Error("DBF Invalid column name "+f[d]+" |"+typeof f[d]+"|");if(f.indexOf(f[d])!==d){for(g=0;g<1024;++g)if(f.indexOf(f[d]+"_"+g)==-1){f[d]+="_"+g;break}}}}var A=et(o["!ref"]),V=[],q=[],ie=[];for(d=0;d<=A.e.c-A.s.c;++d){var D="",Y="",z=0,j=[];for(g=0;g<p.length;++g)p[g][d]!=null&&j.push(p[g][d]);if(j.length==0||f[d]==null){V[d]="?";continue}for(g=0;g<j.length;++g){switch(typeof j[g]){case"number":Y="B";break;case"string":Y="C";break;case"boolean":Y="L";break;case"object":Y=j[g]instanceof Date?"D":"C";break;default:Y="C"}z=Math.max(z,String(j[g]).length),D=D&&D!=Y?"C":Y}z>250&&(z=250),Y=((x[d]||{}).DBF||{}).type,Y=="C"&&x[d].DBF.len>z&&(z=x[d].DBF.len),D=="B"&&Y=="N"&&(D="N",ie[d]=x[d].DBF.dec,z=x[d].DBF.len),q[d]=D=="C"||Y=="N"?z:s[D]||0,O+=q[d],V[d]=D}var Q=h.next(32);for(Q.write_shift(4,318902576),Q.write_shift(4,p.length),Q.write_shift(2,296+32*I),Q.write_shift(2,O),d=0;d<4;++d)Q.write_shift(4,0);for(Q.write_shift(4,0|(+t[kn]||3)<<8),d=0,g=0;d<f.length;++d)if(f[d]!=null){var te=h.next(32),ge=(f[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);te.write_shift(1,ge,"sbcs"),te.write_shift(1,V[d]=="?"?"C":V[d],"sbcs"),te.write_shift(4,g),te.write_shift(1,q[d]||s[V[d]]||0),te.write_shift(1,ie[d]||0),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(1,0),te.write_shift(4,0),te.write_shift(4,0),g+=q[d]||s[V[d]]||0}var ze=h.next(264);for(ze.write_shift(4,13),d=0;d<65;++d)ze.write_shift(4,0);for(d=0;d<p.length;++d){var _e=h.next(O);for(_e.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(V[g]){case"L":_e.write_shift(1,p[d][g]==null?63:p[d][g]?84:70);break;case"B":_e.write_shift(8,p[d][g]||0,"f");break;case"N":var pt="0";for(typeof p[d][g]=="number"&&(pt=p[d][g].toFixed(ie[g]||0)),I=0;I<q[g]-pt.length;++I)_e.write_shift(1,32);_e.write_shift(1,pt,"sbcs");break;case"D":p[d][g]?(_e.write_shift(4,("0000"+p[d][g].getFullYear()).slice(-4),"sbcs"),_e.write_shift(2,("00"+(p[d][g].getMonth()+1)).slice(-2),"sbcs"),_e.write_shift(2,("00"+p[d][g].getDate()).slice(-2),"sbcs")):_e.write_shift(8,"00000000","sbcs");break;case"C":var mt=String(p[d][g]!=null?p[d][g]:"").slice(0,q[g]);for(_e.write_shift(1,mt,"sbcs"),I=0;I<q[g]-mt.length;++I)_e.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:n,to_sheet:i,from_sheet:a}}(),_g=function(){var r={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Lt(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(f,p){var x=r[p];return typeof x=="number"?e0(x):x},i=function(f,p,x){var d=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return d==59?f:e0(d)};r["|"]=254;function n(f,p){switch(p.type){case"base64":return s(ci(f),p);case"binary":return s(f,p);case"buffer":return s($e&&Buffer.isBuffer(f)?f.toString("binary"):_s(f),p);case"array":return s(Oa(f),p)}throw new Error("Unrecognized type "+p.type)}function s(f,p){var x=f.split(/[\n\r]+/),d=-1,g=-1,I=0,O=0,A=[],V=[],q=null,ie={},D=[],Y=[],z=[],j=0,Q;for(+p.codepage>=0&&ds(+p.codepage);I!==x.length;++I){j=0;var te=x[I].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(t,e),ge=te.replace(/;;/g,"\0").split(";").map(function(k){return k.replace(/\u0000/g,";")}),ze=ge[0],_e;if(te.length>0)switch(ze){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ge[1].charAt(0)=="P"&&V.push(te.slice(3).replace(/;;/g,";"));break;case"C":var pt=!1,mt=!1,jt=!1,$t=!1,bt=-1,Yt=-1;for(O=1;O<ge.length;++O)switch(ge[O].charAt(0)){case"A":break;case"X":g=parseInt(ge[O].slice(1))-1,mt=!0;break;case"Y":for(d=parseInt(ge[O].slice(1))-1,mt||(g=0),Q=A.length;Q<=d;++Q)A[Q]=[];break;case"K":_e=ge[O].slice(1),_e.charAt(0)==='"'?_e=_e.slice(1,_e.length-1):_e==="TRUE"?_e=!0:_e==="FALSE"?_e=!1:isNaN(oi(_e))?isNaN(ms(_e).getDate())||(_e=Xt(_e)):(_e=oi(_e),q!==null&&Z0(q)&&(_e=th(_e))),typeof Ze<"u"&&typeof _e=="string"&&(p||{}).type!="string"&&(p||{}).codepage&&(_e=Ze.utils.decode(p.codepage,_e)),pt=!0;break;case"E":$t=!0;var b=x1(ge[O].slice(1),{r:d,c:g});A[d][g]=[A[d][g],b];break;case"S":jt=!0,A[d][g]=[A[d][g],"S5S"];break;case"G":break;case"R":bt=parseInt(ge[O].slice(1))-1;break;case"C":Yt=parseInt(ge[O].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+te)}if(pt&&(A[d][g]&&A[d][g].length==2?A[d][g][0]=_e:A[d][g]=_e,q=null),jt){if($t)throw new Error("SYLK shared formula cannot have own formula");var G=bt>-1&&A[bt][Yt];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");A[d][g][1]=v1(G[1],{r:d-bt,c:g-Yt})}break;case"F":var F=0;for(O=1;O<ge.length;++O)switch(ge[O].charAt(0)){case"X":g=parseInt(ge[O].slice(1))-1,++F;break;case"Y":for(d=parseInt(ge[O].slice(1))-1,Q=A.length;Q<=d;++Q)A[Q]=[];break;case"M":j=parseInt(ge[O].slice(1))/20;break;case"F":break;case"G":break;case"P":q=V[parseInt(ge[O].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(z=ge[O].slice(1).split(" "),Q=parseInt(z[0],10);Q<=parseInt(z[1],10);++Q)j=parseInt(z[2],10),Y[Q-1]=j===0?{hidden:!0}:{wch:j},il(Y[Q-1]);break;case"C":g=parseInt(ge[O].slice(1))-1,Y[g]||(Y[g]={});break;case"R":d=parseInt(ge[O].slice(1))-1,D[d]||(D[d]={}),j>0?(D[d].hpt=j,D[d].hpx=Nh(j)):j===0&&(D[d].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+te)}F<1&&(q=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+te)}}return D.length>0&&(ie["!rows"]=D),Y.length>0&&(ie["!cols"]=Y),p&&p.sheetRows&&(A=A.slice(0,p.sheetRows)),[A,ie]}function a(f,p){var x=n(f,p),d=x[0],g=x[1],I=An(d,p);return Lt(g).forEach(function(O){I[O]=g[O]}),I}function o(f,p){return Ki(a(f,p),p)}function c(f,p,x,d){var g="C;Y"+(x+1)+";X"+(d+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+sl(f.f,{r:x,c:d}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function l(f,p){p.forEach(function(x,d){var g="F;W"+(d+1)+" "+(d+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=wa(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Ca(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function h(f,p){p.forEach(function(x,d){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*ba(x.hpx)+";"),g.length>2&&f.push(g+"R"+(d+1))})}function u(f,p){var x=["ID;PWXL;N;E"],d=[],g=et(f["!ref"]),I,O=Array.isArray(f),A=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),f["!cols"]&&l(x,f["!cols"]),f["!rows"]&&h(x,f["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var V=g.s.r;V<=g.e.r;++V)for(var q=g.s.c;q<=g.e.c;++q){var ie=Ye({r:V,c:q});I=O?(f[V]||[])[q]:f[ie],!(!I||I.v==null&&(!I.f||I.F))&&d.push(c(I,f,V,q,p))}return x.join(A)+A+d.join(A)+A+"E"+A}return{to_workbook:o,to_sheet:a,from_sheet:u}}(),yg=function(){function r(s,a){switch(a.type){case"base64":return t(ci(s),a);case"binary":return t(s,a);case"buffer":return t($e&&Buffer.isBuffer(s)?s.toString("binary"):_s(s),a);case"array":return t(Oa(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),c=-1,l=-1,h=0,u=[];h!==o.length;++h){if(o[h].trim()==="BOT"){u[++c]=[],l=0;continue}if(!(c<0)){var f=o[h].trim().split(","),p=f[0],x=f[1];++h;for(var d=o[h]||"";(d.match(/["]/g)||[]).length&1&&h<o.length-1;)d+=`
`+o[++h];switch(d=d.trim(),+p){case-1:if(d==="BOT"){u[++c]=[],l=0;continue}else if(d!=="EOD")throw new Error("Unrecognized DIF special command "+d);break;case 0:d==="TRUE"?u[c][l]=!0:d==="FALSE"?u[c][l]=!1:isNaN(oi(x))?isNaN(ms(x).getDate())?u[c][l]=x:u[c][l]=Xt(x):u[c][l]=oi(x),++l;break;case 1:d=d.slice(1,d.length-1),d=d.replace(/""/g,'"'),ns&&d&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),u[c][l++]=d!==""?d:null;break}if(d==="EOD")break}}return a&&a.sheetRows&&(u=u.slice(0,a.sheetRows)),u}function e(s,a){return An(r(s,a),a)}function i(s,a){return Ki(e(s,a),a)}var n=function(){var s=function(c,l,h,u,f){c.push(l),c.push(h+","+u),c.push('"'+f.replace(/"/g,'""')+'"')},a=function(c,l,h,u){c.push(l+","+h),c.push(l==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(c){var l=[],h=et(c["!ref"]),u,f=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,h.e.r-h.s.r+1,""),s(l,"TUPLES",0,h.e.c-h.s.c+1,""),s(l,"DATA",0,0,"");for(var p=h.s.r;p<=h.e.r;++p){a(l,-1,0,"BOT");for(var x=h.s.c;x<=h.e.c;++x){var d=Ye({r:p,c:x});if(u=f?(c[p]||[])[x]:c[d],!u){a(l,1,0,"");continue}switch(u.t){case"n":var g=ns?u.w:u.v;!g&&u.v!=null&&(g=u.v),g==null?ns&&u.f&&!u.F?a(l,1,0,"="+u.f):a(l,1,0,""):a(l,0,g,"V");break;case"b":a(l,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":a(l,1,0,!ns||isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=ki(u.z||ot[14],ir(Xt(u.v)))),ns?a(l,0,u.w,"V"):a(l,1,0,u.w);break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var I=`\r
`,O=l.join(I);return O}}();return{to_workbook:i,to_sheet:e,from_sheet:n}}(),Mh=function(){function r(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(u,f){for(var p=u.split(`
`),x=-1,d=-1,g=0,I=[];g!==p.length;++g){var O=p[g].trim().split(":");if(O[0]==="cell"){var A=wt(O[1]);if(I.length<=A.r)for(x=I.length;x<=A.r;++x)I[x]||(I[x]=[]);switch(x=A.r,d=A.c,O[2]){case"t":I[x][d]=r(O[3]);break;case"v":I[x][d]=+O[3];break;case"vtf":var V=O[O.length-1];case"vtc":switch(O[3]){case"nl":I[x][d]=!!+O[4];break;default:I[x][d]=+O[4];break}O[2]=="vtf"&&(I[x][d]=[I[x][d],V])}}}return f&&f.sheetRows&&(I=I.slice(0,f.sheetRows)),I}function i(u,f){return An(e(u,f),f)}function n(u,f){return Ki(i(u,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(u){if(!u||!u["!ref"])return"";for(var f=[],p=[],x,d="",g=gr(u["!ref"]),I=Array.isArray(u),O=g.s.r;O<=g.e.r;++O)for(var A=g.s.c;A<=g.e.c;++A)if(d=Ye({r:O,c:A}),x=I?(u[O]||[])[A]:u[d],!(!x||x.v==null||x.t==="z")){switch(p=["cell",d,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var V=ir(Xt(x.v));p[2]="vtc",p[3]="nd",p[4]=""+V,p[5]=x.w||ki(x.z||ot[14],V);break;case"e":continue}f.push(p.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function h(u){return[s,a,o,a,l(u),c].join(`
`)}return{to_workbook:n,to_sheet:i,from_sheet:h}}(),wg=function(){function r(h,u,f,p,x){x.raw?u[f][p]=h:h===""||(h==="TRUE"?u[f][p]=!0:h==="FALSE"?u[f][p]=!1:isNaN(oi(h))?isNaN(ms(h).getDate())?u[f][p]=h:u[f][p]=Xt(h):u[f][p]=oi(h))}function t(h,u){var f=u||{},p=[];if(!h||h.length===0)return p;for(var x=h.split(/[\r\n]/),d=x.length-1;d>=0&&x[d].length===0;)--d;for(var g=10,I=0,O=0;O<=d;++O)I=x[O].indexOf(" "),I==-1?I=x[O].length:I++,g=Math.max(g,I);for(O=0;O<=d;++O){p[O]=[];var A=0;for(r(x[O].slice(0,g).trim(),p,O,A,f),A=1;A<=(x[O].length-g)/10+1;++A)r(x[O].slice(g+(A-1)*10,g+A*10).trim(),p,O,A,f)}return f.sheetRows&&(p=p.slice(0,f.sheetRows)),p}var e={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function n(h){for(var u={},f=!1,p=0,x=0;p<h.length;++p)(x=h.charCodeAt(p))==34?f=!f:!f&&x in e&&(u[x]=(u[x]||0)+1);x=[];for(p in u)Object.prototype.hasOwnProperty.call(u,p)&&x.push([u[p],p]);if(!x.length){u=i;for(p in u)Object.prototype.hasOwnProperty.call(u,p)&&x.push([u[p],p])}return x.sort(function(d,g){return d[0]-g[0]||i[d[1]]-i[g[1]]}),e[x.pop()[1]]||44}function s(h,u){var f=u||{},p="";jr!=null&&f.dense==null&&(f.dense=jr);var x=f.dense?[]:{},d={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(p=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(p=h.charAt(4),h=h.slice(6)):p=n(h.slice(0,1024)):f&&f.FS?p=f.FS:p=n(h.slice(0,1024));var g=0,I=0,O=0,A=0,V=0,q=p.charCodeAt(0),ie=!1,D=0,Y=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var z=f.dateNF!=null?Rp(f.dateNF):null;function j(){var Q=h.slice(A,V),te={};if(Q.charAt(0)=='"'&&Q.charAt(Q.length-1)=='"'&&(Q=Q.slice(1,-1).replace(/""/g,'"')),Q.length===0)te.t="z";else if(f.raw)te.t="s",te.v=Q;else if(Q.trim().length===0)te.t="s",te.v=Q;else if(Q.charCodeAt(0)==61)Q.charCodeAt(1)==34&&Q.charCodeAt(Q.length-1)==34?(te.t="s",te.v=Q.slice(2,-1).replace(/""/g,'"')):_1(Q)?(te.t="n",te.f=Q.slice(1)):(te.t="s",te.v=Q);else if(Q=="TRUE")te.t="b",te.v=!0;else if(Q=="FALSE")te.t="b",te.v=!1;else if(!isNaN(O=oi(Q)))te.t="n",f.cellText!==!1&&(te.w=Q),te.v=O;else if(!isNaN(ms(Q).getDate())||z&&Q.match(z)){te.z=f.dateNF||ot[14];var ge=0;z&&Q.match(z)&&(Q=Np(Q,f.dateNF,Q.match(z)||[]),ge=1),f.cellDates?(te.t="d",te.v=Xt(Q,ge)):(te.t="n",te.v=ir(Xt(Q,ge))),f.cellText!==!1&&(te.w=ki(te.z,te.v instanceof Date?ir(te.v):te.v)),f.cellNF||delete te.z}else te.t="s",te.v=Q;if(te.t=="z"||(f.dense?(x[g]||(x[g]=[]),x[g][I]=te):x[Ye({c:I,r:g})]=te),A=V+1,Y=h.charCodeAt(A),d.e.c<I&&(d.e.c=I),d.e.r<g&&(d.e.r=g),D==q)++I;else if(I=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;V<h.length;++V)switch(D=h.charCodeAt(V)){case 34:Y===34&&(ie=!ie);break;case q:case 10:case 13:if(!ie&&j())break e;break;default:break}return V-A>0&&j(),x["!ref"]=ut(d),x}function a(h,u){return!(u&&u.PRN)||u.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,u):An(t(h,u),u)}function o(h,u){var f="",p=u.type=="string"?[0,0,0,0]:My(h,u);switch(u.type){case"base64":f=ci(h);break;case"binary":f=h;break;case"buffer":u.codepage==65001?f=h.toString("utf8"):u.codepage&&typeof Ze<"u"?f=Ze.utils.decode(u.codepage,h):f=$e&&Buffer.isBuffer(h)?h.toString("binary"):_s(h);break;case"array":f=Oa(h);break;case"string":f=h;break;default:throw new Error("Unrecognized type "+u.type)}return p[0]==239&&p[1]==187&&p[2]==191?f=os(f.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?f=os(f):u.type=="binary"&&typeof Ze<"u"&&u.codepage&&(f=Ze.utils.decode(u.codepage,Ze.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?Mh.to_sheet(u.type=="string"?f:os(f),u):a(f,u)}function c(h,u){return Ki(o(h,u),u)}function l(h){for(var u=[],f=et(h["!ref"]),p,x=Array.isArray(h),d=f.s.r;d<=f.e.r;++d){for(var g=[],I=f.s.c;I<=f.e.c;++I){var O=Ye({r:d,c:I});if(p=x?(h[d]||[])[I]:h[O],!p||p.v==null){g.push("          ");continue}for(var A=(p.w||(hi(p),p.w)||"").slice(0,10);A.length<10;)A+=" ";g.push(A+(I===0?" ":""))}u.push(g.join(""))}return u.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();var A0=function(){function r(b,G,F){if(b){pr(b,b.l||0);for(var k=F.Enum||bt;b.l<b.length;){var Z=b.read_shift(2),me=k[Z]||k[65535],be=b.read_shift(2),fe=b.l+be,le=me.f&&me.f(b,be,F);if(b.l=fe,G(le,me,Z))return}}}function t(b,G){switch(G.type){case"base64":return e(Nr(ci(b)),G);case"binary":return e(Nr(b),G);case"buffer":case"array":return e(b,G)}throw"Unsupported type "+G.type}function e(b,G){if(!b)return b;var F=G||{};jr!=null&&F.dense==null&&(F.dense=jr);var k=F.dense?[]:{},Z="Sheet1",me="",be=0,fe={},le=[],Ke=[],Re={s:{r:0,c:0},e:{r:0,c:0}},St=F.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)F.Enum=bt,r(b,function(pe,xr,Kr){switch(Kr){case 0:F.vers=pe,pe>=4096&&(F.qpro=!0);break;case 6:Re=pe;break;case 204:pe&&(me=pe);break;case 222:me=pe;break;case 15:case 51:F.qpro||(pe[1].v=pe[1].v.slice(1));case 13:case 14:case 16:Kr==14&&(pe[2]&112)==112&&(pe[2]&15)>1&&(pe[2]&15)<15&&(pe[1].z=F.dateNF||ot[14],F.cellDates&&(pe[1].t="d",pe[1].v=th(pe[1].v))),F.qpro&&pe[3]>be&&(k["!ref"]=ut(Re),fe[Z]=k,le.push(Z),k=F.dense?[]:{},Re={s:{r:0,c:0},e:{r:0,c:0}},be=pe[3],Z=me||"Sheet"+(be+1),me="");var Ai=F.dense?(k[pe[0].r]||[])[pe[0].c]:k[Ye(pe[0])];if(Ai){Ai.t=pe[1].t,Ai.v=pe[1].v,pe[1].z!=null&&(Ai.z=pe[1].z),pe[1].f!=null&&(Ai.f=pe[1].f);break}F.dense?(k[pe[0].r]||(k[pe[0].r]=[]),k[pe[0].r][pe[0].c]=pe[1]):k[Ye(pe[0])]=pe[1];break;default:}},F);else if(b[2]==26||b[2]==14)F.Enum=Yt,b[2]==14&&(F.qpro=!0,b.l=0),r(b,function(pe,xr,Kr){switch(Kr){case 204:Z=pe;break;case 22:pe[1].v=pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(pe[3]>be&&(k["!ref"]=ut(Re),fe[Z]=k,le.push(Z),k=F.dense?[]:{},Re={s:{r:0,c:0},e:{r:0,c:0}},be=pe[3],Z="Sheet"+(be+1)),St>0&&pe[0].r>=St)break;F.dense?(k[pe[0].r]||(k[pe[0].r]=[]),k[pe[0].r][pe[0].c]=pe[1]):k[Ye(pe[0])]=pe[1],Re.e.c<pe[0].c&&(Re.e.c=pe[0].c),Re.e.r<pe[0].r&&(Re.e.r=pe[0].r);break;case 27:pe[14e3]&&(Ke[pe[14e3][0]]=pe[14e3][1]);break;case 1537:Ke[pe[0]]=pe[1],pe[0]==be&&(Z=pe[1]);break;default:break}},F);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(k["!ref"]=ut(Re),fe[me||Z]=k,le.push(me||Z),!Ke.length)return{SheetNames:le,Sheets:fe};for(var He={},Fr=[],it=0;it<Ke.length;++it)fe[le[it]]?(Fr.push(Ke[it]||le[it]),He[Ke[it]]=fe[Ke[it]]||fe[le[it]]):(Fr.push(Ke[it]),He[Ke[it]]={"!ref":"A1"});return{SheetNames:Fr,Sheets:He}}function i(b,G){var F=G||{};if(+F.codepage>=0&&ds(+F.codepage),F.type=="string")throw new Error("Cannot write WK1 to JS string");var k=rr(),Z=et(b["!ref"]),me=Array.isArray(b),be=[];se(k,0,s(1030)),se(k,6,c(Z));for(var fe=Math.min(Z.e.r,8191),le=Z.s.r;le<=fe;++le)for(var Ke=Pt(le),Re=Z.s.c;Re<=Z.e.c;++Re){le===Z.s.r&&(be[Re]=Vt(Re));var St=be[Re]+Ke,He=me?(b[le]||[])[Re]:b[St];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?se(k,13,p(le,Re,He.v)):se(k,14,d(le,Re,He.v));else{var Fr=hi(He);se(k,15,u(le,Re,Fr.slice(0,239)))}}return se(k,1),k.end()}function n(b,G){var F=G||{};if(+F.codepage>=0&&ds(+F.codepage),F.type=="string")throw new Error("Cannot write WK3 to JS string");var k=rr();se(k,0,a(b));for(var Z=0,me=0;Z<b.SheetNames.length;++Z)(b.Sheets[b.SheetNames[Z]]||{})["!ref"]&&se(k,27,$t(b.SheetNames[Z],me++));var be=0;for(Z=0;Z<b.SheetNames.length;++Z){var fe=b.Sheets[b.SheetNames[Z]];if(!(!fe||!fe["!ref"])){for(var le=et(fe["!ref"]),Ke=Array.isArray(fe),Re=[],St=Math.min(le.e.r,8191),He=le.s.r;He<=St;++He)for(var Fr=Pt(He),it=le.s.c;it<=le.e.c;++it){He===le.s.r&&(Re[it]=Vt(it));var pe=Re[it]+Fr,xr=Ke?(fe[He]||[])[it]:fe[pe];if(!(!xr||xr.t=="z"))if(xr.t=="n")se(k,23,j(He,it,be,xr.v));else{var Kr=hi(xr);se(k,22,D(He,it,be,Kr.slice(0,239)))}}++be}}return se(k,1),k.end()}function s(b){var G=H(2);return G.write_shift(2,b),G}function a(b){var G=H(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var F=0,k=0,Z=0,me=0;me<b.SheetNames.length;++me){var be=b.SheetNames[me],fe=b.Sheets[be];if(!(!fe||!fe["!ref"])){++Z;var le=gr(fe["!ref"]);F<le.e.r&&(F=le.e.r),k<le.e.c&&(k=le.e.c)}}return F>8191&&(F=8191),G.write_shift(2,F),G.write_shift(1,Z),G.write_shift(1,k),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(b,G,F){var k={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&F.qpro?(k.s.c=b.read_shift(1),b.l++,k.s.r=b.read_shift(2),k.e.c=b.read_shift(1),b.l++,k.e.r=b.read_shift(2),k):(k.s.c=b.read_shift(2),k.s.r=b.read_shift(2),G==12&&F.qpro&&(b.l+=2),k.e.c=b.read_shift(2),k.e.r=b.read_shift(2),G==12&&F.qpro&&(b.l+=2),k.s.c==65535&&(k.s.c=k.e.c=k.s.r=k.e.r=0),k)}function c(b){var G=H(8);return G.write_shift(2,b.s.c),G.write_shift(2,b.s.r),G.write_shift(2,b.e.c),G.write_shift(2,b.e.r),G}function l(b,G,F){var k=[{c:0,r:0},{t:"n",v:0},0,0];return F.qpro&&F.vers!=20768?(k[0].c=b.read_shift(1),k[3]=b.read_shift(1),k[0].r=b.read_shift(2),b.l+=2):(k[2]=b.read_shift(1),k[0].c=b.read_shift(2),k[0].r=b.read_shift(2)),k}function h(b,G,F){var k=b.l+G,Z=l(b,G,F);if(Z[1].t="s",F.vers==20768){b.l++;var me=b.read_shift(1);return Z[1].v=b.read_shift(me,"utf8"),Z}return F.qpro&&b.l++,Z[1].v=b.read_shift(k-b.l,"cstr"),Z}function u(b,G,F){var k=H(7+F.length);k.write_shift(1,255),k.write_shift(2,G),k.write_shift(2,b),k.write_shift(1,39);for(var Z=0;Z<k.length;++Z){var me=F.charCodeAt(Z);k.write_shift(1,me>=128?95:me)}return k.write_shift(1,0),k}function f(b,G,F){var k=l(b,G,F);return k[1].v=b.read_shift(2,"i"),k}function p(b,G,F){var k=H(7);return k.write_shift(1,255),k.write_shift(2,G),k.write_shift(2,b),k.write_shift(2,F,"i"),k}function x(b,G,F){var k=l(b,G,F);return k[1].v=b.read_shift(8,"f"),k}function d(b,G,F){var k=H(13);return k.write_shift(1,255),k.write_shift(2,G),k.write_shift(2,b),k.write_shift(8,F,"f"),k}function g(b,G,F){var k=b.l+G,Z=l(b,G,F);if(Z[1].v=b.read_shift(8,"f"),F.qpro)b.l=k;else{var me=b.read_shift(2);V(b.slice(b.l,b.l+me),Z),b.l+=me}return Z}function I(b,G,F){var k=G&32768;return G&=-32769,G=(k?b:0)+(G>=8192?G-16384:G),(k?"":"$")+(F?Vt(G):Pt(G))}var O={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function V(b,G){pr(b,0);for(var F=[],k=0,Z="",me="",be="",fe="";b.l<b.length;){var le=b[b.l++];switch(le){case 0:F.push(b.read_shift(8,"f"));break;case 1:me=I(G[0].c,b.read_shift(2),!0),Z=I(G[0].r,b.read_shift(2),!1),F.push(me+Z);break;case 2:{var Ke=I(G[0].c,b.read_shift(2),!0),Re=I(G[0].r,b.read_shift(2),!1);me=I(G[0].c,b.read_shift(2),!0),Z=I(G[0].r,b.read_shift(2),!1),F.push(Ke+Re+":"+me+Z)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:F.push("("+F.pop()+")");break;case 5:F.push(b.read_shift(2));break;case 6:{for(var St="";le=b[b.l++];)St+=String.fromCharCode(le);F.push('"'+St.replace(/"/g,'""')+'"')}break;case 8:F.push("-"+F.pop());break;case 23:F.push("+"+F.pop());break;case 22:F.push("NOT("+F.pop()+")");break;case 20:case 21:fe=F.pop(),be=F.pop(),F.push(["AND","OR"][le-20]+"("+be+","+fe+")");break;default:if(le<32&&A[le])fe=F.pop(),be=F.pop(),F.push(be+A[le]+fe);else if(O[le]){if(k=O[le][1],k==69&&(k=b[b.l++]),k>F.length){console.error("WK1 bad formula parse 0x"+le.toString(16)+":|"+F.join("|")+"|");return}var He=F.slice(-k);F.length-=k,F.push(O[le][0]+"("+He.join(",")+")")}else return le<=7?console.error("WK1 invalid opcode "+le.toString(16)):le<=24?console.error("WK1 unsupported op "+le.toString(16)):le<=30?console.error("WK1 invalid opcode "+le.toString(16)):le<=115?console.error("WK1 unsupported function opcode "+le.toString(16)):console.error("WK1 unrecognized opcode "+le.toString(16))}}F.length==1?G[1].f=""+F[0]:console.error("WK1 bad formula parse |"+F.join("|")+"|")}function q(b){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=b.read_shift(2),G[3]=b[b.l++],G[0].c=b[b.l++],G}function ie(b,G){var F=q(b,G);return F[1].t="s",F[1].v=b.read_shift(G-4,"cstr"),F}function D(b,G,F,k){var Z=H(6+k.length);Z.write_shift(2,b),Z.write_shift(1,F),Z.write_shift(1,G),Z.write_shift(1,39);for(var me=0;me<k.length;++me){var be=k.charCodeAt(me);Z.write_shift(1,be>=128?95:be)}return Z.write_shift(1,0),Z}function Y(b,G){var F=q(b,G);F[1].v=b.read_shift(2);var k=F[1].v>>1;if(F[1].v&1)switch(k&7){case 0:k=(k>>3)*5e3;break;case 1:k=(k>>3)*500;break;case 2:k=(k>>3)/20;break;case 3:k=(k>>3)/200;break;case 4:k=(k>>3)/2e3;break;case 5:k=(k>>3)/2e4;break;case 6:k=(k>>3)/16;break;case 7:k=(k>>3)/64;break}return F[1].v=k,F}function z(b,G){var F=q(b,G),k=b.read_shift(4),Z=b.read_shift(4),me=b.read_shift(2);if(me==65535)return k===0&&Z===3221225472?(F[1].t="e",F[1].v=15):k===0&&Z===3489660928?(F[1].t="e",F[1].v=42):F[1].v=0,F;var be=me&32768;return me=(me&32767)-16446,F[1].v=(1-be*2)*(Z*Math.pow(2,me+32)+k*Math.pow(2,me)),F}function j(b,G,F,k){var Z=H(14);if(Z.write_shift(2,b),Z.write_shift(1,F),Z.write_shift(1,G),k==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var me=0,be=0,fe=0,le=0;return k<0&&(me=1,k=-k),be=Math.log2(k)|0,k/=Math.pow(2,be-31),le=k>>>0,(le&2147483648)==0&&(k/=2,++be,le=k>>>0),k-=le,le|=2147483648,le>>>=0,k*=Math.pow(2,32),fe=k>>>0,Z.write_shift(4,fe),Z.write_shift(4,le),be+=16383+(me?32768:0),Z.write_shift(2,be),Z}function Q(b,G){var F=z(b,14);return b.l+=G-14,F}function te(b,G){var F=q(b,G),k=b.read_shift(4);return F[1].v=k>>6,F}function ge(b,G){var F=q(b,G),k=b.read_shift(8,"f");return F[1].v=k,F}function ze(b,G){var F=ge(b,14);return b.l+=G-10,F}function _e(b,G){return b[b.l+G-1]==0?b.read_shift(G,"cstr"):""}function pt(b,G){var F=b[b.l++];F>G-1&&(F=G-1);for(var k="";k.length<F;)k+=String.fromCharCode(b[b.l++]);return k}function mt(b,G,F){if(!(!F.qpro||G<21)){var k=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var Z=b.read_shift(G-21,"cstr");return[k,Z]}}function jt(b,G){for(var F={},k=b.l+G;b.l<k;){var Z=b.read_shift(2);if(Z==14e3){for(F[Z]=[0,""],F[Z][0]=b.read_shift(2);b[b.l];)F[Z][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return F}function $t(b,G){var F=H(5+b.length);F.write_shift(2,14e3),F.write_shift(2,G);for(var k=0;k<b.length;++k){var Z=b.charCodeAt(k);F[F.l++]=Z>127?95:Z}return F[F.l++]=0,F}var bt={0:{n:"BOF",f:Ih},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_e},222:{n:"SHEETNAMELP",f:pt},65535:{n:""}},Yt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ie},23:{n:"NUMBER17",f:z},24:{n:"NUMBER18",f:Y},25:{n:"FORMULA19",f:Q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:jt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:te},38:{n:"??"},39:{n:"NUMBER27",f:ge},40:{n:"FORMULA28",f:ze},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:mt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:n,to_workbook:t}}();var Cg=/^\s|\s$|[\t\n\r]/;function Ph(r,t){if(!t.bookSST)return"";var e=[ft];e[e.length]=ne("sst",null,{xmlns:Fn[0],count:r.Count,uniqueCount:r.Unique});for(var i=0;i!=r.length;++i)if(r[i]!=null){var n=r[i],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(Cg)&&(s+=' xml:space="preserve"'),s+=">"+je(n.t)+"</t>"),s+="</si>",e[e.length]=s}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function bg(r){return[r.read_shift(4),r.read_shift(4)]}function Sg(r,t){return t||(t=H(8)),t.write_shift(4,r.Count),t.write_shift(4,r.Unique),t}var Tg=mm;function Eg(r){var t=rr();K(t,159,Sg(r));for(var e=0;e<r.length;++e)K(t,19,Tg(r[e]));return K(t,160),t.end()}function kg(r){if(typeof Ze<"u")return Ze.utils.encode(kn,r);for(var t=[],e=r.split(""),i=0;i<e.length;++i)t[i]=e[i].charCodeAt(0);return t}function Lh(r){var t=0,e,i=kg(r),n=i.length+1,s,a,o,c,l;for(e=Xi(n),e[0]=i.length,s=1;s!=n;++s)e[s]=i[s-1];for(s=n-1;s>=0;--s)a=e[s],o=(t&16384)===0?0:1,c=t<<1&32767,l=o|c,t=l^a;return t^52811}var Ig=function(){function r(n,s){switch(s.type){case"base64":return t(ci(n),s);case"binary":return t(n,s);case"buffer":return t($e&&Buffer.isBuffer(n)?n.toString("binary"):_s(n),s);case"array":return t(Oa(n),s)}throw new Error("Unrecognized type "+s.type)}function t(n,s){var a=s||{},o=a.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,u){Array.isArray(o)&&(o[u]=[]);for(var f=/\\\w+\b/g,p=0,x,d=-1;x=f.exec(h);){switch(x[0]){case"\\cell":var g=h.slice(p,f.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++d,g.length){var I={v:g,t:"s"};Array.isArray(o)?o[u][d]=I:o[Ye({r:u,c:d})]=I}break}p=f.lastIndex}d>l.e.c&&(l.e.c=d)}),o["!ref"]=ut(l),o}function e(n,s){return Ki(r(n,s),s)}function i(n){for(var s=["{\\rtf1\\ansi"],a=et(n["!ref"]),o,c=Array.isArray(n),l=a.s.r;l<=a.e.r;++l){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var u=Ye({r:l,c:h});o=c?(n[l]||[])[h]:n[u],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(hi(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:e,to_sheet:r,from_sheet:i}}();function D0(r){for(var t=0,e=1;t!=3;++t)e=e*256+(r[t]>255?255:r[t]<0?0:r[t]);return e.toString(16).toUpperCase().slice(1)}var Fg=6;var li=Fg;function wa(r){return Math.floor((r+Math.round(128/li)/256)*li)}function Ca(r){return Math.floor((r-5)/li*100+.5)/100}function Bo(r){return Math.round((r*li+5)/li*256)/256}function il(r){r.width?(r.wpx=wa(r.width),r.wch=Ca(r.wpx),r.MDW=li):r.wpx?(r.wch=Ca(r.wpx),r.width=Bo(r.wch),r.MDW=li):typeof r.wch=="number"&&(r.width=Bo(r.wch),r.wpx=wa(r.width),r.MDW=li),r.customWidth&&delete r.customWidth}var Og=96,Rh=Og;function ba(r){return r*96/Rh}function Nh(r){return r*Rh/96}function Ag(r){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var i=e[0];i<=e[1];++i)r[i]!=null&&(t[t.length]=ne("numFmt",null,{numFmtId:i,formatCode:je(r[i])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ne("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Dg(r){var t=[];return t[t.length]=ne("cellXfs",null),r.forEach(function(e){t[t.length]=ne("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ne("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Bh(r,t){var e=[ft,ne("styleSheet",null,{xmlns:Fn[0],"xmlns:vt":yt.vt})],i;return r.SSF&&(i=Ag(r.SSF))!=null&&(e[e.length]=i),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=Dg(t.cellXfs))&&(e[e.length]=i),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function Mg(r,t){var e=r.read_shift(2),i=Wt(r,t-2);return[e,i]}function Pg(r,t,e){e||(e=H(6+4*t.length)),e.write_shift(2,r),Ct(t,e);var i=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),i}function Lg(r,t,e){var i={};i.sz=r.read_shift(2)/20;var n=Cm(r,2,e);n.fItalic&&(i.italic=1),n.fCondense&&(i.condense=1),n.fExtend&&(i.extend=1),n.fShadow&&(i.shadow=1),n.fOutline&&(i.outline=1),n.fStrikeout&&(i.strike=1);var s=r.read_shift(2);switch(s===700&&(i.bold=1),r.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var a=r.read_shift(1);a!=0&&(i.underline=a);var o=r.read_shift(1);o>0&&(i.family=o);var c=r.read_shift(1);switch(c>0&&(i.charset=c),r.l++,i.color=wm(r,8),r.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=Wt(r,t-21),i}function Rg(r,t){t||(t=H(25+4*32)),t.write_shift(2,r.sz*20),bm(r,t),t.write_shift(2,r.bold?700:400);var e=0;r.vertAlign=="superscript"?e=1:r.vertAlign=="subscript"&&(e=2),t.write_shift(2,e),t.write_shift(1,r.underline||0),t.write_shift(1,r.family||0),t.write_shift(1,r.charset||0),t.write_shift(1,0),_a(r.color,t);var i=0;return r.scheme=="major"&&(i=1),r.scheme=="minor"&&(i=2),t.write_shift(1,i),Ct(r.name,t),t.length>t.l?t.slice(0,t.l):t}var Ng=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ao,Bg=Yr;function M0(r,t){t||(t=H(4*3+8*7+16*1)),Ao||(Ao=Wo(Ng));var e=Ao[r.patternType];e==null&&(e=40),t.write_shift(4,e);var i=0;if(e!=40)for(_a({auto:1},t),_a({auto:1},t);i<12;++i)t.write_shift(4,0);else{for(;i<4;++i)t.write_shift(4,0);for(;i<12;++i)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Hg(r,t){var e=r.l+t,i=r.read_shift(2),n=r.read_shift(2);return r.l=e,{ixfe:i,numFmtId:n}}function Hh(r,t,e){e||(e=H(16)),e.write_shift(2,t||0),e.write_shift(2,r.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var i=0;return e.write_shift(1,i),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function ss(r,t){return t||(t=H(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Vg=Yr;function Wg(r,t){return t||(t=H(51)),t.write_shift(1,0),ss(null,t),ss(null,t),ss(null,t),ss(null,t),ss(null,t),t.length>t.l?t.slice(0,t.l):t}function $g(r,t){return t||(t=H(12+4*10)),t.write_shift(4,r.xfId),t.write_shift(2,1),t.write_shift(1,+r.builtinId),t.write_shift(1,0),va(r.name||"",t),t.length>t.l?t.slice(0,t.l):t}function zg(r,t,e){var i=H(2052);return i.write_shift(4,r),va(t,i),va(e,i),i.length>i.l?i.slice(0,i.l):i}function Ug(r,t){if(t){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)t[n]!=null&&++e}),e!=0&&(K(r,615,Hr(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)t[n]!=null&&K(r,44,Pg(n,t[n]))}),K(r,616))}}function Gg(r){var t=1;t!=0&&(K(r,611,Hr(t)),K(r,43,Rg({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),K(r,612))}function Xg(r){var t=2;t!=0&&(K(r,603,Hr(t)),K(r,45,M0({patternType:"none"})),K(r,45,M0({patternType:"gray125"})),K(r,604))}function jg(r){var t=1;t!=0&&(K(r,613,Hr(t)),K(r,46,Wg({})),K(r,614))}function Yg(r){var t=1;K(r,626,Hr(t)),K(r,47,Hh({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),K(r,627)}function Kg(r,t){K(r,617,Hr(t.length)),t.forEach(function(e){K(r,47,Hh(e,0))}),K(r,618)}function qg(r){var t=1;K(r,619,Hr(t)),K(r,48,$g({xfId:0,builtinId:0,name:"Normal"})),K(r,620)}function Zg(r){var t=0;K(r,505,Hr(t)),K(r,506)}function Qg(r){var t=0;K(r,508,zg(t,"TableStyleMedium9","PivotStyleMedium4")),K(r,509)}function Jg(r,t){var e=rr();return K(e,278),Ug(e,r.SSF),Gg(e,r),Xg(e,r),jg(e,r),Yg(e,r),Kg(e,t.cellXfs),qg(e,r),Zg(e,r),Qg(e,r),K(e,279),e.end()}function Vh(r,t){if(t&&t.themeXLSX)return t.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var e=[ft];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function e1(r,t){return{flags:r.read_shift(4),version:r.read_shift(4),name:Wt(r,t-8)}}function t1(r){var t=H(12+2*r.name.length);return t.write_shift(4,r.flags),t.write_shift(4,r.version),Ct(r.name,t),t.slice(0,t.l)}function r1(r){for(var t=[],e=r.read_shift(4);e-- >0;)t.push([r.read_shift(4),r.read_shift(4)]);return t}function i1(r){var t=H(4+8*r.length);t.write_shift(4,r.length);for(var e=0;e<r.length;++e)t.write_shift(4,r[e][0]),t.write_shift(4,r[e][1]);return t}function n1(r,t){var e=H(8+2*t.length);return e.write_shift(4,r),Ct(t,e),e.slice(0,e.l)}function s1(r){return r.l+=4,r.read_shift(4)!=0}function a1(r,t){var e=H(8);return e.write_shift(4,r),e.write_shift(4,t?1:0),e}function o1(){var r=rr();return K(r,332),K(r,334,Hr(1)),K(r,335,t1({name:"XLDAPR",version:12e4,flags:3496657072})),K(r,336),K(r,339,n1(1,"XLDAPR")),K(r,52),K(r,35,Hr(514)),K(r,4096,Hr(0)),K(r,4097,Er(1)),K(r,36),K(r,53),K(r,340),K(r,337,a1(1,!0)),K(r,51,i1([[1,0]])),K(r,338),K(r,333),r.end()}function Wh(){var r=[ft];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function l1(r){var t={};t.i=r.read_shift(4);var e={};e.r=r.read_shift(4),e.c=r.read_shift(4),t.r=Ye(e);var i=r.read_shift(1);return i&2&&(t.l="1"),i&8&&(t.a="1"),t}var wn=1024;function $h(r,t){for(var e=[21600,21600],i=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),n=[ne("xml",null,{"xmlns:v":mr.v,"xmlns:o":mr.o,"xmlns:x":mr.x,"xmlns:mv":mr.mv}).replace(/\/>/,">"),ne("o:shapelayout",ne("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),ne("v:shapetype",[ne("v:stroke",null,{joinstyle:"miter"}),ne("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:i})];wn<r*1e3;)wn+=1e3;return t.forEach(function(s){var a=wt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ne("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=ne("v:fill",c,o),h={on:"t",obscured:"t"};++wn,n=n.concat(["<v:shape"+gs({id:"_x0000_s"+wn,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,ne("v:shadow",null,h),ne("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Mt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Mt("x:AutoFill","False"),Mt("x:Row",String(a.r)),Mt("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function zh(r){var t=[ft,ne("comments",null,{xmlns:Fn[0]})],e=[];return t.push("<authors>"),r.forEach(function(i){i[1].forEach(function(n){var s=je(n.a);e.indexOf(s)==-1&&(e.push(s),t.push("<author>"+s+"</author>")),n.T&&n.ID&&e.indexOf("tc="+n.ID)==-1&&(e.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),r.forEach(function(i){var n=0,s=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?n=e.indexOf("tc="+i[1][0].ID):i[1].forEach(function(c){c.a&&(n=e.indexOf(je(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+i[0]+'" authorId="'+n+'"><text>'),s.length<=1)t.push(Mt("t",je(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(Mt("t",je(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function c1(r,t,e){var i=[ft,ne("ThreadedComments",null,{xmlns:yt.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(n){var s="";(n[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),i.push(ne("threadedComment",Mt("text",a.t||""),c))})}),i.push("</ThreadedComments>"),i.join("")}function h1(r){var t=[ft,ne("personList",null,{xmlns:yt.TCMNT,"xmlns:x":Fn[0]}).replace(/[\/]>/,">")];return r.forEach(function(e,i){t.push(ne("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function u1(r){var t={};t.iauthor=r.read_shift(4);var e=Ji(r,16);return t.rfx=e.s,t.ref=Ye(e.s),r.l+=16,t}function f1(r,t){return t==null&&(t=H(36)),t.write_shift(4,r[1].iauthor),Dn(r[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var d1=Wt;function p1(r){return Ct(r.slice(0,54))}function m1(r){var t=rr(),e=[];return K(t,628),K(t,630),r.forEach(function(i){i[1].forEach(function(n){e.indexOf(n.a)>-1||(e.push(n.a.slice(0,54)),K(t,632,p1(n.a)))})}),K(t,631),K(t,633),r.forEach(function(i){i[1].forEach(function(n){n.iauthor=e.indexOf(n.a);var s={s:wt(i[0]),e:wt(i[0])};K(t,635,f1([s,n])),n.t&&n.t.length>0&&K(t,637,xm(n)),K(t,636),delete n.iauthor})}),K(t,634),K(t,629),t.end()}function g1(r,t){t.FullPaths.forEach(function(e,i){if(i!=0){var n=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&qe.utils.cfb_add(r,n,t.FileIndex[i].content)}})}var Uh=["xlsb","xlsm","xlam","biff8","xla"];var x1=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(i,n,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=t.c:--h,c?l+=t.r:--l,n+(o?"":"$")+Vt(h)+(c?"":"$")+Pt(l)}return function(n,s){return t=s,n.replace(r,e)}}(),nl=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sl=function(){return function(t,e){return t.replace(nl,function(i,n,s,a,o,c){var l=Qo(a)-(s?0:e.c),h=Zo(c)-(o?0:e.r),u=h==0?"":o?h+1:"["+h+"]",f=l==0?"":s?l+1:"["+l+"]";return n+"R"+u+"C"+f})}}();function v1(r,t){return r.replace(nl,function(e,i,n,s,a,o){return i+(n=="$"?n+s:Vt(Qo(s)+t.c))+(a=="$"?a+o:Pt(Zo(o)+t.r))})}function _1(r){return r.length!=1}function ht(r){r.l+=1}function Ii(r,t){var e=r.read_shift(t==1?1:2);return[e&16383,e>>14&1,e>>15&1]}function Gh(r,t,e){var i=2;if(e){if(e.biff>=2&&e.biff<=5)return Xh(r,t,e);e.biff==12&&(i=4)}var n=r.read_shift(i),s=r.read_shift(i),a=Ii(r,2),o=Ii(r,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Xh(r){var t=Ii(r,2),e=Ii(r,2),i=r.read_shift(1),n=r.read_shift(1);return{s:{r:t[0],c:i,cRel:t[1],rRel:t[2]},e:{r:e[0],c:n,cRel:e[1],rRel:e[2]}}}function y1(r,t,e){if(e.biff<8)return Xh(r,t,e);var i=r.read_shift(e.biff==12?4:2),n=r.read_shift(e.biff==12?4:2),s=Ii(r,2),a=Ii(r,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:a[0],cRel:a[1],rRel:a[2]}}}function jh(r,t,e){if(e&&e.biff>=2&&e.biff<=5)return w1(r,t,e);var i=r.read_shift(e&&e.biff==12?4:2),n=Ii(r,2);return{r:i,c:n[0],cRel:n[1],rRel:n[2]}}function w1(r){var t=Ii(r,2),e=r.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function C1(r){var t=r.read_shift(2),e=r.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function b1(r,t,e){var i=e&&e.biff?e.biff:8;if(i>=2&&i<=5)return S1(r,t,e);var n=r.read_shift(i>=12?4:2),s=r.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;n>524287;)n-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:a,rRel:o}}function S1(r){var t=r.read_shift(2),e=r.read_shift(1),i=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,i==1&&t>=8192&&(t=t-16384),n==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:n,rRel:i}}function T1(r,t,e){var i=(r[r.l++]&96)>>5,n=Gh(r,e.biff>=2&&e.biff<=5?6:8,e);return[i,n]}function E1(r,t,e){var i=(r[r.l++]&96)>>5,n=r.read_shift(2,"i"),s=8;if(e)switch(e.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var a=Gh(r,s,e);return[i,n,a]}function k1(r,t,e){var i=(r[r.l++]&96)>>5;return r.l+=e&&e.biff>8?12:e.biff<8?6:8,[i]}function I1(r,t,e){var i=(r[r.l++]&96)>>5,n=r.read_shift(2),s=8;if(e)switch(e.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[i,n]}function F1(r,t,e){var i=(r[r.l++]&96)>>5,n=y1(r,t-1,e);return[i,n]}function O1(r,t,e){var i=(r[r.l++]&96)>>5;return r.l+=e.biff==2?6:e.biff==12?14:7,[i]}function P0(r){var t=r[r.l+1]&1,e=1;return r.l+=4,[t,e]}function A1(r,t,e){r.l+=2;for(var i=r.read_shift(e&&e.biff==2?1:2),n=[],s=0;s<=i;++s)n.push(r.read_shift(e&&e.biff==2?1:2));return n}function D1(r,t,e){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(e&&e.biff==2?1:2)]}function M1(r,t,e){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(e&&e.biff==2?1:2)]}function P1(r){var t=r[r.l+1]&255?1:0;return r.l+=2,[t,r.read_shift(2)]}function L1(r,t,e){var i=r[r.l+1]&255?1:0;return r.l+=e&&e.biff==2?3:4,[i]}function Yh(r){var t=r.read_shift(1),e=r.read_shift(1);return[t,e]}function R1(r){return r.read_shift(2),Yh(r,2)}function N1(r){return r.read_shift(2),Yh(r,2)}function B1(r,t,e){var i=(r[r.l]&96)>>5;r.l+=1;var n=jh(r,0,e);return[i,n]}function H1(r,t,e){var i=(r[r.l]&96)>>5;r.l+=1;var n=b1(r,0,e);return[i,n]}function V1(r,t,e){var i=(r[r.l]&96)>>5;r.l+=1;var n=r.read_shift(2);e&&e.biff==5&&(r.l+=12);var s=jh(r,0,e);return[i,n,s]}function W1(r,t,e){var i=(r[r.l]&96)>>5;r.l+=1;var n=r.read_shift(e&&e.biff<=3?1:2);return[Wx[n],Zh[n],i]}function $1(r,t,e){var i=r[r.l++],n=r.read_shift(1),s=e&&e.biff<=3?[i==88?-1:0,r.read_shift(1)]:z1(r);return[n,(s[0]===0?Zh:Vx)[s[1]]]}function z1(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function U1(r,t,e){r.l+=e&&e.biff==2?3:4}function G1(r,t,e){if(r.l++,e&&e.biff==12)return[r.read_shift(4,"i"),0];var i=r.read_shift(2),n=r.read_shift(e&&e.biff==2?1:2);return[i,n]}function X1(r){return r.l++,ws[r.read_shift(1)]}function j1(r){return r.l++,r.read_shift(2)}function Y1(r){return r.l++,r.read_shift(1)!==0}function K1(r){return r.l++,Mn(r,8)}function q1(r,t,e){return r.l++,Oh(r,t-1,e)}function Z1(r,t){var e=[r.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=Vm(r,1)?"TRUE":"FALSE",t!=12&&(r.l+=7);break;case 37:case 16:e[1]=ws[r[r.l]],r.l+=t==12?4:8;break;case 0:r.l+=8;break;case 1:e[1]=Mn(r,8);break;case 2:e[1]=Um(r,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function Q1(r,t,e){for(var i=r.read_shift(e.biff==12?4:2),n=[],s=0;s!=i;++s)n.push((e.biff==12?Ji:jm)(r,8));return n}function J1(r,t,e){var i=0,n=0;e.biff==12?(i=r.read_shift(4),n=r.read_shift(4)):(n=1+r.read_shift(1),i=1+r.read_shift(2)),e.biff>=2&&e.biff<8&&(--i,--n==0&&(n=256));for(var s=0,a=[];s!=i&&(a[s]=[]);++s)for(var o=0;o!=n;++o)a[s][o]=Z1(r,e.biff);return a}function ex(r,t,e){var i=r.read_shift(1)>>>5&3,n=!e||e.biff>=8?4:2,s=r.read_shift(n);switch(e.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[i,0,s]}function tx(r,t,e){if(e.biff==5)return rx(r,t,e);var i=r.read_shift(1)>>>5&3,n=r.read_shift(2),s=r.read_shift(4);return[i,n,s]}function rx(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2,"i");r.l+=8;var i=r.read_shift(2);return r.l+=12,[t,e,i]}function ix(r,t,e){var i=r.read_shift(1)>>>5&3;r.l+=e&&e.biff==2?3:4;var n=r.read_shift(e&&e.biff==2?1:2);return[i,n]}function nx(r,t,e){var i=r.read_shift(1)>>>5&3,n=r.read_shift(e&&e.biff==2?1:2);return[i,n]}function sx(r,t,e){var i=r.read_shift(1)>>>5&3;return r.l+=4,e.biff<8&&r.l--,e.biff==12&&(r.l+=2),[i]}function ax(r,t,e){var i=(r[r.l++]&96)>>5,n=r.read_shift(2),s=4;if(e)switch(e.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[i,n]}var ox=Yr,lx=Yr,cx=Yr;function Cs(r,t,e){return r.l+=2,[C1(r,4,e)]}function al(r){return r.l+=6,[]}var hx=Cs,ux=al,fx=al,dx=Cs;function Kh(r){return r.l+=2,[Ih(r),r.read_shift(2)&1]}var px=Cs,mx=Kh,gx=al,xx=Cs,vx=Cs,_x=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function yx(r){r.l+=2;var t=r.read_shift(2),e=r.read_shift(2),i=r.read_shift(4),n=r.read_shift(2),s=r.read_shift(2),a=_x[e>>2&31];return{ixti:t,coltype:e&3,rt:a,idx:i,c:n,C:s}}function wx(r){return r.l+=2,[r.read_shift(4)]}function Cx(r,t,e){return r.l+=5,r.l+=2,r.l+=e.biff==2?1:4,["PTGSHEET"]}function bx(r,t,e){return r.l+=e.biff==2?4:5,["PTGENDSHEET"]}function Sx(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2);return[t,e]}function Tx(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2);return[t,e]}function Ex(r){return r.l+=4,[0,0]}var L0={1:{n:"PtgExp",f:G1},2:{n:"PtgTbl",f:cx},3:{n:"PtgAdd",f:ht},4:{n:"PtgSub",f:ht},5:{n:"PtgMul",f:ht},6:{n:"PtgDiv",f:ht},7:{n:"PtgPower",f:ht},8:{n:"PtgConcat",f:ht},9:{n:"PtgLt",f:ht},10:{n:"PtgLe",f:ht},11:{n:"PtgEq",f:ht},12:{n:"PtgGe",f:ht},13:{n:"PtgGt",f:ht},14:{n:"PtgNe",f:ht},15:{n:"PtgIsect",f:ht},16:{n:"PtgUnion",f:ht},17:{n:"PtgRange",f:ht},18:{n:"PtgUplus",f:ht},19:{n:"PtgUminus",f:ht},20:{n:"PtgPercent",f:ht},21:{n:"PtgParen",f:ht},22:{n:"PtgMissArg",f:ht},23:{n:"PtgStr",f:q1},26:{n:"PtgSheet",f:Cx},27:{n:"PtgEndSheet",f:bx},28:{n:"PtgErr",f:X1},29:{n:"PtgBool",f:Y1},30:{n:"PtgInt",f:j1},31:{n:"PtgNum",f:K1},32:{n:"PtgArray",f:O1},33:{n:"PtgFunc",f:W1},34:{n:"PtgFuncVar",f:$1},35:{n:"PtgName",f:ex},36:{n:"PtgRef",f:B1},37:{n:"PtgArea",f:T1},38:{n:"PtgMemArea",f:ix},39:{n:"PtgMemErr",f:ox},40:{n:"PtgMemNoMem",f:lx},41:{n:"PtgMemFunc",f:nx},42:{n:"PtgRefErr",f:sx},43:{n:"PtgAreaErr",f:k1},44:{n:"PtgRefN",f:H1},45:{n:"PtgAreaN",f:F1},46:{n:"PtgMemAreaN",f:Sx},47:{n:"PtgMemNoMemN",f:Tx},57:{n:"PtgNameX",f:tx},58:{n:"PtgRef3d",f:V1},59:{n:"PtgArea3d",f:E1},60:{n:"PtgRefErr3d",f:ax},61:{n:"PtgAreaErr3d",f:I1},255:{}},kx={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ix={1:{n:"PtgElfLel",f:Kh},2:{n:"PtgElfRw",f:xx},3:{n:"PtgElfCol",f:hx},6:{n:"PtgElfRwV",f:vx},7:{n:"PtgElfColV",f:dx},10:{n:"PtgElfRadical",f:px},11:{n:"PtgElfRadicalS",f:gx},13:{n:"PtgElfColS",f:ux},15:{n:"PtgElfColSV",f:fx},16:{n:"PtgElfRadicalLel",f:mx},25:{n:"PtgList",f:yx},29:{n:"PtgSxName",f:wx},255:{}},Fx={0:{n:"PtgAttrNoop",f:Ex},1:{n:"PtgAttrSemi",f:L1},2:{n:"PtgAttrIf",f:M1},4:{n:"PtgAttrChoose",f:A1},8:{n:"PtgAttrGoto",f:D1},16:{n:"PtgAttrSum",f:U1},32:{n:"PtgAttrBaxcel",f:P0},33:{n:"PtgAttrBaxcel",f:P0},64:{n:"PtgAttrSpace",f:R1},65:{n:"PtgAttrSpaceSemi",f:N1},128:{n:"PtgAttrIfError",f:P1},255:{}};function Ox(r,t,e,i){if(i.biff<8)return Yr(r,t);for(var n=r.l+t,s=[],a=0;a!==e.length;++a)switch(e[a][0]){case"PtgArray":e[a][1]=J1(r,0,i),s.push(e[a][1]);break;case"PtgMemArea":e[a][2]=Q1(r,e[a][1],i),s.push(e[a][2]);break;case"PtgExp":i&&i.biff==12&&(e[a][1][1]=r.read_shift(4),s.push(e[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[a][0];default:break}return t=n-r.l,t!==0&&s.push(Yr(r,t)),s}function Ax(r,t,e){for(var i=r.l+t,n,s,a=[];i!=r.l;)t=i-r.l,s=r[r.l],n=L0[s]||L0[kx[s]],(s===24||s===25)&&(n=(s===24?Ix:Fx)[r[r.l+1]]),!n||!n.f?Yr(r,t):a.push([n.n,n.f(r,t,e)]);return a}function Dx(r){for(var t=[],e=0;e<r.length;++e){for(var i=r[e],n=[],s=0;s<i.length;++s){var a=i[s];if(a)switch(a[0]){case 2:n.push('"'+a[1].replace(/"/g,'""')+'"');break;default:n.push(a[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var Mx={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Px(r,t){if(!r&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function qh(r,t,e){if(!r)return"SH33TJSERR0";if(e.biff>8&&(!r.XTI||!r.XTI[t]))return r.SheetNames[t];if(!r.XTI)return"SH33TJSERR6";var i=r.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":r.XTI[t-1];if(!i)return"SH33TJSERR1";var n="";if(e.biff>8)switch(r[i[0]][0]){case 357:return n=i[1]==-1?"#REF":r.SheetNames[i[1]],i[1]==i[2]?n:n+":"+r.SheetNames[i[2]];case 358:return e.SID!=null?r.SheetNames[e.SID]:"SH33TJSSAME"+r[i[0]][0];case 355:default:return"SH33TJSSRC"+r[i[0]][0]}switch(r[i[0]][0][0]){case 1025:return n=i[1]==-1?"#REF":r.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?n:n+":"+r.SheetNames[i[2]];case 14849:return r[i[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[i[0]][0][3]?(n=i[1]==-1?"#REF":r[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?n:n+":"+r[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function R0(r,t,e){var i=qh(r,t,e);return i=="#REF"?i:Px(i,e)}function In(r,t,e,i,n){var s=n&&n.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,h,u=0,f=0,p,x="";if(!r[0]||!r[0][0])return"";for(var d=-1,g="",I=0,O=r[0].length;I<O;++I){var A=r[0][I];switch(A[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),d>=0){switch(r[0][d][1][0]){case 0:g=at(" ",r[0][d][1][1]);break;case 1:g=at("\r",r[0][d][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][d][1][0])}l=l+g,d=-1}o.push(l+Mx[A[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=cs(A[1][1],a,n),o.push(hs(h,s));break;case"PtgRefN":h=e?cs(A[1][1],e,n):A[1][1],o.push(hs(h,s));break;case"PtgRef3d":u=A[1][1],h=cs(A[1][2],a,n),x=R0(i,u,n);var V=x;o.push(x+"!"+hs(h,s));break;case"PtgFunc":case"PtgFuncVar":var q=A[1][0],ie=A[1][1];q||(q=0),q&=127;var D=q==0?[]:o.slice(-q);o.length-=q,ie==="User"&&(ie=D.shift()),o.push(ie+"("+D.join(",")+")");break;case"PtgBool":o.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(A[1]);break;case"PtgNum":o.push(String(A[1]));break;case"PtgStr":o.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(A[1]);break;case"PtgAreaN":p=y0(A[1][1],e?{s:e}:a,n),o.push(Fo(p,n));break;case"PtgArea":p=y0(A[1][1],a,n),o.push(Fo(p,n));break;case"PtgArea3d":u=A[1][1],p=A[1][2],x=R0(i,u,n),o.push(x+"!"+Fo(p,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=A[1][2];var Y=(i.names||[])[f-1]||(i[0]||[])[f],z=Y?Y.Name:"SH33TJSNAME"+String(f);z&&z.slice(0,6)=="_xlfn."&&!n.xlfn&&(z=z.slice(6)),o.push(z);break;case"PtgNameX":var j=A[1][1];f=A[1][2];var Q;if(n.biff<=5)j<0&&(j=-j),i[j]&&(Q=i[j][f]);else{var te="";if(((i[j]||[])[0]||[])[0]==14849||(((i[j]||[])[0]||[])[0]==1025?i[j][f]&&i[j][f].itab>0&&(te=i.SheetNames[i[j][f].itab-1]+"!"):te=i.SheetNames[f-1]+"!"),i[j]&&i[j][f])te+=i[j][f].Name;else if(i[0]&&i[0][f])te+=i[0][f].Name;else{var ge=(qh(i,j,n)||"").split(";;");ge[f-1]?te=ge[f-1]:te+="SH33TJSERRX"}o.push(te);break}Q||(Q={Name:"SH33TJSERRY"}),o.push(Q.Name);break;case"PtgParen":var ze="(",_e=")";if(d>=0){switch(g="",r[0][d][1][0]){case 2:ze=at(" ",r[0][d][1][1])+ze;break;case 3:ze=at("\r",r[0][d][1][1])+ze;break;case 4:_e=at(" ",r[0][d][1][1])+_e;break;case 5:_e=at("\r",r[0][d][1][1])+_e;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][d][1][0])}d=-1}o.push(ze+o.pop()+_e);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:A[1][1],r:A[1][0]};var pt={c:e.c,r:e.r};if(i.sharedf[Ye(h)]){var mt=i.sharedf[Ye(h)];o.push(In(mt,a,pt,i,n))}else{var jt=!1;for(c=0;c!=i.arrayf.length;++c)if(l=i.arrayf[c],!(h.c<l[0].s.c||h.c>l[0].e.c)&&!(h.r<l[0].s.r||h.r>l[0].e.r)){o.push(In(l[1],a,pt,i,n)),jt=!0;break}jt||o.push(A[1])}break;case"PtgArray":o.push("{"+Dx(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":d=I;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var $t=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&d>=0&&$t.indexOf(r[0][I][0])==-1){A=r[0][d];var bt=!0;switch(A[1][0]){case 4:bt=!1;case 0:g=at(" ",A[1][1]);break;case 5:bt=!1;case 1:g=at("\r",A[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}o.push((bt?g:"")+o.pop()+(bt?"":g)),d=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function Lx(r){if(r==null){var t=H(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof r=="number")return ji(r);return ji(0)}function Rx(r,t,e,i,n){var s=Yi(t,e,n),a=Lx(r.v),o=H(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=H(r.bf.length),h=0;h<r.bf.length;++h)l[h]=r.bf[h];var u=Dt([s,a,o,l]);return u}function Da(r,t,e){var i=r.read_shift(4),n=Ax(r,i,e),s=r.read_shift(4),a=s>0?Ox(r,s,n,e):null;return[n,a]}var Nx=Da,Ma=Da,Bx=Da,Hx=Da,Vx={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Zh={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Wx={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function $x(r){var t="of:="+r.replace(nl,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function zx(r){return r.replace(/\./,"!")}var us=typeof Map<"u";function ol(r,t,e){var i=0,n=r.length;if(e){if(us?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var s=us?e.get(t):e[t];i<s.length;++i)if(r[s[i]].t===t)return r.Count++,s[i]}}else for(;i<n;++i)if(r[i].t===t)return r.Count++,i;return r[n]={t},r.Count++,r.Unique++,e&&(us?(e.has(t)||e.set(t,[]),e.get(t).push(n)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(n))),n}function Pa(r,t){var e={min:r+1,max:r+1},i=-1;return t.MDW&&(li=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?i=Ca(t.wpx):t.wch!=null&&(i=t.wch),i>-1?(e.width=Bo(i),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function Qh(r,t){if(r){var e=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(e=[1,1,1,1,.5,.5]),r.left==null&&(r.left=e[0]),r.right==null&&(r.right=e[1]),r.top==null&&(r.top=e[2]),r.bottom==null&&(r.bottom=e[3]),r.header==null&&(r.header=e[4]),r.footer==null&&(r.footer=e[5])}}function Oi(r,t,e){var i=e.revssf[t.z!=null?t.z:"General"],n=60,s=r.length;if(i==null&&e.ssf){for(;n<392;++n)if(e.ssf[n]==null){Q0(t.z,n),e.ssf[n]=t.z,e.revssf[t.z]=i=n;break}}for(n=0;n!=s;++n)if(r[n].numFmtId===i)return n;return r[s]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Ux(r,t,e){if(r&&r["!ref"]){var i=et(r["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+e+"): "+r["!ref"])}}function Gx(r){if(r.length===0)return"";for(var t='<mergeCells count="'+r.length+'">',e=0;e!=r.length;++e)t+='<mergeCell ref="'+ut(r[e])+'"/>';return t+"</mergeCells>"}function Xx(r,t,e,i,n){var s=!1,a={},o=null;if(i.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[e];try{t.Workbook&&(c=t.Workbook.Sheets[e].CodeName||c)}catch{}s=!0,a.codeName=si(je(c))}if(r&&r["!outline"]){var l={summaryBelow:1,summaryRight:1};r["!outline"].above&&(l.summaryBelow=0),r["!outline"].left&&(l.summaryRight=0),o=(o||"")+ne("outlinePr",null,l)}!s&&!o||(n[n.length]=ne("sheetPr",o,a))}var jx=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Yx=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Kx(r){var t={sheet:1};return jx.forEach(function(e){r[e]!=null&&r[e]&&(t[e]="1")}),Yx.forEach(function(e){r[e]!=null&&!r[e]&&(t[e]="0")}),r.password&&(t.password=Lh(r.password).toString(16).toUpperCase()),ne("sheetProtection",null,t)}function qx(r){return Qh(r),ne("pageMargins",null,r)}function Zx(r,t){for(var e=["<cols>"],i,n=0;n!=t.length;++n)(i=t[n])&&(e[e.length]=ne("col",null,Pa(n,i)));return e[e.length]="</cols>",e.join("")}function Qx(r,t,e,i){var n=typeof r.ref=="string"?r.ref:ut(r.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var s=e.Workbook.Names,a=gr(n);a.s.r==a.e.r&&(a.e.r=gr(t["!ref"]).e.r,n=ut(a));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==i){c.Ref="'"+e.SheetNames[i]+"'!"+n;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+n}),ne("autoFilter",null,{ref:n})}function Jx(r,t,e,i){var n={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),ne("sheetViews",ne("sheetView",null,n),{})}function ev(r,t,e,i){if(r.c&&e["!comments"].push([t,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var n="",s=r.t,a=r.v;if(r.t!=="z")switch(r.t){case"b":n=r.v?"1":"0";break;case"n":n=""+r.v;break;case"e":n=ws[r.v];break;case"d":i&&i.cellDates?n=Xt(r.v,-1).toISOString():(r=nr(r),r.t="n",n=""+(r.v=ir(Xt(r.v)))),typeof r.z>"u"&&(r.z=ot[14]);break;default:n=r.v;break}var o=Mt("v",je(n)),c={r:t},l=Oi(i.cellXfs,r,i);switch(l!==0&&(c.s=l),r.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){o=Mt("v",""+ol(i.Strings,r.v,i.revStrings)),c.t="s";break}c.t="str";break}if(r.t!=s&&(r.t=s,r.v=a),typeof r.f=="string"&&r.f){var h=r.F&&r.F.slice(0,t.length)==t?{t:"array",ref:r.F}:null;o=ne("f",je(r.f),h)+(r.v!=null?o:"")}return r.l&&e["!links"].push([t,r.l]),r.D&&(c.cm=1),ne("c",o,c)}function tv(r,t,e,i){var n=[],s=[],a=et(r["!ref"]),o="",c,l="",h=[],u=0,f=0,p=r["!rows"],x=Array.isArray(r),d={r:l},g,I=-1;for(f=a.s.c;f<=a.e.c;++f)h[f]=Vt(f);for(u=a.s.r;u<=a.e.r;++u){for(s=[],l=Pt(u),f=a.s.c;f<=a.e.c;++f){c=h[f]+l;var O=x?(r[u]||[])[f]:r[c];O!==void 0&&(o=ev(O,c,r,t,e,i))!=null&&s.push(o)}(s.length>0||p&&p[u])&&(d={r:l},p&&p[u]&&(g=p[u],g.hidden&&(d.hidden=1),I=-1,g.hpx?I=ba(g.hpx):g.hpt&&(I=g.hpt),I>-1&&(d.ht=I,d.customHeight=1),g.level&&(d.outlineLevel=g.level)),n[n.length]=ne("row",s.join(""),d))}if(p)for(;u<p.length;++u)p&&p[u]&&(d={r:u+1},g=p[u],g.hidden&&(d.hidden=1),I=-1,g.hpx?I=ba(g.hpx):g.hpt&&(I=g.hpt),I>-1&&(d.ht=I,d.customHeight=1),g.level&&(d.outlineLevel=g.level),n[n.length]=ne("row","",d));return n.join("")}function Jh(r,t,e,i){var n=[ft,ne("worksheet",null,{xmlns:Fn[0],"xmlns:r":yt.r})],s=e.SheetNames[r],a=0,o="",c=e.Sheets[s];c==null&&(c={});var l=c["!ref"]||"A1",h=et(l);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),l=ut(h)}i||(i={}),c["!comments"]=[];var u=[];Xx(c,e,r,t,n),n[n.length]=ne("dimension",null,{ref:l}),n[n.length]=Jx(c,t,r,e),t.sheetFormat&&(n[n.length]=ne("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=Zx(c,c["!cols"])),n[a=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=tv(c,t,r,e,i),o.length>0&&(n[n.length]=o)),n.length>a+1&&(n[n.length]="</sheetData>",n[a]=n[a].replace("/>",">")),c["!protect"]&&(n[n.length]=Kx(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=Qx(c["!autofilter"],c,e,r)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=Gx(c["!merges"]));var f=-1,p,x=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(d){d[1].Target&&(p={ref:d[0]},d[1].Target.charAt(0)!="#"&&(x=Xe(i,-1,je(d[1].Target).replace(/#.*$/,""),Ve.HLINK),p["r:id"]="rId"+x),(f=d[1].Target.indexOf("#"))>-1&&(p.location=je(d[1].Target.slice(f+1))),d[1].Tooltip&&(p.tooltip=je(d[1].Tooltip)),n[n.length]=ne("hyperlink",null,p))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=qx(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=Mt("ignoredErrors",ne("ignoredError",null,{numberStoredAsText:1,sqref:l}))),u.length>0&&(x=Xe(i,-1,"../drawings/drawing"+(r+1)+".xml",Ve.DRAW),n[n.length]=ne("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=u),c["!comments"].length>0&&(x=Xe(i,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ve.VML),n[n.length]=ne("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function rv(r,t){var e={},i=r.l+t;e.r=r.read_shift(4),r.l+=4;var n=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=i,s&7&&(e.level=s&7),s&16&&(e.hidden=!0),s&32&&(e.hpt=n/20),e}function iv(r,t,e){var i=H(145),n=(e["!rows"]||[])[r]||{};i.write_shift(4,r),i.write_shift(4,0);var s=320;n.hpx?s=ba(n.hpx)*20:n.hpt&&(s=n.hpt*20),i.write_shift(2,s),i.write_shift(1,0);var a=0;n.level&&(a|=n.level),n.hidden&&(a|=16),(n.hpx||n.hpt)&&(a|=32),i.write_shift(1,a),i.write_shift(1,0);var o=0,c=i.l;i.l+=4;for(var l={r,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var u=-1,f=-1,p=h<<10;p<h+1<<10;++p){l.c=p;var x=Array.isArray(e)?(e[l.r]||[])[l.c]:e[Ye(l)];x&&(u<0&&(u=p),f=p)}u<0||(++o,i.write_shift(4,u),i.write_shift(4,f))}var d=i.l;return i.l=c,i.write_shift(4,o),i.l=d,i.length>i.l?i.slice(0,i.l):i}function nv(r,t,e,i){var n=iv(i,e,t);(n.length>17||(t["!rows"]||[])[i])&&K(r,0,n)}var sv=Ji,av=Dn;function ov(){}function lv(r,t){var e={},i=r[r.l];return++r.l,e.above=!(i&64),e.left=!(i&128),r.l+=18,e.name=vm(r,t-19),e}function cv(r,t,e){e==null&&(e=H(84+4*r.length));var i=192;t&&(t.above&&(i&=-65),t.left&&(i&=-129)),e.write_shift(1,i);for(var n=1;n<3;++n)e.write_shift(1,0);return _a({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),ph(r,e),e.slice(0,e.l)}function hv(r){var t=kr(r);return[t]}function uv(r,t,e){return e==null&&(e=H(8)),qi(t,e)}function fv(r){var t=Zi(r);return[t]}function dv(r,t,e){return e==null&&(e=H(4)),Qi(t,e)}function pv(r){var t=kr(r),e=r.read_shift(1);return[t,e,"b"]}function mv(r,t,e){return e==null&&(e=H(9)),qi(t,e),e.write_shift(1,r.v?1:0),e}function gv(r){var t=Zi(r),e=r.read_shift(1);return[t,e,"b"]}function xv(r,t,e){return e==null&&(e=H(5)),Qi(t,e),e.write_shift(1,r.v?1:0),e}function vv(r){var t=kr(r),e=r.read_shift(1);return[t,e,"e"]}function _v(r,t,e){return e==null&&(e=H(9)),qi(t,e),e.write_shift(1,r.v),e}function yv(r){var t=Zi(r),e=r.read_shift(1);return[t,e,"e"]}function wv(r,t,e){return e==null&&(e=H(8)),Qi(t,e),e.write_shift(1,r.v),e.write_shift(2,0),e.write_shift(1,0),e}function Cv(r){var t=kr(r),e=r.read_shift(4);return[t,e,"s"]}function bv(r,t,e){return e==null&&(e=H(12)),qi(t,e),e.write_shift(4,t.v),e}function Sv(r){var t=Zi(r),e=r.read_shift(4);return[t,e,"s"]}function Tv(r,t,e){return e==null&&(e=H(8)),Qi(t,e),e.write_shift(4,t.v),e}function Ev(r){var t=kr(r),e=Mn(r);return[t,e,"n"]}function kv(r,t,e){return e==null&&(e=H(16)),qi(t,e),ji(r.v,e),e}function Iv(r){var t=Zi(r),e=Mn(r);return[t,e,"n"]}function Fv(r,t,e){return e==null&&(e=H(12)),Qi(t,e),ji(r.v,e),e}function Ov(r){var t=kr(r),e=mh(r);return[t,e,"n"]}function Av(r,t,e){return e==null&&(e=H(12)),qi(t,e),gh(r.v,e),e}function Dv(r){var t=Zi(r),e=mh(r);return[t,e,"n"]}function Mv(r,t,e){return e==null&&(e=H(8)),Qi(t,e),gh(r.v,e),e}function Pv(r){var t=kr(r),e=Jo(r);return[t,e,"is"]}function Lv(r){var t=kr(r),e=Wt(r);return[t,e,"str"]}function Rv(r,t,e){return e==null&&(e=H(12+4*r.v.length)),qi(t,e),Ct(r.v,e),e.length>e.l?e.slice(0,e.l):e}function Nv(r){var t=Zi(r),e=Wt(r);return[t,e,"str"]}function Bv(r,t,e){return e==null&&(e=H(8+4*r.v.length)),Qi(t,e),Ct(r.v,e),e.length>e.l?e.slice(0,e.l):e}function Hv(r,t,e){var i=r.l+t,n=kr(r);n.r=e["!row"];var s=r.read_shift(1),a=[n,s,"b"];if(e.cellFormula){r.l+=2;var o=Ma(r,i-r.l,e);a[3]=In(o,null,n,e.supbooks,e)}else r.l=i;return a}function Vv(r,t,e){var i=r.l+t,n=kr(r);n.r=e["!row"];var s=r.read_shift(1),a=[n,s,"e"];if(e.cellFormula){r.l+=2;var o=Ma(r,i-r.l,e);a[3]=In(o,null,n,e.supbooks,e)}else r.l=i;return a}function Wv(r,t,e){var i=r.l+t,n=kr(r);n.r=e["!row"];var s=Mn(r),a=[n,s,"n"];if(e.cellFormula){r.l+=2;var o=Ma(r,i-r.l,e);a[3]=In(o,null,n,e.supbooks,e)}else r.l=i;return a}function $v(r,t,e){var i=r.l+t,n=kr(r);n.r=e["!row"];var s=Wt(r),a=[n,s,"str"];if(e.cellFormula){r.l+=2;var o=Ma(r,i-r.l,e);a[3]=In(o,null,n,e.supbooks,e)}else r.l=i;return a}var zv=Ji,Uv=Dn;function Gv(r,t){return t==null&&(t=H(4)),t.write_shift(4,r),t}function Xv(r,t){var e=r.l+t,i=Ji(r,16),n=el(r),s=Wt(r),a=Wt(r),o=Wt(r);r.l=e;var c={rfx:i,relId:n,loc:s,display:o};return a&&(c.Tooltip=a),c}function jv(r,t){var e=H(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));Dn({s:wt(r[0]),e:wt(r[0])},e),tl("rId"+t,e);var i=r[1].Target.indexOf("#"),n=i==-1?"":r[1].Target.slice(i+1);return Ct(n||"",e),Ct(r[1].Tooltip||"",e),Ct("",e),e.slice(0,e.l)}function Yv(){}function Kv(r,t,e){var i=r.l+t,n=xh(r,16),s=r.read_shift(1),a=[n];if(a[2]=s,e.cellFormula){var o=Nx(r,i-r.l,e);a[1]=o}else r.l=i;return a}function qv(r,t,e){var i=r.l+t,n=Ji(r,16),s=[n];if(e.cellFormula){var a=Hx(r,i-r.l,e);s[1]=a,r.l=i}else r.l=i;return s}function Zv(r,t,e){e==null&&(e=H(18));var i=Pa(r,t);e.write_shift(-4,r),e.write_shift(-4,r),e.write_shift(4,(i.width||10)*256),e.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof i.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),e.write_shift(2,n),e}var eu=["left","right","top","bottom","header","footer"];function Qv(r){var t={};return eu.forEach(function(e){t[e]=Mn(r,8)}),t}function Jv(r,t){return t==null&&(t=H(6*8)),Qh(r),eu.forEach(function(e){ji(r[e],t)}),t}function e_(r){var t=r.read_shift(2);return r.l+=28,{RTL:t&32}}function t_(r,t,e){e==null&&(e=H(30));var i=924;return(((t||{}).Views||[])[0]||{}).RTL&&(i|=32),e.write_shift(2,i),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function r_(r){var t=H(24);return t.write_shift(4,4),t.write_shift(4,1),Dn(r,t),t}function i_(r,t){return t==null&&(t=H(16*4+2)),t.write_shift(2,r.password?Lh(r.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?t.write_shift(4,r[e[0]]!=null&&!r[e[0]]?1:0):t.write_shift(4,r[e[0]]!=null&&r[e[0]]?0:1)}),t}function n_(){}function s_(){}function a_(r,t,e,i,n,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=nr(t),t.z=t.z||ot[14],t.v=ir(Xt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r:e,c:i};switch(c.s=Oi(n.cellXfs,t,n),t.l&&s["!links"].push([Ye(c),t.l]),t.c&&s["!comments"].push([Ye(c),t.c]),t.t){case"s":case"str":return n.bookSST?(o=ol(n.Strings,t.v,n.revStrings),c.t="s",c.v=o,a?K(r,18,Tv(t,c)):K(r,7,bv(t,c))):(c.t="str",a?K(r,17,Bv(t,c)):K(r,6,Rv(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?K(r,13,Mv(t,c)):K(r,2,Av(t,c)):a?K(r,16,Fv(t,c)):K(r,5,kv(t,c)),!0;case"b":return c.t="b",a?K(r,15,xv(t,c)):K(r,4,mv(t,c)),!0;case"e":return c.t="e",a?K(r,14,wv(t,c)):K(r,3,_v(t,c)),!0}return a?K(r,12,dv(t,c)):K(r,1,uv(t,c)),!0}function o_(r,t,e,i){var n=et(t["!ref"]||"A1"),s,a="",o=[];K(r,145);var c=Array.isArray(t),l=n.e.r;t["!rows"]&&(l=Math.max(n.e.r,t["!rows"].length-1));for(var h=n.s.r;h<=l;++h){a=Pt(h),nv(r,t,n,h);var u=!1;if(h<=n.e.r)for(var f=n.s.c;f<=n.e.c;++f){h===n.s.r&&(o[f]=Vt(f)),s=o[f]+a;var p=c?(t[h]||[])[f]:t[s];if(!p){u=!1;continue}u=a_(r,p,h,f,i,t,u)}}K(r,146)}function l_(r,t){!t||!t["!merges"]||(K(r,177,Gv(t["!merges"].length)),t["!merges"].forEach(function(e){K(r,176,Uv(e))}),K(r,178))}function c_(r,t){!t||!t["!cols"]||(K(r,390),t["!cols"].forEach(function(e,i){e&&K(r,60,Zv(i,e))}),K(r,391))}function h_(r,t){!t||!t["!ref"]||(K(r,648),K(r,649,r_(et(t["!ref"]))),K(r,650))}function u_(r,t,e){t["!links"].forEach(function(i){if(i[1].Target){var n=Xe(e,-1,i[1].Target.replace(/#.*$/,""),Ve.HLINK);K(r,494,jv(i,n))}}),delete t["!links"]}function f_(r,t,e,i){if(t["!comments"].length>0){var n=Xe(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ve.VML);K(r,551,tl("rId"+n)),t["!legacy"]=n}}function d_(r,t,e,i){if(t["!autofilter"]){var n=t["!autofilter"],s=typeof n.ref=="string"?n.ref:ut(n.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,o=gr(s);o.s.r==o.e.r&&(o.e.r=gr(t["!ref"]).e.r,s=ut(o));for(var c=0;c<a.length;++c){var l=a[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==i){l.Ref="'"+e.SheetNames[i]+"'!"+s;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+s}),K(r,161,Dn(et(s))),K(r,162)}}function p_(r,t,e){K(r,133),K(r,137,t_(t,e)),K(r,138),K(r,134)}function m_(r,t){t["!protect"]&&K(r,535,i_(t["!protect"]))}function g_(r,t,e,i){var n=rr(),s=e.SheetNames[r],a=e.Sheets[s]||{},o=s;try{e&&e.Workbook&&(o=e.Workbook.Sheets[r].CodeName||o)}catch{}var c=et(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],K(n,129),(e.vbaraw||a["!outline"])&&K(n,147,cv(o,a["!outline"])),K(n,148,av(c)),p_(n,a,e.Workbook),c_(n,a,r,t,e),o_(n,a,r,t,e),m_(n,a),d_(n,a,e,r),l_(n,a),u_(n,a,i),a["!margins"]&&K(n,476,Jv(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&h_(n,a),f_(n,a,r,i),K(n,130),n.end()}function x_(r,t){r.l+=10;var e=Wt(r,t-10);return{name:e}}var v_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function __(r){return!r.Workbook||!r.Workbook.WBProps?"false":Kp(r.Workbook.WBProps.date1904)?"true":"false"}var y_="][*?/\\".split("");function tu(r,t){if(r.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var e=!0;return y_.forEach(function(i){if(r.indexOf(i)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");e=!1}}),e}function w_(r,t,e){r.forEach(function(i,n){tu(i);for(var s=0;s<n;++s)if(i==r[s])throw new Error("Duplicate Sheet Name: "+i);if(e){var a=t&&t[n]&&t[n].CodeName||i;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function C_(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var t=r.Workbook&&r.Workbook.Sheets||[];w_(r.SheetNames,t,!!r.vbaraw);for(var e=0;e<r.SheetNames.length;++e)Ux(r.Sheets[r.SheetNames[e]],r.SheetNames[e],e)}function ru(r){var t=[ft];t[t.length]=ne("workbook",null,{xmlns:Fn[0],"xmlns:r":yt.r});var e=r.Workbook&&(r.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(v_.forEach(function(o){r.Workbook.WBProps[o[0]]!=null&&r.Workbook.WBProps[o[0]]!=o[1]&&(i[o[0]]=r.Workbook.WBProps[o[0]])}),r.Workbook.WBProps.CodeName&&(i.codeName=r.Workbook.WBProps.CodeName,delete i.CodeName)),t[t.length]=ne("workbookPr",null,i);var n=r.Workbook&&r.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==r.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var a={name:je(r.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=ne("sheet",null,a)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=ne("definedName",je(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function b_(r,t){var e={};return e.Hidden=r.read_shift(4),e.iTabID=r.read_shift(4),e.strRelID=No(r,t-8),e.name=Wt(r),e}function S_(r,t){return t||(t=H(127)),t.write_shift(4,r.Hidden),t.write_shift(4,r.iTabID),tl(r.strRelID,t),Ct(r.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function T_(r,t){var e={},i=r.read_shift(4);e.defaultThemeVersion=r.read_shift(4);var n=t>8?Wt(r):"";return n.length>0&&(e.CodeName=n),e.autoCompressPictures=!!(i&65536),e.backupFile=!!(i&64),e.checkCompatibility=!!(i&4096),e.date1904=!!(i&1),e.filterPrivacy=!!(i&8),e.hidePivotFieldList=!!(i&1024),e.promptedSolutions=!!(i&16),e.publishItems=!!(i&2048),e.refreshAllConnections=!!(i&262144),e.saveExternalLinkValues=!!(i&128),e.showBorderUnselectedTables=!!(i&4),e.showInkAnnotation=!!(i&32),e.showObjects=["all","placeholders","none"][i>>13&3],e.showPivotChartFilter=!!(i&32768),e.updateLinks=["userSet","never","always"][i>>8&3],e}function E_(r,t){t||(t=H(72));var e=0;return r&&r.filterPrivacy&&(e|=8),t.write_shift(4,e),t.write_shift(4,0),ph(r&&r.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function k_(r,t,e){var i=r.l+t;r.l+=4,r.l+=1;var n=r.read_shift(4),s=_m(r),a=Bx(r,0,e),o=el(r);r.l=i;var c={Name:s,Ptg:a};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function I_(r,t){K(r,143);for(var e=0;e!=t.SheetNames.length;++e){var i=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[e]&&t.Workbook.Sheets[e].Hidden||0,n={Hidden:i,iTabID:e+1,strRelID:"rId"+(e+1),name:t.SheetNames[e]};K(r,156,S_(n))}K(r,144)}function F_(r,t){t||(t=H(127));for(var e=0;e!=4;++e)t.write_shift(4,0);return Ct("SheetJS",t),Ct(fs.version,t),Ct(fs.version,t),Ct("7262",t),t.length>t.l?t.slice(0,t.l):t}function O_(r,t){t||(t=H(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,r),t.write_shift(4,r);var e=120;return t.write_shift(1,e),t.length>t.l?t.slice(0,t.l):t}function A_(r,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var e=t.Workbook.Sheets,i=0,n=-1,s=-1;i<e.length;++i)!e[i]||!e[i].Hidden&&n==-1?n=i:e[i].Hidden==1&&s==-1&&(s=i);s>n||(K(r,135),K(r,158,O_(n)),K(r,136))}}function D_(r,t){var e=rr();return K(e,131),K(e,128,F_()),K(e,153,E_(r.Workbook&&r.Workbook.WBProps||null)),A_(e,r,t),I_(e,r,t),K(e,132),e.end()}function M_(r,t,e){return(t.slice(-4)===".bin"?D_:ru)(r,e)}function P_(r,t,e,i,n){return(t.slice(-4)===".bin"?g_:Jh)(r,e,i,n)}function L_(r,t,e){return(t.slice(-4)===".bin"?Jg:Bh)(r,e)}function R_(r,t,e){return(t.slice(-4)===".bin"?Eg:Ph)(r,e)}function N_(r,t,e){return(t.slice(-4)===".bin"?m1:zh)(r,e)}function B_(r){return(r.slice(-4)===".bin"?o1:Wh)()}function H_(r,t){var e=[];return r.Props&&e.push(Lm(r.Props,t)),r.Custprops&&e.push(Rm(r.Props,r.Custprops,t)),e.join("")}function V_(){return""}function W_(r,t){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(i,n){var s=[];s.push(ne("NumberFormat",null,{"ss:Format":je(ot[i.numFmtId])}));var a={"ss:ID":"s"+(21+n)};e.push(ne("Style",s.join(""),a))}),ne("Styles",e.join(""))}function iu(r){return ne("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+sl(r.Ref,{r:0,c:0})})}function $_(r){if(!((r||{}).Workbook||{}).Names)return"";for(var t=r.Workbook.Names,e=[],i=0;i<t.length;++i){var n=t[i];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||e.push(iu(n)))}return ne("Names",e.join(""))}function z_(r,t,e,i){if(!r||!((i||{}).Workbook||{}).Names)return"";for(var n=i.Workbook.Names,s=[],a=0;a<n.length;++a){var o=n[a];o.Sheet==e&&(o.Name.match(/^_xlfn\./)||s.push(iu(o)))}return s.join("")}function U_(r,t,e,i){if(!r)return"";var n=[];if(r["!margins"]&&(n.push("<PageSetup>"),r["!margins"].header&&n.push(ne("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&n.push(ne("Footer",null,{"x:Margin":r["!margins"].footer})),n.push(ne("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),n.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[e])if(i.Workbook.Sheets[e].Hidden)n.push(ne("Visible",i.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<e&&!(i.Workbook.Sheets[s]&&!i.Workbook.Sheets[s].Hidden);++s);s==e&&n.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),r["!protect"]&&(n.push(Mt("ProtectContents","True")),r["!protect"].objects&&n.push(Mt("ProtectObjects","True")),r["!protect"].scenarios&&n.push(Mt("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?n.push(Mt("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&n.push(Mt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){r["!protect"][a[0]]&&n.push("<"+a[1]+"/>")})),n.length==0?"":ne("WorksheetOptions",n.join(""),{xmlns:mr.x})}function G_(r){return r.map(function(t){var e=Yp(t.t||""),i=ne("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return ne("Comment",i,{"ss:Author":t.a})}).join("")}function X_(r,t,e,i,n,s,a){if(!r||r.v==null&&r.f==null)return"";var o={};if(r.f&&(o["ss:Formula"]="="+je(sl(r.f,a))),r.F&&r.F.slice(0,t.length)==t){var c=wt(r.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(r.l&&r.l.Target&&(o["ss:HRef"]=je(r.l.Target),r.l.Tooltip&&(o["x:HRefScreenTip"]=je(r.l.Tooltip))),e["!merges"])for(var l=e["!merges"],h=0;h!=l.length;++h)l[h].s.c!=a.c||l[h].s.r!=a.r||(l[h].e.c>l[h].s.c&&(o["ss:MergeAcross"]=l[h].e.c-l[h].s.c),l[h].e.r>l[h].s.r&&(o["ss:MergeDown"]=l[h].e.r-l[h].s.r));var u="",f="";switch(r.t){case"z":if(!i.sheetStubs)return"";break;case"n":u="Number",f=String(r.v);break;case"b":u="Boolean",f=r.v?"1":"0";break;case"e":u="Error",f=ws[r.v];break;case"d":u="DateTime",f=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||ot[14]);break;case"s":u="String",f=jp(r.v||"");break}var p=Oi(i.cellXfs,r,i);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=a.c+1;var x=r.v!=null?f:"",d=r.t=="z"?"":'<Data ss:Type="'+u+'">'+x+"</Data>";return(r.c||[]).length>0&&(d+=G_(r.c)),ne("Cell",d,o)}function j_(r,t){var e='<Row ss:Index="'+(r+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Nh(t.hpt)),t.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(e+=' ss:Hidden="1"')),e+">"}function Y_(r,t,e,i){if(!r["!ref"])return"";var n=et(r["!ref"]),s=r["!merges"]||[],a=0,o=[];r["!cols"]&&r["!cols"].forEach(function(g,I){il(g);var O=!!g.width,A=Pa(I,g),V={"ss:Index":I+1};O&&(V["ss:Width"]=wa(A.width)),g.hidden&&(V["ss:Hidden"]="1"),o.push(ne("Column",null,V))});for(var c=Array.isArray(r),l=n.s.r;l<=n.e.r;++l){for(var h=[j_(l,(r["!rows"]||[])[l])],u=n.s.c;u<=n.e.c;++u){var f=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>u)&&!(s[a].s.r>l)&&!(s[a].e.c<u)&&!(s[a].e.r<l)){(s[a].s.c!=u||s[a].s.r!=l)&&(f=!0);break}if(!f){var p={r:l,c:u},x=Ye(p),d=c?(r[l]||[])[u]:r[x];h.push(X_(d,x,r,t,e,i,p))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function K_(r,t,e){var i=[],n=e.SheetNames[r],s=e.Sheets[n],a=s?z_(s,t,r,e):"";return a.length>0&&i.push("<Names>"+a+"</Names>"),a=s?Y_(s,t,r,e):"",a.length>0&&i.push("<Table>"+a+"</Table>"),i.push(U_(s,t,r,e)),i.join("")}function q_(r,t){t||(t={}),r.SSF||(r.SSF=nr(ot)),r.SSF&&(Ia(),ka(r.SSF),t.revssf=Fa(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF,t.cellXfs=[],Oi(t.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(H_(r,t)),e.push(V_(r,t)),e.push(""),e.push("");for(var i=0;i<r.SheetNames.length;++i)e.push(ne("Worksheet",K_(i,t,r),{"ss:Name":je(r.SheetNames[i])}));return e[2]=W_(r,t),e[3]=$_(r,t),ft+ne("Workbook",e.join(""),{xmlns:mr.ss,"xmlns:o":mr.o,"xmlns:x":mr.x,"xmlns:ss":mr.ss,"xmlns:dt":mr.dt,"xmlns:html":mr.html})}var Do={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Z_(r,t){var e=[],i=[],n=[],s=0,a,o=c0(C0,"n"),c=c0(b0,"n");if(r.Props)for(a=Lt(r.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?e:Object.prototype.hasOwnProperty.call(c,a[s])?i:n).push([a[s],r.Props[a[s]]]);if(r.Custprops)for(a=Lt(r.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?e:Object.prototype.hasOwnProperty.call(c,a[s])?i:n).push([a[s],r.Custprops[a[s]]]);var l=[];for(s=0;s<n.length;++s)kh.indexOf(n[s][0])>-1||Sh.indexOf(n[s][0])>-1||n[s][1]!=null&&l.push(n[s]);i.length&&qe.utils.cfb_add(t,"/SummaryInformation",I0(i,Do.SI,c,b0)),(e.length||l.length)&&qe.utils.cfb_add(t,"/DocumentSummaryInformation",I0(e,Do.DSI,o,C0,l.length?l:null,Do.UDI))}function Q_(r,t){var e=t||{},i=qe.utils.cfb_new({root:"R"}),n="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":n="/Workbook",e.biff=8;break;case"biff5":n="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return qe.utils.cfb_add(i,n,nu(r,e)),e.biff==8&&(r.Props||r.Custprops)&&Z_(r,i),e.biff==8&&r.vbaraw&&g1(i,qe.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),i}var J_={0:{f:rv},1:{f:hv},2:{f:Ov},3:{f:vv},4:{f:pv},5:{f:Ev},6:{f:Lv},7:{f:Cv},8:{f:$v},9:{f:Wv},10:{f:Hv},11:{f:Vv},12:{f:fv},13:{f:Dv},14:{f:yv},15:{f:gv},16:{f:Iv},17:{f:Nv},18:{f:Sv},19:{f:Jo},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:k_},40:{},42:{},43:{f:Lg},44:{f:Mg},45:{f:Bg},46:{f:Vg},47:{f:Hg},48:{},49:{f:fm},50:{},51:{f:r1},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:dg},62:{f:Pv},63:{f:l1},64:{f:n_},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Yr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:e_},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:lv},148:{f:sv,p:16},151:{f:Yv},152:{},153:{f:T_},154:{},155:{},156:{f:b_},157:{},158:{},159:{T:1,f:bg},160:{T:-1},161:{T:1,f:Ji},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:zv},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:e1},336:{T:-1},337:{f:s1,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:No},357:{},358:{},359:{},360:{T:1},361:{},362:{f:og},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Kv},427:{f:qv},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Qv},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:ov},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Xv},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:No},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:d1},633:{T:1},634:{T:-1},635:{T:1,f:u1},636:{T:-1},637:{f:gm},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:x_},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:s_},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function se(r,t,e,i){var n=t;if(!isNaN(n)){var s=i||(e||[]).length||0,a=r.next(4);a.write_shift(2,n),a.write_shift(2,s),s>0&&qo(e)&&r.push(e)}}function ey(r,t,e,i){var n=i||(e||[]).length||0;if(n<=8224)return se(r,t,e,n);var s=t;if(!isNaN(s)){for(var a=e.parts||[],o=0,c=0,l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;var h=r.next(4);for(h.write_shift(2,s),h.write_shift(2,l),r.push(e.slice(c,c+l)),c+=l;c<n;){for(h=r.next(4),h.write_shift(2,60),l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;h.write_shift(2,l),r.push(e.slice(c,c+l)),c+=l}}}function bs(r,t,e){return r||(r=H(7)),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,0),r.write_shift(1,0),r}function ty(r,t,e,i){var n=H(9);return bs(n,r,t),Fh(e,i||"b",n),n}function ry(r,t,e){var i=H(8+2*e.length);return bs(i,r,t),i.write_shift(1,e.length),i.write_shift(e.length,e,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function iy(r,t,e,i){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?ir(Xt(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?se(r,2,xg(e,i,n)):se(r,3,gg(e,i,n));return;case"b":case"e":se(r,5,ty(e,i,t.v,t.t));return;case"s":case"str":se(r,4,ry(e,i,(t.v||"").slice(0,255)));return}se(r,1,bs(null,e,i))}function ny(r,t,e,i){var n=Array.isArray(t),s=et(t["!ref"]||"A1"),a,o="",c=[];if(s.e.c>255||s.e.r>16383){if(i.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=ut(s)}for(var l=s.s.r;l<=s.e.r;++l){o=Pt(l);for(var h=s.s.c;h<=s.e.c;++h){l===s.s.r&&(c[h]=Vt(h)),a=c[h]+o;var u=n?(t[l]||[])[h]:t[a];u&&iy(r,u,l,h,i)}}}function sy(r,t){var e=t||{};jr!=null&&e.dense==null&&(e.dense=jr);for(var i=rr(),n=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==e.sheet&&(n=s);if(n==0&&e.sheet&&r.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return se(i,e.biff==4?1033:e.biff==3?521:9,rl(r,16,e)),ny(i,r.Sheets[r.SheetNames[n]],n,e,r),se(i,10),i.end()}function ay(r,t,e){se(r,49,Jm({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},e))}function oy(r,t,e){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)t[n]!=null&&se(r,1054,rg(n,t[n],e))})}function ly(r,t){var e=H(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),se(r,2151,e),e=H(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),Dh(et(t["!ref"]||"A1"),e),e.write_shift(4,4),se(r,2152,e)}function cy(r,t){for(var e=0;e<16;++e)se(r,224,O0({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(i){se(r,224,O0(i,0,t))})}function hy(r,t){for(var e=0;e<t["!links"].length;++e){var i=t["!links"][e];se(r,440,hg(i)),i[1].Tooltip&&se(r,2048,ug(i))}delete t["!links"]}function uy(r,t){if(t){var e=0;t.forEach(function(i,n){++e<=256&&i&&se(r,125,pg(Pa(n,i),n))})}}function fy(r,t,e,i,n){var s=16+Oi(n.cellXfs,t,n);if(t.v==null&&!t.bf){se(r,513,Yi(e,i,s));return}if(t.bf)se(r,6,Rx(t,e,i,n,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?ir(Xt(t.v)):t.v;se(r,515,ag(e,i,a,s,n));break;case"b":case"e":se(r,517,sg(e,i,t.v,s,n,t.t));break;case"s":case"str":if(n.bookSST){var o=ol(n.Strings,t.v,n.revStrings);se(r,253,eg(e,i,o,s,n))}else se(r,516,tg(e,i,(t.v||"").slice(0,255),s,n));break;default:se(r,513,Yi(e,i,s))}}function dy(r,t,e){var i=rr(),n=e.SheetNames[r],s=e.Sheets[n]||{},a=(e||{}).Workbook||{},o=(a.Sheets||[])[r]||{},c=Array.isArray(s),l=t.biff==8,h,u="",f=[],p=et(s["!ref"]||"A1"),x=l?65536:16384;if(p.e.c>255||p.e.r>=x){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}se(i,2057,rl(e,16,t)),se(i,13,Er(1)),se(i,12,Er(100)),se(i,15,Gt(!0)),se(i,17,Gt(!1)),se(i,16,ji(.001)),se(i,95,Gt(!0)),se(i,42,Gt(!1)),se(i,43,Gt(!1)),se(i,130,Er(1)),se(i,128,ng([0,0])),se(i,131,Gt(!1)),se(i,132,Gt(!1)),l&&uy(i,s["!cols"]),se(i,512,ig(p,t)),l&&(s["!links"]=[]);for(var d=p.s.r;d<=p.e.r;++d){u=Pt(d);for(var g=p.s.c;g<=p.e.c;++g){d===p.s.r&&(f[g]=Vt(g)),h=f[g]+u;var I=c?(s[d]||[])[g]:s[h];I&&(fy(i,I,d,g,t),l&&I.l&&s["!links"].push([h,I.l]))}}var O=o.CodeName||o.name||n;return l&&se(i,574,Qm((a.Views||[])[0])),l&&(s["!merges"]||[]).length&&se(i,229,cg(s["!merges"])),l&&hy(i,s),se(i,442,Ah(O,t)),l&&ly(i,s),se(i,10),i.end()}function py(r,t,e){var i=rr(),n=(r||{}).Workbook||{},s=n.Sheets||[],a=n.WBProps||{},o=e.biff==8,c=e.biff==5;if(se(i,2057,rl(r,5,e)),e.bookType=="xla"&&se(i,135),se(i,225,o?Er(1200):null),se(i,193,Hm(2)),c&&se(i,191),c&&se(i,192),se(i,226),se(i,92,Ym("SheetJS",e)),se(i,66,Er(o?1200:1252)),o&&se(i,353,Er(0)),o&&se(i,448),se(i,317,mg(r.SheetNames.length)),o&&r.vbaraw&&se(i,211),o&&r.vbaraw){var l=a.CodeName||"ThisWorkbook";se(i,442,Ah(l,e))}se(i,156,Er(17)),se(i,25,Gt(!1)),se(i,18,Gt(!1)),se(i,19,Er(0)),o&&se(i,431,Gt(!1)),o&&se(i,444,Er(0)),se(i,61,Zm(e)),se(i,64,Gt(!1)),se(i,141,Er(0)),se(i,34,Gt(__(r)=="true")),se(i,14,Gt(!0)),o&&se(i,439,Gt(!1)),se(i,218,Er(0)),ay(i,r,e),oy(i,r.SSF,e),cy(i,e),o&&se(i,352,Gt(!1));var h=i.end(),u=rr();o&&se(u,140,fg()),o&&e.Strings&&ey(u,252,qm(e.Strings,e)),se(u,10);var f=u.end(),p=rr(),x=0,d=0;for(d=0;d<r.SheetNames.length;++d)x+=(o?12:11)+(o?2:1)*r.SheetNames[d].length;var g=h.length+x+f.length;for(d=0;d<r.SheetNames.length;++d){var I=s[d]||{};se(p,133,Km({pos:g,hs:I.Hidden||0,dt:0,name:r.SheetNames[d]},e)),g+=t[d].length}var O=p.end();if(x!=O.length)throw new Error("BS8 "+x+" != "+O.length);var A=[];return h.length&&A.push(h),O.length&&A.push(O),f.length&&A.push(f),Dt(A)}function my(r,t){var e=t||{},i=[];r&&!r.SSF&&(r.SSF=nr(ot)),r&&r.SSF&&(Ia(),ka(r.SSF),e.revssf=Fa(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ll(e),e.cellXfs=[],Oi(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var n=0;n<r.SheetNames.length;++n)i[i.length]=dy(n,e,r);return i.unshift(py(r,i,e)),Dt(i)}function nu(r,t){for(var e=0;e<=r.SheetNames.length;++e){var i=r.Sheets[r.SheetNames[e]];if(!(!i||!i["!ref"])){var n=gr(i["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return my(r,t);case 4:case 3:case 2:return sy(r,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function gy(r,t,e,i){for(var n=r["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,c=0,l=0;l<n.length;++l)if(!(n[l].s.r>e||n[l].s.c>a)&&!(n[l].e.r<e||n[l].e.c<a)){if(n[l].s.r<e||n[l].s.c<a){o=-1;break}o=n[l].e.r-n[l].s.r+1,c=n[l].e.c-n[l].s.c+1;break}if(!(o<0)){var h=Ye({r:e,c:a}),u=i.dense?(r[e]||[])[a]:r[h],f=u&&u.v!=null&&(u.h||Xp(u.w||(hi(u),u.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),i.editable?f='<span contenteditable="true">'+f+"</span>":u&&(p["data-t"]=u&&u.t||"z",u.v!=null&&(p["data-v"]=u.v),u.z!=null&&(p["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+u.l.Target+'">'+f+"</a>")),p.id=(i.id||"sjs")+"-"+h,s.push(ne("td",f,p))}}var x="<tr>";return x+s.join("")+"</tr>"}var xy='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',vy="</body></html>";function _y(r,t,e){var i=[];return i.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function su(r,t){var e=t||{},i=e.header!=null?e.header:xy,n=e.footer!=null?e.footer:vy,s=[i],a=gr(r["!ref"]);e.dense=Array.isArray(r),s.push(_y(r,a,e));for(var o=a.s.r;o<=a.e.r;++o)s.push(gy(r,a,o,e));return s.push("</table>"+n),s.join("")}function au(r,t,e){var i=e||{};jr!=null&&(i.dense=jr);var n=0,s=0;if(i.origin!=null)if(typeof i.origin=="number")n=i.origin;else{var a=typeof i.origin=="string"?wt(i.origin):i.origin;n=a.r,s=a.c}var o=t.getElementsByTagName("tr"),c=Math.min(i.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:n,c:s}};if(r["!ref"]){var h=gr(r["!ref"]);l.s.r=Math.min(l.s.r,h.s.r),l.s.c=Math.min(l.s.c,h.s.c),l.e.r=Math.max(l.e.r,h.e.r),l.e.c=Math.max(l.e.c,h.e.c),n==-1&&(l.e.r=n=h.e.r+1)}var u=[],f=0,p=r["!rows"]||(r["!rows"]=[]),x=0,d=0,g=0,I=0,O=0,A=0;for(r["!cols"]||(r["!cols"]=[]);x<o.length&&d<c;++x){var V=o[x];if(N0(V)){if(i.display)continue;p[d]={hidden:!0}}var q=V.children;for(g=I=0;g<q.length;++g){var ie=q[g];if(!(i.display&&N0(ie))){var D=ie.hasAttribute("data-v")?ie.getAttribute("data-v"):ie.hasAttribute("v")?ie.getAttribute("v"):qp(ie.innerHTML),Y=ie.getAttribute("data-z")||ie.getAttribute("z");for(f=0;f<u.length;++f){var z=u[f];z.s.c==I+s&&z.s.r<d+n&&d+n<=z.e.r&&(I=z.e.c+1-s,f=-1)}A=+ie.getAttribute("colspan")||1,((O=+ie.getAttribute("rowspan")||1)>1||A>1)&&u.push({s:{r:d+n,c:I+s},e:{r:d+n+(O||1)-1,c:I+s+(A||1)-1}});var j={t:"s",v:D},Q=ie.getAttribute("data-t")||ie.getAttribute("t")||"";D!=null&&(D.length==0?j.t=Q||"z":i.raw||D.trim().length==0||Q=="s"||(D==="TRUE"?j={t:"b",v:!0}:D==="FALSE"?j={t:"b",v:!1}:isNaN(oi(D))?isNaN(ms(D).getDate())||(j={t:"d",v:Xt(D)},i.cellDates||(j={t:"n",v:ir(j.v)}),j.z=i.dateNF||ot[14]):j={t:"n",v:oi(D)})),j.z===void 0&&Y!=null&&(j.z=Y);var te="",ge=ie.getElementsByTagName("A");if(ge&&ge.length)for(var ze=0;ze<ge.length&&!(ge[ze].hasAttribute("href")&&(te=ge[ze].getAttribute("href"),te.charAt(0)!="#"));++ze);te&&te.charAt(0)!="#"&&(j.l={Target:te}),i.dense?(r[d+n]||(r[d+n]=[]),r[d+n][I+s]=j):r[Ye({c:I+s,r:d+n})]=j,l.e.c<I+s&&(l.e.c=I+s),I+=A}}++d}return u.length&&(r["!merges"]=(r["!merges"]||[]).concat(u)),l.e.r=Math.max(l.e.r,d-1+n),r["!ref"]=ut(l),d>=c&&(r["!fullref"]=ut((l.e.r=o.length-x+d-1+n,l))),r}function ou(r,t){var e=t||{},i=e.dense?[]:{};return au(i,r,t)}function yy(r,t){return Ki(ou(r,t),t)}function N0(r){var t="",e=wy(r);return e&&(t=e(r).getPropertyValue("display")),t||(t=r.style&&r.style.display),t==="none"}function wy(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Cy=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+gs({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return ft+t}}(),B0=function(){var r=function(s){return je(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,i=function(s,a,o){var c=[];c.push('      <table:table table:name="'+je(a.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,h=0,u=gr(s["!ref"]||"A1"),f=s["!merges"]||[],p=0,x=Array.isArray(s);if(s["!cols"])for(h=0;h<=u.e.c;++h)c.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var d="",g=s["!rows"]||[];for(l=0;l<u.s.r;++l)d=g[l]?' table:style-name="ro'+g[l].ods+'"':"",c.push("        <table:table-row"+d+`></table:table-row>
`);for(;l<=u.e.r;++l){for(d=g[l]?' table:style-name="ro'+g[l].ods+'"':"",c.push("        <table:table-row"+d+`>
`),h=0;h<u.s.c;++h)c.push(t);for(;h<=u.e.c;++h){var I=!1,O={},A="";for(p=0;p!=f.length;++p)if(!(f[p].s.c>h)&&!(f[p].s.r>l)&&!(f[p].e.c<h)&&!(f[p].e.r<l)){(f[p].s.c!=h||f[p].s.r!=l)&&(I=!0),O["table:number-columns-spanned"]=f[p].e.c-f[p].s.c+1,O["table:number-rows-spanned"]=f[p].e.r-f[p].s.r+1;break}if(I){c.push(e);continue}var V=Ye({r:l,c:h}),q=x?(s[l]||[])[h]:s[V];if(q&&q.f&&(O["table:formula"]=je($x(q.f)),q.F&&q.F.slice(0,V.length)==V)){var ie=gr(q.F);O["table:number-matrix-columns-spanned"]=ie.e.c-ie.s.c+1,O["table:number-matrix-rows-spanned"]=ie.e.r-ie.s.r+1}if(!q){c.push(t);continue}switch(q.t){case"b":A=q.v?"TRUE":"FALSE",O["office:value-type"]="boolean",O["office:boolean-value"]=q.v?"true":"false";break;case"n":A=q.w||String(q.v||0),O["office:value-type"]="float",O["office:value"]=q.v||0;break;case"s":case"str":A=q.v==null?"":q.v,O["office:value-type"]="string";break;case"d":A=q.w||Xt(q.v).toISOString(),O["office:value-type"]="date",O["office:date-value"]=Xt(q.v).toISOString(),O["table:style-name"]="ce1";break;default:c.push(t);continue}var D=r(A);if(q.l&&q.l.Target){var Y=q.l.Target;Y=Y.charAt(0)=="#"?"#"+zx(Y.slice(1)):Y,Y.charAt(0)!="#"&&!Y.match(/^\w+:/)&&(Y="../"+Y),D=ne("text:a",D,{"xlink:href":Y.replace(/&/g,"&amp;")})}c.push("          "+ne("table:table-cell",ne("text:p",D,{}),O)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var h=0;h<l["!cols"].length;++h)if(l["!cols"][h]){var u=l["!cols"][h];if(u.width==null&&u.wpx==null&&u.wch==null)continue;il(u),u.ods=o;var f=l["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var h=0;h<l["!rows"].length;++h)if(l["!rows"][h]){l["!rows"][h].ods=c;var u=l["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+u+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var c=[ft],l=gs({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=gs({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+h+`>
`),c.push(Ch().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),n(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var u=0;u!=a.SheetNames.length;++u)c.push(i(a.Sheets[a.SheetNames[u]],a,u,o));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function lu(r,t){if(t.bookType=="fods")return B0(r,t);var e=$o(),i="",n=[],s=[];return i="mimetype",De(e,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",De(e,i,B0(r,t)),n.push([i,"text/xml"]),s.push([i,"ContentFile"]),i="styles.xml",De(e,i,Cy(r,t)),n.push([i,"text/xml"]),s.push([i,"StylesFile"]),i="meta.xml",De(e,i,ft+Ch()),n.push([i,"text/xml"]),s.push([i,"MetadataFile"]),i="manifest.rdf",De(e,i,Pm(s)),n.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",De(e,i,Dm(n)),e}function Sa(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function by(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):Nr(si(r))}function Sy(r,t){e:for(var e=0;e<=r.length-t.length;++e){for(var i=0;i<t.length;++i)if(r[e+i]!=t[i])continue e;return!0}return!1}function Fi(r){var t=r.reduce(function(n,s){return n+s.length},0),e=new Uint8Array(t),i=0;return r.forEach(function(n){e.set(n,i),i+=n.length}),e}function Ty(r,t,e){var i=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,n=e/Math.pow(10,i-6176);r[t+15]|=i>>7,r[t+14]|=(i&127)<<1;for(var s=0;n>=1;++s,n/=256)r[t+s]=n&255;r[t+15]|=e>=0?0:128}function xs(r,t){var e=t?t[0]:0,i=r[e]&127;e:if(r[e++]>=128&&(i|=(r[e]&127)<<7,r[e++]<128||(i|=(r[e]&127)<<14,r[e++]<128)||(i|=(r[e]&127)<<21,r[e++]<128)||(i+=(r[e]&127)*Math.pow(2,28),++e,r[e++]<128)||(i+=(r[e]&127)*Math.pow(2,35),++e,r[e++]<128)||(i+=(r[e]&127)*Math.pow(2,42),++e,r[e++]<128)))break e;return t&&(t[0]=e),i}function Ge(r){var t=new Uint8Array(7);t[0]=r&127;var e=1;e:if(r>127){if(t[e-1]|=128,t[e]=r>>7&127,++e,r<=16383||(t[e-1]|=128,t[e]=r>>14&127,++e,r<=2097151)||(t[e-1]|=128,t[e]=r>>21&127,++e,r<=268435455)||(t[e-1]|=128,t[e]=r/256>>>21&127,++e,r<=34359738367)||(t[e-1]|=128,t[e]=r/65536>>>21&127,++e,r<=4398046511103))break e;t[e-1]|=128,t[e]=r/16777216>>>21&127,++e}return t.slice(0,e)}function En(r){var t=0,e=r[t]&127;e:if(r[t++]>=128){if(e|=(r[t]&127)<<7,r[t++]<128||(e|=(r[t]&127)<<14,r[t++]<128)||(e|=(r[t]&127)<<21,r[t++]<128))break e;e|=(r[t]&127)<<28}return e}function dt(r){for(var t=[],e=[0];e[0]<r.length;){var i=e[0],n=xs(r,e),s=n&7;n=Math.floor(n/8);var a=0,o;if(n==0)break;switch(s){case 0:{for(var c=e[0];r[e[0]++]>=128;);o=r.slice(c,e[0])}break;case 5:a=4,o=r.slice(e[0],e[0]+a),e[0]+=a;break;case 1:a=8,o=r.slice(e[0],e[0]+a),e[0]+=a;break;case 2:a=xs(r,e),o=r.slice(e[0],e[0]+a),e[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(i))}var l={data:o,type:s};t[n]==null?t[n]=[l]:t[n].push(l)}return t}function Ot(r){var t=[];return r.forEach(function(e,i){e.forEach(function(n){n.data&&(t.push(Ge(i*8+n.type)),n.type==2&&t.push(Ge(n.data.length)),t.push(n.data))})}),Fi(t)}function Lr(r){for(var t,e=[],i=[0];i[0]<r.length;){var n=xs(r,i),s=dt(r.slice(i[0],i[0]+n));i[0]+=n;var a={id:En(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=dt(o.data),l=En(c[3][0].data);a.messages.push({meta:c,data:r.slice(i[0],i[0]+l)}),i[0]+=l}),(t=s[3])!=null&&t[0]&&(a.merge=En(s[3][0].data)>>>0>0),e.push(a)}return e}function vn(r){var t=[];return r.forEach(function(e){var i=[];i[1]=[{data:Ge(e.id),type:0}],i[2]=[],e.merge!=null&&(i[3]=[{data:Ge(+!!e.merge),type:0}]);var n=[];e.messages.forEach(function(a){n.push(a.data),a.meta[3]=[{type:0,data:Ge(a.data.length)}],i[2].push({data:Ot(a.meta),type:2})});var s=Ot(i);t.push(Ge(s.length)),t.push(s),n.forEach(function(a){return t.push(a)})}),Fi(t)}function Ey(r,t){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var e=[0],i=xs(t,e),n=[];e[0]<t.length;){var s=t[e[0]]&3;if(s==0){var a=t[e[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[e[0]],o>1&&(a|=t[e[0]+1]<<8),o>2&&(a|=t[e[0]+2]<<16),o>3&&(a|=t[e[0]+3]<<24),a>>>=0,a++,e[0]+=o}n.push(t.slice(e[0],e[0]+a)),e[0]+=a;continue}else{var c=0,l=0;if(s==1?(l=(t[e[0]]>>2&7)+4,c=(t[e[0]++]&224)<<3,c|=t[e[0]++]):(l=(t[e[0]++]>>2)+1,s==2?(c=t[e[0]]|t[e[0]+1]<<8,e[0]+=2):(c=(t[e[0]]|t[e[0]+1]<<8|t[e[0]+2]<<16|t[e[0]+3]<<24)>>>0,e[0]+=4)),n=[Fi(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(n.push(n[0].slice(-c)),l-=c;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-c,-c+l))}}var h=Fi(n);if(h.length!=i)throw new Error("Unexpected length: ".concat(h.length," != ").concat(i));return h}function Rr(r){for(var t=[],e=0;e<r.length;){var i=r[e++],n=r[e]|r[e+1]<<8|r[e+2]<<16;e+=3,t.push(Ey(i,r.slice(e,e+n))),e+=n}if(e!==r.length)throw new Error("data is not a valid framed stream!");return Fi(t)}function _n(r){for(var t=[],e=0;e<r.length;){var i=Math.min(r.length-e,268435455),n=new Uint8Array(4);t.push(n);var s=Ge(i),a=s.length;t.push(s),i<=60?(a++,t.push(new Uint8Array([i-1<<2]))):i<=256?(a+=2,t.push(new Uint8Array([240,i-1&255]))):i<=65536?(a+=3,t.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(a+=4,t.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(a+=5,t.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),t.push(r.slice(e,e+i)),a+=i,n[0]=0,n[1]=a&255,n[2]=a>>8&255,n[3]=a>>16&255,e+=i}return Fi(t)}function Mo(r,t){var e=new Uint8Array(32),i=Sa(e),n=12,s=0;switch(e[0]=5,r.t){case"n":e[1]=2,Ty(e,n,r.v),s|=1,n+=16;break;case"b":e[1]=6,i.setFloat64(n,r.v?1:0,!0),s|=2,n+=8;break;case"s":if(t.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));e[1]=3,i.setUint32(n,t.indexOf(r.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+r.t}return i.setUint32(8,s,!0),e.slice(0,n)}function Po(r,t){var e=new Uint8Array(32),i=Sa(e),n=12,s=0;switch(e[0]=3,r.t){case"n":e[2]=2,i.setFloat64(n,r.v,!0),s|=32,n+=8;break;case"b":e[2]=6,i.setFloat64(n,r.v?1:0,!0),s|=32,n+=8;break;case"s":if(t.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));e[2]=3,i.setUint32(n,t.indexOf(r.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+r.t}return i.setUint32(4,s,!0),e.slice(0,n)}function Si(r){var t=dt(r);return xs(t[1][0].data)}function ky(r,t,e){var i,n,s,a;if(!((i=r[6])!=null&&i[0])||!((n=r[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=r[8])==null?void 0:s[0])==null?void 0:a.data)&&En(r[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=Sa(r[7][0].data),h=0,u=[],f=Sa(r[4][0].data),p=0,x=[],d=0;d<t.length;++d){if(t[d]==null){l.setUint16(d*2,65535,!0),f.setUint16(d*2,65535);continue}l.setUint16(d*2,h,!0),f.setUint16(d*2,p,!0);var g,I;switch(typeof t[d]){case"string":g=Mo({t:"s",v:t[d]},e),I=Po({t:"s",v:t[d]},e);break;case"number":g=Mo({t:"n",v:t[d]},e),I=Po({t:"n",v:t[d]},e);break;case"boolean":g=Mo({t:"b",v:t[d]},e),I=Po({t:"b",v:t[d]},e);break;default:throw new Error("Unsupported value "+t[d])}u.push(g),h+=g.length,x.push(I),p+=I.length,++c}for(r[2][0].data=Ge(c);d<r[7][0].data.length/2;++d)l.setUint16(d*2,65535,!0),f.setUint16(d*2,65535,!0);return r[6][0].data=Fi(u),r[3][0].data=Fi(x),c}function Iy(r,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=gr(e["!ref"]);i.s.r=i.s.c=0;var n=!1;i.e.c>9&&(n=!0,i.e.c=9),i.e.r>49&&(n=!0,i.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(ut(i)));var s=Ta(e,{range:i,header:1}),a=["~Sh33tJ5~"];s.forEach(function(F){return F.forEach(function(k){typeof k=="string"&&a.push(k)})});var o={},c=[],l=qe.read(t.numbers,{type:"base64"});l.FileIndex.map(function(F,k){return[F,l.FullPaths[k]]}).forEach(function(F){var k=F[0],Z=F[1];if(k.type==2&&k.name.match(/\.iwa/)){var me=k.content,be=Rr(me),fe=Lr(be);fe.forEach(function(le){c.push(le.id),o[le.id]={deps:[],location:Z,type:En(le.messages[0].meta[1][0].data)}})}}),c.sort(function(F,k){return F-k});var h=c.filter(function(F){return F>1}).map(function(F){return[F,Ge(F)]});l.FileIndex.map(function(F,k){return[F,l.FullPaths[k]]}).forEach(function(F){var k=F[0],Z=F[1];if(k.name.match(/\.iwa/)){var me=Lr(Rr(k.content));me.forEach(function(be){be.messages.forEach(function(fe){h.forEach(function(le){be.messages.some(function(Ke){return En(Ke.meta[1][0].data)!=11006&&Sy(Ke.data,le[1])})&&o[le[0]].deps.push(be.id)})})})}});function u(){for(var F=927262;F<2e6;++F)if(!o[F])return F;throw new Error("Too many messages")}for(var f=qe.find(l,o[1].location),p=Lr(Rr(f.content)),x,d=0;d<p.length;++d){var g=p[d];g.id==1&&(x=g)}var I=Si(dt(x.messages[0].data)[1][0].data);for(f=qe.find(l,o[I].location),p=Lr(Rr(f.content)),d=0;d<p.length;++d)g=p[d],g.id==I&&(x=g);for(I=Si(dt(x.messages[0].data)[2][0].data),f=qe.find(l,o[I].location),p=Lr(Rr(f.content)),d=0;d<p.length;++d)g=p[d],g.id==I&&(x=g);for(I=Si(dt(x.messages[0].data)[2][0].data),f=qe.find(l,o[I].location),p=Lr(Rr(f.content)),d=0;d<p.length;++d)g=p[d],g.id==I&&(x=g);var O=dt(x.messages[0].data);{O[6][0].data=Ge(i.e.r+1),O[7][0].data=Ge(i.e.c+1);var A=Si(O[46][0].data),V=qe.find(l,o[A].location),q=Lr(Rr(V.content));{for(var ie=0;ie<q.length&&q[ie].id!=A;++ie);if(q[ie].id!=A)throw"Bad ColumnRowUIDMapArchive";var D=dt(q[ie].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var Y=0;Y<=i.e.c;++Y){var z=[];z[1]=z[2]=[{type:0,data:Ge(Y+420690)}],D[1].push({type:2,data:Ot(z)}),D[2].push({type:0,data:Ge(Y)}),D[3].push({type:0,data:Ge(Y)})}D[4]=[],D[5]=[],D[6]=[];for(var j=0;j<=i.e.r;++j)z=[],z[1]=z[2]=[{type:0,data:Ge(j+726270)}],D[4].push({type:2,data:Ot(z)}),D[5].push({type:0,data:Ge(j)}),D[6].push({type:0,data:Ge(j)});q[ie].messages[0].data=Ot(D)}V.content=_n(vn(q)),V.size=V.content.length,delete O[46];var Q=dt(O[4][0].data);{Q[7][0].data=Ge(i.e.r+1);var te=dt(Q[1][0].data),ge=Si(te[2][0].data);V=qe.find(l,o[ge].location),q=Lr(Rr(V.content));{if(q[0].id!=ge)throw"Bad HeaderStorageBucket";var ze=dt(q[0].messages[0].data);for(j=0;j<s.length;++j){var _e=dt(ze[2][0].data);_e[1][0].data=Ge(j),_e[4][0].data=Ge(s[j].length),ze[2][j]={type:ze[2][0].type,data:Ot(_e)}}q[0].messages[0].data=Ot(ze)}V.content=_n(vn(q)),V.size=V.content.length;var pt=Si(Q[2][0].data);V=qe.find(l,o[pt].location),q=Lr(Rr(V.content));{if(q[0].id!=pt)throw"Bad HeaderStorageBucket";for(ze=dt(q[0].messages[0].data),Y=0;Y<=i.e.c;++Y)_e=dt(ze[2][0].data),_e[1][0].data=Ge(Y),_e[4][0].data=Ge(i.e.r+1),ze[2][Y]={type:ze[2][0].type,data:Ot(_e)};q[0].messages[0].data=Ot(ze)}V.content=_n(vn(q)),V.size=V.content.length;var mt=Si(Q[4][0].data);(function(){for(var F=qe.find(l,o[mt].location),k=Lr(Rr(F.content)),Z,me=0;me<k.length;++me){var be=k[me];be.id==mt&&(Z=be)}var fe=dt(Z.messages[0].data);{fe[3]=[];var le=[];a.forEach(function(St,He){le[1]=[{type:0,data:Ge(He)}],le[2]=[{type:0,data:Ge(1)}],le[3]=[{type:2,data:by(St)}],fe[3].push({type:2,data:Ot(le)})})}Z.messages[0].data=Ot(fe);var Ke=vn(k),Re=_n(Ke);F.content=Re,F.size=F.content.length})();var jt=dt(Q[3][0].data);{var $t=jt[1][0];delete jt[2];var bt=dt($t.data);{var Yt=Si(bt[2][0].data);(function(){for(var F=qe.find(l,o[Yt].location),k=Lr(Rr(F.content)),Z,me=0;me<k.length;++me){var be=k[me];be.id==Yt&&(Z=be)}var fe=dt(Z.messages[0].data);{delete fe[6],delete jt[7];var le=new Uint8Array(fe[5][0].data);fe[5]=[];for(var Ke=0,Re=0;Re<=i.e.r;++Re){var St=dt(le);Ke+=ky(St,s[Re],a),St[1][0].data=Ge(Re),fe[5].push({data:Ot(St),type:2})}fe[1]=[{type:0,data:Ge(i.e.c+1)}],fe[2]=[{type:0,data:Ge(i.e.r+1)}],fe[3]=[{type:0,data:Ge(Ke)}],fe[4]=[{type:0,data:Ge(i.e.r+1)}]}Z.messages[0].data=Ot(fe);var He=vn(k),Fr=_n(He);F.content=Fr,F.size=F.content.length})()}$t.data=Ot(bt)}Q[3][0].data=Ot(jt)}O[4][0].data=Ot(Q)}x.messages[0].data=Ot(O);var b=vn(p),G=_n(b);return f.content=G,f.size=f.content.length,l}function Fy(r){return function(e){for(var i=0;i!=r.length;++i){var n=r[i];e[n[0]]===void 0&&(e[n[0]]=n[1]),n[2]==="n"&&(e[n[0]]=Number(e[n[0]]))}}}function ll(r){Fy([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function Oy(r,t){return t.bookType=="ods"?lu(r,t):t.bookType=="numbers"?Iy(r,t):t.bookType=="xlsb"?Ay(r,t):Dy(r,t)}function Ay(r,t){wn=1024,r&&!r.SSF&&(r.SSF=nr(ot)),r&&r.SSF&&(Ia(),ka(r.SSF),t.revssf=Fa(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,us?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e=t.bookType=="xlsb"?"bin":"xml",i=Uh.indexOf(t.bookType)>-1,n=_h();ll(t=t||{});var s=$o(),a="",o=0;if(t.cellXfs=[],Oi(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",De(s,a,bh(r.Props,t)),n.coreprops.push(a),Xe(t.rels,2,a,Ve.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],l=0;l<r.SheetNames.length;++l)(r.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(r.SheetNames[l]);r.Props.SheetNames=c}for(r.Props.Worksheets=r.Props.SheetNames.length,De(s,a,Th(r.Props,t)),n.extprops.push(a),Xe(t.rels,3,a,Ve.EXT_PROPS),r.Custprops!==r.Props&&Lt(r.Custprops||{}).length>0&&(a="docProps/custom.xml",De(s,a,Eh(r.Custprops,t)),n.custprops.push(a),Xe(t.rels,4,a,Ve.CUST_PROPS)),o=1;o<=r.SheetNames.length;++o){var h={"!id":{}},u=r.Sheets[r.SheetNames[o-1]],f=(u||{})["!type"]||"sheet";switch(f){case"chart":default:a="xl/worksheets/sheet"+o+"."+e,De(s,a,P_(o-1,a,t,r,h)),n.sheets.push(a),Xe(t.wbrels,-1,"worksheets/sheet"+o+"."+e,Ve.WS[0])}if(u){var p=u["!comments"],x=!1,d="";p&&p.length>0&&(d="xl/comments"+o+"."+e,De(s,d,N_(p,d,t)),n.comments.push(d),Xe(h,-1,"../comments"+o+"."+e,Ve.CMNT),x=!0),u["!legacy"]&&x&&De(s,"xl/drawings/vmlDrawing"+o+".vml",$h(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}h["!id"].rId1&&De(s,wh(a),Sn(h))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+e,De(s,a,R_(t.Strings,a,t)),n.strs.push(a),Xe(t.wbrels,-1,"sharedStrings."+e,Ve.SST)),a="xl/workbook."+e,De(s,a,M_(r,a,t)),n.workbooks.push(a),Xe(t.rels,1,a,Ve.WB),a="xl/theme/theme1.xml",De(s,a,Vh(r.Themes,t)),n.themes.push(a),Xe(t.wbrels,-1,"theme/theme1.xml",Ve.THEME),a="xl/styles."+e,De(s,a,L_(r,a,t)),n.styles.push(a),Xe(t.wbrels,-1,"styles."+e,Ve.STY),r.vbaraw&&i&&(a="xl/vbaProject.bin",De(s,a,r.vbaraw),n.vba.push(a),Xe(t.wbrels,-1,"vbaProject.bin",Ve.VBA)),a="xl/metadata."+e,De(s,a,B_(a)),n.metadata.push(a),Xe(t.wbrels,-1,"metadata."+e,Ve.XLMETA),De(s,"[Content_Types].xml",yh(n,t)),De(s,"_rels/.rels",Sn(t.rels)),De(s,"xl/_rels/workbook."+e+".rels",Sn(t.wbrels)),delete t.revssf,delete t.ssf,s}function Dy(r,t){wn=1024,r&&!r.SSF&&(r.SSF=nr(ot)),r&&r.SSF&&(Ia(),ka(r.SSF),t.revssf=Fa(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,us?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",i=Uh.indexOf(t.bookType)>-1,n=_h();ll(t=t||{});var s=$o(),a="",o=0;if(t.cellXfs=[],Oi(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",De(s,a,bh(r.Props,t)),n.coreprops.push(a),Xe(t.rels,2,a,Ve.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],l=0;l<r.SheetNames.length;++l)(r.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(r.SheetNames[l]);r.Props.SheetNames=c}r.Props.Worksheets=r.Props.SheetNames.length,De(s,a,Th(r.Props,t)),n.extprops.push(a),Xe(t.rels,3,a,Ve.EXT_PROPS),r.Custprops!==r.Props&&Lt(r.Custprops||{}).length>0&&(a="docProps/custom.xml",De(s,a,Eh(r.Custprops,t)),n.custprops.push(a),Xe(t.rels,4,a,Ve.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,o=1;o<=r.SheetNames.length;++o){var u={"!id":{}},f=r.Sheets[r.SheetNames[o-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+e,De(s,a,Jh(o-1,t,r,u)),n.sheets.push(a),Xe(t.wbrels,-1,"worksheets/sheet"+o+"."+e,Ve.WS[0])}if(f){var x=f["!comments"],d=!1,g="";if(x&&x.length>0){var I=!1;x.forEach(function(O){O[1].forEach(function(A){A.T==!0&&(I=!0)})}),I&&(g="xl/threadedComments/threadedComment"+o+"."+e,De(s,g,c1(x,h,t)),n.threadedcomments.push(g),Xe(u,-1,"../threadedComments/threadedComment"+o+"."+e,Ve.TCMNT)),g="xl/comments"+o+"."+e,De(s,g,zh(x,t)),n.comments.push(g),Xe(u,-1,"../comments"+o+"."+e,Ve.CMNT),d=!0}f["!legacy"]&&d&&De(s,"xl/drawings/vmlDrawing"+o+".vml",$h(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&De(s,wh(a),Sn(u))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+e,De(s,a,Ph(t.Strings,t)),n.strs.push(a),Xe(t.wbrels,-1,"sharedStrings."+e,Ve.SST)),a="xl/workbook."+e,De(s,a,ru(r,t)),n.workbooks.push(a),Xe(t.rels,1,a,Ve.WB),a="xl/theme/theme1.xml",De(s,a,Vh(r.Themes,t)),n.themes.push(a),Xe(t.wbrels,-1,"theme/theme1.xml",Ve.THEME),a="xl/styles."+e,De(s,a,Bh(r,t)),n.styles.push(a),Xe(t.wbrels,-1,"styles."+e,Ve.STY),r.vbaraw&&i&&(a="xl/vbaProject.bin",De(s,a,r.vbaraw),n.vba.push(a),Xe(t.wbrels,-1,"vbaProject.bin",Ve.VBA)),a="xl/metadata."+e,De(s,a,Wh()),n.metadata.push(a),Xe(t.wbrels,-1,"metadata."+e,Ve.XLMETA),h.length>1&&(a="xl/persons/person.xml",De(s,a,h1(h,t)),n.people.push(a),Xe(t.wbrels,-1,"persons/person.xml",Ve.PEOPLE)),De(s,"[Content_Types].xml",yh(n,t)),De(s,"_rels/.rels",Sn(t.rels)),De(s,"xl/_rels/workbook."+e+".rels",Sn(t.wbrels)),delete t.revssf,delete t.ssf,s}function My(r,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":e=ci(r.slice(0,12));break;case"binary":e=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function cu(r,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ys(t.file,qe.write(r,{type:$e?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return qe.write(r,t)}function Py(r,t){var e=nr(t||{}),i=Oy(r,e);return Ly(i,e)}function Ly(r,t){var e={},i=$e?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=i;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=i;break;default:throw new Error("Unrecognized type "+t.type)}var n=r.FullPaths?qe.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):r.generate(e);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(Ea(n))}return t.password&&typeof encrypt_agile<"u"?cu(encrypt_agile(n,t.password),t):t.type==="file"?ys(t.file,n):t.type=="string"?os(n):n}function Ry(r,t){var e=t||{},i=Q_(r,e);return cu(i,e)}function Xr(r,t,e){e||(e="");var i=e+r;switch(t.type){case"base64":return ps(si(i));case"binary":return si(i);case"string":return r;case"file":return ys(t.file,i,"utf8");case"buffer":return $e?ui(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):Xr(i,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ny(r,t){switch(t.type){case"base64":return ps(r);case"binary":return r;case"string":return r;case"file":return ys(t.file,r,"binary");case"buffer":return $e?ui(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function fa(r,t){switch(t.type){case"string":case"base64":case"binary":for(var e="",i=0;i<r.length;++i)e+=String.fromCharCode(r[i]);return t.type=="base64"?ps(e):t.type=="string"?os(e):e;case"file":return ys(t.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+t.type)}}function hu(r,t){cp(),C_(r);var e=nr(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var i=hu(r,e);return e.type="array",Ea(i)}var n=0;if(e.sheet&&(typeof e.sheet=="number"?n=e.sheet:n=r.SheetNames.indexOf(e.sheet),!r.SheetNames[n]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return Xr(q_(r,e),e);case"slk":case"sylk":return Xr(_g.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"htm":case"html":return Xr(su(r.Sheets[r.SheetNames[n]],e),e);case"txt":return Ny(uu(r.Sheets[r.SheetNames[n]],e),e);case"csv":return Xr(hl(r.Sheets[r.SheetNames[n]],e),e,"\uFEFF");case"dif":return Xr(yg.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"dbf":return fa(vg.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"prn":return Xr(wg.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"rtf":return Xr(Ig.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"eth":return Xr(Mh.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"fods":return Xr(lu(r,e),e);case"wk1":return fa(A0.sheet_to_wk1(r.Sheets[r.SheetNames[n]],e),e);case"wk3":return fa(A0.book_to_wk3(r,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),fa(nu(r,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),Ry(r,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Py(r,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function By(r){if(!r.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(r.bookType=e.slice(1)),r.bookType=t[r.bookType]||r.bookType}}function cl(r,t,e){var i=e||{};return i.type="file",i.file=t,By(i),hu(r,i)}function Hy(r,t,e,i,n,s,a,o){var c=Pt(e),l=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,f=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:e,enumerable:!1})}catch{f.__rowNum__=e}else f.__rowNum__=e;if(!a||r[e])for(var p=t.s.c;p<=t.e.c;++p){var x=a?r[e][p]:r[i[p]+c];if(x===void 0||x.t===void 0){if(l===void 0)continue;s[p]!=null&&(f[s[p]]=l);continue}var d=x.v;switch(x.t){case"z":if(d==null)break;continue;case"e":d=d==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[p]!=null){if(d==null)if(x.t=="e"&&d===null)f[s[p]]=null;else if(l!==void 0)f[s[p]]=l;else if(h&&d===null)f[s[p]]=null;else continue;else f[s[p]]=h&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?d:hi(x,d,o);d!=null&&(u=!1)}}return{row:f,isempty:u}}function Ta(r,t){if(r==null||r["!ref"]==null)return[];var e={t:"n",v:0},i=0,n=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},h=l.range!=null?l.range:r["!ref"];switch(l.header===1?i=1:l.header==="A"?i=2:Array.isArray(l.header)?i=3:l.header==null&&(i=0),typeof h){case"string":c=et(h);break;case"number":c=et(r["!ref"]),c.s.r=h;break;default:c=h}i>0&&(n=0);var u=Pt(c.s.r),f=[],p=[],x=0,d=0,g=Array.isArray(r),I=c.s.r,O=0,A={};g&&!r[I]&&(r[I]=[]);var V=l.skipHidden&&r["!cols"]||[],q=l.skipHidden&&r["!rows"]||[];for(O=c.s.c;O<=c.e.c;++O)if(!(V[O]||{}).hidden)switch(f[O]=Vt(O),e=g?r[I][O]:r[f[O]+u],i){case 1:s[O]=O-c.s.c;break;case 2:s[O]=f[O];break;case 3:s[O]=l.header[O-c.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),o=a=hi(e,null,l),d=A[a]||0,!d)A[a]=1;else{do o=a+"_"+d++;while(A[o]);A[a]=d,A[o]=1}s[O]=o}for(I=c.s.r+n;I<=c.e.r;++I)if(!(q[I]||{}).hidden){var ie=Hy(r,c,I,f,i,s,g,l);(ie.isempty===!1||(i===1?l.blankrows!==!1:l.blankrows))&&(p[x++]=ie.row)}return p.length=x,p}var H0=/"/g;function Vy(r,t,e,i,n,s,a,o){for(var c=!0,l=[],h="",u=Pt(e),f=t.s.c;f<=t.e.c;++f)if(i[f]){var p=o.dense?(r[e]||[])[f]:r[i[f]+u];if(p==null)h="";else if(p.v!=null){c=!1,h=""+(o.rawNumbers&&p.t=="n"?p.v:hi(p,null,o));for(var x=0,d=0;x!==h.length;++x)if((d=h.charCodeAt(x))===n||d===s||d===34||o.forceQuotes){h='"'+h.replace(H0,'""')+'"';break}h=="ID"&&(h='"ID"')}else p.f!=null&&!p.F?(c=!1,h="="+p.f,h.indexOf(",")>=0&&(h='"'+h.replace(H0,'""')+'"')):h="";l.push(h)}return o.blankrows===!1&&c?null:l.join(a)}function hl(r,t){var e=[],i=t??{};if(r==null||r["!ref"]==null)return"";var n=et(r["!ref"]),s=i.FS!==void 0?i.FS:",",a=s.charCodeAt(0),o=i.RS!==void 0?i.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),h="",u=[];i.dense=Array.isArray(r);for(var f=i.skipHidden&&r["!cols"]||[],p=i.skipHidden&&r["!rows"]||[],x=n.s.c;x<=n.e.c;++x)(f[x]||{}).hidden||(u[x]=Vt(x));for(var d=0,g=n.s.r;g<=n.e.r;++g)(p[g]||{}).hidden||(h=Vy(r,n,g,u,a,c,s,i),h!=null&&(i.strip&&(h=h.replace(l,"")),(h||i.blankrows!==!1)&&e.push((d++?o:"")+h)));return delete i.dense,e.join("")}function uu(r,t){t||(t={}),t.FS="	",t.RS=`
`;var e=hl(r,t);if(typeof Ze>"u"||t.type=="string")return e;var i=Ze.utils.encode(1200,e,"str");return"\xFF\xFE"+i}function Wy(r){var t="",e,i="";if(r==null||r["!ref"]==null)return[];var n=et(r["!ref"]),s="",a=[],o,c=[],l=Array.isArray(r);for(o=n.s.c;o<=n.e.c;++o)a[o]=Vt(o);for(var h=n.s.r;h<=n.e.r;++h)for(s=Pt(h),o=n.s.c;o<=n.e.c;++o)if(t=a[o]+s,e=l?(r[h]||[])[o]:r[t],i="",e!==void 0){if(e.F!=null){if(t=e.F,!e.f)continue;i=e.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(e.f!=null)i=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)i=""+e.v;else if(e.t=="b")i=e.v?"TRUE":"FALSE";else if(e.w!==void 0)i="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?i="'"+e.v:i=""+e.v}}c[c.length]=t+"="+i}return c}function fu(r,t,e){var i=e||{},n=+!i.skipHeader,s=r||{},a=0,o=0;if(s&&i.origin!=null)if(typeof i.origin=="number")a=i.origin;else{var c=typeof i.origin=="string"?wt(i.origin):i.origin;a=c.r,o=c.c}var l,h={s:{c:0,r:0},e:{c:o,r:a+t.length-1+n}};if(s["!ref"]){var u=et(s["!ref"]);h.e.c=Math.max(h.e.c,u.e.c),h.e.r=Math.max(h.e.r,u.e.r),a==-1&&(a=u.e.r+1,h.e.r=a+t.length-1+n)}else a==-1&&(a=0,h.e.r=t.length-1+n);var f=i.header||[],p=0;t.forEach(function(d,g){Lt(d).forEach(function(I){(p=f.indexOf(I))==-1&&(f[p=f.length]=I);var O=d[I],A="z",V="",q=Ye({c:o+p,r:a+g+n});l=vs(s,q),O&&typeof O=="object"&&!(O instanceof Date)?s[q]=O:(typeof O=="number"?A="n":typeof O=="boolean"?A="b":typeof O=="string"?A="s":O instanceof Date?(A="d",i.cellDates||(A="n",O=ir(O)),V=i.dateNF||ot[14]):O===null&&i.nullError&&(A="e",O=0),l?(l.t=A,l.v=O,delete l.w,delete l.R,V&&(l.z=V)):s[q]=l={t:A,v:O},V&&(l.z=V))})}),h.e.c=Math.max(h.e.c,o+f.length-1);var x=Pt(a);if(n)for(p=0;p<f.length;++p)s[Vt(p+o)+x]={t:"s",v:f[p]};return s["!ref"]=ut(h),s}function $y(r,t){return fu(null,r,t)}function vs(r,t,e){if(typeof t=="string"){if(Array.isArray(r)){var i=wt(t);return r[i.r]||(r[i.r]=[]),r[i.r][i.c]||(r[i.r][i.c]={t:"z"})}return r[t]||(r[t]={t:"z"})}return typeof t!="number"?vs(r,Ye(t)):vs(r,Ye({r:t,c:e||0}))}function zy(r,t){if(typeof t=="number"){if(t>=0&&r.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=r.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Uy(){return{SheetNames:[],Sheets:{}}}function Gy(r,t,e,i){var n=1;if(!e)for(;n<=65535&&r.SheetNames.indexOf(e="Sheet"+n)!=-1;++n,e=void 0);if(!e||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&r.SheetNames.indexOf(e)>=0){var s=e.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var a=s&&s[1]||e;for(++n;n<=65535&&r.SheetNames.indexOf(e=a+n)!=-1;++n);}if(tu(e),r.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return r.SheetNames.push(e),r.Sheets[e]=t,e}function Xy(r,t,e){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var i=zy(r,t);switch(r.Workbook.Sheets[i]||(r.Workbook.Sheets[i]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}r.Workbook.Sheets[i].Hidden=e}function jy(r,t){return r.z=t,r}function du(r,t,e){return t?(r.l={Target:t},e&&(r.l.Tooltip=e)):delete r.l,r}function Yy(r,t,e){return du(r,"#"+t,e)}function Ky(r,t,e){r.c||(r.c=[]),r.c.push({t,a:e||"SheetJS"})}function qy(r,t,e,i){for(var n=typeof t!="string"?t:et(t),s=typeof t=="string"?t:ut(t),a=n.s.r;a<=n.e.r;++a)for(var o=n.s.c;o<=n.e.c;++o){var c=vs(r,a,o);c.t="n",c.F=s,delete c.v,a==n.s.r&&o==n.s.c&&(c.f=e,i&&(c.D=!0))}return r}var Ir={encode_col:Vt,encode_row:Pt,encode_cell:Ye,encode_range:ut,decode_col:Qo,decode_row:Zo,split_cell:um,decode_cell:wt,decode_range:gr,format_cell:hi,sheet_add_aoa:dh,sheet_add_json:fu,sheet_add_dom:au,aoa_to_sheet:An,json_to_sheet:$y,table_to_sheet:ou,table_to_book:yy,sheet_to_csv:hl,sheet_to_txt:uu,sheet_to_json:Ta,sheet_to_html:su,sheet_to_formulae:Wy,sheet_to_row_object_array:Ta,sheet_get_cell:vs,book_new:Uy,book_append_sheet:Gy,book_set_sheet_visibility:Xy,cell_set_number_format:jy,cell_set_hyperlink:du,cell_set_internal_link:Yy,cell_add_comment:Ky,sheet_set_array_formula:qy,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var QS=fs.version;var fi=class r extends ve{constructor(){super(),this.xAxisData=[],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}}}}getChartType(){return"line"}getDefaultSeriesOptions(){return{name:"Line Chart",type:"line",smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",aggregateBy:n,sortBy:s,sortOrder:a="asc",limit:o,dateFormat:c}=t;try{let l=this.data.map(h=>({name:h[e]||"Unknown",value:parseFloat(h[i])||0,originalItem:h}));if(n){let h=new Map;l.forEach(u=>{let f=u.name;h.set(f,(h.get(f)||0)+u.value)}),l=Array.from(h.entries()).map(([u,f])=>({name:u,value:f,originalItem:null}))}s==="name"?l.sort((h,u)=>a==="asc"?h.name.localeCompare(u.name):u.name.localeCompare(h.name)):s==="value"&&l.sort((h,u)=>a==="asc"?h.value-u.value:u.value-h.value),o&&o>0&&(l=l.slice(0,o)),this.seriesOptions.data=l.map(h=>h.value),this.xAxisData.length===0&&(this.xAxisData=l.map(h=>h.name),this.setXAxisData(this.xAxisData))}catch(l){console.error("Error transforming line chart data:",l)}return this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis=B(T({},this.chartOptions.xAxis),{data:t}),this}setXAxisName(t){return this.chartOptions.xAxis=B(T({},this.chartOptions.xAxis),{name:t}),this}setYAxisName(t){return this.chartOptions.yAxis=B(T({},this.chartOptions.yAxis),{name:t}),this}setSmooth(t){return this.seriesOptions.smooth=t,this}setSymbol(t,e=6){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setLineStyle(t,e,i="solid"){return this.seriesOptions.lineStyle={width:t,color:e,type:i},this}setAreaStyle(t,e=.3){return this.seriesOptions.areaStyle={color:t,opacity:e},this}setShowSymbol(t){return this.seriesOptions.showSymbol=t,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&(this.setLineStyle(2,e[0]),this.seriesOptions.itemStyle=B(T({},this.seriesOptions.itemStyle),{color:e[0]})),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setValueFormatter(i),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setValueFormatter(e),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setValueFormatter(i),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=12){let e=[],i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=100;for(let s=0;s<Math.min(t,i.length);s++){let a=(Math.random()-.5)*20;n+=a,e.push({name:i[s],value:Math.round(n),date:i[s],category:["Revenue","Profit","Expenses"][Math.floor(Math.random()*3)]})}return this.setData(e)}setTrendAnalysisConfiguration(){return this.setSmooth(!0).setSymbol("circle",4).setLineStyle(3,"#5470c6").setAreaStyle("#5470c6",.1).setYAxisName("Value").setXAxisName("Time Period").setPredefinedPalette("finance").setTooltip("axis","{b}: {c}")}setPerformanceConfiguration(){return this.setSmooth(!1).setSymbol("diamond",6).setLineStyle(2,"#91cc75").setYAxisName("Performance Score").setXAxisName("Metrics").setPredefinedPalette("business").setTooltip("axis","{b}: {c}%")}setTimeSeriesConfiguration(){return this.setSmooth(!0).setSymbol("none",0).setLineStyle(2,"#fac858").setShowSymbol(!1).setYAxisName("Value").setXAxisName("Time").setPredefinedPalette("modern").setTooltip("axis","{b}: {c}")}build(){let t=B(T({},this.chartOptions),{series:[B(T({},this.seriesOptions),{type:"line"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>parseFloat(l.value)||0));let o=t.chartInstance.getOption(),c=B(T({},o),{series:[B(T({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating line chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isLineChart(t){return ve.isChartType(t,"line")}static createLineChartWidget(t,e){let i=r.create();return t&&i.setData(t),e&&i.setXAxisData(e),i.getWidgetBuilder()}static exportData(t){let e=[];if(t.echart_options?.series?.[0]?.data&&t.echart_options?.xAxis?.data){let i=t.echart_options.series[0].data,n=t.echart_options.xAxis.data;for(let s=0;s<i.length;s++){let a=i[s],o=n[s]||`Point ${s+1}`;e.push({Label:o,Value:a||0})}}return e}static getExportHeaders(t){return["Label","Value"]}static getExportSheetName(t){return"Line Chart Data"}};var Pn=class r extends ve{constructor(){super(),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"item",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},polar:{center:["50%","50%"],radius:["30%","80%"],startAngle:0,endAngle:360},angleAxis:{type:"value",startAngle:0,endAngle:360,min:0,max:100,axisLabel:{color:"#666",fontSize:12}},radiusAxis:{type:"value",min:0,max:100,axisLabel:{color:"#666",fontSize:12}}}}getChartType(){return"line"}getDefaultSeriesOptions(){return{name:"Polar Chart",type:"line",coordinateSystem:"polar",smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.3},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setPolarCenter(t){return this.chartOptions.polar.center=t,this}setPolarRadius(t){return this.chartOptions.polar.radius=t,this}setStartAngle(t){return this.chartOptions.polar.startAngle=t,this.chartOptions.angleAxis.startAngle=t,this}setEndAngle(t){return this.chartOptions.polar.endAngle=t,this.chartOptions.angleAxis.endAngle=t,this}setAngleAxisRange(t,e){return this.chartOptions.angleAxis.min=t,this.chartOptions.angleAxis.max=e,this}setRadiusAxisRange(t,e){return this.chartOptions.radiusAxis.min=t,this.chartOptions.radiusAxis.max=e,this}setSmooth(t){return this.seriesOptions.smooth=t,this}setSymbol(t,e=6){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setLineStyle(t,e,i="solid"){return this.seriesOptions.lineStyle={width:t,color:e,type:i},this}setItemStyle(t,e,i){return this.seriesOptions.itemStyle={color:t,borderColor:e,borderWidth:i},this}setAreaStyle(t,e=.3){return this.seriesOptions.areaStyle={color:t,opacity:e},this}setGradientAreaStyle(t,e,i=.3){return this.seriesOptions.areaStyle={color:{type:"radial",x:.5,y:.5,r:.5,colorStops:[{offset:0,color:t},{offset:1,color:e}]},opacity:i},this}setShowSymbol(t){return this.seriesOptions.showSymbol=t,this}setStack(t){return this.seriesOptions.stack=t,this}setSampling(t){return this.seriesOptions.sampling=t,this}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{valueField:e="value",nameField:i="name",categoryField:n="category",sortBy:s,sortOrder:a="desc",limit:o}=t;try{let c=[],l=this.data;t.filters&&t.filters.length>0&&(l=ve.applyFilters(this.data,t.filters)),l.forEach(h=>{let u=parseFloat(h[e])||0;c.push(u)}),s==="value"&&c.sort((h,u)=>a==="asc"?h-u:u-h),o&&o>0&&(c=c.slice(0,o)),this.seriesOptions.data=c}catch(c){console.error("Error transforming polar chart data:",c)}return this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&(this.setItemStyle(e[0]),this.setLineStyle(2,e[0])),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("item",n=>`${n.seriesName}: ${i(n.value)}`),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("item",i=>`${i.seriesName}: ${e(i.value)}`),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("item",n=>`${n.seriesName}: ${i(n.value)}`),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=8){let e=[];for(let i=0;i<t;i++)e.push({value:Math.floor(Math.random()*100)+10,name:`Metric ${i+1}`,angle:360/t*i,category:["Performance","Quality","Efficiency"][Math.floor(Math.random()*3)],department:["Sales","Marketing","Operations"][Math.floor(Math.random()*3)]});return this.setData(e)}setPerformanceMetricsConfiguration(){return this.setPredefinedPalette("business").setPercentageFormatter(1).setPolarRadius(["20%","80%"]).setAreaStyle("#5470c6",.3).setSmooth(!0)}setRadarAnalysisConfiguration(){return this.setPredefinedPalette("finance").setCustomNumberFormatter(0,"en-US").setPolarRadius(["30%","90%"]).setLineStyle(3,"#91cc75","solid").setSymbol("circle",6)}set360ViewConfiguration(){return this.setPredefinedPalette("modern").setCurrencyFormatter("USD","en-US").setPolarRadius(["10%","95%"]).setStartAngle(0).setEndAngle(360).setAreaStyle("#ee6666",.4)}build(){return this.chartOptions.series=[this.seriesOptions],this.widgetBuilder.setEChartsOptions(this.chartOptions),this.widgetBuilder.build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>parseFloat(l.value)||0));let o=t.chartInstance.getOption(),c=B(T({},o),{series:[B(T({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating polar chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isPolarChart(t){return t.config?.options?.series?.[0]?.coordinateSystem==="polar"}static createPolarChartWidget(t){return new tr().setComponent("echart").setEChartsOptions({grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"item",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},polar:{center:["50%","50%"],radius:["30%","80%"],startAngle:0,endAngle:360},angleAxis:{type:"value",startAngle:0,endAngle:360,min:0,max:100,axisLabel:{color:"#666",fontSize:12}},radiusAxis:{type:"value",min:0,max:100,axisLabel:{color:"#666",fontSize:12}},series:[{name:"Polar Chart",type:"line",coordinateSystem:"polar",data:t||[],smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.3},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}static exportData(t){if(!r.isPolarChart(t))return[];let i=t.config?.options?.series;if(!i||i.length===0)return[];let n=[];return i.forEach((s,a)=>{s.data&&s.data.forEach((o,c)=>{a===0&&(n[c]=[`Point ${c+1}`]),n[c]&&n[c].push(o||0)})}),n}static getExportHeaders(t){let i=t.config?.options?.series;return!i||i.length===0?["Angle"]:["Angle",...i.map(n=>n.name||"Series")]}static getExportSheetName(t){return`PolarChart_${(t.config?.header?.title||"Polar Chart").replace(/[^a-zA-Z0-9]/g,"_")}`}};var Ln=class r extends ve{constructor(){super(),this.xAxisData=[],this.multiSeriesData=[],this.colors=["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4"],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}}}}getChartType(){return"line"}getDefaultSeriesOptions(){return{name:"Stacked Area",type:"line",smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.6,origin:"auto"},stack:"total",emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}setMultiSeriesData(t){return this.multiSeriesData=t,this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{seriesField:e="series",valueField:i="value",categoryField:n="category",timeField:s="time",sortBy:a,sortOrder:o="asc",limit:c}=t;try{let l=this.data;t.filters&&t.filters.length>0&&(l=ve.applyFilters(this.data,t.filters));let h=new Map,u=new Set;l.forEach(x=>{let d=x[e]||"Default",g=x[n]||x[s]||"Unknown",I=parseFloat(x[i])||0;h.has(d)||h.set(d,new Map),h.get(d).set(g,(h.get(d).get(g)||0)+I),u.add(g)});let f=Array.from(u).sort();this.setXAxisData(f);let p=[];h.forEach((x,d)=>{let g=f.map(I=>x.get(I)||0);p.push({name:d,data:g})}),a==="total"&&p.sort((x,d)=>{let g=x.data.reduce((O,A)=>O+A,0),I=d.data.reduce((O,A)=>O+A,0);return o==="asc"?g-I:I-g}),c&&c>0&&p.splice(c),this.setMultiSeriesData(p)}catch(l){console.error("Error transforming stacked area chart data:",l)}return this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis.data=t,this}setXAxisName(t){return this.chartOptions.xAxis.name=t,this}setYAxisName(t){return this.chartOptions.yAxis.name=t,this}setSmooth(t){return this.seriesOptions.smooth=t,this}setSymbol(t,e=6){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setLineStyle(t,e,i="solid"){return this.seriesOptions.lineStyle={width:t,color:e,type:i},this}setItemStyle(t,e,i){return this.seriesOptions.itemStyle={color:t,borderColor:e,borderWidth:i},this}setAreaStyle(t,e=.6){return this.seriesOptions.areaStyle={color:t,opacity:e,origin:"auto"},this}setGradientAreaStyle(t,e,i=.6){return this.seriesOptions.areaStyle={color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:t},{offset:1,color:e}]},opacity:i,origin:"auto"},this}setShowSymbol(t){return this.seriesOptions.showSymbol=t,this}setStack(t){return this.seriesOptions.stack=t,this}setSampling(t){return this.seriesOptions.sampling=t,this}setColors(t){return this.colors=t,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&this.setColors(e),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("axis",n=>{if(!Array.isArray(n))return"";let s=`${n[0].name}<br/>`;return n.forEach(a=>{s+=`${a.seriesName}: ${i(a.value)}<br/>`}),s}),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("axis",i=>{if(!Array.isArray(i))return"";let n=`${i[0].name}<br/>`;return i.forEach(s=>{n+=`${s.seriesName}: ${e(s.value)}<br/>`}),n}),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("axis",n=>{if(!Array.isArray(n))return"";let s=`${n[0].name}<br/>`;return n.forEach(a=>{s+=`${a.seriesName}: ${i(a.value)}<br/>`}),s}),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=3,e=7){let i=[],n=["Revenue","Expenses","Profit","Investment","Savings"].slice(0,t),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].slice(0,e);for(let a of n){let o=[];for(let c=0;c<e;c++)o.push(Math.floor(Math.random()*200)+50);i.push({name:a,data:o,category:["Primary","Secondary","Tertiary"][Math.floor(Math.random()*3)]})}return this.setMultiSeriesData(i),this.setXAxisData(s),this}setFinancialAnalysisConfiguration(){return this.setPredefinedPalette("finance").setCurrencyFormatter("USD","en-US").setXAxisName("Time Period").setYAxisName("Amount").setStack("financial").setSmooth(!0)}setPerformanceMonitoringConfiguration(){return this.setPredefinedPalette("business").setPercentageFormatter(1).setXAxisName("Metrics").setYAxisName("Performance").setStack("performance").setAreaStyle("#5470c6",.5)}setTrendAnalysisConfiguration(){return this.setPredefinedPalette("modern").setCustomNumberFormatter(0,"en-US").setXAxisName("Period").setYAxisName("Value").setStack("trend").setSmooth(!1).setSymbol("circle",4)}build(){let t=[];return this.multiSeriesData.length>0?this.multiSeriesData.forEach((e,i)=>{let n=B(T({},this.seriesOptions),{name:e.name,data:e.data,itemStyle:{color:this.colors[i%this.colors.length]},areaStyle:{color:this.colors[i%this.colors.length],opacity:.6,origin:"auto"},lineStyle:{width:2,color:this.colors[i%this.colors.length],type:"solid"}});t.push(n)}):t.push(this.seriesOptions),this.chartOptions.series=t,this.widgetBuilder.setEChartsOptions(this.chartOptions),this.widgetBuilder.build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>({name:l.name||"Series",data:l.data||[],type:"line",stack:"total",areaStyle:{}})));let o=t.chartInstance.getOption(),c=B(T({},o),{series:a});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating stacked area chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isStackedAreaChart(t){let e=t.config?.options;return e?.series?.[0]?.type==="line"&&e?.series?.[0]?.areaStyle&&e?.series?.[0]?.stack}static createStackedAreaChartWidget(t,e){let i=["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4"],n=[];return t&&t.length>0&&t.forEach((a,o)=>{n.push({name:a.name,type:"line",data:a.data,smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:i[o%i.length],type:"solid"},itemStyle:{color:i[o%i.length]},areaStyle:{color:i[o%i.length],opacity:.6,origin:"auto"},stack:"total",emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}})}),new tr().setComponent("echart").setEChartsOptions({grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:e||[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}},series:n})}static exportData(t){if(!r.isStackedAreaChart(t))return[];let e=t.config?.options,i=e?.series,n=e?.xAxis;if(!i||i.length===0)return[];let s=[];n&&(Array.isArray(n)?s=n[0]?.data||[]:n.data&&(s=n.data)),s.length===0&&i[0]?.data&&(s=i[0].data.map((o,c)=>`Point ${c+1}`));let a=[];return i.forEach((o,c)=>{o.data&&o.data.forEach((l,h)=>{c===0&&(a[h]=[s[h]||`Point ${h+1}`]),a[h]&&a[h].push(l||0)})}),a}static getExportHeaders(t){let i=t.config?.options?.series;return!i||i.length===0?["Category"]:["Category",...i.map(n=>n.name||"Series")]}static getExportSheetName(t){return`StackedAreaChart_${(t.config?.header?.title||"Stacked Area Chart").replace(/[^a-zA-Z0-9]/g,"_")}`}};var Rn=class r extends ve{constructor(){super(),this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{tooltip:{trigger:"item",formatter:"{b}: {c}"},series:[]}}getChartType(){return"treemap"}getDefaultSeriesOptions(){return{name:"Treemap Chart",type:"treemap",breadcrumb:{show:!0,top:"10%",left:"10%",right:"10%",bottom:"10%"},itemStyle:{borderColor:"#fff",borderWidth:1,gapWidth:1},label:{show:!0,formatter:"{b}",fontSize:12,color:"#333"},levels:[{itemStyle:{borderColor:"#777",borderWidth:1,gapWidth:1},label:{show:!1}},{itemStyle:{borderColor:"#555",borderWidth:1,gapWidth:1},label:{show:!0}},{itemStyle:{borderColor:"#555",borderWidth:1,gapWidth:1},label:{show:!0}}],emphasis:{itemStyle:{shadowBlur:3,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},roam:!0,nodeClick:"zoomToNode"}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setBreadcrumb(t,e,i,n,s){return this.seriesOptions.breadcrumb={show:t,top:e,left:i,right:n,bottom:s,height:22,emptyItemWidth:25,itemStyle:{color:"rgba(0,0,0,0.7)",borderColor:"rgba(0,0,0,0.7)",borderWidth:1,shadowBlur:3,shadowColor:"rgba(0, 0, 0, 0.2)",textStyle:{color:"#fff"}},emphasis:{itemStyle:{color:"rgba(0,0,0,0.9)"}}},this}setItemStyle(t,e,i){return this.seriesOptions.itemStyle={borderColor:t,borderWidth:e,gapWidth:i},this}setLabelFormatter(t){return this.seriesOptions.label||(this.seriesOptions.label={}),this.seriesOptions.label.formatter=t,this}setLevels(t){return this.seriesOptions.levels=t,this}setRoam(t){return this.seriesOptions.roam=t,this}setNodeClick(t){return this.seriesOptions.nodeClick=t,this}setSize(t,e){return this.seriesOptions.width=t,this.seriesOptions.height=e,this}build(){let t=B(T({},this.chartOptions),{series:[B(T({},this.seriesOptions),{type:"treemap"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e,i){ve.updateData(t,e,i)}static transformToTreemapData(t,e){if(!t||t.length===0)return[];let i=e?.valueField||"value",n=e?.nameField||"name",s=e?.childrenField||"children",a=e?.maxDepth||3,o=e?.minValue||0,c=(l,h)=>{let u={name:String(l[n])||"Unknown",value:Number(l[i])||0};return u.value<o||h<a&&l[s]&&Array.isArray(l[s])&&(u.children=l[s].map(f=>c(f,h+1)).filter(f=>f.value>=o)),u};return t.map(l=>c(l,0))}static createHierarchyFromFlat(t,e){let{idField:i,parentField:n,valueField:s,nameField:a}=e,o=new Map,c=[];return!t||!Array.isArray(t)||t.length===0||(t.forEach(l=>{if(!l||l[i]==null)return;let h={name:String(l[a])||"Unknown",value:Number(l[s])||0,children:[]};o.set(l[i],h)}),t.forEach(l=>{if(!l||l[i]==null)return;let h=o.get(l[i]);if(!h)return;let u=l[n];if(u!=null&&o.has(u)){let f=o.get(u);f&&f.children&&f.children.push(h)}else c.push(h)})),c}setFinancialDisplay(t="USD",e="en-US"){this.setCurrencyFormatter(t,e);let i=new Intl.NumberFormat(e,{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0});return this.setLabelFormatter(n=>`${n.data.name}
${i.format(n.data.value)}`),this}setPercentageDisplay(t=1){return this.setPercentageFormatter(t),this.setLabelFormatter(e=>`${e.data.name}
${e.data.value.toFixed(t)}%`),this}setZoomBehavior(t=!0,e="zoomToNode",i=!0){return this.setRoam(i),e&&this.setNodeClick(e),this}setDrillDownAnimations(){return this.chartOptions.animationDuration=1e3,this.chartOptions.animationDurationUpdate=1e3,this.chartOptions.animationEasing="cubicInOut",this.chartOptions.animationEasingUpdate="quinticInOut",this.seriesOptions.animation=!0,this.seriesOptions.animationDuration=1e3,this.seriesOptions.animationDurationUpdate=1e3,this.seriesOptions.animationEasing="cubicInOut",this.seriesOptions.animationEasingUpdate="quinticInOut",this}setDrillDownEventHandlers(t,e){return this.chartOptions.customEventHandlers||(this.chartOptions.customEventHandlers={}),t&&(this.chartOptions.customEventHandlers.onDrillDown=t),e&&(this.chartOptions.customEventHandlers.onBreadcrumbClick=e),this}setPortfolioConfiguration(){return this.setBreadcrumb(!0,"bottom","10%","10%","10%").setItemStyle("#fff",1,1).setLevels([{itemStyle:{borderColor:"#777",borderWidth:0,gapWidth:5,borderColorSaturation:.6},upperLabel:{show:!1},label:{show:!1}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1,borderColorSaturation:.7},label:{show:!0,formatter:`{b}
\u20B9{c}`,fontSize:12,fontWeight:"bold"}},{itemStyle:{borderColor:"#333",borderWidth:5,gapWidth:1,borderColorSaturation:.8},label:{show:!0,formatter:`{b}
\u20B9{c}`,fontSize:10}}]).setEmphasis(10,0,"rgba(0, 0, 0, 0.5)").setZoomBehavior(!0,"zoomToNode",!0).setDrillDownAnimations()}setExpenseConfiguration(){return this.setBreadcrumb(!0,"10%","10%","10%","10%").setItemStyle("#fff",1,1).setLevels([{itemStyle:{borderColor:"#777",borderWidth:0,gapWidth:1},label:{show:!1}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},label:{show:!0,formatter:"{b}\n${c}K"}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},label:{show:!0,formatter:"{b}\n${c}K"}}]).setEmphasis(10,0,"rgba(0, 0, 0, 0.5)").setZoomBehavior(!0,"zoomToNode",!0)}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return null;let t=this.filterColumn,e=[...new Set(this.data.map(i=>i[t]))];return{column:this.filterColumn,operator:"in",value:e}}static isTreemapChart(t){return ve.isChartType(t,"treemap")}static createTreemapChartWidget(t){let e=new r;return t&&e.setData(t),e.widgetBuilder}static exportData(t){let e=t.echartsOptions;if(!e||!e.series||!e.series[0]||!e.series[0].data)return[];let i=e.series[0].data;return this.flattenTreemapData(i)}static getExportHeaders(t){return["Name","Value","Level"]}static getExportSheetName(t){return"Treemap Data"}static flattenTreemapData(t,e=0){let i=[];for(let n of t)i.push({name:n.name,value:n.value,level:e}),n.children&&n.children.length>0&&i.push(...this.flattenTreemapData(n.children,e+1));return i}};var Nn=class r extends ve{constructor(){super(),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{tooltip:{trigger:"item",formatter:"{b}: {c}"},legend:{show:!0,orient:"vertical",left:"left",top:"middle"}}}getChartType(){return"sunburst"}getDefaultSeriesOptions(){return{name:"Sunburst Chart",type:"sunburst",radius:["20%","90%"],center:["50%","50%"],itemStyle:{borderWidth:2,borderColor:"#fff"},label:{show:!0,formatter:"{b}",position:"inside",fontSize:12,color:"#fff",rotate:"radial"},levels:[{itemStyle:{borderWidth:2,borderColor:"#777"}},{itemStyle:{borderWidth:1,borderColor:"#555"}},{itemStyle:{borderWidth:1,borderColor:"#333"}}],sort:"desc",animationDuration:1e3,animationEasing:"cubicOut"}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setRadius(t){return this.seriesOptions.radius=t,this}setCenter(t){return this.seriesOptions.center=t,this}setLevels(t){return this.seriesOptions.levels=t,this}setSort(t){return this.seriesOptions.sort=t,this}setAnimationDuration(t){return this.seriesOptions.animationDuration=t,this}setAnimationEasing(t){return this.seriesOptions.animationEasing=t,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&this.setLevels([{itemStyle:{color:e[0]}},{itemStyle:{color:e[1]||e[0]}},{itemStyle:{color:e[2]||e[0]}}]),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("item",n=>`${n.data.name}: ${i(n.data.value)}`),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("item",i=>`${i.data.name}: ${e(i.data.value)}`),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("item",n=>`${n.data.name}: ${i(n.data.value)}`),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(){let t=[{name:"Technology",value:100,children:[{name:"Software",value:60,children:[{name:"Frontend",value:30},{name:"Backend",value:30}]},{name:"Hardware",value:40,children:[{name:"Servers",value:25},{name:"Devices",value:15}]}]},{name:"Marketing",value:80,children:[{name:"Digital",value:50},{name:"Traditional",value:30}]},{name:"Operations",value:70,children:[{name:"Logistics",value:40},{name:"Support",value:30}]}];return this.setData(t)}setOrganizationalStructureConfiguration(){return this.setPredefinedPalette("business").setCustomNumberFormatter(0,"en-US").setRadius(["15%","85%"]).setLabelFormatter("{b}").setSort("desc")}setBudgetAllocationConfiguration(){return this.setPredefinedPalette("finance").setCurrencyFormatter("USD","en-US").setRadius(["20%","90%"]).setLabelFormatter("{b}: {c}").setSort("desc")}setCategoryAnalysisConfiguration(){return this.setPredefinedPalette("modern").setPercentageFormatter(1).setRadius(["25%","95%"]).setLabelFormatter("{b}").setSort("desc")}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",parentField:n="parent",levelField:s="level",categoryField:a="category",sortBy:o,sortOrder:c="desc",limit:l}=t;try{let h=this.data;t.filters&&t.filters.length>0&&(h=ve.applyFilters(this.data,t.filters));let u=this.buildHierarchy(h,e,i,n,s);o==="value"&&this.sortHierarchy(u,c),l&&l>0&&u.length>l&&u.splice(l),this.seriesOptions.data=u}catch(h){console.error("Error transforming sunburst chart data:",h)}return this}buildHierarchy(t,e,i,n,s){let a=new Map,o=[];return t.forEach(c=>{let l=c[e]||"Unknown",h=parseFloat(c[i])||0,u=c[n],f={name:l,value:h,children:[]};a.set(l,f),u||o.push(f)}),t.forEach(c=>{let l=c[e]||"Unknown",h=c[n];if(h&&a.has(h)&&a.has(l)){let u=a.get(h),f=a.get(l);u.children||(u.children=[]),u.children.push(f)}}),o}sortHierarchy(t,e){t.sort((i,n)=>{let s=i.value||0,a=n.value||0;return e==="asc"?s-a:a-s}),t.forEach(i=>{i.children&&i.children.length>0&&this.sortHierarchy(i.children,e)})}build(){let t=B(T({},this.chartOptions),{series:[B(T({},this.seriesOptions),{type:"sunburst"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>({name:l.name||"Unknown",value:parseFloat(l.value)||0,children:l.children||[]})));let o=t.chartInstance.getOption(),c=B(T({},o),{series:[B(T({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating sunburst chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isSunburstChart(t){return ve.isChartType(t,"sunburst")}static createSunburstChartWidget(t){return r.create().setData(t||[]).setHeader("Sunburst Chart").setPosition({x:0,y:0,cols:4,rows:4}).getWidgetBuilder()}static exportData(t){let e=t.data||[],i=[],n=(s,a=0,o="")=>{s.forEach(c=>{i.push({Level:a,Parent:o,Name:c.name,Value:c.value||0}),c.children&&c.children.length>0&&n(c.children,a+1,c.name)})};return n(e),i}static getExportHeaders(t){return["Level","Parent","Name","Value"]}static getExportSheetName(t){return(t.config?.header?.title||"Sunburst Chart").replace(/[^a-zA-Z0-9\s]/g,"").substring(0,31)}};var Bn=class r extends ve{constructor(){super(),this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{tooltip:{trigger:"item",triggerOn:"mousemove",formatter:"{b}: {c}"},legend:{show:!1}}}getChartType(){return"sankey"}getDefaultSeriesOptions(){return{name:"Sankey Chart",type:"sankey",emphasis:{focus:"adjacency"},lineStyle:{color:"source",curveness:.5}}}setData(t){return this.seriesOptions.data=t.nodes,this.seriesOptions.links=t.links,super.setData(t),this}setNodeWidth(t){return this.seriesOptions.nodeWidth=t,this}setNodeGap(t){return this.seriesOptions.nodeGap=t,this}setNodeAlign(t){return this.seriesOptions.nodeAlign=t,this}setLayoutIterations(t){return this.seriesOptions.layoutIterations=t,this}setLayout(t){return this.seriesOptions.layout=t,this}setCurveness(t){return this.seriesOptions.lineStyle||(this.seriesOptions.lineStyle={}),this.seriesOptions.lineStyle.curveness=t,this}setLineColor(t){return this.seriesOptions.lineStyle||(this.seriesOptions.lineStyle={}),this.seriesOptions.lineStyle.color=t,this}setNodeColors(t){return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.color=t,this}setEmphasisFocus(t){return this.seriesOptions.emphasis||(this.seriesOptions.emphasis={}),this.seriesOptions.emphasis.focus=t,this}build(){let t=this.seriesOptions.data?.nodes,e=this.seriesOptions.data?.links,i=B(T({},this.chartOptions),{series:[B(T({},this.seriesOptions),{type:"sankey",data:t,links:e})]});return this.widgetBuilder.setEChartsOptions(i).build()}static updateData(t,e,i){t.config?.options?.series?.[0]&&(t.config.options.series[0].data=e.nodes,t.config.options.series[0].links=e.links),t.data=e,ve.updateData(t,e,i)}static transformToSankeyData(t,e){if(!t||t.length===0)return{nodes:[],links:[]};let i=e?.sourceField||"source",n=e?.targetField||"target",s=e?.valueField||"value",a=e?.aggregateBy||"sum",o=new Set;t.forEach(u=>{o.add(String(u[i])),o.add(String(u[n]))});let c=Array.from(o).map(u=>({name:u})),l=new Map;t.forEach(u=>{let f=String(u[i]),p=String(u[n]),x=Number(u[s])||1,d=`${f}->${p}`;if(l.has(d)){let g=l.get(d);l.set(d,a==="sum"?g+x:g+1)}else l.set(d,a==="sum"?x:1)});let h=Array.from(l.entries()).map(([u,f])=>{let[p,x]=u.split("->");return{source:p,target:x,value:f}});return{nodes:c,links:h}}setFinancialFlow(){return this.setNodeWidth(20).setNodeGap(8).setLayout("left").setCurveness(.5).setEmphasisFocus("adjacency").setNodeColors(["#5470c6","#91cc75","#fac858","#ee6666","#73c0de"])}setBudgetAllocation(){return this.setNodeWidth(15).setNodeGap(10).setLayout("left").setCurveness(.4).setEmphasisFocus("adjacency").setNodeColors(["#2E8B57","#4682B4","#DAA520","#DC143C","#9370DB"])}setInvestmentFlow(){return this.setNodeWidth(25).setNodeGap(12).setLayout("left").setCurveness(.3).setEmphasisFocus("adjacency").setNodeColors(["#667eea","#764ba2","#f093fb","#f5576c","#4facfe"])}setPercentageDisplay(){return this.setTooltip("item",t=>t.data.source?`${t.data.source} \u2192 ${t.data.target}<br/>Value: ${t.data.value}%`:`${t.data.name}<br/>Total: ${t.data.value||0}%`),this}setCurrencyDisplay(t="USD",e="en-US"){let i=new Intl.NumberFormat(e,{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0});return this.setTooltip("item",n=>n.data.source?`${n.data.source} \u2192 ${n.data.target}<br/>Amount: ${i.format(n.data.value)}`:`${n.data.name}<br/>Total: ${i.format(n.data.value||0)}`),this}setMinimalConfiguration(){return this.setNodeWidth(10).setNodeGap(5).setLayout("none").setCurveness(.5).setEmphasisFocus("adjacency")}static isSankeyChart(t){return t.config?.component==="echart"&&t.config?.options?.series?.[0]?.type==="sankey"}static exportData(t){let e=t.data;return!e||!e.links?[]:e.links.map(i=>({Source:i.source,Target:i.target,Value:i.value}))}static getExportHeaders(t){return["Source","Target","Value"]}static getExportSheetName(t){return(t.config?.header?.title||"Sankey Chart").replace(/[^a-zA-Z0-9\s]/g,"").substring(0,31)}};var pu=class r extends ve{constructor(){super(),this.xAxisData=[],this.filterColumn="",this.timeRangeFilters=["1D","5D","1M","3M","6M","YTD","1Y","3Y","5Y","MAX"],this.selectedTimeRange="1Y",this.showAreaSeries=!0,this.areaSeriesOpacity=.3,this.showVolume=!0,this.showLegend=!0,this.showDataZoom=!0,this.graphicElements=[],this.seriesOptions=this.getDefaultSeriesOptions(),this.volumeSeriesOptions=this.getDefaultVolumeSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:[{left:"10%",right:"10%",top:"10%",height:"60%"},{left:"10%",right:"10%",top:"75%",height:"12%"}],tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:t=>{if(Array.isArray(t)){let e=`${t[0].name}<br/>`;return t.forEach(i=>{if(i.seriesName==="Candlestick"){let n=i.data;e+=`Open: ${n[1]}<br/>Close: ${n[2]}<br/>Low: ${n[3]}<br/>High: ${n[4]}<br/>`}else i.seriesName==="Volume"&&(e+=`Volume: ${i.data[1]}<br/>`)}),e}else{let e=t,i=e.data;return`${e.name}<br/>
                    Open: ${i[1]}<br/>
                    Close: ${i[2]}<br/>
                    Low: ${i[3]}<br/>
                    High: ${i[4]}`}}},xAxis:[{type:"category",data:[],boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},min:"dataMin",max:"dataMax"},{type:"category",gridIndex:1,data:[],boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},axisLabel:{show:!1},min:"dataMin",max:"dataMax"}],yAxis:[{scale:!0,splitArea:{show:!0}},{scale:!0,gridIndex:1,splitNumber:2,axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}}],dataZoom:[{type:"inside",xAxisIndex:[0,1],start:0,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",top:"92%",start:0,end:100}],legend:{data:["Candlestick","Volume"],top:"5%",left:"center"}}}getChartType(){return"candlestick"}getDefaultSeriesOptions(){return{name:"Candlestick",type:"candlestick",data:[],itemStyle:{color:"#00da3c",color0:"#ec0000",borderColor:"#008F28",borderColor0:"#8A0000",borderWidth:1}}}getDefaultVolumeSeriesOptions(){return{name:"Volume",type:"bar",xAxisIndex:1,yAxisIndex:1,data:[],itemStyle:{color:"#7fbe9e",color0:"#d87a80",opacity:.8}}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{dateField:e="date",openField:i="open",closeField:n="close",lowField:s="low",highField:a="high",volumeField:o="volume",sortBy:c,sortOrder:l="asc",limit:h}=t;try{let u=[],f=[],p=[],x=this.data;if(t.filters&&t.filters.length>0&&(x=ve.applyFilters(this.data,t.filters)),x.forEach(d=>{let g=d[e],I=parseFloat(d[i])||0,O=parseFloat(d[n])||0,A=parseFloat(d[s])||0,V=parseFloat(d[a])||0,q=parseFloat(d[o])||0;p.push(g),u.push([I,O,A,V]),f.push([g,q])}),c==="date"){let d=p.map((g,I)=>({label:g,candlestickData:u[I],volumeData:f[I]}));d.sort((g,I)=>{let O=new Date(g.label).getTime(),A=new Date(I.label).getTime();return l==="asc"?O-A:A-O}),p=d.map(g=>g.label),u=d.map(g=>g.candlestickData),f=d.map(g=>g.volumeData)}h&&h>0&&(p=p.slice(0,h),u=u.slice(0,h),f=f.slice(0,h)),this.seriesOptions.data=u,this.volumeSeriesOptions.data=f,this.setXAxisData(p)}catch(u){console.error("Error transforming candlestick chart data:",u)}return this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis&&Array.isArray(this.chartOptions.xAxis)?(this.chartOptions.xAxis[0].data=t,this.chartOptions.xAxis[1].data=t):this.chartOptions.xAxis=B(T({},this.chartOptions.xAxis),{data:t}),this}setXAxisName(t){return this.chartOptions.xAxis=B(T({},this.chartOptions.xAxis),{name:t}),this}setYAxisName(t){return this.chartOptions.yAxis&&Array.isArray(this.chartOptions.yAxis)?this.chartOptions.yAxis[0].name=t:this.chartOptions.yAxis=B(T({},this.chartOptions.yAxis),{name:t}),this}enableVolume(t=!0){return this.showVolume=t,this}enableLegend(t=!0){return this.showLegend=t,this}enableDataZoom(t=!0){return this.showDataZoom=t,this}setCandlestickColors(t="#00da3c",e="#ec0000",i="#808080"){return this.seriesOptions.itemStyle?(this.seriesOptions.itemStyle.color=t,this.seriesOptions.itemStyle.color0=e,this.seriesOptions.itemStyle.borderColor=t,this.seriesOptions.itemStyle.borderColor0=e):this.seriesOptions.itemStyle={color:t,color0:e,borderColor:t,borderColor0:e,borderWidth:1},this}setBarWidth(t){return this.seriesOptions.itemStyle?this.seriesOptions.itemStyle.barWidth=t:this.seriesOptions.itemStyle={barWidth:t},this}enableTimeRangeFilters(t=["1D","5D","1M","3M","6M","YTD","1Y","3Y","5Y","MAX"],e="1Y"){return this.timeRangeFilters=t,this.selectedTimeRange=e,this.chartOptions.timeRangeFilters={selectedRange:this.selectedTimeRange,ranges:this.timeRangeFilters},this}setSelectedTimeRange(t){return this.selectedTimeRange=t,this.chartOptions.timeRangeFilters&&(this.chartOptions.timeRangeFilters.selectedRange=t),this}setTimeRangeChangeCallback(t){return console.log("\u{1F525} setTimeRangeChangeCallback called with callback:",!!t),this.timeRangeChangeCallback=t,console.log("\u{1F525} Stored timeRangeChangeCallback:",!!this.timeRangeChangeCallback),this.setFilterChangeCallback(e=>{if(console.log("\u{1F525} Filter change callback triggered:",e),e.type==="customFilter"&&e.filterType==="timeRange"){let i={type:"timeRangeChange",range:e.value,widgetId:e.widgetId};console.log("\u{1F525} Calling time range callback with event:",i),t(i)}}),this.setEvents((e,i)=>{console.log("\u{1F525} Setting up event handler in setTimeRangeChangeCallback"),console.log("\u{1F525} Widget:",e),console.log("\u{1F525} Chart instance:",i),i&&(console.log("\u{1F525} Chart instance available, setting up click handler"),i.off("click"),i.on("click",n=>{if(console.log("\u{1F525} Chart click detected:",n),console.log("\u{1F525} Component type:",n.componentType),console.log("\u{1F525} Component sub type:",n.componentSubType),console.log("\u{1F525} Data:",n.data),console.log("\u{1F525} Component index:",n.componentIndex),n.componentType==="graphic"){console.log("\u{1F525} Graphic element clicked:",n);let s=i.getOption();console.log("\u{1F525} Chart options structure:",s);let a=[];if(s.graphic)a=s.graphic;else if(s.elements&&s.elements.graphic)a=s.elements.graphic;else if(Array.isArray(s)){for(let c of s)if(c.graphic){a=c.graphic;break}}console.log("\u{1F525} Graphic elements found:",a),console.log("\u{1F525} Component index:",n.componentIndex),console.log("\u{1F525} Graphic elements length:",a.length);let o=a[n.componentIndex];if((!o||!o.range)&&(console.log("\u{1F525} Using fallback: stored graphic elements"),console.log("\u{1F525} Stored graphic elements:",this.graphicElements),o=this.graphicElements[n.componentIndex]),console.log("\u{1F525} Clicked graphic element:",o),console.log("\u{1F525} Element range:",o?.range),console.log("\u{1F525} Element filterType:",o?.filterType),console.log("\u{1F525} Element filterValue:",o?.filterValue),o&&(o.range||o.filterValue)){let c=o.range||o.filterValue;return console.log("\u{1F525} Time range filter graphic clicked:",c),this.selectedTimeRange=c,console.log("\u{1F525} Updated selectedTimeRange to:",this.selectedTimeRange),this.filterChangeCallback?(console.log("\u{1F525} Triggering filter change callback"),this.filterChangeCallback({type:"customFilter",filterType:"timeRange",value:c,widgetId:e.id})):console.warn("\u{1F525} No filter change callback available!"),this.timeRangeChangeCallback?(console.log("\u{1F525} Triggering time range change callback with range:",c),this.timeRangeChangeCallback({type:"timeRangeChange",range:c,widgetId:e.id})):console.warn("\u{1F525} No time range change callback set!"),typeof window<"u"&&window.handleTimeRangeFilterClick?(console.log("\u{1F525} Triggering global fallback function"),window.handleTimeRangeFilterClick(c)):console.warn("\u{1F525} Global fallback function not available!"),!1}else console.log("\u{1F525} Graphic element clicked but no range/filterValue found")}return!0}))}),this}enableAreaSeries(t=!0,e=.3){return this.showAreaSeries=t,this.areaSeriesOpacity=e,this}setAreaSeriesOpacity(t){return this.areaSeriesOpacity=Math.max(0,Math.min(1,t)),this}enableBrush(){return this.chartOptions.brush={xAxisIndex:0,brushLink:"all",outOfBrush:{colorAlpha:.1},brushStyle:{borderWidth:1,color:"rgba(120,140,180,0.3)",borderColor:"rgba(120,140,180,0.8)"}},this}setLargeMode(t=600){return this.data&&this.data.length>=t&&(this.chartOptions.useUTC=!0,this.chartOptions.animation=!1,this.chartOptions.progressive=500,this.chartOptions.progressiveThreshold=3e3),this}setTooltipType(t="axis"){return this.chartOptions.tooltip=B(T({},this.chartOptions.tooltip),{trigger:t}),this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>=2&&(this.seriesOptions.itemStyle=B(T({},this.seriesOptions.itemStyle),{color:e[0],color0:e[1],borderColor:e[0],borderColor0:e[1]})),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("axis",n=>{let s=Array.isArray(n)?n[0]:n,a=s.data;return`${s.name}<br/>
              Open: ${i(a[1])}<br/>
              Close: ${i(a[2])}<br/>
              Low: ${i(a[3])}<br/>
              High: ${i(a[4])}`}),this}setPercentageFormatter(t=2){let e=this.createPercentageFormatter(t);return this.setTooltip("axis",i=>{let n=Array.isArray(i)?i[0]:i,s=n.data;return`${n.name}<br/>
              Open: ${e(s[1])}<br/>
              Close: ${e(s[2])}<br/>
              Low: ${e(s[3])}<br/>
              High: ${e(s[4])}`}),this}setCustomNumberFormatter(t=2,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("axis",n=>{let s=Array.isArray(n)?n[0]:n,a=s.data;return`${s.name}<br/>
              Open: ${i(a[1])}<br/>
              Close: ${i(a[2])}<br/>
              Low: ${i(a[3])}<br/>
              High: ${i(a[4])}`}),this}setBorderColors(t,e){return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.borderColor=t,this.seriesOptions.itemStyle.borderColor0=e,this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=30){let e=[],i=100;for(let n=0;n<t;n++){let s=new Date;s.setDate(s.getDate()-(t-n));let a=i,o=(Math.random()-.5)*10,c=Math.max(.1,a+o),l=Math.max(a,c)+Math.random()*5,h=Math.min(a,c)-Math.random()*5;e.push({date:s.toISOString().split("T")[0],open:parseFloat(a.toFixed(2)),close:parseFloat(c.toFixed(2)),high:parseFloat(l.toFixed(2)),low:parseFloat(h.toFixed(2)),volume:Math.floor(Math.random()*1e6),symbol:"SAMPLE"}),i=c}return this.setData(e)}setStockAnalysisConfiguration(){return this.setPredefinedPalette("finance").setXAxisName("Date").setYAxisName("Price").setCurrencyFormatter("USD","en-US").setTooltip("axis")}setCryptoAnalysisConfiguration(){return this.setPredefinedPalette("modern").setXAxisName("Date").setYAxisName("Price (USD)").setCurrencyFormatter("USD","en-US")}setForexAnalysisConfiguration(){return this.setPredefinedPalette("business").setXAxisName("Date").setYAxisName("Exchange Rate").setCustomNumberFormatter(4,"en-US")}build(){console.log("\u{1F525} build() method called"),console.log("\u{1F525} timeRangeChangeCallback available:",!!this.timeRangeChangeCallback),console.log("\u{1F525} filterChangeCallback available:",!!this.filterChangeCallback);let t=[B(T({},this.seriesOptions),{type:"candlestick"})];if(this.showVolume&&t.push(B(T({},this.volumeSeriesOptions),{type:"bar",xAxisIndex:1,yAxisIndex:1,data:this.volumeSeriesOptions.data||[]})),this.showAreaSeries){let n=this.seriesOptions.data?.map(s=>s[1])||[];t.push({name:"Close Price Area",type:"line",data:n,smooth:!0,symbol:"none",lineStyle:{width:1,color:"#1976d2"},areaStyle:{color:this.getAreaSeriesColor(),opacity:this.areaSeriesOpacity},z:1,yAxisIndex:0,xAxisIndex:0})}if(this.timeRangeFilters.length>0){console.log("Creating time range filters:",this.timeRangeFilters),console.log("Selected time range:",this.selectedTimeRange),console.log("Time range filter details:",this.timeRangeFilters.map((c,l)=>({index:l,range:c,charCode:c.charCodeAt(0),length:c.length,hex:Array.from(c).map(h=>h.charCodeAt(0).toString(16)).join(" ")})));let n=this.timeRangeFilters.map((c,l)=>({type:"rect",left:10+l*40,top:10,width:35,height:28,style:{fill:c===this.selectedTimeRange?"#2196f3":"#ffffff",stroke:c===this.selectedTimeRange?"#1976d2":"#e0e0e0",lineWidth:c===this.selectedTimeRange?2.5:1.5,borderRadius:4,shadowBlur:c===this.selectedTimeRange?8:2,shadowColor:c===this.selectedTimeRange?"rgba(33, 150, 243, 0.5)":"rgba(0, 0, 0, 0.15)",shadowOffsetX:(c===this.selectedTimeRange,0),shadowOffsetY:c===this.selectedTimeRange?4:1},range:c,cursor:"pointer",silent:!1,filterType:"timeRange",filterValue:c})),s=this.timeRangeFilters.map((c,l)=>(c==="1Y"&&console.log("Creating Y text element at index:",l,"position:",10+l*40+17.5,"top:",24),{type:"text",left:10+l*40+17.5,top:24,style:{text:c,fill:c===this.selectedTimeRange?"#ffffff":"#333333",fontSize:10,fontWeight:c===this.selectedTimeRange?"bold":"600",textAlign:"center",textVerticalAlign:"middle",fontFamily:"Verdana, Arial, sans-serif",textShadow:c===this.selectedTimeRange?"0 1px 2px rgba(0,0,0,0.3)":"none"},range:c,cursor:"pointer",silent:!1,filterType:"timeRange",filterValue:c})),a=this.timeRangeFilters.indexOf(this.selectedTimeRange),o=a>=0?[{type:"rect",left:10+a*40+5,top:40,width:25,height:2,style:{fill:"#1565c0",borderRadius:1}}]:[];this.graphicElements=[...n,...s,...o],this.chartOptions.graphic=this.graphicElements,console.log("Chart grid configuration:",this.chartOptions.grid),console.log("Chart container width should accommodate:",this.timeRangeFilters.length*45+10,"px"),console.log("Time range filters created:",this.timeRangeFilters.length,"filters"),console.log("Time range filter positions:",n.map((c,l)=>`${this.timeRangeFilters[l]}: left=${c.left}, width=${c.width}`)),console.log("All time range filters:",this.timeRangeFilters),console.log("1Y filter index:",this.timeRangeFilters.indexOf("1Y")),console.log("Selected time range:",this.selectedTimeRange),console.log("Total width needed:",this.timeRangeFilters.length*40+10,"px"),console.log("1Y button position:",n.find((c,l)=>this.timeRangeFilters[l]==="1Y")),console.log("1Y text position:",s.find((c,l)=>this.timeRangeFilters[l]==="1Y"))}let e=B(T({},this.chartOptions),{series:t});if(console.log("\u{1F527} Final series data:",{candlestickData:t[0]?.data?.length||0,volumeData:t[1]?.data?.length||0,areaData:t[2]?.data?.length||0}),this.showVolume?(console.log("\u{1F527} Building chart with volume enabled - ensuring dual-axis configuration"),e.grid=[{left:"10%",right:"10%",top:"10%",height:"60%"},{left:"10%",right:"10%",top:"75%",height:"12%"}],e.xAxis=[{type:"category",data:this.xAxisData,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},min:"dataMin",max:"dataMax"},{type:"category",gridIndex:1,data:this.xAxisData,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},axisLabel:{show:!1},min:"dataMin",max:"dataMax"}],e.yAxis=[{scale:!0,splitArea:{show:!0}},{scale:!0,gridIndex:1,splitNumber:2,axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}}],console.log("\u{1F527} Dual-axis configuration applied:",{gridCount:e.grid?.length,xAxisCount:e.xAxis?.length,yAxisCount:e.yAxis?.length,seriesCount:e.series?.length})):console.log("\u{1F527} Building chart without volume - single-axis configuration"),!this.showLegend)delete e.legend;else{let n=["Candlestick"];this.showVolume&&n.push("Volume"),this.showAreaSeries&&n.push("Close Price Area"),e.legend=B(T({},e.legend),{data:n})}this.showDataZoom?this.showVolume&&(e.dataZoom=[{type:"inside",xAxisIndex:[0,1],start:0,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",top:"90%",start:0,end:100}]):delete e.dataZoom;let i=this.widgetBuilder.setEChartsOptions(e).build();return i.height=600,console.log("\u{1F527} Candlestick chart widget height set to:",i.height),console.log("\u{1F527} Chart options being set:",{seriesCount:e.series?.length||0,xAxisCount:e.xAxis?.length||0,yAxisCount:e.yAxis?.length||0,gridCount:e.grid?.length||0,hasData:e.series?.[0]?.data?.length||0}),this.timeRangeFilters.length>0&&(i.timeRangeFilters={ranges:this.timeRangeFilters,selectedRange:this.selectedTimeRange}),i}static updateTimeRangeFilters(t,e,i){if(t.chartInstance)try{let n=t.chartInstance.getOption(),s=t.timeRangeFilters;if(!s||!s.ranges)return;t.timeRangeFilters.selectedRange=e;let a=s.ranges.map((u,f)=>({type:"rect",left:10+f*55,top:5,width:50,height:28,style:{fill:u===e?"#1565c0":"#f5f5f5",stroke:u===e?"#1565c0":"#e0e0e0",lineWidth:1.5,borderRadius:6,shadowBlur:u===e?4:1,shadowColor:u===e?"rgba(21, 101, 192, 0.3)":"rgba(0, 0, 0, 0.1)",shadowOffsetX:0,shadowOffsetY:u===e?2:1},range:u,cursor:"pointer",filterType:"timeRange",filterValue:u,onclick:()=>{console.log("Time range filter clicked:",u),i&&i({type:"timeRangeChange",range:u,widgetId:t.id}),typeof window<"u"&&window.handleTimeRangeFilterClick&&window.handleTimeRangeFilterClick(u)}})),o=s.ranges.map((u,f)=>({type:"text",left:10+f*55+25,top:19,style:{text:u,fill:u===e?"#ffffff":"#37474f",fontSize:11,fontWeight:u===e?"bold":"600",textAlign:"center",textVerticalAlign:"middle",fontFamily:"Verdana, Arial, sans-serif",textShadow:u===e?"0 1px 2px rgba(0,0,0,0.3)":"none"},range:u,cursor:"pointer",filterType:"timeRange",filterValue:u,onclick:()=>{console.log("Time range filter text clicked:",u),i&&i({type:"timeRangeChange",range:u,widgetId:t.id}),typeof window<"u"&&window.handleTimeRangeFilterClick&&window.handleTimeRangeFilterClick(u)}})),c=s.ranges.indexOf(e),l=c>=0?[{type:"rect",left:10+c*55+5,top:35,width:40,height:2,style:{fill:"#1565c0",borderRadius:1}}]:[],h=B(T({},n),{graphic:[...a,...o,...l]});t.chartInstance.setOption(h,!0)}catch(n){console.error("Error updating time range filters:",n)}}getTimeRangeFiltersConfig(){return{selectedRange:this.selectedTimeRange,ranges:this.timeRangeFilters}}getAreaSeriesColor(){if(this.seriesOptions.itemStyle?.color){let t=this.seriesOptions.itemStyle.color;return"#e3f2fd"}return"#e3f2fd"}static updateData(t,e){console.log("\u{1F504} CandlestickChartBuilder.updateData called with:",e?.length||0,"records"),console.log("\u{1F504} Sample data:",e?.slice(0,2)),console.log("\u{1F504} Data date range:",e?.length>0?{first:e[0]?.date,last:e[e.length-1]?.date}:"No data");let i=3,n=0,s=()=>{try{if(t.chartInstance){if(console.log("\u2705 Chart instance found, updating data"),console.log("\u{1F504} Chart instance type:",typeof t.chartInstance),console.log("\u{1F504} Chart instance methods:",Object.getOwnPropertyNames(t.chartInstance)),!t.chartInstance.getOption){if(console.warn("\u26A0\uFE0F Chart instance getOption not available, but trying direct update..."),console.log("\u{1F504} Chart instance properties:",Object.getOwnPropertyNames(t.chartInstance)),console.log("\u{1F504} Chart instance prototype:",Object.getPrototypeOf(t.chartInstance)),t.chartInstance.setOption){console.log("\u{1F504} Attempting direct setOption update...");try{let ie={series:[{type:"candlestick",data:e.map(D=>[Number(D.open)||0,Number(D.close)||0,Number(D.low)||0,Number(D.high)||0])}],xAxis:[{type:"category",data:e.map(D=>D.date||"")}],yAxis:[{scale:!0}]};t.chartInstance.setOption(ie,!0),console.log("\u2705 Direct setOption update successful");return}catch(ie){console.error("\u274C Direct setOption update failed:",ie)}}if(n<i){n++,setTimeout(s,100*n);return}else{console.error("\u274C Chart instance never properly initialized after max retries");return}}console.log("\u{1F504} Chart instance is properly initialized, proceeding with data update");let a=e,o=[],c=[];Array.isArray(e)&&e.length>0&&typeof e[0]=="object"?(console.log("\u{1F504} Transforming object data to candlestick format"),a=e.map(ie=>[Number(ie.open)||0,Number(ie.close)||0,Number(ie.low)||0,Number(ie.high)||0]),e[0].volume!==void 0&&(console.log("\u{1F504} Extracting volume data"),o=e.map(ie=>[ie.date||"",Number(ie.volume)||0])),c=e.map(ie=>ie.date||""),console.log("\u{1F504} Transformed data:",a.length,"candlesticks,",o.length,"volume records")):console.log("\u{1F504} Data is already in array format or empty");let l=t.chartInstance.getOption();if(console.log("\u{1F504} Current chart options:",{hasXAxis:!!l.xAxis,xAxisCount:l.xAxis?.length||0,hasYAxis:!!l.yAxis,yAxisCount:l.yAxis?.length||0,hasGrid:!!l.grid,gridCount:l.grid?.length||0,seriesCount:l.series?.length||0,seriesNames:l.series?.map(ie=>ie.name)||[]}),console.log("\u{1F504} Full current options structure:",l),!l||typeof l!="object"){console.error("\u274C Invalid chart options structure:",l);return}if(!l.series&&!l.xAxis&&!l.yAxis){console.log("\u{1F504} Chart options are empty, creating basic structure");let ie={series:[{name:"Candlestick",type:"candlestick",data:a,itemStyle:{color:"#00da3c",color0:"#ec0000",borderColor:"#00da3c",borderColor0:"#ec0000"}}],xAxis:[{type:"category",data:c,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1}}],yAxis:[{scale:!0,splitArea:{show:!0}}],grid:[{left:"10%",right:"10%",top:"10%",height:"65%"}]};console.log("\u{1F504} Setting basic chart options"),t.chartInstance.setOption(ie,!0);return}let h=a.map(ie=>ie[1]),u=l.series||[],f=l.xAxis||[],p=l.yAxis||[],x=l.grid||[],d=[];u[0]?d.push(B(T({},u[0]),{data:a})):d.push({name:"Candlestick",type:"candlestick",data:a,itemStyle:{color:"#00da3c",color0:"#ec0000",borderColor:"#00da3c",borderColor0:"#ec0000"}}),u[1]?.name==="Volume"&&o.length>0?(console.log("\u{1F504} Adding volume series with data:",o.length,"records"),d.push(B(T({},u[1]),{data:o,xAxisIndex:1,yAxisIndex:1,type:"bar"}))):o.length>0&&d.push({name:"Volume",type:"bar",data:o,xAxisIndex:1,yAxisIndex:1,itemStyle:{color:"#7fbe9e"}});let g=u.findIndex(ie=>ie.name==="Close Price Area");g>=0&&d.push(B(T({},u[g]),{data:h}));let I=[B(T({},f[0]||{}),{data:c,type:"category",boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},min:"dataMin",max:"dataMax"}),B(T({},f[1]||{}),{data:c,gridIndex:1,type:"category",boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},axisLabel:{show:!1},min:"dataMin",max:"dataMax"})],O=[B(T({},p[0]||{}),{scale:!0,splitArea:{show:!0}}),B(T({},p[1]||{}),{scale:!0,gridIndex:1,splitNumber:2,axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}})],A=[B(T({},x[0]||{}),{left:"10%",right:"10%",top:"10%",height:"65%"}),B(T({},x[1]||{}),{left:"10%",right:"10%",top:"75%",height:"12%"})],V=B(T({},l),{series:d,xAxis:I,yAxis:O,grid:A});console.log("\u{1F504} Updating chart with new options:",{seriesCount:d.length,xAxisLabelsCount:c.length,candlestickDataCount:a.length,volumeDataCount:o.length}),console.log("\u{1F504} New options structure:",V),console.log("\u{1F504} New series data:",d),t.chartInstance.setOption(V,!0),console.log("\u2705 Chart updated successfully");let q=t.chartInstance.getOption();console.log("\u{1F504} Verification - Updated chart options:",{seriesCount:q.series?.length||0,seriesNames:q.series?.map(ie=>ie.name)||[],xAxisDataCount:q.xAxis?.[0]?.data?.length||0})}else n<i&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating candlestick chart data:",a),n<i&&(n++,setTimeout(s,100*n))}};s()}static isCandlestickChart(t){return ve.isChartType(t,"candlestick")}static exportData(t){let e=[];if(t.echart_options?.series?.[0]?.data&&t.echart_options?.xAxis?.data){let i=t.echart_options.series[0].data,n=t.echart_options.xAxis.data;i.forEach((s,a)=>{e.push({Date:n[a]||`Day ${a+1}`,Open:s[0]||0,Close:s[1]||0,Low:s[2]||0,High:s[3]||0})})}return e}static getExportHeaders(t){return["Date","Open","Close","Low","High"]}static getExportSheetName(t){return"Candlestick Chart Data"}setEvents(t){console.log("\u{1F525} setEvents called with callback:",!!t),console.log("\u{1F525} Current timeRangeChangeCallback:",!!this.timeRangeChangeCallback),console.log("\u{1F525} Current filterChangeCallback:",!!this.filterChangeCallback);let e=(i,n)=>{console.log("\u{1F525} Setting up events for recreated chart"),console.log("\u{1F525} Current data length:",this.data?.length||0),console.log("\u{1F525} Sample data:",this.data?.slice(0,2)),n&&(console.log("\u{1F525} Chart instance available in events:",n),i.chartInstance=n,this.data&&this.data.length>0?(console.log("\u{1F525} Updating chart data immediately after instance is set"),r.updateData(i,this.data)):console.log("\u{1F525} No data available for immediate update, skipping")),t&&t(i,n)};return super.setEvents(e),this}};var La=(()=>{let t=class t{exportDashboardToExcel(s){return Tt(this,arguments,function*(i,n={}){let{filename:a=`dashboard-export-${new Date().toISOString().split("T")[0]}.xlsx`,includeHeaders:o=!0,includeTimestamp:c=!0,sheetNamePrefix:l="Widget",autoColumnWidth:h=!0,includeWidgetTitles:u=!0}=n;try{let f=Ir.book_new();c&&this.addTimestampSheet(f);for(let p of i)try{yield this.exportWidgetToSheet(f,p,{includeHeaders:o,sheetNamePrefix:l,autoColumnWidth:h,includeWidgetTitles:u})}catch(x){console.error(`Error exporting widget ${p.id} to Excel:`,x)}cl(f,a)}catch(f){throw console.error("Error exporting dashboard to Excel:",f),new Error("Failed to export dashboard to Excel")}})}exportWidgetToSheet(i,n,s){return Tt(this,null,function*(){let{includeHeaders:a,sheetNamePrefix:o,autoColumnWidth:c,includeWidgetTitles:l}=s,h=this.getDataExtractor(n);if(!h){console.warn(`No data extractor found for widget type: ${n.config?.component}`);return}try{let u=h.extractData(n),f=h.getHeaders(n),p=h.getSheetName(n);if(!u||u.length===0){console.warn(`No data found for widget: ${n.id}`);let g=[[n.config?.header?.title||"Widget Data"],[],["No data available for export"],["Widget ID:",n.id],["Component:",n.config?.component||"Unknown"],["Export Time:",new Date().toLocaleString()]],I=Ir.aoa_to_sheet(g);Ir.book_append_sheet(i,I,p);return}let x=[];l&&n.config?.header?.title&&(x.push([n.config.header.title]),x.push([])),a&&f.length>0&&x.push(f),x=x.concat(u);let d=Ir.aoa_to_sheet(x);c&&this.autoResizeColumns(d,x),Ir.book_append_sheet(i,d,p)}catch(u){console.error(`Error processing widget ${n.id}:`,u);let f=[[n.config?.header?.title||"Widget Data"],[],["Error occurred during export"],["Widget ID:",n.id],["Component:",n.config?.component||"Unknown"],["Error:",u instanceof Error?u.message:String(u)],["Export Time:",new Date().toLocaleString()]],p=Ir.aoa_to_sheet(f),x=this.getErrorSheetName(n);Ir.book_append_sheet(i,p,x)}})}addTimestampSheet(i){let n=new Date().toLocaleString(),s=[["Dashboard Export Information"],[],["Export Date:",n],["Generated by:","MoneyPlant Dashboard"],["Total Sheets:","Multiple"],["Export Type:","Dashboard Data Export"]],a=Ir.aoa_to_sheet(s);Ir.book_append_sheet(i,a,"Export Info")}autoResizeColumns(i,n){if(!n||n.length===0)return;let s=Math.max(...n.map(a=>a.length));for(let a=0;a<s;a++){let o=10;for(let l of n)if(l[a]!==void 0){let h=String(l[a]);o=Math.max(o,h.length)}let c=Ir.encode_col(a);i["!cols"]=i["!cols"]||[],i["!cols"][a]={width:Math.min(o+2,50)}}}getDataExtractor(i){let n=i.config?.component,s=i.config?.options?.series?.[0]?.type;return n==="echart"&&s?this.getChartDataExtractor(s):n==="table"?{extractData:a=>a.config?.options?.data||[],getHeaders:a=>a.config?.options?.columns||[],getSheetName:a=>this.getWidgetSheetName(a,"Table")}:n==="tile"?{extractData:a=>{let o=a.config?.options;return[[o?.value||"",o?.change||"",o?.changeType||"",o?.description||""]]},getHeaders:()=>["Value","Change","Type","Description"],getSheetName:a=>this.getWidgetSheetName(a,"Tile")}:this.getGenericDataExtractor()}getChartDataExtractor(i){switch(i.toLowerCase()){case"pie":return{extractData:n=>hn.exportData(n),getHeaders:n=>hn.getExportHeaders(n),getSheetName:n=>hn.getExportSheetName(n)};case"bar":return{extractData:n=>un.exportData(n),getHeaders:n=>un.getExportHeaders(n),getSheetName:n=>un.getExportSheetName(n)};case"line":return{extractData:n=>fi.exportData(n),getHeaders:n=>fi.getExportHeaders(n),getSheetName:n=>fi.getExportSheetName(n)};case"scatter":return{extractData:n=>fn.exportData(n),getHeaders:n=>fn.getExportHeaders(n),getSheetName:n=>fn.getExportSheetName(n)};case"gauge":return{extractData:n=>dn.exportData(n),getHeaders:n=>dn.getExportHeaders(n),getSheetName:n=>dn.getExportSheetName(n)};case"heatmap":return{extractData:n=>pn.exportData(n),getHeaders:n=>pn.getExportHeaders(n),getSheetName:n=>pn.getExportSheetName(n)};case"map":return{extractData:n=>mn.exportData(n),getHeaders:n=>mn.getExportHeaders(n),getSheetName:n=>mn.getExportSheetName(n)};case"treemap":return{extractData:n=>Rn.exportData(n),getHeaders:n=>Rn.getExportHeaders(n),getSheetName:n=>Rn.getExportSheetName(n)};case"sunburst":return{extractData:n=>Nn.exportData(n),getHeaders:n=>Nn.getExportHeaders(n),getSheetName:n=>Nn.getExportSheetName(n)};case"sankey":return{extractData:n=>Bn.exportData(n),getHeaders:n=>Bn.getExportHeaders(n),getSheetName:n=>Bn.getExportSheetName(n)};default:return this.getSpecialChartDataExtractor(i)}}getSpecialChartDataExtractor(i){return{extractData:n=>{let a=n.config?.options?.series?.[0];return a?.type==="line"&&a?.areaStyle?a?.stack?Ln.exportData(n):Hn.exportData(n):a?.type==="line"&&a?.coordinateSystem==="polar"?Pn.exportData(n):fi.exportData(n)},getHeaders:n=>{let a=n.config?.options?.series?.[0];return a?.type==="line"&&a?.areaStyle?a?.stack?Ln.getExportHeaders(n):Hn.getExportHeaders(n):a?.type==="line"&&a?.coordinateSystem==="polar"?Pn.getExportHeaders(n):fi.getExportHeaders(n)},getSheetName:n=>{let a=n.config?.options?.series?.[0];return a?.type==="line"&&a?.areaStyle?a?.stack?Ln.getExportSheetName(n):Hn.getExportSheetName(n):a?.type==="line"&&a?.coordinateSystem==="polar"?Pn.getExportSheetName(n):fi.getExportSheetName(n)}}}getGenericDataExtractor(){return{extractData:i=>this.extractGenericData(i),getHeaders:()=>["Property","Value"],getSheetName:i=>this.getWidgetSheetName(i,"Generic")}}extractGenericData(i){let n=[];if(n.push(["Widget ID",i.id]),n.push(["Component Type",i.config?.component||"Unknown"]),n.push(["Title",i.config?.header?.title||"Untitled"]),i.config?.options){let s=i.config.options;Object.keys(s).forEach(a=>{(typeof s[a]!="object"||s[a]===null)&&n.push([a,s[a]])})}return i.series&&i.series.length>0&&n.push(["Series Data",JSON.stringify(i.series)]),n}getWidgetSheetName(i,n){let a=(i.config?.header?.title||i.id).replace(/[^a-zA-Z0-9\s]/g,"").substring(0,20);return`${n}_${a}`}getErrorSheetName(i){return`Error_${i.id}`}exportWidgetToExcel(s){return Tt(this,arguments,function*(i,n={}){let{filename:a=`${i.id}-export-${new Date().toISOString().split("T")[0]}.xlsx`,includeHeaders:o=!0,includeTimestamp:c=!0,autoColumnWidth:l=!0,includeWidgetTitles:h=!0}=n;try{let u=Ir.book_new();c&&this.addTimestampSheet(u),yield this.exportWidgetToSheet(u,i,{includeHeaders:o,sheetNamePrefix:"Widget",autoColumnWidth:l,includeWidgetTitles:h}),cl(u,a)}catch(u){throw console.error("Error exporting widget to Excel:",u),new Error("Failed to export widget to Excel")}})}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ar({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();var Jy=()=>({width:"30%",height:"100%",padding:"0px","padding-right":"2px"});function ew(r,t){if(r&1){let e=Se();U(0,"p-button",9),Ce("click",function(n){J(e);let s=E(2);return ee(s.onDeleteWidgetClicked(n))}),X(),U(1,"p-button",10),Ce("click",function(){J(e);let n=E(2);return ee(n.sidebarVisible=!0)}),X()}r&2&&(M("outlined",!0),S(),M("outlined",!0)("outlined",!0))}function tw(r,t){if(r&1){let e=Se();gt(0,ew,2,3),U(1,"p-button",8,1),Ce("click",function(n){J(e),E();let s=Jt(3);return ee(s.toggle(n))}),X()}if(r&2){let e=E();xt(e.onEditMode?0:-1),S(),M("outlined",!0)}}function rw(r,t){if(r&1&&(U(0,"div",11),ce(1),X()),r&2){let e=E();S(),rt(" ",e.title," Settings ")}}var mu=(()=>{let t=class t{constructor(i){this.excelExportService=i,this.onUpdateWidget=new ye,this.onDeleteWidget=new ye,this.onToggleViewMode=new ye,this.onEditMode=!0,this.currentViewMode="chart",this.sidebarVisible=!1}get title(){return this.widget?.config?.header?.title}get menuItems(){let i=[];return this.currentViewMode==="chart"?i.push({label:"Show Data",icon:"pi pi-table",command:()=>this.toggleToTableView()}):i.push({label:"Show Chart",icon:"pi pi-chart-bar",command:()=>this.toggleToChartView()}),i.push({label:"Export to Excel/CSV",icon:"pi pi-file-excel",command:()=>this.exportToExcel()}),i}onUpdateOptions(i){this.onUpdateWidget.emit(i),this.sidebarVisible=!1}onEditModeClicked(){this.onEditMode=!this.onEditMode}onDeleteWidgetClicked(i){this.onDeleteWidget.emit(this.widget)}toggleToTableView(){this.onToggleViewMode.emit({widgetId:this.widget.id,viewMode:"table"})}toggleToChartView(){this.onToggleViewMode.emit({widgetId:this.widget.id,viewMode:"chart"})}exportToExcel(){return Tt(this,null,function*(){try{let i={filename:`${this.widget.id}-export.xlsx`,includeHeaders:!0,includeTimestamp:!0,autoColumnWidth:!0,includeWidgetTitles:!0};yield this.excelExportService.exportWidgetToExcel(this.widget,i)}catch(i){console.error("Error exporting widget to Excel:",i)}})}};t.\u0275fac=function(n){return new(n||t)(We(La))},t.\u0275cmp=Oe({type:t,selectors:[["vis-widget-header"]],inputs:{widget:"widget",onEditMode:"onEditMode",dashboardId:"dashboardId",currentViewMode:"currentViewMode"},outputs:{onUpdateWidget:"onUpdateWidget",onDeleteWidget:"onDeleteWidget",onToggleViewMode:"onToggleViewMode"},decls:7,vars:11,consts:[["menu",""],["menuButton",""],[3,"header"],["pTemplate","icons"],["appendTo","body",3,"model","popup"],["position","right",3,"visibleChange","visible","modal","appendTo"],["pTemplate","header"],[3,"onUpdate","selectedDashboardId","widget"],["type","button","icon","pi pi-ellipsis-v",1,"p-button-sm","ml-2",3,"click","outlined"],["type","button","icon","pi pi-trash",1,"p-button-sm","mr-2",3,"click","outlined"],["type","button","icon","pi pi-cog",1,"p-button-sm",3,"click","outlined"],[1,"font-bold","ml-3","mb-3","text-lg"]],template:function(n,s){if(n&1){let a=Se();U(0,"p-panel",2),he(1,tw,3,2,"ng-template",3),X(),xe(2,"p-menu",4,0),U(4,"p-drawer",5),Ms("visibleChange",function(c){return J(a),Ds(s.sidebarVisible,c)||(s.sidebarVisible=c),ee(c)}),he(5,rw,2,1,"ng-template",6),U(6,"vis-widget-config",7),Ce("onUpdate",function(c){return J(a),ee(s.onUpdateOptions(c))}),X()()}n&2&&(M("header",s.title),S(2),M("model",s.menuItems)("popup",!0),S(2),kt(vr(10,Jy)),As("visible",s.sidebarVisible),M("modal",!1)("appendTo","body"),S(2),M("selectedDashboardId",s.dashboardId)("widget",s.widget))},dependencies:[Be,Kc,Eo,Cr,Ks,xc,qc,yi,_i,ia,gn],styles:[".panel-button[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:end}[_nghost-%COMP%]     .p-panel .p-panel-content{display:none}[_nghost-%COMP%]     .p-panel .p-panel-header{padding:.5rem 1rem}.widget-data-panel[_ngcontent-%COMP%]{padding:1rem;max-height:400px;overflow:hidden;display:flex;flex-direction:column}.data-header[_ngcontent-%COMP%]{margin-bottom:1rem;padding-bottom:.5rem;border-bottom:1px solid #e0e0e0}.data-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.1rem;font-weight:600;color:#333}.data-info[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:#666}.data-table-container[_ngcontent-%COMP%]{flex:1;overflow:auto;border:1px solid #e0e0e0;border-radius:4px}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.875rem}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:.5rem;text-align:left;font-weight:600;border-bottom:1px solid #e0e0e0;position:sticky;top:0;z-index:1}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem;border-bottom:1px solid #f0f0f0;word-break:break-word}.data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}.data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.no-data[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#666;font-style:italic}[_nghost-%COMP%]     .p-button.p-button-sm{padding:.25rem .5rem;font-size:.875rem}"]});let r=t;return r})();var gu=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=Mr({type:r});static \u0275inj=Or({})}return r})();var Ra=class{constructor(){this.widgets=[],this.filterValues=[],this.dashboardId="",this.isEditMode=!1,this.chartHeight=300,this.defaultChartHeight=400,this.containerConfig=this.getDefaultConfig()}setGridType(t){return this.containerConfig.gridType=t,this}setDisplayGrid(t){return this.containerConfig.displayGrid=t,this}setOuterMargin(t){return this.containerConfig.outerMargin=t,this}setDraggable(t,e){return this.containerConfig.draggable=T({enabled:t},e),this}setResizable(t,e){return this.containerConfig.resizable=T({enabled:t},e),this}setMaxCols(t){return this.containerConfig.maxCols=t,this}setMinCols(t){return this.containerConfig.minCols=t,this}setMaxRows(t){return this.containerConfig.maxRows=t,this}setMinRows(t){return this.containerConfig.minRows=t,this}setFixedColWidth(t){return this.containerConfig.fixedColWidth=t,this}setFixedRowHeight(t){return this.containerConfig.fixedRowHeight=t,this}setEmptyCellConfig(t){return Object.assign(this.containerConfig,t),this}setIgnoreMarginInRow(t){return this.containerConfig.ignoreMarginInRow=t,this}setMobileBreakpoint(t){return this.containerConfig.mobileBreakpoint=t,this}setWidgets(t){return this.widgets=t,this}addWidget(t){return this.widgets.push(t),this}setFilterValues(t){return this.filterValues=t,this}setDashboardId(t){return this.dashboardId=t,this}setEditMode(t){return this.isEditMode=t,this}setChartHeight(t){return this.chartHeight=t,this}setDefaultChartHeight(t){return this.defaultChartHeight=t,this}setCustomConfig(t){return this.containerConfig=T(T({},this.containerConfig),t),this}setItemResizeCallback(t){return this.containerConfig.itemResizeCallback=t,this}setItemChangeCallback(t){return this.containerConfig.itemChangeCallback=t,this}setFilterVisualization(t){return this.filterVisualization=t,this}enableFilterHighlighting(t=!0,e){let i={enableHighlighting:t,defaultFilteredOpacity:e?.filteredOpacity||.3,defaultHighlightedOpacity:e?.highlightedOpacity||1,defaultHighlightColor:e?.highlightColor||"#ff6b6b",defaultFilteredColor:e?.filteredColor||"#cccccc"};return this.setFilterVisualization(i)}build(){return{config:this.containerConfig,widgets:this.widgets,filterValues:this.filterValues,dashboardId:this.dashboardId,isEditMode:this.isEditMode,chartHeight:this.chartHeight,defaultChartHeight:this.defaultChartHeight}}getConfig(){return this.containerConfig}getWidgets(){return this.widgets}getFilterValues(){return this.filterValues}static create(){return new this}static updateConfig(t,e){return T(T({},t),e)}static calculateChartHeight(t,e,i=!1,n=400){let s=n,a=t/e,o=t*e,c=Math.log(o)/Math.log(2),l=.95,h=a<1?1/a:1;return i&&(h=h*a),Math.round(s*h*l)}static calculateMapCenter(t,e){let s=t/e,a=s>1?(s-1)*5:0,o=s<1?(1/s-1)*2:0;return[-95+a,38+o]}static calculateMapZoom(t,e){let n=t*e,s=Math.log(n)/Math.log(2),a=t/e,o=Math.abs(1-a)*.5;return 4-s*.1-o}};var di=class r extends Ra{getDefaultConfig(){return{gridType:Pe.VerticalFixed,displayGrid:Ci.None,outerMargin:!0,draggable:{enabled:!1},resizable:{enabled:!1},maxCols:we.MAX_COLS,minCols:we.MIN_COLS,maxRows:we.MAX_ROWS,minRows:we.MIN_ROWS,fixedColWidth:we.FIXED_COL_WIDTH,fixedRowHeight:we.FIXED_ROW_HEIGHT,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,mobileBreakpoint:we.MOBILE_BREAKPOINT}}enableEditMode(){return this.setDraggable(!0).setResizable(!0).setEditMode(!0).setDisplayGrid(Ci.Always)}disableEditMode(){return this.setDraggable(!1).setResizable(!1).setEditMode(!1).setDisplayGrid(Ci.None)}setResponsive(t=we.MOBILE_BREAKPOINT){return this.setMobileBreakpoint(t)}setCompactLayout(){return this.setOuterMargin(Wi.COMPACT.OUTER_MARGIN).setFixedColWidth(Wi.COMPACT.FIXED_COL_WIDTH).setFixedRowHeight(Wi.COMPACT.FIXED_ROW_HEIGHT)}setSpaciousLayout(){return this.setOuterMargin(Wi.SPACIOUS.OUTER_MARGIN).setFixedColWidth(Wi.SPACIOUS.FIXED_COL_WIDTH).setFixedRowHeight(Wi.SPACIOUS.FIXED_ROW_HEIGHT)}setGridLayout(){return this.setDisplayGrid(Ci.Always)}setFluidLayout(){return this.setGridType(Pe.VerticalFixed).setMaxCols(24).setMinCols(1)}setFixedLayout(){return this.setGridType(Pe.Fit).setMaxCols(we.MAX_COLS).setMinCols(we.MAX_COLS)}setMobileOptimized(){let t=ao;return this.setMobileBreakpoint(t.MOBILE_BREAKPOINT).setMaxCols(t.MAX_COLS).setFixedColWidth(t.FIXED_COL_WIDTH).setFixedRowHeight(t.FIXED_ROW_HEIGHT)}setTabletOptimized(){let t=oo;return this.setMobileBreakpoint(t.MOBILE_BREAKPOINT).setMaxCols(t.MAX_COLS).setFixedColWidth(t.FIXED_COL_WIDTH).setFixedRowHeight(t.FIXED_ROW_HEIGHT)}setDesktopOptimized(){let t=we;return this.setMaxCols(t.MAX_COLS).setFixedColWidth(t.FIXED_COL_WIDTH).setFixedRowHeight(t.FIXED_ROW_HEIGHT).setMobileBreakpoint(Zn.DESKTOP)}setLargeDesktopOptimized(){let t=lo;return this.setMaxCols(t.MAX_COLS).setFixedColWidth(t.FIXED_COL_WIDTH).setFixedRowHeight(t.FIXED_ROW_HEIGHT).setMobileBreakpoint(t.MOBILE_BREAKPOINT)}setGridDimensions(t,e){return this.setMaxCols(t).setMinCols(t).setMaxRows(e)}enableEmptyCellInteractions(){return this.setEmptyCellConfig({enableEmptyCellClick:!0,enableEmptyCellContextMenu:!0,enableEmptyCellDrop:!0,enableEmptyCellDrag:!0})}disableEmptyCellInteractions(){return this.setEmptyCellConfig({enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1})}setItemSizeConstraints(t=we.MIN_COLS,e=we.MAX_COLS,i=we.MIN_ROWS,n=50){return this.setMinCols(t).setMaxCols(e).setMinRows(i).setMaxRows(n)}setScreenSize(t){let e=wc(t);return this.setMaxCols(e.MAX_COLS).setMinCols(e.MIN_COLS).setMaxRows(e.MAX_ROWS).setMinRows(e.MIN_ROWS).setFixedColWidth(e.FIXED_COL_WIDTH).setFixedRowHeight(e.FIXED_ROW_HEIGHT).setMobileBreakpoint(e.MOBILE_BREAKPOINT)}static createStandard(){return new r().setGridType(Pe.VerticalFixed).setDisplayGrid(Ci.None).setOuterMargin(!0).setDraggable(!1).setResizable(!1).setMaxCols(we.MAX_COLS).setMinCols(we.MIN_COLS).setMaxRows(we.MAX_ROWS).setMinRows(we.MIN_ROWS).setFixedColWidth(we.FIXED_COL_WIDTH).setFixedRowHeight(we.FIXED_ROW_HEIGHT).setMobileBreakpoint(we.MOBILE_BREAKPOINT)}static createEditMode(){return new r().enableEditMode().setMaxCols(we.MAX_COLS).setMinCols(we.MIN_COLS).setMaxRows(we.MAX_ROWS).setMinRows(we.MIN_ROWS).setFixedColWidth(we.FIXED_COL_WIDTH).setFixedRowHeight(we.FIXED_ROW_HEIGHT).setMobileBreakpoint(we.MOBILE_BREAKPOINT)}static createMobile(){return new r().setScreenSize("MOBILE").setCompactLayout()}static createTablet(){return new r().setScreenSize("TABLET").setSpaciousLayout()}static createDesktop(){return new r().setScreenSize("DESKTOP").setSpaciousLayout()}static createLargeDesktop(){return new r().setScreenSize("LARGE_DESKTOP").setSpaciousLayout()}build(){return{config:this.containerConfig,widgets:this.widgets,filterValues:this.filterValues,dashboardId:this.dashboardId,isEditMode:this.isEditMode,chartHeight:this.chartHeight,defaultChartHeight:this.defaultChartHeight,filterVisualization:this.filterVisualization}}};var iw=["dashboardContainer"],nw=(r,t)=>t.id;function sw(r,t){if(r&1){let e=Se();U(0,"vis-widget-header",9),Ce("onUpdateWidget",function(n){J(e);let s=E(2);return ee(s.onUpdateWidget(n))})("onDeleteWidget",function(n){J(e);let s=E(2);return ee(s.onDeleteWidget(n))})("onToggleViewMode",function(n){J(e);let s=E(2);return ee(s.onToggleViewMode(n))}),X()}if(r&2){let e=E().$implicit,i=E();M("dashboardId",i.dashboardId)("widget",e)("currentViewMode",i.getWidgetViewMode(e.id))("onEditMode",i.isEditMode)}}function aw(r,t){if(r&1){let e=Se();U(0,"gridster-item",6),Ce("itemResize",function(){J(e);let n=E();return ee(n.updateString(n.container.editModeString))})("itemChange",function(){J(e);let n=E();return ee(n.updateString(n.container.editModeString))}),gt(1,sw,1,4,"vis-widget-header",7),U(2,"vis-widget",8),Ce("onDataLoad",function(n){J(e);let s=E();return ee(s.handleDataLoad(n))})("onUpdateFilter",function(n){J(e);let s=E();return ee(s.onUpdateFilter(n))}),X()()}if(r&2){let e=t.$implicit,i=E();M("item",e.position),Ae("data-widget-id",e.id),S(),xt(e.config.header?1:-1),S(),M("widget",e)("viewMode",i.getWidgetViewMode(e.id))}}var ul=(()=>{let t=class t{constructor(){this.filterValues=[],this.container=t,this.chartHeight=300,this.defaultChartHeight=400,this.containerTouchChanged=new ye,this.editModeStringChange=new ye,this.changesMade=new ye,this.filterValuesChanged=new ye,this.onDataLoad=new ye,this.availableDashboards=[],this.isEditMode=!1,this.onShowConfirmation=!1,this.onShowNewDashboardDialog=!1,this.options={},this.mergedOptions={},this.widgetViewModes=new Map,this.dashboardBuilder=di.createStandard()}ngOnInit(){this.initializeDashboard()}initializeDashboard(){let i=this.dashboardBuilder.setWidgets(this.widgets||[]).setFilterValues(this.filterValues||[]).setDashboardId(this.dashboardId||"").setEditMode(this.isEditMode).setChartHeight(this.chartHeight).setDefaultChartHeight(this.defaultChartHeight).setCustomConfig(this.options).setItemResizeCallback(this.onWidgetResize.bind(this)).setItemChangeCallback(this.onWidgetChange.bind(this)).build();this.applyDashboardConfig(i)}applyDashboardConfig(i){this.mergedOptions=i.config,this.widgets=i.widgets,this.filterValues=i.filterValues,this.dashboardId=i.dashboardId,this.isEditMode=i.isEditMode,this.chartHeight=i.chartHeight}updateDashboardConfig(i){i.config&&(this.mergedOptions=T(T({},this.mergedOptions),i.config)),i.widgets&&(this.widgets=i.widgets),i.filterValues&&(this.filterValues=i.filterValues),i.dashboardId&&(this.dashboardId=i.dashboardId),i.isEditMode!==void 0&&(this.isEditMode=i.isEditMode),i.chartHeight&&(this.chartHeight=i.chartHeight),this.dashboardBuilder=di.createStandard().setWidgets(this.widgets).setFilterValues(this.filterValues).setDashboardId(this.dashboardId).setEditMode(this.isEditMode).setChartHeight(this.chartHeight).setDefaultChartHeight(this.defaultChartHeight),this.applyDashboardConfig(this.dashboardBuilder.build())}enableEditMode(){this.dashboardBuilder.enableEditMode();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}disableEditMode(){this.dashboardBuilder.disableEditMode();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}setResponsive(i=640){this.dashboardBuilder.setResponsive(i);let n=this.dashboardBuilder.build();this.applyDashboardConfig(n)}setCompactLayout(){this.dashboardBuilder.setCompactLayout();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}setSpaciousLayout(){this.dashboardBuilder.setSpaciousLayout();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}setMobileOptimized(){this.dashboardBuilder.setMobileOptimized();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}setDesktopOptimized(){this.dashboardBuilder.setDesktopOptimized();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}getCurrentConfig(){return this.dashboardBuilder.build()}getBuilder(){return this.dashboardBuilder}handleDataLoad(i){return Tt(this,null,function*(){console.log("\u{1F525} Dashboard container handleDataLoad called for widget:",i.id,i.config?.header?.title),this.filterValues&&this.filterValues.length>0&&this.applyFiltersToWidget(i),this.onDataLoad.emit(i)})}applyFiltersToWidget(i){}getFilterParams(){return this.filterValues}onUpdateWidget(i){}onWidgetResize(i,n){}onWidgetChange(i,n){t.containerTouched=!0,t.editModeString="[Edit Mode - Pending Changes]"}updateString(i){this.editModeStringChange.emit(i)}getEditModeString(i){return t.editModeString}onUpdateFilter(i){let n=this.widgets.find(o=>o.config?.component==="filter");if(!n)return;let s=T({},n);s.config?s.config.options||(s.config.options={values:[]}):s.config={options:{values:[]}};let a=s.config.options;if(a.values||(a.values=[]),Array.isArray(i))a.values=i,this.filterValues=i,i.length===0&&(this.dashboardBuilder.setFilterValues([]),this.filterValues=[]);else if(i&&i.value&&i.widget){let o=i.value,c=i.widget,h=i.filterValue;if(!h&&o&&typeof o=="object"){let u=c.config?.filterColumn||c.config?.accessor||"unknown";if(o.name)h={accessor:"category",filterColumn:u,category:o.name,value:o.value||o.name};else if(o.seriesName)h={accessor:"series",filterColumn:u,series:o.seriesName,value:o.value||o.seriesName};else{let f=Object.keys(o);if(f.length>0){let p=f[0];h={accessor:p,filterColumn:u,[p]:o[p],value:o[p]}}}c.config?.header?.title&&(h.widgetTitle=c.config.header.title),c.id&&(h.widgetId=c.id)}h&&h.accessor&&h.value&&(a.values.push(h),this.filterValues.push(h))}this.dashboardBuilder.setFilterValues(this.filterValues),this.filterValuesChanged.emit(this.filterValues)}onDashboardSelectionChanged(i){}onDeleteWidget(i){this.widgets.splice(this.widgets.indexOf(i),1)}calculateChartHeight(i,n,s=!1,a=this.defaultChartHeight){return di.calculateChartHeight(i,n,s,a)}calculateMapCenter(i,n){return di.calculateMapCenter(i,n)}calculateMapZoom(i,n){return di.calculateMapZoom(i,n)}getWidgetViewMode(i){return this.widgetViewModes.get(i)||"chart"}onToggleViewMode(i){this.widgetViewModes.set(i.widgetId,i.viewMode)}};t.editModeString="",t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-dashboard-container"]],viewQuery:function(n,s){if(n&1&&(tt(Qs,5),tt(iw,7)),n&2){let a;Ie(a=Fe())&&(s.gridster=a.first),Ie(a=Fe())&&(s.dashboardContainer=a.first)}},inputs:{widgets:"widgets",filterValues:"filterValues",dashboardId:"dashboardId",isEditMode:"isEditMode",options:"options"},outputs:{containerTouchChanged:"containerTouchChanged",editModeStringChange:"editModeStringChange",changesMade:"changesMade",filterValuesChanged:"filterValuesChanged",onDataLoad:"onDataLoad"},decls:7,vars:1,consts:[["dashboardContainer",""],[1,"gridster-container"],[1,"mt-2","dashboard-gridster",3,"options"],["id","dashboard",1,"print-body"],[3,"item"],["position","bottom-right","key","br"],[3,"itemResize","itemChange","item"],[3,"dashboardId","widget","currentViewMode","onEditMode"],[3,"onDataLoad","onUpdateFilter","widget","viewMode"],[3,"onUpdateWidget","onDeleteWidget","onToggleViewMode","dashboardId","widget","currentViewMode","onEditMode"]],template:function(n,s){n&1&&(U(0,"div",1,0)(2,"gridster",2)(3,"div",3),Ri(4,aw,3,5,"gridster-item",4,nw),X()()(),xe(6,"p-toast",5)),n&2&&(S(2),M("options",s.mergedOptions),S(2),Ni(s.widgets))},dependencies:[Be,wi,Qs,Mc,Xc,mu,gu,Gs,Us],styles:[".vis-chart-container[_ngcontent-%COMP%]{background-color:#fff;min-height:1000px;width:100%}.gridster-container[_ngcontent-%COMP%]{width:100%;height:100%}.editMode[_ngcontent-%COMP%]{color:red}.print-body[_ngcontent-%COMP%]{width:95%}@media print{#dashboard[_ngcontent-%COMP%]{width:95%;overflow-y:visible!important;position:relative}@page{size:landscape}}.vis-filter-component[_ngcontent-%COMP%]{font-size:.8rem!important;width:100%;height:40px}  .p-dropdown-custom{width:100%!important}  .p-dropdown-custom.p-dropdown .p-component{width:100%!important}.dashboard-gridster[_ngcontent-%COMP%]{background-color:var(--p-surface-50);padding:5px;height:100%!important;overflow-y:auto!important}[_nghost-%COMP%]     .no-border .p-panel-content{border:none!important;background:transparent!important}[_nghost-%COMP%]     .hide-panel-header .p-panel-header{display:none!important}"]});let r=t;return r})();var xu=`
    .p-tieredmenu {
        background: dt('tieredmenu.background');
        color: dt('tieredmenu.color');
        border: 1px solid dt('tieredmenu.border.color');
        border-radius: dt('tieredmenu.border.radius');
        min-width: 12.5rem;
    }

    .p-tieredmenu-root-list,
    .p-tieredmenu-submenu {
        margin: 0;
        padding: dt('tieredmenu.list.padding');
        list-style: none;
        outline: 0 none;
        display: flex;
        flex-direction: column;
        gap: dt('tieredmenu.list.gap');
    }

    .p-tieredmenu-submenu {
        position: absolute;
        min-width: 100%;
        z-index: 1;
        background: dt('tieredmenu.background');
        color: dt('tieredmenu.color');
        border: 1px solid dt('tieredmenu.border.color');
        border-radius: dt('tieredmenu.border.radius');
        box-shadow: dt('tieredmenu.shadow');
    }

    .p-tieredmenu-item {
        position: relative;
    }

    .p-tieredmenu-item-content {
        transition:
            background dt('tieredmenu.transition.duration'),
            color dt('tieredmenu.transition.duration');
        border-radius: dt('tieredmenu.item.border.radius');
        color: dt('tieredmenu.item.color');
    }

    .p-tieredmenu-item-link {
        cursor: pointer;
        display: flex;
        align-items: center;
        text-decoration: none;
        overflow: hidden;
        position: relative;
        color: inherit;
        padding: dt('tieredmenu.item.padding');
        gap: dt('tieredmenu.item.gap');
        user-select: none;
        outline: 0 none;
    }

    .p-tieredmenu-item-label {
        line-height: 1;
    }

    .p-tieredmenu-item-icon {
        color: dt('tieredmenu.item.icon.color');
    }

    .p-tieredmenu-submenu-icon {
        color: dt('tieredmenu.submenu.icon.color');
        margin-left: auto;
        font-size: dt('tieredmenu.submenu.icon.size');
        width: dt('tieredmenu.submenu.icon.size');
        height: dt('tieredmenu.submenu.icon.size');
    }

    .p-tieredmenu-submenu-icon:dir(rtl) {
        margin-left: 0;
        margin-right: auto;
    }

    .p-tieredmenu-item.p-focus > .p-tieredmenu-item-content {
        color: dt('tieredmenu.item.focus.color');
        background: dt('tieredmenu.item.focus.background');
    }

    .p-tieredmenu-item.p-focus > .p-tieredmenu-item-content .p-tieredmenu-item-icon {
        color: dt('tieredmenu.item.icon.focus.color');
    }

    .p-tieredmenu-item.p-focus > .p-tieredmenu-item-content .p-tieredmenu-submenu-icon {
        color: dt('tieredmenu.submenu.icon.focus.color');
    }

    .p-tieredmenu-item:not(.p-disabled) > .p-tieredmenu-item-content:hover {
        color: dt('tieredmenu.item.focus.color');
        background: dt('tieredmenu.item.focus.background');
    }

    .p-tieredmenu-item:not(.p-disabled) > .p-tieredmenu-item-content:hover .p-tieredmenu-item-icon {
        color: dt('tieredmenu.item.icon.focus.color');
    }

    .p-tieredmenu-item:not(.p-disabled) > .p-tieredmenu-item-content:hover .p-tieredmenu-submenu-icon {
        color: dt('tieredmenu.submenu.icon.focus.color');
    }

    .p-tieredmenu-item-active > .p-tieredmenu-item-content {
        color: dt('tieredmenu.item.active.color');
        background: dt('tieredmenu.item.active.background');
    }

    .p-tieredmenu-item-active > .p-tieredmenu-item-content .p-tieredmenu-item-icon {
        color: dt('tieredmenu.item.icon.active.color');
    }

    .p-tieredmenu-item-active > .p-tieredmenu-item-content .p-tieredmenu-submenu-icon {
        color: dt('tieredmenu.submenu.icon.active.color');
    }

    .p-tieredmenu-separator {
        border-block-start: 1px solid dt('tieredmenu.separator.border.color');
    }

    .p-tieredmenu-overlay {
        box-shadow: dt('tieredmenu.shadow');
    }

    .p-tieredmenu-enter-from,
    .p-tieredmenu-leave-active {
        opacity: 0;
    }

    .p-tieredmenu-enter-active {
        transition: opacity 250ms;
    }

    .p-tieredmenu-mobile .p-tieredmenu-submenu {
        position: static;
        box-shadow: none;
        border: 0 none;
        padding-inline-start: dt('tieredmenu.submenu.mobile.indent');
        padding-inline-end: 0;
    }

    .p-tieredmenu-mobile .p-tieredmenu-submenu:dir(rtl) {
        padding-inline-start: 0;
        padding-inline-end: dt('tieredmenu.submenu.mobile.indent');
    }

    .p-tieredmenu-mobile .p-tieredmenu-submenu-icon {
        transition: transform 0.2s;
        transform: rotate(90deg);
    }

    .p-tieredmenu-mobile .p-tieredmenu-item-active > .p-tieredmenu-item-content .p-tieredmenu-submenu-icon {
        transform: rotate(-90deg);
    }
`;var ow=["sublist"],lw=r=>({processedItem:r}),cw=()=>({exact:!1}),hw=(r,t)=>({$implicit:r,hasSubmenu:t}),uw=r=>({display:r});function fw(r,t){if(r&1&&xe(0,"li",7),r&2){let e=E().$implicit,i=E();kt(i.getItemProp(e,"style")),Te(i.cn(i.cx("separator"),i.getItemProp(e,"class"),i.getItemProp(e,"styleClass"))),Ae("id",i.getItemId(e))("data-pc-section","separator")}}function dw(r,t){if(r&1&&xe(0,"span",18),r&2){let e=E(4).$implicit,i=E();Te(i.cn(i.cx("itemIcon"),i.getItemProp(e,"icon"))),M("ngStyle",i.getItemProp(e,"iconStyle")),Ae("data-pc-section","icon")("tabindex",-1)}}function pw(r,t){if(r&1&&(U(0,"span"),ce(1),X()),r&2){let e=E(4).$implicit,i=E();Te(i.cx("itemLabel")),Ae("data-pc-section","label"),S(),rt(" ",i.getItemLabel(e)," ")}}function mw(r,t){if(r&1&&xe(0,"span",19),r&2){let e=E(4).$implicit,i=E();Te(i.cx("itemLabel")),M("innerHTML",i.getItemLabel(e),pi),Ae("data-pc-section","label")}}function gw(r,t){if(r&1&&(U(0,"span"),ce(1),X()),r&2){let e=E(4).$implicit,i=E();Te(i.cn(i.cx("itemBadge"),i.getItemProp(e,"badgeStyleClass"))),S(),Ne(i.getItemProp(e,"badge"))}}function xw(r,t){if(r&1&&(Pi(),xe(0,"svg",22)),r&2){let e=E(6);Te(e.cx("submenuIcon")),Ae("data-pc-section","submenuicon")("aria-hidden",!0)}}function vw(r,t){}function _w(r,t){r&1&&he(0,vw,0,0,"ng-template",23),r&2&&M("data-pc-section","submenuicon")("aria-hidden",!0)}function yw(r,t){if(r&1&&(qt(0),he(1,xw,1,4,"svg",20)(2,_w,1,2,null,21),Zt()),r&2){let e=E(5);S(),M("ngIf",!e.tieredMenu.submenuIconTemplate&&!e.tieredMenu._submenuIconTemplate),S(),M("ngTemplateOutlet",e.tieredMenu.submenuIconTemplate||e.tieredMenu._submenuIconTemplate)}}function ww(r,t){if(r&1&&(U(0,"a",14),he(1,dw,1,5,"span",15)(2,pw,2,4,"span",16)(3,mw,1,4,"ng-template",null,2,cr)(5,gw,2,3,"span",17)(6,yw,3,2,"ng-container",10),X()),r&2){let e=Jt(4),i=E(3).$implicit,n=E();Te(n.cx("itemLink")),M("target",n.getItemProp(i,"target")),Ae("href",n.getItemProp(i,"url"),Fs)("data-automationid",n.getItemProp(i,"automationId"))("data-pc-section","action")("tabindex",-1),S(),M("ngIf",n.getItemProp(i,"icon")),S(),M("ngIf",n.getItemProp(i,"escape"))("ngIfElse",e),S(3),M("ngIf",n.getItemProp(i,"badge")),S(),M("ngIf",n.isItemGroup(i))}}function Cw(r,t){if(r&1&&xe(0,"span",18),r&2){let e=E(4).$implicit,i=E();Te(i.cn(i.cx("itemIcon"),i.getItemProp(e,"icon"))),M("ngStyle",i.getItemProp(e,"iconStyle")),Ae("data-pc-section","icon")("aria-hidden",!0)("tabindex",-1)}}function bw(r,t){if(r&1&&(U(0,"span"),ce(1),X()),r&2){let e=E(4).$implicit,i=E();Te(i.cx("itemLabel")),Ae("data-pc-section","label"),S(),rt(" ",i.getItemLabel(e)," ")}}function Sw(r,t){if(r&1&&xe(0,"span",19),r&2){let e=E(4).$implicit,i=E();Te(i.cx("itemLabel")),M("innerHTML",i.getItemLabel(e),pi),Ae("data-pc-section","label")}}function Tw(r,t){if(r&1&&(U(0,"span"),ce(1),X()),r&2){let e=E(4).$implicit,i=E();Te(i.cn(i.cx("itemBadge"),i.getItemProp(e,"badgeStyleClass"))),S(),Ne(i.getItemProp(e,"badge"))}}function Ew(r,t){if(r&1&&(Pi(),xe(0,"svg",22)),r&2){let e=E(6);Te(e.cx("submenuIcon")),Ae("data-pc-section","submenuicon")("aria-hidden",!0)}}function kw(r,t){}function Iw(r,t){r&1&&he(0,kw,0,0,"ng-template",23),r&2&&M("data-pc-section","submenuicon")("aria-hidden",!0)}function Fw(r,t){if(r&1&&(qt(0),he(1,Ew,1,4,"svg",20)(2,Iw,1,2,null,21),Zt()),r&2){let e=E(5);S(),M("ngIf",!e.tieredMenu.submenuIconTemplate&&!e.tieredMenu._submenuIconTemplate),S(),M("ngTemplateOutlet",e.tieredMenu.submenuIconTemplate||e.tieredMenu._submenuIconTemplate)}}function Ow(r,t){if(r&1&&(U(0,"a",24),he(1,Cw,1,6,"span",15)(2,bw,2,4,"span",16)(3,Sw,1,4,"ng-template",null,2,cr)(5,Tw,2,3,"span",17)(6,Fw,3,2,"ng-container",10),X()),r&2){let e=Jt(4),i=E(3).$implicit,n=E();Te(n.cx("itemLink")),M("routerLink",n.getItemProp(i,"routerLink"))("queryParams",n.getItemProp(i,"queryParams"))("routerLinkActive","p-tieredmenu-item-link-active")("routerLinkActiveOptions",n.getItemProp(i,"routerLinkActiveOptions")||vr(21,cw))("target",n.getItemProp(i,"target"))("fragment",n.getItemProp(i,"fragment"))("queryParamsHandling",n.getItemProp(i,"queryParamsHandling"))("preserveFragment",n.getItemProp(i,"preserveFragment"))("skipLocationChange",n.getItemProp(i,"skipLocationChange"))("replaceUrl",n.getItemProp(i,"replaceUrl"))("state",n.getItemProp(i,"state")),Ae("data-automationid",n.getItemProp(i,"automationId"))("tabindex",-1)("data-pc-section","action"),S(),M("ngIf",n.getItemProp(i,"icon")),S(),M("ngIf",n.getItemProp(i,"escape"))("ngIfElse",e),S(3),M("ngIf",n.getItemProp(i,"badge")),S(),M("ngIf",n.isItemGroup(i))}}function Aw(r,t){if(r&1&&(qt(0),he(1,ww,7,12,"a",12)(2,Ow,7,22,"a",13),Zt()),r&2){let e=E(2).$implicit,i=E();S(),M("ngIf",!i.getItemProp(e,"routerLink")),S(),M("ngIf",i.getItemProp(e,"routerLink"))}}function Dw(r,t){}function Mw(r,t){r&1&&he(0,Dw,0,0,"ng-template")}function Pw(r,t){if(r&1&&(qt(0),he(1,Mw,1,0,null,25),Zt()),r&2){let e=E(2).$implicit,i=E();S(),M("ngTemplateOutlet",i.itemTemplate)("ngTemplateOutletContext",_r(2,hw,e.item,i.getItemProp(e,"items")))}}function Lw(r,t){if(r&1){let e=Se();U(0,"p-tieredmenusub",26),Ce("itemClick",function(n){J(e);let s=E(3);return ee(s.itemClick.emit(n))})("itemMouseEnter",function(n){J(e);let s=E(3);return ee(s.onItemMouseEnter(n))}),X()}if(r&2){let e=E(2).$implicit,i=E();M("items",e.items)("itemTemplate",i.itemTemplate)("autoDisplay",i.autoDisplay)("menuId",i.menuId)("activeItemPath",i.activeItemPath())("focusedItemId",i.focusedItemId)("ariaLabelledBy",i.getItemId(e))("level",i.level+1)("inlineStyles",lr(9,uw,i.isItemActive(e)?"flex":"none"))}}function Rw(r,t){if(r&1){let e=Se();U(0,"li",8,1)(2,"div",9),Ce("click",function(n){J(e);let s=E().$implicit,a=E();return ee(a.onItemClick(n,s))})("mouseenter",function(n){J(e);let s=E().$implicit,a=E();return ee(a.onItemMouseEnter({$event:n,processedItem:s}))}),he(3,Aw,3,2,"ng-container",10)(4,Pw,2,5,"ng-container",10),X(),he(5,Lw,1,11,"p-tieredmenusub",11),X()}if(r&2){let e=E(),i=e.$implicit,n=e.index,s=E();Te(s.cn(s.cx("item",lr(21,lw,i)),s.getItemProp(i,"styleClass"))),M("ngStyle",s.getItemProp(i,"style"))("tooltipOptions",s.getItemProp(i,"tooltipOptions")),Ae("id",s.getItemId(i))("data-pc-section","menuitem")("data-p-highlight",s.isItemActive(i))("data-p-focused",s.isItemFocused(i))("data-p-disabled",s.isItemDisabled(i))("aria-label",s.getItemLabel(i))("aria-disabled",s.isItemDisabled(i)||void 0)("aria-haspopup",s.isItemGroup(i)&&!s.getItemProp(i,"to")?"menu":void 0)("aria-expanded",s.isItemGroup(i)?s.isItemActive(i):void 0)("aria-setsize",s.getAriaSetSize())("aria-posinset",s.getAriaPosInset(n)),S(2),Te(s.cx("itemContent")),Ae("data-pc-section","content"),S(),M("ngIf",!s.itemTemplate),S(),M("ngIf",s.itemTemplate),S(),M("ngIf",s.isItemVisible(i)&&s.isItemGroup(i))}}function Nw(r,t){if(r&1&&he(0,fw,1,6,"li",5)(1,Rw,6,23,"li",6),r&2){let e=t.$implicit,i=E();M("ngIf",i.isItemVisible(e)&&i.getItemProp(e,"separator")),S(),M("ngIf",i.isItemVisible(e)&&!i.getItemProp(e,"separator"))}}var Bw=["submenuicon"],Hw=["item"],Vw=["rootmenu"],Ww=["container"],$w=(r,t)=>({showTransitionParams:r,hideTransitionParams:t}),zw=r=>({value:"visible",params:r});function Uw(r,t){if(r&1){let e=Se();U(0,"div",3,0),Ce("click",function(n){J(e);let s=E();return ee(s.onOverlayClick(n))})("@overlayAnimation.start",function(n){J(e);let s=E();return ee(s.onOverlayAnimationStart(n))})("@overlayAnimation.done",function(n){J(e);let s=E();return ee(s.onOverlayAnimationEnd(n))}),U(2,"p-tieredMenuSub",4,1),Ce("itemClick",function(n){J(e);let s=E();return ee(s.onItemClick(n))})("menuFocus",function(n){J(e);let s=E();return ee(s.onMenuFocus(n))})("menuBlur",function(n){J(e);let s=E();return ee(s.onMenuBlur(n))})("menuKeydown",function(n){J(e);let s=E();return ee(s.onKeyDown(n))})("itemMouseEnter",function(n){J(e);let s=E();return ee(s.onItemMouseEnter(n))}),X()()}if(r&2){let e=E();Te(e.cn(e.cx("root"),e.styleClass)),M("id",e.id)("ngStyle",e.style)("@overlayAnimation",lr(24,zw,_r(21,$w,e.showTransitionOptions,e.hideTransitionOptions)))("@.disabled",e.popup!==!0),Ae("data-pc-section","root")("data-pc-name","tieredmenu"),S(2),M("root",!0)("items",e.processedItems)("itemTemplate",e.itemTemplate||e._itemTemplate)("menuId",e.id)("tabindex",e.disabled?-1:e.tabindex)("ariaLabel",e.ariaLabel)("ariaLabelledBy",e.ariaLabelledBy)("baseZIndex",e.baseZIndex)("autoZIndex",e.autoZIndex)("autoDisplay",e.autoDisplay)("popup",e.popup)("focusedItemId",e.focused?e.focusedItemId:void 0)("activeItemPath",e.activeItemPath())}}var Gw={submenu:({instance:r,processedItem:t})=>({display:r.isItemActive(t)?"flex":"none"})},Xw={root:({instance:r})=>["p-tieredmenu p-component",{"p-tieredmenu-overlay":r.popup,"p-tieredmenu-mobile":r.queryMatches}],start:"p-tieredmenu-start",rootList:"p-tieredmenu-root-list",item:({instance:r,processedItem:t})=>["p-tieredmenu-item",{"p-tieredmenu-item-active":r.isItemActive(t),"p-focus":r.isItemFocused(t),"p-disabled":r.isItemDisabled(t)}],itemContent:"p-tieredmenu-item-content",itemLink:"p-tieredmenu-item-link",itemIcon:"p-tieredmenu-item-icon",itemLabel:"p-tieredmenu-item-label",itemBadge:"p-menuitem-badge",submenuIcon:"p-tieredmenu-submenu-icon",submenu:"p-tieredmenu-submenu",separator:"p-tieredmenu-separator",end:"p-tieredmenu-end"},fl=(()=>{class r extends xi{name="tieredmenu";theme=xu;classes=Xw;inlineStyles=Gw;static \u0275fac=(()=>{let e;return function(n){return(e||(e=Dr(r)))(n||r)}})();static \u0275prov=ar({token:r,factory:r.\u0275fac})}return r})();var jw=(()=>{class r extends zr{el;renderer;tieredMenu;items;itemTemplate;root=!1;autoDisplay;autoZIndex=!0;baseZIndex=0;popup;menuId;ariaLabel;ariaLabelledBy;level=0;focusedItemId;activeItemPath=er([]);tabindex=0;inlineStyles;itemClick=new ye;itemMouseEnter=new ye;menuFocus=new ye;menuBlur=new ye;menuKeydown=new ye;sublistViewChild;_componentStyle=Et(fl);constructor(e,i,n){super(),this.el=e,this.renderer=i,this.tieredMenu=n}positionSubmenu(){if(ei(this.tieredMenu.platformId)){let e=this.sublistViewChild&&this.sublistViewChild.nativeElement;e&&Wl(e,this.level)}}getItemProp(e,i,n=null){return e&&e.item?Ja(e.item[i],n):void 0}getItemId(e){return e.item?.id??`${this.menuId}_${e.key}`}getItemKey(e){return this.getItemId(e)}getItemClass(e){return B(T({},this.getItemProp(e,"class")),{"p-tieredmenu-item":!0,"p-tieredmenu-item-active":this.isItemActive(e),"p-focus":this.isItemFocused(e),"p-disabled":this.isItemDisabled(e)})}getItemLabel(e){return this.getItemProp(e,"label")}getSeparatorItemClass(e){return B(T({},this.getItemProp(e,"class")),{"p-tieredmenu-separator":!0})}getAriaSetSize(){return this.items.filter(e=>this.isItemVisible(e)&&!this.getItemProp(e,"separator")).length}getAriaPosInset(e){return e-this.items.slice(0,e).filter(i=>{let n=this.isItemVisible(i),s=n&&this.getItemProp(i,"separator");return!n||s}).length+1}isItemVisible(e){return this.getItemProp(e,"visible")!==!1}isItemActive(e){if(this.activeItemPath())return this.positionSubmenu(),this.activeItemPath().some(i=>i.key===e.key)}isItemDisabled(e){return this.getItemProp(e,"disabled")}isItemFocused(e){return this.focusedItemId===this.getItemId(e)}isItemGroup(e){return Vi(e.items)}onItemMouseEnter(e){if(this.autoDisplay){let{event:i,processedItem:n}=e;this.itemMouseEnter.emit({originalEvent:i,processedItem:n})}}onItemClick(e,i){this.getItemProp(i,"command",{originalEvent:e,item:i.item}),this.itemClick.emit({originalEvent:e,processedItem:i,isFocus:!0})}static \u0275fac=function(i){return new(i||r)(We(Zr),We(Li),We(Is(()=>dl)))};static \u0275cmp=Oe({type:r,selectors:[["p-tieredMenuSub"],["p-tieredmenusub"]],viewQuery:function(i,n){if(i&1&&tt(ow,7),i&2){let s;Ie(s=Fe())&&(n.sublistViewChild=s.first)}},inputs:{items:"items",itemTemplate:"itemTemplate",root:[2,"root","root",Ue],autoDisplay:[2,"autoDisplay","autoDisplay",Ue],autoZIndex:[2,"autoZIndex","autoZIndex",Ue],baseZIndex:[2,"baseZIndex","baseZIndex",hr],popup:[2,"popup","popup",Ue],menuId:"menuId",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",level:[2,"level","level",hr],focusedItemId:"focusedItemId",activeItemPath:[1,"activeItemPath"],tabindex:[2,"tabindex","tabindex",hr],inlineStyles:"inlineStyles"},outputs:{itemClick:"itemClick",itemMouseEnter:"itemMouseEnter",menuFocus:"menuFocus",menuBlur:"menuBlur",menuKeydown:"menuKeydown"},features:[Pr],decls:3,vars:12,consts:[["sublist",""],["listItem",""],["htmlLabel",""],["role","menu",3,"keydown","focus","blur","id","tabindex"],["ngFor","",3,"ngForOf"],["role","separator",3,"style","class",4,"ngIf"],["role","menuitem","pTooltip","",3,"ngStyle","class","tooltipOptions",4,"ngIf"],["role","separator"],["role","menuitem","pTooltip","",3,"ngStyle","tooltipOptions"],[3,"click","mouseenter"],[4,"ngIf"],[3,"items","itemTemplate","autoDisplay","menuId","activeItemPath","focusedItemId","ariaLabelledBy","level","inlineStyles","itemClick","itemMouseEnter",4,"ngIf"],["pRipple","",3,"target","class",4,"ngIf"],["pRipple","",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","class","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state",4,"ngIf"],["pRipple","",3,"target"],[3,"class","ngStyle",4,"ngIf"],[3,"class",4,"ngIf","ngIfElse"],[3,"class",4,"ngIf"],[3,"ngStyle"],[3,"innerHTML"],["data-p-icon","angle-right",3,"class",4,"ngIf"],[4,"ngTemplateOutlet"],["data-p-icon","angle-right"],[3,"data-pc-section","aria-hidden"],["pRipple","",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"itemClick","itemMouseEnter","items","itemTemplate","autoDisplay","menuId","activeItemPath","focusedItemId","ariaLabelledBy","level","inlineStyles"]],template:function(i,n){if(i&1){let s=Se();U(0,"ul",3,0),Ce("keydown",function(o){return J(s),ee(n.menuKeydown.emit(o))})("focus",function(o){return J(s),ee(n.menuFocus.emit(o))})("blur",function(o){return J(s),ee(n.menuBlur.emit(o))}),he(2,Nw,2,2,"ng-template",4),X()}i&2&&(kt(n.inlineStyles),Te(n.root?n.cx("rootList"):n.cx("submenu")),M("id",n.menuId+"_list")("tabindex",n.tabindex),Ae("aria-label",n.ariaLabel)("aria-labelledBy",n.ariaLabelledBy)("aria-activedescendant",n.focusedItemId)("aria-orientation","vertical")("data-pc-section","menu"),S(2),M("ngForOf",n.items))},dependencies:[r,Be,gi,Rt,Jr,Bi,nn,Ls,Rs,an,Ur,vi,Ul,Nt],encapsulation:2})}return r})(),dl=(()=>{class r extends zr{overlayService;set model(e){this._model=e,this._processedItems=this.createProcessedItems(this._model||[])}get model(){return this._model}popup;style;styleClass;breakpoint="960px";autoZIndex=!0;baseZIndex=0;autoDisplay=!0;showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)";hideTransitionOptions=".1s linear";id;ariaLabel;ariaLabelledBy;disabled=!1;tabindex=0;appendTo=er(void 0);onShow=new ye;onHide=new ye;rootmenu;containerViewChild;submenuIconTemplate;itemTemplate;templates;$appendTo=rn(()=>this.appendTo()||this.config.overlayAppendTo());container;outsideClickListener;resizeListener;scrollHandler;target;relatedTarget;visible;relativeAlign;dirty=!1;focused=!1;activeItemPath=Wr([]);number=Wr(0);focusedItemInfo=Wr({index:-1,level:0,parentKey:"",item:null});searchValue="";searchTimeout;_processedItems;_model;_componentStyle=Et(fl);matchMediaListener;query;queryMatches;_submenuIconTemplate;_itemTemplate;get visibleItems(){let e=this.activeItemPath().find(i=>i.key===this.focusedItemInfo().parentKey);return e?e.items:this.processedItems}get processedItems(){return(!this._processedItems||!this._processedItems.length)&&(this._processedItems=this.createProcessedItems(this.model||[])),this._processedItems}get focusedItemId(){let e=this.focusedItemInfo();return e.item?.id?e.item.id:e.index!==-1?`${this.id}${Vi(e.parentKey)?"_"+e.parentKey:""}_${e.index}`:null}constructor(e){super(),this.overlayService=e,Ya(()=>{let i=this.activeItemPath();Vi(i)?(this.bindOutsideClickListener(),this.bindResizeListener()):(this.unbindOutsideClickListener(),this.unbindResizeListener())})}ngOnInit(){super.ngOnInit(),this.bindMatchMediaListener(),this.id=this.id||sn("pn_id_")}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"submenuicon":this._submenuIconTemplate=e.template;break;case"item":this._itemTemplate=e.template;break;default:this._itemTemplate=e.template;break}})}bindMatchMediaListener(){if(ei(this.platformId)&&!this.matchMediaListener){let e=window.matchMedia(`(max-width: ${this.breakpoint})`);this.query=e,this.queryMatches=e.matches,this.matchMediaListener=()=>{this.queryMatches=e.matches},e.addEventListener("change",this.matchMediaListener)}}unbindMatchMediaListener(){this.matchMediaListener&&(this.query.removeEventListener("change",this.matchMediaListener),this.matchMediaListener=null)}createProcessedItems(e,i=0,n={},s=""){let a=[];return e&&e.forEach((o,c)=>{let l=(s!==""?s+"_":"")+c,h={item:o,index:c,level:i,key:l,parent:n,parentKey:s};h.items=this.createProcessedItems(o.items,i+1,h,l),a.push(h)}),a}getItemProp(e,i){return e?Ja(e[i]):void 0}getProccessedItemLabel(e){return e?this.getItemLabel(e.item):void 0}getItemLabel(e){return this.getItemProp(e,"label")}isProcessedItemGroup(e){return e&&Vi(e.items)}isSelected(e){return this.activeItemPath().some(i=>i.key===e.key)}isValidSelectedItem(e){return this.isValidItem(e)&&this.isSelected(e)}isValidItem(e){return!!e&&!this.isItemDisabled(e.item)&&!this.isItemSeparator(e.item)&&this.isItemVisible(e.item)}isItemDisabled(e){return this.getItemProp(e,"disabled")}isItemVisible(e){return this.getItemProp(e,"visible")!==!1}isItemSeparator(e){return this.getItemProp(e,"separator")}isItemMatched(e){return this.isValidItem(e)&&this.getProccessedItemLabel(e).toLocaleLowerCase().startsWith(this.searchValue.toLocaleLowerCase())}isProccessedItemGroup(e){return e&&Vi(e.items)}onOverlayClick(e){this.popup&&this.overlayService.add({originalEvent:e,target:this.el.nativeElement})}onItemClick(e){let{originalEvent:i,processedItem:n}=e,s=this.isProcessedItemGroup(n),a=Ws(n.parent);if(this.isSelected(n)){let{index:c,key:l,level:h,parentKey:u,item:f}=n;this.activeItemPath.set(this.activeItemPath().filter(p=>l!==p.key&&l.startsWith(p.key))),this.focusedItemInfo.set({index:c,level:h,parentKey:u,item:f}),this.dirty=!0,wr(this.rootmenu.sublistViewChild.nativeElement)}else if(s)this.onItemChange(e);else{let c=a?n:this.activeItemPath().find(l=>l.parentKey==="");this.hide(i),this.changeFocusedItemIndex(i,c?c.index:-1),wr(this.rootmenu.sublistViewChild.nativeElement)}}onItemMouseEnter(e){qn()?this.onItemChange({event:e,processedItem:e.processedItem,focus:this.autoDisplay},"hover"):this.dirty&&this.onItemChange(e,"hover")}onKeyDown(e){let i=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"ArrowLeft":this.onArrowLeftKey(e);break;case"ArrowRight":this.onArrowRightKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"Space":this.onSpaceKey(e);break;case"Enter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"PageDown":case"PageUp":case"Backspace":case"ShiftLeft":case"ShiftRight":break;default:!i&&$l(e.key)&&this.searchItems(e,e.key);break}}onArrowDownKey(e){let i=this.focusedItemInfo().index!==-1?this.findNextItemIndex(this.focusedItemInfo().index):this.findFirstFocusedItemIndex();this.changeFocusedItemIndex(e,i),e.preventDefault()}onArrowRightKey(e){let i=this.visibleItems[this.focusedItemInfo().index],n=this.isProccessedItemGroup(i),s=i?.item;n&&(this.onItemChange({originalEvent:e,processedItem:i}),this.focusedItemInfo.set({index:-1,parentKey:i.key,item:s}),this.searchValue="",this.onArrowDownKey(e)),e.preventDefault()}onArrowUpKey(e){if(e.altKey){if(this.focusedItemInfo().index!==-1){let i=this.visibleItems[this.focusedItemInfo().index];!this.isProccessedItemGroup(i)&&this.onItemChange({originalEvent:e,processedItem:i})}this.popup&&this.hide(e,!0),e.preventDefault()}else{let i=this.focusedItemInfo().index!==-1?this.findPrevItemIndex(this.focusedItemInfo().index):this.findLastFocusedItemIndex();this.changeFocusedItemIndex(e,i),e.preventDefault()}}onArrowLeftKey(e){let i=this.visibleItems[this.focusedItemInfo().index],n=this.activeItemPath().find(o=>o.key===i.parentKey);Ws(i.parent)||(this.focusedItemInfo.set({index:-1,parentKey:n?n.parentKey:"",item:i.item}),this.searchValue="",this.onArrowDownKey(e));let a=this.activeItemPath().filter(o=>o.parentKey!==this.focusedItemInfo().parentKey);this.activeItemPath.set(a),e.preventDefault()}onHomeKey(e){this.changeFocusedItemIndex(e,this.findFirstItemIndex()),e.preventDefault()}onEndKey(e){this.changeFocusedItemIndex(e,this.findLastItemIndex()),e.preventDefault()}onSpaceKey(e){this.onEnterKey(e)}onEscapeKey(e){this.hide(e,!0),this.focusedItemInfo().index=this.findFirstFocusedItemIndex(),e.preventDefault()}onTabKey(e){if(this.focusedItemInfo().index!==-1){let i=this.visibleItems[this.focusedItemInfo().index];!this.isProccessedItemGroup(i)&&this.onItemChange({originalEvent:e,processedItem:i})}this.hide()}onEnterKey(e){if(this.focusedItemInfo().index!==-1){let i=Hi(this.rootmenu.el.nativeElement,`li[id="${`${this.focusedItemId}`}"]`),n=i&&Hi(i,'a[data-pc-section="action"]');if(n?n.click():i&&i.click(),!this.popup){let s=this.visibleItems[this.focusedItemInfo().index];!this.isProccessedItemGroup(s)&&(this.focusedItemInfo().index=this.findFirstFocusedItemIndex())}}e.preventDefault()}onItemChange(e,i){let{processedItem:n,isFocus:s}=e;if(Ws(n))return;let{index:a,key:o,level:c,parentKey:l,items:h,item:u}=n,f=Vi(h),p=this.activeItemPath().filter(x=>x.parentKey!==l&&x.parentKey!==o);f&&p.push(n),this.focusedItemInfo.set({index:a,level:c,parentKey:l,item:u}),f&&(this.dirty=!0),s&&wr(this.rootmenu.sublistViewChild.nativeElement),!(i==="hover"&&this.queryMatches)&&this.activeItemPath.set(p)}onMenuFocus(e){this.focused=!0,this.focusedItemInfo().index===-1&&this.popup}onMenuBlur(e){this.focused=!1,this.focusedItemInfo.set({index:-1,level:0,parentKey:"",item:null}),this.searchValue="",this.dirty=!1}onOverlayAnimationStart(e){switch(e.toState){case"visible":this.popup&&(this.container=e.element,this.moveOnTop(),this.onShow.emit({}),Vl(this.containerViewChild.nativeElement,{position:"absolute",top:0}),this.attrSelector&&this.container.setAttribute(this.attrSelector,""),this.appendOverlay(),this.alignOverlay(),this.bindOutsideClickListener(),this.bindResizeListener(),this.bindScrollListener(),wr(this.rootmenu.sublistViewChild.nativeElement),this.scrollInView());break;case"void":this.onOverlayHide(),this.onHide.emit({});break}}alignOverlay(){this.relativeAlign?Hs(this.container,this.target):Ns(this.container,this.target),Bs(this.target)>Bs(this.container)&&(this.container.style.minWidth=Bs(this.target)+"px")}onOverlayAnimationEnd(e){switch(e.toState){case"void":ur.clear(e.element);break}}appendOverlay(){this.$appendTo()&&this.$appendTo()!=="self"&&(this.$appendTo()==="body"?this.renderer.appendChild(this.document.body,this.container):Vs(this.$appendTo(),this.container))}restoreOverlayAppend(){this.container&&this.$appendTo()!=="self"&&this.renderer.appendChild(this.el.nativeElement,this.container)}moveOnTop(){this.autoZIndex&&ur.set("menu",this.container,this.baseZIndex+this.config.zIndex.menu)}hide(e,i){this.popup&&(this.onHide.emit({}),this.visible=!1),this.activeItemPath.set([]),this.focusedItemInfo.set({index:-1,level:0,parentKey:""}),i&&wr(this.relatedTarget||this.target||this.rootmenu.sublistViewChild.nativeElement),this.dirty=!1}toggle(e){this.visible?this.hide(e,!0):this.show(e)}show(e,i){this.popup&&(this.visible=!0,this.target=this.target||e.currentTarget,this.relatedTarget=e.relatedTarget||null,this.relativeAlign=e?.relativeAlign||null),this.focusedItemInfo.set({index:-1,level:0,parentKey:""}),i&&wr(this.rootmenu.sublistViewChild.nativeElement),this.cd.markForCheck()}searchItems(e,i){this.searchValue=(this.searchValue||"")+i;let n=-1,s=!1;return this.focusedItemInfo().index!==-1?(n=this.visibleItems.slice(this.focusedItemInfo().index).findIndex(a=>this.isItemMatched(a)),n=n===-1?this.visibleItems.slice(0,this.focusedItemInfo().index).findIndex(a=>this.isItemMatched(a)):n+this.focusedItemInfo().index):n=this.visibleItems.findIndex(a=>this.isItemMatched(a)),n!==-1&&(s=!0),n===-1&&this.focusedItemInfo().index===-1&&(n=this.findFirstFocusedItemIndex()),n!==-1&&this.changeFocusedItemIndex(e,n),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchValue="",this.searchTimeout=null},500),s}findLastFocusedItemIndex(){let e=this.findSelectedItemIndex();return e<0?this.findLastItemIndex():e}findLastItemIndex(){return Qa(this.visibleItems,e=>this.isValidItem(e))}findPrevItemIndex(e){let i=e>0?Qa(this.visibleItems.slice(0,e),n=>this.isValidItem(n)):-1;return i>-1?i:e}findNextItemIndex(e){let i=e<this.visibleItems.length-1?this.visibleItems.slice(e+1).findIndex(n=>this.isValidItem(n)):-1;return i>-1?i+e+1:e}findFirstFocusedItemIndex(){let e=this.findSelectedItemIndex();return e<0?this.findFirstItemIndex():e}findFirstItemIndex(){return this.visibleItems.findIndex(e=>this.isValidItem(e))}findSelectedItemIndex(){return this.visibleItems.findIndex(e=>this.isValidSelectedItem(e))}changeFocusedItemIndex(e,i){if(this.focusedItemInfo().index!==i){let n=this.focusedItemInfo();this.focusedItemInfo.set(B(T({},n),{item:this.visibleItems[i].item,index:i})),this.scrollInView()}}scrollInView(e=-1){let i=e!==-1?`${this.id}_${e}`:this.focusedItemId,n=Hi(this.rootmenu.el.nativeElement,`li[id="${i}"]`);n&&n.scrollIntoView&&n.scrollIntoView({block:"nearest",inline:"nearest"})}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new zs(this.target,e=>{this.visible&&this.hide(e,!0)})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&(this.scrollHandler.unbindScrollListener(),this.scrollHandler=null)}bindResizeListener(){ei(this.platformId)&&(this.resizeListener||(this.resizeListener=this.renderer.listen(this.document.defaultView,"resize",e=>{qn()||this.hide(e,!0)})))}bindOutsideClickListener(){ei(this.platformId)&&(this.outsideClickListener||(this.outsideClickListener=this.renderer.listen(this.document,"click",e=>{let i=this.containerViewChild&&!this.containerViewChild.nativeElement.contains(e.target),n=this.popup?!(this.target&&(this.target===e.target||this.target.contains(e.target))):!0;i&&n&&this.hide()})))}unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)}unbindResizeListener(){this.resizeListener&&(this.resizeListener(),this.resizeListener=null)}onOverlayHide(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindScrollListener(),this.cd.destroyed||(this.target=null)}ngOnDestroy(){this.popup&&(this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.container&&this.autoZIndex&&ur.clear(this.container),this.restoreOverlayAppend(),this.onOverlayHide()),this.unbindMatchMediaListener(),super.ngOnDestroy()}static \u0275fac=function(i){return new(i||r)(We($s))};static \u0275cmp=Oe({type:r,selectors:[["p-tieredMenu"],["p-tieredmenu"],["p-tiered-menu"]],contentQueries:function(i,n,s){if(i&1&&(nt(s,Bw,4),nt(s,Hw,4),nt(s,Cr,4)),i&2){let a;Ie(a=Fe())&&(n.submenuIconTemplate=a.first),Ie(a=Fe())&&(n.itemTemplate=a.first),Ie(a=Fe())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&(tt(Vw,5),tt(Ww,5)),i&2){let s;Ie(s=Fe())&&(n.rootmenu=s.first),Ie(s=Fe())&&(n.containerViewChild=s.first)}},inputs:{model:"model",popup:[2,"popup","popup",Ue],style:"style",styleClass:"styleClass",breakpoint:"breakpoint",autoZIndex:[2,"autoZIndex","autoZIndex",Ue],baseZIndex:[2,"baseZIndex","baseZIndex",hr],autoDisplay:[2,"autoDisplay","autoDisplay",Ue],showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",id:"id",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",disabled:[2,"disabled","disabled",Ue],tabindex:[2,"tabindex","tabindex",hr],appendTo:[1,"appendTo"]},outputs:{onShow:"onShow",onHide:"onHide"},features:[or([fl]),Pr],decls:1,vars:1,consts:[["container",""],["rootmenu",""],[3,"id","class","ngStyle","click",4,"ngIf"],[3,"click","id","ngStyle"],[3,"itemClick","menuFocus","menuBlur","menuKeydown","itemMouseEnter","root","items","itemTemplate","menuId","tabindex","ariaLabel","ariaLabelledBy","baseZIndex","autoZIndex","autoDisplay","popup","focusedItemId","activeItemPath"]],template:function(i,n){i&1&&he(0,Uw,4,26,"div",2),i&2&&M("ngIf",!n.popup||n.visible)},dependencies:[Be,Rt,Bi,jw,nn,Ur,Nt],encapsulation:2,data:{animation:[on("overlayAnimation",[ii(":enter",[ri({opacity:0,transform:"scaleY(0.8)"}),ti("{{showTransitionParams}}")]),ii(":leave",[ti("{{hideTransitionParams}}",ri({opacity:0}))])])]},changeDetection:0})}return r})();var vu=`
    .p-splitbutton {
        display: inline-flex;
        position: relative;
        border-radius: dt('splitbutton.border.radius');
    }

    .p-splitbutton-button.p-button {
        border-start-end-radius: 0;
        border-end-end-radius: 0;
        border-inline-end: 0 none;
    }

    .p-splitbutton-button.p-button:focus-visible,
    .p-splitbutton-dropdown.p-button:focus-visible {
        z-index: 1;
    }

    .p-splitbutton-button.p-button:not(:disabled):hover,
    .p-splitbutton-button.p-button:not(:disabled):active {
        border-inline-end: 0 none;
    }

    .p-splitbutton-dropdown.p-button {
        border-start-start-radius: 0;
        border-end-start-radius: 0;
    }

    .p-splitbutton .p-menu {
        min-width: 100%;
    }

    .p-splitbutton-fluid {
        display: flex;
    }

    .p-splitbutton-rounded .p-splitbutton-dropdown.p-button {
        border-start-end-radius: dt('splitbutton.rounded.border.radius');
        border-end-end-radius: dt('splitbutton.rounded.border.radius');
    }

    .p-splitbutton-rounded .p-splitbutton-button.p-button {
        border-start-start-radius: dt('splitbutton.rounded.border.radius');
        border-end-start-radius: dt('splitbutton.rounded.border.radius');
    }

    .p-splitbutton-raised {
        box-shadow: dt('splitbutton.raised.shadow');
    }
`;var Yw=["content"],Kw=["dropdownicon"],qw=["defaultbtn"],Zw=["menu"];function Qw(r,t){r&1&&zt(0)}function Jw(r,t){if(r&1){let e=Se();qt(0),U(1,"button",8),Ce("click",function(n){J(e);let s=E();return ee(s.onDefaultButtonClick(n))}),he(2,Qw,1,0,"ng-container",9),X(),Zt()}if(r&2){let e=E();S(),Te(e.cx("pcButton")),M("severity",e.severity)("text",e.text)("outlined",e.outlined)("size",e.size)("icon",e.icon)("iconPos",e.iconPos)("disabled",e.disabled)("pAutoFocus",e.autofocus)("pTooltip",e.tooltip)("tooltipOptions",e.tooltipOptions),Ae("tabindex",e.tabindex)("aria-label",(e.buttonProps==null?null:e.buttonProps.ariaLabel)||e.label),S(),M("ngTemplateOutlet",e.contentTemplate||e._contentTemplate)}}function e2(r,t){if(r&1){let e=Se();U(0,"button",10,2),Ce("click",function(n){J(e);let s=E();return ee(s.onDefaultButtonClick(n))}),X()}if(r&2){let e=E();Te(e.cx("pcButton")),M("severity",e.severity)("text",e.text)("outlined",e.outlined)("size",e.size)("icon",e.icon)("iconPos",e.iconPos)("label",e.label)("disabled",e.buttonDisabled)("pAutoFocus",e.autofocus)("pTooltip",e.tooltip)("tooltipOptions",e.tooltipOptions),Ae("tabindex",e.tabindex)("aria-label",e.buttonProps==null?null:e.buttonProps.ariaLabel)}}function t2(r,t){if(r&1&&xe(0,"span"),r&2){let e=E();Te(e.dropdownIcon)}}function r2(r,t){r&1&&(Pi(),xe(0,"svg",12))}function i2(r,t){}function n2(r,t){r&1&&he(0,i2,0,0,"ng-template")}function s2(r,t){if(r&1&&(qt(0),he(1,r2,1,0,"svg",11)(2,n2,1,0,null,9),Zt()),r&2){let e=E();S(),M("ngIf",!e.dropdownIconTemplate&&!e._dropdownIconTemplate),S(),M("ngTemplateOutlet",e.dropdownIconTemplate||e._dropdownIconTemplate)}}var a2={root:({instance:r})=>["p-splitbutton p-component",{"p-splitbutton-raised":r.raised,"p-splitbutton-rounded":r.rounded,"p-splitbutton-outlined":r.outlined,"p-splitbutton-text":r.text,[`p-splitbutton-${r.size==="small"?"sm":"lg"}`]:r.size}],pcButton:"p-splitbutton-button",pcDropdown:"p-splitbutton-dropdown p-button-icon-only"},_u=(()=>{class r extends xi{name="splitbutton";theme=vu;classes=a2;static \u0275fac=(()=>{let e;return function(n){return(e||(e=Dr(r)))(n||r)}})();static \u0275prov=ar({token:r,factory:r.\u0275fac})}return r})();var o2=(()=>{class r extends zr{model;severity;raised=!1;rounded=!1;text=!1;outlined=!1;size=null;plain=!1;icon;iconPos="left";label;tooltip;tooltipOptions;styleClass;menuStyle;menuStyleClass;dropdownIcon;appendTo="body";dir;expandAriaLabel;showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)";hideTransitionOptions=".1s linear";buttonProps;menuButtonProps;autofocus;set disabled(e){this._disabled=e,this.buttonDisabled=e,this.menuButtonDisabled=e}get disabled(){return this._disabled}tabindex;menuButtonDisabled=!1;buttonDisabled=!1;onClick=new ye;onMenuHide=new ye;onMenuShow=new ye;onDropdownClick=new ye;buttonViewChild;menu;contentTemplate;dropdownIconTemplate;templates;ariaId;isExpanded=Wr(!1);_disabled;_componentStyle=Et(_u);_contentTemplate;_dropdownIconTemplate;ngOnInit(){super.ngOnInit(),this.ariaId=sn("pn_id_")}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this._contentTemplate=e.template;break;case"dropdownicon":this._dropdownIconTemplate=e.template;break;default:this._contentTemplate=e.template;break}})}onDefaultButtonClick(e){this.onClick.emit(e),this.menu.hide()}onDropdownButtonClick(e){this.onDropdownClick.emit(e),this.menu?.toggle({currentTarget:this.el?.nativeElement,relativeAlign:this.appendTo==null})}onDropdownButtonKeydown(e){(e.code==="ArrowDown"||e.code==="ArrowUp")&&(this.onDropdownButtonClick(),e.preventDefault())}onHide(){this.isExpanded.set(!1),this.onMenuHide.emit()}onShow(){this.isExpanded.set(!0),this.onMenuShow.emit()}static \u0275fac=(()=>{let e;return function(n){return(e||(e=Dr(r)))(n||r)}})();static \u0275cmp=Oe({type:r,selectors:[["p-splitbutton"],["p-splitButton"],["p-split-button"]],contentQueries:function(i,n,s){if(i&1&&(nt(s,Yw,4),nt(s,Kw,4),nt(s,Cr,4)),i&2){let a;Ie(a=Fe())&&(n.contentTemplate=a.first),Ie(a=Fe())&&(n.dropdownIconTemplate=a.first),Ie(a=Fe())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&(tt(qw,5),tt(Zw,5)),i&2){let s;Ie(s=Fe())&&(n.buttonViewChild=s.first),Ie(s=Fe())&&(n.menu=s.first)}},hostVars:2,hostBindings:function(i,n){i&2&&Te(n.cn(n.cx("root"),n.styleClass))},inputs:{model:"model",severity:"severity",raised:[2,"raised","raised",Ue],rounded:[2,"rounded","rounded",Ue],text:[2,"text","text",Ue],outlined:[2,"outlined","outlined",Ue],size:"size",plain:[2,"plain","plain",Ue],icon:"icon",iconPos:"iconPos",label:"label",tooltip:"tooltip",tooltipOptions:"tooltipOptions",styleClass:"styleClass",menuStyle:"menuStyle",menuStyleClass:"menuStyleClass",dropdownIcon:"dropdownIcon",appendTo:"appendTo",dir:"dir",expandAriaLabel:"expandAriaLabel",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",buttonProps:"buttonProps",menuButtonProps:"menuButtonProps",autofocus:[2,"autofocus","autofocus",Ue],disabled:[2,"disabled","disabled",Ue],tabindex:[2,"tabindex","tabindex",hr],menuButtonDisabled:[2,"menuButtonDisabled","menuButtonDisabled",Ue],buttonDisabled:[2,"buttonDisabled","buttonDisabled",Ue]},outputs:{onClick:"onClick",onMenuHide:"onMenuHide",onMenuShow:"onMenuShow",onDropdownClick:"onDropdownClick"},features:[or([_u]),Pr],decls:8,vars:24,consts:[["defaultButton",""],["menu",""],["defaultbtn",""],[4,"ngIf","ngIfElse"],["type","button","pButton","","pRipple","",3,"click","keydown","size","severity","text","outlined","disabled"],[3,"class",4,"ngIf"],[4,"ngIf"],[3,"onHide","onShow","id","popup","model","styleClass","appendTo","showTransitionOptions","hideTransitionOptions"],["type","button","pButton","","pRipple","",3,"click","severity","text","outlined","size","icon","iconPos","disabled","pAutoFocus","pTooltip","tooltipOptions"],[4,"ngTemplateOutlet"],["type","button","pButton","","pRipple","",3,"click","severity","text","outlined","size","icon","iconPos","label","disabled","pAutoFocus","pTooltip","tooltipOptions"],["data-p-icon","chevron-down",4,"ngIf"],["data-p-icon","chevron-down"]],template:function(i,n){if(i&1){let s=Se();he(0,Jw,3,15,"ng-container",3)(1,e2,2,15,"ng-template",null,0,cr),U(3,"button",4),Ce("click",function(o){return J(s),ee(n.onDropdownButtonClick(o))})("keydown",function(o){return J(s),ee(n.onDropdownButtonKeydown(o))}),he(4,t2,1,2,"span",5)(5,s2,3,2,"ng-container",6),X(),U(6,"p-tieredmenu",7,1),Ce("onHide",function(){return J(s),ee(n.onHide())})("onShow",function(){return J(s),ee(n.onShow())}),X()}if(i&2){let s=Jt(2);M("ngIf",n.contentTemplate||n._contentTemplate)("ngIfElse",s),S(3),Te(n.cx("pcDropdown")),M("size",n.size)("severity",n.severity)("text",n.text)("outlined",n.outlined)("disabled",n.menuButtonDisabled),Ae("aria-label",(n.menuButtonProps==null?null:n.menuButtonProps.ariaLabel)||n.expandAriaLabel)("aria-haspopup",(n.menuButtonProps==null?null:n.menuButtonProps.ariaHasPopup)||!0)("aria-expanded",(n.menuButtonProps==null?null:n.menuButtonProps.ariaExpanded)||n.isExpanded())("aria-controls",(n.menuButtonProps==null?null:n.menuButtonProps.ariaControls)||n.ariaId),S(),M("ngIf",n.dropdownIcon),S(),M("ngIf",!n.dropdownIcon),S(),kt(n.menuStyle),M("id",n.ariaId)("popup",!0)("model",n.model)("styleClass",n.menuStyleClass)("appendTo",n.appendTo)("showTransitionOptions",n.showTransitionOptions)("hideTransitionOptions",n.hideTransitionOptions)}},dependencies:[Be,Rt,Jr,Zl,dl,ql,Gl,an,Ur,vi,Nt],encapsulation:2,changeDetection:0})}return r})(),yu=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=Mr({type:r});static \u0275inj=Or({imports:[o2,Nt,Nt]})}return r})();var l2=()=>({display:"none"});function c2(r,t){if(r&1&&(U(0,"span",21),ce(1),X()),r&2){let e=E().$implicit;S(),Ne(e.name)}}function h2(r,t){if(r&1){let e=Se();U(0,"div",18),Ce("click",function(){let n=J(e).$implicit,s=E(3);return ee(s.selectStock(n))}),U(1,"span",19),ce(2),X(),he(3,c2,2,1,"span",20),X()}if(r&2){let e=t.$implicit;S(2),Ne(e.symbol),S(),M("ngIf",e.name)}}function u2(r,t){if(r&1&&(U(0,"div",16),he(1,h2,4,2,"div",17),X()),r&2){let e=E(2);S(),M("ngForOf",e.filteredStocks)}}function f2(r,t){if(r&1){let e=Se();U(0,"div",11)(1,"div",12),xe(2,"i",13),U(3,"input",14),Ms("ngModelChange",function(n){J(e);let s=E();return Ds(s.searchQuery,n)||(s.searchQuery=n),ee(n)}),Ce("input",function(n){J(e);let s=E();return ee(s.onSearchInput(n))})("keyup.enter",function(n){J(e);let s=E();return ee(s.onSubmitSearch(n.target.value))}),X()(),he(4,u2,2,1,"div",15),X()}if(r&2){let e=E();S(3),As("ngModel",e.searchQuery),S(),M("ngIf",e.showSearchResults)}}function d2(r,t){r&1&&xe(0,"i",31)}function p2(r,t){r&1&&xe(0,"i",32)}function m2(r,t){r&1&&xe(0,"div",26)}function g2(r,t){if(r&1){let e=Se();U(0,"div",23),Ce("click",function(){J(e);let n=E(2);return ee(n.testCustomClick("subtle"))}),xe(1,"i",33),ce(2," Subtle (40%) "),X()}}function x2(r,t){if(r&1){let e=Se();U(0,"div",23),Ce("click",function(){J(e);let n=E(2);return ee(n.testCustomClick("medium"))}),xe(1,"i",33),ce(2," Medium (25%) "),X()}}function v2(r,t){if(r&1){let e=Se();U(0,"div",23),Ce("click",function(){J(e);let n=E(2);return ee(n.testCustomClick("strong"))}),xe(1,"i",33),ce(2," Strong (10%) "),X()}}function _2(r,t){if(r&1){let e=Se();U(0,"div",22)(1,"div",23),Ce("click",function(){J(e);let n=E();return ee(n.testCustomClick("excel"))}),he(2,d2,1,0,"i",24)(3,p2,1,0,"i",25),ce(4),X(),xe(5,"div",26),U(6,"div",23),Ce("click",function(){J(e);let n=E();return ee(n.testCustomClick("toggle"))}),xe(7,"i",27),ce(8),X(),he(9,m2,1,0,"div",28)(10,g2,3,0,"div",29)(11,x2,3,0,"div",29)(12,v2,3,0,"div",29),xe(13,"div",26),U(14,"div",23),Ce("click",function(){J(e);let n=E();return ee(n.testCustomClick("refresh"))}),xe(15,"i",30),ce(16," Force Tile Refresh "),X()()}if(r&2){let e=E();S(),Xa("loading",e.isExportingExcel),S(),M("ngIf",!e.isExportingExcel),S(),M("ngIf",e.isExportingExcel),S(),rt(" ",e.isExportingExcel?"Exporting Excel...":"Export to Excel"," "),S(3),Xa("pi-eye-slash",e.isHighlightingEnabled)("pi-eye",!e.isHighlightingEnabled),S(),rt(" ",e.isHighlightingEnabled?"Disable":"Enable"," Highlighting "),S(),M("ngIf",e.isHighlightingEnabled),S(),M("ngIf",e.isHighlightingEnabled),S(),M("ngIf",e.isHighlightingEnabled),S(),M("ngIf",e.isHighlightingEnabled)}}var vk=(()=>{let t=class t{constructor(){this.title="Dashboard",this.isHighlightingEnabled=!0,this.isExportingExcel=!1,this.enableStockSearch=!1,this.stockSearchList=[],this.onExportToExcel=new ye,this.onToggleHighlighting=new ye,this.onSetHighlightingPreset=new ye,this.onForceTileRefresh=new ye,this.onSearchStock=new ye,this.menuItems=[],this.showCustomMenu=!1,this.searchQuery="",this.filteredStocks=[],this.showSearchResults=!1,this.boundExportToExcel=()=>{console.log("Dashboard header: Export to Excel clicked (bound method)"),this.exportToExcel()},this.boundToggleHighlighting=()=>{console.log("Dashboard header: Toggle highlighting clicked (bound method)"),this.toggleHighlighting()},this.boundSetSubtle=()=>{console.log("Dashboard header: Set subtle preset (bound method)"),this.setHighlightingPreset("subtle")},this.boundSetMedium=()=>{console.log("Dashboard header: Set medium preset (bound method)"),this.setHighlightingPreset("medium")},this.boundSetStrong=()=>{console.log("Dashboard header: Set strong preset (bound method)"),this.setHighlightingPreset("strong")}}ngOnChanges(i){(i.isHighlightingEnabled||i.isExportingExcel)&&this.updateMenuItems()}ngOnInit(){this.updateMenuItems()}updateMenuItems(){let i=[];i.push({label:"\u{1F9EA} Simple Test",command:()=>{alert("Simple test works!")}}),i.push({separator:!0}),i.push({label:"Export to Excel",command:()=>{console.log("EXCEL EXPORT CLICKED!"),this.exportToExcel()}}),i.push({separator:!0}),i.push({label:this.isHighlightingEnabled?"Disable Highlighting":"Enable Highlighting",command:()=>{this.toggleHighlighting()}}),this.isHighlightingEnabled&&(i.push({separator:!0}),i.push({label:"Highlighting Intensity",items:[{label:"Subtle (40%)",command:this.boundSetSubtle},{label:"Medium (25%)",command:this.boundSetMedium},{label:"Strong (10%)",command:this.boundSetStrong}]})),this.menuItems=i}exportToExcel(){this.onExportToExcel.emit()}toggleHighlighting(){this.onToggleHighlighting.emit(),setTimeout(()=>{this.updateMenuItems()},100)}setHighlightingPreset(i){this.onSetHighlightingPreset.emit(i)}onMenuButtonClick(i,n){n.toggle(i)}onMenuShow(){console.log("Menu shown")}onMenuHide(){console.log("Menu hidden")}testMainAction(){console.log("SPLIT BUTTON MAIN ACTION CLICKED!"),alert("Split button main action works!")}toggleCustomMenu(){console.log("Custom menu toggle clicked"),this.showCustomMenu=!this.showCustomMenu}testCustomClick(i){switch(console.log("CUSTOM MENU ITEM CLICKED:",i),this.showCustomMenu=!1,i){case"test":alert("Custom test menu item works!");break;case"excel":this.exportToExcel();break;case"toggle":this.toggleHighlighting();break;case"subtle":this.setHighlightingPreset("subtle");break;case"medium":this.setHighlightingPreset("medium");break;case"strong":this.setHighlightingPreset("strong");break;case"refresh":this.onForceTileRefresh.emit();break}}onSearchInput(i){let n=i.target.value.toLowerCase();if(this.searchQuery=n,n.length===0){this.filteredStocks=[],this.showSearchResults=!1;return}this.filteredStocks=this.stockSearchList.filter(s=>s.symbol.toLowerCase().includes(n)||s.name&&s.name.toLowerCase().includes(n)).slice(0,10),this.showSearchResults=this.filteredStocks.length>0}selectStock(i){this.onSearchStock.emit(i.symbol),this.searchQuery="",this.showSearchResults=!1}onSubmitSearch(i){let n=(i||"").trim();n&&(this.onSearchStock.emit(n.toUpperCase()),this.searchQuery="",this.showSearchResults=!1)}onDocumentClick(i){if(this.showCustomMenu){let n=i.target;n&&!n.closest(".custom-menu-container")&&(this.showCustomMenu=!1)}if(this.showSearchResults){let n=i.target;n&&!n.closest(".header-search")&&(this.showSearchResults=!1)}}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-dashboard-header"]],hostBindings:function(n,s){n&1&&Ce("click",function(o){return s.onDocumentClick(o)},Ml)},inputs:{title:"title",isHighlightingEnabled:"isHighlightingEnabled",isExportingExcel:"isExportingExcel",enableStockSearch:"enableStockSearch",stockSearchList:"stockSearchList"},outputs:{onExportToExcel:"onExportToExcel",onToggleHighlighting:"onToggleHighlighting",onSetHighlightingPreset:"onSetHighlightingPreset",onForceTileRefresh:"onForceTileRefresh",onSearchStock:"onSearchStock"},features:[Ar],decls:12,vars:8,consts:[["menu",""],[1,"dashboard-header"],[1,"dashboard-header-left"],[1,"dashboard-title"],[1,"dashboard-header-right"],["class","header-search",4,"ngIf"],[1,"custom-menu-container"],[1,"custom-menu-button",3,"click"],[1,"pi","pi-ellipsis-v"],["class","custom-menu",4,"ngIf"],["appendTo","body",3,"onShow","onHide","model","popup"],[1,"header-search"],[1,"search-input-container"],[1,"pi","pi-search","search-icon"],["type","text","placeholder","Search stock symbol or company name",1,"header-search-input",3,"ngModelChange","input","keyup.enter","ngModel"],["class","search-results",4,"ngIf"],[1,"search-results"],["class","search-result-item",3,"click",4,"ngFor","ngForOf"],[1,"search-result-item",3,"click"],[1,"stock-symbol"],["class","stock-name",4,"ngIf"],[1,"stock-name"],[1,"custom-menu"],[1,"custom-menu-item",3,"click"],["class","pi pi-file-excel",4,"ngIf"],["class","pi pi-spin pi-spinner",4,"ngIf"],[1,"custom-menu-separator"],[1,"pi"],["class","custom-menu-separator",4,"ngIf"],["class","custom-menu-item",3,"click",4,"ngIf"],[1,"pi","pi-refresh"],[1,"pi","pi-file-excel"],[1,"pi","pi-spin","pi-spinner"],[1,"pi","pi-circle"]],template:function(n,s){if(n&1){let a=Se();U(0,"div",1)(1,"div",2)(2,"h2",3),ce(3),X()(),U(4,"div",4),he(5,f2,5,2,"div",5),U(6,"div",6)(7,"button",7),Ce("click",function(){return J(a),ee(s.toggleCustomMenu())}),xe(8,"i",8),X(),he(9,_2,17,14,"div",9),X()()(),U(10,"p-menu",10,0),Ce("onShow",function(){return J(a),ee(s.onMenuShow())})("onHide",function(){return J(a),ee(s.onMenuHide())}),X()}n&2&&(S(3),Ne(s.title),S(2),M("ngIf",s.enableStockSearch),S(4),M("ngIf",s.showCustomMenu),S(),kt(vr(7,l2)),M("model",s.menuItems)("popup",!0))},dependencies:[Be,gi,Rt,yi,ia,gn,yu,lc,ln,wi,Ql,Jl,tc],styles:[".dashboard-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:2px 16px;margin:4px 0;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border:1px solid #dee2e6;border-radius:8px;box-shadow:0 2px 4px #0000000d;transition:all .3s ease;position:relative;z-index:10}.dashboard-header[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #0000001a;transform:translateY(-1px)}.dashboard-header-left[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center}.dashboard-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#495057;margin:0;padding:0}.dashboard-header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;position:relative}.header-search[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative}.search-input-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.search-icon[_ngcontent-%COMP%]{position:absolute;left:10px;color:#6c757d;font-size:14px;z-index:1}.header-search-input[_ngcontent-%COMP%]{padding:6px 10px 6px 35px;border:1px solid #ced4da;border-radius:6px;min-width:242px;outline:none;font-size:14px;transition:border-color .2s ease}.header-search-input[_ngcontent-%COMP%]:focus{border-color:#007bff;box-shadow:0 0 0 2px #007bff40}.search-results[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:#fff;border:1px solid #ced4da;border-radius:6px;box-shadow:0 4px 12px #00000026;z-index:1000;max-height:300px;overflow-y:auto;margin-top:4px}.search-result-item[_ngcontent-%COMP%]{padding:10px 12px;cursor:pointer;border-bottom:1px solid #f8f9fa;display:flex;flex-direction:column;gap:2px;transition:background-color .2s ease}.search-result-item[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.search-result-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.stock-symbol[_ngcontent-%COMP%]{font-weight:600;color:#495057;font-size:14px}.stock-name[_ngcontent-%COMP%]{color:#6c757d;font-size:12px}[_nghost-%COMP%]     .p-button.p-button-sm{transition:all .2s ease;font-size:13px;position:relative;z-index:11}[_nghost-%COMP%]     .p-button.p-button-sm:hover{transform:translateY(-1px);box-shadow:0 3px 6px #0000001a}[_nghost-%COMP%]     .p-button.p-button-outlined{background:#ffffffe6}[_nghost-%COMP%]     .p-button.p-button-outlined:hover{background:#fff}[_nghost-%COMP%]     .p-menu{z-index:99999!important;box-shadow:0 8px 16px #0003!important;border:1px solid #ccc!important;background:#fff!important}[_nghost-%COMP%]     .p-menu .p-menuitem{pointer-events:auto!important;cursor:pointer!important;position:relative!important;background:transparent!important}[_nghost-%COMP%]     .p-menu .p-menuitem-link{pointer-events:auto!important;cursor:pointer!important;display:block!important;padding:12px 16px!important;color:#333!important;text-decoration:none!important;width:100%!important;background:transparent!important;border:none!important;outline:none!important}[_nghost-%COMP%]     .p-menu .p-menuitem:hover{background-color:#f0f0f0!important}[_nghost-%COMP%]     .p-menu .p-menuitem-link:hover{background-color:#f0f0f0!important;color:#000!important}[_nghost-%COMP%]     .p-menu .p-menuitem-icon{pointer-events:none!important;margin-right:8px!important}[_nghost-%COMP%]     .p-menu .p-menuitem-text{pointer-events:none!important}[_nghost-%COMP%]     .p-menu .p-separator{pointer-events:none!important;background:#eee!important;height:1px!important;margin:4px 0!important}[_nghost-%COMP%]     .p-menu .p-submenu-list{z-index:100000!important;box-shadow:0 4px 12px #00000026!important;background:#fff!important;border:1px solid #ccc!important}@media (max-width: 768px){.dashboard-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.dashboard-header-left[_ngcontent-%COMP%]{text-align:center}.dashboard-title[_ngcontent-%COMP%]{font-size:1.1rem}.dashboard-header-right[_ngcontent-%COMP%]{justify-content:center}.header-search-input[_ngcontent-%COMP%]{min-width:200px}}.custom-menu-container[_ngcontent-%COMP%]{position:relative;display:inline-block}.custom-menu-button[_ngcontent-%COMP%]{background:#ffffffe6;border:1px solid #ccc;border-radius:4px;padding:8px 12px;cursor:pointer;font-size:14px;transition:all .2s ease}.custom-menu-button[_ngcontent-%COMP%]:hover{background:#fff;transform:translateY(-1px);box-shadow:0 3px 6px #0000001a}.custom-menu[_ngcontent-%COMP%]{position:absolute;right:0;top:100%;margin-top:4px;background:#fff;border:1px solid #ccc;border-radius:4px;box-shadow:0 8px 16px #0003;z-index:99999;min-width:200px;overflow:hidden}.custom-menu-item[_ngcontent-%COMP%]{padding:12px 16px;cursor:pointer;color:#333;background:#fff;border:none;width:100%;text-align:left;font-size:14px;transition:background-color .2s ease;display:flex;align-items:center;gap:8px}.custom-menu-item[_ngcontent-%COMP%]:hover{background-color:#f0f0f0;color:#000}.custom-menu-item.loading[_ngcontent-%COMP%]{opacity:.7;cursor:wait}.custom-menu-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:16px;font-size:14px}.custom-menu-item[_ngcontent-%COMP%]   i.pi-spin[_ngcontent-%COMP%]{animation:spin 1s linear infinite}.custom-menu-separator[_ngcontent-%COMP%]{height:1px;background:#eee;margin:4px 0}"]});let r=t;return r})();var y2=["dashboardContainer"],w2=(()=>{let t=class t{constructor(i,n,s){this.cdr=i,this.excelExportService=n,this.filterService=s,this.isExportingExcel=!1,this.isUpdatingFilters=!1,this.isHighlightingEnabled=!0,this.highlightingOpacity=.25}ngOnInit(){this.initializeDashboardConfig(),this.filterSubscription=this.filterService.filterValues$.subscribe(i=>{this.updateWidgetsWithFilters(i)}),this.onChildInit()}onFilterValuesChanged(i){this.isUpdatingFilters||(this.isUpdatingFilters=!0,this.filterService.setFilterValues(i),this.isUpdatingFilters=!1)}updateWidgetsWithFilters(i){if(this.isUpdatingFilters)return;let n=i||this.filterService.getFilterValues();this.applyFiltersToDashboardData(n),this.dashboardConfig.widgets.filter(a=>a.config?.component==="echart").forEach(a=>{this.updateWidgetWithFilters(a,n)}),this.updateMetricTilesWithFilters(n),setTimeout(()=>{this.cdr.detectChanges(),setTimeout(()=>{this.cdr.detectChanges()},100)},50)}updateMetricTilesWithFilters(i){let n=this.dashboardConfig.widgets.filter(a=>a.config?.component==="tile"),s=this.createMetricTiles(this.dashboardData);n.forEach((a,o)=>{if(o<s.length){let c=s[o];a.config?.options?.updateOnDataChange!==!1&&a.config?.options&&Object.assign(a.config.options,c.config?.options)}})}applyFiltersToDashboardData(i){if(i.length===0){this.dashboardData=[...this.initialDashboardData];return}this.dashboardConfig?.filterVisualization?.enableHighlighting?this.dashboardData=[...this.initialDashboardData]:this.dashboardData=this.applyFiltersToFlatData(this.initialDashboardData,i)}applyFiltersToFlatData(i,n){return!n||n.length===0?i:i.filter(s=>n.every(a=>this.matchesFlatDataFilter(s,a)))}matchesFlatDataFilter(i,n){let s=i,a=n.value||n[n.accessor];if(n.accessor&&s.hasOwnProperty(n.accessor))return s[n.accessor]===a;let o=["category","month","type","name"];for(let c of o)if(s.hasOwnProperty(c)&&s[c]===a)return!0;return Object.values(s).includes(a)}getFilteredDataForWidgetFromOriginalData(i,n){let s=this.applyFiltersToFlatData(this.initialDashboardData,n);return this.getFilteredDataForWidget(i,s)}groupByAndSum(i,n,s){let a=i.reduce((o,c)=>{let l=c,h=l[n];o[h]||(o[h]=0);let u=Number(l[s])||0;return o[h]+=u,o},{});return Object.entries(a).map(([o,c])=>({name:o,value:c}))}groupByAndCount(i,n){let s=i.reduce((a,o)=>{let l=o[n];return a[l]||(a[l]=0),a[l]++,a},{});return Object.entries(s).map(([a,o])=>({name:a,value:o}))}groupByAndAverage(i,n,s){let a=i.reduce((o,c)=>{let l=c,h=l[n];o[h]||(o[h]={sum:0,count:0});let u=Number(l[s])||0;return o[h].sum+=u,o[h].count++,o},{});return Object.entries(a).map(([o,{sum:c,count:l}])=>({name:o,value:l>0?c/l:0}))}filterByFieldValues(i,n,s){return i.filter(a=>{let o=a;return s.includes(o[n])})}getUniqueFieldValues(i,n){let s=i.map(a=>a[n]);return[...new Set(s)]}sortByField(i,n,s=!0){return[...i].sort((a,o)=>{let c=a[n],l=o[n];return c<l?s?-1:1:c>l?s?1:-1:0})}aggregateByFields(i,n,s){let a=i.reduce((o,c)=>{let l=c,h=n.map(u=>l[u]).join("|");return o[h]||(o[h]={groupKey:h,groupValues:n.reduce((u,f)=>(u[f]=l[f],u),{}),aggregations:s.reduce((u,f)=>(u[f.field]={operation:f.operation,values:[]},u),{})}),s.forEach(u=>{let f=Number(l[u.field])||0;o[h].aggregations[u.field].values.push(f)}),o},{});return Object.values(a).map(o=>{let c=T({},o.groupValues);return Object.entries(o.aggregations).forEach(([l,h])=>{let u=h.values;switch(h.operation){case"sum":c[`${l}_sum`]=u.reduce((f,p)=>f+p,0);break;case"count":c[`${l}_count`]=u.length;break;case"avg":c[`${l}_avg`]=u.length>0?u.reduce((f,p)=>f+p,0)/u.length:0;break;case"min":c[`${l}_min`]=Math.min(...u);break;case"max":c[`${l}_max`]=Math.max(...u);break}}),c})}updateWidgetWithFilters(i,n){if(!i.config||!i.config.component)return;let s=i.config?.header?.title,a=n.some(h=>{let u=h.widgetId===i.id,f=h.widgetTitle===s;return u||f}),o=this.dashboardConfig?.filterVisualization?.enableHighlighting,c=null;if(s&&(o&&!a&&n.length>0?c=this.getFilteredDataForWidgetFromOriginalData(s,n):c=this.getFilteredDataForWidget(s)),c||(c=this.getSummarizedDataByWidget(s||"")),!c)return;let l=c;if(o&&n.length>0&&a){let h=i.config?.options,u="other";h?.series?.[0]?.type&&(u=h.series[0].type);let f={filteredOpacity:this.dashboardConfig.filterVisualization?.defaultFilteredOpacity||.25,highlightedOpacity:this.dashboardConfig.filterVisualization?.defaultHighlightedOpacity||1,highlightColor:this.dashboardConfig.filterVisualization?.defaultHighlightColor||"#ff6b6b",filteredColor:this.dashboardConfig.filterVisualization?.defaultFilteredColor||"#e0e0e0"};l=this.filterService.applyHighlightingToEChartsData(c,n,u,f)}else n.length>0&&(Array.isArray(c)?(l=this.filterService.applyFiltersToData(c,n),l.length===0&&(l=[{name:"No data matches filter",value:0,itemStyle:{color:"#cccccc"}}])):l=c);i.config.component==="echart"&&this.updateEchartWidget(i,l)}updateEchartWidget(i,n){if(!i.config?.options)return;let s=i.config?.header?.title,a=T({},i.config.options);if(a.series&&a.series.length>0){let o=a.series[0];if(n&&n.length>0)if(o.type==="treemap")if(this.isHierarchicalData(n))o.data=n;else{console.warn(`Skipping treemap update for widget "${s}" - data is not hierarchical`);return}else o.data=n,a.xAxis&&a.xAxis.type==="value"&&a.yAxis&&a.yAxis.type==="category"?a.yAxis&&(Array.isArray(a.yAxis)&&a.yAxis[0]&&a.yAxis[0].data!==void 0?a.yAxis[0].data=n.map(l=>l.name):!Array.isArray(a.yAxis)&&a.yAxis.data!==void 0&&(a.yAxis.data=n.map(l=>l.name))):a.xAxis&&(Array.isArray(a.xAxis)&&a.xAxis[0]&&a.xAxis[0].data!==void 0?a.xAxis[0].data=n.map(l=>l.name):!Array.isArray(a.xAxis)&&a.xAxis.data!==void 0&&(a.xAxis.data=n.map(l=>l.name)))}i.config.options=a,this.scheduleWidgetUpdate(i)}isHierarchicalData(i){return!Array.isArray(i)||i.length===0?!1:i.some(n=>n&&typeof n=="object"&&n.children&&Array.isArray(n.children)&&n.children.length>0)}scheduleWidgetUpdate(i){this.widgetUpdateTimeout&&clearTimeout(this.widgetUpdateTimeout),this.widgetUpdateTimeout=setTimeout(()=>{this.retryWidgetUpdate(i,0)},50)}retryWidgetUpdate(i,n){let o=i.config?.header?.title||i.id;if(!(n>=5))try{this.cdr.detectChanges(),setTimeout(()=>{this.cdr.detectChanges()},50)}catch{let l=100*Math.pow(2,n);setTimeout(()=>{this.retryWidgetUpdate(i,n+1)},l)}}exportDashboardToExcel(){return Tt(this,null,function*(){this.isExportingExcel=!0,this.cdr.detectChanges();try{yield new Promise(i=>setTimeout(i,50)),yield new Promise((i,n)=>{setTimeout(()=>Tt(this,null,function*(){try{yield this.excelExportService.exportDashboardToExcel(this.dashboardConfig.widgets,{filename:`financial-dashboard-data-${new Date().toISOString().split("T")[0]}.xlsx`,includeHeaders:!0,includeTimestamp:!0,sheetNamePrefix:"Widget",autoColumnWidth:!0,includeWidgetTitles:!0}),i()}catch(s){console.error("Excel export failed:",s),n(s)}}),100)})}catch(i){console.error("Excel export error:",i)}finally{this.isExportingExcel=!1,this.cdr.detectChanges()}})}updateAllCharts(){return Tt(this,null,function*(){try{let i=yield this.getUpdatedChartData();this.dashboardConfig.widgets.forEach((n,s)=>{if(n.config?.component==="echart"&&i[s]&&n.config?.options){let a=n.config.options;a.series&&a.series.forEach((o,c)=>{i[s][c]&&(o.data=i[s][c])})}})}catch{}})}getUpdatedChartData(){return Tt(this,null,function*(){return yield new Promise(i=>setTimeout(i,1e3)),[{name:"Updated Data 1",value:Math.random()*100},{name:"Updated Data 2",value:Math.random()*100},{name:"Updated Data 3",value:Math.random()*100}]})}clearAllFilters(){this.isUpdatingFilters=!0;try{this.filterService.clearAllFilters()}finally{this.isUpdatingFilters=!1}}getCurrentFilters(){return this.filterService.getFilterValues()}toggleHighlightingMode(){this.isHighlightingEnabled=!this.isHighlightingEnabled,this.updateDashboardHighlightingConfig();let i=this.getCurrentFilters();this.updateWidgetsWithFilters(i),this.cdr.detectChanges()}updateHighlightingOpacity(i){this.highlightingOpacity=Math.max(.1,Math.min(1,i)),this.updateDashboardHighlightingConfig();let n=this.getCurrentFilters();this.updateWidgetsWithFilters(n),this.cdr.detectChanges()}updateDashboardHighlightingConfig(){this.dashboardConfig?.filterVisualization&&(this.dashboardConfig.filterVisualization.enableHighlighting=this.isHighlightingEnabled,this.dashboardConfig.filterVisualization.defaultFilteredOpacity=this.highlightingOpacity)}getHighlightingStatusMessage(){return this.isHighlightingEnabled?`Highlighting Mode: ON - Source widgets highlighted (${Math.round(this.highlightingOpacity*100)}% opacity), others filtered`:"Highlighting Mode: OFF - All widgets use traditional filtering"}setHighlightingPreset(i){let n;switch(i){case"subtle":n=.4;break;case"medium":n=.25;break;case"strong":n=.1;break}this.updateHighlightingOpacity(n)}populateWidgetsWithInitialData(){if(!this.dashboardConfig?.widgets)return;this.dashboardConfig.widgets.filter(n=>n.config?.component==="echart").forEach(n=>{let s=n.config?.header?.title||"",a=null;s&&(a=this.getFilteredDataForWidget(s)),a||(a=this.getSummarizedDataByWidget(s)),a&&this.updateEchartWidget(n,a)}),this.updateMetricTilesWithFilters([]),setTimeout(()=>{this.cdr.detectChanges()},100)}ngOnDestroy(){this.widgetUpdateTimeout&&clearTimeout(this.widgetUpdateTimeout),this.filterSubscription&&this.filterSubscription.unsubscribe(),this.onChildDestroy()}};t.\u0275fac=function(n){return new(n||t)(We($r),We(La),We(wu))},t.\u0275dir=Un({type:t,viewQuery:function(n,s){if(n&1&&(tt(y2,5),tt(ul,5)),n&2){let a;Ie(a=Fe())&&(s.dashboardContainer=a.first),Ie(a=Fe())&&(s.dashboardContainerComponent=a.first)}}});let r=t;return r})();var wu=(()=>{let t=class t{constructor(){this.filterValuesSubject=new za([]),this.filterEventsSubject=new za([]),this.isUpdating=!1,this.filterValues$=this.filterValuesSubject.asObservable(),this.filterEvents$=this.filterEventsSubject.asObservable()}getFilterValues(){return this.filterValuesSubject.value}getFilterEvents(){return this.filterEventsSubject.value}addFilterValue(i,n,s){if(this.isUpdating)return;let a=this.createFilterValueFromClickData(s);if(a){a.widgetId=i,a.widgetTitle=n;let o=this.filterValuesSubject.value;if(o.some(p=>this.isSameFilter(p,a)))return;let l=[...o,a];this.debouncedUpdate(l);let h={widgetId:i,widgetTitle:n,filterValue:a,timestamp:new Date},f=[...this.filterEventsSubject.value,h];this.filterEventsSubject.next(f)}}removeFilterValue(i){if(this.isUpdating)return;let s=this.filterValuesSubject.value.filter(a=>!this.isSameFilter(a,i));this.debouncedUpdate(s)}clearAllFilters(){if(!this.isUpdating){this.isUpdating=!0;try{this.filterValuesSubject.next([]),this.filterEventsSubject.next([])}finally{this.isUpdating=!1}}}setFilterValues(i){this.isUpdating||this.debouncedUpdate(i)}debouncedUpdate(i){this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>{this.isUpdating=!0;try{this.filterValuesSubject.next(i)}finally{this.isUpdating=!1}},50)}getFiltersForWidget(i){return this.filterValuesSubject.value.filter(n=>n.widgetId===i)}getFiltersByAccessor(i){return this.filterValuesSubject.value.filter(n=>n.accessor===i||n.filterColumn===i)}hasActiveFilters(i){return this.getFiltersForWidget(i).length>0}createFilterValueFromClickData(i){if(!i||typeof i!="object")return null;let n={accessor:"unknown"};if(i.name)n={accessor:"category",category:i.name,value:i.value||i.name};else if(i.seriesName)n={accessor:"series",series:i.seriesName,value:i.value||i.seriesName};else if(i.value&&Array.isArray(i.value))n={accessor:"coordinates",x:i.value[0]?.toString(),y:i.value[1]?.toString(),value:`(${i.value[0]}, ${i.value[1]})`};else{let s=Object.keys(i);if(s.length>0){let a=s[0];n={accessor:a,[a]:i[a],value:i[a]?.toString()}}}return n.accessor!=="unknown"?n:null}isSameFilter(i,n){return JSON.stringify(i)===JSON.stringify(n)}applyFiltersToData(i,n){if(!Array.isArray(i))return console.warn("FilterService.applyFiltersToData: data is not an array, returning as-is",i),i;if(!n||n.length===0)return i;let s=n.filter(o=>{if(o.accessor==="category")return i.some(l=>l.name===o.category||l.category===o.category);let c=o.filterColumn||o.accessor;return i.some(l=>l.hasOwnProperty(c))});return s.length===0?i:i.filter(o=>s.every(c=>this.matchesFilter(o,c)))}matchesFilter(i,n){let s=n.filterColumn||n.accessor,a=!1;switch(n.accessor){case"category":a=i.name===n.category||i.category===n.category;break;case"series":a=i.seriesName===n.series||i.series===n.series;break;case"coordinates":a=i.value&&Array.isArray(i.value)&&i.value[0]?.toString()===n.x&&i.value[1]?.toString()===n.y;break;default:let o=n.filterColumn||n.accessor;a=i[o]===n[n.accessor]||i[o]?.toString()===n.value;break}return a}applyHighlightingFiltersToData(i,n,s){if(!n||n.length===0)return i.map(c=>B(T({},c),{_filterState:"normal"}));let o=T(T({},{filteredOpacity:.3,highlightedOpacity:1,highlightColor:void 0,filteredColor:"#cccccc"}),s);return i.map(c=>n.some(h=>this.matchesFilter(c,h))?B(T({},c),{_filterState:"highlighted",_visualOptions:{opacity:o.highlightedOpacity,color:o.highlightColor}}):B(T({},c),{_filterState:"filtered",_visualOptions:{opacity:o.filteredOpacity,color:o.filteredColor}}))}applyHighlightingToEChartsData(i,n,s="other",a){if(!n||n.length===0)return i;let c=T(T({},{filteredOpacity:.3,highlightedOpacity:1,highlightColor:void 0,filteredColor:"#cccccc"}),a);return s==="pie"?i.map((l,h)=>n.some(f=>this.matchesPieSliceFilter(l,f))?B(T({},l),{itemStyle:B(T({},l.itemStyle),{opacity:c.highlightedOpacity,borderWidth:3,borderColor:c.highlightColor||"#ff6b6b"})}):B(T({},l),{itemStyle:B(T({},l.itemStyle),{opacity:c.filteredOpacity,color:c.filteredColor})})):s==="bar"?i.map(l=>n.some(u=>this.matchesBarDataFilter(l,u))?B(T({},l),{itemStyle:B(T({},l.itemStyle),{opacity:c.highlightedOpacity,borderWidth:2,borderColor:c.highlightColor||"#ff6b6b"})}):B(T({},l),{itemStyle:B(T({},l.itemStyle),{opacity:c.filteredOpacity,color:c.filteredColor})})):i}matchesPieSliceFilter(i,n){if(!i||!n)return!1;if(i.name&&n.value){let s=i.name.toString().toLowerCase(),a=n.value.toString().toLowerCase();if(s===a)return!0}if(i.name&&n.category){let s=i.name.toString().toLowerCase(),a=n.category.toString().toLowerCase();if(s===a)return!0}return!1}matchesBarDataFilter(i,n){return!i||!n?!1:i.name&&n.category?i.name.toString().toLowerCase()===n.category.toString().toLowerCase():i.name&&n.value?i.name.toString().toLowerCase()===n.value.toString().toLowerCase():!1}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ar({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();var Na=class r{constructor(){this.widgetBuilder=new tr().setId(cn()).setComponent("tile"),this.tileOptions=this.getDefaultTileOptions(),this.styleOptions=this.getDefaultStyleOptions(),this.layoutOptions=this.getDefaultLayoutOptions(),this.customData={}}static create(){return new r}static createFromData(t){return new r().setData(t).setValue(t.value).setChange(t.change||"").setChangeType(t.changeType||"neutral").setDescription(t.description||"").setIcon(t.icon||"fas fa-chart-bar").setColor(t.color||"#6b7280").setBackgroundColor(t.backgroundColor||"").setHeader(t.title||"").setSubHeader(t.subtitle||"")}getDefaultTileOptions(){return{value:"",change:"",changeType:"neutral",icon:"fas fa-chart-bar",color:"#6b7280",description:"",updateOnDataChange:!0}}getDefaultStyleOptions(){return{color:"#6b7280",backgroundColor:"",borderColor:"",borderWidth:0,borderRadius:8,padding:"1.5rem",margin:"0",fontSize:"1rem",fontWeight:"normal",textAlign:"left",iconSize:"2rem",iconColor:"inherit",backgroundOpacity:1}}getDefaultLayoutOptions(){return{width:"100%",height:"100%",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",gap:"1rem"}}setData(t){return this.customData=T(T({},this.customData),t),this.widgetBuilder.setData(this.customData),this}setValue(t){let e=String(t);return this.tileOptions.value=e,this.customData.value=e,this}setChange(t){return this.tileOptions.change=t,this.customData.change=t,this}setChangeType(t){return this.tileOptions.changeType=t,this.customData.changeType=t,this}setDescription(t){return this.tileOptions.description=t,this.customData.description=t,this}setHeader(t,e){return this.widgetBuilder.setHeader(t,e),this.customData.title=t,this}setSubHeader(t){return this.customData.subtitle=t,this}setHeaders(t,e,i){return this.setHeader(t,i),e&&this.setSubHeader(e),this}setColor(t){return this.tileOptions.color=t,this.styleOptions.color=t,this}setBackgroundColor(t){return this.styleOptions.backgroundColor=t,this.customData.backgroundColor=t,this}setBackgroundOpacity(t){return this.styleOptions.backgroundOpacity=t,this.customData.backgroundOpacity=t,this}setUpdateOnDataChange(t){return this.tileOptions.updateOnDataChange=t,this.customData.updateOnDataChange=t,this}setIcon(t){return this.tileOptions.icon=t,this.customData.icon=t,this}setIconSize(t){return this.styleOptions.iconSize=t,this}setIconColor(t){return this.styleOptions.iconColor=t,this}setBorder(t,e=1,i=8){return this.styleOptions.borderColor=t,this.styleOptions.borderWidth=e,this.styleOptions.borderRadius=i,this}setPadding(t){return this.styleOptions.padding=t,this}setMargin(t){return this.styleOptions.margin=t,this}setFont(t,e="normal"){return this.styleOptions.fontSize=t,this.styleOptions.fontWeight=e,this}setTextAlign(t){return this.styleOptions.textAlign=t,this}setStyle(t){return this.styleOptions=T(T({},this.styleOptions),t),this}setPosition(t){return this.widgetBuilder.setPosition(t),this}setSize(t,e){return this.layoutOptions.width=t,this.layoutOptions.height=e,this}setMinSize(t,e){return this.layoutOptions.minWidth=t,this.layoutOptions.minHeight=e,this}setMaxSize(t,e){return this.layoutOptions.maxWidth=t,this.layoutOptions.maxHeight=e,this}setFlexDirection(t){return this.layoutOptions.flexDirection=t,this}setJustifyContent(t){return this.layoutOptions.justifyContent=t,this}setAlignItems(t){return this.layoutOptions.alignItems=t,this}setGap(t){return this.layoutOptions.gap=t,this}setLayout(t){return this.layoutOptions=T(T({},this.layoutOptions),t),this}setAccessor(t){return this.tileOptions.accessor=t,this}setTileOptions(t){return this.tileOptions=T(T({},this.tileOptions),t),this}setEvents(t){return t&&this.widgetBuilder.setEvents(t),this}setInitialState(t){return this.widgetBuilder.setInitialState(t),this}setState(t){return this.widgetBuilder.setState(t),this}setProperty(t,e){return this.customData[t]=e,this}setProperties(t){return this.customData=T(T({},this.customData),t),this}build(){let t=B(T(T({},this.tileOptions),this.customData),{style:this.styleOptions,layout:this.layoutOptions});return this.widgetBuilder.setTileOptions(t),this.widgetBuilder.build()}getTileOptions(){return T({},this.tileOptions)}getStyleOptions(){return T({},this.styleOptions)}getLayoutOptions(){return T({},this.layoutOptions)}getCustomData(){return T({},this.customData)}getWidgetBuilder(){return this.widgetBuilder}static updateData(t,e){if(r.isTileWidget(t)){let i=t.config?.options;i&&(Object.assign(i,e),t.data=T(T({},t.data),e))}}static isTileWidget(t){return t.config?.component==="tile"}static createTileWidget(t){let e=new tr().setId(cn()).setComponent("tile");if(t){let i=T({change:t.change||"",changeType:t.changeType||"neutral",icon:t.icon||"fas fa-chart-bar",color:t.color||"#6b7280",description:t.description||"",title:t.title||"",subtitle:t.subtitle||"",backgroundColor:t.backgroundColor||""},t);e.setTileOptions(i)}else e.setTileOptions({value:"",change:"",changeType:"neutral",icon:"fas fa-chart-bar",color:"#6b7280",description:""});return e}static exportData(t){if(!r.isTileWidget(t))return[];let e=t.config?.options;return e?[[e.title||t.config?.header?.title||"Metric",e.value||"",e.change||"",e.changeType||"neutral",e.description||"",e.subtitle||""]]:[]}static getExportHeaders(t){return["Title","Value","Change","Change Type","Description","Subtitle"]}static getExportSheetName(t){return`Tile_${(t.config?.header?.title||"Tile").replace(/[^a-zA-Z0-9]/g,"_")}`}static createMetricTile(t,e,i,n="fas fa-chart-line",s="#10b981"){return r.create().setValue(t).setChange(e).setChangeType("positive").setDescription(i).setIcon(n).setColor(s)}static createWarningTile(t,e,i,n="fas fa-exclamation-triangle",s="#ef4444"){return r.create().setValue(t).setChange(e).setChangeType("negative").setDescription(i).setIcon(n).setColor(s)}static createNeutralTile(t,e,i="fas fa-chart-bar",n="#6b7280"){return r.create().setValue(t).setChange("0%").setChangeType("neutral").setDescription(e).setIcon(i).setColor(n)}static createFinancialTile(t,e,i,n="$",s="fas fa-dollar-sign"){let a=`${n}${t.toLocaleString()}`,o=e>0?"positive":e<0?"negative":"neutral",c=`${e>0?"+":""}${e.toFixed(1)}%`,l=e>0?"#10b981":e<0?"#ef4444":"#6b7280";return r.create().setValue(a).setChange(c).setChangeType(o).setDescription(i).setIcon(s).setColor(l)}static createPercentageTile(t,e,i="fas fa-percentage",n="#3b82f6"){let s=t>0?"positive":t<0?"negative":"neutral",a=`${t>0?"+":""}${t.toFixed(1)}%`,o=t>0?"#10b981":t<0?"#ef4444":n;return r.create().setValue(`${t.toFixed(1)}%`).setChange(a).setChangeType(s).setDescription(e).setIcon(i).setColor(o)}static createInfoTile(t,e,i,n="fas fa-info-circle",s="#3b82f6"){return r.create().setValue(e).setDescription(i).setIcon(n).setColor(s)}static createStatusTile(t,e,i=!0,n="fas fa-circle",s="#10b981"){let a=i?s:"#6b7280",o=i?n:"fas fa-circle";return r.create().setValue(e).setDescription(t).setIcon(o).setColor(a).setChangeType(i?"positive":"neutral")}};var pl=class r extends ve{constructor(){super(),this.categories=[],this.datasetSource=[],this.encode={},this.colors=[],this.barWidth="auto",this.barBorderRadius=0,this.currencyFormatter=null,this.percentageFormatter=null,this.customNumberFormatter=null,this.filterColumn=null}static create(){return new r}getDefaultOptions(){return{title:{text:"Stock List",subtext:"Stock Ticks Data"},tooltip:{trigger:"item",formatter:t=>{let e=t.data;return e&&typeof e=="object"?`
              <strong>${e.symbol}</strong><br/>
              Company: ${e.companyName||"N/A"}<br/>
              Price: \u20B9${e.lastPrice?.toFixed(2)||"0.00"}<br/>
              Change: \u20B9${e.priceChange?.toFixed(2)||"0.00"} (${e.percentChange?.toFixed(2)||"0.00"}%)<br/>
              Volume: ${e.volume?.toLocaleString()||"N/A"}<br/>
              High: \u20B9${e.dayHigh?.toFixed(2)||"N/A"}<br/>
              Low: \u20B9${e.dayLow?.toFixed(2)||"N/A"}
            `:""}},legend:{data:["Stocks"]},grid:{left:"3%",right:"4%",bottom:"3%",top:"10%",containLabel:!0},xAxis:{type:"category",name:"Stock Symbol",nameLocation:"middle",nameGap:30},yAxis:{type:"value",name:"Price (\u20B9)",nameLocation:"middle",nameGap:50},series:[],color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"]}}getChartType(){return"stock-list"}getDefaultSeriesOptions(){return{type:"bar",name:"Stock Price",itemStyle:{borderRadius:this.barBorderRadius,color:t=>{let e=t.data;return e&&typeof e=="object"&&e.percentChange!==void 0?e.percentChange>=0?"#26a69a":"#ef5350":"#5470c6"}},label:{show:!1,position:"right",formatter:t=>{let e=t.data;return e&&typeof e=="object"?`\u20B9${e.lastPrice?.toFixed(2)||"0.00"}`:""}},emphasis:{focus:"series",itemStyle:{color:"#3f51b5"}}}}transformData(t){if(!this.data||!Array.isArray(this.data))return[];let e=[...this.data];return t?.sortBy&&e.sort((i,n)=>{let s=i[t.sortBy],a=n[t.sortBy];if(typeof s=="number"&&typeof a=="number")return t.sortOrder==="desc"?a-s:s-a;let o=String(s||""),c=String(a||"");return t.sortOrder==="desc"?c.localeCompare(o):o.localeCompare(c)}),t?.limit&&t.limit>0&&(e=e.slice(0,t.limit)),e.map(i=>B(T({},i),{name:i.symbol,value:i.lastPrice}))}autoExtractCategories(t){!t||t.length===0||(this.categories=t.map(e=>e.symbol).filter(Boolean))}setCategories(t){return this.categories=t,this}setDatasetSource(t){return this.datasetSource=t,this}setEncode(t){return this.encode=t,this}setVisualMap(t){return this.chartOptions.visualMap=t,this}setColors(t){return this.colors=t,this.chartOptions.color=t,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return this.setColors(e)}setBarWidth(t){return this.barWidth=t,this}setBarBorderRadius(t){return this.barBorderRadius=t,this}setXAxisName(t){return this.chartOptions.xAxis||(this.chartOptions.xAxis={}),this.chartOptions.xAxis.name=t,this}setYAxisName(t){return this.chartOptions.yAxis||(this.chartOptions.yAxis={}),this.chartOptions.yAxis.name=t,this}setCurrencyFormatter(t="INR",e="en-IN"){return this.currencyFormatter={currency:t,locale:e},this}setPercentageFormatter(t=2){return this.percentageFormatter={decimals:t},this}setCustomNumberFormatter(t=2,e="en-IN"){return this.customNumberFormatter={decimals:t,locale:e},this}setFilterColumn(t,e=br.Value){return this.filterColumn=t,super.setFilterColumn(t,e)}createFilterFromChartData(){return!this.data||this.data.length===0?[]:[{column:"symbol",operator:"in",value:[...new Set(this.data.map(e=>e.symbol))]}]}generateSampleData(t=10){let e=["RELIANCE","TCS","INFY","HDFC","ICICI","SBI","WIPRO","ONGC","ITC","BHARTI"];return Array.from({length:t},(i,n)=>({symbol:e[n%e.length]+(n>=e.length?Math.floor(n/e.length)+1:""),companyName:`Company ${n+1}`,lastPrice:Math.random()*3e3+100,priceChange:(Math.random()-.5)*100,percentChange:(Math.random()-.5)*10,volume:Math.floor(Math.random()*1e6),dayHigh:Math.random()*3100+100,dayLow:Math.random()*2900+100,openPrice:Math.random()*3e3+100,previousClose:Math.random()*3e3+100,industry:"Technology",sector:"IT"}))}setStockPerformanceConfiguration(){return this.setXAxisName("Stock Symbol"),this.setYAxisName("Price (INR)"),this.setCurrencyFormatter("INR","en-IN"),this}setStockComparisonConfiguration(){return this.setXAxisName("Stocks"),this.setYAxisName("Performance (%)"),this.setPercentageFormatter(2),this}setVolumeAnalysisConfiguration(){return this.setXAxisName("Stock Symbol"),this.setYAxisName("Volume"),this.setCustomNumberFormatter(0,"en-IN"),this}setDatasetEncodeConfiguration(){this.setDatasetSource(this.data||[]),this.setEncode({x:"symbol",y:"lastPrice",tooltip:["symbol","lastPrice","percentChange"],itemName:"symbol",value:"lastPrice"});let t=this.getDefaultSeriesOptions();return t.encode=this.encode,t.tooltip={formatter:e=>{let i=e.data;return`${i.symbol}: \u20B9${i.lastPrice?.toFixed(2)} (${i.percentChange?.toFixed(2)}%)`}},this.chartOptions.series=[t],this.chartOptions.dataset={source:this.datasetSource},this}setData(t){return this.data=t,this.widgetBuilder.setData(t),this}transformToStockListData(t){return!t||t.length===0?[]:t.map(e=>({symbol:e.symbol||"",companyName:e.companyName||"",lastPrice:e.lastPrice||0,priceChange:e.priceChange||0,percentChange:e.percentChange||0,volume:e.totalTradedVolume||e.volume||0,dayHigh:e.dayHigh||0,dayLow:e.dayLow||0,openPrice:e.openPrice||0,previousClose:e.previousClose||0,industry:e.industry||e.basicIndustry||"",sector:e.sector||""}))}build(){let t=this.transformToStockListData(this.data||[]);return this.widgetBuilder.setComponent("stock-list-table").setData({stocks:t,isLoadingStocks:!1}).build()}updateData(t,e){return new Promise((i,n)=>{let s=(a=0)=>{try{let o=e.map(l=>B(T({},l),{name:l.symbol,value:l.lastPrice})),c=e.map(l=>l.symbol);t.chart&&t.chart.setOption?(t.chart.setOption({xAxis:{data:c},series:[{data:o}]}),i()):a<3?setTimeout(()=>s(a+1),100):n(new Error("Chart instance not available after retries"))}catch(o){a<3?setTimeout(()=>s(a+1),100):n(o)}};s()})}static isStockListChart(t){return t.type==="stock-list"||t.chartType==="stock-list"}exportData(t){return!this.data||this.data.length===0?[]:this.data.map(e=>({Symbol:e.symbol,"Company Name":e.companyName||"","Last Price":e.lastPrice,"Price Change":e.priceChange,"Percent Change":e.percentChange,Volume:e.volume||0,"Day High":e.dayHigh||0,"Day Low":e.dayLow||0,"Open Price":e.openPrice||0,"Previous Close":e.previousClose||0,Industry:e.industry||"",Sector:e.sector||""}))}getExportHeaders(t){return["Symbol","Company Name","Last Price","Price Change","Percent Change","Volume","Day High","Day Low","Open Price","Previous Close","Industry","Sector"]}getExportSheetName(t){return t.title||"Stock List Data"}};var ml=class r{constructor(){this.tileBuilder=Na.create(),this.stockTileOptions=this.getDefaultStockTileOptions()}static create(){return new r}static createFromData(t){let e=new r;return t.value&&e.setValue(t.value),t.change&&e.setChange(t.change),t.changeType&&e.setChangeType(t.changeType),t.description&&e.setDescription(t.description),t.icon&&e.setIcon(t.icon),t.color&&e.setColor(t.color),t.backgroundColor&&e.setBackgroundColor(t.backgroundColor),t.subtitle&&e.setSubtitle(t.subtitle),t.highValue&&e.setHighValue(t.highValue),t.lowValue&&e.setLowValue(t.lowValue),t.currency&&e.setCurrency(t.currency),t.showCurrency!==void 0&&e.setShowCurrency(t.showCurrency),e}getDefaultStockTileOptions(){return{value:"0",change:"0%",changeType:"neutral",description:"Stock Price",icon:"fas fa-chart-line",color:"#10b981",backgroundColor:"#f0fdf4",highValue:"0",lowValue:"0",currency:"\u20B9",showCurrency:!0,updateOnDataChange:!0}}setValue(t){return this.stockTileOptions.value=t.toString(),this.tileBuilder.setValue(t),this}setChange(t){return this.stockTileOptions.change=t,this.tileBuilder.setChange(t),this}setChangeType(t){return this.stockTileOptions.changeType=t,this.tileBuilder.setChangeType(t),this}setDescription(t){return this.stockTileOptions.description=t,this.tileBuilder.setDescription(t),this}setSubtitle(t){return this.stockTileOptions.subtitle=t,this.tileBuilder.setSubHeader(t),this}setIcon(t){return this.stockTileOptions.icon=t,this.tileBuilder.setIcon(t),this}setColor(t){return this.stockTileOptions.color=t,this.tileBuilder.setColor(t),this}setBackgroundColor(t){return this.stockTileOptions.backgroundColor=t,this.tileBuilder.setBackgroundColor(t),this}setHighValue(t){return this.stockTileOptions.highValue=t.toString(),this}setLowValue(t){return this.stockTileOptions.lowValue=t.toString(),this}setCurrency(t){return this.stockTileOptions.currency=t,this}setShowCurrency(t){return this.stockTileOptions.showCurrency=t,this}setFormatHighLow(t){return this.stockTileOptions.formatHighLow=t,this}setUpdateOnDataChange(t){return this.stockTileOptions.updateOnDataChange=t,this.tileBuilder.setUpdateOnDataChange(t),this}setDataEvent(t){return this.tileBuilder.setEvents(t),this}setPosition(t){return this.tileBuilder.setPosition(t),this}setBorder(t,e=1,i=8){return this.tileBuilder.setBorder(t,e,i),this}setData(t){return this.tileBuilder.setData(t),this}build(){let t=this.tileBuilder.build();return t.config.component="stock-tile",t.config.options=this.stockTileOptions,t}static createStockTile(t,e,i,n,s,a="\u20B9"){let o=e>=0?"positive":"negative",c=e>=0?"fas fa-arrow-up":"fas fa-arrow-down",l=e>=0?"#16a34a":"#dc2626",h=e>=0?"#bbf7d0":"#fecaca",u=e>=0?"#4ade80":"#f87171",f=t*e/100,p=`${e>=0?"+":""}${a}${Math.abs(f).toFixed(2)} (${e>=0?"+":""}${e.toFixed(2)}%)`;return r.create().setValue(`${a}${t.toLocaleString()}`).setChange(p).setChangeType(o).setDescription(i).setIcon(c).setColor(l).setBackgroundColor(h).setBorder(u,1,8).setHighValue(`${a}${n.toLocaleString()}`).setLowValue(`${a}${s.toLocaleString()}`).setCurrency(a).setShowCurrency(!0).setUpdateOnDataChange(!0)}static updateData(t,e){if(t.config?.component!=="stock-tile"){console.warn("Attempting to update non-stock-tile widget");return}let i=t.config.options;e.value!==void 0&&(i.value=e.value),e.change!==void 0&&(i.change=e.change),e.changeType!==void 0&&(i.changeType=e.changeType),e.description!==void 0&&(i.description=e.description),e.icon!==void 0&&(i.icon=e.icon),e.color!==void 0&&(i.color=e.color),e.backgroundColor!==void 0&&(i.backgroundColor=e.backgroundColor),e.subtitle!==void 0&&(i.subtitle=e.subtitle),e.highValue!==void 0&&(i.highValue=e.highValue),e.lowValue!==void 0&&(i.lowValue=e.lowValue),e.currency!==void 0&&(i.currency=e.currency),e.showCurrency!==void 0&&(i.showCurrency=e.showCurrency)}static isStockTileWidget(t){return t.config?.component==="stock-tile"}static setDataEvent(t,e){if(t.config?.component!=="stock-tile"){console.warn("Attempting to set data event on non-stock-tile widget");return}t.config.events||(t.config.events={}),t.config.events.onChartOptions=e}};var Hn=class r extends ve{constructor(){super(),this.xAxisData=[],this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}}}}getChartType(){return"line"}getDefaultSeriesOptions(){return{name:"Area Chart",type:"line",smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.3,origin:"auto"},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis.data=t,this}setXAxisName(t){return this.chartOptions.xAxis.name=t,this}setYAxisName(t){return this.chartOptions.yAxis.name=t,this}setSmooth(t){return this.seriesOptions.smooth=t,this}setSymbol(t,e=6){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setLineStyle(t,e,i="solid"){return this.seriesOptions.lineStyle={width:t,color:e,type:i},this}setItemStyle(t,e,i){return this.seriesOptions.itemStyle={color:t,borderColor:e,borderWidth:i},this}setAreaStyle(t,e=.3){return this.seriesOptions.areaStyle={color:t,opacity:e,origin:"auto"},this}setGradientAreaStyle(t,e,i=.3){return this.seriesOptions.areaStyle={color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:t},{offset:1,color:e}]},opacity:i,origin:"auto"},this}setShowSymbol(t){return this.seriesOptions.showSymbol=t,this}setStack(t){return this.seriesOptions.stack=t,this}setSampling(t){return this.seriesOptions.sampling=t,this}build(){return this.chartOptions.series=[this.seriesOptions],this.widgetBuilder.setEChartsOptions(this.chartOptions),this.widgetBuilder.build()}static updateData(t,e,i){if(r.isAreaChart(t)){let n=t.config?.options;n?.series&&n.series.length>0&&(n.series[0].data=e)}ve.updateData(t,e,i)}static transformToAreaData(t,e){if(!t||t.length===0)return{data:[]};let i=e?.valueField||"value",n=e?.nameField||"name",s=e?.xAxisField||n;if(e?.multiSeries){let o=e.seriesNameField||"series",c=new Map;t.forEach(h=>{let u=h[o]||"Series 1";c.has(u)||c.set(u,[]),c.get(u).push({name:String(h[n])||"Unknown",value:Number(h[i])||0})});let l=Array.from(c.values())[0]||[];return{data:l,xAxisData:l.map(h=>h.name)}}return{data:t.map(o=>({name:String(o[n])||"Unknown",value:Number(o[i])||0})),xAxisData:t.map(o=>String(o[s])||"Unknown")}}setFinancialTrend(t="USD",e="en-US"){return this.setCurrencyFormatter(t,e),this.setSmooth(!0).setSymbol("circle",6).setLineStyle(3,"#5470c6","solid").setGradientAreaStyle("#5470c6","#91cc75",.4)}setPerformanceMonitoring(){return this.setSmooth(!0).setSampling("average").setShowSymbol(!1).setLineStyle(1,"#ff6b6b","solid").setGradientAreaStyle("#ff6b6b","#4ecdc4",.3)}static addRandomVariation(t,e=25){return t.map(i=>B(T({},i),{value:Math.max(0,i.value+(Math.random()-.5)*2*(i.value*e/100))}))}static isAreaChart(t){let e=t.config?.options;return e?.series?.[0]?.type==="line"&&e?.series?.[0]?.areaStyle}static createAreaChartWidget(t,e){return new tr().setComponent("echart").setEChartsOptions({grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:e||[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}},series:[{name:"Area Chart",type:"line",data:t||[],smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.3,origin:"auto"},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}static exportData(t){if(!r.isAreaChart(t))return[];let e=t.config?.options,i=e?.series,n=e?.xAxis;if(!i||i.length===0)return[];let s=[];n&&(Array.isArray(n)?s=n[0]?.data||[]:n.data&&(s=n.data)),s.length===0&&i[0]?.data&&(s=i[0].data.map((o,c)=>`Point ${c+1}`));let a=[];return i.forEach((o,c)=>{o.data&&o.data.forEach((l,h)=>{c===0&&(a[h]=[s[h]||`Point ${h+1}`]),a[h]&&a[h].push(l||0)})}),a}static getExportHeaders(t){let i=t.config?.options?.series;return!i||i.length===0?["Category"]:["Category",...i.map(n=>n.name||"Series")]}static getExportSheetName(t){return`AreaChart_${(t.config?.header?.title||"Area Chart").replace(/[^a-zA-Z0-9]/g,"_")}`}};export{gn as a,ia as b,tr as c,ve as d,br as e,hn as f,un as g,_c as h,fn as i,dn as j,pn as k,mn as l,Hn as m,Pn as n,Rn as o,Nn as p,Bn as q,pu as r,La as s,di as t,ul as u,vk as v,w2 as w,wu as x,Na as y,pl as z,ml as A};
