import{T as h,c as l,g as i}from"./chunk-I5ELLGFI.js";var n=function(a){return a.INDEX_SELECTION="index_selection",a.STOCK_SELECTION="stock_selection",a.PORTFOLIO_SELECTION="portfolio_selection",a.WATCHLIST_SELECTION="watchlist_selection",a.CUSTOM="custom",a}(n||{}),d=(()=>{let s=class s{constructor(){this.communicationChannels=new Map,this.transformers=new Map,this.dashboardRoutes=new Map,this.initializeChannel(n.INDEX_SELECTION),this.initializeChannel(n.STOCK_SELECTION),this.initializeChannel(n.PORTFOLIO_SELECTION),this.initializeChannel(n.WATCHLIST_SELECTION),this.registerTransformer(n.INDEX_SELECTION,this.defaultIndexTransformer.bind(this)),this.registerDashboardRoute(n.INDEX_SELECTION,"/dashboard/overall","OverallComponent")}initializeChannel(e){this.communicationChannels.has(e)||this.communicationChannels.set(e,new i(null))}sendData(e,t,r,c,u){this.initializeChannel(e);let I={id:this.generateId(),type:u||e,source:t,destination:r,payload:c,timestamp:new Date},o=this.communicationChannels.get(e);o&&o.next(I)}receiveData(e){this.initializeChannel(e);let t=this.communicationChannels.get(e);return t?t.asObservable():new i(null).asObservable()}clearData(e){let t=this.communicationChannels.get(e);t&&t.next(null)}registerTransformer(e,t){this.transformers.set(e,t)}transformData(e,t){let r=this.transformers.get(e);return r?r(t):null}registerDashboardRoute(e,t,r){this.dashboardRoutes.set(e,{path:t,component:r})}getDashboardRoute(e){return this.dashboardRoutes.get(e)||null}generateId(){return`comm_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}defaultIndexTransformer(e){let r=new Date().toLocaleString("default",{month:"long"});return{id:e.id||e.symbol,assetCategory:e.keyCategory||"Index",month:r,market:"Stock Market",totalValue:e.lastPrice||0,riskValue:Math.abs(e.variation||0),returnValue:e.percentChange||0,description:`${e.symbol} - ${e.name||"Market Index"}`}}setSelectedIndex(e){this.sendData(n.INDEX_SELECTION,"IndicesComponent","OverallComponent",e,"index")}getSelectedIndex(){return new l(e=>{this.receiveData(n.INDEX_SELECTION).subscribe(t=>{e.next(t?t.payload:null)})})}clearSelectedIndex(){this.clearData(n.INDEX_SELECTION)}transformToDashboardData(e){return this.transformData(n.INDEX_SELECTION,e)}};s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=h({token:s,factory:s.\u0275fac,providedIn:"root"});let a=s;return a})();export{d as a};
