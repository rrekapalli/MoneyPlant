import{b as ee,c as I,f as B,j as W,l as te,m as ne,p as re,q as ie,r as oe,v as R}from"./chunk-RSWLFW5Q.js";import{Da as s,Fc as J,Hb as H,Hc as A,Ia as P,Ib as q,Ic as Q,Jc as X,Kb as G,Kc as Y,Lb as y,Lc as $,Nb as T,Oa as S,Qb as h,Rb as v,Sb as M,Ta as f,Tb as D,U as z,Ub as w,Uc as V,Va as O,Yb as Z,a as j,bb as E,ca as p,da as d,g as N,jb as c,kb as a,lb as u,mb as x,qb as K,rb as U,tb as C,vb as m,xb as l}from"./chunk-53IN4TFO.js";import{a as b}from"./chunk-GAL4ENT6.js";var Ee=[{name:"SMA 5",value:"sma5",type:"number",category:"Moving Averages",description:"Simple Moving Average 5 periods"},{name:"SMA 10",value:"sma10",type:"number",category:"Moving Averages",description:"Simple Moving Average 10 periods"},{name:"SMA 20",value:"sma20",type:"number",category:"Moving Averages",description:"Simple Moving Average 20 periods"},{name:"SMA 50",value:"sma50",type:"number",category:"Moving Averages",description:"Simple Moving Average 50 periods"},{name:"SMA 100",value:"sma100",type:"number",category:"Moving Averages",description:"Simple Moving Average 100 periods"},{name:"SMA 200",value:"sma200",type:"number",category:"Moving Averages",description:"Simple Moving Average 200 periods"},{name:"EMA 5",value:"ema5",type:"number",category:"Moving Averages",description:"Exponential Moving Average 5 periods"},{name:"EMA 10",value:"ema10",type:"number",category:"Moving Averages",description:"Exponential Moving Average 10 periods"},{name:"EMA 20",value:"ema20",type:"number",category:"Moving Averages",description:"Exponential Moving Average 20 periods"},{name:"EMA 50",value:"ema50",type:"number",category:"Moving Averages",description:"Exponential Moving Average 50 periods"},{name:"WMA 5",value:"wma5",type:"number",category:"Moving Averages",description:"Weighted Moving Average 5 periods"},{name:"WMA 10",value:"wma10",type:"number",category:"Moving Averages",description:"Weighted Moving Average 10 periods"},{name:"WMA 20",value:"wma20",type:"number",category:"Moving Averages",description:"Weighted Moving Average 20 periods"},{name:"HMA 20",value:"hma20",type:"number",category:"Moving Averages",description:"Hull Moving Average 20 periods"},{name:"TEMA 20",value:"tema20",type:"number",category:"Moving Averages",description:"Triple Exponential Moving Average 20 periods"},{name:"KAMA 20",value:"kama20",type:"number",category:"Moving Averages",description:"Kaufman Adaptive Moving Average 20 periods"},{name:"RSI 14",value:"rsi14",type:"number",category:"Oscillators",description:"Relative Strength Index 14 periods",min:0,max:100},{name:"MACD Line",value:"macdLine",type:"number",category:"Oscillators",description:"MACD Line"},{name:"MACD Signal",value:"macdSignal",type:"number",category:"Oscillators",description:"MACD Signal Line"},{name:"MACD Histogram",value:"macdHistogram",type:"number",category:"Oscillators",description:"MACD Histogram"},{name:"BB Upper 20",value:"bbUpper20",type:"number",category:"Volatility",description:"Bollinger Bands Upper 20 periods"},{name:"BB Middle 20",value:"bbMiddle20",type:"number",category:"Volatility",description:"Bollinger Bands Middle 20 periods"},{name:"BB Lower 20",value:"bbLower20",type:"number",category:"Volatility",description:"Bollinger Bands Lower 20 periods"},{name:"OBV",value:"obv",type:"number",category:"Volume",description:"On Balance Volume"},{name:"AD Line",value:"adLine",type:"number",category:"Volume",description:"Accumulation/Distribution Line"},{name:"CMF 21",value:"cmf21",type:"number",category:"Volume",description:"Chaikin Money Flow 21 periods",min:-1,max:1},{name:"VPT",value:"vpt",type:"number",category:"Volume",description:"Volume Price Trend"},{name:"Volume SMA 10",value:"volumeSma10",type:"number",category:"Volume",description:"Volume Simple Moving Average 10 periods"},{name:"Volume SMA 30",value:"volumeSma30",type:"number",category:"Volume",description:"Volume Simple Moving Average 30 periods"},{name:"Volume EMA 10",value:"volumeEma10",type:"number",category:"Volume",description:"Volume Exponential Moving Average 10 periods"},{name:"Volume EMA 30",value:"volumeEma30",type:"number",category:"Volume",description:"Volume Exponential Moving Average 30 periods"},{name:"ATR 14",value:"atr14",type:"number",category:"Volatility",description:"Average True Range 14 periods"},{name:"ATR 20",value:"atr20",type:"number",category:"Volatility",description:"Average True Range 20 periods"},{name:"Keltner Upper 14",value:"keltnerUpper14",type:"number",category:"Volatility",description:"Keltner Channel Upper 14 periods"},{name:"Keltner Middle 14",value:"keltnerMiddle14",type:"number",category:"Volatility",description:"Keltner Channel Middle 14 periods"},{name:"Keltner Lower 14",value:"keltnerLower14",type:"number",category:"Volatility",description:"Keltner Channel Lower 14 periods"},{name:"Keltner Upper 20",value:"keltnerUpper20",type:"number",category:"Volatility",description:"Keltner Channel Upper 20 periods"},{name:"Keltner Middle 20",value:"keltnerMiddle20",type:"number",category:"Volatility",description:"Keltner Channel Middle 20 periods"},{name:"Keltner Lower 20",value:"keltnerLower20",type:"number",category:"Volatility",description:"Keltner Channel Lower 20 periods"},{name:"Keltner Upper 50",value:"keltnerUpper50",type:"number",category:"Volatility",description:"Keltner Channel Upper 50 periods"},{name:"Keltner Middle 50",value:"keltnerMiddle50",type:"number",category:"Volatility",description:"Keltner Channel Middle 50 periods"},{name:"Keltner Lower 50",value:"keltnerLower50",type:"number",category:"Volatility",description:"Keltner Channel Lower 50 periods"},{name:"Typical Price",value:"typicalPrice",type:"number",category:"Price Action",description:"Typical Price (H+L+C)/3"},{name:"True Range",value:"tr",type:"number",category:"Price Action",description:"True Range"},{name:"DM Plus",value:"dmPlus",type:"number",category:"Price Action",description:"Directional Movement Plus"},{name:"DM Minus",value:"dmMinus",type:"number",category:"Price Action",description:"Directional Movement Minus"},{name:"Darvas Box Volume",value:"darvasBoxVolume",type:"number",category:"Composite",description:"Darvas Box Volume Indicator"},{name:"CANSLIM Technical",value:"canslimTechnical",type:"number",category:"Composite",description:"CANSLIM Technical Score"},{name:"Triple Screen System",value:"tripleScreenSystem",type:"number",category:"Composite",description:"Triple Screen Trading System"},{name:"VAM Ratio",value:"vamRatio",type:"number",category:"Composite",description:"Volume Adjusted Momentum Ratio"},{name:"Z-Score Fusion",value:"zscoreFusion",type:"number",category:"Composite",description:"Z-Score Fusion Indicator"},{name:"Weighted Multi Factor",value:"weightedMultiFactor",type:"number",category:"Composite",description:"Weighted Multi-Factor Score"},{name:"Candle RSI BB",value:"candleRsiBb",type:"number",category:"Composite",description:"Candlestick RSI Bollinger Bands"},{name:"Volume Weighted Trend Score",value:"volumeWeightedTrendScore",type:"number",category:"Composite",description:"Volume Weighted Trend Score"}];var k=(()=>{let o=class o{constructor(){this.defaultOperators={string:["=","!=","contains","not contains","starts with","ends with","is empty","is not empty"],number:["=","!=",">",">=","<","<=","between","not between","is empty","is not empty"],date:["=","!=",">",">=","<","<=","between","not between","is empty","is not empty"],time:["=","!=",">",">=","<","<=","between","not between","is empty","is not empty"],boolean:["=","!=","is empty","is not empty"],category:["=","!=","in","not in","is empty","is not empty"]},this.queryStateSubject=new N({condition:"and",rules:[]}),this.queryState$=this.queryStateSubject.asObservable()}getOperators(e){return this.defaultOperators[e]||[]}getFieldByName(e,n){return e.find(t=>t.value===n)}addRule(e){let n={field:"",operator:"",value:null},t=b({},e);return t.rules=[...e.rules,n],this.queryStateSubject.next(t),t}addRuleSet(e){let n={condition:"and",rules:[]},t=b({},e);return t.rules=[...e.rules,n],this.queryStateSubject.next(t),t}removeRule(e,n){let t=b({},e);return t.rules=e.rules.filter((_,g)=>g!==n),this.queryStateSubject.next(t),t}removeRuleSet(e,n){let t=b({},e);return t.rules=e.rules.filter((_,g)=>g!==n),this.queryStateSubject.next(t),t}updateRule(e,n,t){let _=b({},e),g=_.rules[n];return g&&(_.rules[n]=b(b({},g),t)),this.queryStateSubject.next(_),_}toggleCollapse(e,n){let t=b({},e),_=t.rules[n];return _&&(_.collapsed=!_.collapsed),this.queryStateSubject.next(t),t}getQueryString(e){return this.buildQueryString(e)}buildQueryString(e){return!e.rules||e.rules.length===0?"":e.rules.map(t=>this.isRuleSet(t)?`(${this.buildQueryString(t)})`:this.buildRuleString(t)).join(` ${e.condition.toUpperCase()} `)}buildRuleString(e){if(!e.field||!e.operator)return"";let n=this.formatValue(e.value);return`${e.field} ${e.operator} ${n}`}formatValue(e){return e==null?"NULL":typeof e=="string"?`'${e}'`:Array.isArray(e)?`[${e.map(n=>this.formatValue(n)).join(", ")}]`:String(e)}isRuleSet(e){return"rules"in e}setQueryState(e){this.queryStateSubject.next(e)}getCurrentState(){return this.queryStateSubject.value}};o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=z({token:o,factory:o.\u0275fac,providedIn:"root"});let i=o;return i})();function ce(i,o){if(i&1&&(a(0,"option",20),y(1),u()),i&2){let r=o.$implicit;c("value",r.value),s(),T(" ",r.name," ")}}function pe(i,o){if(i&1&&(a(0,"option",20),y(1),u()),i&2){let r=o.$implicit;c("value",r),s(),T(" ",r," ")}}function de(i,o){if(i&1){let r=C();a(0,"input",21),M("ngModelChange",function(n){p(r);let t=l();return v(t.rule.value,n)||(t.rule.value=n),d(n)}),m("ngModelChange",function(n){p(r);let t=l();return d(t.onValueChange(n))}),u()}if(i&2){let r=l();h("ngModel",r.rule.value)}}function ge(i,o){if(i&1){let r=C();a(0,"input",22),M("ngModelChange",function(n){p(r);let t=l();return v(t.rule.value,n)||(t.rule.value=n),d(n)}),m("ngModelChange",function(n){p(r);let t=l();return d(t.onValueChange(n))}),u()}if(i&2){let r=l();h("ngModel",r.rule.value)}}function me(i,o){if(i&1){let r=C();a(0,"div",23)(1,"input",24),m("ngModelChange",function(n){p(r);let t=l();return d(t.onBetweenValueChange("min",n))}),u(),a(2,"span",25),y(3,"and"),u(),a(4,"input",26),m("ngModelChange",function(n){p(r);let t=l();return d(t.onBetweenValueChange("max",n))}),u()()}if(i&2){let r=l();s(),c("ngModel",r.getBetweenValue("min")),s(3),c("ngModel",r.getBetweenValue("max"))}}function _e(i,o){if(i&1){let r=C();a(0,"div",23)(1,"input",27),m("ngModelChange",function(n){p(r);let t=l();return d(t.onBetweenValueChange("min",n))}),u(),a(2,"span",25),y(3,"and"),u(),a(4,"input",27),m("ngModelChange",function(n){p(r);let t=l();return d(t.onBetweenValueChange("max",n))}),u()()}if(i&2){let r=l();s(),c("ngModel",r.getBetweenValue("min")),s(3),c("ngModel",r.getBetweenValue("max"))}}function ye(i,o){if(i&1){let r=C();a(0,"input",27),M("ngModelChange",function(n){p(r);let t=l();return v(t.rule.value,n)||(t.rule.value=n),d(n)}),m("ngModelChange",function(n){p(r);let t=l();return d(t.onValueChange(n))}),u()}if(i&2){let r=l();h("ngModel",r.rule.value)}}function Ce(i,o){if(i&1){let r=C();a(0,"input",28),M("ngModelChange",function(n){p(r);let t=l();return v(t.rule.value,n)||(t.rule.value=n),d(n)}),m("ngModelChange",function(n){p(r);let t=l();return d(t.onValueChange(n))}),u()}if(i&2){let r=l();h("ngModel",r.rule.value)}}function fe(i,o){if(i&1){let r=C();a(0,"div",29)(1,"input",30),M("ngModelChange",function(n){p(r);let t=l();return v(t.rule.value,n)||(t.rule.value=n),d(n)}),m("ngModelChange",function(n){p(r);let t=l();return d(t.onValueChange(n))}),u(),a(2,"label",31),y(3),u()()}if(i&2){let r=l();s(),c("id",D("boolean-",r.rule.field)),h("ngModel",r.rule.value),s(),c("for",D("boolean-",r.rule.field)),s(),T(" ",r.rule.value?"True":"False"," ")}}function he(i,o){if(i&1&&(a(0,"option",20),y(1),u()),i&2){let r=o.$implicit;c("value",r.value),s(),T(" ",r.name," ")}}function ve(i,o){if(i&1){let r=C();a(0,"select",4),M("ngModelChange",function(n){p(r);let t=l();return v(t.rule.value,n)||(t.rule.value=n),d(n)}),m("ngModelChange",function(n){p(r);let t=l();return d(t.onValueChange(n))}),a(1,"option",5),y(2,"Select option"),u(),f(3,he,2,2,"option",6),u()}if(i&2){let r=l();h("ngModel",r.rule.value),s(3),c("ngForOf",r.getFieldOptions())}}function Me(i,o){if(i&1){let r=C();a(0,"input",21),M("ngModelChange",function(n){p(r);let t=l();return v(t.rule.value,n)||(t.rule.value=n),d(n)}),m("ngModelChange",function(n){p(r);let t=l();return d(t.onValueChange(n))}),u()}if(i&2){let r=l();h("ngModel",r.rule.value)}}var ue=(()=>{let o=class o{constructor(e){this.queryBuilderService=e,this.ruleChange=new O,this.removeRuleEvent=new O}ngOnInit(){!this.rule.value&&this.rule.field&&this.initializeDefaultValue()}getOperators(){if(!this.rule.field)return[];let e=this.config.fields.find(n=>n.value===this.rule.field);return e?.getOperators?e.getOperators():this.queryBuilderService.getOperators(e?.type||"string")}getFieldType(){return this.config.fields.find(n=>n.value===this.rule.field)?.type||"string"}getValueInputType(){if(!this.rule.field||!this.rule.operator)return"string";let e=this.getFieldType();if(this.rule.operator==="between"||this.rule.operator==="not between"){if(e==="number")return"between-number";if(e==="date")return"between-date"}return e}getFieldOptions(){let e=this.config.fields.find(n=>n.value===this.rule.field);return e?.getOptions?e.getOptions():e?.options||[]}onFieldChange(e){this.rule.field=e,this.rule.operator="",this.rule.value=null,this.initializeDefaultValue(),this.ruleChange.emit(this.rule)}onOperatorChange(e){this.rule.operator=e,e==="between"||e==="not between"?(!this.rule.value||typeof this.rule.value!="object")&&(this.rule.value={min:null,max:null}):this.rule.value&&typeof this.rule.value=="object"&&(this.rule.value=null),this.ruleChange.emit(this.rule)}onValueChange(e){this.rule.value=e,this.ruleChange.emit(this.rule)}getBetweenValue(e){return!this.rule.value||typeof this.rule.value!="object"?null:this.rule.value[e]}onBetweenValueChange(e,n){(!this.rule.value||typeof this.rule.value!="object")&&(this.rule.value={min:null,max:null}),this.rule.value[e]=n,this.ruleChange.emit(this.rule)}removeRule(){this.removeRuleEvent.emit(this.ruleIndex)}initializeDefaultValue(){let e=this.getFieldType();if(this.rule.operator==="between"||this.rule.operator==="not between"){this.rule.value={min:null,max:null};return}switch(e){case"boolean":this.rule.value=!1;break;case"number":this.rule.value=0;break;case"string":this.rule.value="";break;case"date":this.rule.value=new Date().toISOString().split("T")[0];break;case"time":this.rule.value="00:00";break;default:this.rule.value=""}}};o.\u0275fac=function(n){return new(n||o)(P(k))},o.\u0275cmp=S({type:o,selectors:[["app-query-rule"]],inputs:{rule:"rule",config:"config",ruleIndex:"ruleIndex"},outputs:{ruleChange:"ruleChange",removeRuleEvent:"removeRuleEvent"},decls:32,vars:13,consts:[[1,"query-rule"],[1,"query-rule-content"],[1,"form-group"],[1,"form-label"],[1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-group","value-input-group"],[1,"value-input-container"],[3,"ngSwitch"],["type","text","class","form-control","placeholder","Enter value",3,"ngModel","ngModelChange",4,"ngSwitchCase"],["type","number","class","form-control","placeholder","Enter number",3,"ngModel","ngModelChange",4,"ngSwitchCase"],["class","between-inputs",4,"ngSwitchCase"],["type","date","class","form-control",3,"ngModel","ngModelChange",4,"ngSwitchCase"],["type","time","class","form-control",3,"ngModel","ngModelChange",4,"ngSwitchCase"],["class","form-check",4,"ngSwitchCase"],["class","form-select",3,"ngModel","ngModelChange",4,"ngSwitchCase"],["type","text","class","form-control","placeholder","Enter value",3,"ngModel","ngModelChange",4,"ngSwitchDefault"],["type","button","title","Remove rule",1,"btn","btn-outline-danger","btn-sm","remove-rule-btn",3,"click"],[1,"pi","pi-trash"],[3,"value"],["type","text","placeholder","Enter value",1,"form-control",3,"ngModelChange","ngModel"],["type","number","placeholder","Enter number",1,"form-control",3,"ngModelChange","ngModel"],[1,"between-inputs"],["type","number","placeholder","Min value",1,"form-control",3,"ngModelChange","ngModel"],[1,"between-separator"],["type","number","placeholder","Max value",1,"form-control",3,"ngModelChange","ngModel"],["type","date",1,"form-control",3,"ngModelChange","ngModel"],["type","time",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"ngModelChange","ngModel","id"],[1,"form-check-label",3,"for"]],template:function(n,t){n&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),y(4,"Field"),u(),a(5,"select",4),M("ngModelChange",function(g){return v(t.rule.field,g)||(t.rule.field=g),g}),m("ngModelChange",function(g){return t.onFieldChange(g)}),a(6,"option",5),y(7,"Select a field"),u(),f(8,ce,2,2,"option",6),u()(),a(9,"div",2)(10,"label",3),y(11,"Operator"),u(),a(12,"select",4),M("ngModelChange",function(g){return v(t.rule.operator,g)||(t.rule.operator=g),g}),m("ngModelChange",function(g){return t.onOperatorChange(g)}),a(13,"option",5),y(14,"Select an operator"),u(),f(15,pe,2,2,"option",6),u()(),a(16,"div",7)(17,"label",3),y(18,"Value"),u(),a(19,"div",8),K(20,9),f(21,de,1,1,"input",10)(22,ge,1,1,"input",11)(23,me,5,2,"div",12)(24,_e,5,2,"div",12)(25,ye,1,1,"input",13)(26,Ce,1,1,"input",14)(27,fe,4,6,"div",15)(28,ve,4,2,"select",16)(29,Me,1,1,"input",17),U(),a(30,"button",18),m("click",function(){return t.removeRule()}),x(31,"i",19),u()()()()()),n&2&&(s(5),h("ngModel",t.rule.field),s(3),c("ngForOf",t.config.fields),s(4),h("ngModel",t.rule.operator),s(3),c("ngForOf",t.getOperators()),s(5),c("ngSwitch",t.getValueInputType()),s(),c("ngSwitchCase","string"),s(),c("ngSwitchCase","number"),s(),c("ngSwitchCase","between-number"),s(),c("ngSwitchCase","between-date"),s(),c("ngSwitchCase","date"),s(),c("ngSwitchCase","time"),s(),c("ngSwitchCase","boolean"),s(),c("ngSwitchCase","category"))},dependencies:[V,A,X,Y,$,R,ie,oe,I,te,ee,re,B,W],styles:[".query-rule[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:16px;padding:16px;border:1px solid #e0e0e0;border-radius:6px;background-color:#f8f9fa;margin:8px 0}.query-rule[_ngcontent-%COMP%]   .query-rule-content[_ngcontent-%COMP%]{flex:1;display:grid;grid-template-columns:1fr 1fr 2fr;gap:12px;align-items:end}.query-rule[_ngcontent-%COMP%]   .value-input-group[_ngcontent-%COMP%]   .value-input-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.query-rule[_ngcontent-%COMP%]   .value-input-group[_ngcontent-%COMP%]   .value-input-container[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%], .query-rule[_ngcontent-%COMP%]   .value-input-group[_ngcontent-%COMP%]   .value-input-container[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%], .query-rule[_ngcontent-%COMP%]   .value-input-group[_ngcontent-%COMP%]   .value-input-container[_ngcontent-%COMP%]   .between-inputs[_ngcontent-%COMP%]{flex:1}.query-rule[_ngcontent-%COMP%]   .value-input-group[_ngcontent-%COMP%]   .value-input-container[_ngcontent-%COMP%]   .remove-rule-btn[_ngcontent-%COMP%]{flex-shrink:0;width:32px;height:32px;padding:0;border-radius:4px;font-size:12px;display:flex;align-items:center;justify-content:center;border:1px solid #dc3545;background-color:transparent;color:#dc3545;transition:all .2s ease}.query-rule[_ngcontent-%COMP%]   .value-input-group[_ngcontent-%COMP%]   .value-input-container[_ngcontent-%COMP%]   .remove-rule-btn[_ngcontent-%COMP%]:hover{background-color:#dc3545;color:#fff;border-color:#dc3545}.query-rule[_ngcontent-%COMP%]   .value-input-group[_ngcontent-%COMP%]   .value-input-container[_ngcontent-%COMP%]   .remove-rule-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px;color:inherit;visibility:visible!important;opacity:1!important}.query-rule[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.query-rule[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#495057;margin:0;text-transform:uppercase;letter-spacing:.5px}.query-rule[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%], .query-rule[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #ced4da;border-radius:4px;font-size:14px;transition:border-color .2s ease,box-shadow .2s ease}.query-rule[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:focus, .query-rule[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 0 .2rem #007bff40}.query-rule[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:hover, .query-rule[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:hover{border-color:#adb5bd}.query-rule[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-check[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin:0}.query-rule[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-check[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{margin:0;width:16px;height:16px;cursor:pointer}.query-rule[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-check[_ngcontent-%COMP%]   .form-check-label[_ngcontent-%COMP%]{font-size:14px;color:#495057;cursor:pointer;margin:0}.query-rule[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .between-inputs[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;flex:1}.query-rule[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .between-inputs[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{flex:1}.query-rule[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .between-inputs[_ngcontent-%COMP%]   .between-separator[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#6c757d;white-space:nowrap;padding:0 4px}.query-rule[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:32px;height:32px;padding:0;border-radius:4px;font-size:12px;font-weight:500;text-decoration:none;border:1px solid transparent;cursor:pointer;transition:all .2s ease}.query-rule[_ngcontent-%COMP%]   .btn.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;border-color:#dc3545;color:#fff}.query-rule[_ngcontent-%COMP%]   .btn.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c82333;border-color:#bd2130}.query-rule[_ngcontent-%COMP%]   .btn.btn-danger[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px;color:#fff!important;visibility:visible!important}.query-rule[_ngcontent-%COMP%]   .btn.btn-sm[_ngcontent-%COMP%]{width:28px;height:28px;font-size:10px}@media (max-width: 768px){.query-rule[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.query-rule[_ngcontent-%COMP%]   .query-rule-content[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}.query-rule[_ngcontent-%COMP%]   .query-rule-actions[_ngcontent-%COMP%]{align-self:flex-end}}"],changeDetection:0});let i=o;return i})();var be=(i,o)=>({"query-rule-item":i,"query-ruleset-item":o});function xe(i,o){if(i&1){let r=C();a(0,"button",10),m("click",function(){p(r);let n=l();return d(n.toggleCollapse())}),x(1,"i",11),u()}if(i&2){let r=l();E("aria-expanded",!r.ruleset.collapsed),s(),q("fa-chevron-down",!r.ruleset.collapsed)("fa-chevron-right",r.ruleset.collapsed)}}function Oe(i,o){if(i&1){let r=C();a(0,"app-query-rule",15),m("ruleChange",function(n){p(r);let t=l().index,_=l();return d(_.onRuleChange(t,n))})("removeRuleEvent",function(){p(r);let n=l().index,t=l();return d(t.removeRule(n))}),u()}if(i&2){let r=l(),e=r.$implicit,n=r.index,t=l();c("rule",e)("config",t.config)("ruleIndex",n)}}function we(i,o){if(i&1){let r=C();a(0,"app-query-rule-set",16),m("queryChange",function(n){p(r);let t=l().index,_=l();return d(_.onRuleSetChange(t,n))})("removeRuleSetEvent",function(){p(r);let n=l().index,t=l();return d(t.removeRuleSet(n))}),u()}if(i&2){let r=l(),e=r.$implicit,n=r.index,t=l();c("ruleset",e)("config",t.config)("level",t.level+1)("rulesetIndex",n)}}function Pe(i,o){if(i&1&&(a(0,"div",12),f(1,Oe,1,3,"app-query-rule",13)(2,we,1,4,"app-query-rule-set",14),u()),i&2){let r=o.$implicit,e=l();c("ngClass",Z(3,be,!e.isRuleSet(r),e.isRuleSet(r))),s(),c("ngIf",!e.isRuleSet(r)),s(),c("ngIf",e.isRuleSet(r))}}function Se(i,o){if(i&1){let r=C();a(0,"div",17)(1,"button",18),m("click",function(){p(r);let n=l();return d(n.removeCurrentRuleSet())}),x(2,"i",19),y(3," Remove Group "),u()()}}var ae=(()=>{let o=class o{constructor(e){this.queryBuilderService=e,this.level=0,this.rulesetIndex=0,this.queryChange=new O,this.removeRuleSetEvent=new O}ngOnInit(){this.ruleset.rules.length===0&&this.addRule()}isRuleSet(e){return"rules"in e}onConditionChange(e){this.ruleset.condition=e,this.queryChange.emit(this.ruleset)}onRuleChange(e,n){this.ruleset.rules[e]=n,this.queryChange.emit(this.ruleset)}onRuleSetChange(e,n){this.ruleset.rules[e]=n,this.queryChange.emit(this.ruleset)}addRule(){let e={field:"",operator:"",value:null};this.ruleset.rules.push(e),this.queryChange.emit(this.ruleset)}addRuleSet(){let e={condition:"and",rules:[]};this.ruleset.rules.push(e),this.queryChange.emit(this.ruleset)}removeRule(e){this.ruleset.rules.splice(e,1),this.queryChange.emit(this.ruleset)}removeRuleSet(e){this.ruleset.rules.splice(e,1),this.ruleset.rules.length===0&&this.addRule(),this.queryChange.emit(this.ruleset)}removeCurrentRuleSet(){this.removeRuleSetEvent.emit(this.rulesetIndex)}toggleCollapse(){this.config?.allowCollapse&&(this.ruleset.collapsed=!this.ruleset.collapsed,this.queryChange.emit(this.ruleset))}};o.\u0275fac=function(n){return new(n||o)(P(k))},o.\u0275cmp=S({type:o,selectors:[["app-query-rule-set"]],inputs:{ruleset:"ruleset",config:"config",level:"level",rulesetIndex:"rulesetIndex"},outputs:{queryChange:"queryChange",removeRuleSetEvent:"removeRuleSetEvent"},decls:14,vars:27,consts:[[1,"query-rule-set"],[1,"query-rule-set-header"],[1,"form-check","form-check-inline"],["type","radio","value","and",1,"form-check-input",3,"ngModelChange","name","id","ngModel"],[1,"form-check-label",3,"for"],["type","radio","value","or",1,"form-check-input",3,"ngModelChange","name","id","ngModel"],["type","button","class","btn btn-link btn-sm","title","Toggle collapse",3,"click",4,"ngIf"],[1,"query-rule-set-content"],["class","query-item",3,"ngClass",4,"ngFor","ngForOf"],["class","query-rule-set-actions",4,"ngIf"],["type","button","title","Toggle collapse",1,"btn","btn-link","btn-sm",3,"click"],[1,"fas"],[1,"query-item",3,"ngClass"],[3,"rule","config","ruleIndex","ruleChange","removeRuleEvent",4,"ngIf"],[3,"ruleset","config","level","rulesetIndex","queryChange","removeRuleSetEvent",4,"ngIf"],[3,"ruleChange","removeRuleEvent","rule","config","ruleIndex"],[3,"queryChange","removeRuleSetEvent","ruleset","config","level","rulesetIndex"],[1,"query-rule-set-actions"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],[1,"fas","fa-trash"]],template:function(n,t){n&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"input",3),M("ngModelChange",function(g){return v(t.ruleset.condition,g)||(t.ruleset.condition=g),g}),m("ngModelChange",function(g){return t.onConditionChange(g)}),u(),a(4,"label",4),y(5," AND "),u()(),a(6,"div",2)(7,"input",5),M("ngModelChange",function(g){return v(t.ruleset.condition,g)||(t.ruleset.condition=g),g}),m("ngModelChange",function(g){return t.onConditionChange(g)}),u(),a(8,"label",4),y(9," OR "),u()(),f(10,xe,2,5,"button",6),u(),a(11,"div",7),f(12,Pe,3,6,"div",8),u(),f(13,Se,4,0,"div",9),u()),n&2&&(H("padding-left",t.level*20,"px"),s(3),c("name",w("condition-",t.level,"-",t.rulesetIndex))("id",w("and-",t.level,"-",t.rulesetIndex)),h("ngModel",t.ruleset.condition),s(),c("for",w("and-",t.level,"-",t.rulesetIndex)),s(3),c("name",w("condition-",t.level,"-",t.rulesetIndex))("id",w("or-",t.level,"-",t.rulesetIndex)),h("ngModel",t.ruleset.condition),s(),c("for",w("or-",t.level,"-",t.rulesetIndex)),s(2),c("ngIf",(t.config==null?null:t.config.allowCollapse)&&t.ruleset.rules.length>1),s(),q("collapsed",t.ruleset.collapsed),s(),c("ngForOf",t.ruleset.rules),s(),c("ngIf",!t.ruleset.collapsed&&t.level>0))},dependencies:[o,V,J,A,Q,R,I,ne,B,W,ue],styles:[".query-rule-set[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:8px;background-color:#fff;margin:8px 0;transition:all .3s ease}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:12px 16px;background-color:#f8f9fa;border-bottom:1px solid #dee2e6;border-radius:8px 8px 0 0}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-header[_ngcontent-%COMP%]   .form-check-inline[_ngcontent-%COMP%]{margin:0;display:flex;align-items:center;gap:6px}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-header[_ngcontent-%COMP%]   .form-check-inline[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{margin:0;width:16px;height:16px;cursor:pointer}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-header[_ngcontent-%COMP%]   .form-check-inline[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:checked{background-color:#007bff;border-color:#007bff}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-header[_ngcontent-%COMP%]   .form-check-inline[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem #007bff40}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-header[_ngcontent-%COMP%]   .form-check-inline[_ngcontent-%COMP%]   .form-check-label[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#495057;cursor:pointer;margin:0;text-transform:uppercase;letter-spacing:.5px}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-header[_ngcontent-%COMP%]   .btn-link[_ngcontent-%COMP%]{color:#6c757d;text-decoration:none;padding:4px 8px;border:none;background:none;border-radius:4px;transition:all .2s ease}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-header[_ngcontent-%COMP%]   .btn-link[_ngcontent-%COMP%]:hover{color:#495057;background-color:#e9ecef}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-header[_ngcontent-%COMP%]   .btn-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px;transition:transform .2s ease}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-content[_ngcontent-%COMP%]{padding:16px;transition:all .3s ease}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-content.collapsed[_ngcontent-%COMP%]{display:none}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-content[_ngcontent-%COMP%]   .query-item[_ngcontent-%COMP%]{margin:8px 0}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-content[_ngcontent-%COMP%]   .query-item.query-ruleset-item[_ngcontent-%COMP%]{margin-left:16px}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-actions[_ngcontent-%COMP%]{display:flex;gap:8px;padding:16px;border-top:1px solid #dee2e6;background-color:#f8f9fa;border-radius:0 0 8px 8px}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:8px 16px;border-radius:6px;font-size:14px;font-weight:500;text-decoration:none;border:1px solid transparent;cursor:pointer;transition:all .2s ease}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-actions[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;border-color:#007bff;color:#fff}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-actions[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:hover{background-color:#0056b3;border-color:#0056b3}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-actions[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;border-color:#6c757d;color:#fff}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-actions[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#545b62;border-color:#545b62}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-actions[_ngcontent-%COMP%]   .btn.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;border-color:#dc3545;color:#fff}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-actions[_ngcontent-%COMP%]   .btn.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c82333;border-color:#bd2130}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-actions[_ngcontent-%COMP%]   .btn.btn-sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set[_ngcontent-%COMP%]{border-left:3px solid #007bff;margin-left:16px}@media (max-width: 768px){.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-actions[_ngcontent-%COMP%]{flex-wrap:wrap;gap:6px}.query-rule-set[_ngcontent-%COMP%]   .query-rule-set-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex:1;min-width:120px;justify-content:center}}"],changeDetection:0});let i=o;return i})();function qe(i,o){if(i&1){let r=C();a(0,"button",9),m("click",function(){p(r);let n=l(2);return d(n.toggleCollapse())}),x(1,"i",10),y(2," Query Builder "),u()}if(i&2){let r=l(2);E("aria-expanded",!r.collapsed)("aria-label",r.collapsed?"Expand query builder":"Collapse query builder"),s(),q("fa-chevron-down",!r.collapsed)("fa-chevron-right",r.collapsed)}}function Ve(i,o){i&1&&(a(0,"span",11),y(1,"Query Builder"),u())}function Re(i,o){if(i&1){let r=C();a(0,"div",12)(1,"button",13),m("click",function(){p(r);let n=l(2);return d(n.addRule())}),x(2,"i",14),y(3," Add Rule "),u(),a(4,"button",15),m("click",function(){p(r);let n=l(2);return d(n.addRuleSet())}),x(5,"i",16),y(6," Add Group "),u()()}}function ke(i,o){if(i&1&&(a(0,"div",4)(1,"div",5),f(2,qe,3,6,"button",6)(3,Ve,2,0,"span",7),u(),f(4,Re,7,0,"div",8),u()),i&2){let r=l();s(2),c("ngIf",r.config.allowCollapse),s(),c("ngIf",!r.config.allowCollapse),s(),c("ngIf",!r.collapsed)}}function Te(i,o){if(i&1){let r=C();a(0,"div",17)(1,"app-query-rule-set",18),m("queryChange",function(n){p(r);let t=l();return d(t.onQueryChange(n))}),u()()}if(i&2){let r=l();s(),c("ruleset",r.query)("config",r.config)("level",0)}}var st=(()=>{let o=class o{constructor(e){this.queryBuilderService=e,this.query={condition:"and",rules:[]},this.hideHeader=!1,this.queryChange=new O,this.collapsed=!1,this.subscription=new j}ngOnInit(){this.config.allowCollapse&&(this.collapsed=!1),this.subscription.add(this.queryBuilderService.queryState$.subscribe(e=>{this.query=e,this.queryChange.emit(e)})),this.queryBuilderService.setQueryState(this.query)}ngOnDestroy(){this.subscription.unsubscribe()}toggleCollapse(){this.collapsed=!this.collapsed}addRule(){let e=this.queryBuilderService.addRule(this.query);this.query=e,this.queryChange.emit(e)}addRuleSet(){let e=this.queryBuilderService.addRuleSet(this.query);this.query=e,this.queryChange.emit(e)}onQueryChange(e){this.query=e,this.queryChange.emit(e)}};o.\u0275fac=function(n){return new(n||o)(P(k))},o.\u0275cmp=S({type:o,selectors:[["app-query-builder"]],inputs:{query:"query",config:"config",hideHeader:"hideHeader"},outputs:{queryChange:"queryChange"},decls:4,vars:6,consts:[[1,"query-builder"],["class","query-builder-header",4,"ngIf"],[1,"query-builder-content"],["class","query-rule-set",4,"ngIf"],[1,"query-builder-header"],[1,"query-builder-title"],["type","button","class","btn btn-link",3,"click",4,"ngIf"],["class","query-builder-title-text",4,"ngIf"],["class","query-builder-header-actions",4,"ngIf"],["type","button",1,"btn","btn-link",3,"click"],[1,"fas"],[1,"query-builder-title-text"],[1,"query-builder-header-actions"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-plus"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fas","fa-layer-group"],[1,"query-rule-set"],[3,"queryChange","ruleset","config","level"]],template:function(n,t){n&1&&(a(0,"div",0),f(1,ke,5,3,"div",1),a(2,"div",2),f(3,Te,2,3,"div",3),u()()),n&2&&(G((t.config.classNames==null?null:t.config.classNames.queryBuilder)||""),s(),c("ngIf",!t.hideHeader),s(),q("collapsed",t.collapsed&&!t.hideHeader),s(),c("ngIf",!t.collapsed||t.hideHeader))},dependencies:[V,Q,R,ae],styles:[".query-builder[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:6px;background-color:#fff;margin:8px 0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.query-builder[_ngcontent-%COMP%]   .query-builder-header[_ngcontent-%COMP%]{padding:8px 12px;border-bottom:1px solid #e0e0e0;background-color:#f8f9fa;display:flex;justify-content:space-between;align-items:center}.query-builder[_ngcontent-%COMP%]   .query-builder-header[_ngcontent-%COMP%]   .query-builder-title[_ngcontent-%COMP%]   .btn-link[_ngcontent-%COMP%]{color:#495057;text-decoration:none;font-weight:500;padding:0;border:none;background:none;cursor:pointer;display:flex;align-items:center;gap:8px;font-size:14px}.query-builder[_ngcontent-%COMP%]   .query-builder-header[_ngcontent-%COMP%]   .query-builder-title[_ngcontent-%COMP%]   .btn-link[_ngcontent-%COMP%]:hover{color:#007bff}.query-builder[_ngcontent-%COMP%]   .query-builder-header[_ngcontent-%COMP%]   .query-builder-title[_ngcontent-%COMP%]   .btn-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px;transition:transform .2s ease}.query-builder[_ngcontent-%COMP%]   .query-builder-header[_ngcontent-%COMP%]   .query-builder-title[_ngcontent-%COMP%]   .query-builder-title-text[_ngcontent-%COMP%]{color:#495057;font-weight:500;font-size:14px}.query-builder[_ngcontent-%COMP%]   .query-builder-header[_ngcontent-%COMP%]   .query-builder-header-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.query-builder[_ngcontent-%COMP%]   .query-builder-content[_ngcontent-%COMP%]{padding:12px;transition:all .3s ease}.query-builder[_ngcontent-%COMP%]   .query-builder-content.collapsed[_ngcontent-%COMP%]{display:none}"],changeDetection:0});let i=o;return i})();export{Ee as a,k as b,st as c};
