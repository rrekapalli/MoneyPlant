import{a as Ft,b as vt,c as F,d as N,f as O,j as M,q as xt,r as Tt,s as It,t as wt,u as Wt,v as Bt,w as p,x as At}from"./chunk-TBRJD4LS.js";import"./chunk-OZIICUCO.js";import{a as Q}from"./chunk-ZRWWL7IO.js";import{b as Y}from"./chunk-RGYFSMI6.js";import{b as K,c as Z}from"./chunk-OGF7L3WK.js";import"./chunk-CP2JDSGT.js";import"./chunk-PL4JV4RC.js";import{b as X}from"./chunk-QDWGY6SB.js";import"./chunk-NLSVLC3G.js";import"./chunk-MGIYICR7.js";import{Na as q}from"./chunk-RQNRJHRX.js";import{Ba as w,Ga as y,Hb as R,Ma as L,Nc as $,Pa as j,Sb as z,T as _,X as J,ba as k,ca as S,hb as W,ib as B,jb as A,oc as G,rb as H,tb as U}from"./chunk-I5ELLGFI.js";import{Ab as gt,Bb as bt,Da as tt,Gb as Ct,Jb as yt,Mb as Dt,Ob as Vt,Pb as kt,Rb as St,Wa as et,Xa as at,Ya as it,Za as rt,ab as st,cb as ot,eb as nt,ib as lt,kb as dt,nb as ct,qb as ut,tb as ht,ub as pt,yb as mt,zb as ft}from"./chunk-ZOFRZBD6.js";import{a as b,b as C}from"./chunk-JKOY2XUY.js";function E(){let d={values:[]};return new Ft().setId("filter-widget").setComponent("filter").setPosition({x:0,y:1,cols:12,rows:1}).setFilterOptions(d).build()}function v(d,u){let T=u||[];d.config?.options&&(d.config.options.values=T)}function x(d){d.config?.options&&(d.config.options.values=[])}function P(d){if(!d)return Nt();let u=d.length||0,T=d.filter(s=>(s.percentChange||0)<0).length,t=d.filter(s=>(s.percentChange||0)>0).length,a=d.filter(s=>(s.percentChange||0)===0).length,e=d.reduce((s,o)=>{let l=o.totalTradedValue||0;return isNaN(l)||!isFinite(l)?s:s+l},0)||0,r=d.reduce((s,o)=>{let l=o.totalTradedVolume||0;return isNaN(l)||!isFinite(l)?s:s+l},0)||0,i=isNaN(e)||!isFinite(e)?0:e,n=isNaN(r)||!isFinite(r)?0:r;return[p.createInfoTile("Stocks",u.toString(),"Total Stocks","fas fa-chart-line","#1e40af").setBackgroundColor("#bfdbfe").setBorder("#7dd3fc",1,8).setUpdateOnDataChange(!0).setPosition({x:0,y:0,cols:2,rows:2}).build(),p.createInfoTile("Declines",T.toString(),"Declining Stocks","fas fa-arrow-down","#dc2626").setBackgroundColor("#fecaca").setBorder("#f87171",1,8).setUpdateOnDataChange(!0).setPosition({x:2,y:0,cols:2,rows:2}).build(),p.createInfoTile("Advances",t.toString(),"Advancing Stocks","fas fa-arrow-up","#16a34a").setBackgroundColor("#bbf7d0").setBorder("#4ade80",1,8).setUpdateOnDataChange(!0).setPosition({x:4,y:0,cols:2,rows:2}).build(),p.createInfoTile("Unchanged",a.toString(),"Unchanged Stocks","fas fa-minus","#6b7280").setBackgroundColor("#e5e7eb").setBorder("#9ca3af",1,8).setUpdateOnDataChange(!0).setPosition({x:6,y:0,cols:2,rows:2}).build(),p.createFinancialTile(i,0,"Traded Value","\u20B9","fas fa-rupee-sign").setColor("#047857").setBackgroundColor("#a7f3d0").setBorder("#5eead4",1,8).setUpdateOnDataChange(!0).setPosition({x:8,y:0,cols:2,rows:2}).build(),p.createInfoTile("Traded Volume",n.toLocaleString(),"Total Volume","fas fa-chart-bar","#7c3aed").setBackgroundColor("#ddd6fe").setBorder("#a78bfa",1,8).setUpdateOnDataChange(!0).setPosition({x:10,y:0,cols:2,rows:2}).build()]}function Nt(){return[p.createInfoTile("Stocks","0","Total Stocks","fas fa-chart-line","#6b7280").setBackgroundColor("#f3f4f6").setBorder("#d1d5db",1,8).setUpdateOnDataChange(!0).setPosition({x:0,y:0,cols:2,rows:2}).build(),p.createInfoTile("Declines","0","Declining Stocks","fas fa-arrow-down","#6b7280").setBackgroundColor("#f3f4f6").setBorder("#d1d5db",1,8).setUpdateOnDataChange(!0).setPosition({x:2,y:0,cols:2,rows:2}).build(),p.createInfoTile("Advances","0","Advancing Stocks","fas fa-arrow-up","#6b7280").setBackgroundColor("#f3f4f6").setBorder("#d1d5db",1,8).setUpdateOnDataChange(!0).setPosition({x:4,y:0,cols:2,rows:2}).build(),p.createInfoTile("Unchanged","0","Unchanged Stocks","fas fa-minus","#6b7280").setBackgroundColor("#f3f4f6").setBorder("#d1d5db",1,8).setUpdateOnDataChange(!0).setPosition({x:6,y:0,cols:2,rows:2}).build(),p.createFinancialTile(0,0,"Traded Value","\u20B9","fas fa-rupee-sign").setColor("#6b7280").setBackgroundColor("#f3f4f6").setBorder("#d1d5db",1,8).setUpdateOnDataChange(!0).setPosition({x:8,y:0,cols:2,rows:2}).build(),p.createInfoTile("Traded Volume","0","Total Volume","fas fa-chart-bar","#6b7280").setBackgroundColor("#f3f4f6").setBorder("#d1d5db",1,8).setUpdateOnDataChange(!0).setPosition({x:10,y:0,cols:2,rows:2}).build()]}var Ut=(()=>{let u=class u{constructor(t){this.apiService=t,this.endpoint="/api/v1/stock-ticks"}getStockTicks(t){let a=t.replace(/\s+/g,"-");return this.apiService.get(`${this.endpoint}/${a}`)}getStockTicksByIndex(t){let a=t.replace(/\s+/g,"-");return this.apiService.get(`${this.endpoint}/by-index/${a}`)}getAvailableIndices(){return this.apiService.get(`${this.endpoint}/indices`)}getNifty50StockTicks(){return this.getStockTicks("NIFTY 50")}getNiftyBankStockTicks(){return this.getStockTicks("NIFTY BANK")}getNiftyITStockTicks(){return this.getStockTicks("NIFTY IT")}};u.\u0275fac=function(a){return new(a||u)(J(Y))},u.\u0275prov=_({token:u,factory:u.\u0275fac,providedIn:"root"});let d=u;return d})();var Et=()=>({height:"100%",width:"100%","overflow-x":"hidden",overflow:"auto"});tt([bt,ft,ht,kt,Vt,Ct,Dt,pt,yt,gt,mt,at,et,it,rt,nt,ct,st,ot,ut,lt,dt,St]);import("./chunk-HCSKVX6S.js").then(d=>{M.registerMap("world",d.default||d)}).catch(d=>{});var fe=(()=>{let u=class u extends Wt{constructor(t,a,e,r,i){super(t,a,e),this.componentCommunicationService=r,this.stockTicksService=i,this.dashboardData=[],this.initialDashboardData=[],this.filteredDashboardData=this.dashboardData||[],this.appliedFilters=[],this.dashboardTitle="Financial Dashboard",this.selectedIndexSubscription=null}ngOnInit(){super.ngOnInit?.()}onChildInit(){import("./chunk-HCSKVX6S.js").then(t=>{M.registerMap("world",t.default||t)}).catch(()=>{}),this.selectedIndexSubscription&&(this.selectedIndexSubscription.unsubscribe(),this.selectedIndexSubscription=null),this.appliedFilters=[],this.dashboardTitle="Financial Dashboard",this.componentCommunicationService.clearSelectedIndex(),this.selectedIndexSubscription=this.componentCommunicationService.getSelectedIndex().subscribe(t=>{t?this.updateDashboardWithSelectedIndex(t):this.loadDefaultNifty50Data()}),setTimeout(()=>{this.componentCommunicationService.getSelectedIndex()||this.loadDefaultNifty50Data()},100)}onChildDestroy(){this.selectedIndexSubscription&&(this.selectedIndexSubscription.unsubscribe(),this.selectedIndexSubscription=null),this.dashboardData=[],this.filteredDashboardData=null,this.appliedFilters=[]}loadDefaultNifty50Data(){this.dashboardTitle="NIFTY METAL - Financial Dashboard";let t={id:"NIFTYMETAL",symbol:"NIFTY METAL",name:"NIFTY-METAL",lastPrice:0,variation:0,percentChange:0,keyCategory:"Index"};this.updateDashboardWithSelectedIndex(t)}loadStockTicksData(t){t&&t.trim()&&this.stockTicksService.getStockTicksByIndex(t).subscribe({next:a=>{this.dashboardData=a||[],this.appliedFilters=[],this.filteredDashboardData=this.dashboardData,this.updateMetricTilesWithFilters([]),this.populateWidgetsWithInitialData(),this.updateAllChartsWithFilteredData(),this.cdr.detectChanges()},error:()=>{this.dashboardData=[],this.filteredDashboardData=[],this.appliedFilters=[],this.updateMetricTilesWithFilters([]),this.updateAllChartsWithFilteredData(),this.cdr.detectChanges()}})}clearAllWidgetsData(){if(!this.dashboardConfig?.widgets)return;this.dashboardConfig.widgets.filter(a=>a.config?.component==="echart").forEach(a=>{this.updateEchartWidget(a,[])})}updateDashboardWithSelectedIndex(t){this.dashboardTitle=t.name||t.symbol||"Financial Dashboard";let a=this.componentCommunicationService.transformToDashboardData(t);this.dashboardData=this.dashboardData.filter(r=>r.symbol!==a.symbol),this.dashboardData=[a,...this.dashboardData];let e=t.symbol;this.loadStockTicksData(e),this.populateWidgetsWithInitialData(),this.cdr.detectChanges()}createMetricTiles(t){return P(this.filteredDashboardData||this.dashboardData)}updateMetricTilesWithFilters(t){let a=this.dashboardConfig.widgets.filter(r=>r.config?.component==="tile"),e=this.createMetricTiles(this.filteredDashboardData||this.dashboardData);a.forEach((r,i)=>{if(i<e.length){let n=e[i];r.config?.options?.updateOnDataChange!==!1&&r.config?.options&&Object.assign(r.config.options,n.config?.options)}})}initializeDashboardConfig(){let t=O.create().setData(this.filteredDashboardData||[]).setHeader("Industry").setCurrencyFormatter("INR","en-US").setPredefinedPalette("business").setTooltip("item",n=>{let c=new Intl.NumberFormat("en-US",{style:"currency",currency:"INR"});return`${n.name}: ${c.format(n.value)}`}).setAccessor("industry").setFilterColumn("industry",F.Value).setEvents((n,c)=>{c&&(c.off("click"),c.on("click",s=>{s.event?.stop?.();let o=s.name||s.data&&s.data.name;return o&&typeof o=="string"&&isNaN(Number(o))&&this.filterChartsByIndustry(o),!1}))}).setId("industry-bar-chart").setSkipDefaultFiltering(!0).build(),a=N.create().setData(this.filteredDashboardData).setHeader("Sector Allocation").setShowLegend(!1).setDonutStyle("40%","70%").setFinancialDisplay("INR","en-US").setPredefinedPalette("finance").setAccessor("sector").setFilterColumn("sector",F.Value).setEvents((n,c)=>{c&&(c.off("click"),c.on("click",s=>{s.event?.stop?.();let o=s.name||s.data&&s.data.name;return o&&typeof o=="string"&&isNaN(Number(o))&&this.filterChartsBySector(o),!1}))}).setId("sector-pie-chart").setSkipDefaultFiltering(!0).build(),e=At.create().setData(this.filteredDashboardData).setStockPerformanceConfiguration().setHeader("Stock List").setCurrencyFormatter("\u20B9","en-IN").setPredefinedPalette("finance").setAccessor("symbol").setFilterColumn("symbol",F.Value).setId("stock-list-widget").build(),r=E(),i=this.createMetricTiles([]);r.position={x:0,y:1,cols:12,rows:1},t.position={x:0,y:2,cols:4,rows:8},a.position={x:4,y:2,cols:4,rows:8},e.position={x:8,y:2,cols:4,rows:12},this.dashboardConfig=Tt.createStandard().setDashboardId("overall-dashboard").enableFilterHighlighting(!0,{filteredOpacity:.25,highlightedOpacity:1,highlightColor:"#ff6b6b",filteredColor:"#e0e0e0"}).setWidgets([...i,r,t,a,e]).setEditMode(!1).build(),this.populateWidgetsWithInitialData()}populateWidgetsWithInitialData(){if(!this.dashboardConfig?.widgets)return;this.dashboardConfig.widgets.filter(e=>e.config?.component==="echart").forEach(e=>{let r=e.config?.header?.title,i=null;r&&(i=this.getFilteredDataForWidget(r)),i||(i=this.getSummarizedDataByWidget(r)),i&&this.updateEchartWidget(e,i)}),this.dashboardConfig.widgets.filter(e=>e.config?.component==="stock-list-table").forEach(e=>{let r=this.filteredDashboardData||this.dashboardData;r&&r.length>0?e.data?(e.data.stocks=r,e.data.isLoadingStocks=!1):e.data={stocks:r,isLoadingStocks:!1}:e.data?(e.data.stocks=[],e.data.isLoadingStocks=!1):e.data={stocks:[],isLoadingStocks:!1}}),this.updateMetricTilesWithFilters([]),setTimeout(()=>{this.cdr.detectChanges()},100)}getSummarizedDataByWidget(t){let a=this.dashboardConfig.widgets.find(r=>r.config?.header?.title===t);if(!a||!a.config?.options?.series?.[0])return null;switch(t){case"Sector Allocation":return this.groupByAndSum(this.filteredDashboardData||this.dashboardData,"sector","totalTradedValue");case"Industry":return this.groupByAndSum(this.filteredDashboardData||this.dashboardData,"industry","totalTradedValue");case"Portfolio Distribution":return this.groupByAndSum(this.filteredDashboardData||this.dashboardData,"industry","totalTradedValue");default:return null}}getFilteredDataForWidget(t,a){let e=a||this.filteredDashboardData||this.dashboardData;switch(t){case"Sector Allocation":if(!e)return[];let r=e.reduce((s,o)=>{let l=o.sector||"Unknown",h=o.totalTradedValue||0;return s[l]||(s[l]=0),s[l]+=h,s},{});return Object.entries(r).map(([s,o])=>({name:s,value:o})).sort((s,o)=>o.value-s.value);case"Industry":if(!e)return[];let i=e.reduce((s,o)=>{let l=o.industry||"Unknown",h=o.totalTradedValue||0;return s[l]||(s[l]=0),s[l]+=h,s},{}),n=["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"];return Object.entries(i).map(([s,o])=>({name:s,value:o})).sort((s,o)=>o.value-s.value).map((s,o)=>C(b({},s),{itemStyle:{color:n[o%n.length]}}));case"Portfolio Distribution":if(!e)return[];let c=e.reduce((s,o)=>{let l=o.macro||"Unknown Macro",h=o.industry||"Unknown Industry",g=o.sector||"Unknown Sector",m=o.totalTradedValue||0;return s[l]||(s[l]={}),s[l][h]||(s[l][h]={}),s[l][h][g]||(s[l][h][g]=0),s[l][h][g]+=m,s},{});return Object.entries(c).map(([s,o])=>{let l=Object.entries(o).map(([g,m])=>{let f=Object.entries(m).map(([D,V])=>({name:D,value:V})),I=f.reduce((D,V)=>D+V.value,0);return{name:g,value:I,children:f}}),h=l.reduce((g,m)=>g+m.value,0);return{name:s,value:h,children:l}}).sort((s,o)=>o.value-s.value);default:return null}}applyEnhancedFilters(t){if(!this.dashboardConfig?.widgets)return;let a=this.dashboardData;if(t&&t.length>0){let e=t.map(r=>({property:r.filterColumn||"industry",operator:"equals",value:r.value}));a=vt.applyFilters(a,e)}this.filteredDashboardData=a,this.updateAllChartsWithFilteredData(),setTimeout(()=>this.cdr.detectChanges(),100)}createStockTicksTreemapData(t){if(!t||t.length===0)return[];let a=new Map;return t.forEach(e=>{let r=e.macro||"Other";a.has(r)||a.set(r,[]),a.get(r).push(e)}),Array.from(a.entries()).map(([e,r])=>{let i=new Map;r.forEach(s=>{let o=s.industry||"Other";i.has(o)||i.set(o,[]),i.get(o).push(s)});let n=Array.from(i.entries()).map(([s,o])=>{let l=new Map;o.forEach(m=>{let f=m.sector||"Other";l.has(f)||l.set(f,[]),l.get(f).push(m)});let h=Array.from(l.entries()).map(([m,f])=>{let I=f.reduce((D,V)=>D+(V.lastPrice||0),0);return{name:m,value:I}}),g=h.reduce((m,f)=>m+f.value,0);return{name:s,value:g,children:h}}),c=n.reduce((s,o)=>s+o.value,0);return{name:e,value:c,children:n}})}applyFilters(){if(!this.dashboardData||this.dashboardData.length===0){this.filteredDashboardData=[],this.updateAllChartsWithFilteredData();return}if(this.appliedFilters.length===0){this.filteredDashboardData=[...this.dashboardData],this.updateAllChartsWithFilteredData();return}let t=[...this.dashboardData];for(let a of this.appliedFilters)t=this.applyIndividualFilter(t,a);this.filteredDashboardData=t,this.updateAllChartsWithFilteredData()}applyIndividualFilter(t,a){let e=a.operator||"equals";return t.filter(r=>{let i=r[a.field];switch(e){case"equals":return i===a.value;case"contains":return i&&i.toString().toLowerCase().includes(a.value.toString().toLowerCase());case"greaterThan":return i>a.value;case"lessThan":return i<a.value;default:return i===a.value}})}convertFilterCriteriaToIFilterValues(t){let a=typeof t.value=="number"?t.value.toString():t.value,r=`${this.getFieldDisplayName(t.field)}: '${t.value}'`,i=0;return typeof t.value=="string"&&(i=this.getAggregatedValueForCategory(t.field,t.value)),{accessor:t.field,filterColumn:t.field,category:a,value:a,numericValue:i.toString(),percentage:i.toString(),[t.field]:a,displayValue:r,source:t.source||"Unknown"}}getAggregatedValueForCategory(t,a){return!this.dashboardData||this.dashboardData.length===0?0:this.dashboardData.filter(e=>e[t]===a).reduce((e,r)=>e+(r.totalTradedValue||0),0)}getFieldDisplayName(t){switch(t){case"industry":return"Industry";case"sector":return"Sector";case"macro":return"Macro";case"symbol":return"Symbol";default:return t.charAt(0).toUpperCase()+t.slice(1)}}getFilterWidget(){return this.dashboardConfig?.widgets?.find(t=>t.id==="filter-widget"||t.config?.component==="filter")}updateFilterWidget(){let t=this.getFilterWidget();if(t){let a=this.appliedFilters.map(e=>this.convertFilterCriteriaToIFilterValues(e));v(t,a),this.cdr.detectChanges()}}addFilter(t){this.appliedFilters.some(e=>e.type===t.type&&e.field===t.field&&e.value===t.value)?this.appliedFilters=this.appliedFilters.filter(e=>!(e.type===t.type&&e.field===t.field&&e.value===t.value)):this.appliedFilters=this.appliedFilters.filter(e=>!(e.type===t.type&&e.field===t.field)),this.appliedFilters.push(t),this.applyFilters(),this.updateFilterWidget()}removeFilter(t,a){this.appliedFilters=this.appliedFilters.filter(e=>!(e.type===t&&e.field===a)),this.applyFilters(),this.updateFilterWidget()}clearAllFilters(){this.appliedFilters=[],this.filteredDashboardData=[...this.dashboardData||[]],this.applyFilters(),this.updateAllChartsWithFilteredData();let t=this.getFilterWidget();t&&x(t),this.cdr.detectChanges(),setTimeout(()=>{this.cdr.markForCheck(),this.cdr.detectChanges()},50),super.clearAllFilters()}onFilterValuesChanged(t){if(!t||t.length===0){this.appliedFilters=[],this.filteredDashboardData=[...this.dashboardData||[]],this.updateAllChartsWithFilteredData();let i=this.getFilterWidget();i&&x(i),this.cdr.detectChanges();return}let a=t.map(i=>i.category&&typeof i.category=="string"&&typeof i.value=="number"&&!isNaN(i.value)?C(b({},i),{value:i.category,category:i.category,numericValue:i.value}):i),e=this.getFilterWidget();e&&v(e,a);let r=[];a.forEach(i=>{let n=i.category||i.value;i.filterColumn==="sector"&&n&&typeof n=="string"&&isNaN(Number(n))?r.push({type:"sector",field:"sector",value:n,operator:"equals",source:"Filter Widget"}):i.filterColumn==="industry"&&n&&typeof n=="string"&&isNaN(Number(n))&&r.push({type:"industry",field:"industry",value:n,operator:"equals",source:"Filter Widget"})}),this.appliedFilters=r,this.applyFilters()}updateAllChartsWithFilteredData(){this.filteredDashboardData&&(this.updateBarChartWithFilteredData(),this.updatePieChartWithFilteredData(),this.updateStockListWithFilteredData(),this.updateMetricTilesWithFilters([]),this.cdr.detectChanges(),setTimeout(()=>{this.cdr.markForCheck(),this.cdr.detectChanges()},100))}filterChartsByIndustry(t){!this.dashboardData||this.dashboardData.length===0||typeof t!="string"||!isNaN(Number(t))||![...new Set(this.dashboardData.map(e=>e.industry))].includes(t)||this.addFilter({type:"industry",field:"industry",value:t,operator:"equals",source:"Industry Chart"})}filterChartsBySector(t){!this.dashboardData||this.dashboardData.length===0||typeof t!="string"||!isNaN(Number(t))||![...new Set(this.dashboardData.map(e=>e.sector))].includes(t)||this.addFilter({type:"sector",field:"sector",value:t,operator:"equals",source:"Sector Chart"})}filterChartsByMacro(t){!this.dashboardData||this.dashboardData.length===0||(console.log(`\u{1F3AF} filterChartsByMacro: Filtering by macro: ${t}`),this.addFilter({type:"macro",field:"macro",value:t,operator:"equals",source:"Treemap Chart"}))}updatePieChartWithFilteredData(){if(!this.dashboardConfig?.widgets||!this.filteredDashboardData)return;let t=this.dashboardConfig.widgets.find(a=>a.config?.header?.title==="Sector Allocation");if(t){let a=this.filteredDashboardData.reduce((r,i)=>{let n=i.sector||"Unknown";return r[n]||(r[n]=0),r[n]+=i.totalTradedValue||0,r},{}),e=Object.entries(a).map(([r,i])=>({name:r,value:i})).sort((r,i)=>i.value-r.value);try{if(N.updateData(t,e),t.chartInstance&&typeof t.chartInstance.setOption=="function"){let r=C(b({},t.config?.options),{series:[C(b({},t.config?.options?.series?.[0]||{}),{data:e})]});t.chartInstance.setOption(r,!0)}this.updateEchartWidget(t,e)}catch{}}}updateBarChartWithFilteredData(){if(!this.dashboardConfig?.widgets||!this.filteredDashboardData)return;let t=this.dashboardConfig.widgets.find(a=>a.config?.header?.title==="Industry");if(t){let a=this.filteredDashboardData.reduce((i,n)=>{let c=n.industry||"Unknown";return i[c]||(i[c]=0),i[c]+=n.totalTradedValue||0,i},{}),e=["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],r=Object.entries(a).map(([i,n])=>({name:i,value:n})).sort((i,n)=>n.value-i.value).map((i,n)=>C(b({},i),{itemStyle:{color:e[n%e.length]}}));try{if(O.updateData(t,r),t.chartInstance&&typeof t.chartInstance.setOption=="function"){let i=C(b({},t.config?.options),{series:[C(b({},t.config?.options?.series?.[0]||{}),{data:r})],yAxis:C(b({},t.config?.options?.yAxis||{}),{data:r.map(n=>n.name)})});t.chartInstance.setOption(i,!0)}this.updateEchartWidget(t,r)}catch{}}}updateTreemapWithFilteredData(){if(!this.dashboardConfig?.widgets||!this.filteredDashboardData)return;let t=this.dashboardConfig.widgets.find(a=>a.config?.header?.title==="Portfolio Distribution");if(t){let a=this.createStockTicksTreemapData(this.filteredDashboardData);this.updateEchartWidget(t,a)}}updateStockListWithFilteredData(){if(!this.dashboardConfig?.widgets)return;let t=this.dashboardConfig.widgets.filter(a=>a.config?.component==="stock-list-table");t.forEach(a=>{let r=[...this.filteredDashboardData||[]];a.data?(a.data.stocks=r,a.data.isLoadingStocks=!1):a.data={stocks:r,isLoadingStocks:!1}}),this.cdr.detectChanges(),t.forEach(a=>{a.data&&typeof a.data.refresh=="function"&&a.data.refresh()}),setTimeout(()=>{this.cdr.markForCheck(),this.cdr.detectChanges()},10)}};u.\u0275fac=function(a){return new(a||u)(y(G),y(xt),y(Bt),y(Q),y(Ut))},u.\u0275cmp=L({type:u,selectors:[["app-overall"]],features:[j],decls:6,vars:9,consts:[["dashboardContainer",""],["dashboardContainerComponent",""],[3,"onExportToExcel","onToggleHighlighting","onSetHighlightingPreset","title","isHighlightingEnabled","isExportingExcel"],[1,"dashboard-container"],[3,"filterValuesChanged","widgets","options","dashboardId"]],template:function(a,e){if(a&1){let r=H();B(0,"vis-dashboard-header",2),U("onExportToExcel",function(){return k(r),S(e.exportDashboardToExcel())})("onToggleHighlighting",function(){return k(r),S(e.toggleHighlightingMode())})("onSetHighlightingPreset",function(n){return k(r),S(e.setHighlightingPreset(n))}),A(),B(1,"p-scrollPanel")(2,"div",3,0)(4,"vis-dashboard-container",4,1),U("filterValuesChanged",function(n){return k(r),S(e.onFilterValuesChanged(n))}),A()()()}a&2&&(W("title",e.dashboardTitle)("isHighlightingEnabled",e.isHighlightingEnabled)("isExportingExcel",e.isExportingExcel),w(),R(z(8,Et)),w(3),W("widgets",e.dashboardConfig.widgets)("options",e.dashboardConfig.config)("dashboardId",e.dashboardConfig.dashboardId))},dependencies:[$,q,X,Z,K,It,wt],styles:[".dashboard-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:80vh;padding:.5rem}vis-dashboard-container[_ngcontent-%COMP%]{flex:1 1 auto;min-height:0}.filter-status[_ngcontent-%COMP%]{margin-bottom:1rem;padding:.75rem 1rem;background:linear-gradient(135deg,#e3f2fd,#bbdefb);border-radius:8px;border:1px solid #90caf9;box-shadow:0 2px 4px #2196f31a;transition:all .3s ease-in-out}.filter-status[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #2196f326;transform:translateY(-1px)}.filter-status-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start}.filter-status-text[_ngcontent-%COMP%]{font-weight:600;color:#1565c0;font-size:.9rem;text-transform:uppercase;letter-spacing:.5px;display:flex;align-items:center}.filter-count[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;min-width:24px;height:24px;padding:0 .5rem;background:linear-gradient(135deg,#1976d2,#1565c0);color:#fff;border-radius:12px;font-size:.75rem;font-weight:700;margin-left:.5rem;box-shadow:0 2px 4px #1976d24d}  .filter-status .p-message{background:transparent!important;border:none!important;padding:0!important;margin:0!important}  .filter-status .p-message .p-message-text{color:#1565c0!important;font-weight:600!important;font-size:.9rem!important;text-transform:uppercase!important;letter-spacing:.5px!important}  .filter-status .p-message .p-message-icon{color:#1976d2!important;font-size:1rem!important}[_nghost-%COMP%]{display:block;height:100%;width:100%}  .gridster-item{box-shadow:0 2px 8px #0000001a;border-radius:4px;background-color:#fff;overflow:visible!important;min-height:200px!important;min-width:200px!important;border:2px solid #007bff!important;padding:10px!important;margin:5px!important}  .widget-header{padding:.5rem 1rem;background-color:#f8f9fa;border-bottom:1px solid #e9ecef}  .widget-content{padding:.5rem;height:calc(100% - 40px);min-height:150px}  .echart-container{width:100%!important;height:100%!important;min-height:300px!important;min-width:300px!important;border:4px solid #dc3545!important;background-color:#dc35451a!important;display:flex!important;justify-content:center!important;align-items:center!important;position:relative!important;z-index:10!important;overflow:visible!important}  .echart-widget-container{width:100%!important;height:100%!important;min-height:300px!important;min-width:300px!important;display:flex!important;flex-direction:column!important;justify-content:center!important;align-items:center!important;border:4px solid #ffc107!important;background-color:#ffc1071a!important;padding:10px!important;box-sizing:border-box!important;overflow:visible!important;z-index:5!important;position:relative!important}  .gridster-item{min-height:300px!important;min-width:300px!important;height:auto!important;overflow:visible!important;z-index:1!important}"],changeDetection:0});let d=u;return d})();export{fe as OverallComponent};
