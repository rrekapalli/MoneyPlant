import{a as y}from"./chunk-NBMXCGLL.js";import{H as p,M as c,Q as h,U as u,Y as d,l as n}from"./chunk-53IN4TFO.js";var I=(()=>{let i=class i{constructor(e){this.apiService=e,this.endpoint="/api/v1/index",this.publicEndpoint="/api/public/indices",this.stockEndpoint="/api/v1/indices",this.previousDayRequests=new Map,this.previousDayCache=new Map,this.previousDayTTL=6e4}createIndex(e){return this.apiService.post(this.endpoint,e)}getAllIndices(){return this.apiService.get(this.publicEndpoint)}getIndexById(e){return this.apiService.get(`${this.endpoint}/${e}`)}getIndexBySymbol(e){return this.apiService.get(`${this.endpoint}/symbol/${e}`)}getIndexByName(e){return this.apiService.get(`${this.endpoint}/name/${e}`)}getIndexByKeyCategory(e){return this.apiService.get(`${this.endpoint}/category/${e}`)}getPreviousDayIndexData(e){let t=(e||"").trim().toLowerCase();if(!t)return n({});let r=this.previousDayCache.get(t),v=Date.now();if(r&&v-r.timestamp<this.previousDayTTL)return n(r.data);let a=this.previousDayRequests.get(t);if(a)return a;let g=e.replace(/\s+/g,"-").toLowerCase(),o=this.apiService.get(`${this.stockEndpoint}/${g}/previous-day`).pipe(h(l=>{this.previousDayCache.set(t,{timestamp:Date.now(),data:l})}),c(1),p(()=>{this.previousDayRequests.delete(t)}));return this.previousDayRequests.set(t,o),o}getIndexHistoricalData(e){return this.apiService.get(`${this.endpoint}/${e}/historical-data`)}};i.\u0275fac=function(t){return new(t||i)(d(y))},i.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();export{I as a};
