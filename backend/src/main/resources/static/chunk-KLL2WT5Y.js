import{a as f}from"./chunk-NBMXCGLL.js";import{d as o}from"./chunk-AR7LHXST.js";import{Q as s,U as p,Y as d,g,p as a}from"./chunk-53IN4TFO.js";import{a as S}from"./chunk-GAL4ENT6.js";var v=(()=>{let i=class i{constructor(e){this.apiService=e}createScreener(e){return this.apiService.post("/api/screeners",e)}getScreener(e){return this.apiService.get(`/api/screeners/${e}`)}updateScreener(e,r){return this.apiService.patch(`/api/screeners/${e}`,r)}deleteScreener(e){return this.apiService.delete(`/api/screeners/${e}`)}listScreeners(e={}){let r=new o;return e.q&&(r=r.set("q",e.q)),e.page!==void 0&&(r=r.set("page",e.page.toString())),e.size!==void 0&&(r=r.set("size",e.size.toString())),e.sort&&(r=r.set("sort",e.sort)),this.apiService.get("/api/screeners",r)}listMyScreeners(){return this.apiService.get("/api/screeners/my")}listPublicScreeners(){return this.apiService.get("/api/screeners/public")}createVersion(e,r){return this.apiService.post(`/api/screeners/${e}/versions`,r)}listVersions(e){return this.apiService.get(`/api/screeners/${e}/versions`)}getVersion(e){return this.apiService.get(`/api/versions/${e}`)}updateVersion(e,r){return this.apiService.patch(`/api/versions/${e}`,r)}createParamset(e,r){return this.apiService.post(`/api/versions/${e}/paramsets`,r)}listParamsets(e){return this.apiService.get(`/api/versions/${e}/paramsets`)}deleteParamset(e){return this.apiService.delete(`/api/paramsets/${e}`)}createSchedule(e,r){return this.apiService.post(`/api/screeners/${e}/schedules`,r)}listSchedules(e){return this.apiService.get(`/api/screeners/${e}/schedules`)}updateSchedule(e,r){return this.apiService.patch(`/api/schedules/${e}`,r)}deleteSchedule(e){return this.apiService.delete(`/api/schedules/${e}`)}createAlert(e,r){return this.apiService.post(`/api/screeners/${e}/alerts`,r)}listAlerts(e){return this.apiService.get(`/api/screeners/${e}/alerts`)}updateAlert(e,r){return this.apiService.patch(`/api/alerts/${e}`,r)}deleteAlert(e){return this.apiService.delete(`/api/alerts/${e}`)}createRun(e,r){return this.apiService.post(`/api/screeners/${e}/runs`,r)}listRuns(e,r={}){let t=new o;return r.page!==void 0&&(t=t.set("page",r.page.toString())),r.size!==void 0&&(t=t.set("size",r.size.toString())),this.apiService.get(`/api/screeners/${e}/runs`,t)}getRun(e){return this.apiService.get(`/api/runs/${e}`)}retryRun(e){return this.apiService.post(`/api/runs/${e}/retry`,{})}getLatestSuccessfulRun(e){return this.apiService.get(`/api/screeners/${e}/last-run`)}getRunsByStatus(e){return this.apiService.get(`/api/runs/status/${e}`)}getRunsByUser(e){return this.apiService.get(`/api/runs/user/${e}`)}getRunResults(e,r={}){let t=new o;return r.matched!==void 0&&(t=t.set("matched",r.matched.toString())),r.minScore!==void 0&&(t=t.set("minScore",r.minScore.toString())),r.symbolId!==void 0&&(t=t.set("symbolId",r.symbolId.toString())),r.page!==void 0&&(t=t.set("page",r.page.toString())),r.size!==void 0&&(t=t.set("size",r.size.toString())),r.sort&&(t=t.set("sort",r.sort)),this.apiService.get(`/api/runs/${e}/results`,t)}getRunDiffs(e){return this.apiService.get(`/api/runs/${e}/diffs`)}getLastResults(e,r={}){let t=new o;return r.matched!==void 0&&(t=t.set("matched",r.matched.toString())),r.minScore!==void 0&&(t=t.set("minScore",r.minScore.toString())),r.symbolId!==void 0&&(t=t.set("symbolId",r.symbolId.toString())),r.page!==void 0&&(t=t.set("page",r.page.toString())),r.size!==void 0&&(t=t.set("size",r.size.toString())),r.sort&&(t=t.set("sort",r.sort)),this.apiService.get(`/api/screeners/${e}/last-results`,t)}toggleStar(e,r){return this.apiService.put(`/api/screeners/${e}/star`,r)}getStarredScreeners(){return this.apiService.get("/api/screeners/starred")}createSavedView(e,r){return this.apiService.post(`/api/screeners/${e}/saved-views`,r)}listSavedViews(e){return this.apiService.get(`/api/screeners/${e}/saved-views`)}updateSavedView(e,r){return this.apiService.patch(`/api/saved-views/${e}`,r)}deleteSavedView(e){return this.apiService.delete(`/api/saved-views/${e}`)}searchSymbols(e){let r=new o().set("q",e);return this.apiService.get("/api/symbols",r)}};i.\u0275fac=function(r){return new(r||i)(d(f))},i.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"});let u=i;return u})();var $={screeners:[],myScreeners:[],publicScreeners:[],starredScreeners:[],currentScreener:null,screenerVersions:[],screenerRuns:[],currentRun:null,runResults:[],loading:!1,error:null,pagination:{page:0,size:25,totalElements:0,totalPages:0}},L=(()=>{let i=class i{constructor(e){this.screenerApi=e,this.stateSubject$=new g($)}get state$(){return this.stateSubject$.asObservable()}get screeners$(){return this.state$.pipe(a(e=>e.screeners))}get myScreeners$(){return this.state$.pipe(a(e=>e.myScreeners))}get publicScreeners$(){return this.state$.pipe(a(e=>e.publicScreeners))}get starredScreeners$(){return this.state$.pipe(a(e=>e.starredScreeners))}get currentScreener$(){return this.state$.pipe(a(e=>e.currentScreener))}get screenerVersions$(){return this.state$.pipe(a(e=>e.screenerVersions))}get screenerRuns$(){return this.state$.pipe(a(e=>e.screenerRuns))}get currentRun$(){return this.state$.pipe(a(e=>e.currentRun))}get runResults$(){return this.state$.pipe(a(e=>e.runResults))}get loading$(){return this.state$.pipe(a(e=>e.loading))}get error$(){return this.state$.pipe(a(e=>e.error))}get pagination$(){return this.state$.pipe(a(e=>e.pagination))}updateState(e){let r=this.stateSubject$.value;this.stateSubject$.next(S(S({},r),e))}setLoading(e){this.updateState({loading:e})}setError(e){this.updateState({error:e})}setCurrentScreener(e){this.updateState({currentScreener:e})}setCurrentRun(e){this.updateState({currentRun:e})}loadScreeners(e={}){return this.setLoading(!0),this.setError(null),this.screenerApi.listScreeners(e).pipe(s(r=>{this.updateState({screeners:r.content,pagination:{page:r.page,size:r.size,totalElements:r.totalElements,totalPages:r.totalPages},loading:!1})}),s({error:r=>{this.setError("Failed to load screeners"),this.setLoading(!1)}}))}loadMyScreeners(){return this.setLoading(!0),this.setError(null),this.screenerApi.listMyScreeners().pipe(s(e=>{this.updateState({myScreeners:e,loading:!1})}),s({error:e=>{this.setError("Failed to load my screeners"),this.setLoading(!1)}}))}loadPublicScreeners(){return this.setLoading(!0),this.setError(null),this.screenerApi.listPublicScreeners().pipe(s(e=>{this.updateState({publicScreeners:e,loading:!1})}),s({error:e=>{this.setError("Failed to load public screeners"),this.setLoading(!1)}}))}loadStarredScreeners(){return this.setLoading(!0),this.setError(null),this.screenerApi.getStarredScreeners().pipe(s(e=>{this.updateState({starredScreeners:e,loading:!1})}),s({error:e=>{this.setError("Failed to load starred screeners"),this.setLoading(!1)}}))}loadScreener(e){return this.setLoading(!0),this.setError(null),this.screenerApi.getScreener(e).pipe(s(r=>{this.setCurrentScreener(r),this.setLoading(!1)}),s({error:r=>{this.setError("Failed to load screener"),this.setLoading(!1)}}))}createScreener(e){return this.setLoading(!0),this.setError(null),this.screenerApi.createScreener(e).pipe(s(r=>{let t=this.stateSubject$.value;this.updateState({screeners:[r,...t.screeners],myScreeners:[r,...t.myScreeners],loading:!1})}),s({error:r=>{this.setError("Failed to create screener"),this.setLoading(!1)}}))}updateScreener(e,r){return this.setLoading(!0),this.setError(null),this.screenerApi.updateScreener(e,r).pipe(s(t=>{let n=this.stateSubject$.value,c=l=>l.map(h=>h.screenerId===e?t:h);this.updateState({screeners:c(n.screeners),myScreeners:c(n.myScreeners),publicScreeners:c(n.publicScreeners),starredScreeners:c(n.starredScreeners),currentScreener:n.currentScreener?.screenerId===e?t:n.currentScreener,loading:!1})}),s({error:t=>{this.setError("Failed to update screener"),this.setLoading(!1)}}))}deleteScreener(e){return this.setLoading(!0),this.setError(null),this.screenerApi.deleteScreener(e).pipe(s(()=>{let r=this.stateSubject$.value,t=n=>n.filter(c=>c.screenerId!==e);this.updateState({screeners:t(r.screeners),myScreeners:t(r.myScreeners),publicScreeners:t(r.publicScreeners),starredScreeners:t(r.starredScreeners),currentScreener:r.currentScreener?.screenerId===e?null:r.currentScreener,loading:!1})}),s({error:r=>{this.setError("Failed to delete screener"),this.setLoading(!1)}}))}loadScreenerVersions(e){return this.setLoading(!0),this.setError(null),this.screenerApi.listVersions(e).pipe(s(r=>{this.updateState({screenerVersions:r,loading:!1})}),s({error:r=>{this.setError("Failed to load screener versions"),this.setLoading(!1)}}))}loadScreenerRuns(e,r={}){return this.setLoading(!0),this.setError(null),this.screenerApi.listRuns(e,r).pipe(s(t=>{this.updateState({screenerRuns:t.content,pagination:{page:t.page,size:t.size,totalElements:t.totalElements,totalPages:t.totalPages},loading:!1})}),s({error:t=>{this.setError("Failed to load screener runs"),this.setLoading(!1)}}))}loadRunResults(e,r={}){return this.setLoading(!0),this.setError(null),this.screenerApi.getRunResults(e,r).pipe(s(t=>{this.updateState({runResults:t.content,pagination:{page:t.page,size:t.size,totalElements:t.totalElements,totalPages:t.totalPages},loading:!1})}),s({error:t=>{this.setError("Failed to load run results"),this.setLoading(!1)}}))}toggleStar(e,r){return this.setLoading(!0),this.setError(null),this.screenerApi.toggleStar(e,{starred:r}).pipe(s(()=>{let t=this.stateSubject$.value,n=[...t.starredScreeners];if(r){let c=t.screeners.find(l=>l.screenerId===e);c&&!n.find(l=>l.screenerId===e)&&n.push(c)}else n=n.filter(c=>c.screenerId!==e);this.updateState({starredScreeners:n,loading:!1})}),s({error:t=>{this.setError("Failed to toggle star"),this.setLoading(!1)}}))}reset(){this.stateSubject$.next($)}};i.\u0275fac=function(r){return new(r||i)(d(v))},i.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"});let u=i;return u})();export{v as a,L as b};
