<div class="configure-tab-content">
  @if (editingPortfolio) {
    <div class="portfolio-header">
      <div class="header-content">
        <!-- Edit Button at Top Right -->
        <div class="edit-controls">
          @if (!isEditing) {
            <button class="edit-all-btn" (click)="startEditAll()" title="Edit portfolio">
              <i class="pi pi-pencil"></i>
              Edit
            </button>
          } @else {
            <div class="edit-buttons">
              <button class="save-all-btn" 
                      (click)="saveEditAll()" 
                      title="Save all changes"
                      [disabled]="isSaving">
                @if (isSaving) {
                  <i class="pi pi-spin pi-spinner"></i>
                  Saving...
                } @else {
                  <i class="pi pi-check"></i>
                  Save
                }
              </button>
              <button class="cancel-btn" 
                      (click)="cancelEdit()" 
                      title="Cancel editing"
                      [disabled]="isSaving">
                <i class="pi pi-times"></i>
                Cancel
              </button>
            </div>
          }
        </div>

        <div class="portfolio-title-section">
          <!-- First row: Portfolio Name + Risk Profile -->
          <div class="title-row">
            <div class="portfolio-name">
              @if (!isEditing) {
                <span class="name-text">{{ editingPortfolio.name || 'Untitled Portfolio' }}</span>
              } @else {
                <textarea pInputTextarea 
                          [(ngModel)]="editingPortfolio.name"
                          placeholder="Enter portfolio name"
                          class="inline-edit-textarea"
                          rows="1"
                          autoResize="true"
                          [disabled]="isSaving">
                </textarea>
              }
            </div>
            
            <div class="risk-profile-inline">
              @if (!isEditing) {
                <span class="risk-text">[{{ editingPortfolio.riskProfile || 'Not set' }}]</span>
              } @else {
                <p-select [options]="riskProfileOptions" 
                         [(ngModel)]="editingPortfolio.riskProfile"
                         optionLabel="label"
                         optionValue="value"
                         placeholder="Select risk profile"
                         class="inline-edit-select"
                         [disabled]="isSaving">
                </p-select>
              }
            </div>
          </div>
          
          <!-- Second row: Description -->
          <div class="description-row">
            @if (!isEditing) {
              <span class="description-text">{{ editingPortfolio.description || 'No description provided' }}</span>
            } @else {
              <textarea pInputTextarea 
                        [(ngModel)]="editingPortfolio.description"
                        placeholder="Enter portfolio description (optional)"
                        class="inline-edit-textarea"
                        rows="2"
                        autoResize="true"
                        [disabled]="isSaving">
              </textarea>
            }
          </div>
        </div>
      </div>
    </div>
  } @else {
    <div class="no-selection-message">
      <i class="pi pi-info-circle"></i>
      <h3>No Portfolio Selected</h3>
      <p>Please select a portfolio from the Overview tab to configure it, or click "Create Portfolio" to create a new one.</p>
      <button pButton 
              label="Back to Overview" 
              icon="pi pi-arrow-left" 
              class="p-button-outlined"
              (click)="navigateToOverview()">
      </button>
    </div>
  }
</div>
