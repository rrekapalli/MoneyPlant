:host {
  .criteria-popover {
    .criteria-popover-content {
      padding: 0;
      
      .loading-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 2rem;
        gap: 1rem;
        
        .loading-text {
          color: var(--text-color-secondary);
          font-size: 0.875rem;
        }
      }
      
      .error-message {
        margin: 1rem;
        width: calc(100% - 2rem);
      }
      
      .popover-main {
        .search-container {
          padding: 1rem 1rem 0.5rem 1rem;
          border-bottom: 1px solid var(--surface-border);
          
          .search-input {
            width: 100%;
          }
        }
        
        .criteria-tabs {
          ::ng-deep {
            .p-tabview-nav {
              background: var(--surface-ground);
              border-bottom: 1px solid var(--surface-border);
              
              .p-tabview-nav-link {
                padding: 0.75rem 1rem;
                border: none;
                background: transparent;
                
                .tab-label {
                  margin-left: 0.5rem;
                }
                
                &:hover {
                  background: var(--surface-hover);
                }
              }
              
              .p-highlight .p-tabview-nav-link {
                background: var(--primary-color);
                color: var(--primary-color-text);
              }
            }
            
            .p-tabview-panels {
              padding: 0;
              background: transparent;
              
              .p-tabview-panel {
                padding: 0;
              }
            }
          }
          
          .options-container {
            max-height: 300px;
            overflow-y: auto;
            
            .no-results {
              display: flex;
              flex-direction: column;
              align-items: center;
              justify-content: center;
              padding: 2rem;
              color: var(--text-color-secondary);
              gap: 0.5rem;
              
              i {
                font-size: 1.5rem;
                opacity: 0.6;
              }
            }
            
            .options-groups {
              .option-group {
                .category-header {
                  padding: 0.75rem 1rem 0.5rem 1rem;
                  background: var(--surface-section);
                  border-bottom: 1px solid var(--surface-border);
                  
                  .category-title {
                    font-weight: 600;
                    font-size: 0.875rem;
                    color: var(--text-color-secondary);
                    text-transform: uppercase;
                    letter-spacing: 0.5px;
                  }
                }
                
                .option-list {
                  .option-item {
                    display: flex;
                    align-items: center;
                    padding: 0.75rem 1rem;
                    cursor: pointer;
                    border-bottom: 1px solid var(--surface-border);
                    transition: all 0.2s ease;
                    gap: 0.75rem;
                    
                    &:hover:not(.disabled) {
                      background: var(--surface-hover);
                    }
                    
                    &.disabled {
                      opacity: 0.5;
                      cursor: not-allowed;
                    }
                    
                    .option-icon {
                      color: var(--primary-color);
                      font-size: 1rem;
                      min-width: 1rem;
                    }
                    
                    .option-content {
                      flex: 1;
                      
                      .option-label {
                        font-weight: 500;
                        color: var(--text-color);
                        margin-bottom: 0.25rem;
                      }
                      
                      .option-description {
                        font-size: 0.875rem;
                        color: var(--text-color-secondary);
                        line-height: 1.3;
                      }
                    }
                    
                    .option-check {
                      color: var(--green-500);
                      font-size: 1rem;
                      opacity: 0;
                      transition: opacity 0.2s ease;
                      
                      &.visible {
                        opacity: 1;
                      }
                    }
                  }
                  
                  .option-item:last-child {
                    border-bottom: none;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}

// Responsive adjustments
@media (max-width: 768px) {
  :host {
    .criteria-popover {
      .criteria-popover-content {
        .popover-main {
          .criteria-tabs {
            ::ng-deep {
              .p-tabview-nav {
                .p-tabview-nav-link {
                  padding: 0.5rem 0.75rem;
                  font-size: 0.875rem;
                  
                  .tab-label {
                    margin-left: 0.25rem;
                  }
                }
              }
            }
          }
          
          .options-container {
            max-height: 250px;
            
            .options-groups {
              .option-group {
                .option-list {
                  .option-item {
                    padding: 0.5rem 0.75rem;
                    gap: 0.5rem;
                    
                    .option-content {
                      .option-label {
                        font-size: 0.875rem;
                      }
                      
                      .option-description {
                        font-size: 0.8125rem;
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}

// Dark theme adjustments
@media (prefers-color-scheme: dark) {
  :host {
    .criteria-popover {
      .criteria-popover-content {
        .popover-main {
          .search-container {
            border-bottom-color: var(--surface-border);
          }
          
          .criteria-tabs {
            ::ng-deep {
              .p-tabview-nav {
                background: var(--surface-ground);
                border-bottom-color: var(--surface-border);
              }
            }
          }
          
          .options-container {
            .options-groups {
              .option-group {
                .category-header {
                  background: var(--surface-section);
                  border-bottom-color: var(--surface-border);
                }
                
                .option-list {
                  .option-item {
                    border-bottom-color: var(--surface-border);
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}