<!-- Loading State -->
<div class="loading-container" *ngIf="isLoading">
  <p-progressSpinner 
    [style]="{ width: '30px', height: '30px' }" 
    strokeWidth="4">
  </p-progressSpinner>
  <span class="loading-text">Loading operators...</span>
</div>

<!-- Error State -->
<div class="error-container" *ngIf="error && !isLoading">
  <p-message 
    severity="error" 
    [text]="error"
    styleClass="error-message">
  </p-message>
  <button 
    type="button" 
    class="p-button p-button-sm p-button-outlined"
    (click)="retryLoad()">
    <i class="pi pi-refresh"></i>
    Retry
  </button>
</div>

<!-- Operators Content -->
<div class="operators-content" *ngIf="!isLoading && !error">
  
  <!-- Search Input -->
  <div class="search-container">
    <span class="p-input-icon-left">
      <i class="pi pi-search"></i>
      <input 
        type="text" 
        pInputText 
        [value]="searchTerm"
        (input)="onSearchChange($event.target?.value || '')"
        placeholder="Search operators..."
        class="search-input">
    </span>
  </div>

  <!-- Field Context Info -->
  <div class="context-info" *ngIf="fieldId">
    <i class="pi pi-info-circle"></i>
    <span>Showing operators compatible with selected field</span>
  </div>

  <!-- No Results -->
  <div class="no-results" *ngIf="filteredOperators.length === 0">
    <i class="pi pi-info-circle"></i>
    <span>No operators found</span>
    <small *ngIf="searchTerm">Try adjusting your search terms</small>
  </div>

  <!-- Operators by Type -->
  <div class="operators-container" *ngIf="filteredOperators.length > 0">
    <p-accordion 
      [multiple]="true" 
      styleClass="operators-accordion">
      
      <p-accordionpanel 
        *ngFor="let type of operatorTypes; trackBy: trackByType">
        
        <p-accordionheader>
          <div class="type-header">
            <span class="type-title">{{ type }}</span>
            <p-badge 
              [value]="groupedOperators[type].length.toString()" 
              styleClass="type-count">
            </p-badge>
          </div>
        </p-accordionheader>

        <p-accordioncontent>
          <!-- Operators List -->
          <div class="operators-list">
          <div 
            class="operator-item"
            *ngFor="let operator of groupedOperators[type]; trackBy: trackByOperatorId"
            (click)="onOperatorSelect(operator)">
            
            <!-- Operator Icon -->
            <i 
              [class]="getOperatorIcon(operator.type)" 
              class="operator-icon">
            </i>
            
            <!-- Operator Content -->
            <div class="operator-content">
              <div class="operator-header">
                <div class="operator-main">
                  <span class="operator-symbol">{{ operator.symbol }}</span>
                  <span class="operator-name">{{ operator.name }}</span>
                </div>
                <div class="operator-badges">
                  <p-badge 
                    [value]="formatOperatorType(operator.type)" 
                    [styleClass]="getOperatorTypeBadge(operator.type)"
                    class="type-badge">
                  </p-badge>
                  <p-badge 
                    [value]="getPrecedenceText(operator.precedence)" 
                    styleClass="p-badge-secondary"
                    class="precedence-badge"
                    *ngIf="operator.precedence">
                  </p-badge>
                </div>
              </div>
              
              <div class="operator-description" *ngIf="operator.description">
                {{ operator.description }}
              </div>
              
              <div class="operator-meta" *ngIf="hasAdditionalInfo(operator)">
                <small class="operator-info">{{ getAdditionalInfo(operator) }}</small>
              </div>
              
              <div class="operator-example" *ngIf="operator.example">
                <p-divider styleClass="example-divider"></p-divider>
                <div class="example-content">
                  <small class="example-label">Example:</small>
                  <code class="example-code">{{ operator.example }}</code>
                </div>
              </div>
            </div>

            <!-- Selection Indicator -->
            <i class="pi pi-angle-right operator-arrow"></i>
          </div>
          </div>
        </p-accordioncontent>
      </p-accordionpanel>
    </p-accordion>
  </div>
</div>