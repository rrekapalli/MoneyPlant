<form [formGroup]="valueForm" (keydown)="onKeyDown($event)">
  <div class="value-input-container">
    <!-- Header -->
    <div class="input-header">
      <h4 class="input-title">
        <i class="pencil-icon">✏</i>
        Enter {{ getValueTypeLabel() }} Value
      </h4>
      <small class="operator-info" *ngIf="operator">
        for operator: <strong>{{ operator }}</strong>
      </small>
    </div>
    
    <!-- String Input -->
    <div class="input-section" *ngIf="valueType === 'string'">
      <label class="input-label">Text Value</label>
      <input 
        type="text"
        formControlName="value"
        [class.invalid]="hasError('required') || hasError('pattern')"
        placeholder="Enter text value"
        autocomplete="off">
      
      <!-- Suggestions -->
      <div class="suggestions" *ngIf="suggestions && suggestions.length > 0">
        <small class="suggestions-label">Suggestions:</small>
        <div class="suggestion-chips">
          <span class="suggestion-chip" 
                *ngFor="let suggestion of suggestions.slice(0, 5)"
                (click)="valueForm.patchValue({value: suggestion.value || suggestion})">
            {{ suggestion.label || suggestion }}
          </span>
        </div>
      </div>
    </div>
    
    <!-- Number Input -->
    <div class="input-section" *ngIf="valueType === 'number' || valueType === 'integer'">
      <label class="input-label">
        {{ valueType === 'integer' ? 'Integer' : 'Number' }} Value
        <span class="range-info" *ngIf="minValue !== null || maxValue !== null">
          ({{ minValue !== null ? minValue : '∞' }} - {{ maxValue !== null ? maxValue : '∞' }})
        </span>
      </label>
      <input
        type="number"
        formControlName="value"
        [step]="numberStep"
        [min]="minValue"
        [max]="maxValue"
        [class.invalid]="hasError('required') || hasError('min') || hasError('max')"
        placeholder="Enter number">
    </div>
    
    <!-- Percent Input -->
    <div class="input-section" *ngIf="valueType === 'percent'">
      <label class="input-label">Percentage Value (0-100)</label>
      <input
        type="number"
        formControlName="value"
        step="0.01"
        min="0"
        max="100"
        [class.invalid]="hasError('required') || hasError('min') || hasError('max')"
        placeholder="Enter percentage (0-100)">
    </div>
    
    <!-- Currency Input -->
    <div class="input-section" *ngIf="valueType === 'currency'">
      <label class="input-label">Currency Value</label>
      <input
        type="number"
        formControlName="value"
        step="0.01"
        min="0"
        [class.invalid]="hasError('required') || hasError('min')"
        placeholder="Enter amount (USD)">
    </div>
    
    <!-- Date Input -->
    <div class="input-section" *ngIf="valueType === 'date'">
      <label class="input-label">Date Value</label>
      <input
        type="date"
        formControlName="value"
        [class.invalid]="hasError('required')"
        placeholder="Select date">
    </div>
    
    <!-- Boolean Input -->
    <div class="input-section" *ngIf="valueType === 'boolean'">
      <label class="input-label">Boolean Value</label>
      <select
        formControlName="value"
        [class.invalid]="hasError('required')">
        <option value="">Select true or false</option>
        <option *ngFor="let option of enumOptions" [value]="option.value">
          {{ option.label }}
        </option>
      </select>
    </div>
    
    <!-- Enum/Select Input -->
    <div class="input-section" *ngIf="valueType === 'enum'">
      <label class="input-label">Select Value</label>
      
      <!-- Single Select -->
      <select *ngIf="!allowMultiple"
        formControlName="value"
        [class.invalid]="hasError('required')">
        <option value="">Select option</option>
        <option *ngFor="let option of enumOptions" [value]="option.value">
          {{ option.label }}
        </option>
      </select>
      
      <!-- Multi Select -->
      <select *ngIf="allowMultiple"
        formControlName="value"
        multiple
        [class.invalid]="hasError('required')">
        <option *ngFor="let option of enumOptions" [value]="option.value">
          {{ option.label }}
        </option>
      </select>
    </div>
    
    <!-- Multi-value Input for IN/NOT_IN operators -->
    <div class="input-section" *ngIf="allowMultiple && valueType !== 'enum'">
      <label class="input-label">Multiple Values (comma-separated)</label>
      <textarea 
        formControlName="value"
        [class.invalid]="hasError('required')"
        placeholder="Enter values separated by commas"
        rows="3">
      </textarea>
      <small class="input-help">
        Enter multiple values separated by commas (e.g., value1, value2, value3)
      </small>
    </div>
    
    <!-- Validation Error -->
    <small class="input-error" 
           *ngIf="valueForm.get('value')?.invalid && valueForm.get('value')?.touched">
      {{ getErrorMessage() }}
    </small>
    
    <!-- Preview -->
    <div class="value-preview" *ngIf="previewText && isValid">
      <label class="preview-label">Preview:</label>
      <span class="preview-text">{{ previewText }}</span>
    </div>
    
    <!-- Field Info -->
    <div class="field-info" *ngIf="fieldMeta">
      <small class="field-description" *ngIf="fieldMeta.description">
        <i class="info-icon">ℹ</i>
        {{ fieldMeta.description }}
      </small>
      <small class="field-example" *ngIf="fieldMeta.example">
        <strong>Example:</strong> {{ fieldMeta.example }}
      </small>
    </div>
  </div>
  
  <!-- Footer -->
  <div class="input-footer">
    <div class="keyboard-hints">
      <small>
        <kbd>Enter</kbd> Confirm • <kbd>Esc</kbd> Cancel
      </small>
    </div>
    
    <div class="action-buttons">
      <button type="button" 
              class="cancel-btn"
              (click)="onCancel()">
        Cancel
      </button>
      
      <button type="button" 
              class="confirm-btn"
              [disabled]="!isValid"
              (click)="onConfirm()">
        Apply
      </button>
    </div>
  </div>
</form>