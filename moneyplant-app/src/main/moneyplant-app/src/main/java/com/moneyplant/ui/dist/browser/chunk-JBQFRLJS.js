import{a as Js,b as ea}from"./chunk-QNYTVHMB.js";import{a as vc,b as yc}from"./chunk-6FKSLAUI.js";import{A as lo,a as sc,b as ro,c as io,d as rs,e as ac,f as oc,g as lc,h as cc,i as no,j as fc,n as dc,o as qs,q as pc,r as mc,s as Qs,t as gc,u as xc,v as Zs,w as so,x as ao,y as _c,z as oo}from"./chunk-LUZOZIDA.js";import{$ as Us,A as or,Aa as Zr,B as ut,Ba as Mr,C as zs,Ca as Ys,D as ql,Da as uc,E as Ql,Ea as hc,Fa as Ci,Ga as Jr,H as Zl,I as to,L as hn,O as Jn,P as Jl,Q as ec,S as fn,T as tc,U as Wr,V as dn,W as rc,Y as pn,Z as es,aa as qr,c as bi,d as br,da as ic,f as Cr,fa as Gs,g as Vs,h as Tr,ha as nc,i as Ja,ia as er,ja as tt,k as eo,ka as Xs,ma as pr,oa as tr,pa as js,qa as ts,r as jl,t as Kl,ta as is,u as $s,ua as Qr,v as Yl,w as Hs,wa as Ks,x as Ws,y as un,z as Zn,za as Sr}from"./chunk-XBYO5J67.js";import{g as Ul,i as Gl,k as Xl,l as ln,m as cn,p as wi}from"./chunk-BCYXNNE7.js";import{$a as z,Ab as y,Bb as Vi,C as Ml,Cb as li,Db as Ue,Eb as Ae,Fb as de,Fc as Wt,Ga as $r,Gb as pe,Gc as Wl,Ha as rn,Hc as Yr,Ic as Tt,Ja as Bl,Jb as mt,Jc as St,Ka as S,Kb as Dr,Kc as Jt,Lb as Qa,Lc as zl,M as Ls,Mb as Qt,N as Yn,Nb as et,Oa as Li,Ob as Se,P as Pl,Pa as ze,Pb as He,Q as Ll,Qb as yr,R as tn,Rc as Le,S as yt,T as Vt,Tb as Rs,Ub as Ns,V as Rl,Va as Oe,Vb as Bs,Vc as wr,Wa as $t,Wb as Ft,X as at,Xa as qn,Xb as Zt,Ya as Vl,Yb as Re,Za as Ht,Zb as Ct,_b as nn,a as Ol,aa as X,ba as j,bb as ve,c as Kn,cb as Ri,ec as sn,f as en,fa as Ya,fc as an,g as Ka,h as Ps,i as Al,ia as wt,ic as ct,jb as fe,kb as dt,kc as Hl,la as ai,lb as pt,ma as bt,mb as qa,mc as yi,nb as $l,nc as Qn,oa as oi,ob as Ni,pb as Bi,pc as Za,qb as w,qc as Hr,rb as P,sa as Nl,sb as L,sc as on,tb as he,ub as Be,uc as be,vb as Ve,vc as Ot,w as Dl,wb as $e,xb as ge,zb as ce}from"./chunk-E5FNFP2Z.js";import{wa as wc}from"./chunk-ZOFRZBD6.js";import{a as F,b as Y,e as Bt}from"./chunk-JKOY2XUY.js";var mr=class{constructor(){this.widget={id:"",x:0,y:0,cols:1,rows:1,position:{x:0,y:0,cols:1,rows:1},config:{options:{}}}}setId(t){return this.widget.id=t,this}setPosition(t){return this.widget.position=t,this}setComponent(t){return this.widget.config.component=t,this}setInitialState(t){return this.widget.config.initialState=t,this}setState(t){return this.widget.config.state=t,this}setHeader(t,e){return this.widget.config.header={title:t,options:e},this}setSize(t){return this.widget.config.size=t,this}setEChartsOptions(t){return this.widget.config.options=t,this}setFilterOptions(t){return this.widget.config.options=t,this}setTileOptions(t){return this.widget.config.options=t,this}setMarkdownCellOptions(t){return this.widget.config.options=t,this}setCodeCellOptions(t){return this.widget.config.options=t,this}setTableOptions(t){return this.widget.config.options=t,this}setEvents(t){return this.widget.config.events={onChartOptions:t},this}setEventChartOptions(t){return this.widget.config.events={onChartOptions:t},this}setSeries(t){return this.widget.series=t,this}setData(t){return this.widget.data=t,this}setChartInstance(t){return this.widget.chartInstance=t,this}setEChartsTitle(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.title=t,this}setEChartsGrid(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.grid=t,this}setEChartsTooltip(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.tooltip=t,this}setEChartsLegend(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.legend=t,this}setEChartsXAxis(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.xAxis=t,this}setEChartsYAxis(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.yAxis=t,this}setEChartsSeries(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.series=t,this}build(){return this.widget}static setData(t,e){if(t.data=e,t.config.options&&"series"in t.config.options){let i=t.config.options;i.series&&Array.isArray(i.series)&&i.series.forEach(n=>{n&&typeof n=="object"&&"data"in n&&(n.data=e)}),t.chartInstance&&t.chartInstance.setOption(i)}if(t.config.component==="table"&&t.config.options){let i=t.config.options;i.data&&(i.data=e)}if(t.config.component==="tile"&&t.config.options){let i=t.config.options;e&&typeof e=="object"&&Object.assign(i,e)}}static exportTableData(t){let e=t.config?.options;return!e?.data||!e?.columns?[]:e.data.map(i=>e.columns.map(n=>i[n]||""))}static getTableExportHeaders(t){return t.config?.options?.columns||[]}static getTableExportSheetName(t){return`${(t.config?.header?.title||"Table").replace(/[^\w\s]/gi,"").substring(0,20)} (Table)`}static exportTileData(t){let e=t.config?.options;return e?[[t.config?.header?.title||"Metric",e.value||"",e.change||"",e.changeType||"neutral",e.description||""]]:[]}static getTileExportHeaders(t){return["Metric","Value","Change","Change Type","Description"]}static getTileExportSheetName(t){return`${(t.config?.header?.title||"Tile").replace(/[^\w\s]/gi,"").substring(0,20)} (Tile)`}};var zt=[];for(let r=0;r<256;++r)zt.push((r+256).toString(16).slice(1));function bc(r,t=0){return(zt[r[t+0]]+zt[r[t+1]]+zt[r[t+2]]+zt[r[t+3]]+"-"+zt[r[t+4]]+zt[r[t+5]]+"-"+zt[r[t+6]]+zt[r[t+7]]+"-"+zt[r[t+8]]+zt[r[t+9]]+"-"+zt[r[t+10]]+zt[r[t+11]]+zt[r[t+12]]+zt[r[t+13]]+zt[r[t+14]]+zt[r[t+15]]).toLowerCase()}var co,Yh=new Uint8Array(16);function uo(){if(!co){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");co=crypto.getRandomValues.bind(crypto)}return co(Yh)}var qh=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ho={randomUUID:qh};function Qh(r,t,e){if(ho.randomUUID&&!t&&!r)return ho.randomUUID();r=r||{};let i=r.random??r.rng?.()??uo();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){if(e=e||0,e<0||e+16>t.length)throw new RangeError(`UUID byte range ${e}:${e+15} is out of buffer bounds`);for(let n=0;n<16;++n)t[e+n]=i[n];return t}return bc(i)}var mn=Qh;var Ee=class{constructor(){this.data=[],this.widgetBuilder=new mr().setId(mn()).setComponent("echart"),this.chartOptions=this.getDefaultOptions()}static exportData(t){throw new Error("exportData must be implemented by subclass")}static getExportHeaders(t){throw new Error("getExportHeaders must be implemented by subclass")}static getExportSheetName(t){throw new Error("getExportSheetName must be implemented by subclass")}setData(t){return this.data=Array.isArray(t)?t:[t],this.widgetBuilder.setData(t),this}setLabelFormatter(t){return this.seriesOptions.label||(this.seriesOptions.label={}),this.seriesOptions.label.formatter=t,this}setLabelShow(t){return this.seriesOptions.label||(this.seriesOptions.label={}),this.seriesOptions.label.show=t,this}setLabelPosition(t){return this.seriesOptions.label||(this.seriesOptions.label={}),this.seriesOptions.label.position=t,this}setColors(t){return this.getChartType()==="pie"?this.seriesOptions.color=t:(this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.color=t),this}setBorderRadius(t){return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.borderRadius=t,this}setBorder(t,e=1){return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.borderColor=t,this.seriesOptions.itemStyle.borderWidth=e,this}setEmphasis(t=10,e=0,i="rgba(0, 0, 0, 0.5)"){return this.seriesOptions.emphasis={itemStyle:{shadowBlur:t,shadowOffsetX:e,shadowColor:i}},this}setTitle(t,e){return this.chartOptions.title={text:t,subtext:e,left:"center",top:"10",textStyle:{fontSize:16,color:"#333"}},this}setTitleOptions(t){return this.chartOptions.title=F(F({},this.chartOptions.title),t),this}setTooltip(t,e){return this.chartOptions.tooltip={trigger:t,formatter:e||"{b}: {c}"},this}setTooltipOptions(t){return this.chartOptions.tooltip=F(F({},this.chartOptions.tooltip),t),this}setLegend(t="vertical",e="left"){return this.chartOptions.legend={show:!0,orient:t,left:e==="left"?"left":e==="right"?"right":"center",top:t==="horizontal"?"bottom":"middle",bottom:t==="horizontal"?"10":void 0},this}setLegendOptions(t){return this.chartOptions.legend=F(F({},this.chartOptions.legend),t),this}setGrid(t){return this.chartOptions.grid=F(F({},this.chartOptions.grid),t),this}setXAxis(t){return this.chartOptions.xAxis=t,this}setYAxis(t){return this.chartOptions.yAxis=t,this}setSeries(t){return this.chartOptions.series=t,this}addSeries(t){return this.chartOptions.series||(this.chartOptions.series=[]),this.chartOptions.series.push(t),this}setAnimation(t){return this.chartOptions.animation=t,this}setBackgroundColor(t){return this.chartOptions.backgroundColor=t,this}setHeader(t,e){return this.widgetBuilder.setHeader(t,e),this}setPosition(t){return this.widgetBuilder.setPosition(t),this}setCustomOptions(t){return this.widgetBuilder.setEChartsOptions(t),this}setEvents(t){return this.widgetBuilder.setEvents(t),this}setChartInstance(t){return this.widgetBuilder.setChartInstance(t),this}build(){return this.widgetBuilder.setEChartsOptions(this.chartOptions).build()}getChartOptions(){return F({},this.chartOptions)}getWidgetBuilder(){return this.widgetBuilder}static updateData(t,e,i){if(mr.setData(t,e),t.chartInstance)try{t.chartInstance.setOption(t.config?.options,!0)}catch(n){console.error("Error updating chart:",n)}else this.retryChartUpdate(t,i)}static retryChartUpdate(t,e){let i=e?.maxAttempts||10,n=e?.baseDelay||100,s=0,a=()=>{if(s++,t.chartInstance)try{t.chartInstance.setOption(t.config?.options,!0);return}catch(o){console.error("Error updating chart on retry:",o)}if(s<i){let o=Math.min(n*Math.pow(1.5,s-1),2e3);setTimeout(a,o)}};setTimeout(a,n)}static isChartType(t,e){return t.config.component==="echart"&&t.config.options?.series?.[0]?.type===e}static getChartType(t){return t.config.component==="echart"&&t.config.options?.series?.[0]?.type?t.config.options.series[0].type:null}static transformData(t,e){return t}static applyFilters(t,e){return!e||e.length===0?t:t.filter(i=>e.every(n=>{let s=n.column||n.property;if(!s)return!0;let a=this.getNestedProperty(i,s);return this.matchesFilter(a,n)}))}static getNestedProperty(t,e){return e.split(".").reduce((i,n)=>i?.[n],t)}static matchesFilter(t,e){switch(e.operator){case"equals":return t===e.value;case"contains":return String(t).toLowerCase().includes(String(e.value).toLowerCase());case"greaterThan":return Number(t)>Number(e.value);case"lessThan":return Number(t)<Number(e.value);case"greaterThanOrEqual":return Number(t)>=Number(e.value);case"lessThanOrEqual":return Number(t)<=Number(e.value);case"in":return Array.isArray(e.value)&&e.value.includes(t);default:return!0}}static generateSampleData(t,e){return t.map(i=>{let n=F({},i);return e?.randomizeNumericFields&&Object.keys(n).forEach(s=>{if(typeof n[s]=="number"){let a=(Math.random()-.5)*2*(e.variationPercentage||.2);n[s]=Math.max(0,n[s]*(1+a))}}),n})}setCurrencyFormatter(t="USD",e="en-US"){let i=n=>new Intl.NumberFormat(e,{style:"currency",currency:t}).format(n);return this.setTooltip(this.chartOptions.tooltip?.trigger||"item",n=>Array.isArray(n)?n.map(s=>`${s.seriesName}<br/>${s.name}: ${i(s.value)}`).join("<br/>"):`${n.name}: ${i(n.value)}`),this}setPercentageFormatter(t=1){let e=i=>`${i.toFixed(t)}%`;return this.setTooltip(this.chartOptions.tooltip?.trigger||"item",i=>Array.isArray(i)?i.map(n=>`${n.seriesName}<br/>${n.name}: ${e(n.value)}`).join("<br/>"):`${i.name}: ${e(i.value)}`),this}setNumberFormatter(t="en-US",e){let i=n=>new Intl.NumberFormat(t,e).format(n);return this.setTooltip(this.chartOptions.tooltip?.trigger||"item",n=>Array.isArray(n)?n.map(s=>`${s.seriesName}<br/>${s.name}: ${i(s.value)}`).join("<br/>"):`${n.name}: ${i(n.value)}`),this}setFilterColumn(t){let e=this.widgetBuilder.build();return e.config&&(e.config.filterColumn=t),this}static createFilterFromChartData(t,e){return!t||!e?null:{property:e,operator:"equals",value:t.name||t.value,displayValue:t.name||String(t.value)}}setGradientColors(t,e,i="vertical"){let n={type:"linear",x:0,y:i==="vertical"?0:1,x2:i==="vertical"?0:1,y2:i==="vertical"?1:0,colorStops:[{offset:0,color:t},{offset:1,color:e}]};return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.color=n,this}setPredefinedPalette(t){let e={business:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],finance:["#2E8B57","#4682B4","#DAA520","#DC143C","#9370DB","#20B2AA","#FF6347","#4169E1","#32CD32"],modern:["#667eea","#764ba2","#f093fb","#f5576c","#4facfe","#00f2fe","#43e97b","#38f9d7","#ffecd2"],pastel:["#FFB6C1","#87CEEB","#98FB98","#F0E68C","#DDA0DD","#F5DEB3","#FFE4E1","#E0FFFF","#FAFAD2"],dark:["#2c3e50","#34495e","#7f8c8d","#95a5a6","#bdc3c7","#ecf0f1","#f39c12","#e67e22","#e74c3c"]};return this.setColors(e[t]||e.business)}getPaletteColors(t){let e={business:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],finance:["#2E8B57","#4682B4","#DAA520","#DC143C","#9370DB","#20B2AA","#FF6347","#4169E1","#32CD32"],modern:["#667eea","#764ba2","#f093fb","#f5576c","#4facfe","#00f2fe","#43e97b","#38f9d7","#ffecd2"],pastel:["#FFB6C1","#87CEEB","#98FB98","#F0E68C","#DDA0DD","#F5DEB3","#FFE4E1","#E0FFFF","#FAFAD2"],dark:["#2c3e50","#34495e","#7f8c8d","#95a5a6","#bdc3c7","#ecf0f1","#f39c12","#e67e22","#e74c3c"]};return e[t]||e.business}createCurrencyFormatter(t="USD",e="en-US"){return i=>new Intl.NumberFormat(e,{style:"currency",currency:t}).format(i)}createPercentageFormatter(t=1){return e=>`${e.toFixed(t)}%`}createNumberFormatter(t=0,e="en-US"){return i=>new Intl.NumberFormat(e,{minimumFractionDigits:t,maximumFractionDigits:t}).format(i)}setValueFormatter(t){return this.setTooltip(this.chartOptions.tooltip?.trigger||"item",e=>Array.isArray(e)?e.map(i=>`${i.seriesName}<br/>${i.name}: ${t(i.value)}`).join("<br/>"):`${e.name}: ${t(e.value)}`),this}};var gn=class r extends Ee{constructor(){super(),this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"5%",right:"5%",bottom:"15%",height:"70%"},tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{show:!0,orient:"vertical",left:"left",top:"middle"}}}getChartType(){return"pie"}getDefaultSeriesOptions(){return{name:"Pie Chart",type:"pie",radius:["30%","60%"],center:["50%","50%"],itemStyle:{borderRadius:2},label:{formatter:`{b}
{c}%
({d})%`,show:!0},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setRadius(t){return this.seriesOptions.radius=t,this}setCenter(t){return this.seriesOptions.center=t,this}build(){let t=Y(F({},this.chartOptions),{series:[Y(F({},this.seriesOptions),{type:"pie"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e,i){Ee.updateData(t,e,i)}static transformData(t,e){if(!t||t.length===0)return[];let i=e?.valueField||"value",n=e?.nameField||"name",s=t.map(a=>({value:Number(a[i])||0,name:String(a[n])||"Unknown"}));return e?.sortBy==="value"?s.sort((a,o)=>o.value-a.value):e?.sortBy==="name"&&s.sort((a,o)=>a.name.localeCompare(o.name)),s}static addPercentages(t){let e=t.reduce((i,n)=>i+n.value,0);return t.map(i=>Y(F({},i),{percentage:e>0?i.value/e*100:0}))}static createFilterFromPieClick(t,e){return!t||!t.name?null:{accessor:e,filterColumn:e,[e]:t.name,value:t.name,percentage:t.value?.toString()||"0"}}setDonutStyle(t="40%",e="70%"){return this.seriesOptions.radius=[t,e],this}setPercentageLabels(t=!0,e=1){return t&&(this.seriesOptions.label=Y(F({},this.seriesOptions.label),{formatter:"{b}: {c} ({d}%)"})),this}setFinancialDisplay(t="USD",e="en-US"){return this.setCurrencyFormatter(t,e),this.seriesOptions.label=Y(F({},this.seriesOptions.label),{formatter:i=>{let n=new Intl.NumberFormat(e,{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0});return`${i.data.name}
${n.format(i.data.value)}
(${i.percent}%)`}}),this}static isPieChart(t){return Ee.isChartType(t,"pie")}static createPieChartWidget(t){let e=r.create();t&&e.setData(t);let i=Y(F({},e.chartOptions),{series:[Y(F({},e.seriesOptions),{type:"pie"})]});return e.widgetBuilder.setEChartsOptions(i).setData(t||[])}static exportData(t){let e=t.config?.options?.series?.[0];return e?.data?e.data.map(i=>[i.name||"Unknown",i.value||0,r.calculatePercentage(i.value,e.data)]):(console.warn("PieChartBuilder.exportData - No series data found"),[])}static getExportHeaders(t){return["Category","Value","Percentage"]}static getExportSheetName(t){return(t.config?.header?.title||"Sheet").replace(/[^\w\s]/gi,"").substring(0,31).trim()}static calculatePercentage(t,e){let i=e.reduce((n,s)=>n+(s.value||0),0);return i===0?"0%":`${(t/i*100).toFixed(2)}%`}};var xn=class r extends Ee{constructor(){super(),this.categories=[],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"3%",right:"4%",bottom:"15%"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{show:!0,orient:"horizontal",top:"10"},xAxis:{type:"category",data:[]},yAxis:{type:"value"}}}getChartType(){return"bar"}getDefaultSeriesOptions(){return{name:"Bar Chart",type:"bar",itemStyle:{borderRadius:2},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",aggregateBy:n,sortBy:s,sortOrder:a="desc",limit:o}=t;try{let c=this.data.map(l=>({name:l[e]||"Unknown",value:parseFloat(l[i])||0}));if(n){let l=new Map;c.forEach(u=>{let h=u.name;l.set(h,(l.get(h)||0)+u.value)}),c=Array.from(l.entries()).map(([u,h])=>({name:u,value:h}))}s==="name"?c.sort((l,u)=>a==="asc"?l.name.localeCompare(u.name):u.name.localeCompare(l.name)):s==="value"&&c.sort((l,u)=>a==="asc"?l.value-u.value:u.value-l.value),o&&o>0&&(c=c.slice(0,o)),this.seriesOptions.data=c,this.categories.length===0&&(this.categories=c.map(l=>l.name),this.setCategories(this.categories))}catch(c){console.error("Error transforming bar chart data:",c)}return this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setCategories(t){return this.categories=t,this.chartOptions.xAxis=Y(F({},this.chartOptions.xAxis),{data:t}),this}setColors(t){return this.seriesOptions.color=t,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return this.setColors(e)}setBarWidth(t){return this.seriesOptions.barWidth=t,this}setBarBorderRadius(t){return this.seriesOptions.itemStyle=Y(F({},this.seriesOptions.itemStyle),{borderRadius:t}),this}setYAxisName(t){return this.chartOptions.yAxis=Y(F({},this.chartOptions.yAxis),{name:t,nameLocation:"middle",nameGap:30}),this}setXAxisName(t){return this.chartOptions.xAxis=Y(F({},this.chartOptions.xAxis),{name:t,nameLocation:"middle",nameGap:30}),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setValueFormatter(i),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setValueFormatter(e),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setValueFormatter(i),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=5){let e=[],i=["Q1","Q2","Q3","Q4","Q5"];for(let n=0;n<Math.min(t,i.length);n++)e.push({name:i[n],value:Math.floor(Math.random()*100)+10,category:i[n],department:["Sales","Marketing","Operations"][Math.floor(Math.random()*3)]});return this.setData(e)}setSalesRevenueConfiguration(){return this.setBarWidth("60%").setBarBorderRadius(4).setYAxisName("Revenue ($)").setXAxisName("Time Period").setPredefinedPalette("finance").setTooltip("axis","{b}: ${c}")}setPerformanceConfiguration(){return this.setBarWidth("70%").setBarBorderRadius(6).setYAxisName("Performance Score").setXAxisName("Metrics").setPredefinedPalette("business").setTooltip("axis","{b}: {c}%")}setComparisonConfiguration(){return this.setBarWidth("50%").setBarBorderRadius(2).setYAxisName("Value").setXAxisName("Categories").setPredefinedPalette("modern").setTooltip("axis","{b}: {c}")}build(){let t=Y(F({},this.chartOptions),{series:[Y(F({},this.seriesOptions),{type:"bar"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>({name:l.name||l.category||"Unknown",value:parseFloat(l.value)||0})));let o=t.chartInstance.getOption(),c=Y(F({},o),{series:[Y(F({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating bar chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isBarChart(t){return Ee.isChartType(t,"bar")}static exportData(t){let e=[];if(t.echart_options?.series?.[0]?.data&&t.echart_options?.xAxis?.data){let i=t.echart_options.series[0].data,n=t.echart_options.xAxis.data;for(let s=0;s<i.length;s++){let a=i[s],o=n[s]||`Category ${s+1}`;typeof a=="object"&&a!==null?e.push(F({Category:a.name||o,Value:a.value||0},a)):e.push({Category:o,Value:a||0})}}return e}static getExportHeaders(t){return["Category","Value"]}static getExportSheetName(t){return"Bar Chart Data"}};var _n=class r extends Ee{constructor(){super(),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"item",formatter:"{b}: ({c})"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"value",nameLocation:"middle",scale:!0,axisLabel:{color:"#666"}},yAxis:{type:"value",nameLocation:"middle",scale:!0,axisLabel:{color:"#666"}}}}getChartType(){return"scatter"}getDefaultSeriesOptions(){return{name:"Scatter Chart",type:"scatter",symbolSize:8,symbol:"circle",itemStyle:{color:"#5470c6",opacity:.8},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},large:!1,largeThreshold:2e3}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{xField:e="x",yField:i="y",nameField:n="name",sizeField:s,sortBy:a,sortOrder:o="asc",limit:c}=t;try{let l=this.data.map((u,h)=>({value:[parseFloat(u[e])||0,parseFloat(u[i])||0],name:u[n]||`Point ${h+1}`,symbolSize:s&&parseFloat(u[s])||8,originalItem:u}));a==="x"?l.sort((u,h)=>o==="asc"?u.value[0]-h.value[0]:h.value[0]-u.value[0]):a==="y"&&l.sort((u,h)=>o==="asc"?u.value[1]-h.value[1]:h.value[1]-u.value[1]),c&&c>0&&(l=l.slice(0,c)),this.seriesOptions.data=l}catch(l){console.error("Error transforming scatter chart data:",l)}return this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisName(t){return this.chartOptions.xAxis=Y(F({},this.chartOptions.xAxis),{name:t}),this}setYAxisName(t){return this.chartOptions.yAxis=Y(F({},this.chartOptions.yAxis),{name:t}),this}setSymbol(t,e=8){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setSymbolSizeFunction(t){return this.seriesOptions.symbolSize=t,this}setItemStyle(t,e=.8,i,n){return this.seriesOptions.itemStyle={color:t,opacity:e,borderColor:i,borderWidth:n},this}setLargeScatter(t,e=2e3){return this.seriesOptions.large=t,this.seriesOptions.largeThreshold=e,this}setProgressive(t,e=3e3){return this.seriesOptions.progressive=t,this.seriesOptions.progressiveThreshold=e,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&this.setItemStyle(e[0]),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setValueFormatter(i),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setValueFormatter(e),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setValueFormatter(i),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=20){let e=[];for(let i=0;i<t;i++)e.push({x:Math.random()*100,y:Math.random()*100,name:`Point ${i+1}`,size:Math.random()*15+5,category:["A","B","C"][Math.floor(Math.random()*3)],department:["Sales","Marketing","Operations"][Math.floor(Math.random()*3)]});return this.setData(e)}setCorrelationAnalysisConfiguration(){return this.setSymbol("circle",6).setItemStyle("#5470c6",.7).setLargeScatter(!0,1e3).setXAxisName("X Variable").setYAxisName("Y Variable").setPredefinedPalette("finance").setTooltip("item","{b}: ({c})")}setPerformanceAnalysisConfiguration(){return this.setSymbol("diamond",8).setItemStyle("#91cc75",.8).setXAxisName("Performance Score").setYAxisName("Efficiency Rating").setPredefinedPalette("business").setTooltip("item","{b}: Performance {c}")}setRiskAnalysisConfiguration(){return this.setSymbol("triangle",7).setItemStyle("#ee6666",.7).setXAxisName("Risk Level").setYAxisName("Return Potential").setPredefinedPalette("modern").setTooltip("item","Risk: {c}")}build(){let t=Y(F({},this.chartOptions),{series:[Y(F({},this.seriesOptions),{type:"scatter"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>({value:[parseFloat(l.x)||0,parseFloat(l.y)||0],name:l.name||"Point"})));let o=t.chartInstance.getOption(),c=Y(F({},o),{series:[Y(F({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating scatter chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isScatterChart(t){return Ee.isChartType(t,"scatter")}static createScatterChartWidget(t){let e=r.create();return t&&e.setData(t),e.getWidgetBuilder()}static exportData(t){let e=[];return t.echart_options?.series?.[0]?.data&&t.echart_options.series[0].data.forEach((n,s)=>{n&&n.value&&Array.isArray(n.value)&&e.push({Name:n.name||`Point ${s+1}`,"X Value":n.value[0]||0,"Y Value":n.value[1]||0,"Symbol Size":n.symbolSize||8})}),e}static getExportHeaders(t){return["Name","X Value","Y Value","Symbol Size"]}static getExportSheetName(t){return"Scatter Chart Data"}};var vn=class r extends Ee{constructor(){super(),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{tooltip:{trigger:"item",formatter:"{b}: {c}"}}}getChartType(){return"gauge"}getDefaultSeriesOptions(){return{name:"Gauge Chart",type:"gauge",min:0,max:100,startAngle:180,endAngle:0,radius:"75%",center:["50%","60%"],axisLine:{lineStyle:{width:30,color:[[.3,"#ff6e76"],[.7,"#fddd60"],[1,"#58d9f9"]]}},progress:{show:!0,width:8},pointer:{show:!0,length:"60%",width:8},axisTick:{show:!0,splitNumber:5,length:8,lineStyle:{width:2,color:"#999"}},splitLine:{show:!0,length:30,lineStyle:{width:4,color:"#999"}},axisLabel:{show:!0,distance:5,color:"#999",fontSize:12},title:{show:!0,offsetCenter:[0,70],color:"#464646",fontSize:14},detail:{show:!0,offsetCenter:[0,40],color:"#464646",fontSize:30,formatter:"{value}%"}}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",sortBy:n,sortOrder:s="desc",limit:a}=t;try{let o=this.data.map(c=>({value:parseFloat(c[i])||0,name:c[e]||"Gauge",originalItem:c}));n==="value"?o.sort((c,l)=>s==="asc"?c.value-l.value:l.value-c.value):n==="name"&&o.sort((c,l)=>s==="asc"?c.name.localeCompare(l.name):l.name.localeCompare(c.name)),a&&a>0&&(o=o.slice(0,a)),this.seriesOptions.data=o.length>0?[o[0]]:[]}catch(o){console.error("Error transforming gauge chart data:",o)}return this}setData(t){return this.seriesOptions.data=Array.isArray(t)?t:[t],super.setData(t),this}setRange(t,e){return this.seriesOptions.min=t,this.seriesOptions.max=e,this}setAngles(t,e){return this.seriesOptions.startAngle=t,this.seriesOptions.endAngle=e,this}setRadius(t){return this.seriesOptions.radius=t,this}setCenter(t){return this.seriesOptions.center=t,this}setAxisLine(t,e){return this.seriesOptions.axisLine={lineStyle:{width:t,color:e}},this}setProgress(t,e=8){return this.seriesOptions.progress={show:t,width:e},this}setPointer(t,e="60%",i=8){return this.seriesOptions.pointer={show:t,length:e,width:i},this}setAxisTick(t,e=5,i=8,n=2,s="#999"){return this.seriesOptions.axisTick={show:t,splitNumber:e,length:i,lineStyle:{width:n,color:s}},this}setSplitLine(t,e=30,i=4,n="#999"){return this.seriesOptions.splitLine={show:t,length:e,lineStyle:{width:i,color:n}},this}setAxisLabel(t,e=5,i="#999",n=12){return this.seriesOptions.axisLabel={show:t,distance:e,color:i,fontSize:n},this}setGaugeTitle(t,e=[0,70],i="#464646",n=14){return this.seriesOptions.title={show:t,offsetCenter:e,color:i,fontSize:n},this}setDetail(t,e=[0,40],i="#464646",n=30,s="{value}%"){return this.seriesOptions.detail={show:t,offsetCenter:e,color:i,fontSize:n,formatter:s},this}setPredefinedPalette(t){let e=this.getPaletteColors(t),i=[];for(let n=0;n<e.length&&n<3;n++)i.push([(n+1)/3,e[n]]);return i.length===0&&i.push([.3,"#ff6e76"],[.7,"#fddd60"],[1,"#58d9f9"]),this.setAxisLine(30,i),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setDetail(!0,[0,40],"#464646",30,`{value | ${i.name}}`),this}setPercentageFormatter(t=1){return this.setDetail(!0,[0,40],"#464646",30,"{value}%"),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setDetail(!0,[0,40],"#464646",30,"{value}"),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=1){let e=[];for(let i=0;i<t;i++)e.push({value:Math.floor(Math.random()*100),name:`Gauge ${i+1}`,progress:Math.floor(Math.random()*100),target:100,category:["Performance","Efficiency","Quality"][Math.floor(Math.random()*3)]});return this.setData(e)}setKPIMonitoringConfiguration(){return this.setRange(0,100).setRadius("70%").setCenter(["50%","55%"]).setProgress(!0,10).setPointer(!0,"70%",6).setPredefinedPalette("business").setDetail(!0,[0,70],"#333",24,"{value}%").setGaugeTitle(!0,[0,-30],"#666",16)}setPerformanceTrackingConfiguration(){return this.setRange(0,100).setRadius("80%").setCenter(["50%","60%"]).setProgress(!0,15).setPointer(!1).setPredefinedPalette("finance").setDetail(!0,[0,10],"#333",32,"{value}%").setGaugeTitle(!0,[0,-40],"#666",18)}setProgressIndicatorConfiguration(){return this.setRange(0,100).setRadius("60%").setCenter(["50%","50%"]).setProgress(!0,8).setPointer(!0,"60%",4).setPredefinedPalette("modern").setDetail(!0,[0,60],"#333",20,"{value}%").setGaugeTitle(!0,[0,-50],"#666",14)}build(){let t=Y(F({},this.chartOptions),{series:[Y(F({},this.seriesOptions),{type:"gauge"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"?a=e.map(l=>({value:parseFloat(l.value)||0,name:l.name||"Gauge"})):typeof e=="number"&&(a=[{value:e,name:"Gauge"}]);let o=t.chartInstance.getOption(),c=Y(F({},o),{series:[Y(F({},o.series[0]),{data:Array.isArray(a)?a:[a]})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating gauge chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isGaugeChart(t){return Ee.isChartType(t,"gauge")}static createGaugeChartWidget(t){let e=r.create();return t&&e.setData(t),e.getWidgetBuilder()}static exportData(t){let e=[];return t.echart_options?.series?.[0]?.data&&t.echart_options.series[0].data.forEach(n=>{n&&e.push({Name:n.name||"Gauge",Value:n.value||0,Percentage:this.calculatePercentage(n.value||0,t.echart_options.series[0].max||100)})}),e}static getExportHeaders(t){return["Name","Value","Percentage"]}static getExportSheetName(t){return"Gauge Chart Data"}static calculatePercentage(t,e){return`${(t/e*100).toFixed(1)}%`}};var yn=class r extends Ee{constructor(){super(),this.xAxisData=[],this.yAxisData=[],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"15%",bottom:"15%"},tooltip:{trigger:"item",formatter:"{b}: {c}"},xAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{color:"#666"}},visualMap:{show:!0,min:0,max:10,calculable:!0,orient:"horizontal",left:"center",top:"5%",inRange:{color:["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffcc","#fee090","#fdae61","#f46d43","#d73027","#a50026"]},text:["High","Low"]}}}getChartType(){return"heatmap"}getDefaultSeriesOptions(){return{name:"Heatmap Chart",type:"heatmap",itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},progressive:1e3,progressiveThreshold:3e3,animation:!0}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{xField:e="x",yField:i="y",valueField:n="value",nameField:s="name",sortBy:a,sortOrder:o="desc",limit:c}=t;try{let l=[],u=new Set,h=new Set,f=this.data;t.filters&&t.filters.length>0&&(f=Ee.applyFilters(this.data,t.filters)),f.forEach((x,O)=>{let A=x[e]||O%10,D=x[i]||Math.floor(O/10),G=parseFloat(x[n])||0,te=x[s]||`${A}-${D}`,me=typeof A=="string"?this.getAxisIndex(A,u):A,M=typeof D=="string"?this.getAxisIndex(D,h):D;l.push({value:[me,M,G],name:te,originalItem:x}),typeof A=="string"&&u.add(A),typeof D=="string"&&h.add(D)}),a==="value"&&l.sort((x,O)=>o==="asc"?x.value[2]-O.value[2]:O.value[2]-x.value[2]),c&&c>0&&(l=l.slice(0,c)),this.seriesOptions.data=l,u.size>0&&this.setXAxisData(Array.from(u).sort()),h.size>0&&this.setYAxisData(Array.from(h).sort());let d=l.map(x=>x.value[2]),g=Math.min(...d),p=Math.max(...d);this.setVisualMap(g,p)}catch(l){console.error("Error transforming heatmap chart data:",l)}return this}getAxisIndex(t,e){let i=Array.from(e).sort(),n=i.indexOf(t);return n!==-1?n:i.length}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis=Y(F({},this.chartOptions.xAxis),{data:t}),this}setYAxisData(t){return this.yAxisData=t,this.chartOptions.yAxis=Y(F({},this.chartOptions.yAxis),{data:t}),this}setXAxisName(t){return this.chartOptions.xAxis=Y(F({},this.chartOptions.xAxis),{name:t}),this}setYAxisName(t){return this.chartOptions.yAxis=Y(F({},this.chartOptions.yAxis),{name:t}),this}setVisualMap(t,e,i,n=["High","Low"]){return this.chartOptions.visualMap=Y(F({},this.chartOptions.visualMap),{min:t,max:e,inRange:{color:i||["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffcc","#fee090","#fdae61","#f46d43","#d73027","#a50026"]},text:n}),this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&(this.chartOptions.visualMap=Y(F({},this.chartOptions.visualMap),{inRange:{color:e}})),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("item",n=>{let[s,a,o]=n.data.value;return`${n.data.name||`(${s}, ${a})`}: ${i(o)}`}),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("item",i=>{let[n,s,a]=i.data.value;return`${i.data.name||`(${n}, ${s})`}: ${e(a)}`}),this}setCustomNumberFormatter(t=1,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("item",n=>{let[s,a,o]=n.data.value;return`${n.data.name||`(${s}, ${a})`}: ${i(o)}`}),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=7,e=5){let i=[],n=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].slice(0,t),s=["Morning","Afternoon","Evening","Night","Late Night"].slice(0,e);for(let a=0;a<t;a++)for(let o=0;o<e;o++)i.push({x:n[a],y:s[o],value:Math.floor(Math.random()*100),category:["High","Medium","Low"][Math.floor(Math.random()*3)],department:["Sales","Marketing","Operations"][Math.floor(Math.random()*3)]});return this.setData(i)}setActivityAnalysisConfiguration(){return this.setPredefinedPalette("business").setCustomNumberFormatter(0,"en-US").setXAxisName("Time Period").setYAxisName("Activity Type").setVisualMapPosition("horizontal","center","5%")}setCorrelationAnalysisConfiguration(){return this.setPredefinedPalette("modern").setPercentageFormatter(2).setXAxisName("Variable X").setYAxisName("Variable Y").setVisualMapPosition("vertical","right","center")}setPerformanceMatrixConfiguration(){return this.setPredefinedPalette("finance").setCurrencyFormatter("USD","en-US").setXAxisName("Time").setYAxisName("Metrics").setVisualMapPosition("horizontal","center","bottom")}setVisualMapPosition(t="horizontal",e="center",i="5%"){return this.chartOptions.visualMap=Y(F({},this.chartOptions.visualMap),{orient:t,left:e,top:i}),this}setItemStyle(t="#fff",e=1){return this.seriesOptions.itemStyle={borderColor:t,borderWidth:e},this}setProgressive(t,e=3e3){return this.seriesOptions.progressive=t,this.seriesOptions.progressiveThreshold=e,this}setAnimation(t){return this.seriesOptions.animation=t,this}build(){let t=Y(F({},this.chartOptions),{series:[Y(F({},this.seriesOptions),{type:"heatmap"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map((l,u)=>F({value:[l.x||u%10,l.y||Math.floor(u/10),parseFloat(l.value)||0],name:l.name||`${l.x||u%10}-${l.y||Math.floor(u/10)}`},l)));let o=t.chartInstance.getOption(),c=Y(F({},o),{series:[Y(F({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating heatmap chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isHeatmapChart(t){return Ee.isChartType(t,"heatmap")}static createHeatmapChartWidget(t,e,i){let n=r.create();return t&&n.setData(t),e&&n.setXAxisData(e),i&&n.setYAxisData(i),n.getWidgetBuilder()}static exportData(t){let e=[];if(t.echart_options?.series?.[0]?.data){let i=t.echart_options.series[0].data,n=t.echart_options?.xAxis?.data||[],s=t.echart_options?.yAxis?.data||[];i.forEach(a=>{if(a&&a.value){let[o,c,l]=a.value;e.push({X:n[o]||o,Y:s[c]||c,Value:l,Name:a.name||`${o}-${c}`})}})}return e}static getExportHeaders(t){return["X","Y","Value","Name"]}static getExportSheetName(t){return"Heatmap Chart Data"}};var ns={MOBILE:480,TABLET:768,DESKTOP:1024,LARGE_DESKTOP:1440},At={MOBILE:{COLS:.5,ROWS:.8,WIDTH:.6,HEIGHT:1.2},TABLET:{COLS:.75,ROWS:.9,WIDTH:.8,HEIGHT:1},DESKTOP:{COLS:1,ROWS:1,WIDTH:1,HEIGHT:1},LARGE_DESKTOP:{COLS:1.33,ROWS:1.1,WIDTH:1.2,HEIGHT:.9}},Ie={MAX_COLS:12,MIN_COLS:1,MAX_ROWS:100,MIN_ROWS:1,FIXED_COL_WIDTH:100,FIXED_ROW_HEIGHT:50,MOBILE_BREAKPOINT:640},fo={MAX_COLS:Math.round(Ie.MAX_COLS*At.MOBILE.COLS),MIN_COLS:Math.round(Ie.MIN_COLS*At.MOBILE.COLS),MAX_ROWS:Math.round(Ie.MAX_ROWS*At.MOBILE.ROWS),MIN_ROWS:Math.round(Ie.MIN_ROWS*At.MOBILE.ROWS),FIXED_COL_WIDTH:Math.round(Ie.FIXED_COL_WIDTH*At.MOBILE.WIDTH),FIXED_ROW_HEIGHT:Math.round(Ie.FIXED_ROW_HEIGHT*At.MOBILE.HEIGHT),MOBILE_BREAKPOINT:ns.MOBILE},po={MAX_COLS:Math.round(Ie.MAX_COLS*At.TABLET.COLS),MIN_COLS:Math.round(Ie.MIN_COLS*At.TABLET.COLS),MAX_ROWS:Math.round(Ie.MAX_ROWS*At.TABLET.ROWS),MIN_ROWS:Math.round(Ie.MIN_ROWS*At.TABLET.ROWS),FIXED_COL_WIDTH:Math.round(Ie.FIXED_COL_WIDTH*At.TABLET.WIDTH),FIXED_ROW_HEIGHT:Math.round(Ie.FIXED_ROW_HEIGHT*At.TABLET.HEIGHT),MOBILE_BREAKPOINT:ns.TABLET},mo={MAX_COLS:Math.round(Ie.MAX_COLS*At.LARGE_DESKTOP.COLS),MIN_COLS:Math.round(Ie.MIN_COLS*At.LARGE_DESKTOP.COLS),MAX_ROWS:Math.round(Ie.MAX_ROWS*At.LARGE_DESKTOP.ROWS),MIN_ROWS:Math.round(Ie.MIN_ROWS*At.LARGE_DESKTOP.ROWS),FIXED_COL_WIDTH:Math.round(Ie.FIXED_COL_WIDTH*At.LARGE_DESKTOP.WIDTH),FIXED_ROW_HEIGHT:Math.round(Ie.FIXED_ROW_HEIGHT*At.LARGE_DESKTOP.HEIGHT),MOBILE_BREAKPOINT:ns.LARGE_DESKTOP},$i={COMPACT:{FIXED_COL_WIDTH:80,FIXED_ROW_HEIGHT:40,OUTER_MARGIN:!1},STANDARD:{FIXED_COL_WIDTH:Ie.FIXED_COL_WIDTH,FIXED_ROW_HEIGHT:Ie.FIXED_ROW_HEIGHT,OUTER_MARGIN:!0},SPACIOUS:{FIXED_COL_WIDTH:120,FIXED_ROW_HEIGHT:80,OUTER_MARGIN:!0}};function Tc(r){switch(r){case"MOBILE":return fo;case"TABLET":return po;case"DESKTOP":return Ie;case"LARGE_DESKTOP":return mo;default:return Ie}}var rr=function(r){return r.DENSITY_BLUE="density_blue",r.DENSITY_GREEN="density_green",r.DENSITY_RED="density_red",r.DENSITY_PURPLE="density_purple",r.DENSITY_ORANGE="density_orange",r.RAINBOW="rainbow",r.DIVERGING="diverging",r.CATEGORICAL="categorical",r.GRAYSCALE="grayscale",r.PROFIT_LOSS="profit_loss",r.PERFORMANCE="performance",r}(rr||{}),Cc={[rr.DENSITY_BLUE]:["#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],[rr.DENSITY_GREEN]:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],[rr.DENSITY_RED]:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],[rr.DENSITY_PURPLE]:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],[rr.DENSITY_ORANGE]:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],[rr.RAINBOW]:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],[rr.DIVERGING]:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],[rr.CATEGORICAL]:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],[rr.GRAYSCALE]:["#f7f7f7","#cccccc","#969696","#636363","#252525"],[rr.PROFIT_LOSS]:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91d47c","#4575b4"],[rr.PERFORMANCE]:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#41ab5d"]},go=function(r){return r.DENSITY_MAP="map",r.HEATMAP="heatmap",r.LINE="line",r.BAR="bar",r.PIE="pie",r.SCATTER="scatter",r.AREA="area",r.GAUGE="gauge",r.SANKEY="sankey",r.TREEMAP="treemap",r.SUNBURST="sunburst",r.POLAR="polar",r}(go||{}),xo=function(r){return r.WORLD="world",r.USA="usa",r.CHINA="china",r.JAPAN="japan",r.UK="uk",r.FRANCE="france",r.GERMANY="germany",r.ITALY="italy",r.SPAIN="spain",r.RUSSIA="russia",r.CANADA="canada",r.AUSTRALIA="australia",r.BRAZIL="brazil",r.INDIA="india",r}(xo||{});var Sc={WORLD:[0,30],NORTH_AMERICA:[-100,45],EUROPE:[10,50],ASIA:[100,30],AFRICA:[20,0],SOUTH_AMERICA:[-60,-15],OCEANIA:[140,-25]};function ta(r){return Cc[r]||Cc[rr.DENSITY_BLUE]}var wn=class r extends Ee{constructor(){super(),this.mapName="world",this.roamEnabled=!1,this.zoomLevel=1,this.centerCoords=[0,0],this.visualMapRange=[0,100],this.visualMapColors=ta(rr.DENSITY_BLUE),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}static registerMap(t,e){try{wc(t,e)}catch{}}static getAvailableMaps(){return Object.values(xo)}getDefaultOptions(){return{tooltip:{trigger:"item",formatter:"{b}: {c}"},legend:{show:!1},visualMap:{type:"continuous",min:0,max:100,left:"left",top:"bottom",text:["High","Low"],calculable:!0,inRange:{color:[...ta(rr.DENSITY_BLUE)]},textStyle:{color:"#333"}}}}getChartType(){return go.DENSITY_MAP}getDefaultSeriesOptions(){return{name:"Density Map",type:"map",map:"world",roam:!1,zoom:1,center:[0,0],label:{show:!1,position:"inside",formatter:"{b}",fontSize:12,color:"#333"},itemStyle:{areaColor:"#eee",borderColor:"#999",borderWidth:.5,shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.3)"},emphasis:{itemStyle:{areaColor:"#b8e186",shadowBlur:20,shadowColor:"rgba(0, 0, 0, 0.5)"}},select:{itemStyle:{areaColor:"#b8e186"}}}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setMap(t){return this.mapName=t,this.seriesOptions.map=t,this}setMapType(t){return this.setMap(t)}setRoam(t){return this.roamEnabled=t,this.seriesOptions.roam=t,this}setZoom(t){return this.zoomLevel=t,this.seriesOptions.zoom=t,this}setCenter(t){return this.centerCoords=t,this.seriesOptions.center=t,this}setVisualMap(t,e,i){return this.visualMapRange=[t,e],i&&(this.visualMapColors=i),this.chartOptions.visualMap={type:"continuous",min:t,max:e,left:"left",top:"bottom",text:["High","Low"],calculable:!0,inRange:{color:[...this.visualMapColors]},textStyle:{color:"#333"}},this}setColorScheme(t,e=0,i=100){return this.visualMapColors=ta(t),this.setVisualMap(e,i)}setLabelShow(t,e="inside",i){return this.seriesOptions.label={show:t,position:e,formatter:i||"{b}",fontSize:12,color:"#333"},this}setConditionalLabels(t=!0,e="inside",i,n=!0){return n?this.seriesOptions.label={show:!0,position:e,formatter:s=>typeof s.value=="number"&&isFinite(s.value)?i?i.replace("{b}",s.name).replace("{c}",s.value.toString()):`${s.name}
${s.value}`:"",fontSize:12,color:"#333"}:this.seriesOptions.label={show:t,position:e,formatter:i||`{b}
{c}`,fontSize:12,color:"#333"},this}setAreaColor(t){return this.seriesOptions.itemStyle=Y(F({},this.seriesOptions.itemStyle),{areaColor:t}),this}setBorderColor(t,e=.5){return this.seriesOptions.itemStyle=Y(F({},this.seriesOptions.itemStyle),{borderColor:t,borderWidth:e}),this}setEmphasisColor(t){return this.seriesOptions.emphasis={itemStyle:{areaColor:t,shadowBlur:20,shadowColor:"rgba(0, 0, 0, 0.5)"}},this}setShadow(t=10,e="rgba(0, 0, 0, 0.3)"){return this.seriesOptions.itemStyle=Y(F({},this.seriesOptions.itemStyle),{shadowBlur:t,shadowColor:e}),this}setVisualMapOptions(t){return this.chartOptions.visualMap=F(F({},this.chartOptions.visualMap),t),this}setGeoOptions(t){return this.chartOptions.geo=F(F({},this.chartOptions.geo),t),this}setPosition(t){super.setPosition(t);let e=this.calculateMapCenter(t.cols,t.rows);return this.setCenter(e),this}autoAdjustMapSettings(){let t=this.widgetBuilder.build().position;if(t){let e=this.calculateMapCenter(t.cols,t.rows),i=this.calculateMapZoom(t.cols,t.rows);this.setCenter(e)}return this}build(){return this.autoAdjustMapSettings(),this.seriesOptions=Y(F({},this.seriesOptions),{map:this.mapName,roam:this.roamEnabled,zoom:this.zoomLevel,center:this.centerCoords}),this.chartOptions.series=[this.seriesOptions],this.widgetBuilder.setEChartsOptions(this.chartOptions).build()}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",regionField:n="region",sortBy:s,sortOrder:a="desc",limit:o}=t;try{let c=[],l=this.data;t.filters&&t.filters.length>0&&(l=Ee.applyFilters(this.data,t.filters)),l.forEach(d=>{let g=d[e]||d[n]||"Unknown",p=parseFloat(d[i])||0;c.push({name:g,value:p,originalItem:d})}),s==="value"?c.sort((d,g)=>a==="asc"?d.value-g.value:g.value-d.value):s==="name"&&c.sort((d,g)=>a==="asc"?d.name.localeCompare(g.name):g.name.localeCompare(d.name)),o&&o>0&&(c=c.slice(0,o)),this.seriesOptions.data=c;let u=c.map(d=>d.value),h=Math.min(...u),f=Math.max(...u);this.setVisualMap(h,f)}catch(c){console.error("Error transforming density map data:",c)}return this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&this.setVisualMap(this.visualMapRange[0],this.visualMapRange[1],e),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("item",n=>`${n.name}: ${i(n.value)}`),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("item",i=>`${i.name}: ${e(i.value)}`),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("item",n=>`${n.name}: ${i(n.value)}`),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=10,e="world"){let i=[],n=e==="world"?["China","United States","India","Brazil","Russia","Japan","Germany","United Kingdom","France","Italy"]:["Region 1","Region 2","Region 3","Region 4","Region 5","Region 6","Region 7","Region 8","Region 9","Region 10"];for(let s=0;s<Math.min(t,n.length);s++)i.push({name:n[s],value:Math.floor(Math.random()*1e3)+100,density:Math.floor(Math.random()*500)+50,population:Math.floor(Math.random()*1e6)+1e5,category:["High","Medium","Low"][Math.floor(Math.random()*3)]});return this.setData(i)}setPopulationDensityConfiguration(){return this.setMap("world").setPredefinedPalette("business").setCustomNumberFormatter(0,"en-US").setVisualMapOptions({text:["High Density","Low Density"],orient:"vertical",left:"left",top:"center"})}setEconomicIndicatorsConfiguration(){return this.setMap("world").setPredefinedPalette("finance").setCurrencyFormatter("USD","en-US").setVisualMapOptions({text:["Highest","Lowest"],orient:"horizontal",left:"center",bottom:"10%"})}setRiskAssessmentConfiguration(){return this.setMap("world").setPredefinedPalette("modern").setPercentageFormatter(1).setVisualMapOptions({text:["High Risk","Low Risk"],orient:"vertical",right:"10%",top:"center"})}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>Y(F({},l),{name:l.name||"Unknown",value:typeof l.value=="number"?l.value:parseFloat(l.value)||0})));let o=t.chartInstance.getOption(),c=Y(F({},o),{series:[Y(F({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating density map data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static updateMapSettings(t,e){if(t.chartInstance)try{let i=t.chartInstance.getOption(),n=Y(F({},i),{series:i.series?.map(s=>Y(F({},s),{zoom:e?.zoom??s.zoom,center:e?.center??s.center,roam:e?.roam??s.roam}))});t.chartInstance.setOption(n,!0)}catch(i){console.error("Error updating density map settings:",i)}}static isDensityMap(t){return Ee.isChartType(t,"map")}static isDensityMapEnhanced(t){if(Ee.isChartType(t,"map"))return!0;let e=t.config?.options;if(e?.series?.[0]){let i=e.series[0];return i.type==="map"||i.map!==void 0}return!!e?.visualMap}static getDefaultData(){return[{name:"United States",value:100},{name:"China",value:85},{name:"Japan",value:70},{name:"Germany",value:65},{name:"United Kingdom",value:60},{name:"France",value:55},{name:"Canada",value:50},{name:"Australia",value:45},{name:"Brazil",value:40},{name:"India",value:35}]}static exportData(t){let e=t.config?.options?.series?.[0];return e?.data?e.data.map(i=>[i.name||"Unknown Region",i.value||0]):[]}static getExportHeaders(t){return["Region","Value"]}static getExportSheetName(t){return(t.config?.header?.title||"Sheet").replace(/[^\w\s]/gi,"").substring(0,31).trim()}static createDensityMapWidget(t,e){let i=r.create();return t&&i.setData(t),e&&i.setMap(e),i.getWidgetBuilder()}calculateMapCenter(t,e){let[i,n]=Sc.WORLD,s=t/e,a=s>1?(s-1)*5:0,o=s<1?(1/s-1)*2:0;return[i+a,n+o]}calculateMapZoom(t,e){let n=t*e,s=Math.log(n)/Math.log(2),a=t/e,o=Math.abs(1-a)*.5;return 4-s*.1-o}};var kc=["*"];function Zh(r,t){if(r&1&&he(0,"div",0),r&2){let e=t.$index,i=y();w("ngStyle",i.gridRenderer.getGridColumnStyle(e))}}function Jh(r,t){if(r&1&&he(0,"div",1),r&2){let e=t.$index,i=y();w("ngStyle",i.gridRenderer.getGridRowStyle(e))}}function ef(r,t){if(r&1){let e=ge();P(0,"div",8),ce("mousedown",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))})("touchstart",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))}),L()}}function tf(r,t){if(r&1){let e=ge();P(0,"div",9),ce("mousedown",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))})("touchstart",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))}),L()}}function rf(r,t){if(r&1){let e=ge();P(0,"div",10),ce("mousedown",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))})("touchstart",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))}),L()}}function nf(r,t){if(r&1){let e=ge();P(0,"div",11),ce("mousedown",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))})("touchstart",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))}),L()}}function sf(r,t){if(r&1){let e=ge();P(0,"div",12),ce("mousedown",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))})("touchstart",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))}),L()}}function af(r,t){if(r&1){let e=ge();P(0,"div",13),ce("mousedown",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))})("touchstart",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))}),L()}}function of(r,t){if(r&1){let e=ge();P(0,"div",14),ce("mousedown",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))})("touchstart",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))}),L()}}function lf(r,t){if(r&1){let e=ge();P(0,"div",15),ce("mousedown",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))})("touchstart",function(n){X(e);let s=y();return j(s.resize.dragStartDelay(n))}),L()}}var Me=function(r){return r.Fit="fit",r.ScrollVertical="scrollVertical",r.ScrollHorizontal="scrollHorizontal",r.Fixed="fixed",r.VerticalFixed="verticalFixed",r.HorizontalFixed="horizontalFixed",r}(Me||{}),Ti=function(r){return r.Always="always",r.OnDragAndResize="onDrag&Resize",r.None="none",r}(Ti||{}),it=function(r){return r.None="none",r.CompactUp="compactUp",r.CompactLeft="compactLeft",r.CompactUpAndLeft="compactUp&Left",r.CompactLeftAndUp="compactLeft&Up",r.CompactRight="compactRight",r.CompactUpAndRight="compactUp&Right",r.CompactRightAndUp="compactRight&Up",r.CompactDown="compactDown",r.CompactDownAndLeft="compactDown&Left",r.CompactLeftAndDown="compactLeft&Down",r.CompactDownAndRight="compactDown&Right",r.CompactRightAndDown="compactRight&Down",r}(it||{}),Ut=function(r){return r.LTR="ltr",r.RTL="rtl",r}(Ut||{}),_o=class{gridster;constructor(t){this.gridster=t}destroy(){this.gridster=null}checkCompact(){this.gridster.$options.compactType!==it.None&&(this.gridster.$options.compactType===it.CompactUp?this.checkCompactMovement("y",-1):this.gridster.$options.compactType===it.CompactLeft?this.checkCompactMovement("x",-1):this.gridster.$options.compactType===it.CompactUpAndLeft?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===it.CompactLeftAndUp?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===it.CompactRight?this.checkCompactMovement("x",1):this.gridster.$options.compactType===it.CompactUpAndRight?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===it.CompactRightAndUp?(this.checkCompactMovement("x",1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===it.CompactDown?this.checkCompactMovement("y",1):this.gridster.$options.compactType===it.CompactDownAndLeft?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===it.CompactDownAndRight?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===it.CompactLeftAndDown?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",1)):this.gridster.$options.compactType===it.CompactRightAndDown&&(this.checkCompactMovement("x",1),this.checkCompactMovement("y",1)))}checkCompactItem(t){this.gridster.$options.compactType!==it.None&&(this.gridster.$options.compactType===it.CompactUp?this.moveTillCollision(t,"y",-1):this.gridster.$options.compactType===it.CompactLeft?this.moveTillCollision(t,"x",-1):this.gridster.$options.compactType===it.CompactUpAndLeft?(this.moveTillCollision(t,"y",-1),this.moveTillCollision(t,"x",-1)):this.gridster.$options.compactType===it.CompactLeftAndUp?(this.moveTillCollision(t,"x",-1),this.moveTillCollision(t,"y",-1)):this.gridster.$options.compactType===it.CompactUpAndRight?(this.moveTillCollision(t,"y",-1),this.moveTillCollision(t,"x",1)):this.gridster.$options.compactType===it.CompactDown?this.moveTillCollision(t,"y",1):this.gridster.$options.compactType===it.CompactDownAndLeft?(this.moveTillCollision(t,"y",1),this.moveTillCollision(t,"x",-1)):this.gridster.$options.compactType===it.CompactLeftAndDown?(this.moveTillCollision(t,"x",-1),this.moveTillCollision(t,"y",1)):this.gridster.$options.compactType===it.CompactDownAndRight?(this.moveTillCollision(t,"y",1),this.moveTillCollision(t,"x",1)):this.gridster.$options.compactType===it.CompactRightAndDown&&(this.moveTillCollision(t,"x",1),this.moveTillCollision(t,"y",1)))}checkCompactMovement(t,e){let i=!1;this.gridster.grid.forEach(n=>{n.$item.compactEnabled!==!1&&this.moveTillCollision(n.$item,t,e)&&(i=!0,n.item[t]=n.$item[t],n.itemChanged())}),i&&this.checkCompact()}moveTillCollision(t,e,i){return t[e]+=i,this.gridster.checkCollision(t)?(t[e]-=i,!1):(this.moveTillCollision(t,e,i),!0)}},cf={gridType:Me.Fit,scale:1,fixedColWidth:250,fixedRowHeight:250,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,setGridSize:!1,compactType:it.None,mobileBreakpoint:640,useBodyForBreakpoint:!1,allowMultiLayer:!1,defaultLayerIndex:0,maxLayerIndex:2,baseLayerIndex:1,minCols:1,maxCols:100,minRows:1,maxRows:100,defaultItemCols:1,defaultItemRows:1,maxItemCols:50,maxItemRows:50,minItemCols:1,minItemRows:1,minItemArea:1,maxItemArea:2500,addEmptyRowsCount:0,rowHeightRatio:1,margin:10,outerMargin:!0,outerMarginTop:null,outerMarginRight:null,outerMarginBottom:null,outerMarginLeft:null,useTransformPositioning:!0,scrollSensitivity:10,scrollSpeed:20,initCallback:void 0,destroyCallback:void 0,gridSizeChangedCallback:void 0,itemChangeCallback:void 0,itemResizeCallback:void 0,itemInitCallback:void 0,itemRemovedCallback:void 0,itemValidateCallback:void 0,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,enableOccupiedCellDrop:!1,emptyCellClickCallback:void 0,emptyCellContextMenuCallback:void 0,emptyCellDropCallback:void 0,emptyCellDragCallback:void 0,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,draggable:{delayStart:0,enabled:!1,ignoreContentClass:"gridster-item-content",ignoreContent:!1,dragHandleClass:"drag-handler",stop:void 0,start:void 0,dropOverItems:!1,dropOverItemsCallback:void 0},resizable:{delayStart:0,enabled:!1,handles:{s:!0,e:!0,n:!0,w:!0,se:!0,ne:!0,sw:!0,nw:!0},stop:void 0,start:void 0},swap:!0,swapWhileDragging:!1,pushItems:!1,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushResizeItems:!1,displayGrid:Ti.OnDragAndResize,disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1,disableScrollHorizontal:!1,disableScrollVertical:!1,enableBoundaryControl:!1,disableAutoPositionOnConflict:!1,dirType:Ut.LTR},ir=class r{static merge(t,e,i){for(let n in e)e[n]!==void 0&&i.hasOwnProperty(n)&&(typeof e[n]=="object"?(n in t||(t[n]={}),t[n]=r.merge(t[n],e[n],i[n])):t[n]=e[n]);return t}static checkTouchEvent(t){t.clientX===void 0&&t.touches&&(t.touches&&t.touches.length?(t.clientX=t.touches[0].clientX,t.clientY=t.touches[0].clientY):t.changedTouches&&t.changedTouches.length&&(t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY))}static checkContentClassForEvent(t,e){if(t.$options.draggable.ignoreContent){if(!r.checkDragHandleClass(e.target,e.currentTarget,t.$options.draggable.dragHandleClass,t.$options.draggable.ignoreContentClass))return!0}else if(r.checkContentClass(e.target,e.currentTarget,t.$options.draggable.ignoreContentClass))return!0;return!1}static checkContentClassForEmptyCellClickEvent(t,e){return r.checkContentClass(e.target,e.currentTarget,t.$options.draggable.ignoreContentClass)||r.checkContentClass(e.target,e.currentTarget,t.$options.draggable.dragHandleClass)}static checkDragHandleClass(t,e,i,n){if(!t||t===e)return!1;if(t.hasAttribute("class")){let s=t.getAttribute("class").split(" ");if(s.indexOf(i)>-1)return!0;if(s.indexOf(n)>-1)return!1}return r.checkDragHandleClass(t.parentNode,e,i,n)}static checkContentClass(t,e,i){return!t||t===e?!1:t.hasAttribute("class")&&t.getAttribute("class").split(" ").indexOf(i)>-1?!0:r.checkContentClass(t.parentNode,e,i)}static compareItems(t,e){return t.y>e.y?-1:t.y<e.y?1:t.x>e.x?-1:1}},vo=class{gridster;initialItem;removeEmptyCellClickListenerFn;removeEmptyCellTouchendListenerFn;removeEmptyCellContextMenuListenerFn;removeEmptyCellDropListenerFn;removeEmptyCellMousedownListenerFn;removeEmptyCellTouchstartListenerFn;removeWindowMousemoveListenerFn;removeWindowTouchmoveListenerFn;removeWindowMouseupListenerFn;removeWindowTouchendListenerFn;removeEmptyCellDragoverListenerFn;removeDocumentDragendListenerFn;constructor(t){this.gridster=t}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(),this.gridster.movingItem=null,this.initialItem=this.gridster=null,this.removeDocumentDragendListenerFn&&(this.removeDocumentDragendListenerFn(),this.removeDocumentDragendListenerFn=null)}updateOptions(){this.gridster.$options.enableEmptyCellClick&&!this.removeEmptyCellClickListenerFn&&this.gridster.options.emptyCellClickCallback?(this.removeEmptyCellClickListenerFn=this.gridster.renderer.listen(this.gridster.el,"click",this.emptyCellClickCb),this.removeEmptyCellTouchendListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchend",this.emptyCellClickCb)):!this.gridster.$options.enableEmptyCellClick&&this.removeEmptyCellClickListenerFn&&this.removeEmptyCellTouchendListenerFn&&(this.removeEmptyCellClickListenerFn(),this.removeEmptyCellTouchendListenerFn(),this.removeEmptyCellClickListenerFn=null,this.removeEmptyCellTouchendListenerFn=null),this.gridster.$options.enableEmptyCellContextMenu&&!this.removeEmptyCellContextMenuListenerFn&&this.gridster.options.emptyCellContextMenuCallback?this.removeEmptyCellContextMenuListenerFn=this.gridster.renderer.listen(this.gridster.el,"contextmenu",this.emptyCellContextMenuCb):!this.gridster.$options.enableEmptyCellContextMenu&&this.removeEmptyCellContextMenuListenerFn&&(this.removeEmptyCellContextMenuListenerFn(),this.removeEmptyCellContextMenuListenerFn=null),this.gridster.$options.enableEmptyCellDrop&&!this.removeEmptyCellDropListenerFn&&this.gridster.options.emptyCellDropCallback?(this.removeEmptyCellDropListenerFn=this.gridster.renderer.listen(this.gridster.el,"drop",this.emptyCellDragDrop),this.gridster.zone.runOutsideAngular(()=>{this.removeEmptyCellDragoverListenerFn=this.gridster.renderer.listen(this.gridster.el,"dragover",this.emptyCellDragOver)}),this.removeDocumentDragendListenerFn=this.gridster.renderer.listen("document","dragend",()=>{this.gridster.movingItem=null,this.gridster.previewStyle()})):!this.gridster.$options.enableEmptyCellDrop&&this.removeEmptyCellDropListenerFn&&this.removeEmptyCellDragoverListenerFn&&this.removeDocumentDragendListenerFn&&(this.removeEmptyCellDropListenerFn(),this.removeEmptyCellDragoverListenerFn(),this.removeDocumentDragendListenerFn(),this.removeEmptyCellDragoverListenerFn=null,this.removeEmptyCellDropListenerFn=null,this.removeDocumentDragendListenerFn=null),this.gridster.$options.enableEmptyCellDrag&&!this.removeEmptyCellMousedownListenerFn&&this.gridster.options.emptyCellDragCallback?(this.removeEmptyCellMousedownListenerFn=this.gridster.renderer.listen(this.gridster.el,"mousedown",this.emptyCellMouseDown),this.removeEmptyCellTouchstartListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchstart",this.emptyCellMouseDown)):!this.gridster.$options.enableEmptyCellDrag&&this.removeEmptyCellMousedownListenerFn&&this.removeEmptyCellTouchstartListenerFn&&(this.removeEmptyCellMousedownListenerFn(),this.removeEmptyCellTouchstartListenerFn(),this.removeEmptyCellMousedownListenerFn=null,this.removeEmptyCellTouchstartListenerFn=null)}emptyCellClickCb=t=>{if(!this.gridster||this.gridster.movingItem||ir.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;let e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellClickCallback&&this.gridster.options.emptyCellClickCallback(t,e),this.gridster.cdRef.markForCheck())};emptyCellContextMenuCb=t=>{if(this.gridster.movingItem||ir.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellContextMenuCallback&&this.gridster.options.emptyCellContextMenuCallback(t,e),this.gridster.cdRef.markForCheck())};emptyCellDragDrop=t=>{let e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellDropCallback&&this.gridster.options.emptyCellDropCallback(t,e),this.gridster.cdRef.markForCheck())};emptyCellDragOver=t=>{t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t);e?(t.dataTransfer&&(t.dataTransfer.dropEffect="move"),this.gridster.movingItem=e):(t.dataTransfer&&(t.dataTransfer.dropEffect="none"),this.gridster.movingItem=null),this.gridster.previewStyle()};emptyCellMouseDown=t=>{if(ir.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t);!e||t.buttons!==1&&!(t instanceof TouchEvent)||(this.initialItem=e,this.gridster.movingItem=e,this.gridster.previewStyle(),this.gridster.zone.runOutsideAngular(()=>{this.removeWindowMousemoveListenerFn=this.gridster.renderer.listen("window","mousemove",this.emptyCellMouseMove),this.removeWindowTouchmoveListenerFn=this.gridster.renderer.listen("window","touchmove",this.emptyCellMouseMove)}),this.removeWindowMouseupListenerFn=this.gridster.renderer.listen("window","mouseup",this.emptyCellMouseUp),this.removeWindowTouchendListenerFn=this.gridster.renderer.listen("window","touchend",this.emptyCellMouseUp))};emptyCellMouseMove=t=>{t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t,this.initialItem);e&&(this.gridster.movingItem=e,this.gridster.previewStyle())};emptyCellMouseUp=t=>{this.removeWindowMousemoveListenerFn(),this.removeWindowTouchmoveListenerFn(),this.removeWindowMouseupListenerFn(),this.removeWindowTouchendListenerFn();let e=this.getValidItemFromEvent(t,this.initialItem);e&&(this.gridster.movingItem=e),this.gridster.options.emptyCellDragCallback&&this.gridster.movingItem&&this.gridster.options.emptyCellDragCallback(t,this.gridster.movingItem),setTimeout(()=>{this.initialItem=null,this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())}),this.gridster.cdRef.markForCheck()};getPixelsX(t,e){let i=this.gridster.options.scale;return i?(t.clientX-e.left)/i+this.gridster.el.scrollLeft-this.gridster.gridRenderer.getLeftMargin():t.clientX+this.gridster.el.scrollLeft-e.left-this.gridster.gridRenderer.getLeftMargin()}getPixelsY(t,e){let i=this.gridster.options.scale;return i?(t.clientY-e.top)/i+this.gridster.el.scrollTop-this.gridster.gridRenderer.getTopMargin():t.clientY+this.gridster.el.scrollTop-e.top-this.gridster.gridRenderer.getTopMargin()}getValidItemFromEvent(t,e){t.preventDefault(),t.stopPropagation(),ir.checkTouchEvent(t);let i=this.gridster.el.getBoundingClientRect(),n=this.getPixelsX(t,i),s=this.getPixelsY(t,i),a={x:this.gridster.pixelsToPositionX(n,Math.floor,!0),y:this.gridster.pixelsToPositionY(s,Math.floor,!0),cols:this.gridster.$options.defaultItemCols,rows:this.gridster.$options.defaultItemRows};if(e&&(a.cols=Math.min(Math.abs(e.x-a.x)+1,this.gridster.$options.emptyCellDragMaxCols),a.rows=Math.min(Math.abs(e.y-a.y)+1,this.gridster.$options.emptyCellDragMaxRows),e.x<a.x?a.x=e.x:e.x-a.x>this.gridster.$options.emptyCellDragMaxCols-1&&(a.x=this.gridster.movingItem?this.gridster.movingItem.x:0),e.y<a.y?a.y=e.y:e.y-a.y>this.gridster.$options.emptyCellDragMaxRows-1&&(a.y=this.gridster.movingItem?this.gridster.movingItem.y:0)),!(!this.gridster.$options.enableOccupiedCellDrop&&this.gridster.checkCollision(a)))return a}},yo=class{gridster;lastGridColumnStyles={};lastGridRowStyles={};constructor(t){this.gridster=t}destroy(){this.gridster=null}updateItem(t,e,i){if(this.gridster.mobile)this.clearCellPosition(i,t),this.gridster.$options.keepFixedHeightInMobile?i.setStyle(t,"height",(e.rows-1)*this.gridster.$options.margin+e.rows*this.gridster.$options.fixedRowHeight+"px"):i.setStyle(t,"height",e.rows*this.gridster.curWidth/e.cols+"px"),this.gridster.$options.keepFixedWidthInMobile?i.setStyle(t,"width",this.gridster.$options.fixedColWidth+"px"):i.setStyle(t,"width",""),i.setStyle(t,"margin-bottom",this.gridster.$options.margin+"px"),i.setStyle(t,Ut.LTR?"margin-right":"margin-left","");else{let n=Math.round(this.gridster.curColWidth*e.x),s=Math.round(this.gridster.curRowHeight*e.y),a=this.gridster.curColWidth*e.cols-this.gridster.$options.margin,o=this.gridster.curRowHeight*e.rows-this.gridster.$options.margin;this.setCellPosition(i,t,n,s),i.setStyle(t,"width",a+"px"),i.setStyle(t,"height",o+"px");let c=null,l=null;this.gridster.$options.outerMargin&&(this.gridster.rows===e.rows+e.y&&(this.gridster.$options.outerMarginBottom!==null?c=this.gridster.$options.outerMarginBottom+"px":c=this.gridster.$options.margin+"px"),this.gridster.columns===e.cols+e.x&&(this.gridster.$options.outerMarginBottom!==null?l=this.gridster.$options.outerMarginRight+"px":l=this.gridster.$options.margin+"px")),i.setStyle(t,"margin-bottom",c),i.setStyle(t,Ut.LTR?"margin-right":"margin-left",l)}}updateGridster(){let t="",e="",i="",n="";if(this.gridster.$options.gridType===Me.Fit)t=Me.Fit,e=Me.ScrollVertical,i=Me.ScrollHorizontal,n=Me.Fixed;else if(this.gridster.$options.gridType===Me.ScrollVertical)this.gridster.curRowHeight=this.gridster.curColWidth*this.gridster.$options.rowHeightRatio,t=Me.ScrollVertical,e=Me.Fit,i=Me.ScrollHorizontal,n=Me.Fixed;else if(this.gridster.$options.gridType===Me.ScrollHorizontal){let s=this.gridster.$options.rowHeightRatio,a=s>=1?s:s+1;this.gridster.curColWidth=this.gridster.curRowHeight*a,t=Me.ScrollHorizontal,e=Me.Fit,i=Me.ScrollVertical,n=Me.Fixed}else this.gridster.$options.gridType===Me.Fixed?(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),t=Me.Fixed,e=Me.Fit,i=Me.ScrollVertical,n=Me.ScrollHorizontal):this.gridster.$options.gridType===Me.VerticalFixed?(this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),t=Me.ScrollVertical,e=Me.Fit,i=Me.ScrollHorizontal,n=Me.Fixed):this.gridster.$options.gridType===Me.HorizontalFixed&&(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),t=Me.ScrollHorizontal,e=Me.Fit,i=Me.ScrollVertical,n=Me.Fixed);this.gridster.mobile||this.gridster.$options.setGridSize&&this.gridster.$options.gridType!==Me.Fit?this.gridster.renderer.removeClass(this.gridster.el,t):this.gridster.renderer.addClass(this.gridster.el,t),this.gridster.renderer.removeClass(this.gridster.el,e),this.gridster.renderer.removeClass(this.gridster.el,i),this.gridster.renderer.removeClass(this.gridster.el,n)}getGridColumnStyle(t){let e={left:this.gridster.curColWidth*t,width:this.gridster.curColWidth-this.gridster.$options.margin,height:this.gridster.gridRows.length*this.gridster.curRowHeight-this.gridster.$options.margin,style:{}};e.style=Y(F({},this.getLeftPosition(e.left)),{width:e.width+"px",height:e.height+"px"});let i=this.lastGridColumnStyles[t];return i&&i.left===e.left&&i.width===e.width&&i.height===e.height?i.style:(this.lastGridColumnStyles[t]=e,e.style)}getGridRowStyle(t){let e={top:this.gridster.curRowHeight*t,width:this.gridster.gridColumns.length*this.gridster.curColWidth+this.gridster.$options.margin,height:this.gridster.curRowHeight-this.gridster.$options.margin,style:{}};e.style=Y(F({},this.getTopPosition(e.top)),{width:e.width+"px",height:e.height+"px"});let i=this.lastGridRowStyles[t];return i&&i.top===e.top&&i.width===e.width&&i.height===e.height?i.style:(this.lastGridRowStyles[t]=e,e.style)}getLeftPosition(t){let e=this.gridster.$options.dirType===Ut.RTL?-t:t;return this.gridster.$options.useTransformPositioning?{transform:"translateX("+e+"px)"}:{left:this.getLeftMargin()+e+"px"}}getTopPosition(t){return this.gridster.$options.useTransformPositioning?{transform:"translateY("+t+"px)"}:{top:this.getTopMargin()+t+"px"}}clearCellPosition(t,e){this.gridster.$options.useTransformPositioning?t.setStyle(e,"transform",""):(t.setStyle(e,"top",""),t.setStyle(e,"left",""))}setCellPosition(t,e,i,n){let s=this.gridster.$options.dirType===Ut.RTL?-i:i;if(this.gridster.$options.useTransformPositioning){let a="translate3d("+s+"px, "+n+"px, 0)";t.setStyle(e,"transform",a)}else t.setStyle(e,"left",this.getLeftMargin()+s+"px"),t.setStyle(e,"top",this.getTopMargin()+n+"px")}getLeftMargin(){return this.gridster.$options.outerMargin?this.gridster.$options.outerMarginLeft!==null?this.gridster.$options.outerMarginLeft:this.gridster.$options.margin:0}getTopMargin(){return this.gridster.$options.outerMargin?this.gridster.$options.outerMarginTop!==null?this.gridster.$options.outerMarginTop:this.gridster.$options.margin:0}},uf=(()=>{class r{renderer;previewStyle$;gridRenderer;el;sub;constructor(e,i){this.renderer=i,this.el=e.nativeElement}ngOnInit(){this.sub=this.previewStyle$.subscribe(e=>this.previewStyle(e))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}previewStyle(e){e?(this.renderer.setStyle(this.el,"display","block"),this.gridRenderer.updateItem(this.el,e,this.renderer)):this.renderer.setStyle(this.el,"display","")}static \u0275fac=function(i){return new(i||r)(ze(oi),ze(Li))};static \u0275cmp=Oe({type:r,selectors:[["gridster-preview"]],inputs:{previewStyle$:"previewStyle$",gridRenderer:"gridRenderer"},decls:0,vars:0,template:function(i,n){},styles:[`gridster-preview{position:absolute;display:none;background:#00000026}
`],encapsulation:2})}return r})(),ia=(()=>{class r{renderer;cdRef;zone;options;movingItem;el;$options;mobile;curWidth;curHeight;grid;columns=0;rows=0;curColWidth;curRowHeight;gridColumns=[];gridRows=[];windowResize;dragInProgress;emptyCell;compact;gridRenderer;previewStyle$=new ve;calculateLayout$=new en;resize$=new en;destroy$=new en;constructor(e,i,n,s){this.renderer=i,this.cdRef=n,this.zone=s,this.el=e.nativeElement,this.$options=JSON.parse(JSON.stringify(cf)),this.mobile=!1,this.curWidth=0,this.curHeight=0,this.grid=[],this.curColWidth=0,this.curRowHeight=0,this.dragInProgress=!1,this.emptyCell=new vo(this),this.compact=new _o(this),this.gridRenderer=new yo(this)}static checkCollisionTwoItemsForSwaping(e,i){let n=e.cols===1?0:1,s=i.cols===1?0:1,a=e.rows===1?0:1,o=i.rows===1?0:1;return e.x+n<i.x+i.cols&&e.x+e.cols>i.x+s&&e.y+a<i.y+i.rows&&e.y+e.rows>i.y+o}checkCollisionTwoItems(e,i){if(!(e.x<i.x+i.cols&&e.x+e.cols>i.x&&e.y<i.y+i.rows&&e.y+e.rows>i.y))return!1;if(!this.$options.allowMultiLayer)return!0;let s=this.$options.defaultLayerIndex,a=e.layerIndex===void 0?s:e.layerIndex,o=i.layerIndex===void 0?s:i.layerIndex;return a===o}ngOnInit(){this.options.initCallback&&this.options.initCallback(this),this.calculateLayout$.pipe(Ml(0),Yn(this.destroy$)).subscribe(()=>this.calculateLayout()),this.resize$.pipe(Ls(()=>Dl(100)),Yn(this.destroy$)).subscribe(()=>this.resize())}ngOnChanges(e){e.options&&(this.setOptions(),this.options.api={optionsChanged:this.optionsChanged,resize:this.onResize,getNextPossiblePosition:this.getNextPossiblePosition,getFirstPossiblePosition:this.getFirstPossiblePosition,getLastPossiblePosition:this.getLastPossiblePosition,getItemComponent:i=>this.getItemComponent(i)},this.columns=this.$options.minCols,this.rows=this.$options.minRows+this.$options.addEmptyRowsCount,this.setGridSize(),this.calculateLayout())}resize(){let e,i;this.$options.gridType==="fit"&&!this.mobile?(i=this.el.offsetWidth,e=this.el.offsetHeight):(i=this.el.clientWidth,e=this.el.clientHeight),(i!==this.curWidth||e!==this.curHeight)&&this.checkIfToResize()&&this.onResize()}setOptions(){this.$options=ir.merge(this.$options,this.options,this.$options),!this.$options.disableWindowResize&&!this.windowResize?this.windowResize=this.renderer.listen("window","resize",this.onResize):this.$options.disableWindowResize&&this.windowResize&&(this.windowResize(),this.windowResize=null),this.emptyCell.updateOptions()}optionsChanged=()=>{this.setOptions();let e=this.grid.length-1,i;for(;e>=0;e--)i=this.grid[e],i.updateOptions();this.calculateLayout()};ngOnDestroy(){this.destroy$.next(),this.previewStyle$.complete(),this.windowResize&&this.windowResize(),this.options&&this.options.destroyCallback&&this.options.destroyCallback(this),this.options&&this.options.api&&(this.options.api.resize=void 0,this.options.api.optionsChanged=void 0,this.options.api.getNextPossiblePosition=void 0,this.options.api=void 0),this.emptyCell.destroy(),this.emptyCell=null,this.compact.destroy(),this.compact=null}onResize=()=>{this.el.clientWidth&&(this.options.setGridSize&&(this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.setGridSize(),this.calculateLayout())};checkIfToResize(){let e=this.el.clientWidth,i=this.el.offsetWidth,n=this.el.scrollWidth,s=this.el.clientHeight,a=this.el.offsetHeight,o=this.el.scrollHeight,c=e<i&&o>a&&o-a<i-e,l=s<a&&n>i&&n-i<a-s;return c?!1:!l}checkIfMobile(){return this.$options.useBodyForBreakpoint?this.$options.mobileBreakpoint>document.body.clientWidth:this.$options.mobileBreakpoint>this.curWidth}setGridSize(){let e=this.el,i,n;this.$options.setGridSize||this.$options.gridType===Me.Fit&&!this.mobile?(i=e.offsetWidth,n=e.offsetHeight):(i=e.clientWidth,n=e.clientHeight),this.curWidth=i,this.curHeight=n}setGridDimensions(){this.setGridSize(),!this.mobile&&this.checkIfMobile()?(this.mobile=!this.mobile,this.renderer.addClass(this.el,"mobile")):this.mobile&&!this.checkIfMobile()&&(this.mobile=!this.mobile,this.renderer.removeClass(this.el,"mobile"));let e=this.$options.minRows,i=this.$options.minCols,n=this.grid.length-1,s;for(;n>=0;n--)s=this.grid[n],s.notPlaced||(e=Math.max(e,s.$item.y+s.$item.rows),i=Math.max(i,s.$item.x+s.$item.cols));e+=this.$options.addEmptyRowsCount,(this.columns!==i||this.rows!==e)&&(this.columns=i,this.rows=e,this.options.gridSizeChangedCallback&&this.options.gridSizeChangedCallback(this))}calculateLayout(){if(this.compact&&this.compact.checkCompact(),this.setGridDimensions(),this.$options.outerMargin){let n=-this.$options.margin;this.$options.outerMarginLeft!==null?(n+=this.$options.outerMarginLeft,this.renderer.setStyle(this.el,"padding-left",this.$options.outerMarginLeft+"px")):(n+=this.$options.margin,this.renderer.setStyle(this.el,"padding-left",this.$options.margin+"px")),this.$options.outerMarginRight!==null?(n+=this.$options.outerMarginRight,this.renderer.setStyle(this.el,"padding-right",this.$options.outerMarginRight+"px")):(n+=this.$options.margin,this.renderer.setStyle(this.el,"padding-right",this.$options.margin+"px")),this.curColWidth=(this.curWidth-n)/this.columns;let s=-this.$options.margin;this.$options.outerMarginTop!==null?(s+=this.$options.outerMarginTop,this.renderer.setStyle(this.el,"padding-top",this.$options.outerMarginTop+"px")):(s+=this.$options.margin,this.renderer.setStyle(this.el,"padding-top",this.$options.margin+"px")),this.$options.outerMarginBottom!==null?(s+=this.$options.outerMarginBottom,this.renderer.setStyle(this.el,"padding-bottom",this.$options.outerMarginBottom+"px")):(s+=this.$options.margin,this.renderer.setStyle(this.el,"padding-bottom",this.$options.margin+"px")),this.curRowHeight=(this.curHeight-s)/this.rows*this.$options.rowHeightRatio}else this.curColWidth=(this.curWidth+this.$options.margin)/this.columns,this.curRowHeight=(this.curHeight+this.$options.margin)/this.rows*this.$options.rowHeightRatio,this.renderer.setStyle(this.el,"padding-left","0px"),this.renderer.setStyle(this.el,"padding-right","0px"),this.renderer.setStyle(this.el,"padding-top","0px"),this.renderer.setStyle(this.el,"padding-bottom","0px");this.gridRenderer.updateGridster(),this.$options.setGridSize?(this.renderer.addClass(this.el,"gridSize"),this.mobile||(this.renderer.setStyle(this.el,"width",this.columns*this.curColWidth+this.$options.margin+"px"),this.renderer.setStyle(this.el,"height",this.rows*this.curRowHeight+this.$options.margin+"px"))):(this.renderer.removeClass(this.el,"gridSize"),this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.updateGrid();let e=this.grid.length-1,i;for(;e>=0;e--)i=this.grid[e],i.setSize(),i.drag.toggle(),i.resize.toggle();this.resize$.next()}updateGrid(){this.$options.displayGrid==="always"&&!this.mobile?this.renderer.addClass(this.el,"display-grid"):this.$options.displayGrid==="onDrag&Resize"&&this.dragInProgress?this.renderer.addClass(this.el,"display-grid"):(this.$options.displayGrid==="none"||!this.dragInProgress||this.mobile)&&this.renderer.removeClass(this.el,"display-grid"),this.setGridDimensions(),this.gridColumns.length=r.getNewArrayLength(this.columns,this.curWidth,this.curColWidth),this.gridRows.length=r.getNewArrayLength(this.rows,this.curHeight,this.curRowHeight),this.cdRef.markForCheck()}addItem(e){e.$item.cols===void 0&&(e.$item.cols=this.$options.defaultItemCols,e.item.cols=e.$item.cols,e.itemChanged()),e.$item.rows===void 0&&(e.$item.rows=this.$options.defaultItemRows,e.item.rows=e.$item.rows,e.itemChanged()),e.$item.x===-1||e.$item.y===-1?this.autoPositionItem(e):this.checkCollision(e.$item)&&(this.$options.disableWarnings||(e.notPlaced=!0,console.warn("Can't be placed in the bounds of the dashboard, trying to auto position!/n"+JSON.stringify(e.item,["cols","rows","x","y"]))),this.$options.disableAutoPositionOnConflict?e.notPlaced=!0:this.autoPositionItem(e)),this.grid.push(e),this.calculateLayout$.next()}removeItem(e){this.grid.splice(this.grid.indexOf(e),1),this.calculateLayout$.next(),this.options.itemRemovedCallback&&this.options.itemRemovedCallback(e.item,e)}checkCollision(e){let i=!1;if(this.options.itemValidateCallback&&(i=!this.options.itemValidateCallback(e)),!i&&this.checkGridCollision(e)&&(i=!0),!i){let n=this.findItemWithItem(e);n&&(i=n)}return i}checkGridCollision(e){let i=e.y>-1&&e.x>-1,n=e.cols+e.x<=this.$options.maxCols,s=e.rows+e.y<=this.$options.maxRows,a=e.maxItemCols===void 0?this.$options.maxItemCols:e.maxItemCols,o=e.minItemCols===void 0?this.$options.minItemCols:e.minItemCols,c=e.maxItemRows===void 0?this.$options.maxItemRows:e.maxItemRows,l=e.minItemRows===void 0?this.$options.minItemRows:e.minItemRows,u=e.cols<=a&&e.cols>=o,h=e.rows<=c&&e.rows>=l,f=e.minItemArea===void 0?this.$options.minItemArea:e.minItemArea,d=e.maxItemArea===void 0?this.$options.maxItemArea:e.maxItemArea,g=e.cols*e.rows,p=f<=g,x=d>=g;return!(i&&n&&s&&u&&h&&p&&x)}findItemWithItem(e){let i=0,n;for(;i<this.grid.length;i++)if(n=this.grid[i],n.$item!==e&&this.checkCollisionTwoItems(n.$item,e))return n;return!1}findItemsWithItem(e){let i=[],n=0,s;for(;n<this.grid.length;n++)s=this.grid[n],s.$item!==e&&this.checkCollisionTwoItems(s.$item,e)&&i.push(s);return i}autoPositionItem(e){this.getNextPossiblePosition(e.$item)?(e.notPlaced=!1,e.item.x=e.$item.x,e.item.y=e.$item.y,e.itemChanged()):(e.notPlaced=!0,this.$options.disableWarnings||console.warn("Can't be placed in the bounds of the dashboard!/n"+JSON.stringify(e.item,["cols","rows","x","y"])))}getNextPossiblePosition=(e,i={})=>{e.cols===-1&&(e.cols=this.$options.defaultItemCols),e.rows===-1&&(e.rows=this.$options.defaultItemRows),this.setGridDimensions();let n=i.y||0,s;for(;n<this.rows;n++)for(e.y=n,s=i.x||0;s<this.columns;s++)if(e.x=s,!this.checkCollision(e))return!0;let a=this.$options.maxRows>=this.rows+e.rows,o=this.$options.maxCols>=this.columns+e.cols;return!(this.rows<=this.columns&&a)&&o?(e.x=this.columns,e.y=0,!0):a?(e.y=this.rows,e.x=0,!0):!1};getFirstPossiblePosition=e=>{let i=Object.assign({},e);return this.getNextPossiblePosition(i),i};getLastPossiblePosition=e=>{let i={y:0,x:0};i=this.grid.reduce((s,a)=>{let o={y:a.$item.y+a.$item.rows-1,x:a.$item.x+a.$item.cols-1};return ir.compareItems(s,o)===1?o:s},i);let n=Object.assign({},e);return this.getNextPossiblePosition(n,i),n};pixelsToPositionX(e,i,n){let s=i(e/this.curColWidth);return n?s:Math.max(s,0)}pixelsToPositionY(e,i,n){let s=i(e/this.curRowHeight);return n?s:Math.max(s,0)}positionXToPixels(e){return e*this.curColWidth}positionYToPixels(e){return e*this.curRowHeight}getItemComponent(e){return this.grid.find(i=>i.item===e)}checkCollisionForSwaping(e){let i=!1;if(this.options.itemValidateCallback&&(i=!this.options.itemValidateCallback(e)),!i&&this.checkGridCollision(e)&&(i=!0),!i){let n=this.findItemWithItemForSwapping(e);n&&(i=n)}return i}findItemWithItemForSwapping(e){let i=this.grid.length-1,n;for(;i>-1;i--)if(n=this.grid[i],n.$item!==e&&r.checkCollisionTwoItemsForSwaping(n.$item,e))return n;return!1}previewStyle(e=!1){this.movingItem?(this.compact&&e&&this.compact.checkCompactItem(this.movingItem),this.previewStyle$.next(this.movingItem)):this.previewStyle$.next(null)}static getNewArrayLength(e,i,n){let s=Math.max(e,Math.floor(i/n));return s<0?0:Number.isFinite(s)?Math.floor(s):0}static \u0275fac=function(i){return new(i||r)(ze(oi),ze(Li),ze(on),ze(Ri))};static \u0275cmp=Oe({type:r,selectors:[["gridster"]],inputs:{options:"options"},features:[ai],ngContentSelectors:kc,decls:6,vars:2,consts:[[1,"gridster-column",3,"ngStyle"],[1,"gridster-row",3,"ngStyle"],[1,"gridster-preview",3,"gridRenderer","previewStyle$"]],template:function(i,n){i&1&&(Vi(),Ni(0,Zh,1,1,"div",0,qa),Ni(2,Jh,1,1,"div",1,qa),li(4),he(5,"gridster-preview",2)),i&2&&(Bi(n.gridColumns),S(2),Bi(n.gridRows),S(3),w("gridRenderer",n.gridRenderer)("previewStyle$",n.previewStyle$))},dependencies:[St,uf],styles:[`gridster{position:relative;box-sizing:border-box;background:gray;width:100%;height:100%;-webkit-user-select:none;user-select:none;display:block}gridster.fit{overflow-x:hidden;overflow-y:hidden}gridster.scrollVertical{overflow-x:hidden;overflow-y:auto}gridster.scrollHorizontal{overflow-x:auto;overflow-y:hidden}gridster.fixed{overflow:auto}gridster.mobile{overflow-x:hidden;overflow-y:auto}gridster.mobile gridster-item{position:relative}gridster.gridSize{height:initial;width:initial}gridster.gridSize.fit{height:100%;width:100%}gridster .gridster-column,gridster .gridster-row{position:absolute;display:none;transition:.3s;box-sizing:border-box}gridster.display-grid .gridster-column,gridster.display-grid .gridster-row{display:block}gridster .gridster-column{border-left:1px solid white;border-right:1px solid white}gridster .gridster-row{border-top:1px solid white;border-bottom:1px solid white}
`],encapsulation:2})}return r})(),ra=class{fromSouth;fromNorth;fromEast;fromWest;pushedItems;pushedItemsTemp;pushedItemsTempPath;pushedItemsPath;gridsterItem;gridster;pushedItemsOrder;tryPattern;iteration=0;constructor(t){this.pushedItems=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],this.pushedItemsPath=[],this.gridsterItem=t,this.gridster=t.gridster,this.tryPattern={fromEast:[this.tryWest,this.trySouth,this.tryNorth,this.tryEast],fromWest:[this.tryEast,this.trySouth,this.tryNorth,this.tryWest],fromNorth:[this.trySouth,this.tryEast,this.tryWest,this.tryNorth],fromSouth:[this.tryNorth,this.tryEast,this.tryWest,this.trySouth]},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(t,e){if(this.gridster.$options.pushItems&&!e){this.pushedItemsOrder=[],this.iteration=0;let i=this.push(this.gridsterItem,t);return i||this.restoreTempItems(),this.pushedItemsOrder=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],i}else return!1}restoreTempItems(){let t=this.pushedItemsTemp.length-1;for(;t>-1;t--)this.removeFromTempPushed(this.pushedItemsTemp[t])}restoreItems(){let t=0,e=this.pushedItems.length,i;for(;t<e;t++)i=this.pushedItems[t],i.$item.x=i.item.x||0,i.$item.y=i.item.y||0,i.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let t=0,e=this.pushedItems.length,i;for(;t<e;t++)i=this.pushedItems[t],i.checkItemChanges(i.$item,i.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let t=this.pushedItems.length-1,e=!1;for(;t>-1;t--)this.checkPushedItem(this.pushedItems[t],t)&&(e=!0);e&&this.checkPushBack()}push(t,e){if(this.iteration>100)return console.warn("max iteration reached"),!1;if(this.gridster.checkGridCollision(t.$item)||e==="")return!1;let i=this.gridster.findItemsWithItem(t.$item),n=e===this.fromNorth||e===this.fromWest;i.sort((l,u)=>n?u.$item.y-l.$item.y||u.$item.x-l.$item.x:l.$item.y-u.$item.y||l.$item.x-u.$item.x);let s=0,a,o=!0,c=[];for(;s<i.length;s++){if(a=i[s],a===this.gridsterItem)continue;if(!a.canBeDragged()){o=!1;break}let l=this.pushedItemsTemp.indexOf(a);if(l>-1&&this.pushedItemsTempPath[l].length>10){o=!1;break}if(this.tryPattern[e][0].call(this,a,t))this.pushedItemsOrder.push(a),c.push(a);else if(this.tryPattern[e][1].call(this,a,t))this.pushedItemsOrder.push(a),c.push(a);else if(this.tryPattern[e][2].call(this,a,t))this.pushedItemsOrder.push(a),c.push(a);else if(this.tryPattern[e][3].call(this,a,t))this.pushedItemsOrder.push(a),c.push(a);else{o=!1;break}}if(!o&&(s=this.pushedItemsOrder.lastIndexOf(c[0]),s>-1)){let l=this.pushedItemsOrder.length-1;for(;l>=s;l--)a=this.pushedItemsOrder[l],this.pushedItemsOrder.pop(),this.removeFromTempPushed(a),this.removeFromPushedItem(a)}return this.iteration++,o}trySouth(t,e){return this.gridster.$options.pushDirections.south?(this.addToTempPushed(t),t.$item.y=e.$item.y+e.$item.rows,this.push(t,this.fromNorth)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1)):!1}tryNorth(t,e){return this.gridster.$options.pushDirections.north?(this.addToTempPushed(t),t.$item.y=e.$item.y-t.$item.rows,this.push(t,this.fromSouth)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1)):!1}tryEast(t,e){return this.gridster.$options.pushDirections.east?(this.addToTempPushed(t),t.$item.x=e.$item.x+e.$item.cols,this.push(t,this.fromWest)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1)):!1}tryWest(t,e){return this.gridster.$options.pushDirections.west?(this.addToTempPushed(t),t.$item.x=e.$item.x-t.$item.cols,this.push(t,this.fromEast)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1)):!1}addToTempPushed(t){let e=this.pushedItemsTemp.indexOf(t);e===-1&&(e=this.pushedItemsTemp.push(t)-1,this.pushedItemsTempPath[e]=[]),this.pushedItemsTempPath[e].push({x:t.$item.x,y:t.$item.y})}removeFromTempPushed(t){let e=this.pushedItemsTemp.indexOf(t),i=this.pushedItemsTempPath[e].pop();i&&(t.$item.x=i.x,t.$item.y=i.y,t.setSize(),this.pushedItemsTempPath[e].length||(this.pushedItemsTemp.splice(e,1),this.pushedItemsTempPath.splice(e,1)))}addToPushed(t){if(this.pushedItems.indexOf(t)<0)this.pushedItems.push(t),this.pushedItemsPath.push([{x:t.item.x||0,y:t.item.y||0},{x:t.$item.x,y:t.$item.y}]);else{let e=this.pushedItems.indexOf(t);this.pushedItemsPath[e].push({x:t.$item.x,y:t.$item.y})}}removeFromPushed(t){t>-1&&(this.pushedItems.splice(t,1),this.pushedItemsPath.splice(t,1))}removeFromPushedItem(t){let e=this.pushedItems.indexOf(t);e>-1&&(this.pushedItemsPath[e].pop(),this.pushedItemsPath.length||(this.pushedItems.splice(e,1),this.pushedItemsPath.splice(e,1)))}checkPushedItem(t,e){let i=this.pushedItemsPath[e],n=i.length-2,s,a,o,c=!1;for(;n>-1;n--)s=i[n],a=t.$item.x,o=t.$item.y,t.$item.x=s.x,t.$item.y=s.y,this.gridster.findItemWithItem(t.$item)?(t.$item.x=a,t.$item.y=o):(t.setSize(),i.splice(n+1,i.length-n-1),c=!0);return i.length<2&&this.removeFromPushed(e),c}},ss,Hi,Fc=50,Pr,as,ci,os,ls,cs,us;function Oc(r,t,e,i,n,s,a,o,c,l){ss=r.$options.scrollSensitivity,Hi=r.$options.scrollSpeed,Pr=r.el,as=c,ci=l;let u=Pr.offsetWidth,h=Pr.offsetHeight,f=Pr.scrollLeft,d=Pr.scrollTop,g=e-d,p=h+d-e-n,{clientX:x,clientY:O}=s;if(!r.$options.disableScrollVertical)if(a.clientY<O&&p<ss){if(Lc(),as&&ci&&!ci.south||us)return;us=Ec(1,o,a)}else if(a.clientY>O&&d>0&&g<ss){if(Pc(),as&&ci&&!ci.north||cs)return;cs=Ec(-1,o,a)}else a.clientY!==O&&Eo();let A=f+u-t-i,D=t-f;if(!r.$options.disableScrollHorizontal)if(a.clientX<x&&A<=ss){if(Mc(),as&&ci&&!ci.east||os)return;os=Ic(1,o,a)}else if(a.clientX>x&&f>0&&D<ss){if(Dc(),as&&ci&&!ci.west||ls)return;ls=Ic(-1,o,a)}else a.clientX!==x&&So()}function Ec(r,t,e){let i=e.clientY;return window.setInterval(()=>{(!Pr||r===-1&&Pr.scrollTop-Hi<0)&&Eo(),Pr.scrollTop+=r*Hi,i+=r*Hi,t({clientX:e.clientX,clientY:i})},Fc)}function Ic(r,t,e){let i=e.clientX;return window.setInterval(()=>{(!Pr||r===-1&&Pr.scrollLeft-Hi<0)&&So(),Pr.scrollLeft+=r*Hi,i+=r*Hi,t({clientX:i,clientY:e.clientY})},Fc)}function Ac(){So(),Eo(),Pr=null}function So(){Dc(),Mc()}function Eo(){Lc(),Pc()}function Dc(){os&&(clearInterval(os),os=0)}function Mc(){ls&&(clearInterval(ls),ls=0)}function Pc(){us&&(clearInterval(us),us=0)}function Lc(){cs&&(clearInterval(cs),cs=0)}var wo=class{swapedItem;gridsterItem;gridster;constructor(t){this.gridsterItem=t,this.gridster=t.gridster}destroy(){this.gridster=this.gridsterItem=this.swapedItem=null}swapItems(){this.gridster.$options.swap&&(this.checkSwapBack(),this.checkSwap(this.gridsterItem))}checkSwapBack(){if(this.swapedItem){let t=this.swapedItem.$item.x,e=this.swapedItem.$item.y;this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.gridster.checkCollision(this.swapedItem.$item)?(this.swapedItem.$item.x=t,this.swapedItem.$item.y=e):(this.swapedItem.setSize(),this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.swapedItem=void 0)}}restoreSwapItem(){this.swapedItem&&(this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.swapedItem.setSize(),this.swapedItem=void 0)}setSwapItem(){this.swapedItem&&(this.swapedItem.checkItemChanges(this.swapedItem.$item,this.swapedItem.item),this.swapedItem=void 0)}checkSwap(t){let e;if(this.gridster.$options.swapWhileDragging?e=this.gridster.checkCollisionForSwaping(t.$item):e=this.gridster.checkCollision(t.$item),e&&e!==!0&&e.canBeDragged()){let i=e,n=i.$item.x,s=i.$item.y,a=t.$item.x,o=t.$item.y,c=a-n,l=o-s;i.$item.x=t.item.x-c,i.$item.y=t.item.y-l,t.$item.x=i.item.x+c,t.$item.y=i.item.y+l,this.gridster.checkCollision(i.$item)||this.gridster.checkCollision(t.$item)?(t.$item.x=a,t.$item.y=o,i.$item.x=n,i.$item.y=s):(i.setSize(),this.swapedItem=i,this.gridster.$options.swapWhileDragging&&(this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.setSwapItem()))}}},hf="gridster-item-resizable-handler",Er=function(r){return r.UP="UP",r.DOWN="DOWN",r.LEFT="LEFT",r.RIGHT="RIGHT",r}(Er||{}),bo=class{zone;gridsterItem;gridster;lastMouse;offsetLeft;offsetTop;margin;outerMarginTop;outerMarginRight;outerMarginBottom;outerMarginLeft;diffTop;diffLeft;originalClientX;originalClientY;top;left;height;width;positionX;positionY;positionXBackup;positionYBackup;enabled;mousemove;mouseup;mouseleave;cancelOnBlur;touchmove;touchend;touchcancel;mousedown;touchstart;push;swap;path;collision=!1;constructor(t,e,i){this.zone=i,this.gridsterItem=t,this.gridster=e,this.lastMouse={clientX:0,clientY:0},this.path=[]}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(!0),this.gridsterItem=this.gridster=this.collision=null,this.mousedown&&(this.mousedown(),this.touchstart())}dragStart(t){t.which&&t.which!==1||(this.gridster.options.draggable&&this.gridster.options.draggable.start&&this.gridster.options.draggable.start(this.gridsterItem.item,this.gridsterItem,t),t.stopPropagation(),t.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-moving"),this.margin=this.gridster.$options.margin,this.outerMarginTop=this.gridster.$options.outerMarginTop,this.outerMarginRight=this.gridster.$options.outerMarginRight,this.outerMarginBottom=this.gridster.$options.outerMarginBottom,this.outerMarginLeft=this.gridster.$options.outerMarginLeft,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.left=this.gridsterItem.left-this.margin,this.top=this.gridsterItem.top-this.margin,this.originalClientX=t.clientX,this.originalClientY=t.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.gridster.$options.dirType===Ut.RTL?this.diffLeft=t.clientX-this.gridster.el.scrollWidth+this.gridsterItem.left:this.diffLeft=t.clientX+this.offsetLeft-this.margin-this.left,this.diffTop=t.clientY+this.offsetTop-this.margin-this.top,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(!0),this.push=new ra(this.gridsterItem),this.swap=new wo(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid(),this.path.push({x:this.gridsterItem.item.x||0,y:this.gridsterItem.item.y||0}))}dragMove=t=>{t.stopPropagation(),t.preventDefault(),ir.checkTouchEvent(t);let e=this.getDirections(t);this.gridster.options.enableBoundaryControl&&(e.includes(Er.UP)&&this.gridsterItem.el.getBoundingClientRect().top<this.gridster.el.getBoundingClientRect().top+(this.outerMarginTop??this.margin)&&(e=e.filter(i=>i!=Er.UP),t=new MouseEvent(t.type,{clientX:t.clientX,clientY:this.lastMouse.clientY})),e.includes(Er.LEFT)&&this.gridsterItem.el.getBoundingClientRect().left<this.gridster.el.getBoundingClientRect().left+(this.outerMarginLeft??this.margin)&&(e=e.filter(i=>i!=Er.LEFT),t=new MouseEvent(t.type,{clientX:this.lastMouse.clientX,clientY:t.clientY})),e.includes(Er.RIGHT)&&this.gridsterItem.el.getBoundingClientRect().right>this.gridster.el.getBoundingClientRect().right-(this.outerMarginRight??this.margin)&&(e=e.filter(i=>i!=Er.RIGHT),t=new MouseEvent(t.type,{clientX:this.lastMouse.clientX,clientY:t.clientY})),e.includes(Er.DOWN)&&this.gridsterItem.el.getBoundingClientRect().bottom>this.gridster.el.getBoundingClientRect().bottom-(this.outerMarginBottom??this.margin)&&(e=e.filter(i=>i!=Er.DOWN),t=new MouseEvent(t.type,{clientX:t.clientX,clientY:this.lastMouse.clientY}))),e.length&&(this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,Oc(this.gridster,this.left,this.top,this.width,this.height,t,this.lastMouse,this.calculateItemPositionFromMousePosition),this.calculateItemPositionFromMousePosition(t))};calculateItemPositionFromMousePosition=t=>{this.gridster.options.scale?this.calculateItemPositionWithScale(t,this.gridster.options.scale):this.calculateItemPositionWithoutScale(t),this.calculateItemPosition(),this.lastMouse.clientX=t.clientX,this.lastMouse.clientY=t.clientY,this.zone.run(()=>{this.gridster.updateGrid()})};calculateItemPositionWithScale(t,e){this.gridster.$options.dirType===Ut.RTL?this.left=this.gridster.el.scrollWidth-this.originalClientX+(t.clientX-this.originalClientX)/e+this.diffLeft:this.left=this.originalClientX+(t.clientX-this.originalClientX)/e+this.offsetLeft-this.diffLeft,this.top=this.originalClientY+(t.clientY-this.originalClientY)/e+this.offsetTop-this.diffTop}calculateItemPositionWithoutScale(t){this.gridster.$options.dirType===Ut.RTL?this.left=this.gridster.el.scrollWidth-t.clientX+this.diffLeft:this.left=t.clientX+this.offsetLeft-this.diffLeft,this.top=t.clientY+this.offsetTop-this.diffTop}dragStop=t=>{t.stopPropagation(),t.preventDefault(),Ac(),this.cancelOnBlur(),this.mousemove(),this.mouseup(),this.mouseleave(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-moving"),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.path=[],this.gridster.options.draggable&&this.gridster.options.draggable.stop?Promise.resolve(this.gridster.options.draggable.stop(this.gridsterItem.item,this.gridsterItem,t)).then(this.makeDrag,this.cancelDrag):this.makeDrag(),setTimeout(()=>{this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle(!0))})};cancelDrag=()=>{this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push&&this.push.restoreItems(),this.swap&&this.swap.restoreSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)};makeDrag=()=>{this.gridster.$options.draggable.dropOverItems&&this.gridster.options.draggable&&this.gridster.options.draggable.dropOverItemsCallback&&this.collision&&this.collision!==!0&&this.collision.$item&&this.gridster.options.draggable.dropOverItemsCallback(this.gridsterItem.item,this.collision.item,this.gridster),this.collision=!1,this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push&&this.push.setPushedItems(),this.swap&&this.swap.setSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)};calculateItemPosition(){if(this.gridster.movingItem=this.gridsterItem.$item,this.positionX=this.gridster.pixelsToPositionX(this.left,Math.round),this.positionY=this.gridster.pixelsToPositionY(this.top,Math.round),this.positionXBackup=this.gridsterItem.$item.x,this.positionYBackup=this.gridsterItem.$item.y,this.gridsterItem.$item.x=this.positionX,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.x=this.positionXBackup),this.gridsterItem.$item.y=this.positionY,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.y=this.positionYBackup),this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,this.top),this.positionXBackup!==this.gridsterItem.$item.x||this.positionYBackup!==this.gridsterItem.$item.y){let t=this.path[this.path.length-1],e="";t.x<this.gridsterItem.$item.x?e=this.push.fromWest:t.x>this.gridsterItem.$item.x?e=this.push.fromEast:t.y<this.gridsterItem.$item.y?e=this.push.fromNorth:t.y>this.gridsterItem.$item.y&&(e=this.push.fromSouth),this.push.pushItems(e,this.gridster.$options.disablePushOnDrag),this.swap.swapItems(),this.collision=this.gridster.checkCollision(this.gridsterItem.$item),this.collision?(this.gridsterItem.$item.x=this.positionXBackup,this.gridsterItem.$item.y=this.positionYBackup,this.gridster.$options.draggable.dropOverItems&&this.collision!==!0&&this.collision.$item&&(this.gridster.movingItem=null)):this.path.push({x:this.gridsterItem.$item.x,y:this.gridsterItem.$item.y}),this.push.checkPushBack()}else this.collision=!1;this.gridster.previewStyle(!0)}toggle(){let t=this.gridsterItem.canBeDragged();!this.enabled&&t?(this.enabled=!this.enabled,this.mousedown=this.gridsterItem.renderer.listen(this.gridsterItem.el,"mousedown",this.dragStartDelay),this.touchstart=this.gridsterItem.renderer.listen(this.gridsterItem.el,"touchstart",this.dragStartDelay)):this.enabled&&!t&&(this.enabled=!this.enabled,this.mousedown(),this.touchstart())}dragStartDelay=t=>{if(t.target.classList.contains(hf)||ir.checkContentClassForEvent(this.gridster,t))return;if(ir.checkTouchEvent(t),!this.gridster.$options.draggable.delayStart){this.dragStart(t);return}let i=setTimeout(()=>{this.dragStart(t),h()},this.gridster.$options.draggable.delayStart),n=this.gridsterItem.renderer.listen("document","mouseup",h),s=this.gridsterItem.renderer.listen("document","mouseleave",h),a=this.gridsterItem.renderer.listen("window","blur",h),o=this.gridsterItem.renderer.listen("document","touchmove",u),c=this.gridsterItem.renderer.listen("document","touchend",h),l=this.gridsterItem.renderer.listen("document","touchcancel",h);function u(f){ir.checkTouchEvent(f),(Math.abs(f.clientX-t.clientX)>9||Math.abs(f.clientY-t.clientY)>9)&&h()}function h(){clearTimeout(i),a(),n(),s(),o(),c(),l()}};getDirections(t){let e=[];return this.lastMouse.clientX===0&&this.lastMouse.clientY===0&&(this.lastMouse.clientY=t.clientY,this.lastMouse.clientX=t.clientX),this.lastMouse.clientY>t.clientY&&e.push(Er.UP),this.lastMouse.clientY<t.clientY&&e.push(Er.DOWN),this.lastMouse.clientX<t.clientX&&e.push(Er.RIGHT),this.lastMouse.clientX>t.clientX&&e.push(Er.LEFT),e}},Co=class{fromSouth;fromNorth;fromEast;fromWest;pushedItems;pushedItemsPath;gridsterItem;gridster;tryPattern;constructor(t){this.pushedItems=[],this.pushedItemsPath=[],this.gridsterItem=t,this.gridster=t.gridster,this.tryPattern={fromEast:this.tryWest,fromWest:this.tryEast,fromNorth:this.trySouth,fromSouth:this.tryNorth},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(t){return this.gridster.$options.pushResizeItems?this.push(this.gridsterItem,t):!1}restoreItems(){let t=0,e=this.pushedItems.length,i;for(;t<e;t++)i=this.pushedItems[t],i.$item.x=i.item.x||0,i.$item.y=i.item.y||0,i.$item.cols=i.item.cols||1,i.$item.row=i.item.row||1,i.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let t=0,e=this.pushedItems.length,i;for(;t<e;t++)i=this.pushedItems[t],i.checkItemChanges(i.$item,i.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let t=this.pushedItems.length-1,e=!1;for(;t>-1;t--)this.checkPushedItem(this.pushedItems[t],t)&&(e=!0);e&&this.checkPushBack()}push(t,e){let i=this.gridster.checkCollision(t.$item);if(i&&i!==!0&&i!==this.gridsterItem&&i.canBeResized()){if(this.tryPattern[e].call(this,i,t,e))return!0}else if(i===!1)return!0;return!1}trySouth(t,e,i){let n=t.$item.y,s=t.$item.rows;return t.$item.y=e.$item.y+e.$item.rows,t.$item.rows=s+n-t.$item.y,!this.gridster.checkCollisionTwoItems(t.$item,e.$item)&&!this.gridster.checkGridCollision(t.$item)?(t.setSize(),this.addToPushed(t),this.push(e,i),!0):(t.$item.y=n,t.$item.rows=s,!1)}tryNorth(t,e,i){let n=t.$item.rows;return t.$item.rows=e.$item.y-t.$item.y,!this.gridster.checkCollisionTwoItems(t.$item,e.$item)&&!this.gridster.checkGridCollision(t.$item)?(t.setSize(),this.addToPushed(t),this.push(e,i),!0):(t.$item.rows=n,!1)}tryEast(t,e,i){let n=t.$item.x,s=t.$item.cols;return t.$item.x=e.$item.x+e.$item.cols,t.$item.cols=s+n-t.$item.x,!this.gridster.checkCollisionTwoItems(t.$item,e.$item)&&!this.gridster.checkGridCollision(t.$item)?(t.setSize(),this.addToPushed(t),this.push(e,i),!0):(t.$item.x=n,t.$item.cols=s,!1)}tryWest(t,e,i){let n=t.$item.cols;return t.$item.cols=e.$item.x-t.$item.x,!this.gridster.checkCollisionTwoItems(t.$item,e.$item)&&!this.gridster.checkGridCollision(t.$item)?(t.setSize(),this.addToPushed(t),this.push(e,i),!0):(t.$item.cols=n,!1)}addToPushed(t){if(this.pushedItems.indexOf(t)<0)this.pushedItems.push(t),this.pushedItemsPath.push([{x:t.item.x||0,y:t.item.y||0,cols:t.item.cols||0,rows:t.item.rows||0},{x:t.$item.x,y:t.$item.y,cols:t.$item.cols,rows:t.$item.rows}]);else{let e=this.pushedItems.indexOf(t);this.pushedItemsPath[e].push({x:t.$item.x,y:t.$item.y,cols:t.$item.cols,rows:t.$item.rows})}}removeFromPushed(t){t>-1&&(this.pushedItems.splice(t,1),this.pushedItemsPath.splice(t,1))}checkPushedItem(t,e){let i=this.pushedItemsPath[e],n=i.length-2,s,a,o,c,l;for(;n>-1;n--)s=i[n],a=t.$item.x,o=t.$item.y,c=t.$item.cols,l=t.$item.rows,t.$item.x=s.x,t.$item.y=s.y,t.$item.cols=s.cols,t.$item.rows=s.rows,this.gridster.findItemWithItem(t.$item)?(t.$item.x=a,t.$item.y=o,t.$item.cols=c,t.$item.rows=l):(t.setSize(),i.splice(n+1,i.length-1-n));return i.length<2?(this.removeFromPushed(e),!0):!1}},To=class{zone;gridsterItem;gridster;lastMouse;itemBackup;resizeEventScrollType;directionFunction=null;resizeEnabled;resizableHandles;mousemove;mouseup;mouseleave;cancelOnBlur;touchmove;touchend;touchcancel;push;pushResize;minHeight;minWidth;offsetTop;offsetLeft;diffTop;diffLeft;diffRight;diffBottom;margin;outerMarginTop;outerMarginRight;outerMarginBottom;outerMarginLeft;originalClientX;originalClientY;top;left;bottom;right;width;height;newPosition;constructor(t,e,i){this.zone=i,this.gridsterItem=t,this.gridster=e,this.lastMouse={clientX:0,clientY:0},this.itemBackup=[0,0,0,0],this.resizeEventScrollType={west:!1,east:!1,north:!1,south:!1}}destroy(){this.gridster?.previewStyle(),this.gridster=this.gridsterItem=null}dragStart(t){if(t.which&&t.which!==1)return;this.gridster.options.resizable&&this.gridster.options.resizable.start&&this.gridster.options.resizable.start(this.gridsterItem.item,this.gridsterItem,t),t.stopPropagation(),t.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-resizing"),this.lastMouse.clientX=t.clientX,this.lastMouse.clientY=t.clientY,this.left=this.gridsterItem.left,this.top=this.gridsterItem.top,this.originalClientX=t.clientX,this.originalClientY=t.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.bottom=this.gridsterItem.top+this.gridsterItem.height,this.right=this.gridsterItem.left+this.gridsterItem.width,this.margin=this.gridster.$options.margin,this.outerMarginTop=this.gridster.$options.outerMarginTop,this.outerMarginRight=this.gridster.$options.outerMarginRight,this.outerMarginBottom=this.gridster.$options.outerMarginBottom,this.outerMarginLeft=this.gridster.$options.outerMarginLeft,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.diffLeft=t.clientX+this.offsetLeft-this.left,this.diffRight=t.clientX+this.offsetLeft-this.right,this.diffTop=t.clientY+this.offsetTop-this.top,this.diffBottom=t.clientY+this.offsetTop-this.bottom,this.minHeight=this.gridster.positionYToPixels(this.gridsterItem.$item.minItemRows||this.gridster.$options.minItemRows)-this.margin,this.minWidth=this.gridster.positionXToPixels(this.gridsterItem.$item.minItemCols||this.gridster.$options.minItemCols)-this.margin,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(),this.push=new ra(this.gridsterItem),this.pushResize=new Co(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid();let{classList:e}=t.target;e.contains("handle-n")?(this.resizeEventScrollType.north=!0,this.directionFunction=this.handleNorth):e.contains("handle-w")?this.gridster.$options.dirType===Ut.RTL?(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):e.contains("handle-s")?(this.resizeEventScrollType.south=!0,this.directionFunction=this.handleSouth):e.contains("handle-e")?this.gridster.$options.dirType===Ut.RTL?(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):e.contains("handle-nw")?this.gridster.$options.dirType===Ut.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):e.contains("handle-ne")?this.gridster.$options.dirType===Ut.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):e.contains("handle-sw")?this.gridster.$options.dirType===Ut.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):e.contains("handle-se")&&(this.gridster.$options.dirType===Ut.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast))}dragMove=t=>{if(this.directionFunction===null)throw new Error("The `directionFunction` has not been set before calling `dragMove`.");t.stopPropagation(),t.preventDefault(),ir.checkTouchEvent(t),this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,Oc(this.gridster,this.left,this.top,this.width,this.height,t,this.lastMouse,this.directionFunction,!0,this.resizeEventScrollType);let e=this.gridster.options.scale||1;this.directionFunction({clientX:this.originalClientX+(t.clientX-this.originalClientX)/e,clientY:this.originalClientY+(t.clientY-this.originalClientY)/e}),this.lastMouse.clientX=t.clientX,this.lastMouse.clientY=t.clientY,this.zone.run(()=>{this.gridster.updateGrid()})};dragStop=t=>{t.stopPropagation(),t.preventDefault(),Ac(),this.mousemove(),this.mouseup(),this.mouseleave(),this.cancelOnBlur(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.gridster.options.resizable&&this.gridster.options.resizable.stop?Promise.resolve(this.gridster.options.resizable.stop(this.gridsterItem.item,this.gridsterItem,t)).then(this.makeResize,this.cancelResize):this.makeResize(),setTimeout(()=>{this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-resizing"),this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())})};cancelResize=()=>{this.gridsterItem.$item.cols=this.gridsterItem.item.cols||1,this.gridsterItem.$item.rows=this.gridsterItem.item.rows||1,this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push.restoreItems(),this.pushResize.restoreItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null};makeResize=()=>{this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push.setPushedItems(),this.pushResize.setPushedItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null};handleNorth=t=>{this.top=t.clientY+this.offsetTop-this.diffTop,this.height=this.bottom-this.top,this.minHeight>this.height?(this.height=this.minHeight,this.top=this.bottom-this.minHeight):this.gridster.options.enableBoundaryControl&&(this.top=Math.max(0,this.top),this.height=this.bottom-this.top);let e=this.gridster.options.pushItems?this.margin:0;if(this.newPosition=this.gridster.pixelsToPositionY(this.top+e,Math.floor),this.gridsterItem.$item.y!==this.newPosition){if(this.itemBackup[1]=this.gridsterItem.$item.y,this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows+=this.gridsterItem.$item.y-this.newPosition,this.gridsterItem.$item.y=this.newPosition,this.pushResize.pushItems(this.pushResize.fromSouth),this.push.pushItems(this.push.fromSouth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item)){this.gridsterItem.$item.y=this.itemBackup[1],this.gridsterItem.$item.rows=this.itemBackup[3],this.top=this.gridster.positionYToPixels(this.gridsterItem.$item.y),this.setItemTop(this.gridster.positionYToPixels(this.gridsterItem.$item.y)),this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);return}else this.gridster.previewStyle();this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemTop(this.top),this.setItemHeight(this.height)};handleWest=t=>{let e=this.gridster.$options.dirType===Ut.RTL?this.originalClientX+(this.originalClientX-t.clientX):t.clientX;this.left=e+this.offsetLeft-this.diffLeft,this.width=this.right-this.left,this.minWidth>this.width?(this.width=this.minWidth,this.left=this.right-this.minWidth):this.gridster.options.enableBoundaryControl&&(this.left=Math.max(0,this.left),this.width=this.right-this.left);let i=this.gridster.options.pushItems?this.margin:0;if(this.newPosition=this.gridster.pixelsToPositionX(this.left+i,Math.floor),this.gridsterItem.$item.x!==this.newPosition){if(this.itemBackup[0]=this.gridsterItem.$item.x,this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols+=this.gridsterItem.$item.x-this.newPosition,this.gridsterItem.$item.x=this.newPosition,this.pushResize.pushItems(this.pushResize.fromEast),this.push.pushItems(this.push.fromEast,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item)){this.gridsterItem.$item.x=this.itemBackup[0],this.gridsterItem.$item.cols=this.itemBackup[2],this.left=this.gridster.positionXToPixels(this.gridsterItem.$item.x),this.setItemLeft(this.gridster.positionXToPixels(this.gridsterItem.$item.x)),this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);return}else this.gridster.previewStyle();this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemLeft(this.left),this.setItemWidth(this.width)};handleSouth=t=>{if(this.height=t.clientY+this.offsetTop-this.diffBottom-this.top,this.minHeight>this.height&&(this.height=this.minHeight),this.bottom=this.top+this.height,this.gridster.options.enableBoundaryControl){let i=this.outerMarginBottom??this.margin,n=this.gridster.el.getBoundingClientRect();this.bottom=Math.min(this.bottom,n.bottom-n.top-2*i),this.height=this.bottom-this.top}let e=this.gridster.options.pushItems?0:this.margin;if(this.newPosition=this.gridster.pixelsToPositionY(this.bottom+e,Math.ceil),this.gridsterItem.$item.y+this.gridsterItem.$item.rows!==this.newPosition){if(this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows=this.newPosition-this.gridsterItem.$item.y,this.pushResize.pushItems(this.pushResize.fromNorth),this.push.pushItems(this.push.fromNorth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item)){this.gridsterItem.$item.rows=this.itemBackup[3],this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);return}else this.gridster.previewStyle();this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemHeight(this.height)};handleEast=t=>{let e=this.gridster.$options.dirType===Ut.RTL?this.originalClientX+(this.originalClientX-t.clientX):t.clientX;if(this.width=e+this.offsetLeft-this.diffRight-this.left,this.minWidth>this.width&&(this.width=this.minWidth),this.right=this.left+this.width,this.gridster.options.enableBoundaryControl){let n=this.outerMarginRight??this.margin,s=this.gridster.el.getBoundingClientRect();this.right=Math.min(this.right,s.right-s.left-2*n),this.width=this.right-this.left}let i=this.gridster.options.pushItems?0:this.margin;if(this.newPosition=this.gridster.pixelsToPositionX(this.right+i,Math.ceil),this.gridsterItem.$item.x+this.gridsterItem.$item.cols!==this.newPosition){if(this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols=this.newPosition-this.gridsterItem.$item.x,this.pushResize.pushItems(this.pushResize.fromWest),this.push.pushItems(this.push.fromWest,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item)){this.gridsterItem.$item.cols=this.itemBackup[2],this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);return}else this.gridster.previewStyle();this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemWidth(this.width)};handleNorthWest=t=>{this.handleNorth(t),this.handleWest(t)};handleNorthEast=t=>{this.handleNorth(t),this.handleEast(t)};handleSouthWest=t=>{this.handleSouth(t),this.handleWest(t)};handleSouthEast=t=>{this.handleSouth(t),this.handleEast(t)};toggle(){this.resizeEnabled=this.gridsterItem.canBeResized(),this.resizableHandles=this.gridsterItem.getResizableHandles()}dragStartDelay(t){if(ir.checkTouchEvent(t),!this.gridster.$options.resizable.delayStart){this.dragStart(t);return}let e=setTimeout(()=>{this.dragStart(t),u()},this.gridster.$options.resizable.delayStart),{cancelMouse:i,cancelMouseLeave:n,cancelOnBlur:s,cancelTouchMove:a,cancelTouchEnd:o,cancelTouchCancel:c}=this.zone.runOutsideAngular(()=>{let h=this.gridsterItem.renderer.listen("document","mouseup",u),f=this.gridsterItem.renderer.listen("document","mouseleave",u),d=this.gridsterItem.renderer.listen("window","blur",u),g=this.gridsterItem.renderer.listen("document","touchmove",l),p=this.gridsterItem.renderer.listen("document","touchend",u),x=this.gridsterItem.renderer.listen("document","touchcancel",u);return{cancelMouse:h,cancelMouseLeave:f,cancelOnBlur:d,cancelTouchMove:g,cancelTouchEnd:p,cancelTouchCancel:x}});function l(h){ir.checkTouchEvent(h),(Math.abs(h.clientX-t.clientX)>9||Math.abs(h.clientY-t.clientY)>9)&&u()}function u(){clearTimeout(e),s(),i(),n(),a(),o(),c()}}setItemTop(t){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,t)}setItemLeft(t){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,t,this.top)}setItemHeight(t){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"height",t+"px")}setItemWidth(t){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"width",t+"px")}},Rc=(()=>{class r{renderer;zone;item;itemInit=new ve;itemChange=new ve;itemResize=new ve;$item;el;gridster;top;left;width;height;drag;resize;notPlaced;init;get zIndex(){return this.getLayerIndex()+this.gridster.$options.baseLayerIndex}constructor(e,i,n,s){this.renderer=n,this.zone=s,this.el=e.nativeElement,this.$item={cols:-1,rows:-1,x:-1,y:-1},this.gridster=i,this.drag=new bo(this,i,this.zone),this.resize=new To(this,i,this.zone)}ngOnInit(){this.gridster.addItem(this)}ngOnChanges(e){e.item&&(this.updateOptions(),this.init||this.gridster.calculateLayout$.next()),e.item&&e.item.previousValue&&this.setSize()}updateOptions(){this.$item=ir.merge(this.$item,this.item,{cols:void 0,rows:void 0,x:void 0,y:void 0,layerIndex:void 0,dragEnabled:void 0,resizeEnabled:void 0,compactEnabled:void 0,maxItemRows:void 0,minItemRows:void 0,maxItemCols:void 0,minItemCols:void 0,maxItemArea:void 0,minItemArea:void 0,resizableHandles:{s:void 0,e:void 0,n:void 0,w:void 0,se:void 0,ne:void 0,sw:void 0,nw:void 0}})}ngOnDestroy(){this.gridster.removeItem(this),this.drag.destroy(),this.resize.destroy(),this.gridster=this.drag=this.resize=null}setSize(){this.renderer.setStyle(this.el,"display",this.notPlaced?"":"block"),this.gridster.gridRenderer.updateItem(this.el,this.$item,this.renderer),this.updateItemSize()}updateItemSize(){let e=this.$item.y*this.gridster.curRowHeight,i=this.$item.x*this.gridster.curColWidth,n=this.$item.cols*this.gridster.curColWidth-this.gridster.$options.margin,s=this.$item.rows*this.gridster.curRowHeight-this.gridster.$options.margin;this.top=e,this.left=i,!this.init&&n>0&&s>0&&(this.init=!0,this.item.initCallback&&this.item.initCallback(this.item,this),this.gridster.options.itemInitCallback&&this.gridster.options.itemInitCallback(this.item,this),this.itemInit.next({item:this.item,itemComponent:this}),this.gridster.$options.scrollToNewItems&&this.el.scrollIntoView(!1)),(n!==this.width||s!==this.height)&&(this.width=n,this.height=s,this.gridster.options.itemResizeCallback&&this.gridster.options.itemResizeCallback(this.item,this),this.itemResize.next({item:this.item,itemComponent:this}))}itemChanged(){this.gridster.options.itemChangeCallback&&this.gridster.options.itemChangeCallback(this.item,this),this.itemChange.next({item:this.item,itemComponent:this})}checkItemChanges(e,i){e.rows===i.rows&&e.cols===i.cols&&e.x===i.x&&e.y===i.y||(this.gridster.checkCollision(this.$item)?(this.$item.x=i.x||0,this.$item.y=i.y||0,this.$item.cols=i.cols||1,this.$item.rows=i.rows||1,this.setSize()):(this.item.cols=this.$item.cols,this.item.rows=this.$item.rows,this.item.x=this.$item.x,this.item.y=this.$item.y,this.gridster.calculateLayout$.next(),this.itemChanged()))}canBeDragged(){let e=this.gridster.$options.draggable.enabled,i=this.$item.dragEnabled===void 0?e:this.$item.dragEnabled;return!this.gridster.mobile&&e&&i}canBeResized(){let e=this.gridster.$options.resizable.enabled,i=this.$item.resizeEnabled===void 0?e:this.$item.resizeEnabled;return!this.gridster.mobile&&e&&i}getResizableHandles(){let e=this.gridster.$options.resizable.handles,i=this.$item.resizableHandles;return i===void 0?e:F(F({},e),i)}bringToFront(e){if(e&&e<=0)return;let i=this.getLayerIndex(),n=this.gridster.$options.maxLayerIndex;if(i<n){let s=e?i+e:n;this.item.layerIndex=this.$item.layerIndex=s>n?n:s}}sendToBack(e){if(e&&e<=0)return;let i=this.getLayerIndex();if(i>0){let n=e?i-e:0;this.item.layerIndex=this.$item.layerIndex=n<0?0:n}}getLayerIndex(){return this.item.layerIndex!==void 0?this.item.layerIndex:this.gridster.$options.defaultLayerIndex!==void 0?this.gridster.$options.defaultLayerIndex:0}static \u0275fac=function(i){return new(i||r)(ze(oi),ze(ia),ze(Li),ze(Ri))};static \u0275cmp=Oe({type:r,selectors:[["gridster-item"]],hostVars:2,hostBindings:function(i,n){i&2&&Dr("z-index",n.zIndex)},inputs:{item:"item"},outputs:{itemInit:"itemInit",itemChange:"itemChange",itemResize:"itemResize"},features:[ai],ngContentSelectors:kc,decls:9,vars:8,consts:[[1,"gridster-item-resizable-handler","handle-s"],[1,"gridster-item-resizable-handler","handle-e"],[1,"gridster-item-resizable-handler","handle-n"],[1,"gridster-item-resizable-handler","handle-w"],[1,"gridster-item-resizable-handler","handle-se"],[1,"gridster-item-resizable-handler","handle-ne"],[1,"gridster-item-resizable-handler","handle-sw"],[1,"gridster-item-resizable-handler","handle-nw"],[1,"gridster-item-resizable-handler","handle-s",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-e",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-n",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-w",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-se",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-ne",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-sw",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-nw",3,"mousedown","touchstart"]],template:function(i,n){i&1&&(Vi(),li(0),dt(1,ef,1,0,"div",0),dt(2,tf,1,0,"div",1),dt(3,rf,1,0,"div",2),dt(4,nf,1,0,"div",3),dt(5,sf,1,0,"div",4),dt(6,af,1,0,"div",5),dt(7,of,1,0,"div",6),dt(8,lf,1,0,"div",7)),i&2&&(S(),pt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.s&&n.resize.resizeEnabled?1:-1),S(),pt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.e&&n.resize.resizeEnabled?2:-1),S(),pt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.n&&n.resize.resizeEnabled?3:-1),S(),pt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.w&&n.resize.resizeEnabled?4:-1),S(),pt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.se&&n.resize.resizeEnabled?5:-1),S(),pt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.ne&&n.resize.resizeEnabled?6:-1),S(),pt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.sw&&n.resize.resizeEnabled?7:-1),S(),pt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.nw&&n.resize.resizeEnabled?8:-1))},styles:[`gridster-item{box-sizing:border-box;z-index:1;position:absolute;overflow:hidden;transition:.3s;display:none;background:#fff;-webkit-user-select:text;user-select:text}gridster-item.gridster-item-moving{cursor:move}gridster-item.gridster-item-resizing,gridster-item.gridster-item-moving{transition:0s;z-index:2;box-shadow:0 0 5px 5px #0003,0 6px 10px #00000024,0 1px 18px #0000001f}.gridster-item-resizable-handler{position:absolute;z-index:2}.gridster-item-resizable-handler.handle-n{cursor:ns-resize;height:10px;right:0;top:0;left:0}.gridster-item-resizable-handler.handle-e{cursor:ew-resize;width:10px;bottom:0;right:0;top:0}.gridster-item-resizable-handler.handle-s{cursor:ns-resize;height:10px;right:0;bottom:0;left:0}.gridster-item-resizable-handler.handle-w{cursor:ew-resize;width:10px;left:0;top:0;bottom:0}.gridster-item-resizable-handler.handle-ne{cursor:ne-resize;width:10px;height:10px;right:0;top:0}.gridster-item-resizable-handler.handle-nw{cursor:nw-resize;width:10px;height:10px;left:0;top:0}.gridster-item-resizable-handler.handle-se{cursor:se-resize;width:0;height:0;right:0;bottom:0;border-style:solid;border-width:0 0 10px 10px;border-color:transparent}.gridster-item-resizable-handler.handle-sw{cursor:sw-resize;width:10px;height:10px;left:0;bottom:0}gridster-item:hover .gridster-item-resizable-handler.handle-se{border-color:transparent transparent #ccc}
`],encapsulation:2})}return r})();function ff(r){r||(r=at(Ya));let t=new Kn(e=>{if(r.destroyed){e.next();return}return r.onDestroy(e.next.bind(e))});return e=>e.pipe(Yn(t))}var Io=class{source;destroyed=!1;destroyRef=at(Ya);constructor(t){this.source=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}subscribe(t){if(this.destroyed)throw new Ll(953,!1);let e=this.source.pipe(ff(this.destroyRef)).subscribe({next:i=>t(i)});return{unsubscribe:()=>e.unsubscribe()}}};function Pe(r,t){return new Io(r)}function Nc(r){let t=Hl(r);return new Kn(e=>{let i=t?.onDestroy(()=>e.complete()),n=r.subscribe(s=>e.next(s));return()=>{n.unsubscribe(),i?.()}})}var Bc=new Rl("NGX_ECHARTS_CONFIG"),ko=class{constructor(){this.subject=new Ps(1),this.subscriptions=new Ol}doFilter(t){this.subject.next(t)}dispose(){this.subscriptions.unsubscribe()}notEmpty(t,e){this.subscriptions.add(this.subject.subscribe(i=>{if(i[t]){let n=i[t].currentValue;n!=null&&e(n)}}))}has(t,e){this.subscriptions.add(this.subject.subscribe(i=>{if(i[t]){let n=i[t].currentValue;e(n)}}))}notFirst(t,e){this.subscriptions.add(this.subject.subscribe(i=>{if(i[t]&&!i[t].isFirstChange()){let n=i[t].currentValue;e(n)}}))}notFirstAndEmpty(t,e){this.subscriptions.add(this.subject.subscribe(i=>{if(i[t]&&!i[t].isFirstChange()){let n=i[t].currentValue;n!=null&&e(n)}}))}},Vc=(()=>{let t=class t{constructor(){this.el=at(oi),this.ngZone=at(Ri),this.config=at(Bc),this.options=Hr(null),this.theme=Hr(this.config.theme??null),this.initOpts=Hr(null),this.merge=Hr(null),this.autoResize=Hr(!0),this.loading=Hr(!1),this.loadingType=Hr("default"),this.loadingOpts=Hr(null),this.chartInit=Za(),this.optionsError=Za(),this.chartClick=Pe(this.createLazyEvent("click")),this.chartDblClick=Pe(this.createLazyEvent("dblclick")),this.chartMouseDown=Pe(this.createLazyEvent("mousedown")),this.chartMouseMove=Pe(this.createLazyEvent("mousemove")),this.chartMouseUp=Pe(this.createLazyEvent("mouseup")),this.chartMouseOver=Pe(this.createLazyEvent("mouseover")),this.chartMouseOut=Pe(this.createLazyEvent("mouseout")),this.chartGlobalOut=Pe(this.createLazyEvent("globalout")),this.chartContextMenu=Pe(this.createLazyEvent("contextmenu")),this.chartHighlight=Pe(this.createLazyEvent("highlight")),this.chartDownplay=Pe(this.createLazyEvent("downplay")),this.chartSelectChanged=Pe(this.createLazyEvent("selectchanged")),this.chartLegendSelectChanged=Pe(this.createLazyEvent("legendselectchanged")),this.chartLegendSelected=Pe(this.createLazyEvent("legendselected")),this.chartLegendUnselected=Pe(this.createLazyEvent("legendunselected")),this.chartLegendLegendSelectAll=Pe(this.createLazyEvent("legendselectall")),this.chartLegendLegendInverseSelect=Pe(this.createLazyEvent("legendinverseselect")),this.chartLegendScroll=Pe(this.createLazyEvent("legendscroll")),this.chartDataZoom=Pe(this.createLazyEvent("datazoom")),this.chartDataRangeSelected=Pe(this.createLazyEvent("datarangeselected")),this.chartGraphRoam=Pe(this.createLazyEvent("graphroam")),this.chartGeoRoam=Pe(this.createLazyEvent("georoam")),this.chartTreeRoam=Pe(this.createLazyEvent("treeroam")),this.chartTimelineChanged=Pe(this.createLazyEvent("timelinechanged")),this.chartTimelinePlayChanged=Pe(this.createLazyEvent("timelineplaychanged")),this.chartRestore=Pe(this.createLazyEvent("restore")),this.chartDataViewChanged=Pe(this.createLazyEvent("dataviewchanged")),this.chartMagicTypeChanged=Pe(this.createLazyEvent("magictypechanged")),this.chartGeoSelectChanged=Pe(this.createLazyEvent("geoselectchanged")),this.chartGeoSelected=Pe(this.createLazyEvent("geoselected")),this.chartGeoUnselected=Pe(this.createLazyEvent("geounselected")),this.chartAxisAreaSelected=Pe(this.createLazyEvent("axisareaselected")),this.chartBrush=Pe(this.createLazyEvent("brush")),this.chartBrushEnd=Pe(this.createLazyEvent("brushend")),this.chartBrushSelected=Pe(this.createLazyEvent("brushselected")),this.chartGlobalCursorTaken=Pe(this.createLazyEvent("globalcursortaken")),this.chartRendered=Pe(this.createLazyEvent("rendered")),this.chartFinished=Pe(this.createLazyEvent("finished")),this.animationFrameID=null,this.chart$=new Ps(1),this.resize$=new en,this.changeFilter=new ko,this.resizeObFired=!1,this.echarts=this.config.echarts}ngOnChanges(i){this.changeFilter.doFilter(i)}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe(Pl(100,Al,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize()&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(i=>{for(let n of i)n.target===this.el.nativeElement&&(this.resizeObFired?this.animationFrameID=window.requestAnimationFrame(()=>{this.resize$.next()}):this.resizeObFired=!0)})),this.resizeOb.observe(this.el.nativeElement)),this.changeFilter.notFirstAndEmpty("options",i=>this.onOptionsChange(i)),this.changeFilter.notFirstAndEmpty("merge",i=>this.setOption(i)),this.changeFilter.has("loading",i=>this.toggleLoading(!!i)),this.changeFilter.notFirst("theme",()=>this.refreshChart())}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.loadingSub&&this.loadingSub.unsubscribe(),this.changeFilter.dispose(),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(i){this.chart?i?this.chart.showLoading(this.loadingType(),this.loadingOpts()):this.chart.hideLoading():this.loadingSub=this.chart$.subscribe(n=>i?n.showLoading(this.loadingType(),this.loadingOpts()):n.hideLoading())}setOption(i,n){if(this.chart)try{this.chart.setOption(i,n)}catch(s){console.error(s),this.optionsError.emit(s)}}refreshChart(){return Bt(this,null,function*(){this.dispose(),yield this.initChart()})}createChart(){let i=this.el.nativeElement;if(window&&window.getComputedStyle){let n=window.getComputedStyle(i,null).getPropertyValue("height");(!n||n==="0px")&&(!i.style.height||i.style.height==="0px")&&(i.style.height="400px")}return this.ngZone.runOutsideAngular(()=>(typeof this.echarts=="function"?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:s})=>s(i,this.theme??this.config?.theme,this.initOpts())))}initChart(){return Bt(this,null,function*(){yield this.onOptionsChange(this.options());let i=this.merge();i&&this.chart&&this.setOption(i)})}onOptionsChange(i){return Bt(this,null,function*(){i&&(this.chart?this.setOption(this.options(),!0):(this.chart=yield this.createChart(),this.chart$.next(this.chart),this.chartInit.emit(this.chart),this.setOption(this.options(),!0)))})}createLazyEvent(i){return Nc(this.chartInit).pipe(Ls(n=>new Kn(s=>(n.on(i,a=>this.ngZone.run(()=>s.next(a))),()=>{this.chart&&(this.chart.isDisposed()||n.off(i))}))))}};t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=qn({type:t,selectors:[["echarts"],["","echarts",""]],inputs:{options:[1,"options"],theme:[1,"theme"],initOpts:[1,"initOpts"],merge:[1,"merge"],autoResize:[1,"autoResize"],loading:[1,"loading"],loadingType:[1,"loadingType"],loadingOpts:[1,"loadingOpts"]},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartHighlight:"chartHighlight",chartDownplay:"chartDownplay",chartSelectChanged:"chartSelectChanged",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendLegendSelectAll:"chartLegendLegendSelectAll",chartLegendLegendInverseSelect:"chartLegendLegendInverseSelect",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartGraphRoam:"chartGraphRoam",chartGeoRoam:"chartGeoRoam",chartTreeRoam:"chartTreeRoam",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartGeoSelectChanged:"chartGeoSelectChanged",chartGeoSelected:"chartGeoSelected",chartGeoUnselected:"chartGeoUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartGlobalCursorTaken:"chartGlobalCursorTaken",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],features:[ai]});let r=t;return r})();function na(r){return{provide:Bc,useValue:r}}var df=["chart"],sa=(()=>{let t=class t{constructor(i){this.cdr=i,this.isSingleClick=!0}get chartOptions(){return this.widget?.config?.options}onChartInit(i){this.widget.chartInstance=i,setTimeout(()=>{this.onDataLoad?.emit(this.widget)})}onChartDblClick(i){this.isSingleClick=!1}onClick(i){this.isSingleClick=!0,setTimeout(()=>{let n=i.data;if(i.seriesType==="scatter"){let a=i.data.find(o=>o.name===this.widget.config.state?.accessor);n=F(F({},n),a)}let s=this.createFilterValueFromClickData(n,i);s?(s.widgetId=this.widget.id,this.widget.config?.header?.title&&(s.widgetTitle=this.widget.config.header.title),this.onUpdateFilter.emit({value:n,widget:this.widget,filterValue:s})):this.onUpdateFilter.emit({value:n,widget:this.widget})},250)}createFilterValueFromClickData(i,n){if(!i||typeof i!="object")return null;let s=this.widget.config?.filterColumn||this.widget.config?.accessor||"unknown",a={accessor:"unknown",filterColumn:s};if(i&&typeof i=="object"&&i.name&&n.seriesType==="pie")a={accessor:"category",filterColumn:s,category:i.name,value:i.name,percentage:i.value?.toString()||"0"};else if(n.seriesType==="bar"){let o,c;if(i&&typeof i=="object"&&i.name)o=i.name,c=i.value||i.name;else{c=i;let l=this.widget.config?.options,u=[];if(l?.xAxis&&(Array.isArray(l.xAxis)?u=l.xAxis[0]?.data||[]:u=l.xAxis.data||[]),u.length===0&&l?.series?.[0]?.data){let h=l.series[0].data;Array.isArray(h)&&h.length>0&&typeof h[0]=="object"&&h[0].name&&(u=h.map(f=>f.name))}u&&Array.isArray(u)&&n.dataIndex!==void 0?o=u[n.dataIndex]:o=c?.toString()||"Unknown"}a={accessor:"category",filterColumn:s,category:o,value:c,seriesName:n.seriesName}}else if(n.seriesType==="line")a={accessor:"series",filterColumn:s,series:n.seriesName||(i&&typeof i=="object"?i.name:null),value:i&&typeof i=="object"?i.value:i,xAxis:i&&Array.isArray(i)?i[0]?.toString():null,yAxis:i&&Array.isArray(i)?i[1]?.toString():null};else if(n.seriesType==="scatter"&&i&&typeof i=="object"&&i.value&&Array.isArray(i.value))a={accessor:"coordinates",filterColumn:s,x:i.value[0]?.toString(),y:i.value[1]?.toString(),value:`(${i.value[0]}, ${i.value[1]})`,seriesName:n.seriesName};else if(i&&typeof i=="object"){let o=Object.keys(i);if(o.length>0){let c=o[0];a={accessor:c,filterColumn:s,[c]:i[c],value:i[c]?.toString(),seriesName:n.seriesName}}}else return null;return a.accessor!=="unknown"?a:null}forceChartUpdate(){this.widget.chartInstance&&this.widget.chartInstance.setOption(this.chartOptions),this.cdr.detectChanges()}};t.\u0275fac=function(n){return new(n||t)(ze(on))},t.\u0275cmp=Oe({type:t,selectors:[["vis-echart"]],viewQuery:function(n,s){if(n&1&&Ae(df,5),n&2){let a;de(a=pe())&&(s.chart=a.first)}},inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},features:[Ft([na({echarts:()=>import("./chunk-VTG26B3E.js")})])],decls:2,vars:1,consts:[["chart",""],["echarts","",3,"chartInit","chartClick","chartDblClick","options"]],template:function(n,s){if(n&1){let a=ge();P(0,"div",1,0),ce("chartInit",function(c){return X(a),j(s.onChartInit(c))})("chartClick",function(c){return X(a),j(s.onClick(c))})("chartDblClick",function(c){return X(a),j(s.onChartDblClick(c))}),L()}n&2&&w("options",s.chartOptions)},dependencies:[Le,Vc],encapsulation:2});let r=t;return r})();function pf(r,t){if(r&1&&(P(0,"span",11),Se(1),sn(2,"uppercase"),L(),P(3,"span",12),Se(4,":"),L(),P(5,"span",13),Se(6),L()),r&2){let e=y().$implicit;S(),He(an(2,2,e.filterColumn||e.accessor)),S(5),He(e.value)}}function mf(r,t){if(r&1&&(P(0,"span",11),Se(1),L(),P(2,"span",12),Se(3,":"),L(),P(4,"span",13),Se(5),L()),r&2){let e=y().$implicit;S(),He(e.widgetTitle),S(4),He(e.value)}}function gf(r,t){if(r&1&&(P(0,"span",11),Se(1),sn(2,"uppercase"),L(),P(3,"span",12),Se(4,"="),L(),P(5,"span",13),Se(6),L()),r&2){let e=y().$implicit;S(),He(an(2,2,e.accessor)),S(5),He(e.value)}}function xf(r,t){if(r&1){let e=ge();P(0,"button",8),ce("click",function(){let n=X(e).$implicit,s=y(2);return j(s.clearFilter(n))}),he(1,"i",9),dt(2,pf,7,4)(3,mf,6,2)(4,gf,7,4),he(5,"i",10),L()}if(r&2){let e=t.$implicit;w("title","Remove "+(e.filterColumn||e.accessor||e.widgetTitle)+" filter"),S(2),pt(e.filterColumn||e.accessor?2:e.widgetTitle?3:4)}}function _f(r,t){if(r&1){let e=ge();P(0,"div",0)(1,"span",2),Se(2,"Applied Filters"),L(),P(3,"div",3),Ni(4,xf,6,2,"button",4,$l),L(),P(6,"div",5)(7,"button",6),ce("click",function(){X(e);let n=y();return j(n.clearAllFilters(!0))}),he(8,"i",7),P(9,"span"),Se(10,"Clear All"),L()()()()}if(r&2){let e=y();S(4),Bi(e.filterValues)}}function vf(r,t){r&1&&(P(0,"div",1)(1,"div",14),he(2,"i",15),P(3,"div",16)(4,"p",17),Se(5,"No Filters Applied"),L(),P(6,"p",18),Se(7," Click on any chart element to slice and dice data. You can use annotations to save a specific state of dashboard after applying filters. "),L()()()())}var $c=(()=>{let t=class t{get filterValues(){let i=this.widget?.config?.options;return i&&i.values&&Array.isArray(i.values)&&i.values.length>0?i.values:[]}set filterValues(i){i&&i.length>0&&(this.widget.config?this.widget.config.options||(this.widget.config.options={values:[]}):this.widget.config={options:{values:[]}},this.widget.config.options.values=i)}clearAllFilters(i){i&&(this.filterValues=[],this.widget?.config?.options&&(this.widget.config.options.values=[]),this.onUpdateFilter.emit([]))}clearFilter(i){if(JSON.stringify(i).length>0){let n=this.filterValues.splice(this.filterValues.indexOf(i),1);this.widget?.config?.options&&(this.widget.config.options.values=this.filterValues),this.onUpdateFilter.emit(this.filterValues)}}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-filters"]],inputs:{widget:"widget",onUpdateFilter:"onUpdateFilter",onDataLoad:"onDataLoad"},decls:2,vars:1,consts:[[1,"filter-component"],[1,"filter-component","empty-state"],[1,"filter-label"],[1,"filter-badges"],[1,"btn-wide","btn","btn-outline-primary","btn-sm","chip",3,"title"],[1,"filter-actions"],["title","Clear all applied filters",1,"btn-wide","btn","btn-outline-warning","btn-sm","chip","clear-all-btn",3,"click"],[1,"pi","pi-trash"],[1,"btn-wide","btn","btn-outline-primary","btn-sm","chip",3,"click","title"],[1,"pi","pi-tag","filter-badge-icon"],["title","Remove filter",1,"pi","pi-times","close-icon"],[1,"filter-key"],[1,"filter-separator"],[1,"filter-value"],[1,"empty-state-content"],[1,"pi","pi-info-circle","empty-state-icon"],[1,"empty-state-text"],[1,"empty-state-title"],[1,"empty-state-description"]],template:function(n,s){n&1&&dt(0,_f,11,0,"div",0)(1,vf,8,0,"div",1),n&2&&pt(s.filterValues&&s.filterValues.length>0?0:1)},dependencies:[Le,zl],styles:[".filter-component[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:1rem;margin:0;padding:.5rem;font-size:.8rem;font-weight:500;background:linear-gradient(135deg,var(--p-surface-0) 0%,var(--p-surface-100) 100%);border-radius:8px;border:1px solid var(--p-surface-300);box-shadow:0 2px 4px #0000000d;transition:all .3s ease-in-out;flex-wrap:nowrap;overflow-x:auto;white-space:nowrap}.filter-component[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #0000001a;transform:translateY(-1px)}.filter-label[_ngcontent-%COMP%]{font-weight:700;color:var(--p-primary-700);font-size:.8rem;text-transform:uppercase;letter-spacing:.3px;margin:0;white-space:nowrap;flex-shrink:0}.filter-badges[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;gap:.5rem;align-items:center;overflow-x:auto;flex:1}.filter-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:0;border:none;flex-shrink:0}.clear-all-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.3rem;padding:.3rem .6rem;font-size:.8rem}.chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem;border-radius:16px;font-size:.8rem;font-weight:600;text-transform:uppercase;letter-spacing:.2px;border:none;cursor:pointer;transition:all .2s ease-in-out;position:relative;min-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex-shrink:0}.filter-badge-icon[_ngcontent-%COMP%]{font-size:.8rem;opacity:.8;color:var(--p-primary-600)}.filter-key[_ngcontent-%COMP%]{font-weight:700;color:var(--p-primary-800);font-size:.8rem}.filter-separator[_ngcontent-%COMP%]{color:var(--p-primary-800);font-weight:400;font-size:.8rem}.filter-value[_ngcontent-%COMP%]{font-weight:600;color:var(--p-primary-800);font-size:.8rem}.btn-outline-primary.chip[_ngcontent-%COMP%]{background:var(--p-surface-0);color:var(--p-primary-800);border:1px solid var(--p-primary-300)}.btn-outline-primary.chip[_ngcontent-%COMP%]:hover{background:var(--p-primary-50);color:var(--p-primary-900);border:1px solid var(--p-primary-400);transform:translateY(-1px);box-shadow:0 3px 6px var(--p-primary-200)}.btn-outline-warning.chip[_ngcontent-%COMP%]{background:var(--p-surface-0);color:var(--p-orange-700);border:1px solid var(--p-orange-300)}.btn-outline-warning.chip[_ngcontent-%COMP%]:hover{background:var(--p-orange-50);color:var(--p-orange-900);border:1px solid var(--p-orange-400);transform:translateY(-1px);box-shadow:0 3px 6px var(--p-orange-200)}.close-icon[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:14px;height:14px;border-radius:50%;background-color:var(--p-primary-100);color:var(--p-primary-700);font-size:.8rem;transition:all .2s ease-in-out;flex-shrink:0}.empty-state[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--p-surface-0) 0%,var(--p-surface-100) 100%);border:2px dashed var(--p-surface-300);box-shadow:none;justify-content:center}.empty-state[_ngcontent-%COMP%]:hover{transform:none;box-shadow:none}.empty-state-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:0;width:100%;overflow:hidden}.empty-state-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--p-surface-600);opacity:.6;flex-shrink:0}.empty-state-text[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex:1;overflow:hidden;white-space:nowrap}.empty-state-title[_ngcontent-%COMP%]{font-weight:700;color:var(--p-surface-700);margin:0;font-size:1rem;white-space:nowrap;flex-shrink:0}.empty-state-description[_ngcontent-%COMP%]{color:var(--p-surface-600);margin:0;font-size:1rem;line-height:1.2;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1}@media (max-width: 768px){.filter-component[_ngcontent-%COMP%]{padding:.4rem .6rem;gap:.3rem;font-size:.7rem}.filter-badges[_ngcontent-%COMP%]{gap:.2rem}.chip[_ngcontent-%COMP%]{font-size:.65rem;padding:.25rem .4rem;max-width:120px;min-height:20px}.empty-state-content[_ngcontent-%COMP%]{gap:.3rem}.empty-state-icon[_ngcontent-%COMP%]{font-size:1rem}.empty-state-title[_ngcontent-%COMP%]{font-size:.7rem}.empty-state-description[_ngcontent-%COMP%]{font-size:.65rem}}@keyframes _ngcontent-%COMP%_filterSlideIn{0%{opacity:0;transform:translateY(-5px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.chip[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_filterSlideIn .2s ease-out}.chip[_ngcontent-%COMP%]:focus{outline:2px solid var(--p-primary-500);outline-offset:1px}.chip[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none!important;background:var(--p-surface-200);color:var(--p-surface-500);border-color:var(--p-surface-300)}"]});let r=t;return r})();function yf(r,t){if(r&1&&(P(0,"th"),Se(1),L()),r&2){let e=t.$implicit;S(),He(e)}}function wf(r,t){if(r&1&&(P(0,"td"),Se(1),L()),r&2){let e=t.$implicit,i=y().$implicit;S(),He(i[e])}}function bf(r,t){if(r&1&&(P(0,"tr"),z(1,wf,2,1,"td",2),L()),r&2){let e=y();S(),w("ngForOf",e.tableOptions.columns)}}var Hc=(()=>{let t=class t{get tableOptions(){return this.widget?.config?.options}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-table"]],inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},decls:7,vars:2,consts:[[1,"table-container"],[1,"data-table"],[4,"ngFor","ngForOf"]],template:function(n,s){n&1&&(P(0,"div",0)(1,"table",1)(2,"thead")(3,"tr"),z(4,yf,2,1,"th",2),L()(),P(5,"tbody"),z(6,bf,2,1,"tr",2),L()()()),n&2&&(S(4),w("ngForOf",s.tableOptions.columns),S(2),w("ngForOf",s.tableOptions.data))},dependencies:[Le,Yr],styles:[".table-container[_ngcontent-%COMP%]{padding:1rem;overflow-x:auto}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.875rem}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem;text-align:left;border-bottom:1px solid #e5e7eb}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f9fafb;font-weight:600}.data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9fafb}"]});let r=t;return r})();var Wc=(()=>{let t=class t{get tileOptions(){return this.widget?.config?.options}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-tile"]],inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},decls:12,vars:19,consts:[[1,"tile-container"],[1,"tile-content"],[1,"tile-left"],[1,"tile-value"],[1,"tile-description"],[1,"tile-right"],[1,"tile-change"],[1,"tile-icon"]],template:function(n,s){n&1&&(P(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),Se(4),L(),P(5,"div",4),Se(6),L()(),P(7,"div",5)(8,"div",6),Se(9),L(),P(10,"div",7),he(11,"i"),L()()()()),n&2&&(Dr("background-color",s.tileOptions.backgroundColor||s.tileOptions.color)("opacity",s.tileOptions.backgroundOpacity||1),S(3),Dr("color",s.tileOptions.color),S(),He(s.tileOptions.value),S(),Dr("color",s.tileOptions.color),S(),He(s.tileOptions.description),S(2),et("change-"+s.tileOptions.changeType),Dr("color",s.tileOptions.color),S(),yr(" ",s.tileOptions.change," "),S(),Dr("color",s.tileOptions.color),S(),et(s.tileOptions.icon))},dependencies:[Le],styles:[".tile-container[_ngcontent-%COMP%]{padding:1.5rem;border-radius:.5rem;color:#fff;height:100%;display:flex;align-items:center}.tile-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%;gap:1rem}.tile-left[_ngcontent-%COMP%]{flex:1}.tile-right[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:.5rem}.tile-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin-bottom:.25rem}.tile-description[_ngcontent-%COMP%]{font-size:1.2rem;opacity:.8}.tile-change[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#fff}.tile-icon[_ngcontent-%COMP%]{font-size:1.5rem;opacity:.9;color:#fff}.change-positive[_ngcontent-%COMP%]{color:#10b981!important}.change-negative[_ngcontent-%COMP%]{color:#ef4444!important}.change-neutral[_ngcontent-%COMP%]{color:#6b7280!important}"]});let r=t;return r})();var zc=(()=>{let t=class t{get markdownOptions(){return this.widget?.config?.options}get markdownContent(){return this.markdownOptions?.content||""}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-markdown-cell"]],inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},decls:2,vars:1,consts:[[1,"markdown-container"],[1,"markdown-content",3,"innerHTML"]],template:function(n,s){n&1&&(P(0,"div",0),he(1,"div",1),L()),n&2&&(S(),w("innerHTML",s.markdownContent,$r))},dependencies:[Le],styles:[".markdown-container[_ngcontent-%COMP%]{padding:1rem;height:100%;overflow-y:auto}.markdown-content[_ngcontent-%COMP%]{line-height:1.6;color:#374151}.markdown-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin-top:1.5rem;margin-bottom:.5rem;font-weight:600;color:#111827}.markdown-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.875rem}.markdown-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem}.markdown-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem}.markdown-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:1rem}.markdown-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin-bottom:1rem;padding-left:1.5rem}.markdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.25rem}.markdown-content[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background-color:#f3f4f6;padding:.125rem .25rem;border-radius:.25rem;font-family:Courier New,monospace;font-size:.875rem}.markdown-content[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{background-color:#f3f4f6;padding:1rem;border-radius:.5rem;overflow-x:auto;margin-bottom:1rem}.markdown-content[_ngcontent-%COMP%]   blockquote[_ngcontent-%COMP%]{border-left:4px solid #d1d5db;padding-left:1rem;margin:1rem 0;font-style:italic;color:#6b7280}"]});let r=t;return r})();var Uc=(()=>{let t=class t{get codeOptions(){return this.widget?.config?.options}get codeContent(){return this.widget?.data||"// Code content will be displayed here"}get codeLanguage(){let i=this.codeOptions?.accessor||"";return i.endsWith(".ts")?"typescript":i.endsWith(".js")?"javascript":i.endsWith(".py")?"python":i.endsWith(".java")?"java":i.endsWith(".cpp")?"cpp":i.endsWith(".cs")?"csharp":"text"}copyCode(){navigator.clipboard.writeText(this.codeContent).then(()=>{}).catch(i=>{})}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-code-cell"]],inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},decls:9,vars:2,consts:[[1,"code-container"],[1,"code-header"],[1,"code-language"],["title","Copy code",1,"copy-button",3,"click"],[1,"fas","fa-copy"],[1,"code-content"]],template:function(n,s){n&1&&(P(0,"div",0)(1,"div",1)(2,"span",2),Se(3),L(),P(4,"button",3),ce("click",function(){return s.copyCode()}),he(5,"i",4),L()(),P(6,"pre",5)(7,"code"),Se(8),L()()()),n&2&&(S(3),He(s.codeLanguage),S(5),He(s.codeContent))},dependencies:[Le],styles:[".code-container[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;background-color:#1f2937;border-radius:.5rem;overflow:hidden}.code-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem 1rem;background-color:#374151;border-bottom:1px solid #4b5563}.code-language[_ngcontent-%COMP%]{color:#d1d5db;font-size:.875rem;font-weight:500;text-transform:uppercase}.copy-button[_ngcontent-%COMP%]{background:none;border:none;color:#9ca3af;cursor:pointer;padding:.25rem;border-radius:.25rem;transition:color .2s}.copy-button[_ngcontent-%COMP%]:hover{color:#d1d5db;background-color:#4b5563}.code-content[_ngcontent-%COMP%]{flex:1;margin:0;padding:1rem;overflow:auto;font-family:Courier New,Monaco,Menlo,monospace;font-size:.875rem;line-height:1.5;color:#e5e7eb;background-color:#1f2937}.code-content[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:none;padding:0;border-radius:0;font-family:inherit;font-size:inherit;color:inherit}"]});let r=t;return r})();function Cf(r,t){r&1&&$e(0)}var Gc=r=>{switch(r?.config?.component){case"echart":return sa;case"filter":return $c;case"table":return Hc;case"tile":return Wc;case"markdownCell":return zc;case"codeCell":return Uc;default:return sa}},Xc=(()=>{let t=class t{constructor(){this.viewMode="chart",this.onDataLoad=new ve,this.onUpdateFilter=new ve,this.originalWidget=null,this.tableWidget=null,this.cachedCurrentWidget=null,this.lastWidgetId=null,this.lastViewMode=null}get currentWidget(){let i=this.widget?.id,n=this.viewMode;if(this.cachedCurrentWidget&&this.lastWidgetId===i&&this.lastViewMode===n)return this.cachedCurrentWidget;let s=this.getWidgetForCurrentMode();return this.cachedCurrentWidget={component:Gc(s),inputs:{widget:s,onDataLoad:this.onDataLoad,onUpdateFilter:this.onUpdateFilter}},this.lastWidgetId=i,this.lastViewMode=n,this.cachedCurrentWidget}get isEchartComponent(){let i=this.getWidgetForCurrentMode();return Gc(i)===sa}getWidgetForCurrentMode(){return this.viewMode==="table"?this.getTableWidget():this.getOriginalWidget()}getOriginalWidget(){return this.originalWidget||(this.originalWidget=F({},this.widget)),this.originalWidget}getTableWidget(){return this.tableWidget||(this.tableWidget=this.createTableWidget()),this.tableWidget}createTableWidget(){let i=this.getOriginalWidget(),n=this.getDataExtractor(i),s=[],a=[];n?(s=n.getHeaders(i),a=n.extractData(i).map((l,u)=>{let h={};return s.forEach((f,d)=>{h[f]=l[d]||""}),h})):(s=["Property","Value"],a=[{Property:"Widget ID",Value:i.id},{Property:"Component Type",Value:i.config?.component||"Unknown"},{Property:"Title",Value:i.config?.header?.title||"Untitled"}]);let o={columns:s,data:a};return Y(F({},i),{config:Y(F({},i.config),{component:"table",options:o})})}getDataExtractor(i){let n=i.config?.component;if(n==="echart"){let s=this.getChartType(i);if(s)return this.getChartDataExtractor(s)}else return n==="table"?{extractData:s=>s.config?.options?.data||[],getHeaders:s=>s.config?.options?.columns||[],getSheetName:s=>this.getWidgetSheetName(s,"Table")}:n==="tile"?{extractData:s=>{let a=s.config?.options;return[[a?.value||"",a?.change||"",a?.changeType||"",a?.description||""]]},getHeaders:()=>["Value","Change","Type","Description"],getSheetName:s=>this.getWidgetSheetName(s,"Tile")}:this.getGenericDataExtractor()}getChartType(i){return i.config?.component==="echart"&&i.config?.options?.series?.[0]?.type?i.config.options.series[0].type:null}getChartDataExtractor(i){switch(i){case"pie":return{extractData:n=>{let s=n.config?.options?.series?.[0];return s?.data?s.data.map(a=>[a.name||"Unknown",a.value||0,this.calculatePercentage(a.value,s.data)]):[]},getHeaders:()=>["Category","Value","Percentage"],getSheetName:n=>this.getWidgetSheetName(n,"PieChart")};case"bar":return{extractData:n=>{let s=n.config?.options?.series?.[0],a=n.config?.options?.xAxis;if(!s?.data)return[];let o=[];return a&&(Array.isArray(a)?o=a[0]?.data||[]:a.data&&(o=a.data)),o.length===0&&(o=s.data.map((c,l)=>`Category ${l+1}`)),s.data.map((c,l)=>[o[l]||`Category ${l+1}`,c||0])},getHeaders:()=>["Category","Value"],getSheetName:n=>this.getWidgetSheetName(n,"BarChart")};case"line":return{extractData:n=>{let s=n.config?.options?.series,a=n.config?.options?.xAxis;if(!s||s.length===0)return[];let o=[];a&&(Array.isArray(a)?o=a[0]?.data||[]:a.data&&(o=a.data)),o.length===0&&s[0]?.data&&(o=s[0].data.map((l,u)=>`Point ${u+1}`));let c=[];return s.forEach((l,u)=>{l.data&&l.data.forEach((h,f)=>{u===0&&(c[f]=[o[f]||`Point ${f+1}`]),c[f]&&c[f].push(h||0)})}),c},getHeaders:n=>{let s=n.config?.options?.series;return!s||s.length===0?["Category"]:["Category",...s.map(a=>a.name||"Series")]},getSheetName:n=>this.getWidgetSheetName(n,"LineChart")};case"scatter":return{extractData:n=>{let s=n.config?.options?.series?.[0];return s?.data?s.data.map(a=>[a.name||"Point",Array.isArray(a.value)?a.value[0]||0:a.value||0,Array.isArray(a.value)?a.value[1]||0:""]):[]},getHeaders:()=>["Name","X","Y"],getSheetName:n=>this.getWidgetSheetName(n,"ScatterChart")};default:return this.getGenericDataExtractor()}}getGenericDataExtractor(){return{extractData:i=>{let n=[];if(n.push(["Widget ID",i.id]),n.push(["Component Type",i.config?.component||"Unknown"]),n.push(["Title",i.config?.header?.title||"Untitled"]),i.config?.options){let s=i.config.options;Object.keys(s).forEach(a=>{(typeof s[a]!="object"||s[a]===null)&&n.push([a,s[a]])})}return i.series&&i.series.length>0&&n.push(["Series Data",JSON.stringify(i.series)]),n},getHeaders:()=>["Property","Value"],getSheetName:i=>this.getWidgetSheetName(i,"Widget")}}getWidgetSheetName(i,n){let s=i.config?.header?.title||i.id;return`${n}_${s}`.replace(/[^a-zA-Z0-9_]/g,"_").substring(0,31)}calculatePercentage(i,n){let s=n.reduce((a,o)=>a+(o.value||0),0);return s===0?"0%":`${(i/s*100).toFixed(1)}%`}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-widget"]],inputs:{widget:"widget",viewMode:"viewMode"},outputs:{onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},features:[Ft([na({echarts:()=>import("./chunk-VTG26B3E.js")})])],decls:2,vars:4,consts:[[4,"ngComponentOutlet","ngComponentOutletInputs"]],template:function(n,s){n&1&&(P(0,"div"),z(1,Cf,1,0,"ng-container",0),L()),n&2&&(Dr("height",s.widget.height,"px"),S(),w("ngComponentOutlet",s.currentWidget.component)("ngComponentOutletInputs",s.currentWidget.inputs))},dependencies:[Wl],encapsulation:2});let r=t;return r})();var Tf=["header"],Sf=["icons"],Ef=["content"],If=["footer"],kf=["headericons"],Ff=["contentWrapper"],Of=["*",[["p-header"]],[["p-footer"]]],Af=["*","p-header","p-footer"],Df=(r,t)=>({"p-panel p-component":!0,"p-panel-toggleable":r,"p-panel-expanded":t}),Mf=r=>({transitionParams:r,height:"0",opacity:"0"}),Pf=r=>({value:"hidden",params:r}),Lf=r=>({transitionParams:r,height:"*",opacity:"1"}),Rf=r=>({value:"visible",params:r}),Nf=(r,t,e)=>({"p-panel-icons-start":r,"p-panel-icons-end":t,"p-panel-icons-center":e}),Bf=r=>({$implicit:r});function Vf(r,t){if(r&1&&(P(0,"span",12),Se(1),L()),r&2){let e=y(2);fe("id",e.id+"_header"),S(),He(e._header)}}function $f(r,t){r&1&&$e(0)}function Hf(r,t){}function Wf(r,t){r&1&&z(0,Hf,0,0,"ng-template")}function zf(r,t){if(r&1&&he(0,"span"),r&2){let e=y(6);et(e.expandIcon)}}function Uf(r,t){r&1&&he(0,"MinusIcon")}function Gf(r,t){if(r&1&&(Be(0),z(1,zf,1,2,"span",16)(2,Uf,1,0,"MinusIcon",14),Ve()),r&2){let e=y(5);S(),w("ngIf",e.expandIcon),S(),w("ngIf",!e.expandIcon)}}function Xf(r,t){if(r&1&&he(0,"span"),r&2){let e=y(6);et(e.collapseIcon)}}function jf(r,t){r&1&&he(0,"PlusIcon")}function Kf(r,t){if(r&1&&(Be(0),z(1,Xf,1,2,"span",16)(2,jf,1,0,"PlusIcon",14),Ve()),r&2){let e=y(5);S(),w("ngIf",e.collapseIcon),S(),w("ngIf",!e.collapseIcon)}}function Yf(r,t){if(r&1&&(Be(0),z(1,Gf,3,2,"ng-container",14)(2,Kf,3,2,"ng-container",14),Ve()),r&2){let e=y(4);S(),w("ngIf",!e.collapsed),S(),w("ngIf",e.collapsed)}}function qf(r,t){}function Qf(r,t){r&1&&z(0,qf,0,0,"ng-template")}function Zf(r,t){if(r&1&&z(0,Yf,3,2,"ng-container",14)(1,Qf,1,0,null,15),r&2){let e=y(3);w("ngIf",!e.headerIconsTemplate&&!e._headerIconsTemplate&&!(e.toggleButtonProps!=null&&e.toggleButtonProps.icon)),S(),w("ngTemplateOutlet",e.headerIconsTemplate||e._headerIconsTemplate)("ngTemplateOutletContext",Re(3,Bf,e.collapsed))}}function Jf(r,t){if(r&1){let e=ge();P(0,"p-button",13),ce("click",function(n){X(e);let s=y(2);return j(s.onIconClick(n))})("keydown",function(n){X(e);let s=y(2);return j(s.onKeyDown(n))}),z(1,Zf,2,5,"ng-template",null,1,ct),L()}if(r&2){let e=y(2);w("text",!0)("rounded",!0)("buttonProps",e.toggleButtonProps),fe("id",e.id+"_header")("aria-label",e.buttonAriaLabel)("aria-controls",e.id+"_content")("aria-expanded",!e.collapsed)}}function ed(r,t){if(r&1){let e=ge();P(0,"div",8),ce("click",function(n){X(e);let s=y();return j(s.onHeaderClick(n))}),z(1,Vf,2,2,"span",9),li(2,1),z(3,$f,1,0,"ng-container",6),P(4,"div",10),z(5,Wf,1,0,null,6)(6,Jf,3,7,"p-button",11),L()()}if(r&2){let e=y();fe("id",e.id+"-titlebar"),S(),w("ngIf",e._header),S(2),w("ngTemplateOutlet",e.headerTemplate||e._headerTemplate),S(),w("ngClass",nn(6,Nf,e.iconPos==="start",e.iconPos==="end",e.iconPos==="center")),S(),w("ngTemplateOutlet",e.iconTemplate||e._iconTemplate),S(),w("ngIf",e.toggleable)}}function td(r,t){r&1&&$e(0)}function rd(r,t){r&1&&$e(0)}function id(r,t){if(r&1&&(P(0,"div",17),li(1,2),z(2,rd,1,0,"ng-container",6),L()),r&2){let e=y();S(2),w("ngTemplateOutlet",e.footerTemplate||e._footerTemplate)}}var nd=({dt:r})=>`
.p-panel {
    border: 1px solid ${r("panel.border.color")};
    border-radius: ${r("panel.border.radius")};
    background: ${r("panel.background")};
    color: ${r("panel.color")};
}

.p-panel-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: ${r("panel.header.padding")};
    background: ${r("panel.header.background")};
    color: ${r("panel.header.color")};
    border-style: solid;
    border-width: ${r("panel.header.border.width")};
    border-color: ${r("panel.header.border.color")};
    border-radius: ${r("panel.header.border.radius")};
}

.p-panel-toggleable .p-panel-header {
    padding: ${r("panel.toggleable.header.padding")};
}

.p-panel-title {
    line-height: 1;
    font-weight: ${r("panel.title.font.weight")};
}

.p-panel-content {
    padding: ${r("panel.content.padding")};
}

.p-panel-footer {
    padding: ${r("panel.footer.padding")};
}

/* For PrimeNG */
.p-panel-toggleable.p-panel-expanded > .p-panel-content-container:not(.ng-animating) {
    overflow: visible
}

.p-panel-toggleable .p-panel-content-container {
    overflow: hidden;
}
`,sd={root:({props:r})=>["p-panel p-component",{"p-panel-toggleable":r.toggleable}],header:"p-panel-header",title:"p-panel-title",headerActions:"p-panel-header-actions",pcToggleButton:"p-panel-toggle-button",contentContainer:"p-panel-content-container",content:"p-panel-content",footer:"p-panel-footer"},jc=(()=>{class r extends pr{name="panel";theme=nd;classes=sd;static \u0275fac=(()=>{let e;return function(n){return(e||(e=bt(r)))(n||r)}})();static \u0275prov=yt({token:r,factory:r.\u0275fac})}return r})();var Oo=(()=>{class r extends tr{toggleable;_header;collapsed;style;styleClass;iconPos="end";expandIcon;collapseIcon;showHeader=!0;toggler="icon";transitionOptions="400ms cubic-bezier(0.86, 0, 0.07, 1)";toggleButtonProps;collapsedChange=new ve;onBeforeToggle=new ve;onAfterToggle=new ve;footerFacet;animating;headerTemplate;iconTemplate;contentTemplate;footerTemplate;headerIconsTemplate;_headerTemplate;_iconTemplate;_contentTemplate;_footerTemplate;_headerIconsTemplate;contentWrapperViewChild;id=qr("pn_id_");get buttonAriaLabel(){return this._header}_componentStyle=at(jc);onHeaderClick(e){this.toggler==="header"&&this.toggle(e)}onIconClick(e){this.toggler==="icon"&&this.toggle(e)}toggle(e){if(this.animating)return!1;this.animating=!0,this.onBeforeToggle.emit({originalEvent:e,collapsed:this.collapsed}),this.toggleable&&(this.collapsed?this.expand():this.collapse()),this.cd.markForCheck(),e.preventDefault()}expand(){this.collapsed=!1,this.collapsedChange.emit(this.collapsed),this.updateTabIndex()}collapse(){this.collapsed=!0,this.collapsedChange.emit(this.collapsed),this.updateTabIndex()}getBlockableElement(){return this.el.nativeElement.children[0]}updateTabIndex(){this.contentWrapperViewChild&&this.contentWrapperViewChild.nativeElement.querySelectorAll('input, button, select, a, textarea, [tabindex]:not([tabindex="-1"])').forEach(i=>{this.collapsed?i.setAttribute("tabindex","-1"):i.removeAttribute("tabindex")})}onKeyDown(e){(e.code==="Enter"||e.code==="Space")&&(this.toggle(e),e.preventDefault())}onToggleDone(e){this.animating=!1,this.onAfterToggle.emit({originalEvent:e,collapsed:this.collapsed})}templates;ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"header":this._headerTemplate=e.template;break;case"content":this._contentTemplate=e.template;break;case"footer":this._footerTemplate=e.template;break;case"icons":this._iconTemplate=e.template;break;case"headericons":this._headerIconsTemplate=e.template;break;default:this._contentTemplate=e.template;break}})}static \u0275fac=(()=>{let e;return function(n){return(e||(e=bt(r)))(n||r)}})();static \u0275cmp=Oe({type:r,selectors:[["p-panel"]],contentQueries:function(i,n,s){if(i&1&&(Ue(s,nc,5),Ue(s,Tf,4),Ue(s,Sf,4),Ue(s,Ef,4),Ue(s,If,4),Ue(s,kf,4),Ue(s,er,4)),i&2){let a;de(a=pe())&&(n.footerFacet=a.first),de(a=pe())&&(n.headerTemplate=a.first),de(a=pe())&&(n.iconTemplate=a.first),de(a=pe())&&(n.contentTemplate=a.first),de(a=pe())&&(n.footerTemplate=a.first),de(a=pe())&&(n.headerIconsTemplate=a.first),de(a=pe())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&Ae(Ff,5),i&2){let s;de(s=pe())&&(n.contentWrapperViewChild=s.first)}},inputs:{toggleable:[2,"toggleable","toggleable",be],_header:[0,"header","_header"],collapsed:[2,"collapsed","collapsed",be],style:"style",styleClass:"styleClass",iconPos:"iconPos",expandIcon:"expandIcon",collapseIcon:"collapseIcon",showHeader:[2,"showHeader","showHeader",be],toggler:"toggler",transitionOptions:"transitionOptions",toggleButtonProps:"toggleButtonProps"},outputs:{collapsedChange:"collapsedChange",onBeforeToggle:"onBeforeToggle",onAfterToggle:"onAfterToggle"},features:[Ft([jc]),Ht],ngContentSelectors:Af,decls:8,vars:25,consts:[["contentWrapper",""],["icon",""],[3,"ngClass","ngStyle"],["class","p-panel-header",3,"click",4,"ngIf"],["role","region",1,"p-panel-content-container",3,"id"],[1,"p-panel-content"],[4,"ngTemplateOutlet"],["class","p-panel-footer",4,"ngIf"],[1,"p-panel-header",3,"click"],["class","p-panel-title",4,"ngIf"],[1,"p-panel-icons",3,"ngClass"],["severity","secondary","type","button","role","button","styleClass","p-panel-header-icon p-panel-toggler p-link",3,"text","rounded","buttonProps","click","keydown",4,"ngIf"],[1,"p-panel-title"],["severity","secondary","type","button","role","button","styleClass","p-panel-header-icon p-panel-toggler p-link",3,"click","keydown","text","rounded","buttonProps"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"class",4,"ngIf"],[1,"p-panel-footer"]],template:function(i,n){if(i&1){let s=ge();Vi(Of),P(0,"div",2),z(1,ed,7,10,"div",3),P(2,"div",4),ce("@panelContent.done",function(o){return X(s),j(n.onToggleDone(o))}),P(3,"div",5,0),li(5),z(6,td,1,0,"ng-container",6),L(),z(7,id,3,1,"div",7),L()()}i&2&&(et(n.styleClass),w("ngClass",Ct(14,Df,n.toggleable,!n.collapsed&&n.toggleable))("ngStyle",n.style),fe("id",n.id)("data-pc-name","panel"),S(),w("ngIf",n.showHeader),S(),w("id",n.id+"_content")("@panelContent",n.collapsed?Re(19,Pf,Re(17,Mf,n.animating?n.transitionOptions:"0ms")):Re(23,Rf,Re(21,Lf,n.animating?n.transitionOptions:"0ms"))),fe("aria-labelledby",n.id+"_header")("aria-hidden",n.collapsed)("tabindex",n.collapsed?"-1":void 0),S(4),w("ngTemplateOutlet",n.contentTemplate||n._contentTemplate),S(),w("ngIf",n.footerFacet||n.footerTemplate||n._footerTemplate))},dependencies:[Le,Wt,Tt,Jt,St,cc,lc,Jr,Ci,tt],encapsulation:2,data:{animation:[bi("panelContent",[Vs("hidden",Cr({height:"0"})),Vs("void",Cr({height:"{{height}}"}),{params:{height:"0"}}),Vs("visible",Cr({height:"*"})),Tr("visible <=> hidden",[br("{{transitionParams}}")]),Tr("void => hidden",br("{{transitionParams}}")),Tr("void => visible",br("{{transitionParams}}"))])]},changeDetection:0})}return r})(),aa=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=$t({type:r});static \u0275inj=Vt({imports:[Oo,tt,tt]})}return r})();var od=["maskRef"],ld=["container"],cd=["closeButton"],ud=["*"],hd=(r,t)=>({transform:r,transition:t}),fd=r=>({value:"visible",params:r});function dd(r,t){r&1&&$e(0)}function pd(r,t){if(r&1&&z(0,dd,1,0,"ng-container",4),r&2){let e=y(2);w("ngTemplateOutlet",e.headlessTemplate||e._headlessTemplate)}}function md(r,t){r&1&&$e(0)}function gd(r,t){r&1&&he(0,"TimesIcon"),r&2&&fe("data-pc-section","closeicon")}function xd(r,t){}function _d(r,t){r&1&&z(0,xd,0,0,"ng-template")}function vd(r,t){if(r&1&&(P(0,"span",10),z(1,_d,1,0,null,4),L()),r&2){let e=y(4);fe("data-pc-section","closeicon"),S(),w("ngTemplateOutlet",e.closeIconTemplate||e._closeIconTemplate)}}function yd(r,t){if(r&1){let e=ge();P(0,"p-button",8),ce("onClick",function(n){X(e);let s=y(3);return j(s.close(n))})("keydown.enter",function(n){X(e);let s=y(3);return j(s.close(n))}),z(1,gd,1,1,"TimesIcon",7)(2,vd,2,2,"span",9),L()}if(r&2){let e=y(3);w("ngClass",e.cx("closeButton"))("buttonProps",e.closeButtonProps)("ariaLabel",e.ariaCloseLabel),fe("data-pc-section","closebutton")("data-pc-group-section","iconcontainer"),S(),w("ngIf",!e.closeIconTemplate&&!e._closeIconTemplate),S(),w("ngIf",e.closeIconTemplate||e._closeIconTemplate)}}function wd(r,t){r&1&&$e(0)}function bd(r,t){r&1&&$e(0)}function Cd(r,t){if(r&1&&(Be(0),P(1,"div",5),z(2,bd,1,0,"ng-container",4),L(),Ve()),r&2){let e=y(3);S(),w("ngClass",e.cx("footer")),fe("data-pc-section","footer"),S(),w("ngTemplateOutlet",e.footerTemplate||e._footerTemplate)}}function Td(r,t){if(r&1&&(P(0,"div",5),z(1,md,1,0,"ng-container",4)(2,yd,3,7,"p-button",6),L(),P(3,"div",5),li(4),z(5,wd,1,0,"ng-container",4),L(),z(6,Cd,3,3,"ng-container",7)),r&2){let e=y(2);w("ngClass",e.cx("header")),fe("data-pc-section","header"),S(),w("ngTemplateOutlet",e.headerTemplate||e._headerTemplate),S(),w("ngIf",e.showCloseIcon),S(),w("ngClass",e.cx("content")),fe("data-pc-section","content"),S(2),w("ngTemplateOutlet",e.contentTemplate||e._contentTemplate),S(),w("ngIf",e.footerTemplate||e._footerTemplate)}}function Sd(r,t){if(r&1){let e=ge();P(0,"div",2,0),ce("@panelState.start",function(n){X(e);let s=y();return j(s.onAnimationStart(n))})("@panelState.done",function(n){X(e);let s=y();return j(s.onAnimationEnd(n))})("click",function(n){X(e);let s=y();return j(s.maskClickListener(n))}),P(2,"div",3),ce("keydown",function(n){X(e);let s=y();return j(s.onKeyDown(n))}),dt(3,pd,1,1,"ng-container")(4,Td,7,8),L()()}if(r&2){let e=y();Qt(e.maskStyle),w("ngClass",e.cx("mask"))("ngStyle",e.sx("mask"))("@panelState",Re(15,fd,Ct(12,hd,e.transformOptions,e.transitionOptions))),fe("data-pc-name","mask")("data-pc-section","mask"),S(2),et(e.styleClass),w("ngClass",e.cx("root")),fe("data-pc-section","root"),S(),pt(e.headlessTemplate||e._headlessTemplate?3:4)}}var Ed=({dt:r})=>`

.p-drawer {
    display: flex;
    flex-direction: column;
    pointer-events: auto;
    transform: translate3d(0px, 0px, 0px);
    position: relative;
    transition: transform 0.3s;
    background: ${r("drawer.background")};
    color: ${r("drawer.color")};
    border: 1px solid ${r("drawer.border.color")};
    box-shadow: ${r("drawer.shadow")};
}

.p-drawer-content {
    overflow-y: auto;
    flex-grow: 1;
    padding: ${r("drawer.content.padding")};
}

.p-drawer-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-shrink: 0;
    padding: ${r("drawer.header.padding")};
}

.p-drawer-footer {
    padding: ${r("drawer.header.padding")};
}

.p-drawer-title {
    font-weight: ${r("drawer.title.font.weight")};
    font-size: ${r("drawer.title.font.size")};
}

.p-drawer-full .p-drawer {
    transition: none;
    transform: none;
    width: 100vw !important;
    height: 100vh !important;
    max-height: 100%;
    top: 0px !important;
    left: 0px !important;
    border-width: 1px;
}

/* PrimeVue animations

.p-drawer-left .p-drawer-enter-from,
.p-drawer-left .p-drawer-leave-to {
    transform: translateX(-100%);
}

.p-drawer-right .p-drawer-enter-from,
.p-drawer-right .p-drawer-leave-to {
    transform: translateX(100%);
}

.p-drawer-top .p-drawer-enter-from,
.p-drawer-top .p-drawer-leave-to {
    transform: translateY(-100%);
}

.p-drawer-bottom .p-drawer-enter-from,
.p-drawer-bottom .p-drawer-leave-to {
    transform: translateY(100%);
}

.p-drawer-full .p-drawer-enter-from,
.p-drawer-full .p-drawer-leave-to {
    opacity: 0;
}

.p-drawer-full .p-drawer-enter-active,
.p-drawer-full .p-drawer-leave-active {
    transition: opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1);
}
*/

.p-drawer-left .p-drawer {
    align-self: start;
    width: 20rem;
    height: 100%;
    border-right-width: 1px;
}

.p-drawer-right .p-drawer {
    align-self: end;
    width: 20rem;
    height: 100%;
    border-left-width: 1px;
}

.p-drawer-top .p-drawer {

    height: 10rem;
    width: 100%;
    border-bottom-width: 1px;
}

.p-drawer-bottom .p-drawer {
    height: 10rem;
    width: 100%;
    border-top-width: 1px;
}

.p-drawer-left .p-drawer-content,
.p-drawer-right .p-drawer-content,
.p-drawer-top .p-drawer-content,
.p-drawer-bottom .p-drawer-content {
    width: 100%;
    height: 100%;
}

.p-drawer-open {
    display: flex;
}

.p-drawer-top {
    justify-content: flex-start;
}

.p-drawer-bottom {
    justify-content: flex-end;
}
`,Id={mask:({instance:r})=>({position:"fixed",height:"100%",width:"100%",left:0,top:0,display:"flex",flexDirection:"column",alignItems:r.position==="top"?"flex-start":r.position==="bottom"?"flex-end":"center"})},kd={mask:({instance:r})=>({"p-drawer-mask":!0,"p-overlay-mask p-overlay-mask-enter":r.modal,"p-drawer-open":r.containerVisible,"p-drawer-full":r.fullScreen,[`p-drawer-${r.position}`]:!!r.position}),root:({instance:r})=>({"p-drawer p-component":!0,"p-drawer-full":r.fullScreen}),header:"p-drawer-header",title:"p-drawer-title",pcCloseButton:"p-drawer-close-button",content:"p-drawer-content",footer:"p-drawer-footer"},Kc=(()=>{class r extends pr{name="drawer";theme=Ed;classes=kd;inlineStyles=Id;static \u0275fac=(()=>{let e;return function(n){return(e||(e=bt(r)))(n||r)}})();static \u0275prov=yt({token:r,factory:r.\u0275fac})}return r})(),Fd=Ja([Cr({transform:"{{transform}}",opacity:0}),br("{{transition}}")]),Od=Ja([br("{{transition}}",Cr({transform:"{{transform}}",opacity:0}))]),Ao=(()=>{class r extends tr{appendTo="body";blockScroll=!1;style;styleClass;ariaCloseLabel;autoZIndex=!0;baseZIndex=0;modal=!0;closeButtonProps;dismissible=!0;showCloseIcon=!0;closeOnEscape=!0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";get visible(){return this._visible}set visible(e){this._visible=e}get position(){return this._position}set position(e){switch(this._position=e,e){case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break}}get fullScreen(){return this._fullScreen}set fullScreen(e){this._fullScreen=e,e&&(this.transformOptions="none")}maskStyle;onShow=new ve;onHide=new ve;visibleChange=new ve;maskRef;containerViewChild;closeButtonViewChild;initialized;_visible;_position="left";_fullScreen=!1;container;transformOptions="translate3d(-100%, 0px, 0px)";mask;documentEscapeListener;_componentStyle=at(Kc);headerTemplate;footerTemplate;closeIconTemplate;headlessTemplate;contentTemplate;templates;_headerTemplate;_footerTemplate;_contentTemplate;_closeIconTemplate;_headlessTemplate;ngAfterViewInit(){super.ngAfterViewInit(),this.initialized=!0}ngOnChanges(e){super.ngOnChanges(e);let i=Object.keys(e).find(n=>n.includes("Template"));i&&(this[`_${i}`]=e[i].currentValue)}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this._contentTemplate=e.template;break;case"header":this._headerTemplate=e.template;break;case"footer":this._footerTemplate=e.template;break;case"closeicon":this._closeIconTemplate=e.template;break;case"headless":this._headlessTemplate=e.template;break;default:this._contentTemplate=e.template;break}})}onKeyDown(e){e.code==="Escape"&&this.hide(!1)}show(){this.autoZIndex&&Sr.set("modal",this.container,this.baseZIndex||this.config.zIndex.modal),this.onShow.emit({}),this.visibleChange.emit(!0)}hide(e=!0){e&&this.onHide.emit({})}close(e){this.hide(),this.visibleChange.emit(!1),e.preventDefault()}maskClickListener(e){this.dismissible&&this.close(e),this.blockScroll&&jl()}onAnimationStart(e){switch(e.toState){case"visible":this.container=e.element,this.appendContainer(),this.show(),this.closeOnEscape&&this.bindDocumentEscapeListener();break}}onAnimationEnd(e){switch(e.toState){case"void":this.hide(!1),Sr.clear(this.container),this.unbindGlobalListeners();break}}appendContainer(){if(this.appendTo)return this.appendTo==="body"?this.renderer.appendChild(this.document.body,this.container):un(this.appendTo,this.container)}bindDocumentEscapeListener(){let e=this.el?this.el.nativeElement.ownerDocument:this.document;this.documentEscapeListener=this.renderer.listen(e,"keydown",i=>{i.which==27&&parseInt(this.container.style.zIndex)===Sr.get(this.container)&&this.close(i)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}unbindGlobalListeners(){this.unbindDocumentEscapeListener()}ngOnDestroy(){this.initialized=!1,this.appendTo&&this.container&&this.renderer.appendChild(this.el.nativeElement,this.container),this.container&&this.autoZIndex&&Sr.clear(this.container),this.container=null,this.unbindGlobalListeners(),super.ngOnDestroy()}static \u0275fac=(()=>{let e;return function(n){return(e||(e=bt(r)))(n||r)}})();static \u0275cmp=Oe({type:r,selectors:[["p-sidebar"]],contentQueries:function(i,n,s){if(i&1&&Ue(s,er,4),i&2){let a;de(a=pe())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&(Ae(od,5),Ae(ld,5),Ae(cd,5)),i&2){let s;de(s=pe())&&(n.maskRef=s.first),de(s=pe())&&(n.containerViewChild=s.first),de(s=pe())&&(n.closeButtonViewChild=s.first)}},inputs:{appendTo:"appendTo",blockScroll:[2,"blockScroll","blockScroll",be],style:"style",styleClass:"styleClass",ariaCloseLabel:"ariaCloseLabel",autoZIndex:[2,"autoZIndex","autoZIndex",be],baseZIndex:[2,"baseZIndex","baseZIndex",Ot],modal:[2,"modal","modal",be],closeButtonProps:"closeButtonProps",dismissible:[2,"dismissible","dismissible",be],showCloseIcon:[2,"showCloseIcon","showCloseIcon",be],closeOnEscape:[2,"closeOnEscape","closeOnEscape",be],transitionOptions:"transitionOptions",visible:"visible",position:"position",fullScreen:"fullScreen",maskStyle:"maskStyle",headerTemplate:"headerTemplate",footerTemplate:"footerTemplate",closeIconTemplate:"closeIconTemplate",headlessTemplate:"headlessTemplate",contentTemplate:"contentTemplate"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange"},features:[Ft([Kc]),Ht,ai],ngContentSelectors:ud,decls:1,vars:1,consts:[["maskRef",""],[3,"ngClass","ngStyle","style","click",4,"ngIf"],[3,"click","ngClass","ngStyle"],[3,"keydown","ngClass"],[4,"ngTemplateOutlet"],[3,"ngClass"],[3,"ngClass","buttonProps","ariaLabel","onClick","keydown.enter",4,"ngIf"],[4,"ngIf"],[3,"onClick","keydown.enter","ngClass","buttonProps","ariaLabel"],["class","p-sidebar-close-icon",4,"ngIf"],[1,"p-sidebar-close-icon"]],template:function(i,n){i&1&&(Vi(),z(0,Sd,5,17,"div",1)),i&2&&w("ngIf",n.visible)},dependencies:[Le,Wt,Tt,Jt,St,tt,is,Jr,Ci],encapsulation:2,data:{animation:[bi("panelState",[Tr("void => visible",[eo(Fd)]),Tr("visible => void",[eo(Od)])])]},changeDetection:0})}return r})(),Yc=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=$t({type:r});static \u0275inj=Vt({imports:[Ao,tt,tt]})}return r})();var Md=["item"],Pd=["previousicon"],Ld=["nexticon"],Rd=["content"],Nd=["navbar"],Bd=["inkbar"],Vd=["prevBtn"],$d=["nextBtn"],Hd=["tabLink"],Wd=["tab"],zd=r=>({"p-tabmenu p-component":!0,"p-tabmenu-scrollable":r}),Ud=(r,t,e)=>({"p-tabmenuitem":!0,"p-disabled":r,"p-tabmenuitem-active":t,"p-hidden":e}),Gd=(r,t)=>({$implicit:r,index:t}),Xd=()=>({exact:!1});function jd(r,t){r&1&&he(0,"ChevronLeftIcon"),r&2&&fe("aria-hidden",!0)}function Kd(r,t){}function Yd(r,t){r&1&&z(0,Kd,0,0,"ng-template")}function qd(r,t){if(r&1){let e=ge();P(0,"button",17,3),ce("click",function(){X(e);let n=y();return j(n.navBackward())}),z(2,jd,1,1,"ChevronLeftIcon",18)(3,Yd,1,0,null,19),L()}if(r&2){let e=y();S(2),w("ngIf",!e.previousIconTemplate&&!e._previousIconTemplate),S(),w("ngTemplateOutlet",e.previousIconTemplate||e._previousIconTemplate)}}function Qd(r,t){if(r&1&&he(0,"span",28),r&2){let e=y(2).$implicit;w("ngClass",e.icon)("ngStyle",e.iconStyle)}}function Zd(r,t){if(r&1&&(P(0,"span",29),Se(1),L()),r&2){let e=y(2).$implicit,i=y();S(),He(i.getItemProp(e,"label"))}}function Jd(r,t){if(r&1&&he(0,"span",30),r&2){let e=y(2).$implicit,i=y();w("innerHTML",i.getItemProp(e,"label"),$r)}}function ep(r,t){if(r&1&&he(0,"p-badge",31),r&2){let e=y(2).$implicit,i=y();w("styleClass",e.badgeStyleClass)("value",i.getItemProp(e,"badge"))}}function tp(r,t){if(r&1&&(P(0,"a",24,5),Be(2),z(3,Qd,1,2,"span",25)(4,Zd,2,1,"span",26)(5,Jd,1,1,"ng-template",null,6,ct)(7,ep,1,2,"p-badge",27),Ve(),L()),r&2){let e=mt(6),i=y().$implicit,n=y();w("target",n.getItemProp(i,"target"))("tabindex",-1),fe("href",n.getItemProp(i,"url"),rn)("id",n.getItemProp(i,"id"))("aria-disabled",n.disabled(i)),S(3),w("ngIf",i.icon),S(),w("ngIf",i.escape!==!1)("ngIfElse",e),S(3),w("ngIf",i.badge)}}function rp(r,t){if(r&1&&he(0,"span",28),r&2){let e=y(2).$implicit;w("ngClass",e.icon)("ngStyle",e.iconStyle),fe("aria-hidden",!0)}}function ip(r,t){if(r&1&&(P(0,"span",29),Se(1),L()),r&2){let e=y(2).$implicit,i=y();S(),He(i.getItemProp(e,"label"))}}function np(r,t){if(r&1&&he(0,"span",30),r&2){let e=y(2).$implicit,i=y();w("innerHTML",i.getItemProp(e,"label"),$r)}}function sp(r,t){if(r&1&&he(0,"p-badge",31),r&2){let e=y(2).$implicit,i=y();w("styleClass",e.badgeStyleClass)("value",i.getItemProp(e,"badge"))}}function ap(r,t){if(r&1&&(P(0,"a",32,5),Be(2),z(3,rp,1,3,"span",25)(4,ip,2,1,"span",26)(5,np,1,1,"ng-template",null,7,ct)(7,sp,1,2,"p-badge",27),Ve(),L()),r&2){let e=mt(6),i=y().$implicit,n=y();w("routerLink",i.routerLink)("queryParams",i.queryParams)("routerLinkActive","p-menuitem-link-active")("routerLinkActiveOptions",i.routerLinkActiveOptions||Zt(18,Xd))("target",i.target)("tabindex",-1)("fragment",i.fragment)("queryParamsHandling",i.queryParamsHandling)("preserveFragment",i.preserveFragment)("skipLocationChange",i.skipLocationChange)("replaceUrl",i.replaceUrl)("state",i.state),fe("id",n.getItemProp(i,"id"))("aria-disabled",n.disabled(i)),S(3),w("ngIf",i.icon),S(),w("ngIf",i.escape!==!1)("ngIfElse",e),S(3),w("ngIf",i.badge)}}function op(r,t){r&1&&$e(0)}function lp(r,t){if(r&1){let e=ge();P(0,"li",20,4),ce("click",function(n){let s=X(e).$implicit,a=y();return j(a.itemClick(n,s))})("keydown",function(n){let s=X(e),a=s.$implicit,o=s.index,c=y();return j(c.onKeydownItem(n,o,a))})("focus",function(){let n=X(e).$implicit,s=y();return j(s.onMenuItemFocus(n))}),z(2,tp,8,9,"a",21)(3,ap,8,19,"a",22)(4,op,1,0,"ng-container",23),L()}if(r&2){let e=t.$implicit,i=t.index,n=y();et(e.styleClass),w("ngStyle",e.style)("ngClass",nn(13,Ud,n.getItemProp(e,"disabled"),n.isActive(e),e.visible===!1))("tooltipOptions",e.tooltipOptions),fe("data-p-disabled",n.disabled(e))("data-p-highlight",n.focusedItemInfo()===e)("aria-label",n.getItemProp(e,"label"))("tabindex",n.disabled(e)?-1:0),S(2),w("ngIf",!e.routerLink&&!n.itemTemplate&&!n._itemTemplate),S(),w("ngIf",e.routerLink&&!n.itemTemplate&&!n._itemTemplate),S(),w("ngTemplateOutlet",n.itemTemplate)("ngTemplateOutletContext",Ct(17,Gd,e,i))}}function cp(r,t){r&1&&he(0,"ChevronRightIcon"),r&2&&fe("aria-hidden",!0)}function up(r,t){}function hp(r,t){r&1&&z(0,up,0,0,"ng-template")}function fp(r,t){if(r&1){let e=ge();P(0,"button",33,8),ce("click",function(){X(e);let n=y();return j(n.navForward())}),z(2,cp,1,1,"ChevronRightIcon",18)(3,hp,1,0,null,19),L()}if(r&2){let e=y();S(2),w("ngIf",!e.previousIconTemplate&&!e._previousIconTemplate),S(),w("ngTemplateOutlet",e.nextIconTemplate||e._nextIconTemplate)}}var dp=({dt:r})=>`

/* For PrimeNG */
.p-tabmenu.p-component {
    display: flex;
    flex-direction: column;
}

.p-tabmenu-nav-container {
    display: flex;
    position: relative;
}

.p-tabmenu.p-tabmenu-scrollable .p-tabmenu-nav-container {
    overflow: hidden;
}

.p-tabmenu-nav-content {
    flex-grow: 1;
    overflow-x: auto;
    overflow-y: hidden;
    scroll-behavior: smooth;
    scrollbar-width: none;
    overscroll-behavior: contain auto;
}

.p-tabmenu-nav {
    padding: 0;
    margin: 0;
    list-style-type: none;
    position: relative;
    display: flex;
    flex-wrap: nowrap;
    background: ${r("tabs.tablist.background")};
    border-style: solid;
    border-color: ${r("tabs.tablist.border.color")};
    border-width: ${r("tabs.tablist.border.width")};
}

.p-tabmenuitem {
    display: flex;
    flex-shrink: 0;
    cursor: pointer;
    position: relative;
    border-style: solid;
    background: ${r("tabs.tab.background")};
    border-width: ${r("tabs.tab.border.width")};
    border-color: ${r("tabs.tab.border.color")};
    padding: ${r("tabs.tab.padding")};
    transition: background ${r("tabs.transition.duration")}, border-color ${r("tabs.transition.duration")}, color ${r("tabs.transition.duration")}, outline-color ${r("tabs.transition.duration")}, box-shadow ${r("tabs.transition.duration")};
    margin: ${r("tabs.tab.margin")};
    outline-color: transparent;
}

.p-tabmenuitem > .p-menuitem-link {
    white-space: nowrap;
    user-select: none;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
    gap: ${r("tabs.tab.gap")};
    color: ${r("tabs.tab.color")};
    font-weight: ${r("tabs.tab.font.weight")};
}

.p-tabmenuitem.p-tabmenuitem-active .p-menuitem-link {
    color: ${r("tabs.tab.active.color")};
}

.p-tabmenuitem:not(.p-disabled):focus-visible {
    z-index: 1;
    box-shadow: ${r("tabs.tab.focus.ring.shadow")};
    outline: ${r("tabs.tab.focus.ring.width")} ${r("tabs.tab.focus.ring.style")} ${r("tabs.tab.focus.ring.color")};
    outline-offset: ${r("tabs.tab.focus.ring.offset")};
}

.p-tabmenuitem:not(.p-tabmenuitem-active):not(.p-disabled):hover {
    background: ${r("tabs.tab.hover.background")};
    border-color: ${r("tabs.tab.hover.border.color")};
    color: ${r("tabs.tab.hover.color")};
}

.p-tabmenuitem-active {
    background: ${r("tabs.tab.active.background")};
    border-color: ${r("tabs.tab.active.border.color")};
    color: ${r("tabs.tab.active.color")};
}

.p-tabmenuitem-active-bar {
    z-index: 1;
    display: block;
    position: absolute;
    bottom: ${r("tabs.active.bar.bottom")};
    height: ${r("tabs.active.bar.height")};
    background: ${r("tabs.active.bar.background")};
    transition: 250ms cubic-bezier(0.35, 0, 0.25, 1);
}

.p-tabmenu-nav-button {
    all: unset;
    position: absolute !important;
    flex-shrink: 0;
    top: 0;
    z-index: 2;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: ${r("tabs.nav.button.background")};
    color: ${r("tabs.nav.button.color")};
    width: ${r("tabs.nav.button.width")};
    transition: color ${r("tabs.transition.duration")}, outline-color ${r("tabs.transition.duration")}, box-shadow ${r("tabs.transition.duration")};
    box-shadow: ${r("tabs.nav.button.shadow")};
    outline-color: transparent;
    cursor: pointer;
}

.p-tabmenu-nav-button:focus-visible {
    z-index: 1;
    box-shadow: ${r("tabs.nav.button.focus.ring.shadow")};
    outline: ${r("tabs.nav.button.focus.ring.width")} ${r("tabs.nav.button.focus.ring.style")} ${r("tabs.nav.button.focus.ring.color")};
    outline-offset: ${r("tabs.nav.button.focus.ring.offset")};
}

.p-tabmenu-nav-button:hover {
    color: ${r("tabs.nav.button.hover.color")};
}

.p-tabmenu-nav-prev-button {
    left: 0;
}

.p-tabmenu-nav-next-button {
    right: 0;
}`,qc=(()=>{class r extends pr{name="tabs";theme=dp;static \u0275fac=(()=>{let e;return function(n){return(e||(e=bt(r)))(n||r)}})();static \u0275prov=yt({token:r,factory:r.\u0275fac})}return r})();var pp=(()=>{class r extends tr{set model(e){this._model=e,this._focusableItems=(this._model||[]).reduce((i,n)=>(i.push(n),i),[])}get model(){return this._model}set activeItem(e){this._activeItem=e,this.activeItemChange.emit(e),this.tabChanged=!0}get activeItem(){return this._activeItem}scrollable;popup;style;styleClass;ariaLabel;ariaLabelledBy;activeItemChange=new ve;content;navbar;inkbar;prevBtn;nextBtn;tabLink;tab;itemTemplate;previousIconTemplate;nextIconTemplate;templates;_itemTemplate;_nextIconTemplate;_previousIconTemplate;tabChanged;backwardIsDisabled=!0;forwardIsDisabled=!1;timerIdForInitialAutoScroll=null;_focusableItems;_model;_activeItem;focusedItemInfo=wt(null);router=at(Xl);route=at(Gl);_componentStyle=at(qc);get focusableItems(){return(!this._focusableItems||!this._focusableItems.length)&&(this._focusableItems=(this.model||[]).reduce((e,i)=>(e.push(i),e),[])),this._focusableItems}constructor(){super(),console.log("TabMenu is deprecated as of v18. Use tabs component instead https://primeng.org/tabs#tabmenu")}ngAfterViewInit(){super.ngAfterViewInit(),wr(this.platformId)&&(this.updateInkBar(),this.initAutoScrollForActiveItem(),this.initButtonState())}ngAfterViewChecked(){wr(this.platformId)&&(this.updateInkBar(),this.tabChanged=!1)}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"item":this._itemTemplate=e.template;break;case"nexticon":this._nextIconTemplate=e.template;break;case"previousicon":this._previousIconTemplate=e.template;break;default:this._itemTemplate=e.template;break}})}ngOnDestroy(){this.clearAutoScrollHandler(),super.ngOnDestroy()}isActive(e){if(e.routerLink){let i=Array.isArray(e.routerLink)?e.routerLink:[e.routerLink];return this.router.isActive(this.router.createUrlTree(i,{relativeTo:this.route}).toString(),e.routerLinkActiveOptions?.exact??e.routerLinkActiveOptions??!1)}return e===this.activeItem}getItemProp(e,i){return e?es(e[i]):void 0}visible(e){return typeof e.visible=="function"?e.visible():e.visible!==!1}disabled(e){return typeof e.disabled=="function"?e.disabled():e.disabled}onMenuItemFocus(e){this.focusedItemInfo.set(e)}itemClick(e,i){if(i.disabled){e.preventDefault();return}!i.url&&!i.routerLink&&e.preventDefault(),i.command&&i.command({originalEvent:e,item:i}),this.activeItem=i,this.activeItemChange.emit(i),this.tabChanged=!0,this.cd.markForCheck()}onKeydownItem(e,i,n){let s=i,a={},o=this.tab.toArray();switch(e.code){case"ArrowRight":a=this.findNextItem(o,s),s=a.i,this.changeFocusedTab(e,a.nextItem,s);break;case"ArrowLeft":a=this.findPrevItem(o,s),s=a.i,this.changeFocusedTab(e,a.prevItem,s);break;case"End":a=this.findPrevItem(o,this.model.length),s=a.i,this.changeFocusedTab(e,a.prevItem,s),e.preventDefault();break;case"Home":a=this.findNextItem(o,-1),s=a.i,this.changeFocusedTab(e,a.nextItem,s),e.preventDefault();break;case"Space":case"Enter":this.itemClick(e,n);break;case"Tab":this.onTabKeyDown(o);break;default:break}o[s]&&o[i]&&(o[i].nativeElement.tabIndex="-1",o[s].nativeElement.tabIndex="0",o[s].nativeElement.focus()),this.cd.markForCheck()}onTabKeyDown(e){e.forEach(i=>{i.nativeElement.tabIndex=zs(i.nativeElement.parentElement,"data-p-highlight")?"0":"-1"})}changeFocusedTab(e,i,n){i&&(ut(i),i.scrollIntoView({block:"nearest"}),this.itemClick(e,i))}findNextItem(e,i){let n=i+1;if(n>=e.length)return{nextItem:e[e.length],i:e.length};let s=e[n];return s?zs(s.nativeElement,"data-p-disabled")?this.findNextItem(e,n):{nextItem:s.nativeElement,i:n}:null}findPrevItem(e,i){let n=i-1;if(n<0)return{prevItem:e[0],i:0};let s=e[n];return s?zs(s.nativeElement,"data-p-disabled")?this.findPrevItem(e,n):{prevItem:s.nativeElement,i:n}:null}updateInkBar(){let e=or(this.navbar?.nativeElement,"li.p-tabmenu-active");e&&(this.inkbar.nativeElement.style.width=hn(e)+"px",this.inkbar.nativeElement.style.left=to(e).left-to(this.navbar?.nativeElement).left+"px")}getVisibleButtonWidths(){return[this.prevBtn?.nativeElement,this.nextBtn?.nativeElement].reduce((e,i)=>i?e+hn(i):e,0)}updateButtonState(){let e=this.content?.nativeElement,{scrollLeft:i,scrollWidth:n}=e,s=hn(e);this.backwardIsDisabled=i===0,this.forwardIsDisabled=parseInt(i)===n-s}updateScrollBar(e){let i=this.navbar?.nativeElement.children[e];i&&i.scrollIntoView({block:"nearest"})}onScroll(e){this.scrollable&&this.updateButtonState(),e.preventDefault()}navBackward(){let e=this.content?.nativeElement,i=hn(e)-this.getVisibleButtonWidths(),n=e.scrollLeft-i;e.scrollLeft=n<=0?0:n}navForward(){let e=this.content?.nativeElement,i=hn(e)-this.getVisibleButtonWidths(),n=e.scrollLeft+i,s=e.scrollWidth-i;e.scrollLeft=n>=s?s:n}initAutoScrollForActiveItem(){this.scrollable&&(this.clearAutoScrollHandler(),this.timerIdForInitialAutoScroll=setTimeout(()=>{let e=this.model.findIndex(i=>this.isActive(i));e!==-1&&this.updateScrollBar(e)}))}clearAutoScrollHandler(){this.timerIdForInitialAutoScroll&&(clearTimeout(this.timerIdForInitialAutoScroll),this.timerIdForInitialAutoScroll=null)}initButtonState(){this.scrollable&&Promise.resolve().then(()=>{this.updateButtonState(),this.cd.markForCheck()})}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=Oe({type:r,selectors:[["p-tabMenu"],["p-tabmenu"]],contentQueries:function(i,n,s){if(i&1&&(Ue(s,Md,4),Ue(s,Pd,4),Ue(s,Ld,4),Ue(s,er,4)),i&2){let a;de(a=pe())&&(n.itemTemplate=a.first),de(a=pe())&&(n.previousIconTemplate=a.first),de(a=pe())&&(n.nextIconTemplate=a.first),de(a=pe())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&(Ae(Rd,5),Ae(Nd,5),Ae(Bd,5),Ae(Vd,5),Ae($d,5),Ae(Hd,5),Ae(Wd,5)),i&2){let s;de(s=pe())&&(n.content=s.first),de(s=pe())&&(n.navbar=s.first),de(s=pe())&&(n.inkbar=s.first),de(s=pe())&&(n.prevBtn=s.first),de(s=pe())&&(n.nextBtn=s.first),de(s=pe())&&(n.tabLink=s),de(s=pe())&&(n.tab=s)}},inputs:{model:"model",activeItem:"activeItem",scrollable:[2,"scrollable","scrollable",be],popup:[2,"popup","popup",be],style:"style",styleClass:"styleClass",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy"},outputs:{activeItemChange:"activeItemChange"},features:[Ft([qc]),Ht],decls:11,vars:12,consts:[["content",""],["navbar",""],["inkbar",""],["prevBtn",""],["tab",""],["tabLink",""],["htmlLabel",""],["htmlRouteLabel",""],["nextBtn",""],[3,"ngClass","ngStyle"],[1,"p-tabmenu-nav-container"],["class","p-tabmenu-nav-prev-button p-tabmenu-nav-button","type","button","role","navigation","pRipple","",3,"click",4,"ngIf"],[1,"p-tabmenu-nav-content",3,"scroll"],["role","menubar",1,"p-tabmenu-nav","p-reset"],["role","menuitem","pTooltip","","pRipple","",3,"ngStyle","class","ngClass","tooltipOptions","click","keydown","focus",4,"ngFor","ngForOf"],["role","presentation",1,"p-tabmenuitem-active-bar"],["class","p-tabmenu-nav-next-button p-tabmenu-nav-button","type","button","role","navigation","pRipple","",3,"click",4,"ngIf"],["type","button","role","navigation","pRipple","",1,"p-tabmenu-nav-prev-button","p-tabmenu-nav-button",3,"click"],[4,"ngIf"],[4,"ngTemplateOutlet"],["role","menuitem","pTooltip","","pRipple","",3,"click","keydown","focus","ngStyle","ngClass","tooltipOptions"],["class","p-menuitem-link","role","presentation",3,"target","tabindex",4,"ngIf"],["role","presentation","class","p-menuitem-link",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","tabindex","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["role","presentation",1,"p-menuitem-link",3,"target","tabindex"],["class","p-menuitem-icon",3,"ngClass","ngStyle",4,"ngIf"],["class","p-menuitem-text",4,"ngIf","ngIfElse"],["size","small",3,"styleClass","value",4,"ngIf"],[1,"p-menuitem-icon",3,"ngClass","ngStyle"],[1,"p-menuitem-text"],[1,"p-menuitem-text",3,"innerHTML"],["size","small",3,"styleClass","value"],["role","presentation",1,"p-menuitem-link",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","tabindex","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state"],["type","button","role","navigation","pRipple","",1,"p-tabmenu-nav-next-button","p-tabmenu-nav-button",3,"click"]],template:function(i,n){if(i&1){let s=ge();P(0,"div",9)(1,"div",10),z(2,qd,4,2,"button",11),P(3,"div",12,0),ce("scroll",function(o){return X(s),j(n.onScroll(o))}),P(5,"ul",13,1),z(7,lp,5,20,"li",14),he(8,"li",15,2),L()(),z(10,fp,4,2,"button",16),L()()}i&2&&(et(n.styleClass),w("ngClass",Re(10,zd,n.scrollable))("ngStyle",n.style),S(2),w("ngIf",n.scrollable&&!n.backwardIsDisabled),S(3),fe("aria-labelledby",n.ariaLabelledBy)("aria-label",n.ariaLabel),S(2),w("ngForOf",n.focusableItems),S(),fe("data-pc-section","inkbar"),S(2),w("ngIf",n.scrollable&&!n.forwardIsDisabled))},dependencies:[Le,Wt,Yr,Tt,Jt,St,wi,ln,cn,Qr,Mr,Zr,ac,oc,ts,js,tt],encapsulation:2,changeDetection:0})}return r})(),Zc=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=$t({type:r});static \u0275inj=Vt({imports:[pp,tt,tt]})}return r})();var gp=()=>({height:"85vh",width:"100%","overflow-x":"hidden",overflow:"auto"}),Jc=(()=>{let t=class t{constructor(){this.sidebarVisible=!0,this.onUpdate=new ve,this.formModel={},this.items=[{label:"Positions",value:0},{label:"Options",value:1},{label:"Data Options",value:2}],this.activeItem=this.items[0],this.formWidgetOptions=new qs({}),this.form=new qs({}),this.formSeriesOptions=new qs({})}set widget(i){this._widget=i,setTimeout(()=>{this.formWidgetOptions.patchValue({position:i?.position,config:i?.config})},1e3)}get title(){return this.widget?.config?.header?.title}ngOnInit(){this.formModel={}}onActiveTabItemChange(i){this.activeItem=i}onWidgetSave(){let i=F(F({},this._widget),this.formModel);i.config.options.series=this.formModel.series,this.onUpdate.emit(i),this._widget&&this._widget.series&&this._widget.series?.push({})}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-widget-config"]],inputs:{selectedDashboardId:"selectedDashboardId",widget:"widget"},outputs:{onUpdate:"onUpdate"},decls:11,vars:7,consts:[["id","panelId",2,"height","100%","overflow-y","visible"],[3,"ngSubmit","formGroup"],[1,"form-buttons"],[1,"form-button"],["type","button","label","Save",3,"click","outlined"],["type","button","label","Edit",1,"ui-button-warning","ml-2","mr-2",3,"outlined"],["type","reset","label","Reset",1,"ui-button-danger",3,"outlined"],["position","bottom-right","key","br"]],template:function(n,s){n&1&&(P(0,"div",0)(1,"p-scrollPanel")(2,"form",1),ce("ngSubmit",function(){return s.onWidgetSave()}),L()(),P(3,"div",2)(4,"div",3)(5,"p-button",4),ce("click",function(){return s.onWidgetSave()}),L()(),P(6,"div",3),he(7,"p-button",5),L(),P(8,"div",3),he(9,"p-button",6),L()()(),he(10,"p-toast",7)),n&2&&(S(),Qt(Zt(6,gp)),S(),w("formGroup",s.form),S(3),w("outlined",!0),S(2),w("outlined",!0),S(2),w("outlined",!0))},dependencies:[Le,Qs,pc,dc,gc,mc,Jr,Ci,yc,vc,aa,Zc,Zs,ea,Js],styles:[".form-buttons[_ngcontent-%COMP%]{display:flex;justify-content:end;margin-top:2rem;padding:1.2rem;align-items:end;position:absolute;bottom:0;right:0}  .p-sidebar .p-sidebar-header .p-sidebar-close, .p-sidebar[_ngcontent-%COMP%]   .p-sidebar-header[_ngcontent-%COMP%]   .p-sidebar-icon[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-top-left-radius:5px;border-bottom-left-radius:5px;background:#fff;position:absolute;top:.625rem;padding:.4166666667rem!important;box-shadow:0 .125rem .25rem #00000014;z-index:20;left:-39px;height:3rem;width:3.25rem;color:red}  .form-alignment{margin-left:1rem;margin-right:1rem;width:86.2%}"]});let r=t;return r})();var xp=["pMenuItemContent",""],t0=r=>({"p-disabled":r}),la=r=>({$implicit:r}),_p=()=>({exact:!1});function vp(r,t){r&1&&$e(0)}function yp(r,t){if(r&1&&(P(0,"a",6),z(1,vp,1,0,"ng-container",7),L()),r&2){let e=y(2),i=mt(4);w("target",e.item.target)("ngClass",Re(9,t0,e.item.disabled)),fe("title",e.item.title)("href",e.item.url||null,rn)("data-automationid",e.item.automationId)("tabindex",-1)("data-pc-section","action"),S(),w("ngTemplateOutlet",i)("ngTemplateOutletContext",Re(11,la,e.item))}}function wp(r,t){r&1&&$e(0)}function bp(r,t){if(r&1&&(P(0,"a",8),z(1,wp,1,0,"ng-container",7),L()),r&2){let e=y(2),i=mt(4);w("routerLink",e.item.routerLink)("queryParams",e.item.queryParams)("routerLinkActiveOptions",e.item.routerLinkActiveOptions||Zt(17,_p))("target",e.item.target)("ngClass",Re(18,t0,e.item.disabled))("fragment",e.item.fragment)("queryParamsHandling",e.item.queryParamsHandling)("preserveFragment",e.item.preserveFragment)("skipLocationChange",e.item.skipLocationChange)("replaceUrl",e.item.replaceUrl)("state",e.item.state),fe("data-automationid",e.item.automationId)("tabindex",-1)("data-pc-section","action")("title",e.item.title),S(),w("ngTemplateOutlet",i)("ngTemplateOutletContext",Re(20,la,e.item))}}function Cp(r,t){if(r&1&&(Be(0),z(1,yp,2,13,"a",4)(2,bp,2,22,"a",5),Ve()),r&2){let e=y();S(),w("ngIf",!(e.item!=null&&e.item.routerLink)),S(),w("ngIf",e.item==null?null:e.item.routerLink)}}function Tp(r,t){}function Sp(r,t){r&1&&z(0,Tp,0,0,"ng-template")}function Ep(r,t){if(r&1&&(Be(0),z(1,Sp,1,0,null,7),Ve()),r&2){let e=y();S(),w("ngTemplateOutlet",e.itemTemplate)("ngTemplateOutletContext",Re(2,la,e.item))}}function Ip(r,t){if(r&1&&he(0,"span",12),r&2){let e=y(2);et(e.item.iconClass),w("ngClass",e.item.icon)("ngStyle",e.item.iconStyle)}}function kp(r,t){if(r&1&&(P(0,"span",13),Se(1),L()),r&2){let e=y(2);S(),He(e.item.label)}}function Fp(r,t){if(r&1&&(he(0,"span",14),sn(1,"safeHtml")),r&2){let e=y(2);w("innerHTML",an(1,1,e.item.label),$r)}}function Op(r,t){if(r&1&&he(0,"p-badge",15),r&2){let e=y(2);w("styleClass",e.item.badgeStyleClass)("value",e.item.badge)}}function Ap(r,t){if(r&1&&z(0,Ip,1,4,"span",9)(1,kp,2,1,"span",10)(2,Fp,2,3,"ng-template",null,1,ct)(4,Op,1,2,"p-badge",11),r&2){let e=mt(3),i=y();w("ngIf",i.item.icon),S(),w("ngIf",i.item.escape!==!1)("ngIfElse",e),S(3),w("ngIf",i.item.badge)}}var Dp=["start"],Mp=["end"],Pp=["header"],Lp=["item"],Rp=["submenuheader"],Np=["list"],Bp=["container"],Vp=r=>({"p-menu p-component":!0,"p-menu-overlay":r}),$p=(r,t)=>({showTransitionParams:r,hideTransitionParams:t}),Hp=r=>({value:"visible",params:r}),Wp=(r,t)=>({"p-hidden":r,flex:t}),r0=(r,t)=>({"p-focus":r,"p-disabled":t});function zp(r,t){r&1&&$e(0)}function Up(r,t){if(r&1&&(P(0,"div",9),z(1,zp,1,0,"ng-container",10),L()),r&2){let e=y(2);fe("data-pc-section","start"),S(),w("ngTemplateOutlet",e.startTemplate??e._startTemplate)}}function Gp(r,t){r&1&&he(0,"li",14)}function Xp(r,t){if(r&1&&(P(0,"span"),Se(1),L()),r&2){let e=y(3).$implicit;S(),He(e.label)}}function jp(r,t){if(r&1&&(he(0,"span",18),sn(1,"safeHtml")),r&2){let e=y(3).$implicit;w("innerHTML",an(1,1,e.label),$r)}}function Kp(r,t){if(r&1&&(Be(0),z(1,Xp,2,1,"span",17)(2,jp,2,3,"ng-template",null,2,ct),Ve()),r&2){let e=mt(3),i=y(2).$implicit;S(),w("ngIf",i.escape!==!1)("ngIfElse",e)}}function Yp(r,t){r&1&&$e(0)}function qp(r,t){if(r&1&&(P(0,"li",15),z(1,Kp,4,2,"ng-container",7)(2,Yp,1,0,"ng-container",16),L()),r&2){let e=y(),i=e.$implicit,n=e.index,s=y(3);w("ngClass",Ct(7,Wp,i.visible===!1,i.visible))("tooltipOptions",i.tooltipOptions),fe("data-automationid",i.automationId)("id",s.menuitemId(i,s.id,n)),S(),w("ngIf",!s.submenuHeaderTemplate&&!s._submenuHeaderTemplate),S(),w("ngTemplateOutlet",s.submenuHeaderTemplate??s._submenuHeaderTemplate)("ngTemplateOutletContext",Re(10,la,i))}}function Qp(r,t){r&1&&he(0,"li",14)}function Zp(r,t){if(r&1){let e=ge();P(0,"li",20),ce("onMenuItemClick",function(n){X(e);let s=y(),a=s.$implicit,o=s.index,c=y().index,l=y(3);return j(l.itemClick(n,l.menuitemId(a,l.id,c,o)))}),L()}if(r&2){let e=y(),i=e.$implicit,n=e.index,s=y().index,a=y(3);et(i.styleClass),w("pMenuItemContent",i)("itemTemplate",a.itemTemplate??a._itemTemplate)("ngClass",Ct(13,r0,a.focusedOptionId()&&a.menuitemId(i,a.id,s,n)===a.focusedOptionId(),a.disabled(i.disabled)))("ngStyle",i.style)("tooltipOptions",i.tooltipOptions),fe("data-pc-section","menuitem")("aria-label",a.label(i.label))("data-p-focused",a.isItemFocused(a.menuitemId(i,a.id,s,n)))("data-p-disabled",a.disabled(i.disabled))("aria-disabled",a.disabled(i.disabled))("id",a.menuitemId(i,a.id,s,n))}}function Jp(r,t){if(r&1&&z(0,Qp,1,0,"li",12)(1,Zp,1,16,"li",19),r&2){let e=t.$implicit,i=y().$implicit;w("ngIf",e.separator&&(e.visible!==!1||i.visible!==!1)),S(),w("ngIf",!e.separator&&e.visible!==!1&&(e.visible!==void 0||i.visible!==!1))}}function em(r,t){if(r&1&&z(0,Gp,1,0,"li",12)(1,qp,3,12,"li",13)(2,Jp,2,2,"ng-template",11),r&2){let e=t.$implicit;w("ngIf",e.separator&&e.visible!==!1),S(),w("ngIf",!e.separator),S(),w("ngForOf",e.items)}}function tm(r,t){if(r&1&&z(0,em,3,3,"ng-template",11),r&2){let e=y(2);w("ngForOf",e.model)}}function rm(r,t){r&1&&he(0,"li",14)}function im(r,t){if(r&1){let e=ge();P(0,"li",20),ce("onMenuItemClick",function(n){X(e);let s=y(),a=s.$implicit,o=s.index,c=y(3);return j(c.itemClick(n,c.menuitemId(a,c.id,o)))}),L()}if(r&2){let e=y(),i=e.$implicit,n=e.index,s=y(3);et(i.styleClass),w("pMenuItemContent",i)("itemTemplate",s.itemTemplate??s._itemTemplate)("ngClass",Ct(13,r0,s.focusedOptionId()&&s.menuitemId(i,s.id,n)===s.focusedOptionId(),s.disabled(i.disabled)))("ngStyle",i.style)("tooltipOptions",i.tooltipOptions),fe("data-pc-section","menuitem")("aria-label",s.label(i.label))("data-p-focused",s.isItemFocused(s.menuitemId(i,s.id,n)))("data-p-disabled",s.disabled(i.disabled))("aria-disabled",s.disabled(i.disabled))("id",s.menuitemId(i,s.id,n))}}function nm(r,t){if(r&1&&z(0,rm,1,0,"li",12)(1,im,1,16,"li",19),r&2){let e=t.$implicit;w("ngIf",e.separator&&e.visible!==!1),S(),w("ngIf",!e.separator&&e.visible!==!1)}}function sm(r,t){if(r&1&&z(0,nm,2,2,"ng-template",11),r&2){let e=y(2);w("ngForOf",e.model)}}function am(r,t){r&1&&$e(0)}function om(r,t){if(r&1&&(P(0,"div",21),z(1,am,1,0,"ng-container",10),L()),r&2){let e=y(2);fe("data-pc-section","end"),S(),w("ngTemplateOutlet",e.endTemplate??e._endTemplate)}}function lm(r,t){if(r&1){let e=ge();P(0,"div",4,0),ce("click",function(n){X(e);let s=y();return j(s.onOverlayClick(n))})("@overlayAnimation.start",function(n){X(e);let s=y();return j(s.onOverlayAnimationStart(n))})("@overlayAnimation.done",function(n){X(e);let s=y();return j(s.onOverlayAnimationEnd(n))}),z(2,Up,2,2,"div",5),P(3,"ul",6,1),ce("focus",function(n){X(e);let s=y();return j(s.onListFocus(n))})("blur",function(n){X(e);let s=y();return j(s.onListBlur(n))})("keydown",function(n){X(e);let s=y();return j(s.onListKeyDown(n))}),z(5,tm,1,1,null,7)(6,sm,1,1,null,7),L(),z(7,om,2,2,"div",8),L()}if(r&2){let e=y();et(e.styleClass),w("ngClass",Re(18,Vp,e.popup))("ngStyle",e.style)("@overlayAnimation",Re(23,Hp,Ct(20,$p,e.showTransitionOptions,e.hideTransitionOptions)))("@.disabled",e.popup!==!0),fe("data-pc-name","menu")("id",e.id),S(2),w("ngIf",e.startTemplate??e._startTemplate),S(),fe("id",e.id+"_list")("tabindex",e.getTabIndexValue())("data-pc-section","menu")("aria-activedescendant",e.activedescendant())("aria-label",e.ariaLabel)("aria-labelledBy",e.ariaLabelledBy),S(2),w("ngIf",e.hasSubMenu()),S(),w("ngIf",!e.hasSubMenu()),S(),w("ngIf",e.endTemplate??e._endTemplate)}}var cm=({dt:r})=>`
.p-menu {
    background: ${r("menu.background")};
    color: ${r("menu.color")};
    border: 1px solid ${r("menu.border.color")};
    border-radius: ${r("menu.border.radius")};
    min-width: 12.5rem;
}

.p-menu-list {
    margin: 0;
    padding: ${r("menu.list.padding")};
    outline: 0 none;
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: ${r("menu.list.gap")};
}

.p-menu-item-content {
    transition: background ${r("menu.transition.duration")}, color ${r("menu.transition.duration")};
    border-radius: ${r("menu.item.border.radius")};
    color: ${r("menu.item.color")};
}

.p-menu-item-link {
    cursor: pointer;
    display: flex;
    align-items: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
    color: inherit;
    padding: ${r("menu.item.padding")};
    gap: ${r("menu.item.gap")};
    user-select: none;
    outline: 0 none;
}

.p-menu-item-label {
    line-height: 1;
}

.p-menu-item-icon {
    color: ${r("menu.item.icon.color")};
}

.p-menu-item.p-focus .p-menu-item-content {
    color: ${r("menu.item.focus.color")};
    background: ${r("menu.item.focus.background")};
}

.p-menu-item.p-focus .p-menu-item-icon {
    color: ${r("menu.item.icon.focus.color")};
}

.p-menu-item:not(.p-disabled) .p-menu-item-content:hover {
    color: ${r("menu.item.focus.color")};
    background: ${r("menu.item.focus.background")};
}

.p-menu-item:not(.p-disabled) .p-menu-item-content:hover .p-menu-item-icon {
    color: ${r("menu.item.icon.focus.color")};
}

.p-menu-overlay {
    box-shadow: ${r("menu.shadow")};
}

.p-menu-submenu-label {
    background: ${r("menu.submenu.label.background")};
    padding: ${r("menu.submenu.label.padding")};
    color: ${r("menu.submenu.label.color")};
    font-weight: ${r("menu.submenu.label.font.weight")};
}

.p-menu-separator {
    border-top: 1px solid ${r("menu.separator.border.color")};
}

/* For PrimeNG */
.p-menu-overlay {
    position: absolute;
}
`,um={root:({props:r})=>["p-menu p-component",{"p-menu-overlay":r.popup}],start:"p-menu-start",list:"p-menu-list",submenuLabel:"p-menu-submenu-label",separator:"p-menu-separator",end:"p-menu-end",item:({instance:r})=>["p-menu-item",{"p-focus":r.id===r.focusedOptionId,"p-disabled":r.disabled()}],itemContent:"p-menu-item-content",itemLink:"p-menu-item-link",itemIcon:"p-menu-item-icon",itemLabel:"p-menu-item-label"},e0=(()=>{class r extends pr{name="menu";theme=cm;classes=um;static \u0275fac=(()=>{let e;return function(n){return(e||(e=bt(r)))(n||r)}})();static \u0275prov=yt({token:r,factory:r.\u0275fac})}return r})();var i0=(()=>{class r{platformId;sanitizer;constructor(e,i){this.platformId=e,this.sanitizer=i}transform(e){return!e||!wr(this.platformId)?e:this.sanitizer.bypassSecurityTrustHtml(e)}static \u0275fac=function(i){return new(i||r)(ze(Nl,16),ze(Ul,16))};static \u0275pipe=Vl({name:"safeHtml",type:r,pure:!0})}return r})(),hm=(()=>{class r{item;itemTemplate;onMenuItemClick=new ve;menu;constructor(e){this.menu=e}onItemClick(e,i){this.onMenuItemClick.emit({originalEvent:e,item:i})}static \u0275fac=function(i){return new(i||r)(ze(tn(()=>bn)))};static \u0275cmp=Oe({type:r,selectors:[["","pMenuItemContent",""]],inputs:{item:[0,"pMenuItemContent","item"],itemTemplate:"itemTemplate"},outputs:{onMenuItemClick:"onMenuItemClick"},attrs:xp,decls:5,vars:3,consts:[["itemContent",""],["htmlLabel",""],[1,"p-menu-item-content",3,"click"],[4,"ngIf"],["class","p-menu-item-link","pRipple","",3,"target","ngClass",4,"ngIf"],["routerLinkActive","p-menu-item-link-active","class","p-menu-item-link","pRipple","",3,"routerLink","queryParams","routerLinkActiveOptions","target","ngClass","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state",4,"ngIf"],["pRipple","",1,"p-menu-item-link",3,"target","ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["routerLinkActive","p-menu-item-link-active","pRipple","",1,"p-menu-item-link",3,"routerLink","queryParams","routerLinkActiveOptions","target","ngClass","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state"],["class","p-menu-item-icon",3,"ngClass","class","ngStyle",4,"ngIf"],["class","p-menu-item-label",4,"ngIf","ngIfElse"],[3,"styleClass","value",4,"ngIf"],[1,"p-menu-item-icon",3,"ngClass","ngStyle"],[1,"p-menu-item-label"],[1,"p-menu-item-label",3,"innerHTML"],[3,"styleClass","value"]],template:function(i,n){if(i&1){let s=ge();P(0,"div",2),ce("click",function(o){return X(s),j(n.onItemClick(o,n.item))}),z(1,Cp,3,2,"ng-container",3)(2,Ep,2,4,"ng-container",3)(3,Ap,5,4,"ng-template",null,0,ct),L()}i&2&&(fe("data-pc-section","content"),S(),w("ngIf",!n.itemTemplate),S(),w("ngIf",n.itemTemplate))},dependencies:[Le,Wt,Tt,Jt,St,wi,ln,cn,Qr,Mr,ts,js,tt,i0],encapsulation:2})}return r})(),bn=(()=>{class r extends tr{overlayService;model;popup;style;styleClass;appendTo;autoZIndex=!0;baseZIndex=0;showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)";hideTransitionOptions=".1s linear";ariaLabel;ariaLabelledBy;id;tabindex=0;onShow=new ve;onHide=new ve;onBlur=new ve;onFocus=new ve;listViewChild;containerViewChild;container;scrollHandler;documentClickListener;documentResizeListener;preventDocumentDefault;target;visible;focusedOptionId=yi(()=>this.focusedOptionIndex()!==-1?this.focusedOptionIndex():null);focusedOptionIndex=wt(-1);selectedOptionIndex=wt(-1);focused=!1;overlayVisible=!1;relativeAlign;_componentStyle=at(e0);constructor(e){super(),this.overlayService=e,this.id=this.id||qr("pn_id_")}toggle(e){this.visible?this.hide():this.show(e),this.preventDocumentDefault=!0}show(e){this.target=e.currentTarget,this.relativeAlign=e.relativeAlign,this.visible=!0,this.preventDocumentDefault=!0,this.overlayVisible=!0,this.cd.markForCheck()}ngOnInit(){super.ngOnInit(),this.popup||this.bindDocumentClickListener()}startTemplate;_startTemplate;endTemplate;_endTemplate;headerTemplate;_headerTemplate;itemTemplate;_itemTemplate;submenuHeaderTemplate;_submenuHeaderTemplate;templates;ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"start":this._startTemplate=e.template;break;case"end":this._endTemplate=e.template;break;case"item":this._itemTemplate=e.template;break;case"submenuheader":this._submenuHeaderTemplate=e.template;break;default:this._itemTemplate=e.template;break}})}getTabIndexValue(){return this.tabindex!==void 0?this.tabindex.toString():null}onOverlayAnimationStart(e){switch(e.toState){case"visible":this.popup&&(this.container=e.element,this.moveOnTop(),this.onShow.emit({}),this.appendOverlay(),this.alignOverlay(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener(),ut(this.listViewChild.nativeElement));break;case"void":this.onOverlayHide(),this.onHide.emit({});break}}onOverlayAnimationEnd(e){switch(e.toState){case"void":this.autoZIndex&&Sr.clear(e.element);break}}alignOverlay(){this.relativeAlign?Ws(this.container,this.target):$s(this.container,this.target)}appendOverlay(){this.appendTo&&(this.appendTo==="body"?this.renderer.appendChild(this.document.body,this.container):un(this.appendTo,this.container))}restoreOverlayAppend(){this.container&&this.appendTo&&this.renderer.appendChild(this.el.nativeElement,this.container)}moveOnTop(){this.autoZIndex&&Sr.set("menu",this.container,this.baseZIndex+this.config.zIndex.menu)}hide(){this.visible=!1,this.relativeAlign=!1,this.cd.markForCheck()}onWindowResize(){this.visible&&!Jn()&&this.hide()}menuitemId(e,i,n,s){return e?.id??`${i}_${n}${s!==void 0?"_"+s:""}`}isItemFocused(e){return this.focusedOptionId()===e}label(e){return typeof e=="function"?e():e}disabled(e){return typeof e=="function"?e():typeof e>"u"?!1:e}activedescendant(){return this.focused?this.focusedOptionId():void 0}onListFocus(e){this.focused||(this.focused=!0,this.onFocus.emit(e))}onListBlur(e){this.focused&&(this.focused=!1,this.changeFocusedOptionIndex(-1),this.selectedOptionIndex.set(-1),this.focusedOptionIndex.set(-1),this.onBlur.emit(e))}onListKeyDown(e){switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"Enter":this.onEnterKey(e);break;case"NumpadEnter":this.onEnterKey(e);break;case"Space":this.onSpaceKey(e);break;case"Escape":case"Tab":this.popup&&(ut(this.target),this.hide()),this.overlayVisible&&this.hide();break;default:break}}onArrowDownKey(e){let i=this.findNextOptionIndex(this.focusedOptionIndex());this.changeFocusedOptionIndex(i),e.preventDefault()}onArrowUpKey(e){if(e.altKey&&this.popup)ut(this.target),this.hide(),e.preventDefault();else{let i=this.findPrevOptionIndex(this.focusedOptionIndex());this.changeFocusedOptionIndex(i),e.preventDefault()}}onHomeKey(e){this.changeFocusedOptionIndex(0),e.preventDefault()}onEndKey(e){this.changeFocusedOptionIndex(Zn(this.containerViewChild.nativeElement,'li[data-pc-section="menuitem"][data-p-disabled="false"]').length-1),e.preventDefault()}onEnterKey(e){let i=or(this.containerViewChild.nativeElement,`li[id="${`${this.focusedOptionIndex()}`}"]`),n=i&&or(i,'a[data-pc-section="action"]');this.popup&&ut(this.target),n?n.click():i&&i.click(),e.preventDefault()}onSpaceKey(e){this.onEnterKey(e)}findNextOptionIndex(e){let n=[...Zn(this.containerViewChild.nativeElement,'li[data-pc-section="menuitem"][data-p-disabled="false"]')].findIndex(s=>s.id===e);return n>-1?n+1:0}findPrevOptionIndex(e){let n=[...Zn(this.containerViewChild.nativeElement,'li[data-pc-section="menuitem"][data-p-disabled="false"]')].findIndex(s=>s.id===e);return n>-1?n-1:0}changeFocusedOptionIndex(e){let i=Zn(this.containerViewChild.nativeElement,'li[data-pc-section="menuitem"][data-p-disabled="false"]');if(i.length>0){let n=e>=i.length?i.length-1:e<0?0:e;n>-1&&this.focusedOptionIndex.set(i[n].getAttribute("id"))}}itemClick(e,i){let{originalEvent:n,item:s}=e;if(this.focused||(this.focused=!0,this.onFocus.emit()),s.disabled){n.preventDefault();return}!s.url&&!s.routerLink&&n.preventDefault(),s.command&&s.command({originalEvent:n,item:s}),this.popup&&this.hide(),!this.popup&&this.focusedOptionIndex()!==i&&this.focusedOptionIndex.set(i)}onOverlayClick(e){this.popup&&this.overlayService.add({originalEvent:e,target:this.el.nativeElement}),this.preventDocumentDefault=!0}bindDocumentClickListener(){if(!this.documentClickListener&&wr(this.platformId)){let e=this.el?this.el.nativeElement.ownerDocument:"document";this.documentClickListener=this.renderer.listen(e,"click",i=>{let n=this.containerViewChild?.nativeElement&&!this.containerViewChild?.nativeElement.contains(i.target),s=!(this.target&&(this.target===i.target||this.target.contains(i.target)));!this.popup&&n&&s&&this.onListBlur(i),this.preventDocumentDefault&&this.overlayVisible&&n&&s&&(this.hide(),this.preventDocumentDefault=!1)})}}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){if(!this.documentResizeListener&&wr(this.platformId)){let e=this.document.defaultView;this.documentResizeListener=this.renderer.listen(e,"resize",this.onWindowResize.bind(this))}}unbindDocumentResizeListener(){this.documentResizeListener&&(this.documentResizeListener(),this.documentResizeListener=null)}bindScrollListener(){!this.scrollHandler&&wr(this.platformId)&&(this.scrollHandler=new Ks(this.target,()=>{this.visible&&this.hide()})),this.scrollHandler?.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&(this.scrollHandler.unbindScrollListener(),this.scrollHandler=null)}onOverlayHide(){this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.preventDocumentDefault=!1,this.cd.destroyed||(this.target=null)}ngOnDestroy(){this.popup&&(this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.container&&this.autoZIndex&&Sr.clear(this.container),this.restoreOverlayAppend(),this.onOverlayHide()),this.popup||this.unbindDocumentClickListener(),super.ngOnDestroy()}hasSubMenu(){return this.model?.some(e=>e.items)??!1}isItemHidden(e){return e.separator?e.visible===!1||e.items&&e.items.some(i=>i.visible!==!1):e.visible===!1}static \u0275fac=function(i){return new(i||r)(ze(Gs))};static \u0275cmp=Oe({type:r,selectors:[["p-menu"]],contentQueries:function(i,n,s){if(i&1&&(Ue(s,Dp,4),Ue(s,Mp,4),Ue(s,Pp,4),Ue(s,Lp,4),Ue(s,Rp,4),Ue(s,er,4)),i&2){let a;de(a=pe())&&(n.startTemplate=a.first),de(a=pe())&&(n.endTemplate=a.first),de(a=pe())&&(n.headerTemplate=a.first),de(a=pe())&&(n.itemTemplate=a.first),de(a=pe())&&(n.submenuHeaderTemplate=a.first),de(a=pe())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&(Ae(Np,5),Ae(Bp,5)),i&2){let s;de(s=pe())&&(n.listViewChild=s.first),de(s=pe())&&(n.containerViewChild=s.first)}},inputs:{model:"model",popup:[2,"popup","popup",be],style:"style",styleClass:"styleClass",appendTo:"appendTo",autoZIndex:[2,"autoZIndex","autoZIndex",be],baseZIndex:[2,"baseZIndex","baseZIndex",Ot],showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",id:"id",tabindex:[2,"tabindex","tabindex",Ot]},outputs:{onShow:"onShow",onHide:"onHide",onBlur:"onBlur",onFocus:"onFocus"},features:[Ft([e0]),Ht],decls:1,vars:1,consts:[["container",""],["list",""],["htmlSubmenuLabel",""],[3,"ngClass","class","ngStyle","click",4,"ngIf"],[3,"click","ngClass","ngStyle"],["class","p-menu-start",4,"ngIf"],["role","menu",1,"p-menu-list","p-reset",3,"focus","blur","keydown"],[4,"ngIf"],["class","p-menu-end",4,"ngIf"],[1,"p-menu-start"],[4,"ngTemplateOutlet"],["ngFor","",3,"ngForOf"],["class","p-menu-separator","role","separator",4,"ngIf"],["class","p-menu-submenu-label","pTooltip","","role","none",3,"ngClass","tooltipOptions",4,"ngIf"],["role","separator",1,"p-menu-separator"],["pTooltip","","role","none",1,"p-menu-submenu-label",3,"ngClass","tooltipOptions"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngIf","ngIfElse"],[3,"innerHTML"],["class","p-menu-item","pTooltip","","role","menuitem",3,"pMenuItemContent","itemTemplate","ngClass","ngStyle","class","tooltipOptions","onMenuItemClick",4,"ngIf"],["pTooltip","","role","menuitem",1,"p-menu-item",3,"onMenuItemClick","pMenuItemContent","itemTemplate","ngClass","ngStyle","tooltipOptions"],[1,"p-menu-end"]],template:function(i,n){i&1&&z(0,lm,8,25,"div",3),i&2&&w("ngIf",!n.popup||n.visible)},dependencies:[Le,Wt,Yr,Tt,Jt,St,wi,hm,Mr,Zr,ts,tt,i0],encapsulation:2,data:{animation:[bi("overlayAnimation",[Tr(":enter",[Cr({opacity:0,transform:"scaleY(0.8)"}),br("{{showTransitionParams}}")]),Tr(":leave",[br("{{hideTransitionParams}}",Cr({opacity:0}))])])]},changeDetection:0})}return r})(),ca=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=$t({type:r});static \u0275inj=Vt({imports:[bn,tt,tt]})}return r})();var vs={};vs.version="0.18.5";var zi=1200,Mn=1252,fm=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],dm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},G0=function(r){fm.indexOf(r)!=-1&&(Mn=dm[0]=r)};function pm(){G0(1252)}var ys=function(r){zi=r,G0(r)};function mm(){ys(1200),pm()}function gm(r){for(var t=[],e=0;e<r.length>>1;++e)t[e]=String.fromCharCode(r.charCodeAt(2*e+1)+(r.charCodeAt(2*e)<<8));return t.join("")}var ua=function(t){return String.fromCharCode(t)},s0=function(t){return String.fromCharCode(t)},rt;var ri=null,hs=!0,Ei="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ws(r){for(var t="",e=0,i=0,n=0,s=0,a=0,o=0,c=0,l=0;l<r.length;)e=r.charCodeAt(l++),s=e>>2,i=r.charCodeAt(l++),a=(e&3)<<4|i>>4,n=r.charCodeAt(l++),o=(i&15)<<2|n>>6,c=n&63,isNaN(i)?o=c=64:isNaN(n)&&(c=64),t+=Ei.charAt(s)+Ei.charAt(a)+Ei.charAt(o)+Ei.charAt(c);return t}function mi(r){var t="",e=0,i=0,n=0,s=0,a=0,o=0,c=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<r.length;)s=Ei.indexOf(r.charAt(l++)),a=Ei.indexOf(r.charAt(l++)),e=s<<2|a>>4,t+=String.fromCharCode(e),o=Ei.indexOf(r.charAt(l++)),i=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(i)),c=Ei.indexOf(r.charAt(l++)),n=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var Xe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),xi=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Gi(r){return Xe?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function a0(r){return Xe?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Gr=function(t){return Xe?xi(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function Da(r){if(typeof ArrayBuffer>"u")return Gr(r);for(var t=new ArrayBuffer(r.length),e=new Uint8Array(t),i=0;i!=r.length;++i)e[i]=r.charCodeAt(i)&255;return t}function Es(r){if(Array.isArray(r))return r.map(function(i){return String.fromCharCode(i)}).join("");for(var t=[],e=0;e<r.length;++e)t[e]=String.fromCharCode(r[e]);return t.join("")}function xm(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}var jt=Xe?function(r){return Buffer.concat(r.map(function(t){return Buffer.isBuffer(t)?t:xi(t)}))}:function(r){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<r.length;++t)e+=r[t].length;var i=new Uint8Array(e),n=0;for(t=0,e=0;t<r.length;e+=n,++t)if(n=r[t].length,r[t]instanceof Uint8Array)i.set(r[t],e);else{if(typeof r[t]=="string")throw"wtf";i.set(new Uint8Array(r[t]),e)}return i}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function _m(r){for(var t=[],e=0,i=r.length+250,n=Gi(r.length+255),s=0;s<r.length;++s){var a=r.charCodeAt(s);if(a<128)n[e++]=a;else if(a<2048)n[e++]=192|a>>6&31,n[e++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=r.charCodeAt(++s)&1023;n[e++]=240|a>>8&7,n[e++]=128|a>>2&63,n[e++]=128|o>>6&15|(a&3)<<4,n[e++]=128|o&63}else n[e++]=224|a>>12&15,n[e++]=128|a>>6&63,n[e++]=128|a&63;e>i&&(t.push(n.slice(0,e)),e=0,n=Gi(65535),i=65530)}return t.push(n.slice(0,e)),jt(t)}var kn=/\u0000/g,ha=/[\u0001-\u0006]/g;function Fn(r){for(var t="",e=r.length-1;e>=0;)t+=r.charAt(e--);return t}function Xr(r,t){var e=""+r;return e.length>=t?e:ht("0",t-e.length)+e}function Go(r,t){var e=""+r;return e.length>=t?e:ht(" ",t-e.length)+e}function va(r,t){var e=""+r;return e.length>=t?e:e+ht(" ",t-e.length)}function vm(r,t){var e=""+Math.round(r);return e.length>=t?e:ht("0",t-e.length)+e}function ym(r,t){var e=""+r;return e.length>=t?e:ht("0",t-e.length)+e}var o0=Math.pow(2,32);function Cn(r,t){if(r>o0||r<-o0)return vm(r,t);var e=Math.round(r);return ym(e,t)}function ya(r,t){return t=t||0,r.length>=7+t&&(r.charCodeAt(t)|32)===103&&(r.charCodeAt(t+1)|32)===101&&(r.charCodeAt(t+2)|32)===110&&(r.charCodeAt(t+3)|32)===101&&(r.charCodeAt(t+4)|32)===114&&(r.charCodeAt(t+5)|32)===97&&(r.charCodeAt(t+6)|32)===108}var l0=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Mo=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function wm(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',r}var ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},c0={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},bm={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function wa(r,t,e){for(var i=r<0?-1:1,n=r*i,s=0,a=1,o=0,c=1,l=0,u=0,h=Math.floor(n);l<t&&(h=Math.floor(n),o=h*a+s,u=h*l+c,!(n-h<5e-8));)n=1/(n-h),s=a,a=o,c=l,l=u;if(u>t&&(l>t?(u=c,o=s):(u=l,o=a)),!e)return[0,i*o,u];var f=Math.floor(i*o/u);return[f,i*o-f*u,u]}function fa(r,t,e){if(r>2958465||r<0)return null;var i=r|0,n=Math.floor(86400*(r-i)),s=0,a=[],o={D:i,T:n,u:86400*(r-i)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(i+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++i,++o.D)),i===60)a=e?[1317,10,29]:[1900,2,29],s=3;else if(i===0)a=e?[1317,8,29]:[1900,1,0],s=6;else{i>60&&--i;var c=new Date(1900,0,1);c.setDate(c.getDate()+i-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),i<60&&(s=(s+6)%7),e&&(s=Fm(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=s,o}var X0=new Date(1899,11,31,0,0,0),Cm=X0.getTime(),Tm=new Date(1900,2,1,0,0,0);function j0(r,t){var e=r.getTime();return t?e-=1461*24*60*60*1e3:r>=Tm&&(e+=24*60*60*1e3),(e-(Cm+(r.getTimezoneOffset()-X0.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Xo(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Sm(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Em(r){var t=r<0?12:11,e=Xo(r.toFixed(12));return e.length<=t||(e=r.toPrecision(10),e.length<=t)?e:r.toExponential(5)}function Im(r){var t=Xo(r.toFixed(11));return t.length>(r<0?12:11)||t==="0"||t==="-0"?r.toPrecision(6):t}function km(r){var t=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),e;return t>=-4&&t<=-1?e=r.toPrecision(10+t):Math.abs(t)<=9?e=Em(r):t===10?e=r.toFixed(10).substr(0,12):e=Im(r),Xo(Sm(e.toUpperCase()))}function Ho(r,t){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):km(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return ki(14,j0(r,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+r)}function Fm(r,t){t[0]-=581;var e=r.getDay();return r<60&&(e=(e+6)%7),e}function Om(r,t,e,i){var n="",s=0,a=0,o=e.y,c,l=0;switch(r){case 98:o=e.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(t.length){case 1:case 2:c=e.m,l=t.length;break;case 3:return Mo[e.m-1][1];case 5:return Mo[e.m-1][0];default:return Mo[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=e.d,l=t.length;break;case 3:return l0[e.q][0];default:return l0[e.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(e.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=e.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=e.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?Xr(e.S,t.length):(i>=2?a=i===3?1e3:100:a=i===1?10:1,s=Math.round(a*(e.S+e.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(n=Xr(s,2+i),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=e.D*24+e.H;break;case"[m]":case"[mm]":c=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":c=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+t}l=t.length===3?1:2;break;case 101:c=o,l=1;break}var u=l>0?Xr(c,l):"";return u}function Ii(r){var t=3;if(r.length<=t)return r;for(var e=r.length%t,i=r.substr(0,e);e!=r.length;e+=t)i+=(i.length>0?",":"")+r.substr(e,t);return i}var K0=/%/g;function Am(r,t,e){var i=t.replace(K0,""),n=t.length-i.length;return fi(r,i,e*Math.pow(10,2*n))+ht("%",n)}function Dm(r,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return fi(r,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function Y0(r,t){var e,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Y0(r,-t);var n=r.indexOf(".");n===-1&&(n=r.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),e=(t/Math.pow(10,s)).toPrecision(i+1+(n+s)%n),e.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+s):e+="E+"+(a-s);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,n)+"."+e.substr(2+n),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,u){return c+l+u.substr(0,(n+s)%n)+"."+u.substr(s)+"E"})}else e=t.toExponential(i);return r.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),r.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var q0=/# (\?+)( ?)\/( ?)(\d+)/;function Mm(r,t,e){var i=parseInt(r[4],10),n=Math.round(t*i),s=Math.floor(n/i),a=n-s*i,o=i;return e+(s===0?"":""+s)+" "+(a===0?ht(" ",r[1].length+1+r[4].length):Go(a,r[1].length)+r[2]+"/"+r[3]+Xr(o,r[4].length))}function Pm(r,t,e){return e+(t===0?"":""+t)+ht(" ",r[1].length+2+r[4].length)}var Q0=/^#*0*\.([0#]+)/,Z0=/\).*[0#]/,J0=/\(###\) ###\\?-####/;function lr(r){for(var t="",e,i=0;i!=r.length;++i)switch(e=r.charCodeAt(i)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function u0(r,t){var e=Math.pow(10,t);return""+Math.round(r*e)/e}function h0(r,t){var e=r-Math.floor(r),i=Math.pow(10,t);return t<(""+Math.round(e*i)).length?0:Math.round(e*i)}function Lm(r,t){return t<(""+Math.round((r-Math.floor(r))*Math.pow(10,t))).length?1:0}function Rm(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function Lr(r,t,e){if(r.charCodeAt(0)===40&&!t.match(Z0)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Lr("n",i,e):"("+Lr("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return Dm(r,t,e);if(t.indexOf("%")!==-1)return Am(r,t,e);if(t.indexOf("E")!==-1)return Y0(t,e);if(t.charCodeAt(0)===36)return"$"+Lr(r,t.substr(t.charAt(1)==" "?2:1),e);var n,s,a,o,c=Math.abs(e),l=e<0?"-":"";if(t.match(/^00+$/))return l+Cn(c,t.length);if(t.match(/^[#?]+$/))return n=Cn(e,0),n==="0"&&(n=""),n.length>t.length?n:lr(t.substr(0,t.length-n.length))+n;if(s=t.match(q0))return Mm(s,c,l);if(t.match(/^#+0+$/))return l+Cn(c,t.length-t.indexOf("0"));if(s=t.match(Q0))return n=u0(e,s[1].length).replace(/^([^\.]+)$/,"$1."+lr(s[1])).replace(/\.$/,"."+lr(s[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+ht("0",lr(s[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+u0(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+Ii(Cn(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Lr(r,t,-e):Ii(""+(Math.floor(e)+Lm(e,s[1].length)))+"."+Xr(h0(e,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Lr(r,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Fn(Lr(r,t.replace(/[\\-]/g,""),e)),a=0,Fn(Fn(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<n.length?n.charAt(a++):g==="0"?"0":""}));if(t.match(J0))return n=Lr(r,"##########",e),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=wa(c,Math.pow(10,a)-1,!1),n=""+l,u=fi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+s[2]+"/"+s[3],u=va(o[2],a),u.length<s[4].length&&(u=lr(s[4].substr(s[4].length-u.length))+u),n+=u,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=wa(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Go(o[1],a)+s[2]+"/"+s[3]+va(o[2],a):ht(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=Cn(e,0),t.length<=n.length?n:lr(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var h=t.indexOf(".")-a,f=t.length-n.length-h;return lr(t.substr(0,h)+n+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=h0(e,s[1].length),e<0?"-"+Lr(r,t,-e):Ii(Rm(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Xr(0,3-g.length):"")+g})+"."+Xr(a,s[1].length);switch(t){case"###,##0.00":return Lr(r,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var d=Ii(Cn(c,0));return d!=="0"?l+d:"";case"###,###.00":return Lr(r,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Lr(r,"#,##0.00",e).replace(/^0\./,".");default:}throw new Error("unsupported format |"+t+"|")}function Nm(r,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return fi(r,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function Bm(r,t,e){var i=t.replace(K0,""),n=t.length-i.length;return fi(r,i,e*Math.pow(10,2*n))+ht("%",n)}function eu(r,t){var e,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+eu(r,-t);var n=r.indexOf(".");n===-1&&(n=r.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),e=(t/Math.pow(10,s)).toPrecision(i+1+(n+s)%n),!e.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+s):e+="E+"+(a-s),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,u){return c+l+u.substr(0,(n+s)%n)+"."+u.substr(s)+"E"})}else e=t.toExponential(i);return r.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),r.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function ei(r,t,e){if(r.charCodeAt(0)===40&&!t.match(Z0)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?ei("n",i,e):"("+ei("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return Nm(r,t,e);if(t.indexOf("%")!==-1)return Bm(r,t,e);if(t.indexOf("E")!==-1)return eu(t,e);if(t.charCodeAt(0)===36)return"$"+ei(r,t.substr(t.charAt(1)==" "?2:1),e);var n,s,a,o,c=Math.abs(e),l=e<0?"-":"";if(t.match(/^00+$/))return l+Xr(c,t.length);if(t.match(/^[#?]+$/))return n=""+e,e===0&&(n=""),n.length>t.length?n:lr(t.substr(0,t.length-n.length))+n;if(s=t.match(q0))return Pm(s,c,l);if(t.match(/^#+0+$/))return l+Xr(c,t.length-t.indexOf("0"));if(s=t.match(Q0))return n=(""+e).replace(/^([^\.]+)$/,"$1."+lr(s[1])).replace(/\.$/,"."+lr(s[1])),n=n.replace(/\.(\d*)$/,function(g,p){return"."+p+ht("0",lr(s[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+Ii(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+ei(r,t,-e):Ii(""+e)+"."+ht("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ei(r,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Fn(ei(r,t.replace(/[\\-]/g,""),e)),a=0,Fn(Fn(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<n.length?n.charAt(a++):g==="0"?"0":""}));if(t.match(J0))return n=ei(r,"##########",e),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=wa(c,Math.pow(10,a)-1,!1),n=""+l,u=fi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+s[2]+"/"+s[3],u=va(o[2],a),u.length<s[4].length&&(u=lr(s[4].substr(s[4].length-u.length))+u),n+=u,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=wa(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Go(o[1],a)+s[2]+"/"+s[3]+va(o[2],a):ht(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+e,t.length<=n.length?n:lr(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var h=t.indexOf(".")-a,f=t.length-n.length-h;return lr(t.substr(0,h)+n+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+ei(r,t,-e):Ii(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Xr(0,3-g.length):"")+g})+"."+Xr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=Ii(""+c);return d!=="0"?l+d:"";default:if(t.match(/\.[0#?]*$/))return ei(r,t.slice(0,t.lastIndexOf(".")),e)+lr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function fi(r,t,e){return(e|0)===e?ei(r,t,e):Lr(r,t,e)}function Vm(r){for(var t=[],e=!1,i=0,n=0;i<r.length;++i)switch(r.charCodeAt(i)){case 34:e=!e;break;case 95:case 42:case 92:++i;break;case 59:t[t.length]=r.substr(n,i-n),n=i+1}if(t[t.length]=r.substr(n),e===!0)throw new Error("Format |"+r+"| unterminated string ");return t}var tu=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ru(r){for(var t=0,e="",i="";t<r.length;)switch(e=r.charAt(t)){case"G":ya(r,t)&&(t+=6),t++;break;case'"':for(;r.charCodeAt(++t)!==34&&t<r.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(r.charAt(t+1)==="1"||r.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(r.substr(t,3).toUpperCase()==="A/P"||r.substr(t,5).toUpperCase()==="AM/PM"||r.substr(t,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++t;break;case"[":for(i=e;r.charAt(t++)!=="]"&&t<r.length;)i+=r.charAt(t);if(i.match(tu))return!0;break;case".":case"0":case"#":for(;t<r.length&&("0#?.,E+-%".indexOf(e=r.charAt(++t))>-1||e=="\\"&&r.charAt(t+1)=="-"&&"0#".indexOf(r.charAt(t+2))>-1););break;case"?":for(;r.charAt(++t)===e;);break;case"*":++t,(r.charAt(t)==" "||r.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<r.length&&"0123456789".indexOf(r.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function $m(r,t,e,i){for(var n=[],s="",a=0,o="",c="t",l,u,h,f="H";a<r.length;)switch(o=r.charAt(a)){case"G":if(!ya(r,a))throw new Error("unrecognized character "+o+" in "+r);n[n.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=r.charCodeAt(++a))!==34&&a<r.length;)s+=String.fromCharCode(h);n[n.length]={t:"t",v:s},++a;break;case"\\":var d=r.charAt(++a),g=d==="("||d===")"?d:"t";n[n.length]={t:g,v:d},++a;break;case"_":n[n.length]={t:"t",v:" "},a+=2;break;case"@":n[n.length]={t:"T",v:t},++a;break;case"B":case"b":if(r.charAt(a+1)==="1"||r.charAt(a+1)==="2"){if(l==null&&(l=fa(t,e,r.charAt(a+1)==="2"),l==null))return"";n[n.length]={t:"X",v:r.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||l==null&&(l=fa(t,e),l==null))return"";for(s=o;++a<r.length&&r.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),n[n.length]={t:o,v:s},c=o;break;case"A":case"a":case"\u4E0A":var p={t:o,v:o};if(l==null&&(l=fa(t,e)),r.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",f="h",a+=3):r.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",a+=5,f="h"):r.substr(a,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(l!=null&&(p.v=l.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),p.t="T",a+=5,f="h"):(p.t="t",++a),l==null&&p.t==="T")return"";n[n.length]=p,c=o;break;case"[":for(s=o;r.charAt(a++)!=="]"&&a<r.length;)s+=r.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(tu)){if(l==null&&(l=fa(t,e),l==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ru(r)||(n[n.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++a<r.length&&(o=r.charAt(a))==="0";)s+=o;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(a))>-1;)s+=o;n[n.length]={t:"n",v:s};break;case"?":for(s=o;r.charAt(++a)===o;)s+=o;n[n.length]={t:o,v:s},c=o;break;case"*":++a,(r.charAt(a)==" "||r.charAt(a)=="*")&&++a;break;case"(":case")":n[n.length]={t:i===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<r.length&&"0123456789".indexOf(r.charAt(++a))>-1;)s+=r.charAt(a);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:o,v:o},++a;break;case"$":n[n.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);n[n.length]={t:"t",v:o},++a;break}var x=0,O=0,A;for(a=n.length-1,c="t";a>=0;--a)switch(n[a].t){case"h":case"H":n[a].t=f,c="h",x<1&&(x=1);break;case"s":(A=n[a].v.match(/\.0+$/))&&(O=Math.max(O,A[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=n[a].t;break;case"m":c==="s"&&(n[a].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&n[a].v.match(/[Hh]/)&&(x=1),x<2&&n[a].v.match(/[Mm]/)&&(x=2),x<3&&n[a].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var D="",G;for(a=0;a<n.length;++a)switch(n[a].t){case"t":case"T":case" ":case"D":break;case"X":n[a].v="",n[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[a].v=Om(n[a].t.charCodeAt(0),n[a].v,l,O),n[a].t="t";break;case"n":case"?":for(G=a+1;n[G]!=null&&((o=n[G].t)==="?"||o==="D"||(o===" "||o==="t")&&n[G+1]!=null&&(n[G+1].t==="?"||n[G+1].t==="t"&&n[G+1].v==="/")||n[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[G].v==="/"||n[G].v===" "&&n[G+1]!=null&&n[G+1].t=="?"));)n[a].v+=n[G].v,n[G]={v:"",t:";"},++G;D+=n[a].v,a=G-1;break;case"G":n[a].t="t",n[a].v=Ho(t,e);break}var te="",me,M;if(D.length>0){D.charCodeAt(0)==40?(me=t<0&&D.charCodeAt(0)===45?-t:t,M=fi("n",D,me)):(me=t<0&&i>1?-t:t,M=fi("n",D,me),me<0&&n[0]&&n[0].t=="t"&&(M=M.substr(1),n[0].v="-"+n[0].v)),G=M.length-1;var Q=n.length;for(a=0;a<n.length;++a)if(n[a]!=null&&n[a].t!="t"&&n[a].v.indexOf(".")>-1){Q=a;break}var U=n.length;if(Q===n.length&&M.indexOf("E")===-1){for(a=n.length-1;a>=0;--a)n[a]==null||"n?".indexOf(n[a].t)===-1||(G>=n[a].v.length-1?(G-=n[a].v.length,n[a].v=M.substr(G+1,n[a].v.length)):G<0?n[a].v="":(n[a].v=M.substr(0,G+1),G=-1),n[a].t="t",U=a);G>=0&&U<n.length&&(n[U].v=M.substr(0,G+1)+n[U].v)}else if(Q!==n.length&&M.indexOf("E")===-1){for(G=M.indexOf(".")-1,a=Q;a>=0;--a)if(!(n[a]==null||"n?".indexOf(n[a].t)===-1)){for(u=n[a].v.indexOf(".")>-1&&a===Q?n[a].v.indexOf(".")-1:n[a].v.length-1,te=n[a].v.substr(u+1);u>=0;--u)G>=0&&(n[a].v.charAt(u)==="0"||n[a].v.charAt(u)==="#")&&(te=M.charAt(G--)+te);n[a].v=te,n[a].t="t",U=a}for(G>=0&&U<n.length&&(n[U].v=M.substr(0,G+1)+n[U].v),G=M.indexOf(".")+1,a=Q;a<n.length;++a)if(!(n[a]==null||"n?(".indexOf(n[a].t)===-1&&a!==Q)){for(u=n[a].v.indexOf(".")>-1&&a===Q?n[a].v.indexOf(".")+1:0,te=n[a].v.substr(0,u);u<n[a].v.length;++u)G<M.length&&(te+=M.charAt(G++));n[a].v=te,n[a].t="t",U=a}}}for(a=0;a<n.length;++a)n[a]!=null&&"n?".indexOf(n[a].t)>-1&&(me=i>1&&t<0&&a>0&&n[a-1].v==="-"?-t:t,n[a].v=fi(n[a].t,n[a].v,me),n[a].t="t");var q="";for(a=0;a!==n.length;++a)n[a]!=null&&(q+=n[a].v);return q}var f0=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function d0(r,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(r==e)return!0;break;case">":if(r>e)return!0;break;case"<":if(r<e)return!0;break;case"<>":if(r!=e)return!0;break;case">=":if(r>=e)return!0;break;case"<=":if(r<=e)return!0;break}return!1}function Hm(r,t){var e=Vm(r),i=e.length,n=e[i-1].indexOf("@");if(i<4&&n>-1&&--i,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||n>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=n>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=n>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=n>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break;case 4:break}var s=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[i,s];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var a=e[0].match(f0),o=e[1].match(f0);return d0(t,a)?[i,e[0]]:d0(t,o)?[i,e[1]]:[i,e[a!=null&&o!=null?2:1]]}return[i,s]}function ki(r,t,e){e==null&&(e={});var i="";switch(typeof r){case"string":r=="m/d/yy"&&e.dateNF?i=e.dateNF:i=r;break;case"number":r==14&&e.dateNF?i=e.dateNF:i=(e.table!=null?e.table:ft)[r],i==null&&(i=e.table&&e.table[c0[r]]||ft[c0[r]]),i==null&&(i=bm[r]||"General");break}if(ya(i,0))return Ho(t,e);t instanceof Date&&(t=j0(t,e.date1904));var n=Hm(i,t);if(ya(n[1]))return Ho(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return $m(n[1],t,e,n[0])}function iu(r,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(ft[e]==null){t<0&&(t=e);continue}if(ft[e]==r){t=e;break}}t<0&&(t=391)}return ft[t]=r,t}function Ma(r){for(var t=0;t!=392;++t)r[t]!==void 0&&iu(r[t],t)}function Pa(){ft=wm()}var nu=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Wm(r){var t=typeof r=="number"?ft[r]:r;return t=t.replace(nu,"(\\d+)"),new RegExp("^"+t+"$")}function zm(r,t,e){var i=-1,n=-1,s=-1,a=-1,o=-1,c=-1;(t.match(nu)||[]).forEach(function(h,f){var d=parseInt(e[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":i=d;break;case"d":s=d;break;case"h":a=d;break;case"s":c=d;break;case"m":a>=0?o=d:n=d;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var l=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?l:i==-1&&n==-1&&s==-1?u:l+"T"+u}var Um=function(){var r={};r.version="1.2.0";function t(){for(var M=0,Q=new Array(256),U=0;U!=256;++U)M=U,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,Q[U]=M;return typeof Int32Array<"u"?new Int32Array(Q):Q}var e=t();function i(M){var Q=0,U=0,q=0,ee=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(q=0;q!=256;++q)ee[q]=M[q];for(q=0;q!=256;++q)for(U=M[q],Q=256+q;Q<4096;Q+=256)U=ee[Q]=U>>>8^M[U&255];var re=[];for(q=1;q!=16;++q)re[q-1]=typeof Int32Array<"u"?ee.subarray(q*256,q*256+256):ee.slice(q*256,q*256+256);return re}var n=i(e),s=n[0],a=n[1],o=n[2],c=n[3],l=n[4],u=n[5],h=n[6],f=n[7],d=n[8],g=n[9],p=n[10],x=n[11],O=n[12],A=n[13],D=n[14];function G(M,Q){for(var U=Q^-1,q=0,ee=M.length;q<ee;)U=U>>>8^e[(U^M.charCodeAt(q++))&255];return~U}function te(M,Q){for(var U=Q^-1,q=M.length-15,ee=0;ee<q;)U=D[M[ee++]^U&255]^A[M[ee++]^U>>8&255]^O[M[ee++]^U>>16&255]^x[M[ee++]^U>>>24]^p[M[ee++]]^g[M[ee++]]^d[M[ee++]]^f[M[ee++]]^h[M[ee++]]^u[M[ee++]]^l[M[ee++]]^c[M[ee++]]^o[M[ee++]]^a[M[ee++]]^s[M[ee++]]^e[M[ee++]];for(q+=15;ee<q;)U=U>>>8^e[(U^M[ee++])&255];return~U}function me(M,Q){for(var U=Q^-1,q=0,ee=M.length,re=0,Ce=0;q<ee;)re=M.charCodeAt(q++),re<128?U=U>>>8^e[(U^re)&255]:re<2048?(U=U>>>8^e[(U^(192|re>>6&31))&255],U=U>>>8^e[(U^(128|re&63))&255]):re>=55296&&re<57344?(re=(re&1023)+64,Ce=M.charCodeAt(q++)&1023,U=U>>>8^e[(U^(240|re>>8&7))&255],U=U>>>8^e[(U^(128|re>>2&63))&255],U=U>>>8^e[(U^(128|Ce>>6&15|(re&3)<<4))&255],U=U>>>8^e[(U^(128|Ce&63))&255]):(U=U>>>8^e[(U^(224|re>>12&15))&255],U=U>>>8^e[(U^(128|re>>6&63))&255],U=U>>>8^e[(U^(128|re&63))&255]);return~U}return r.table=e,r.bstr=G,r.buf=te,r.str=me,r}(),Je=function(){var t={};t.version="1.2.1";function e(m,b){for(var _=m.split("/"),v=b.split("/"),C=0,T=0,R=Math.min(_.length,v.length);C<R;++C){if(T=_[C].length-v[C].length)return T;if(_[C]!=v[C])return _[C]<v[C]?-1:1}return _.length-v.length}function i(m){if(m.charAt(m.length-1)=="/")return m.slice(0,-1).indexOf("/")===-1?m:i(m.slice(0,-1));var b=m.lastIndexOf("/");return b===-1?m:m.slice(0,b+1)}function n(m){if(m.charAt(m.length-1)=="/")return n(m.slice(0,-1));var b=m.lastIndexOf("/");return b===-1?m:m.slice(b+1)}function s(m,b){typeof b=="string"&&(b=new Date(b));var _=b.getHours();_=_<<6|b.getMinutes(),_=_<<5|b.getSeconds()>>>1,m.write_shift(2,_);var v=b.getFullYear()-1980;v=v<<4|b.getMonth()+1,v=v<<5|b.getDate(),m.write_shift(2,v)}function a(m){var b=m.read_shift(2)&65535,_=m.read_shift(2)&65535,v=new Date,C=_&31;_>>>=5;var T=_&15;_>>>=4,v.setMilliseconds(0),v.setFullYear(_+1980),v.setMonth(T-1),v.setDate(C);var R=b&31;b>>>=5;var W=b&63;return b>>>=6,v.setHours(b),v.setMinutes(W),v.setSeconds(R<<1),v}function o(m){kr(m,0);for(var b={},_=0;m.l<=m.length-4;){var v=m.read_shift(2),C=m.read_shift(2),T=m.l+C,R={};switch(v){case 21589:_=m.read_shift(1),_&1&&(R.mtime=m.read_shift(4)),C>5&&(_&2&&(R.atime=m.read_shift(4)),_&4&&(R.ctime=m.read_shift(4))),R.mtime&&(R.mt=new Date(R.mtime*1e3));break}m.l=T,b[v]=R}return b}var c;function l(){return c||(c={})}function u(m,b){if(m[0]==80&&m[1]==75)return Fl(m,b);if((m[0]|32)==109&&(m[1]|32)==105)return zh(m,b);if(m.length<512)throw new Error("CFB file size "+m.length+" < 512");var _=3,v=512,C=0,T=0,R=0,W=0,B=0,N=[],V=m.slice(0,512);kr(V,0);var ie=h(V);switch(_=ie[0],_){case 3:v=512;break;case 4:v=4096;break;case 0:if(ie[1]==0)return Fl(m,b);default:throw new Error("Major Version: Expected 3 or 4 saw "+_)}v!==512&&(V=m.slice(0,v),kr(V,28));var ae=m.slice(0,v);f(V,_);var _e=V.read_shift(4,"i");if(_===3&&_e!==0)throw new Error("# Directory Sectors: Expected 0 saw "+_e);V.l+=4,R=V.read_shift(4,"i"),V.l+=4,V.chk("00100000","Mini Stream Cutoff Size: "),W=V.read_shift(4,"i"),C=V.read_shift(4,"i"),B=V.read_shift(4,"i"),T=V.read_shift(4,"i");for(var oe=-1,ue=0;ue<109&&(oe=V.read_shift(4,"i"),!(oe<0));++ue)N[ue]=oe;var Fe=d(m,v);x(B,T,Fe,v,N);var nt=A(Fe,R,N,v);nt[R].name="!Directory",C>0&&W!==Ce&&(nt[W].name="!MiniFAT"),nt[N[0]].name="!FAT",nt.fat_addrs=N,nt.ssz=v;var dr={},gt=[],vr=[],Xn=[];D(R,nt,Fe,gt,C,dr,vr,W),g(vr,Xn,gt),gt.shift();var jn={FileIndex:vr,FullPaths:Xn};return b&&b.raw&&(jn.raw={header:ae,sectors:Fe}),jn}function h(m){if(m[m.l]==80&&m[m.l+1]==75)return[0,0];m.chk(je,"Header Signature: "),m.l+=16;var b=m.read_shift(2,"u");return[m.read_shift(2,"u"),b]}function f(m,b){var _=9;switch(m.l+=2,_=m.read_shift(2)){case 9:if(b!=3)throw new Error("Sector Shift: Expected 9 saw "+_);break;case 12:if(b!=4)throw new Error("Sector Shift: Expected 12 saw "+_);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+_)}m.chk("0600","Mini Sector Shift: "),m.chk("000000000000","Reserved: ")}function d(m,b){for(var _=Math.ceil(m.length/b)-1,v=[],C=1;C<_;++C)v[C-1]=m.slice(C*b,(C+1)*b);return v[_-1]=m.slice(_*b),v}function g(m,b,_){for(var v=0,C=0,T=0,R=0,W=0,B=_.length,N=[],V=[];v<B;++v)N[v]=V[v]=v,b[v]=_[v];for(;W<V.length;++W)v=V[W],C=m[v].L,T=m[v].R,R=m[v].C,N[v]===v&&(C!==-1&&N[C]!==C&&(N[v]=N[C]),T!==-1&&N[T]!==T&&(N[v]=N[T])),R!==-1&&(N[R]=v),C!==-1&&v!=N[v]&&(N[C]=N[v],V.lastIndexOf(C)<W&&V.push(C)),T!==-1&&v!=N[v]&&(N[T]=N[v],V.lastIndexOf(T)<W&&V.push(T));for(v=1;v<B;++v)N[v]===v&&(T!==-1&&N[T]!==T?N[v]=N[T]:C!==-1&&N[C]!==C&&(N[v]=N[C]));for(v=1;v<B;++v)if(m[v].type!==0){if(W=v,W!=N[W])do W=N[W],b[v]=b[W]+"/"+b[v];while(W!==0&&N[W]!==-1&&W!=N[W]);N[v]=-1}for(b[0]+="/",v=1;v<B;++v)m[v].type!==2&&(b[v]+="/")}function p(m,b,_){for(var v=m.start,C=m.size,T=[],R=v;_&&C>0&&R>=0;)T.push(b.slice(R*re,R*re+re)),C-=re,R=Wi(_,R*4);return T.length===0?H(0):jt(T).slice(0,m.size)}function x(m,b,_,v,C){var T=Ce;if(m===Ce){if(b!==0)throw new Error("DIFAT chain shorter than expected")}else if(m!==-1){var R=_[m],W=(v>>>2)-1;if(!R)return;for(var B=0;B<W&&(T=Wi(R,B*4))!==Ce;++B)C.push(T);x(Wi(R,v-4),b-1,_,v,C)}}function O(m,b,_,v,C){var T=[],R=[];C||(C=[]);var W=v-1,B=0,N=0;for(B=b;B>=0;){C[B]=!0,T[T.length]=B,R.push(m[B]);var V=_[Math.floor(B*4/v)];if(N=B*4&W,v<4+N)throw new Error("FAT boundary crossed: "+B+" 4 "+v);if(!m[V])break;B=Wi(m[V],N)}return{nodes:T,data:w0([R])}}function A(m,b,_,v){var C=m.length,T=[],R=[],W=[],B=[],N=v-1,V=0,ie=0,ae=0,_e=0;for(V=0;V<C;++V)if(W=[],ae=V+b,ae>=C&&(ae-=C),!R[ae]){B=[];var oe=[];for(ie=ae;ie>=0;){oe[ie]=!0,R[ie]=!0,W[W.length]=ie,B.push(m[ie]);var ue=_[Math.floor(ie*4/v)];if(_e=ie*4&N,v<4+_e)throw new Error("FAT boundary crossed: "+ie+" 4 "+v);if(!m[ue]||(ie=Wi(m[ue],_e),oe[ie]))break}T[ae]={nodes:W,data:w0([B])}}return T}function D(m,b,_,v,C,T,R,W){for(var B=0,N=v.length?2:0,V=b[m].data,ie=0,ae=0,_e;ie<V.length;ie+=128){var oe=V.slice(ie,ie+128);kr(oe,64),ae=oe.read_shift(2),_e=Na(oe,0,ae-N),v.push(_e);var ue={name:_e,type:oe.read_shift(1),color:oe.read_shift(1),L:oe.read_shift(4,"i"),R:oe.read_shift(4,"i"),C:oe.read_shift(4,"i"),clsid:oe.read_shift(16),state:oe.read_shift(4,"i"),start:0,size:0},Fe=oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2);Fe!==0&&(ue.ct=G(oe,oe.l-8));var nt=oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2);nt!==0&&(ue.mt=G(oe,oe.l-8)),ue.start=oe.read_shift(4,"i"),ue.size=oe.read_shift(4,"i"),ue.size<0&&ue.start<0&&(ue.size=ue.type=0,ue.start=Ce,ue.name=""),ue.type===5?(B=ue.start,C>0&&B!==Ce&&(b[B].name="!StreamData")):ue.size>=4096?(ue.storage="fat",b[ue.start]===void 0&&(b[ue.start]=O(_,ue.start,b.fat_addrs,b.ssz)),b[ue.start].name=ue.name,ue.content=b[ue.start].data.slice(0,ue.size)):(ue.storage="minifat",ue.size<0?ue.size=0:B!==Ce&&ue.start!==Ce&&b[B]&&(ue.content=p(ue,b[B].data,(b[W]||{}).data))),ue.content&&kr(ue.content,0),T[_e]=ue,R.push(ue)}}function G(m,b){return new Date((Dt(m,b+4)/1e7*Math.pow(2,32)+Dt(m,b)/1e7-11644473600)*1e3)}function te(m,b){return l(),u(c.readFileSync(m),b)}function me(m,b){var _=b&&b.type;switch(_||Xe&&Buffer.isBuffer(m)&&(_="buffer"),_||"base64"){case"file":return te(m,b);case"base64":return u(Gr(mi(m)),b);case"binary":return u(Gr(m),b)}return u(m,b)}function M(m,b){var _=b||{},v=_.root||"Root Entry";if(m.FullPaths||(m.FullPaths=[]),m.FileIndex||(m.FileIndex=[]),m.FullPaths.length!==m.FileIndex.length)throw new Error("inconsistent CFB structure");m.FullPaths.length===0&&(m.FullPaths[0]=v+"/",m.FileIndex[0]={name:v,type:5}),_.CLSID&&(m.FileIndex[0].clsid=_.CLSID),Q(m)}function Q(m){var b="Sh33tJ5";if(!Je.find(m,"/"+b)){var _=H(4);_[0]=55,_[1]=_[3]=50,_[2]=54,m.FileIndex.push({name:b,type:2,content:_,size:4,L:69,R:69,C:69}),m.FullPaths.push(m.FullPaths[0]+b),U(m)}}function U(m,b){M(m);for(var _=!1,v=!1,C=m.FullPaths.length-1;C>=0;--C){var T=m.FileIndex[C];switch(T.type){case 0:v?_=!0:(m.FileIndex.pop(),m.FullPaths.pop());break;case 1:case 2:case 5:v=!0,isNaN(T.R*T.L*T.C)&&(_=!0),T.R>-1&&T.L>-1&&T.R==T.L&&(_=!0);break;default:_=!0;break}}if(!(!_&&!b)){var R=new Date(1987,1,19),W=0,B=Object.create?Object.create(null):{},N=[];for(C=0;C<m.FullPaths.length;++C)B[m.FullPaths[C]]=!0,m.FileIndex[C].type!==0&&N.push([m.FullPaths[C],m.FileIndex[C]]);for(C=0;C<N.length;++C){var V=i(N[C][0]);v=B[V],v||(N.push([V,{name:n(V).replace("/",""),type:1,clsid:It,ct:R,mt:R,content:null}]),B[V]=!0)}for(N.sort(function(_e,oe){return e(_e[0],oe[0])}),m.FullPaths=[],m.FileIndex=[],C=0;C<N.length;++C)m.FullPaths[C]=N[C][0],m.FileIndex[C]=N[C][1];for(C=0;C<N.length;++C){var ie=m.FileIndex[C],ae=m.FullPaths[C];if(ie.name=n(ae).replace("/",""),ie.L=ie.R=ie.C=-(ie.color=1),ie.size=ie.content?ie.content.length:0,ie.start=0,ie.clsid=ie.clsid||It,C===0)ie.C=N.length>1?1:-1,ie.size=0,ie.type=5;else if(ae.slice(-1)=="/"){for(W=C+1;W<N.length&&i(m.FullPaths[W])!=ae;++W);for(ie.C=W>=N.length?-1:W,W=C+1;W<N.length&&i(m.FullPaths[W])!=i(ae);++W);ie.R=W>=N.length?-1:W,ie.type=1}else i(m.FullPaths[C+1]||"")==i(ae)&&(ie.R=C+1),ie.type=2}}}function q(m,b){var _=b||{};if(_.fileType=="mad")return Uh(m,_);switch(U(m),_.fileType){case"zip":return Nh(m,_)}var v=function(_e){for(var oe=0,ue=0,Fe=0;Fe<_e.FileIndex.length;++Fe){var nt=_e.FileIndex[Fe];if(nt.content){var dr=nt.content.length;dr>0&&(dr<4096?oe+=dr+63>>6:ue+=dr+511>>9)}}for(var gt=_e.FullPaths.length+3>>2,vr=oe+7>>3,Xn=oe+127>>7,jn=vr+ue+gt+Xn,Pi=jn+127>>7,ja=Pi<=109?0:Math.ceil((Pi-109)/127);jn+Pi+ja+127>>7>Pi;)ja=++Pi<=109?0:Math.ceil((Pi-109)/127);var si=[1,ja,Pi,Xn,gt,ue,oe,0];return _e.FileIndex[0].size=oe<<6,si[7]=(_e.FileIndex[0].start=si[0]+si[1]+si[2]+si[3]+si[4]+si[5])+(si[6]+7>>3),si}(m),C=H(v[7]<<9),T=0,R=0;{for(T=0;T<8;++T)C.write_shift(1,Te[T]);for(T=0;T<8;++T)C.write_shift(2,0);for(C.write_shift(2,62),C.write_shift(2,3),C.write_shift(2,65534),C.write_shift(2,9),C.write_shift(2,6),T=0;T<3;++T)C.write_shift(2,0);for(C.write_shift(4,0),C.write_shift(4,v[2]),C.write_shift(4,v[0]+v[1]+v[2]+v[3]-1),C.write_shift(4,0),C.write_shift(4,4096),C.write_shift(4,v[3]?v[0]+v[1]+v[2]-1:Ce),C.write_shift(4,v[3]),C.write_shift(-4,v[1]?v[0]-1:Ce),C.write_shift(4,v[1]),T=0;T<109;++T)C.write_shift(-4,T<v[2]?v[1]+T:-1)}if(v[1])for(R=0;R<v[1];++R){for(;T<236+R*127;++T)C.write_shift(-4,T<v[2]?v[1]+T:-1);C.write_shift(-4,R===v[1]-1?Ce:R+1)}var W=function(_e){for(R+=_e;T<R-1;++T)C.write_shift(-4,T+1);_e&&(++T,C.write_shift(-4,Ce))};for(R=T=0,R+=v[1];T<R;++T)C.write_shift(-4,kt.DIFSECT);for(R+=v[2];T<R;++T)C.write_shift(-4,kt.FATSECT);W(v[3]),W(v[4]);for(var B=0,N=0,V=m.FileIndex[0];B<m.FileIndex.length;++B)V=m.FileIndex[B],V.content&&(N=V.content.length,!(N<4096)&&(V.start=R,W(N+511>>9)));for(W(v[6]+7>>3);C.l&511;)C.write_shift(-4,kt.ENDOFCHAIN);for(R=T=0,B=0;B<m.FileIndex.length;++B)V=m.FileIndex[B],V.content&&(N=V.content.length,!(!N||N>=4096)&&(V.start=R,W(N+63>>6)));for(;C.l&511;)C.write_shift(-4,kt.ENDOFCHAIN);for(T=0;T<v[4]<<2;++T){var ie=m.FullPaths[T];if(!ie||ie.length===0){for(B=0;B<17;++B)C.write_shift(4,0);for(B=0;B<3;++B)C.write_shift(4,-1);for(B=0;B<12;++B)C.write_shift(4,0);continue}V=m.FileIndex[T],T===0&&(V.start=V.size?V.start-1:Ce);var ae=T===0&&_.root||V.name;if(N=2*(ae.length+1),C.write_shift(64,ae,"utf16le"),C.write_shift(2,N),C.write_shift(1,V.type),C.write_shift(1,V.color),C.write_shift(-4,V.L),C.write_shift(-4,V.R),C.write_shift(-4,V.C),V.clsid)C.write_shift(16,V.clsid,"hex");else for(B=0;B<4;++B)C.write_shift(4,0);C.write_shift(4,V.state||0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,V.start),C.write_shift(4,V.size),C.write_shift(4,0)}for(T=1;T<m.FileIndex.length;++T)if(V=m.FileIndex[T],V.size>=4096)if(C.l=V.start+1<<9,Xe&&Buffer.isBuffer(V.content))V.content.copy(C,C.l,0,V.size),C.l+=V.size+511&-512;else{for(B=0;B<V.size;++B)C.write_shift(1,V.content[B]);for(;B&511;++B)C.write_shift(1,0)}for(T=1;T<m.FileIndex.length;++T)if(V=m.FileIndex[T],V.size>0&&V.size<4096)if(Xe&&Buffer.isBuffer(V.content))V.content.copy(C,C.l,0,V.size),C.l+=V.size+63&-64;else{for(B=0;B<V.size;++B)C.write_shift(1,V.content[B]);for(;B&63;++B)C.write_shift(1,0)}if(Xe)C.l=C.length;else for(;C.l<C.length;)C.write_shift(1,0);return C}function ee(m,b){var _=m.FullPaths.map(function(B){return B.toUpperCase()}),v=_.map(function(B){var N=B.split("/");return N[N.length-(B.slice(-1)=="/"?2:1)]}),C=!1;b.charCodeAt(0)===47?(C=!0,b=_[0].slice(0,-1)+b):C=b.indexOf("/")!==-1;var T=b.toUpperCase(),R=C===!0?_.indexOf(T):v.indexOf(T);if(R!==-1)return m.FileIndex[R];var W=!T.match(ha);for(T=T.replace(kn,""),W&&(T=T.replace(ha,"!")),R=0;R<_.length;++R)if((W?_[R].replace(ha,"!"):_[R]).replace(kn,"")==T||(W?v[R].replace(ha,"!"):v[R]).replace(kn,"")==T)return m.FileIndex[R];return null}var re=64,Ce=-2,je="d0cf11e0a1b11ae1",Te=[208,207,17,224,161,177,26,225],It="00000000000000000000000000000000",kt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Ce,FREESECT:-1,HEADER_SIGNATURE:je,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:It,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function hr(m,b,_){l();var v=q(m,_);c.writeFileSync(b,v)}function ar(m){for(var b=new Array(m.length),_=0;_<m.length;++_)b[_]=String.fromCharCode(m[_]);return b.join("")}function Rt(m,b){var _=q(m,b);switch(b&&b.type||"buffer"){case"file":return l(),c.writeFileSync(b.filename,_),_;case"binary":return typeof _=="string"?_:ar(_);case"base64":return ws(typeof _=="string"?_:ar(_));case"buffer":if(Xe)return Buffer.isBuffer(_)?_:xi(_);case"array":return typeof _=="string"?Gr(_):_}return _}var fr;function E(m){try{var b=m.InflateRaw,_=new b;if(_._processChunk(new Uint8Array([3,0]),_._finishFlushFlag),_.bytesRead)fr=m;else throw new Error("zlib does not expose bytesRead")}catch(v){console.error("cannot use native zlib: "+(v.message||v))}}function K(m,b){if(!fr)return Il(m,b);var _=fr.InflateRaw,v=new _,C=v._processChunk(m.slice(m.l),v._finishFlushFlag);return m.l+=v.bytesRead,C}function k(m){return fr?fr.deflateRawSync(m):wl(m)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ke(m){var b=(m<<1|m<<11)&139536|(m<<5|m<<15)&558144;return(b>>16|b>>8|b)&255}for(var xe=typeof Uint8Array<"u",le=xe?new Uint8Array(256):[],Ze=0;Ze<256;++Ze)le[Ze]=ke(Ze);function Ne(m,b){var _=le[m&255];return b<=8?_>>>8-b:(_=_<<8|le[m>>8&255],b<=16?_>>>16-b:(_=_<<8|le[m>>16&255],_>>>24-b))}function Nt(m,b){var _=b&7,v=b>>>3;return(m[v]|(_<=6?0:m[v+1]<<8))>>>_&3}function We(m,b){var _=b&7,v=b>>>3;return(m[v]|(_<=5?0:m[v+1]<<8))>>>_&7}function Vr(m,b){var _=b&7,v=b>>>3;return(m[v]|(_<=4?0:m[v+1]<<8))>>>_&15}function lt(m,b){var _=b&7,v=b>>>3;return(m[v]|(_<=3?0:m[v+1]<<8))>>>_&31}function ye(m,b){var _=b&7,v=b>>>3;return(m[v]|(_<=1?0:m[v+1]<<8))>>>_&127}function Ar(m,b,_){var v=b&7,C=b>>>3,T=(1<<_)-1,R=m[C]>>>v;return _<8-v||(R|=m[C+1]<<8-v,_<16-v)||(R|=m[C+2]<<16-v,_<24-v)||(R|=m[C+3]<<24-v),R&T}function ni(m,b,_){var v=b&7,C=b>>>3;return v<=5?m[C]|=(_&7)<<v:(m[C]|=_<<v&255,m[C+1]=(_&7)>>8-v),b+3}function Di(m,b,_){var v=b&7,C=b>>>3;return _=(_&1)<<v,m[C]|=_,b+1}function Ji(m,b,_){var v=b&7,C=b>>>3;return _<<=v,m[C]|=_&255,_>>>=8,m[C+1]=_,b+8}function yl(m,b,_){var v=b&7,C=b>>>3;return _<<=v,m[C]|=_&255,_>>>=8,m[C+1]=_&255,m[C+2]=_>>>8,b+16}function za(m,b){var _=m.length,v=2*_>b?2*_:b+5,C=0;if(_>=b)return m;if(Xe){var T=a0(v);if(m.copy)m.copy(T);else for(;C<m.length;++C)T[C]=m[C];return T}else if(xe){var R=new Uint8Array(v);if(R.set)R.set(m);else for(;C<_;++C)R[C]=m[C];return R}return m.length=v,m}function Kr(m){for(var b=new Array(m),_=0;_<m;++_)b[_]=0;return b}function Ds(m,b,_){var v=1,C=0,T=0,R=0,W=0,B=m.length,N=xe?new Uint16Array(32):Kr(32);for(T=0;T<32;++T)N[T]=0;for(T=B;T<_;++T)m[T]=0;B=m.length;var V=xe?new Uint16Array(B):Kr(B);for(T=0;T<B;++T)N[C=m[T]]++,v<C&&(v=C),V[T]=0;for(N[0]=0,T=1;T<=v;++T)N[T+16]=W=W+N[T-1]<<1;for(T=0;T<B;++T)W=m[T],W!=0&&(V[T]=N[W+16]++);var ie=0;for(T=0;T<B;++T)if(ie=m[T],ie!=0)for(W=Ne(V[T],v)>>v-ie,R=(1<<v+4-ie)-1;R>=0;--R)b[W|R<<ie]=ie&15|T<<4;return v}var Ua=xe?new Uint16Array(512):Kr(512),Ga=xe?new Uint16Array(32):Kr(32);if(!xe){for(var Mi=0;Mi<512;++Mi)Ua[Mi]=0;for(Mi=0;Mi<32;++Mi)Ga[Mi]=0}(function(){for(var m=[],b=0;b<32;b++)m.push(5);Ds(m,Ga,32);var _=[];for(b=0;b<=143;b++)_.push(8);for(;b<=255;b++)_.push(9);for(;b<=279;b++)_.push(7);for(;b<=287;b++)_.push(8);Ds(_,Ua,288)})();var Mh=function(){for(var b=xe?new Uint8Array(32768):[],_=0,v=0;_<we.length-1;++_)for(;v<we[_+1];++v)b[v]=_;for(;v<32768;++v)b[v]=29;var C=xe?new Uint8Array(259):[];for(_=0,v=0;_<J.length-1;++_)for(;v<J[_+1];++v)C[v]=_;function T(W,B){for(var N=0;N<W.length;){var V=Math.min(65535,W.length-N),ie=N+V==W.length;for(B.write_shift(1,+ie),B.write_shift(2,V),B.write_shift(2,~V&65535);V-- >0;)B[B.l++]=W[N++]}return B.l}function R(W,B){for(var N=0,V=0,ie=xe?new Uint16Array(32768):[];V<W.length;){var ae=Math.min(65535,W.length-V);if(ae<10){for(N=ni(B,N,+(V+ae==W.length)),N&7&&(N+=8-(N&7)),B.l=N/8|0,B.write_shift(2,ae),B.write_shift(2,~ae&65535);ae-- >0;)B[B.l++]=W[V++];N=B.l*8;continue}N=ni(B,N,+(V+ae==W.length)+2);for(var _e=0;ae-- >0;){var oe=W[V];_e=(_e<<5^oe)&32767;var ue=-1,Fe=0;if((ue=ie[_e])&&(ue|=V&-32768,ue>V&&(ue-=32768),ue<V))for(;W[ue+Fe]==W[V+Fe]&&Fe<250;)++Fe;if(Fe>2){oe=C[Fe],oe<=22?N=Ji(B,N,le[oe+1]>>1)-1:(Ji(B,N,3),N+=5,Ji(B,N,le[oe-23]>>5),N+=3);var nt=oe<8?0:oe-4>>2;nt>0&&(yl(B,N,Fe-J[oe]),N+=nt),oe=b[V-ue],N=Ji(B,N,le[oe]>>3),N-=3;var dr=oe<4?0:oe-2>>1;dr>0&&(yl(B,N,V-ue-we[oe]),N+=dr);for(var gt=0;gt<Fe;++gt)ie[_e]=V&32767,_e=(_e<<5^W[V])&32767,++V;ae-=Fe-1}else oe<=143?oe=oe+48:N=Di(B,N,1),N=Ji(B,N,le[oe]),ie[_e]=V&32767,++V}N=Ji(B,N,0)-1}return B.l=(N+7)/8|0,B.l}return function(B,N){return B.length<8?T(B,N):R(B,N)}}();function wl(m){var b=H(50+Math.floor(m.length*1.1)),_=Mh(m,b);return b.slice(0,_)}var bl=xe?new Uint16Array(32768):Kr(32768),Cl=xe?new Uint16Array(32768):Kr(32768),Tl=xe?new Uint16Array(128):Kr(128),Sl=1,El=1;function Ph(m,b){var _=lt(m,b)+257;b+=5;var v=lt(m,b)+1;b+=5;var C=Vr(m,b)+4;b+=4;for(var T=0,R=xe?new Uint8Array(19):Kr(19),W=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=1,N=xe?new Uint8Array(8):Kr(8),V=xe?new Uint8Array(8):Kr(8),ie=R.length,ae=0;ae<C;++ae)R[I[ae]]=T=We(m,b),B<T&&(B=T),N[T]++,b+=3;var _e=0;for(N[0]=0,ae=1;ae<=B;++ae)V[ae]=_e=_e+N[ae-1]<<1;for(ae=0;ae<ie;++ae)(_e=R[ae])!=0&&(W[ae]=V[_e]++);var oe=0;for(ae=0;ae<ie;++ae)if(oe=R[ae],oe!=0){_e=le[W[ae]]>>8-oe;for(var ue=(1<<7-oe)-1;ue>=0;--ue)Tl[_e|ue<<oe]=oe&7|ae<<3}var Fe=[];for(B=1;Fe.length<_+v;)switch(_e=Tl[ye(m,b)],b+=_e&7,_e>>>=3){case 16:for(T=3+Nt(m,b),b+=2,_e=Fe[Fe.length-1];T-- >0;)Fe.push(_e);break;case 17:for(T=3+We(m,b),b+=3;T-- >0;)Fe.push(0);break;case 18:for(T=11+ye(m,b),b+=7;T-- >0;)Fe.push(0);break;default:Fe.push(_e),B<_e&&(B=_e);break}var nt=Fe.slice(0,_),dr=Fe.slice(_);for(ae=_;ae<286;++ae)nt[ae]=0;for(ae=v;ae<30;++ae)dr[ae]=0;return Sl=Ds(nt,bl,286),El=Ds(dr,Cl,30),b}function Lh(m,b){if(m[0]==3&&!(m[1]&3))return[Gi(b),2];for(var _=0,v=0,C=a0(b||1<<18),T=0,R=C.length>>>0,W=0,B=0;(v&1)==0;){if(v=We(m,_),_+=3,v>>>1)v>>1==1?(W=9,B=5):(_=Ph(m,_),W=Sl,B=El);else{_&7&&(_+=8-(_&7));var N=m[_>>>3]|m[(_>>>3)+1]<<8;if(_+=32,N>0)for(!b&&R<T+N&&(C=za(C,T+N),R=C.length);N-- >0;)C[T++]=m[_>>>3],_+=8;continue}for(;;){!b&&R<T+32767&&(C=za(C,T+32767),R=C.length);var V=Ar(m,_,W),ie=v>>>1==1?Ua[V]:bl[V];if(_+=ie&15,ie>>>=4,(ie>>>8&255)===0)C[T++]=ie;else{if(ie==256)break;ie-=257;var ae=ie<8?0:ie-4>>2;ae>5&&(ae=0);var _e=T+J[ie];ae>0&&(_e+=Ar(m,_,ae),_+=ae),V=Ar(m,_,B),ie=v>>>1==1?Ga[V]:Cl[V],_+=ie&15,ie>>>=4;var oe=ie<4?0:ie-2>>1,ue=we[ie];for(oe>0&&(ue+=Ar(m,_,oe),_+=oe),!b&&R<_e&&(C=za(C,_e+100),R=C.length);T<_e;)C[T]=C[T-ue],++T}}}return b?[C,_+7>>>3]:[C.slice(0,T),_+7>>>3]}function Il(m,b){var _=m.slice(m.l||0),v=Lh(_,b);return m.l+=v[1],v[0]}function kl(m,b){if(m)typeof console<"u"&&console.error(b);else throw new Error(b)}function Fl(m,b){var _=m;kr(_,0);var v=[],C=[],T={FileIndex:v,FullPaths:C};M(T,{root:b.root});for(var R=_.length-4;(_[R]!=80||_[R+1]!=75||_[R+2]!=5||_[R+3]!=6)&&R>=0;)--R;_.l=R+4,_.l+=4;var W=_.read_shift(2);_.l+=6;var B=_.read_shift(4);for(_.l=B,R=0;R<W;++R){_.l+=20;var N=_.read_shift(4),V=_.read_shift(4),ie=_.read_shift(2),ae=_.read_shift(2),_e=_.read_shift(2);_.l+=8;var oe=_.read_shift(4),ue=o(_.slice(_.l+ie,_.l+ie+ae));_.l+=ie+ae+_e;var Fe=_.l;_.l=oe+4,Rh(_,N,V,T,ue),_.l=Fe}return T}function Rh(m,b,_,v,C){m.l+=2;var T=m.read_shift(2),R=m.read_shift(2),W=a(m);if(T&8257)throw new Error("Unsupported ZIP encryption");for(var B=m.read_shift(4),N=m.read_shift(4),V=m.read_shift(4),ie=m.read_shift(2),ae=m.read_shift(2),_e="",oe=0;oe<ie;++oe)_e+=String.fromCharCode(m[m.l++]);if(ae){var ue=o(m.slice(m.l,m.l+ae));(ue[21589]||{}).mt&&(W=ue[21589].mt),((C||{})[21589]||{}).mt&&(W=C[21589].mt)}m.l+=ae;var Fe=m.slice(m.l,m.l+N);switch(R){case 8:Fe=K(m,V);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+R)}var nt=!1;T&8&&(B=m.read_shift(4),B==134695760&&(B=m.read_shift(4),nt=!0),N=m.read_shift(4),V=m.read_shift(4)),N!=b&&kl(nt,"Bad compressed size: "+b+" != "+N),V!=_&&kl(nt,"Bad uncompressed size: "+_+" != "+V),Xa(v,_e,Fe,{unsafe:!0,mt:W})}function Nh(m,b){var _=b||{},v=[],C=[],T=H(1),R=_.compression?8:0,W=0,B=!1;B&&(W|=8);var N=0,V=0,ie=0,ae=0,_e=m.FullPaths[0],oe=_e,ue=m.FileIndex[0],Fe=[],nt=0;for(N=1;N<m.FullPaths.length;++N)if(oe=m.FullPaths[N].slice(_e.length),ue=m.FileIndex[N],!(!ue.size||!ue.content||oe=="Sh33tJ5")){var dr=ie,gt=H(oe.length);for(V=0;V<oe.length;++V)gt.write_shift(1,oe.charCodeAt(V)&127);gt=gt.slice(0,gt.l),Fe[ae]=Um.buf(ue.content,0);var vr=ue.content;R==8&&(vr=k(vr)),T=H(30),T.write_shift(4,67324752),T.write_shift(2,20),T.write_shift(2,W),T.write_shift(2,R),ue.mt?s(T,ue.mt):T.write_shift(4,0),T.write_shift(-4,W&8?0:Fe[ae]),T.write_shift(4,W&8?0:vr.length),T.write_shift(4,W&8?0:ue.content.length),T.write_shift(2,gt.length),T.write_shift(2,0),ie+=T.length,v.push(T),ie+=gt.length,v.push(gt),ie+=vr.length,v.push(vr),W&8&&(T=H(12),T.write_shift(-4,Fe[ae]),T.write_shift(4,vr.length),T.write_shift(4,ue.content.length),ie+=T.l,v.push(T)),T=H(46),T.write_shift(4,33639248),T.write_shift(2,0),T.write_shift(2,20),T.write_shift(2,W),T.write_shift(2,R),T.write_shift(4,0),T.write_shift(-4,Fe[ae]),T.write_shift(4,vr.length),T.write_shift(4,ue.content.length),T.write_shift(2,gt.length),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(4,0),T.write_shift(4,dr),nt+=T.l,C.push(T),nt+=gt.length,C.push(gt),++ae}return T=H(22),T.write_shift(4,101010256),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,ae),T.write_shift(2,ae),T.write_shift(4,nt),T.write_shift(4,ie),T.write_shift(2,0),jt([jt(v),jt(C),T])}var Ms={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Bh(m,b){if(m.ctype)return m.ctype;var _=m.name||"",v=_.match(/\.([^\.]+)$/);return v&&Ms[v[1]]||b&&(v=(_=b).match(/[\.\\]([^\.\\])+$/),v&&Ms[v[1]])?Ms[v[1]]:"application/octet-stream"}function Vh(m){for(var b=ws(m),_=[],v=0;v<b.length;v+=76)_.push(b.slice(v,v+76));return _.join(`\r
`)+`\r
`}function $h(m){var b=m.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(N){var V=N.charCodeAt(0).toString(16).toUpperCase();return"="+(V.length==1?"0"+V:V)});b=b.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),b.charAt(0)==`
`&&(b="=0D"+b.slice(1)),b=b.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var _=[],v=b.split(`\r
`),C=0;C<v.length;++C){var T=v[C];if(T.length==0){_.push("");continue}for(var R=0;R<T.length;){var W=76,B=T.slice(R,R+W);B.charAt(W-1)=="="?W--:B.charAt(W-2)=="="?W-=2:B.charAt(W-3)=="="&&(W-=3),B=T.slice(R,R+W),R+=W,R<T.length&&(B+="="),_.push(B)}}return _.join(`\r
`)}function Hh(m){for(var b=[],_=0;_<m.length;++_){for(var v=m[_];_<=m.length&&v.charAt(v.length-1)=="=";)v=v.slice(0,v.length-1)+m[++_];b.push(v)}for(var C=0;C<b.length;++C)b[C]=b[C].replace(/[=][0-9A-Fa-f]{2}/g,function(T){return String.fromCharCode(parseInt(T.slice(1),16))});return Gr(b.join(`\r
`))}function Wh(m,b,_){for(var v="",C="",T="",R,W=0;W<10;++W){var B=b[W];if(!B||B.match(/^\s*$/))break;var N=B.match(/^(.*?):\s*([^\s].*)$/);if(N)switch(N[1].toLowerCase()){case"content-location":v=N[2].trim();break;case"content-type":T=N[2].trim();break;case"content-transfer-encoding":C=N[2].trim();break}}switch(++W,C.toLowerCase()){case"base64":R=Gr(mi(b.slice(W).join("")));break;case"quoted-printable":R=Hh(b.slice(W));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+C)}var V=Xa(m,v.slice(_.length),R,{unsafe:!0});T&&(V.ctype=T)}function zh(m,b){if(ar(m.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var _=b&&b.root||"",v=(Xe&&Buffer.isBuffer(m)?m.toString("binary"):ar(m)).split(`\r
`),C=0,T="";for(C=0;C<v.length;++C)if(T=v[C],!!/^Content-Location:/i.test(T)&&(T=T.slice(T.indexOf("file")),_||(_=T.slice(0,T.lastIndexOf("/")+1)),T.slice(0,_.length)!=_))for(;_.length>0&&(_=_.slice(0,_.length-1),_=_.slice(0,_.lastIndexOf("/")+1),T.slice(0,_.length)!=_););var R=(v[1]||"").match(/boundary="(.*?)"/);if(!R)throw new Error("MAD cannot find boundary");var W="--"+(R[1]||""),B=[],N=[],V={FileIndex:B,FullPaths:N};M(V);var ie,ae=0;for(C=0;C<v.length;++C){var _e=v[C];_e!==W&&_e!==W+"--"||(ae++&&Wh(V,v.slice(ie,C),_),ie=C)}return V}function Uh(m,b){var _=b||{},v=_.boundary||"SheetJS";v="------="+v;for(var C=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+v.slice(2)+'"',"","",""],T=m.FullPaths[0],R=T,W=m.FileIndex[0],B=1;B<m.FullPaths.length;++B)if(R=m.FullPaths[B].slice(T.length),W=m.FileIndex[B],!(!W.size||!W.content||R=="Sh33tJ5")){R=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Fe){return"_x"+Fe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Fe){return"_u"+Fe.charCodeAt(0).toString(16)+"_"});for(var N=W.content,V=Xe&&Buffer.isBuffer(N)?N.toString("binary"):ar(N),ie=0,ae=Math.min(1024,V.length),_e=0,oe=0;oe<=ae;++oe)(_e=V.charCodeAt(oe))>=32&&_e<128&&++ie;var ue=ie>=ae*4/5;C.push(v),C.push("Content-Location: "+(_.root||"file:///C:/SheetJS/")+R),C.push("Content-Transfer-Encoding: "+(ue?"quoted-printable":"base64")),C.push("Content-Type: "+Bh(W,R)),C.push(""),C.push(ue?$h(V):Vh(V))}return C.push(v+`--\r
`),C.join(`\r
`)}function Gh(m){var b={};return M(b,m),b}function Xa(m,b,_,v){var C=v&&v.unsafe;C||M(m);var T=!C&&Je.find(m,b);if(!T){var R=m.FullPaths[0];b.slice(0,R.length)==R?R=b:(R.slice(-1)!="/"&&(R+="/"),R=(R+b).replace("//","/")),T={name:n(b),type:2},m.FileIndex.push(T),m.FullPaths.push(R),C||Je.utils.cfb_gc(m)}return T.content=_,T.size=_?_.length:0,v&&(v.CLSID&&(T.clsid=v.CLSID),v.mt&&(T.mt=v.mt),v.ct&&(T.ct=v.ct)),T}function Xh(m,b){M(m);var _=Je.find(m,b);if(_){for(var v=0;v<m.FileIndex.length;++v)if(m.FileIndex[v]==_)return m.FileIndex.splice(v,1),m.FullPaths.splice(v,1),!0}return!1}function jh(m,b,_){M(m);var v=Je.find(m,b);if(v){for(var C=0;C<m.FileIndex.length;++C)if(m.FileIndex[C]==v)return m.FileIndex[C].name=n(_),m.FullPaths[C]=_,!0}return!1}function Kh(m){U(m,!0)}return t.find=ee,t.read=me,t.parse=u,t.write=Rt,t.writeFile=hr,t.utils={cfb_new:Gh,cfb_add:Xa,cfb_del:Xh,cfb_mov:jh,cfb_gc:Kh,ReadShift:ms,CheckField:xu,prep_blob:kr,bconcat:jt,use_zlib:E,_deflateRaw:wl,_inflateRaw:Il,consts:kt},t}(),da;function Gm(r){return typeof r=="string"?Da(r):Array.isArray(r)?xm(r):r}function Is(r,t,e){if(typeof da<"u"&&da.writeFileSync)return e?da.writeFileSync(r,t,e):da.writeFileSync(r,t);if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=Da(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(r,t)}var i=e=="utf8"?hi(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,r);if(typeof Blob<"u"){var n=new Blob([Gm(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,r);if(typeof saveAs<"u")return saveAs(n,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=r,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(r);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Es(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+r)}function qt(r){for(var t=Object.keys(r),e=[],i=0;i<t.length;++i)Object.prototype.hasOwnProperty.call(r,t[i])&&e.push(t[i]);return e}function p0(r,t){for(var e=[],i=qt(r),n=0;n!==i.length;++n)e[r[i[n]][t]]==null&&(e[r[i[n]][t]]=i[n]);return e}function jo(r){for(var t=[],e=qt(r),i=0;i!==e.length;++i)t[r[e[i]]]=e[i];return t}function La(r){for(var t=[],e=qt(r),i=0;i!==e.length;++i)t[r[e[i]]]=parseInt(e[i],10);return t}function Xm(r){for(var t=[],e=qt(r),i=0;i!==e.length;++i)t[r[e[i]]]==null&&(t[r[e[i]]]=[]),t[r[e[i]]].push(e[i]);return t}var ba=new Date(1899,11,30,0,0,0);function xr(r,t){var e=r.getTime();t&&(e-=1462*24*60*60*1e3);var i=ba.getTime()+(r.getTimezoneOffset()-ba.getTimezoneOffset())*6e4;return(e-i)/(24*60*60*1e3)}var su=new Date,jm=ba.getTime()+(su.getTimezoneOffset()-ba.getTimezoneOffset())*6e4,m0=su.getTimezoneOffset();function au(r){var t=new Date;return t.setTime(r*24*60*60*1e3+jm),t.getTimezoneOffset()!==m0&&t.setTime(t.getTime()+(t.getTimezoneOffset()-m0)*6e4),t}var g0=new Date("2017-02-19T19:06:09.000Z"),ou=isNaN(g0.getFullYear())?new Date("2/19/17"):g0,Km=ou.getFullYear()==2017;function ur(r,t){var e=new Date(r);if(Km)return t>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):t<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(r instanceof Date)return r;if(ou.getFullYear()==1917&&!isNaN(e.getFullYear())){var i=e.getFullYear();return r.indexOf(""+i)>-1||e.setFullYear(e.getFullYear()+100),e}var n=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ra(r,t){if(Xe&&Buffer.isBuffer(r)){if(t){if(r[0]==255&&r[1]==254)return hi(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return hi(gm(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(r[0]==255&&r[1]==254)return hi(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return hi(new TextDecoder("utf-16be").decode(r.slice(2)))}var e={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(s){return e[s]||s})}catch{}for(var i=[],n=0;n!=r.length;++n)i.push(String.fromCharCode(r[n]));return i.join("")}function _r(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var t={};for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=_r(r[e]));return t}function ht(r,t){for(var e="";e.length<t;)e+=r;return e}function di(r){var t=Number(r);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(r))return t;var e=1,i=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(i))||(i=i.replace(/[(](.*)[)]/,function(n,s){return e=-e,s}),!isNaN(t=Number(i)))?t/e:t}var Ym=["january","february","march","april","may","june","july","august","september","october","november","december"];function bs(r){var t=new Date(r),e=new Date(NaN),i=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return e;var a=r.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&Ym.indexOf(a)==-1)return e}else if(a.match(/[a-z]/))return e;return i<0||i>8099?e:(n>0||s>1)&&i!=101?t:r.match(/[^-0-9:,\/\\]/)?e:t}function De(r,t,e){if(r.FullPaths){if(typeof e=="string"){var i;return Xe?i=xi(e):i=_m(e),Je.utils.cfb_add(r,t,i)}Je.utils.cfb_add(r,t,e)}else r.file(t,e)}function Ko(){return Je.utils.cfb_new()}var vt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var qm={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Yo=jo(qm);var qo=/[&<>'"]/g,Qm=/[\u0000-\u0008\u000b-\u001f]/g;function qe(r){var t=r+"";return t.replace(qo,function(e){return Yo[e]}).replace(Qm,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function x0(r){return qe(r).replace(/ /g,"_x0020_")}var lu=/[\u0000-\u001f]/g;function Zm(r){var t=r+"";return t.replace(qo,function(e){return Yo[e]}).replace(/\n/g,"<br/>").replace(lu,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function Jm(r){var t=r+"";return t.replace(qo,function(e){return Yo[e]}).replace(lu,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function eg(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function tg(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Po(r){for(var t="",e=0,i=0,n=0,s=0,a=0,o=0;e<r.length;){if(i=r.charCodeAt(e++),i<128){t+=String.fromCharCode(i);continue}if(n=r.charCodeAt(e++),i>191&&i<224){a=(i&31)<<6,a|=n&63,t+=String.fromCharCode(a);continue}if(s=r.charCodeAt(e++),i<240){t+=String.fromCharCode((i&15)<<12|(n&63)<<6|s&63);continue}a=r.charCodeAt(e++),o=((i&7)<<18|(n&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function _0(r){var t=Gi(2*r.length),e,i,n=1,s=0,a=0,o;for(i=0;i<r.length;i+=n)n=1,(o=r.charCodeAt(i))<128?e=o:o<224?(e=(o&31)*64+(r.charCodeAt(i+1)&63),n=2):o<240?(e=(o&15)*4096+(r.charCodeAt(i+1)&63)*64+(r.charCodeAt(i+2)&63),n=3):(n=4,e=(o&7)*262144+(r.charCodeAt(i+1)&63)*4096+(r.charCodeAt(i+2)&63)*64+(r.charCodeAt(i+3)&63),e-=65536,a=55296+(e>>>10&1023),e=56320+(e&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=e%256,t[s++]=e>>>8;return t.slice(0,s).toString("ucs2")}function v0(r){return xi(r,"binary").toString("utf8")}var pa="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",ps=Xe&&(v0(pa)==Po(pa)&&v0||_0(pa)==Po(pa)&&_0)||Po,hi=Xe?function(r){return xi(r,"utf8").toString("binary")}:function(r){for(var t=[],e=0,i=0,n=0;e<r.length;)switch(i=r.charCodeAt(e++),!0){case i<128:t.push(String.fromCharCode(i));break;case i<2048:t.push(String.fromCharCode(192+(i>>6))),t.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,n=r.charCodeAt(e++)-56320+(i<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(i>>12))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)))}return t.join("")};var rg=function(){var r=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var i=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<r.length;++n)i=i.replace(r[n][0],r[n][1]);return i}}();var cu=/(^\s|\s$|\n)/;function Kt(r,t){return"<"+r+(t.match(cu)?' xml:space="preserve"':"")+">"+t+"</"+r+">"}function Cs(r){return qt(r).map(function(t){return" "+t+'="'+r[t]+'"'}).join("")}function ne(r,t,e){return"<"+r+(e!=null?Cs(e):"")+(t!=null?(t.match(cu)?' xml:space="preserve"':"")+">"+t+"</"+r:"/")+">"}function Wo(r,t){try{return r.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function ig(r,t){switch(typeof r){case"string":var e=ne("vt:lpwstr",qe(r));return t&&(e=e.replace(/&quot;/g,"_x0022_")),e;case"number":return ne((r|0)==r?"vt:i4":"vt:r8",qe(String(r)));case"boolean":return ne("vt:bool",r?"true":"false")}if(r instanceof Date)return ne("vt:filetime",Wo(r));throw new Error("Unable to serialize "+r)}var Mt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ln=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Fr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function ng(r,t){for(var e=1-2*(r[t+7]>>>7),i=((r[t+7]&127)<<4)+(r[t+6]>>>4&15),n=r[t+6]&15,s=5;s>=0;--s)n=n*256+r[t+s];return i==2047?n==0?e*(1/0):NaN:(i==0?i=-1022:(i-=1023,n+=Math.pow(2,52)),e*Math.pow(2,i-52)*n)}function sg(r,t,e){var i=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,a=i?-t:t;isFinite(a)?a==0?n=s=0:(n=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)r[e+o]=s&255;r[e+6]=(n&15)<<4|s&15,r[e+7]=n>>4|i}var y0=function(r){for(var t=[],e=10240,i=0;i<r[0].length;++i)if(r[0][i])for(var n=0,s=r[0][i].length;n<s;n+=e)t.push.apply(t,r[0][i].slice(n,n+e));return t},w0=Xe?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(t){return Buffer.isBuffer(t)?t:xi(t)})):y0(r)}:y0,b0=function(r,t,e){for(var i=[],n=t;n<e;n+=2)i.push(String.fromCharCode(ds(r,n)));return i.join("").replace(kn,"")},Na=Xe?function(r,t,e){return Buffer.isBuffer(r)?r.toString("utf16le",t,e).replace(kn,""):b0(r,t,e)}:b0,C0=function(r,t,e){for(var i=[],n=t;n<t+e;++n)i.push(("0"+r[n].toString(16)).slice(-2));return i.join("")},uu=Xe?function(r,t,e){return Buffer.isBuffer(r)?r.toString("hex",t,t+e):C0(r,t,e)}:C0,T0=function(r,t,e){for(var i=[],n=t;n<e;n++)i.push(String.fromCharCode(En(r,n)));return i.join("")},Rn=Xe?function(t,e,i){return Buffer.isBuffer(t)?t.toString("utf8",e,i):T0(t,e,i)}:T0,hu=function(r,t){var e=Dt(r,t);return e>0?Rn(r,t+4,t+4+e-1):""},Qo=hu,fu=function(r,t){var e=Dt(r,t);return e>0?Rn(r,t+4,t+4+e-1):""},Zo=fu,du=function(r,t){var e=2*Dt(r,t);return e>0?Rn(r,t+4,t+4+e-1):""},Jo=du,pu=function(t,e){var i=Dt(t,e);return i>0?Na(t,e+4,e+4+i):""},el=pu,mu=function(r,t){var e=Dt(r,t);return e>0?Rn(r,t+4,t+4+e):""},tl=mu,gu=function(r,t){return ng(r,t)},Ca=gu,rl=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Xe&&(Qo=function(t,e){if(!Buffer.isBuffer(t))return hu(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},Zo=function(t,e){if(!Buffer.isBuffer(t))return fu(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},Jo=function(t,e){if(!Buffer.isBuffer(t))return du(t,e);var i=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i-1)},el=function(t,e){if(!Buffer.isBuffer(t))return pu(t,e);var i=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i)},tl=function(t,e){if(!Buffer.isBuffer(t))return mu(t,e);var i=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+i)},Ca=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):gu(t,e)},rl=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function ag(){Na=function(r,t,e){return rt.utils.decode(1200,r.slice(t,e)).replace(kn,"")},Rn=function(r,t,e){return rt.utils.decode(65001,r.slice(t,e))},Qo=function(r,t){var e=Dt(r,t);return e>0?rt.utils.decode(Mn,r.slice(t+4,t+4+e-1)):""},Zo=function(r,t){var e=Dt(r,t);return e>0?rt.utils.decode(zi,r.slice(t+4,t+4+e-1)):""},Jo=function(r,t){var e=2*Dt(r,t);return e>0?rt.utils.decode(1200,r.slice(t+4,t+4+e-1)):""},el=function(r,t){var e=Dt(r,t);return e>0?rt.utils.decode(1200,r.slice(t+4,t+4+e)):""},tl=function(r,t){var e=Dt(r,t);return e>0?rt.utils.decode(65001,r.slice(t+4,t+4+e)):""}}typeof rt<"u"&&ag();var En=function(r,t){return r[t]},ds=function(r,t){return r[t+1]*256+r[t]},og=function(r,t){var e=r[t+1]*256+r[t];return e<32768?e:(65535-e+1)*-1},Dt=function(r,t){return r[t+3]*(1<<24)+(r[t+2]<<16)+(r[t+1]<<8)+r[t]},Wi=function(r,t){return r[t+3]<<24|r[t+2]<<16|r[t+1]<<8|r[t]},lg=function(r,t){return r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3]};function ms(r,t){var e="",i,n,s=[],a,o,c,l;switch(t){case"dbcs":if(l=this.l,Xe&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*r).toString("utf16le");else for(c=0;c<r;++c)e+=String.fromCharCode(ds(this,l)),l+=2;r*=2;break;case"utf8":e=Rn(this,this.l,this.l+r);break;case"utf16le":r*=2,e=Na(this,this.l,this.l+r);break;case"wstr":if(typeof rt<"u")e=rt.utils.decode(zi,this.slice(this.l,this.l+2*r));else return ms.call(this,r,"dbcs");r=2*r;break;case"lpstr-ansi":e=Qo(this,this.l),r=4+Dt(this,this.l);break;case"lpstr-cp":e=Zo(this,this.l),r=4+Dt(this,this.l);break;case"lpwstr":e=Jo(this,this.l),r=4+2*Dt(this,this.l);break;case"lpp4":r=4+Dt(this,this.l),e=el(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+Dt(this,this.l),e=tl(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,e="";(a=En(this,this.l+r++))!==0;)s.push(ua(a));e=s.join("");break;case"_wstr":for(r=0,e="";(a=ds(this,this.l+r))!==0;)s.push(ua(a)),r+=2;r+=2,e=s.join("");break;case"dbcs-cont":for(e="",l=this.l,c=0;c<r;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=En(this,l),this.l=l+1,o=ms.call(this,r-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(ua(ds(this,l))),l+=2}e=s.join(""),r*=2;break;case"cpstr":if(typeof rt<"u"){e=rt.utils.decode(zi,this.slice(this.l,this.l+r));break}case"sbcs-cont":for(e="",l=this.l,c=0;c!=r;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=En(this,l),this.l=l+1,o=ms.call(this,r-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(ua(En(this,l))),l+=1}e=s.join("");break;default:switch(r){case 1:return i=En(this,this.l),this.l++,i;case 2:return i=(t==="i"?og:ds)(this,this.l),this.l+=2,i;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(i=(r>0?Wi:lg)(this,this.l),this.l+=4,i):(n=Dt(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return r==8?n=Ca(this,this.l):n=Ca([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;r=8;case 16:e=uu(this,this.l,r);break}}return this.l+=r,e}var cg=function(r,t,e){r[e]=t&255,r[e+1]=t>>>8&255,r[e+2]=t>>>16&255,r[e+3]=t>>>24&255},ug=function(r,t,e){r[e]=t&255,r[e+1]=t>>8&255,r[e+2]=t>>16&255,r[e+3]=t>>24&255},hg=function(r,t,e){r[e]=t&255,r[e+1]=t>>>8&255};function fg(r,t,e){var i=0,n=0;if(e==="dbcs"){for(n=0;n!=t.length;++n)hg(this,t.charCodeAt(n),this.l+2*n);i=2*t.length}else if(e==="sbcs"){if(typeof rt<"u"&&Mn==874)for(n=0;n!=t.length;++n){var s=rt.utils.encode(Mn,t.charAt(n));this[this.l+n]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;i=t.length}else if(e==="hex"){for(;n<r;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(e==="utf16le"){var a=Math.min(this.l+r,this.length);for(n=0;n<Math.min(t.length,r);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(r){case 1:i=1,this[this.l]=t&255;break;case 2:i=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:i=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:i=4,cg(this,t,this.l);break;case 8:if(i=8,e==="f"){sg(this,t,this.l);break}case 16:break;case-4:i=4,ug(this,t,this.l);break}return this.l+=i,this}function xu(r,t){var e=uu(this,this.l,r.length>>1);if(e!==r)throw new Error(t+"Expected "+r+" saw "+e);this.l+=r.length>>1}function kr(r,t){r.l=t,r.read_shift=ms,r.chk=xu,r.write_shift=fg}function ii(r,t){r.l+=t}function H(r){var t=Gi(r);return kr(t,0),t}function gr(){var r=[],t=Xe?256:2048,e=function(l){var u=H(l);return kr(u,0),u},i=e(t),n=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&r.push(i),i=null)},s=function(l){return i&&l<i.length-i.l?i:(n(),i=e(Math.max(l+1,t)))},a=function(){return n(),jt(r)},o=function(l){n(),i=l,i.l==null&&(i.l=i.length),s(t)};return{next:s,push:o,end:a,_bufs:r}}function Z(r,t,e,i){var n=+t,s;if(!isNaN(n)){i||(i=sw[n].p||(e||[]).length||0),s=1+(n>=128?1:0)+1,i>=128&&++s,i>=16384&&++s,i>=2097152&&++s;var a=r.next(s);n<=127?a.write_shift(1,n):(a.write_shift(1,(n&127)+128),a.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(i>=128)a.write_shift(1,(i&127)+128),i>>=7;else{a.write_shift(1,i);break}i>0&&rl(e)&&r.push(e)}}function gs(r,t,e){var i=_r(r);if(t.s?(i.cRel&&(i.c+=t.s.c),i.rRel&&(i.r+=t.s.r)):(i.cRel&&(i.c+=t.c),i.rRel&&(i.r+=t.r)),!e||e.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function S0(r,t,e){var i=_r(r);return i.s=gs(i.s,t.s,e),i.e=gs(i.e,t.s,e),i}function xs(r,t){if(r.cRel&&r.c<0)for(r=_r(r);r.c<0;)r.c+=t>8?16384:256;if(r.rRel&&r.r<0)for(r=_r(r);r.r<0;)r.r+=t>8?1048576:t>5?65536:16384;var e=Qe(r);return!r.cRel&&r.cRel!=null&&(e=mg(e)),!r.rRel&&r.rRel!=null&&(e=dg(e)),e}function Lo(r,t){return r.s.r==0&&!r.s.rRel&&r.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+nr(r.s.c)+":"+(r.e.cRel?"":"$")+nr(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(t.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Yt(r.s.r)+":"+(r.e.rRel?"":"$")+Yt(r.e.r):xs(r.s,t.biff)+":"+xs(r.e,t.biff)}function il(r){return parseInt(pg(r),10)-1}function Yt(r){return""+(r+1)}function dg(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function pg(r){return r.replace(/\$(\d+)$/,"$1")}function nl(r){for(var t=gg(r),e=0,i=0;i!==t.length;++i)e=26*e+t.charCodeAt(i)-64;return e-1}function nr(r){if(r<0)throw new Error("invalid column "+r);var t="";for(++r;r;r=Math.floor((r-1)/26))t=String.fromCharCode((r-1)%26+65)+t;return t}function mg(r){return r.replace(/^([A-Z])/,"$$$1")}function gg(r){return r.replace(/^\$([A-Z])/,"$1")}function xg(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Pt(r){for(var t=0,e=0,i=0;i<r.length;++i){var n=r.charCodeAt(i);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(e=26*e+(n-64))}return{c:e-1,r:t-1}}function Qe(r){for(var t=r.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(r.r+1)}function Or(r){var t=r.indexOf(":");return t==-1?{s:Pt(r),e:Pt(r)}:{s:Pt(r.slice(0,t)),e:Pt(r.slice(t+1))}}function _t(r,t){return typeof t>"u"||typeof t=="number"?_t(r.s,r.e):(typeof r!="string"&&(r=Qe(r)),typeof t!="string"&&(t=Qe(t)),r==t?r:r+":"+t)}function st(r){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,i=0,n=0,s=r.length;for(e=0;i<s&&!((n=r.charCodeAt(i)-64)<1||n>26);++i)e=26*e+n;for(t.s.c=--e,e=0;i<s&&!((n=r.charCodeAt(i)-48)<0||n>9);++i)e=10*e+n;if(t.s.r=--e,i===s||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++i,e=0;i!=s&&!((n=r.charCodeAt(i)-64)<1||n>26);++i)e=26*e+n;for(t.e.c=--e,e=0;i!=s&&!((n=r.charCodeAt(i)-48)<0||n>9);++i)e=10*e+n;return t.e.r=--e,t}function E0(r,t){var e=r.t=="d"&&t instanceof Date;if(r.z!=null)try{return r.w=ki(r.z,e?xr(t):t)}catch{}try{return r.w=ki((r.XF||{}).numFmtId||(e?14:0),e?xr(t):t)}catch{return""+t}}function gi(r,t,e){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&e&&e.dateNF&&(r.z=e.dateNF),r.t=="e"?ks[r.v]||r.v:t==null?E0(r,r.v):E0(r,t))}function Ki(r,t){var e=t&&t.sheet?t.sheet:"Sheet1",i={};return i[e]=r,{SheetNames:[e],Sheets:i}}function _u(r,t,e){var i=e||{},n=r?Array.isArray(r):i.dense;ri!=null&&n==null&&(n=ri);var s=r||(n?[]:{}),a=0,o=0;if(s&&i.origin!=null){if(typeof i.origin=="number")a=i.origin;else{var c=typeof i.origin=="string"?Pt(i.origin):i.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=st(s["!ref"]);l.s.c=u.s.c,l.s.r=u.s.r,l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),a==-1&&(l.e.r=a=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[h].length;++f)if(!(typeof t[h][f]>"u")){var d={v:t[h][f]},g=a+h,p=o+f;if(l.s.r>g&&(l.s.r=g),l.s.c>p&&(l.s.c=p),l.e.r<g&&(l.e.r=g),l.e.c<p&&(l.e.c=p),t[h][f]&&typeof t[h][f]=="object"&&!Array.isArray(t[h][f])&&!(t[h][f]instanceof Date))d=t[h][f];else if(Array.isArray(d.v)&&(d.f=t[h][f][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(i.nullError)d.t="e",d.v=0;else if(i.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=i.dateNF||ft[14],i.cellDates?(d.t="d",d.w=ki(d.z,xr(d.v))):(d.t="n",d.v=xr(d.v),d.w=ki(d.z,d.v))):d.t="s";if(n)s[g]||(s[g]=[]),s[g][p]&&s[g][p].z&&(d.z=s[g][p].z),s[g][p]=d;else{var x=Qe({c:p,r:g});s[x]&&s[x].z&&(d.z=s[x].z),s[x]=d}}}return l.s.c<1e7&&(s["!ref"]=_t(l)),s}function Nn(r,t){return _u(null,r,t)}function _g(r){return r.read_shift(4,"i")}function jr(r,t){return t||(t=H(4)),t.write_shift(4,r),t}function sr(r){var t=r.read_shift(4);return t===0?"":r.read_shift(t,"dbcs")}function Lt(r,t){var e=!1;return t==null&&(e=!0,t=H(4+2*r.length)),t.write_shift(4,r.length),r.length>0&&t.write_shift(0,r,"dbcs"),e?t.slice(0,t.l):t}function vg(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function yg(r,t){return t||(t=H(4)),t.write_shift(2,r.ich||0),t.write_shift(2,r.ifnt||0),t}function sl(r,t){var e=r.l,i=r.read_shift(1),n=sr(r),s=[],a={t:n,h:n};if((i&1)!==0){for(var o=r.read_shift(4),c=0;c!=o;++c)s.push(vg(r));a.r=s}else a.r=[{ich:0,ifnt:0}];return r.l=e+t,a}function wg(r,t){var e=!1;return t==null&&(e=!0,t=H(15+4*r.t.length)),t.write_shift(1,0),Lt(r.t,t),e?t.slice(0,t.l):t}var bg=sl;function Cg(r,t){var e=!1;return t==null&&(e=!0,t=H(23+4*r.t.length)),t.write_shift(1,1),Lt(r.t,t),t.write_shift(4,1),yg({ich:0,ifnt:0},t),e?t.slice(0,t.l):t}function Nr(r){var t=r.read_shift(4),e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:t,iStyleRef:e}}function Yi(r,t){return t==null&&(t=H(8)),t.write_shift(-4,r.c),t.write_shift(3,r.iStyleRef||r.s),t.write_shift(1,0),t}function qi(r){var t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:t}}function Qi(r,t){return t==null&&(t=H(4)),t.write_shift(3,r.iStyleRef||r.s),t.write_shift(1,0),t}var Tg=sr,vu=Lt;function al(r){var t=r.read_shift(4);return t===0||t===4294967295?"":r.read_shift(t,"dbcs")}function Ta(r,t){var e=!1;return t==null&&(e=!0,t=H(127)),t.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&t.write_shift(0,r,"dbcs"),e?t.slice(0,t.l):t}var Sg=sr,zo=al,ol=Ta;function yu(r){var t=r.slice(r.l,r.l+4),e=t[0]&1,i=t[0]&2;r.l+=4;var n=i===0?Ca([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Wi(t,0)>>2;return e?n/100:n}function wu(r,t){t==null&&(t=H(4));var e=0,i=0,n=r*100;if(r==(r|0)&&r>=-(1<<29)&&r<1<<29?i=1:n==(n|0)&&n>=-(1<<29)&&n<1<<29&&(i=1,e=1),i)t.write_shift(-4,((e?n:r)<<2)+(e+2));else throw new Error("unsupported RkNumber "+r)}function bu(r){var t={s:{},e:{}};return t.s.r=r.read_shift(4),t.e.r=r.read_shift(4),t.s.c=r.read_shift(4),t.e.c=r.read_shift(4),t}function Eg(r,t){return t||(t=H(16)),t.write_shift(4,r.s.r),t.write_shift(4,r.e.r),t.write_shift(4,r.s.c),t.write_shift(4,r.e.c),t}var Zi=bu,Bn=Eg;function Vn(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function Xi(r,t){return(t||H(8)).write_shift(8,r,"f")}function Ig(r){var t={},e=r.read_shift(1),i=e>>>1,n=r.read_shift(1),s=r.read_shift(2,"i"),a=r.read_shift(1),o=r.read_shift(1),c=r.read_shift(1);switch(r.l++,i){case 0:t.auto=1;break;case 1:t.index=n;var l=Rg[n];l&&(t.rgb=N0(l));break;case 2:t.rgb=N0([a,o,c]);break;case 3:t.theme=n;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Sa(r,t){if(t||(t=H(8)),!r||r.auto)return t.write_shift(4,0),t.write_shift(4,0),t;r.index!=null?(t.write_shift(1,2),t.write_shift(1,r.index)):r.theme!=null?(t.write_shift(1,6),t.write_shift(1,r.theme)):(t.write_shift(1,5),t.write_shift(1,0));var e=r.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),t.write_shift(2,e),!r.rgb||r.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var i=r.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),t.write_shift(1,parseInt(i.slice(0,2),16)),t.write_shift(1,parseInt(i.slice(2,4),16)),t.write_shift(1,parseInt(i.slice(4,6),16)),t.write_shift(1,255)}return t}function kg(r){var t=r.read_shift(1);r.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function Fg(r,t){t||(t=H(2));var e=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return t.write_shift(1,e),t.write_shift(1,0),t}var Cu=2,Ir=3,ma=11;var Ea=19;var ga=64,Og=65,Ag=71;var Dg=4108,Mg=4126,Xt=80;var I0={1:{n:"CodePage",t:Cu},2:{n:"Category",t:Xt},3:{n:"PresentationFormat",t:Xt},4:{n:"ByteCount",t:Ir},5:{n:"LineCount",t:Ir},6:{n:"ParagraphCount",t:Ir},7:{n:"SlideCount",t:Ir},8:{n:"NoteCount",t:Ir},9:{n:"HiddenCount",t:Ir},10:{n:"MultimediaClipCount",t:Ir},11:{n:"ScaleCrop",t:ma},12:{n:"HeadingPairs",t:Dg},13:{n:"TitlesOfParts",t:Mg},14:{n:"Manager",t:Xt},15:{n:"Company",t:Xt},16:{n:"LinksUpToDate",t:ma},17:{n:"CharacterCount",t:Ir},19:{n:"SharedDoc",t:ma},22:{n:"HyperlinksChanged",t:ma},23:{n:"AppVersion",t:Ir,p:"version"},24:{n:"DigSig",t:Og},26:{n:"ContentType",t:Xt},27:{n:"ContentStatus",t:Xt},28:{n:"Language",t:Xt},29:{n:"Version",t:Xt},255:{},2147483648:{n:"Locale",t:Ea},2147483651:{n:"Behavior",t:Ea},1919054434:{}},k0={1:{n:"CodePage",t:Cu},2:{n:"Title",t:Xt},3:{n:"Subject",t:Xt},4:{n:"Author",t:Xt},5:{n:"Keywords",t:Xt},6:{n:"Comments",t:Xt},7:{n:"Template",t:Xt},8:{n:"LastAuthor",t:Xt},9:{n:"RevNumber",t:Xt},10:{n:"EditTime",t:ga},11:{n:"LastPrinted",t:ga},12:{n:"CreatedDate",t:ga},13:{n:"ModifiedDate",t:ga},14:{n:"PageCount",t:Ir},15:{n:"WordCount",t:Ir},16:{n:"CharCount",t:Ir},17:{n:"Thumbnail",t:Ag},18:{n:"Application",t:Xt},19:{n:"DocSecurity",t:Ir},255:{},2147483648:{n:"Locale",t:Ea},2147483651:{n:"Behavior",t:Ea},1919054434:{}};function Pg(r){return r.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Lg=Pg([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Rg=_r(Lg),ks={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var Ng={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},xa={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Tu(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Su(r,t){var e=Xm(Ng),i=[],n;i[i.length]=vt,i[i.length]=ne("Types",null,{xmlns:Mt.CT,"xmlns:xsd":Mt.xsd,"xmlns:xsi":Mt.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ne("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){r[c]&&r[c].length>0&&(n=r[c][0],i[i.length]=ne("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:xa[c][t.bookType]||xa[c].xlsx}))},a=function(c){(r[c]||[]).forEach(function(l){i[i.length]=ne("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:xa[c][t.bookType]||xa[c].xlsx})})},o=function(c){(r[c]||[]).forEach(function(l){i[i.length]=ne("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:e[c][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var Ge={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Eu(r){var t=r.lastIndexOf("/");return r.slice(0,t+1)+"_rels/"+r.slice(t+1)+".rels"}function On(r){var t=[vt,ne("Relationships",null,{xmlns:Mt.RELS})];return qt(r["!id"]).forEach(function(e){t[t.length]=ne("Relationship",null,r["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ye(r,t,e,i,n,s){if(n||(n={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),t<0)for(t=r["!idx"];r["!id"]["rId"+t];++t);if(r["!idx"]=t+1,n.Id="rId"+t,n.Type=i,n.Target=e,s?n.TargetMode=s:[Ge.HLINK,Ge.XPATH,Ge.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),r["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return r["!id"][n.Id]=n,r[("/"+n.Target).replace("//","/")]=n,t}function Bg(r){var t=[vt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<r.length;++e)t.push('  <manifest:file-entry manifest:full-path="'+r[e][0]+'" manifest:media-type="'+r[e][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function F0(r,t,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Vg(r,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function $g(r){var t=[vt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=r.length;++e)t.push(F0(r[e][0],r[e][1])),t.push(Vg("",r[e][0]));return t.push(F0("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Iu(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+vs.version+"</meta:generator></office:meta></office:document-meta>"}var Ui=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Ro(r,t,e,i,n){n[r]!=null||t==null||t===""||(n[r]=t,t=qe(t),i[i.length]=e?ne(r,t,e):Kt(r,t))}function ku(r,t){var e=t||{},i=[vt,ne("cp:coreProperties",null,{"xmlns:cp":Mt.CORE_PROPS,"xmlns:dc":Mt.dc,"xmlns:dcterms":Mt.dcterms,"xmlns:dcmitype":Mt.dcmitype,"xmlns:xsi":Mt.xsi})],n={};if(!r&&!e.Props)return i.join("");r&&(r.CreatedDate!=null&&Ro("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:Wo(r.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,n),r.ModifiedDate!=null&&Ro("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:Wo(r.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,n));for(var s=0;s!=Ui.length;++s){var a=Ui[s],o=e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:r?r[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Ro(a[0],o,null,i,n)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var An=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Fu=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ou(r){var t=[],e=ne;return r||(r={}),r.Application="SheetJS",t[t.length]=vt,t[t.length]=ne("Properties",null,{xmlns:Mt.EXT_PROPS,"xmlns:vt":Mt.vt}),An.forEach(function(i){if(r[i[1]]!==void 0){var n;switch(i[2]){case"string":n=qe(String(r[i[1]]));break;case"bool":n=r[i[1]]?"true":"false";break}n!==void 0&&(t[t.length]=e(i[0],n))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",r.SheetNames.map(function(i){return"<vt:lpstr>"+qe(i)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Au(r){var t=[vt,ne("Properties",null,{xmlns:Mt.CUST_PROPS,"xmlns:vt":Mt.vt})];if(!r)return t.join("");var e=1;return qt(r).forEach(function(n){++e,t[t.length]=ne("property",ig(r[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:qe(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var O0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Hg(r,t){var e=[];return qt(O0).map(function(i){for(var n=0;n<Ui.length;++n)if(Ui[n][1]==i)return Ui[n];for(n=0;n<An.length;++n)if(An[n][1]==i)return An[n];throw i}).forEach(function(i){if(r[i[1]]!=null){var n=t&&t.Props&&t.Props[i[1]]!=null?t.Props[i[1]]:r[i[1]];switch(i[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),e.push(Kt(O0[i[1]]||i[1],n))}}),ne("DocumentProperties",e.join(""),{xmlns:Fr.o})}function Wg(r,t){var e=["Worksheets","SheetNames"],i="CustomDocumentProperties",n=[];return r&&qt(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var a=0;a<Ui.length;++a)if(s==Ui[a][1])return;for(a=0;a<An.length;++a)if(s==An[a][1])return;for(a=0;a<e.length;++a)if(s==e[a])return;var o=r[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),n.push(ne(x0(s),o,{"dt:dt":c}))}}),t&&qt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),n.push(ne(x0(s),a,{"dt:dt":o}))}}),"<"+i+' xmlns="'+Fr.o+'">'+n.join("")+"</"+i+">"}function zg(r){var t=typeof r=="string"?new Date(Date.parse(r)):r,e=t.getTime()/1e3+11644473600,i=e%Math.pow(2,32),n=(e-i)/Math.pow(2,32);i*=1e7,n*=1e7;var s=i/Math.pow(2,32)|0;s>0&&(i=i%Math.pow(2,32),n+=s);var a=H(8);return a.write_shift(4,i),a.write_shift(4,n),a}function A0(r,t){var e=H(4),i=H(4);switch(e.write_shift(4,r==80?31:r),r){case 3:i.write_shift(-4,t);break;case 5:i=H(8),i.write_shift(8,t,"f");break;case 11:i.write_shift(4,t?1:0);break;case 64:i=zg(t);break;case 31:case 80:for(i=H(4+2*(t.length+1)+(t.length%2?0:2)),i.write_shift(4,t.length+1),i.write_shift(0,t,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+t)}return jt([e,i])}var Du=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Ug(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function D0(r,t,e){var i=H(8),n=[],s=[],a=8,o=0,c=H(8),l=H(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),s.push(c),n.push(l),a+=8+c.length,!t){l=H(8),l.write_shift(4,0),n.unshift(l);var u=[H(4)];for(u[0].write_shift(4,r.length),o=0;o<r.length;++o){var h=r[o][0];for(c=H(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=jt(u),s.unshift(c),a+=8+c.length}for(o=0;o<r.length;++o)if(!(t&&!t[r[o][0]])&&!(Du.indexOf(r[o][0])>-1||Fu.indexOf(r[o][0])>-1)&&r[o][1]!=null){var f=r[o][1],d=0;if(t){d=+t[r[o][0]];var g=e[d];if(g.p=="version"&&typeof f=="string"){var p=f.split(".");f=(+p[0]<<16)+(+p[1]||0)}c=A0(g.t,f)}else{var x=Ug(f);x==-1&&(x=31,f=String(f)),c=A0(x,f)}s.push(c),l=H(8),l.write_shift(4,t?d:2+o),n.push(l),a+=8+c.length}var O=8*(s.length+1);for(o=0;o<s.length;++o)n[o].write_shift(4,O),O+=s[o].length;return i.write_shift(4,a),i.write_shift(4,s.length),jt([i].concat(n).concat(s))}function M0(r,t,e,i,n,s){var a=H(n?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Je.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,n?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,n?68:48);var c=D0(r,e,i);if(o.push(c),n){var l=D0(n,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+c.length),o.push(l)}return jt(o)}function Gg(r,t){t||(t=H(r));for(var e=0;e<r;++e)t.write_shift(1,0);return t}function Xg(r,t){return r.read_shift(t)===1}function cr(r,t){return t||(t=H(2)),t.write_shift(2,+!!r),t}function Mu(r){return r.read_shift(2,"u")}function Rr(r,t){return t||(t=H(2)),t.write_shift(2,r),t}function Pu(r,t,e){return e||(e=H(2)),e.write_shift(1,t=="e"?+r:+!!r),e.write_shift(1,t=="e"?1:0),e}function Lu(r,t,e){var i=r.read_shift(e&&e.biff>=12?2:1),n="sbcs-cont",s=zi;if(e&&e.biff>=8&&(zi=1200),!e||e.biff==8){var a=r.read_shift(1);a&&(n="dbcs-cont")}else e.biff==12&&(n="wstr");e.biff>=2&&e.biff<=5&&(n="cpstr");var o=i?r.read_shift(i,n):"";return zi=s,o}function jg(r){var t=r.t||"",e=1,i=H(3+(e>1?2:0));i.write_shift(2,t.length),i.write_shift(1,(e>1?8:0)|1),e>1&&i.write_shift(2,e);var n=H(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[i,n];return jt(s)}function Kg(r,t,e){var i;if(e){if(e.biff>=2&&e.biff<=5)return r.read_shift(t,"cpstr");if(e.biff>=12)return r.read_shift(t,"dbcs-cont")}var n=r.read_shift(1);return n===0?i=r.read_shift(t,"sbcs-cont"):i=r.read_shift(t,"dbcs-cont"),i}function Yg(r,t,e){var i=r.read_shift(e&&e.biff==2?1:2);return i===0?(r.l++,""):Kg(r,i,e)}function qg(r,t,e){if(e.biff>5)return Yg(r,t,e);var i=r.read_shift(1);return i===0?(r.l++,""):r.read_shift(i,e.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function Ru(r,t,e){return e||(e=H(3+2*r.length)),e.write_shift(2,r.length),e.write_shift(1,1),e.write_shift(31,r,"utf16le"),e}function P0(r,t){t||(t=H(6+r.length*2)),t.write_shift(4,1+r.length);for(var e=0;e<r.length;++e)t.write_shift(2,r.charCodeAt(e));return t.write_shift(2,0),t}function Qg(r){var t=H(512),e=0,i=r.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var n=i.indexOf("#"),s=n>-1?31:23;switch(i.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(e=0;e<a.length;++e)t.write_shift(4,a[e]);if(s==28)i=i.slice(1),P0(i,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<a.length;++e)t.write_shift(1,parseInt(a[e],16));var o=n>-1?i.slice(0,n):i;for(t.write_shift(4,2*(o.length+1)),e=0;e<o.length;++e)t.write_shift(2,o.charCodeAt(e));t.write_shift(2,0),s&8&&P0(n>-1?i.slice(n+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<a.length;++e)t.write_shift(1,parseInt(a[e],16));for(var c=0;i.slice(c*3,c*3+3)=="../"||i.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,i.length-3*c+1),e=0;e<i.length-3*c;++e)t.write_shift(1,i.charCodeAt(e+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),e=0;e<6;++e)t.write_shift(4,0)}return t.slice(0,t.l)}function ji(r,t,e,i){return i||(i=H(6)),i.write_shift(2,r),i.write_shift(2,t),i.write_shift(2,e||0),i}function Zg(r,t,e){var i=e.biff>8?4:2,n=r.read_shift(i),s=r.read_shift(i,"i"),a=r.read_shift(i,"i");return[n,s,a]}function Jg(r){var t=r.read_shift(2),e=r.read_shift(2),i=r.read_shift(2),n=r.read_shift(2);return{s:{c:i,r:t},e:{c:n,r:e}}}function Nu(r,t){return t||(t=H(8)),t.write_shift(2,r.s.r),t.write_shift(2,r.e.r),t.write_shift(2,r.s.c),t.write_shift(2,r.e.c),t}function ll(r,t,e){var i=1536,n=16;switch(e.bookType){case"biff8":break;case"biff5":i=1280,n=8;break;case"biff4":i=4,n=6;break;case"biff3":i=3,n=6;break;case"biff2":i=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=H(n);return s.write_shift(2,i),s.write_shift(2,t),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function e1(r,t){var e=!t||t.biff==8,i=H(e?112:54);for(i.write_shift(t.biff==8?2:1,7),e&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(e?0:536870912));i.l<i.length;)i.write_shift(1,e?0:32);return i}function t1(r,t){var e=!t||t.biff>=8?2:1,i=H(8+e*r.name.length);i.write_shift(4,r.pos),i.write_shift(1,r.hs||0),i.write_shift(1,r.dt),i.write_shift(1,r.name.length),t.biff>=8&&i.write_shift(1,1),i.write_shift(e*r.name.length,r.name,t.biff<8?"sbcs":"utf16le");var n=i.slice(0,i.l);return n.l=i.l,n}function r1(r,t){var e=H(8);e.write_shift(4,r.Count),e.write_shift(4,r.Unique);for(var i=[],n=0;n<r.length;++n)i[n]=jg(r[n],t);var s=jt([e].concat(i));return s.parts=[e.length].concat(i.map(function(a){return a.length})),s}function i1(){var r=H(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function n1(r){var t=H(18),e=1718;return r&&r.RTL&&(e|=64),t.write_shift(2,e),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function s1(r,t){var e=r.name||"Arial",i=t&&t.biff==5,n=i?15+e.length:16+2*e.length,s=H(n);return s.write_shift(2,(r.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,e.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le"),s}function a1(r,t,e,i){var n=H(10);return ji(r,t,i,n),n.write_shift(4,e),n}function o1(r,t,e,i,n){var s=!n||n.biff==8,a=H(8+ +s+(1+s)*e.length);return ji(r,t,i,a),a.write_shift(2,e.length),s&&a.write_shift(1,1),a.write_shift((1+s)*e.length,e,s?"utf16le":"sbcs"),a}function l1(r,t,e,i){var n=e&&e.biff==5;i||(i=H(n?3+t.length:5+2*t.length)),i.write_shift(2,r),i.write_shift(n?1:2,t.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var s=i.length>i.l?i.slice(0,i.l):i;return s.l==null&&(s.l=s.length),s}function c1(r,t){var e=t.biff==8||!t.biff?4:2,i=H(2*e+6);return i.write_shift(e,r.s.r),i.write_shift(e,r.e.r+1),i.write_shift(2,r.s.c),i.write_shift(2,r.e.c+1),i.write_shift(2,0),i}function L0(r,t,e,i){var n=e&&e.biff==5;i||(i=H(n?16:20)),i.write_shift(2,0),r.style?(i.write_shift(2,r.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,r.numFmtId||0),i.write_shift(2,t<<4));var s=0;return r.numFmtId>0&&n&&(s|=1024),i.write_shift(4,s),i.write_shift(4,0),n||i.write_shift(4,0),i.write_shift(2,0),i}function u1(r){var t=H(8);return t.write_shift(4,0),t.write_shift(2,r[0]?r[0]+1:0),t.write_shift(2,r[1]?r[1]+1:0),t}function h1(r,t,e,i,n,s){var a=H(8);return ji(r,t,i,a),Pu(e,s,a),a}function f1(r,t,e,i){var n=H(14);return ji(r,t,i,n),Xi(e,n),n}function d1(r,t,e){if(e.biff<8)return p1(r,t,e);for(var i=[],n=r.l+t,s=r.read_shift(e.biff>8?4:2);s--!==0;)i.push(Zg(r,e.biff>8?12:6,e));if(r.l!=n)throw new Error("Bad ExternSheet: "+r.l+" != "+n);return i}function p1(r,t,e){r[r.l+1]==3&&r[r.l]++;var i=Lu(r,t,e);return i.charCodeAt(0)==3?i.slice(1):i}function m1(r){var t=H(2+r.length*8);t.write_shift(2,r.length);for(var e=0;e<r.length;++e)Nu(r[e],t);return t}function g1(r){var t=H(24),e=Pt(r[0]);t.write_shift(2,e.r),t.write_shift(2,e.r),t.write_shift(2,e.c),t.write_shift(2,e.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(i[n],16));return jt([t,Qg(r[1])])}function x1(r){var t=r[1].Tooltip,e=H(10+2*(t.length+1));e.write_shift(2,2048);var i=Pt(r[0]);e.write_shift(2,i.r),e.write_shift(2,i.r),e.write_shift(2,i.c),e.write_shift(2,i.c);for(var n=0;n<t.length;++n)e.write_shift(2,t.charCodeAt(n));return e.write_shift(2,0),e}function _1(r){return r||(r=H(4)),r.write_shift(2,1),r.write_shift(2,1),r}function v1(r,t,e){if(!e.cellStyles)return ii(r,t);var i=e&&e.biff>=12?4:2,n=r.read_shift(i),s=r.read_shift(i),a=r.read_shift(i),o=r.read_shift(i),c=r.read_shift(2);i==2&&(r.l+=2);var l={s:n,e:s,w:a,ixfe:o,flags:c};return(e.biff>=5||!e.biff)&&(l.level=c>>8&7),l}function y1(r,t){var e=H(12);e.write_shift(2,t),e.write_shift(2,t),e.write_shift(2,r.width*256),e.write_shift(2,0);var i=0;return r.hidden&&(i|=1),e.write_shift(1,i),i=r.level||0,e.write_shift(1,i),e.write_shift(2,0),e}function w1(r){for(var t=H(2*r),e=0;e<r;++e)t.write_shift(2,e+1);return t}function b1(r,t,e){var i=H(15);return Os(i,r,t),i.write_shift(8,e,"f"),i}function C1(r,t,e){var i=H(9);return Os(i,r,t),i.write_shift(2,e),i}var T1=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=jo({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(o,c){var l=[],u=Gi(1);switch(c.type){case"base64":u=Gr(mi(o));break;case"binary":u=Gr(o);break;case"buffer":case"array":u=o;break}kr(u,0);var h=u.read_shift(1),f=!!(h&136),d=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,f=!0;break;case 49:d=!0,f=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var p=0,x=521;h==2&&(p=u.read_shift(2)),u.l+=3,h!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),h!=2&&(x=u.read_shift(2));var O=u.read_shift(2),A=c.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(A=r[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var D=[],G={},te=Math.min(u.length,h==2?521:x-10-(d?264:0)),me=g?32:11;u.l<te&&u[u.l]!=13;)switch(G={},G.name=rt.utils.decode(A,u.slice(u.l,u.l+me)).replace(/[\u0000\r\n].*$/g,""),u.l+=me,G.type=String.fromCharCode(u.read_shift(1)),h!=2&&!g&&(G.offset=u.read_shift(4)),G.len=u.read_shift(1),h==2&&(G.offset=u.read_shift(2)),G.dec=u.read_shift(1),G.name.length&&D.push(G),h!=2&&(u.l+=g?13:14),G.type){case"B":(!d||G.len!=8)&&c.WTF&&console.log("Skipping "+G.name+":"+G.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+G.name+":"+G.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+G.type)}if(u[u.l]!==13&&(u.l=x-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=x;var M=0,Q=0;for(l[0]=[],Q=0;Q!=D.length;++Q)l[0][Q]=D[Q].name;for(;p-- >0;){if(u[u.l]===42){u.l+=O;continue}for(++u.l,l[++M]=[],Q=0,Q=0;Q!=D.length;++Q){var U=u.slice(u.l,u.l+D[Q].len);u.l+=D[Q].len,kr(U,0);var q=rt.utils.decode(A,U);switch(D[Q].type){case"C":q.trim().length&&(l[M][Q]=q.replace(/\s+$/,""));break;case"D":q.length===8?l[M][Q]=new Date(+q.slice(0,4),+q.slice(4,6)-1,+q.slice(6,8)):l[M][Q]=q;break;case"F":l[M][Q]=parseFloat(q.trim());break;case"+":case"I":l[M][Q]=g?U.read_shift(-4,"i")^2147483648:U.read_shift(4,"i");break;case"L":switch(q.trim().toUpperCase()){case"Y":case"T":l[M][Q]=!0;break;case"N":case"F":l[M][Q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+q+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));l[M][Q]="##MEMO##"+(g?parseInt(q.trim(),10):U.read_shift(4));break;case"N":q=q.replace(/\u0000/g,"").trim(),q&&q!="."&&(l[M][Q]=+q||0);break;case"@":l[M][Q]=new Date(U.read_shift(-8,"f")-621356832e5);break;case"T":l[M][Q]=new Date((U.read_shift(4)-2440588)*864e5+U.read_shift(4));break;case"Y":l[M][Q]=U.read_shift(4,"i")/1e4+U.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[M][Q]=-U.read_shift(-8,"f");break;case"B":if(d&&D[Q].len==8){l[M][Q]=U.read_shift(8,"f");break}case"G":case"P":U.l+=D[Q].len;break;case"0":if(D[Q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+D[Q].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=D,l}function i(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var u=Nn(e(o,l),l);return u["!cols"]=l.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete l.DBF,u}function n(o,c){try{return Ki(i(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var l=c||{};if(+l.codepage>=0&&ys(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var u=gr(),h=Aa(o,{header:1,raw:!0,cellDates:!0}),f=h[0],d=h.slice(1),g=o["!cols"]||[],p=0,x=0,O=0,A=1;for(p=0;p<f.length;++p){if(((g[p]||{}).DBF||{}).name){f[p]=g[p].DBF.name,++O;continue}if(f[p]!=null){if(++O,typeof f[p]=="number"&&(f[p]=f[p].toString(10)),typeof f[p]!="string")throw new Error("DBF Invalid column name "+f[p]+" |"+typeof f[p]+"|");if(f.indexOf(f[p])!==p){for(x=0;x<1024;++x)if(f.indexOf(f[p]+"_"+x)==-1){f[p]+="_"+x;break}}}}var D=st(o["!ref"]),G=[],te=[],me=[];for(p=0;p<=D.e.c-D.s.c;++p){var M="",Q="",U=0,q=[];for(x=0;x<d.length;++x)d[x][p]!=null&&q.push(d[x][p]);if(q.length==0||f[p]==null){G[p]="?";continue}for(x=0;x<q.length;++x){switch(typeof q[x]){case"number":Q="B";break;case"string":Q="C";break;case"boolean":Q="L";break;case"object":Q=q[x]instanceof Date?"D":"C";break;default:Q="C"}U=Math.max(U,String(q[x]).length),M=M&&M!=Q?"C":Q}U>250&&(U=250),Q=((g[p]||{}).DBF||{}).type,Q=="C"&&g[p].DBF.len>U&&(U=g[p].DBF.len),M=="B"&&Q=="N"&&(M="N",me[p]=g[p].DBF.dec,U=g[p].DBF.len),te[p]=M=="C"||Q=="N"?U:s[M]||0,A+=te[p],G[p]=M}var ee=u.next(32);for(ee.write_shift(4,318902576),ee.write_shift(4,d.length),ee.write_shift(2,296+32*O),ee.write_shift(2,A),p=0;p<4;++p)ee.write_shift(4,0);for(ee.write_shift(4,0|(+t[Mn]||3)<<8),p=0,x=0;p<f.length;++p)if(f[p]!=null){var re=u.next(32),Ce=(f[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);re.write_shift(1,Ce,"sbcs"),re.write_shift(1,G[p]=="?"?"C":G[p],"sbcs"),re.write_shift(4,x),re.write_shift(1,te[p]||s[G[p]]||0),re.write_shift(1,me[p]||0),re.write_shift(1,2),re.write_shift(4,0),re.write_shift(1,0),re.write_shift(4,0),re.write_shift(4,0),x+=te[p]||s[G[p]]||0}var je=u.next(264);for(je.write_shift(4,13),p=0;p<65;++p)je.write_shift(4,0);for(p=0;p<d.length;++p){var Te=u.next(A);for(Te.write_shift(1,0),x=0;x<f.length;++x)if(f[x]!=null)switch(G[x]){case"L":Te.write_shift(1,d[p][x]==null?63:d[p][x]?84:70);break;case"B":Te.write_shift(8,d[p][x]||0,"f");break;case"N":var It="0";for(typeof d[p][x]=="number"&&(It=d[p][x].toFixed(me[x]||0)),O=0;O<te[x]-It.length;++O)Te.write_shift(1,32);Te.write_shift(1,It,"sbcs");break;case"D":d[p][x]?(Te.write_shift(4,("0000"+d[p][x].getFullYear()).slice(-4),"sbcs"),Te.write_shift(2,("00"+(d[p][x].getMonth()+1)).slice(-2),"sbcs"),Te.write_shift(2,("00"+d[p][x].getDate()).slice(-2),"sbcs")):Te.write_shift(8,"00000000","sbcs");break;case"C":var kt=String(d[p][x]!=null?d[p][x]:"").slice(0,te[x]);for(Te.write_shift(1,kt,"sbcs"),O=0;O<te[x]-kt.length;++O)Te.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:n,to_sheet:i,from_sheet:a}}(),S1=function(){var r={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+qt(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(f,d){var g=r[d];return typeof g=="number"?s0(g):g},i=function(f,d,g){var p=d.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?f:s0(p)};r["|"]=254;function n(f,d){switch(d.type){case"base64":return s(mi(f),d);case"binary":return s(f,d);case"buffer":return s(Xe&&Buffer.isBuffer(f)?f.toString("binary"):Es(f),d);case"array":return s(Ra(f),d)}throw new Error("Unrecognized type "+d.type)}function s(f,d){var g=f.split(/[\n\r]+/),p=-1,x=-1,O=0,A=0,D=[],G=[],te=null,me={},M=[],Q=[],U=[],q=0,ee;for(+d.codepage>=0&&ys(+d.codepage);O!==g.length;++O){q=0;var re=g[O].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(t,e),Ce=re.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),je=Ce[0],Te;if(re.length>0)switch(je){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Ce[1].charAt(0)=="P"&&G.push(re.slice(3).replace(/;;/g,";"));break;case"C":var It=!1,kt=!1,hr=!1,ar=!1,Rt=-1,fr=-1;for(A=1;A<Ce.length;++A)switch(Ce[A].charAt(0)){case"A":break;case"X":x=parseInt(Ce[A].slice(1))-1,kt=!0;break;case"Y":for(p=parseInt(Ce[A].slice(1))-1,kt||(x=0),ee=D.length;ee<=p;++ee)D[ee]=[];break;case"K":Te=Ce[A].slice(1),Te.charAt(0)==='"'?Te=Te.slice(1,Te.length-1):Te==="TRUE"?Te=!0:Te==="FALSE"?Te=!1:isNaN(di(Te))?isNaN(bs(Te).getDate())||(Te=ur(Te)):(Te=di(Te),te!==null&&ru(te)&&(Te=au(Te))),typeof rt<"u"&&typeof Te=="string"&&(d||{}).type!="string"&&(d||{}).codepage&&(Te=rt.utils.decode(d.codepage,Te)),It=!0;break;case"E":ar=!0;var E=Cx(Ce[A].slice(1),{r:p,c:x});D[p][x]=[D[p][x],E];break;case"S":hr=!0,D[p][x]=[D[p][x],"S5S"];break;case"G":break;case"R":Rt=parseInt(Ce[A].slice(1))-1;break;case"C":fr=parseInt(Ce[A].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+re)}if(It&&(D[p][x]&&D[p][x].length==2?D[p][x][0]=Te:D[p][x]=Te,te=null),hr){if(ar)throw new Error("SYLK shared formula cannot have own formula");var K=Rt>-1&&D[Rt][fr];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");D[p][x][1]=Tx(K[1],{r:p-Rt,c:x-fr})}break;case"F":var k=0;for(A=1;A<Ce.length;++A)switch(Ce[A].charAt(0)){case"X":x=parseInt(Ce[A].slice(1))-1,++k;break;case"Y":for(p=parseInt(Ce[A].slice(1))-1,ee=D.length;ee<=p;++ee)D[ee]=[];break;case"M":q=parseInt(Ce[A].slice(1))/20;break;case"F":break;case"G":break;case"P":te=G[parseInt(Ce[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(U=Ce[A].slice(1).split(" "),ee=parseInt(U[0],10);ee<=parseInt(U[1],10);++ee)q=parseInt(U[2],10),Q[ee-1]=q===0?{hidden:!0}:{wch:q},cl(Q[ee-1]);break;case"C":x=parseInt(Ce[A].slice(1))-1,Q[x]||(Q[x]={});break;case"R":p=parseInt(Ce[A].slice(1))-1,M[p]||(M[p]={}),q>0?(M[p].hpt=q,M[p].hpx=Wu(q)):q===0&&(M[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+re)}k<1&&(te=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+re)}}return M.length>0&&(me["!rows"]=M),Q.length>0&&(me["!cols"]=Q),d&&d.sheetRows&&(D=D.slice(0,d.sheetRows)),[D,me]}function a(f,d){var g=n(f,d),p=g[0],x=g[1],O=Nn(p,d);return qt(x).forEach(function(A){O[A]=x[A]}),O}function o(f,d){return Ki(a(f,d),d)}function c(f,d,g,p){var x="C;Y"+(g+1)+";X"+(p+1)+";K";switch(f.t){case"n":x+=f.v||0,f.f&&!f.F&&(x+=";E"+hl(f.f,{r:g,c:p}));break;case"b":x+=f.v?"TRUE":"FALSE";break;case"e":x+=f.w||f.v;break;case"d":x+='"'+(f.w||f.v)+'"';break;case"s":x+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function l(f,d){d.forEach(function(g,p){var x="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?x+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Ia(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=ka(g.wpx)),typeof g.wch=="number"&&(x+=Math.round(g.wch))),x.charAt(x.length-1)!=" "&&f.push(x)})}function u(f,d){d.forEach(function(g,p){var x="F;";g.hidden?x+="M0;":g.hpt?x+="M"+20*g.hpt+";":g.hpx&&(x+="M"+20*Fa(g.hpx)+";"),x.length>2&&f.push(x+"R"+(p+1))})}function h(f,d){var g=["ID;PWXL;N;E"],p=[],x=st(f["!ref"]),O,A=Array.isArray(f),D=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),f["!cols"]&&l(g,f["!cols"]),f["!rows"]&&u(g,f["!rows"]),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var G=x.s.r;G<=x.e.r;++G)for(var te=x.s.c;te<=x.e.c;++te){var me=Qe({r:G,c:te});O=A?(f[G]||[])[te]:f[me],!(!O||O.v==null&&(!O.f||O.F))&&p.push(c(O,f,G,te,d))}return g.join(D)+D+p.join(D)+D+"E"+D}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),E1=function(){function r(s,a){switch(a.type){case"base64":return t(mi(s),a);case"binary":return t(s,a);case"buffer":return t(Xe&&Buffer.isBuffer(s)?s.toString("binary"):Es(s),a);case"array":return t(Ra(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),c=-1,l=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++c]=[],l=0;continue}if(!(c<0)){var f=o[u].trim().split(","),d=f[0],g=f[1];++u;for(var p=o[u]||"";(p.match(/["]/g)||[]).length&1&&u<o.length-1;)p+=`
`+o[++u];switch(p=p.trim(),+d){case-1:if(p==="BOT"){h[++c]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?h[c][l]=!0:p==="FALSE"?h[c][l]=!1:isNaN(di(g))?isNaN(bs(g).getDate())?h[c][l]=g:h[c][l]=ur(g):h[c][l]=di(g),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),hs&&p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),h[c][l++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function e(s,a){return Nn(r(s,a),a)}function i(s,a){return Ki(e(s,a),a)}var n=function(){var s=function(c,l,u,h,f){c.push(l),c.push(u+","+h),c.push('"'+f.replace(/"/g,'""')+'"')},a=function(c,l,u,h){c.push(l+","+u),c.push(l==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var l=[],u=st(c["!ref"]),h,f=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,u.e.r-u.s.r+1,""),s(l,"TUPLES",0,u.e.c-u.s.c+1,""),s(l,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){a(l,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var p=Qe({r:d,c:g});if(h=f?(c[d]||[])[g]:c[p],!h){a(l,1,0,"");continue}switch(h.t){case"n":var x=hs?h.w:h.v;!x&&h.v!=null&&(x=h.v),x==null?hs&&h.f&&!h.F?a(l,1,0,"="+h.f):a(l,1,0,""):a(l,0,x,"V");break;case"b":a(l,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(l,1,0,!hs||isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=ki(h.z||ft[14],xr(ur(h.v)))),hs?a(l,0,h.w,"V"):a(l,1,0,h.w);break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var O=`\r
`,A=l.join(O);return A}}();return{to_workbook:i,to_sheet:e,from_sheet:n}}(),Bu=function(){function r(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(h,f){for(var d=h.split(`
`),g=-1,p=-1,x=0,O=[];x!==d.length;++x){var A=d[x].trim().split(":");if(A[0]==="cell"){var D=Pt(A[1]);if(O.length<=D.r)for(g=O.length;g<=D.r;++g)O[g]||(O[g]=[]);switch(g=D.r,p=D.c,A[2]){case"t":O[g][p]=r(A[3]);break;case"v":O[g][p]=+A[3];break;case"vtf":var G=A[A.length-1];case"vtc":switch(A[3]){case"nl":O[g][p]=!!+A[4];break;default:O[g][p]=+A[4];break}A[2]=="vtf"&&(O[g][p]=[O[g][p],G])}}}return f&&f.sheetRows&&(O=O.slice(0,f.sheetRows)),O}function i(h,f){return Nn(e(h,f),f)}function n(h,f){return Ki(i(h,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(h){if(!h||!h["!ref"])return"";for(var f=[],d=[],g,p="",x=Or(h["!ref"]),O=Array.isArray(h),A=x.s.r;A<=x.e.r;++A)for(var D=x.s.c;D<=x.e.c;++D)if(p=Qe({r:A,c:D}),g=O?(h[A]||[])[D]:h[p],!(!g||g.v==null||g.t==="z")){switch(d=["cell",p,"t"],g.t){case"s":case"str":d.push(t(g.v));break;case"n":g.f?(d[2]="vtf",d[3]="n",d[4]=g.v,d[5]=t(g.f)):(d[2]="v",d[3]=g.v);break;case"b":d[2]="vt"+(g.f?"f":"c"),d[3]="nl",d[4]=g.v?"1":"0",d[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var G=xr(ur(g.v));d[2]="vtc",d[3]="nd",d[4]=""+G,d[5]=g.w||ki(g.z||ft[14],G);break;case"e":continue}f.push(d.join(":"))}return f.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(h){return[s,a,o,a,l(h),c].join(`
`)}return{to_workbook:n,to_sheet:i,from_sheet:u}}(),I1=function(){function r(u,h,f,d,g){g.raw?h[f][d]=u:u===""||(u==="TRUE"?h[f][d]=!0:u==="FALSE"?h[f][d]=!1:isNaN(di(u))?isNaN(bs(u).getDate())?h[f][d]=u:h[f][d]=ur(u):h[f][d]=di(u))}function t(u,h){var f=h||{},d=[];if(!u||u.length===0)return d;for(var g=u.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var x=10,O=0,A=0;A<=p;++A)O=g[A].indexOf(" "),O==-1?O=g[A].length:O++,x=Math.max(x,O);for(A=0;A<=p;++A){d[A]=[];var D=0;for(r(g[A].slice(0,x).trim(),d,A,D,f),D=1;D<=(g[A].length-x)/10+1;++D)r(g[A].slice(x+(D-1)*10,x+D*10).trim(),d,A,D,f)}return f.sheetRows&&(d=d.slice(0,f.sheetRows)),d}var e={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function n(u){for(var h={},f=!1,d=0,g=0;d<u.length;++d)(g=u.charCodeAt(d))==34?f=!f:!f&&g in e&&(h[g]=(h[g]||0)+1);g=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&g.push([h[d],d]);if(!g.length){h=i;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&g.push([h[d],d])}return g.sort(function(p,x){return p[0]-x[0]||i[p[1]]-i[x[1]]}),e[g.pop()[1]]||44}function s(u,h){var f=h||{},d="";ri!=null&&f.dense==null&&(f.dense=ri);var g=f.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=n(u.slice(0,1024)):f&&f.FS?d=f.FS:d=n(u.slice(0,1024));var x=0,O=0,A=0,D=0,G=0,te=d.charCodeAt(0),me=!1,M=0,Q=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var U=f.dateNF!=null?Wm(f.dateNF):null;function q(){var ee=u.slice(D,G),re={};if(ee.charAt(0)=='"'&&ee.charAt(ee.length-1)=='"'&&(ee=ee.slice(1,-1).replace(/""/g,'"')),ee.length===0)re.t="z";else if(f.raw)re.t="s",re.v=ee;else if(ee.trim().length===0)re.t="s",re.v=ee;else if(ee.charCodeAt(0)==61)ee.charCodeAt(1)==34&&ee.charCodeAt(ee.length-1)==34?(re.t="s",re.v=ee.slice(2,-1).replace(/""/g,'"')):Sx(ee)?(re.t="n",re.f=ee.slice(1)):(re.t="s",re.v=ee);else if(ee=="TRUE")re.t="b",re.v=!0;else if(ee=="FALSE")re.t="b",re.v=!1;else if(!isNaN(A=di(ee)))re.t="n",f.cellText!==!1&&(re.w=ee),re.v=A;else if(!isNaN(bs(ee).getDate())||U&&ee.match(U)){re.z=f.dateNF||ft[14];var Ce=0;U&&ee.match(U)&&(ee=zm(ee,f.dateNF,ee.match(U)||[]),Ce=1),f.cellDates?(re.t="d",re.v=ur(ee,Ce)):(re.t="n",re.v=xr(ur(ee,Ce))),f.cellText!==!1&&(re.w=ki(re.z,re.v instanceof Date?xr(re.v):re.v)),f.cellNF||delete re.z}else re.t="s",re.v=ee;if(re.t=="z"||(f.dense?(g[x]||(g[x]=[]),g[x][O]=re):g[Qe({c:O,r:x})]=re),D=G+1,Q=u.charCodeAt(D),p.e.c<O&&(p.e.c=O),p.e.r<x&&(p.e.r=x),M==te)++O;else if(O=0,++x,f.sheetRows&&f.sheetRows<=x)return!0}e:for(;G<u.length;++G)switch(M=u.charCodeAt(G)){case 34:Q===34&&(me=!me);break;case te:case 10:case 13:if(!me&&q())break e;break;default:break}return G-D>0&&q(),g["!ref"]=_t(p),g}function a(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):Nn(t(u,h),h)}function o(u,h){var f="",d=h.type=="string"?[0,0,0,0]:Vw(u,h);switch(h.type){case"base64":f=mi(u);break;case"binary":f=u;break;case"buffer":h.codepage==65001?f=u.toString("utf8"):h.codepage&&typeof rt<"u"?f=rt.utils.decode(h.codepage,u):f=Xe&&Buffer.isBuffer(u)?u.toString("binary"):Es(u);break;case"array":f=Ra(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?f=ps(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=ps(f):h.type=="binary"&&typeof rt<"u"&&h.codepage&&(f=rt.utils.decode(h.codepage,rt.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?Bu.to_sheet(h.type=="string"?f:ps(f),h):a(f,h)}function c(u,h){return Ki(o(u,h),h)}function l(u){for(var h=[],f=st(u["!ref"]),d,g=Array.isArray(u),p=f.s.r;p<=f.e.r;++p){for(var x=[],O=f.s.c;O<=f.e.c;++O){var A=Qe({r:p,c:O});if(d=g?(u[p]||[])[O]:u[A],!d||d.v==null){x.push("          ");continue}for(var D=(d.w||(gi(d),d.w)||"").slice(0,10);D.length<10;)D+=" ";x.push(D+(O===0?" ":""))}h.push(x.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();var R0=function(){function r(E,K,k){if(E){kr(E,E.l||0);for(var I=k.Enum||Rt;E.l<E.length;){var J=E.read_shift(2),we=I[J]||I[65535],ke=E.read_shift(2),xe=E.l+ke,le=we.f&&we.f(E,ke,k);if(E.l=xe,K(le,we,J))return}}}function t(E,K){switch(K.type){case"base64":return e(Gr(mi(E)),K);case"binary":return e(Gr(E),K);case"buffer":case"array":return e(E,K)}throw"Unsupported type "+K.type}function e(E,K){if(!E)return E;var k=K||{};ri!=null&&k.dense==null&&(k.dense=ri);var I=k.dense?[]:{},J="Sheet1",we="",ke=0,xe={},le=[],Ze=[],Ne={s:{r:0,c:0},e:{r:0,c:0}},Nt=k.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)k.Enum=Rt,r(E,function(ye,Ar,ni){switch(ni){case 0:k.vers=ye,ye>=4096&&(k.qpro=!0);break;case 6:Ne=ye;break;case 204:ye&&(we=ye);break;case 222:we=ye;break;case 15:case 51:k.qpro||(ye[1].v=ye[1].v.slice(1));case 13:case 14:case 16:ni==14&&(ye[2]&112)==112&&(ye[2]&15)>1&&(ye[2]&15)<15&&(ye[1].z=k.dateNF||ft[14],k.cellDates&&(ye[1].t="d",ye[1].v=au(ye[1].v))),k.qpro&&ye[3]>ke&&(I["!ref"]=_t(Ne),xe[J]=I,le.push(J),I=k.dense?[]:{},Ne={s:{r:0,c:0},e:{r:0,c:0}},ke=ye[3],J=we||"Sheet"+(ke+1),we="");var Di=k.dense?(I[ye[0].r]||[])[ye[0].c]:I[Qe(ye[0])];if(Di){Di.t=ye[1].t,Di.v=ye[1].v,ye[1].z!=null&&(Di.z=ye[1].z),ye[1].f!=null&&(Di.f=ye[1].f);break}k.dense?(I[ye[0].r]||(I[ye[0].r]=[]),I[ye[0].r][ye[0].c]=ye[1]):I[Qe(ye[0])]=ye[1];break;default:}},k);else if(E[2]==26||E[2]==14)k.Enum=fr,E[2]==14&&(k.qpro=!0,E.l=0),r(E,function(ye,Ar,ni){switch(ni){case 204:J=ye;break;case 22:ye[1].v=ye[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ye[3]>ke&&(I["!ref"]=_t(Ne),xe[J]=I,le.push(J),I=k.dense?[]:{},Ne={s:{r:0,c:0},e:{r:0,c:0}},ke=ye[3],J="Sheet"+(ke+1)),Nt>0&&ye[0].r>=Nt)break;k.dense?(I[ye[0].r]||(I[ye[0].r]=[]),I[ye[0].r][ye[0].c]=ye[1]):I[Qe(ye[0])]=ye[1],Ne.e.c<ye[0].c&&(Ne.e.c=ye[0].c),Ne.e.r<ye[0].r&&(Ne.e.r=ye[0].r);break;case 27:ye[14e3]&&(Ze[ye[14e3][0]]=ye[14e3][1]);break;case 1537:Ze[ye[0]]=ye[1],ye[0]==ke&&(J=ye[1]);break;default:break}},k);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(I["!ref"]=_t(Ne),xe[we||J]=I,le.push(we||J),!Ze.length)return{SheetNames:le,Sheets:xe};for(var We={},Vr=[],lt=0;lt<Ze.length;++lt)xe[le[lt]]?(Vr.push(Ze[lt]||le[lt]),We[Ze[lt]]=xe[Ze[lt]]||xe[le[lt]]):(Vr.push(Ze[lt]),We[Ze[lt]]={"!ref":"A1"});return{SheetNames:Vr,Sheets:We}}function i(E,K){var k=K||{};if(+k.codepage>=0&&ys(+k.codepage),k.type=="string")throw new Error("Cannot write WK1 to JS string");var I=gr(),J=st(E["!ref"]),we=Array.isArray(E),ke=[];se(I,0,s(1030)),se(I,6,c(J));for(var xe=Math.min(J.e.r,8191),le=J.s.r;le<=xe;++le)for(var Ze=Yt(le),Ne=J.s.c;Ne<=J.e.c;++Ne){le===J.s.r&&(ke[Ne]=nr(Ne));var Nt=ke[Ne]+Ze,We=we?(E[le]||[])[Ne]:E[Nt];if(!(!We||We.t=="z"))if(We.t=="n")(We.v|0)==We.v&&We.v>=-32768&&We.v<=32767?se(I,13,d(le,Ne,We.v)):se(I,14,p(le,Ne,We.v));else{var Vr=gi(We);se(I,15,h(le,Ne,Vr.slice(0,239)))}}return se(I,1),I.end()}function n(E,K){var k=K||{};if(+k.codepage>=0&&ys(+k.codepage),k.type=="string")throw new Error("Cannot write WK3 to JS string");var I=gr();se(I,0,a(E));for(var J=0,we=0;J<E.SheetNames.length;++J)(E.Sheets[E.SheetNames[J]]||{})["!ref"]&&se(I,27,ar(E.SheetNames[J],we++));var ke=0;for(J=0;J<E.SheetNames.length;++J){var xe=E.Sheets[E.SheetNames[J]];if(!(!xe||!xe["!ref"])){for(var le=st(xe["!ref"]),Ze=Array.isArray(xe),Ne=[],Nt=Math.min(le.e.r,8191),We=le.s.r;We<=Nt;++We)for(var Vr=Yt(We),lt=le.s.c;lt<=le.e.c;++lt){We===le.s.r&&(Ne[lt]=nr(lt));var ye=Ne[lt]+Vr,Ar=Ze?(xe[We]||[])[lt]:xe[ye];if(!(!Ar||Ar.t=="z"))if(Ar.t=="n")se(I,23,q(We,lt,ke,Ar.v));else{var ni=gi(Ar);se(I,22,M(We,lt,ke,ni.slice(0,239)))}}++ke}}return se(I,1),I.end()}function s(E){var K=H(2);return K.write_shift(2,E),K}function a(E){var K=H(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var k=0,I=0,J=0,we=0;we<E.SheetNames.length;++we){var ke=E.SheetNames[we],xe=E.Sheets[ke];if(!(!xe||!xe["!ref"])){++J;var le=Or(xe["!ref"]);k<le.e.r&&(k=le.e.r),I<le.e.c&&(I=le.e.c)}}return k>8191&&(k=8191),K.write_shift(2,k),K.write_shift(1,J),K.write_shift(1,I),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(E,K,k){var I={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&k.qpro?(I.s.c=E.read_shift(1),E.l++,I.s.r=E.read_shift(2),I.e.c=E.read_shift(1),E.l++,I.e.r=E.read_shift(2),I):(I.s.c=E.read_shift(2),I.s.r=E.read_shift(2),K==12&&k.qpro&&(E.l+=2),I.e.c=E.read_shift(2),I.e.r=E.read_shift(2),K==12&&k.qpro&&(E.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function c(E){var K=H(8);return K.write_shift(2,E.s.c),K.write_shift(2,E.s.r),K.write_shift(2,E.e.c),K.write_shift(2,E.e.r),K}function l(E,K,k){var I=[{c:0,r:0},{t:"n",v:0},0,0];return k.qpro&&k.vers!=20768?(I[0].c=E.read_shift(1),I[3]=E.read_shift(1),I[0].r=E.read_shift(2),E.l+=2):(I[2]=E.read_shift(1),I[0].c=E.read_shift(2),I[0].r=E.read_shift(2)),I}function u(E,K,k){var I=E.l+K,J=l(E,K,k);if(J[1].t="s",k.vers==20768){E.l++;var we=E.read_shift(1);return J[1].v=E.read_shift(we,"utf8"),J}return k.qpro&&E.l++,J[1].v=E.read_shift(I-E.l,"cstr"),J}function h(E,K,k){var I=H(7+k.length);I.write_shift(1,255),I.write_shift(2,K),I.write_shift(2,E),I.write_shift(1,39);for(var J=0;J<I.length;++J){var we=k.charCodeAt(J);I.write_shift(1,we>=128?95:we)}return I.write_shift(1,0),I}function f(E,K,k){var I=l(E,K,k);return I[1].v=E.read_shift(2,"i"),I}function d(E,K,k){var I=H(7);return I.write_shift(1,255),I.write_shift(2,K),I.write_shift(2,E),I.write_shift(2,k,"i"),I}function g(E,K,k){var I=l(E,K,k);return I[1].v=E.read_shift(8,"f"),I}function p(E,K,k){var I=H(13);return I.write_shift(1,255),I.write_shift(2,K),I.write_shift(2,E),I.write_shift(8,k,"f"),I}function x(E,K,k){var I=E.l+K,J=l(E,K,k);if(J[1].v=E.read_shift(8,"f"),k.qpro)E.l=I;else{var we=E.read_shift(2);G(E.slice(E.l,E.l+we),J),E.l+=we}return J}function O(E,K,k){var I=K&32768;return K&=-32769,K=(I?E:0)+(K>=8192?K-16384:K),(I?"":"$")+(k?nr(K):Yt(K))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},D=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function G(E,K){kr(E,0);for(var k=[],I=0,J="",we="",ke="",xe="";E.l<E.length;){var le=E[E.l++];switch(le){case 0:k.push(E.read_shift(8,"f"));break;case 1:we=O(K[0].c,E.read_shift(2),!0),J=O(K[0].r,E.read_shift(2),!1),k.push(we+J);break;case 2:{var Ze=O(K[0].c,E.read_shift(2),!0),Ne=O(K[0].r,E.read_shift(2),!1);we=O(K[0].c,E.read_shift(2),!0),J=O(K[0].r,E.read_shift(2),!1),k.push(Ze+Ne+":"+we+J)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:k.push("("+k.pop()+")");break;case 5:k.push(E.read_shift(2));break;case 6:{for(var Nt="";le=E[E.l++];)Nt+=String.fromCharCode(le);k.push('"'+Nt.replace(/"/g,'""')+'"')}break;case 8:k.push("-"+k.pop());break;case 23:k.push("+"+k.pop());break;case 22:k.push("NOT("+k.pop()+")");break;case 20:case 21:xe=k.pop(),ke=k.pop(),k.push(["AND","OR"][le-20]+"("+ke+","+xe+")");break;default:if(le<32&&D[le])xe=k.pop(),ke=k.pop(),k.push(ke+D[le]+xe);else if(A[le]){if(I=A[le][1],I==69&&(I=E[E.l++]),I>k.length){console.error("WK1 bad formula parse 0x"+le.toString(16)+":|"+k.join("|")+"|");return}var We=k.slice(-I);k.length-=I,k.push(A[le][0]+"("+We.join(",")+")")}else return le<=7?console.error("WK1 invalid opcode "+le.toString(16)):le<=24?console.error("WK1 unsupported op "+le.toString(16)):le<=30?console.error("WK1 invalid opcode "+le.toString(16)):le<=115?console.error("WK1 unsupported function opcode "+le.toString(16)):console.error("WK1 unrecognized opcode "+le.toString(16))}}k.length==1?K[1].f=""+k[0]:console.error("WK1 bad formula parse |"+k.join("|")+"|")}function te(E){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=E.read_shift(2),K[3]=E[E.l++],K[0].c=E[E.l++],K}function me(E,K){var k=te(E,K);return k[1].t="s",k[1].v=E.read_shift(K-4,"cstr"),k}function M(E,K,k,I){var J=H(6+I.length);J.write_shift(2,E),J.write_shift(1,k),J.write_shift(1,K),J.write_shift(1,39);for(var we=0;we<I.length;++we){var ke=I.charCodeAt(we);J.write_shift(1,ke>=128?95:ke)}return J.write_shift(1,0),J}function Q(E,K){var k=te(E,K);k[1].v=E.read_shift(2);var I=k[1].v>>1;if(k[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return k[1].v=I,k}function U(E,K){var k=te(E,K),I=E.read_shift(4),J=E.read_shift(4),we=E.read_shift(2);if(we==65535)return I===0&&J===3221225472?(k[1].t="e",k[1].v=15):I===0&&J===3489660928?(k[1].t="e",k[1].v=42):k[1].v=0,k;var ke=we&32768;return we=(we&32767)-16446,k[1].v=(1-ke*2)*(J*Math.pow(2,we+32)+I*Math.pow(2,we)),k}function q(E,K,k,I){var J=H(14);if(J.write_shift(2,E),J.write_shift(1,k),J.write_shift(1,K),I==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var we=0,ke=0,xe=0,le=0;return I<0&&(we=1,I=-I),ke=Math.log2(I)|0,I/=Math.pow(2,ke-31),le=I>>>0,(le&2147483648)==0&&(I/=2,++ke,le=I>>>0),I-=le,le|=2147483648,le>>>=0,I*=Math.pow(2,32),xe=I>>>0,J.write_shift(4,xe),J.write_shift(4,le),ke+=16383+(we?32768:0),J.write_shift(2,ke),J}function ee(E,K){var k=U(E,14);return E.l+=K-14,k}function re(E,K){var k=te(E,K),I=E.read_shift(4);return k[1].v=I>>6,k}function Ce(E,K){var k=te(E,K),I=E.read_shift(8,"f");return k[1].v=I,k}function je(E,K){var k=Ce(E,14);return E.l+=K-10,k}function Te(E,K){return E[E.l+K-1]==0?E.read_shift(K,"cstr"):""}function It(E,K){var k=E[E.l++];k>K-1&&(k=K-1);for(var I="";I.length<k;)I+=String.fromCharCode(E[E.l++]);return I}function kt(E,K,k){if(!(!k.qpro||K<21)){var I=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var J=E.read_shift(K-21,"cstr");return[I,J]}}function hr(E,K){for(var k={},I=E.l+K;E.l<I;){var J=E.read_shift(2);if(J==14e3){for(k[J]=[0,""],k[J][0]=E.read_shift(2);E[E.l];)k[J][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return k}function ar(E,K){var k=H(5+E.length);k.write_shift(2,14e3),k.write_shift(2,K);for(var I=0;I<E.length;++I){var J=E.charCodeAt(I);k[k.l++]=J>127?95:J}return k[k.l++]=0,k}var Rt={0:{n:"BOF",f:Mu},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Te},222:{n:"SHEETNAMELP",f:It},65535:{n:""}},fr={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:me},23:{n:"NUMBER17",f:U},24:{n:"NUMBER18",f:Q},25:{n:"FORMULA19",f:ee},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:hr},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:re},38:{n:"??"},39:{n:"NUMBER27",f:Ce},40:{n:"FORMULA28",f:je},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:kt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:n,to_workbook:t}}();var k1=/^\s|\s$|[\t\n\r]/;function Vu(r,t){if(!t.bookSST)return"";var e=[vt];e[e.length]=ne("sst",null,{xmlns:Ln[0],count:r.Count,uniqueCount:r.Unique});for(var i=0;i!=r.length;++i)if(r[i]!=null){var n=r[i],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(k1)&&(s+=' xml:space="preserve"'),s+=">"+qe(n.t)+"</t>"),s+="</si>",e[e.length]=s}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function F1(r){return[r.read_shift(4),r.read_shift(4)]}function O1(r,t){return t||(t=H(8)),t.write_shift(4,r.Count),t.write_shift(4,r.Unique),t}var A1=wg;function D1(r){var t=gr();Z(t,159,O1(r));for(var e=0;e<r.length;++e)Z(t,19,A1(r[e]));return Z(t,160),t.end()}function M1(r){if(typeof rt<"u")return rt.utils.encode(Mn,r);for(var t=[],e=r.split(""),i=0;i<e.length;++i)t[i]=e[i].charCodeAt(0);return t}function $u(r){var t=0,e,i=M1(r),n=i.length+1,s,a,o,c,l;for(e=Gi(n),e[0]=i.length,s=1;s!=n;++s)e[s]=i[s-1];for(s=n-1;s>=0;--s)a=e[s],o=(t&16384)===0?0:1,c=t<<1&32767,l=o|c,t=l^a;return t^52811}var P1=function(){function r(n,s){switch(s.type){case"base64":return t(mi(n),s);case"binary":return t(n,s);case"buffer":return t(Xe&&Buffer.isBuffer(n)?n.toString("binary"):Es(n),s);case"array":return t(Ra(n),s)}throw new Error("Unrecognized type "+s.type)}function t(n,s){var a=s||{},o=a.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var f=/\\\w+\b/g,d=0,g,p=-1;g=f.exec(u);){switch(g[0]){case"\\cell":var x=u.slice(d,f.lastIndex-g[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var O={v:x,t:"s"};Array.isArray(o)?o[h][p]=O:o[Qe({r:h,c:p})]=O}break}d=f.lastIndex}p>l.e.c&&(l.e.c=p)}),o["!ref"]=_t(l),o}function e(n,s){return Ki(r(n,s),s)}function i(n){for(var s=["{\\rtf1\\ansi"],a=st(n["!ref"]),o,c=Array.isArray(n),l=a.s.r;l<=a.e.r;++l){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var h=Qe({r:l,c:u});o=c?(n[l]||[])[u]:n[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(gi(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:e,to_sheet:r,from_sheet:i}}();function N0(r){for(var t=0,e=1;t!=3;++t)e=e*256+(r[t]>255?255:r[t]<0?0:r[t]);return e.toString(16).toUpperCase().slice(1)}var L1=6;var pi=L1;function Ia(r){return Math.floor((r+Math.round(128/pi)/256)*pi)}function ka(r){return Math.floor((r-5)/pi*100+.5)/100}function Uo(r){return Math.round((r*pi+5)/pi*256)/256}function cl(r){r.width?(r.wpx=Ia(r.width),r.wch=ka(r.wpx),r.MDW=pi):r.wpx?(r.wch=ka(r.wpx),r.width=Uo(r.wch),r.MDW=pi):typeof r.wch=="number"&&(r.width=Uo(r.wch),r.wpx=Ia(r.width),r.MDW=pi),r.customWidth&&delete r.customWidth}var R1=96,Hu=R1;function Fa(r){return r*96/Hu}function Wu(r){return r*Hu/96}function N1(r){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var i=e[0];i<=e[1];++i)r[i]!=null&&(t[t.length]=ne("numFmt",null,{numFmtId:i,formatCode:qe(r[i])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ne("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function B1(r){var t=[];return t[t.length]=ne("cellXfs",null),r.forEach(function(e){t[t.length]=ne("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ne("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function zu(r,t){var e=[vt,ne("styleSheet",null,{xmlns:Ln[0],"xmlns:vt":Mt.vt})],i;return r.SSF&&(i=N1(r.SSF))!=null&&(e[e.length]=i),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=B1(t.cellXfs))&&(e[e.length]=i),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function V1(r,t){var e=r.read_shift(2),i=sr(r,t-2);return[e,i]}function $1(r,t,e){e||(e=H(6+4*t.length)),e.write_shift(2,r),Lt(t,e);var i=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),i}function H1(r,t,e){var i={};i.sz=r.read_shift(2)/20;var n=kg(r,2,e);n.fItalic&&(i.italic=1),n.fCondense&&(i.condense=1),n.fExtend&&(i.extend=1),n.fShadow&&(i.shadow=1),n.fOutline&&(i.outline=1),n.fStrikeout&&(i.strike=1);var s=r.read_shift(2);switch(s===700&&(i.bold=1),r.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var a=r.read_shift(1);a!=0&&(i.underline=a);var o=r.read_shift(1);o>0&&(i.family=o);var c=r.read_shift(1);switch(c>0&&(i.charset=c),r.l++,i.color=Ig(r,8),r.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=sr(r,t-21),i}function W1(r,t){t||(t=H(25+4*32)),t.write_shift(2,r.sz*20),Fg(r,t),t.write_shift(2,r.bold?700:400);var e=0;r.vertAlign=="superscript"?e=1:r.vertAlign=="subscript"&&(e=2),t.write_shift(2,e),t.write_shift(1,r.underline||0),t.write_shift(1,r.family||0),t.write_shift(1,r.charset||0),t.write_shift(1,0),Sa(r.color,t);var i=0;return r.scheme=="major"&&(i=1),r.scheme=="minor"&&(i=2),t.write_shift(1,i),Lt(r.name,t),t.length>t.l?t.slice(0,t.l):t}var z1=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],No,U1=ii;function B0(r,t){t||(t=H(4*3+8*7+16*1)),No||(No=jo(z1));var e=No[r.patternType];e==null&&(e=40),t.write_shift(4,e);var i=0;if(e!=40)for(Sa({auto:1},t),Sa({auto:1},t);i<12;++i)t.write_shift(4,0);else{for(;i<4;++i)t.write_shift(4,0);for(;i<12;++i)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function G1(r,t){var e=r.l+t,i=r.read_shift(2),n=r.read_shift(2);return r.l=e,{ixfe:i,numFmtId:n}}function Uu(r,t,e){e||(e=H(16)),e.write_shift(2,t||0),e.write_shift(2,r.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var i=0;return e.write_shift(1,i),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function fs(r,t){return t||(t=H(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var X1=ii;function j1(r,t){return t||(t=H(51)),t.write_shift(1,0),fs(null,t),fs(null,t),fs(null,t),fs(null,t),fs(null,t),t.length>t.l?t.slice(0,t.l):t}function K1(r,t){return t||(t=H(12+4*10)),t.write_shift(4,r.xfId),t.write_shift(2,1),t.write_shift(1,+r.builtinId),t.write_shift(1,0),Ta(r.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Y1(r,t,e){var i=H(2052);return i.write_shift(4,r),Ta(t,i),Ta(e,i),i.length>i.l?i.slice(0,i.l):i}function q1(r,t){if(t){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)t[n]!=null&&++e}),e!=0&&(Z(r,615,jr(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)t[n]!=null&&Z(r,44,$1(n,t[n]))}),Z(r,616))}}function Q1(r){var t=1;t!=0&&(Z(r,611,jr(t)),Z(r,43,W1({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Z(r,612))}function Z1(r){var t=2;t!=0&&(Z(r,603,jr(t)),Z(r,45,B0({patternType:"none"})),Z(r,45,B0({patternType:"gray125"})),Z(r,604))}function J1(r){var t=1;t!=0&&(Z(r,613,jr(t)),Z(r,46,j1({})),Z(r,614))}function ex(r){var t=1;Z(r,626,jr(t)),Z(r,47,Uu({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Z(r,627)}function tx(r,t){Z(r,617,jr(t.length)),t.forEach(function(e){Z(r,47,Uu(e,0))}),Z(r,618)}function rx(r){var t=1;Z(r,619,jr(t)),Z(r,48,K1({xfId:0,builtinId:0,name:"Normal"})),Z(r,620)}function ix(r){var t=0;Z(r,505,jr(t)),Z(r,506)}function nx(r){var t=0;Z(r,508,Y1(t,"TableStyleMedium9","PivotStyleMedium4")),Z(r,509)}function sx(r,t){var e=gr();return Z(e,278),q1(e,r.SSF),Q1(e,r),Z1(e,r),J1(e,r),ex(e,r),tx(e,t.cellXfs),rx(e,r),ix(e,r),nx(e,r),Z(e,279),e.end()}function Gu(r,t){if(t&&t.themeXLSX)return t.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var e=[vt];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function ax(r,t){return{flags:r.read_shift(4),version:r.read_shift(4),name:sr(r,t-8)}}function ox(r){var t=H(12+2*r.name.length);return t.write_shift(4,r.flags),t.write_shift(4,r.version),Lt(r.name,t),t.slice(0,t.l)}function lx(r){for(var t=[],e=r.read_shift(4);e-- >0;)t.push([r.read_shift(4),r.read_shift(4)]);return t}function cx(r){var t=H(4+8*r.length);t.write_shift(4,r.length);for(var e=0;e<r.length;++e)t.write_shift(4,r[e][0]),t.write_shift(4,r[e][1]);return t}function ux(r,t){var e=H(8+2*t.length);return e.write_shift(4,r),Lt(t,e),e.slice(0,e.l)}function hx(r){return r.l+=4,r.read_shift(4)!=0}function fx(r,t){var e=H(8);return e.write_shift(4,r),e.write_shift(4,t?1:0),e}function dx(){var r=gr();return Z(r,332),Z(r,334,jr(1)),Z(r,335,ox({name:"XLDAPR",version:12e4,flags:3496657072})),Z(r,336),Z(r,339,ux(1,"XLDAPR")),Z(r,52),Z(r,35,jr(514)),Z(r,4096,jr(0)),Z(r,4097,Rr(1)),Z(r,36),Z(r,53),Z(r,340),Z(r,337,fx(1,!0)),Z(r,51,cx([[1,0]])),Z(r,338),Z(r,333),r.end()}function Xu(){var r=[vt];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function px(r){var t={};t.i=r.read_shift(4);var e={};e.r=r.read_shift(4),e.c=r.read_shift(4),t.r=Qe(e);var i=r.read_shift(1);return i&2&&(t.l="1"),i&8&&(t.a="1"),t}var In=1024;function ju(r,t){for(var e=[21600,21600],i=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),n=[ne("xml",null,{"xmlns:v":Fr.v,"xmlns:o":Fr.o,"xmlns:x":Fr.x,"xmlns:mv":Fr.mv}).replace(/\/>/,">"),ne("o:shapelayout",ne("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),ne("v:shapetype",[ne("v:stroke",null,{joinstyle:"miter"}),ne("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:i})];In<r*1e3;)In+=1e3;return t.forEach(function(s){var a=Pt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ne("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=ne("v:fill",c,o),u={on:"t",obscured:"t"};++In,n=n.concat(["<v:shape"+Cs({id:"_x0000_s"+In,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,ne("v:shadow",null,u),ne("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Kt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Kt("x:AutoFill","False"),Kt("x:Row",String(a.r)),Kt("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function Ku(r){var t=[vt,ne("comments",null,{xmlns:Ln[0]})],e=[];return t.push("<authors>"),r.forEach(function(i){i[1].forEach(function(n){var s=qe(n.a);e.indexOf(s)==-1&&(e.push(s),t.push("<author>"+s+"</author>")),n.T&&n.ID&&e.indexOf("tc="+n.ID)==-1&&(e.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),r.forEach(function(i){var n=0,s=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?n=e.indexOf("tc="+i[1][0].ID):i[1].forEach(function(c){c.a&&(n=e.indexOf(qe(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+i[0]+'" authorId="'+n+'"><text>'),s.length<=1)t.push(Kt("t",qe(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(Kt("t",qe(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function mx(r,t,e){var i=[vt,ne("ThreadedComments",null,{xmlns:Mt.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(n){var s="";(n[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),i.push(ne("threadedComment",Kt("text",a.t||""),c))})}),i.push("</ThreadedComments>"),i.join("")}function gx(r){var t=[vt,ne("personList",null,{xmlns:Mt.TCMNT,"xmlns:x":Ln[0]}).replace(/[\/]>/,">")];return r.forEach(function(e,i){t.push(ne("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function xx(r){var t={};t.iauthor=r.read_shift(4);var e=Zi(r,16);return t.rfx=e.s,t.ref=Qe(e.s),r.l+=16,t}function _x(r,t){return t==null&&(t=H(36)),t.write_shift(4,r[1].iauthor),Bn(r[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var vx=sr;function yx(r){return Lt(r.slice(0,54))}function wx(r){var t=gr(),e=[];return Z(t,628),Z(t,630),r.forEach(function(i){i[1].forEach(function(n){e.indexOf(n.a)>-1||(e.push(n.a.slice(0,54)),Z(t,632,yx(n.a)))})}),Z(t,631),Z(t,633),r.forEach(function(i){i[1].forEach(function(n){n.iauthor=e.indexOf(n.a);var s={s:Pt(i[0]),e:Pt(i[0])};Z(t,635,_x([s,n])),n.t&&n.t.length>0&&Z(t,637,Cg(n)),Z(t,636),delete n.iauthor})}),Z(t,634),Z(t,629),t.end()}function bx(r,t){t.FullPaths.forEach(function(e,i){if(i!=0){var n=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Je.utils.cfb_add(r,n,t.FileIndex[i].content)}})}var Yu=["xlsb","xlsm","xlam","biff8","xla"];var Cx=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(i,n,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,c?l+=t.r:--l,n+(o?"":"$")+nr(u)+(c?"":"$")+Yt(l)}return function(n,s){return t=s,n.replace(r,e)}}(),ul=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,hl=function(){return function(t,e){return t.replace(ul,function(i,n,s,a,o,c){var l=nl(a)-(s?0:e.c),u=il(c)-(o?0:e.r),h=u==0?"":o?u+1:"["+u+"]",f=l==0?"":s?l+1:"["+l+"]";return n+"R"+h+"C"+f})}}();function Tx(r,t){return r.replace(ul,function(e,i,n,s,a,o){return i+(n=="$"?n+s:nr(nl(s)+t.c))+(a=="$"?a+o:Yt(il(o)+t.r))})}function Sx(r){return r.length!=1}function xt(r){r.l+=1}function Fi(r,t){var e=r.read_shift(t==1?1:2);return[e&16383,e>>14&1,e>>15&1]}function qu(r,t,e){var i=2;if(e){if(e.biff>=2&&e.biff<=5)return Qu(r,t,e);e.biff==12&&(i=4)}var n=r.read_shift(i),s=r.read_shift(i),a=Fi(r,2),o=Fi(r,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Qu(r){var t=Fi(r,2),e=Fi(r,2),i=r.read_shift(1),n=r.read_shift(1);return{s:{r:t[0],c:i,cRel:t[1],rRel:t[2]},e:{r:e[0],c:n,cRel:e[1],rRel:e[2]}}}function Ex(r,t,e){if(e.biff<8)return Qu(r,t,e);var i=r.read_shift(e.biff==12?4:2),n=r.read_shift(e.biff==12?4:2),s=Fi(r,2),a=Fi(r,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:a[0],cRel:a[1],rRel:a[2]}}}function Zu(r,t,e){if(e&&e.biff>=2&&e.biff<=5)return Ix(r,t,e);var i=r.read_shift(e&&e.biff==12?4:2),n=Fi(r,2);return{r:i,c:n[0],cRel:n[1],rRel:n[2]}}function Ix(r){var t=Fi(r,2),e=r.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function kx(r){var t=r.read_shift(2),e=r.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function Fx(r,t,e){var i=e&&e.biff?e.biff:8;if(i>=2&&i<=5)return Ox(r,t,e);var n=r.read_shift(i>=12?4:2),s=r.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;n>524287;)n-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:a,rRel:o}}function Ox(r){var t=r.read_shift(2),e=r.read_shift(1),i=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,i==1&&t>=8192&&(t=t-16384),n==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:n,rRel:i}}function Ax(r,t,e){var i=(r[r.l++]&96)>>5,n=qu(r,e.biff>=2&&e.biff<=5?6:8,e);return[i,n]}function Dx(r,t,e){var i=(r[r.l++]&96)>>5,n=r.read_shift(2,"i"),s=8;if(e)switch(e.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var a=qu(r,s,e);return[i,n,a]}function Mx(r,t,e){var i=(r[r.l++]&96)>>5;return r.l+=e&&e.biff>8?12:e.biff<8?6:8,[i]}function Px(r,t,e){var i=(r[r.l++]&96)>>5,n=r.read_shift(2),s=8;if(e)switch(e.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[i,n]}function Lx(r,t,e){var i=(r[r.l++]&96)>>5,n=Ex(r,t-1,e);return[i,n]}function Rx(r,t,e){var i=(r[r.l++]&96)>>5;return r.l+=e.biff==2?6:e.biff==12?14:7,[i]}function V0(r){var t=r[r.l+1]&1,e=1;return r.l+=4,[t,e]}function Nx(r,t,e){r.l+=2;for(var i=r.read_shift(e&&e.biff==2?1:2),n=[],s=0;s<=i;++s)n.push(r.read_shift(e&&e.biff==2?1:2));return n}function Bx(r,t,e){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(e&&e.biff==2?1:2)]}function Vx(r,t,e){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(e&&e.biff==2?1:2)]}function $x(r){var t=r[r.l+1]&255?1:0;return r.l+=2,[t,r.read_shift(2)]}function Hx(r,t,e){var i=r[r.l+1]&255?1:0;return r.l+=e&&e.biff==2?3:4,[i]}function Ju(r){var t=r.read_shift(1),e=r.read_shift(1);return[t,e]}function Wx(r){return r.read_shift(2),Ju(r,2)}function zx(r){return r.read_shift(2),Ju(r,2)}function Ux(r,t,e){var i=(r[r.l]&96)>>5;r.l+=1;var n=Zu(r,0,e);return[i,n]}function Gx(r,t,e){var i=(r[r.l]&96)>>5;r.l+=1;var n=Fx(r,0,e);return[i,n]}function Xx(r,t,e){var i=(r[r.l]&96)>>5;r.l+=1;var n=r.read_shift(2);e&&e.biff==5&&(r.l+=12);var s=Zu(r,0,e);return[i,n,s]}function jx(r,t,e){var i=(r[r.l]&96)>>5;r.l+=1;var n=r.read_shift(e&&e.biff<=3?1:2);return[j_[n],rh[n],i]}function Kx(r,t,e){var i=r[r.l++],n=r.read_shift(1),s=e&&e.biff<=3?[i==88?-1:0,r.read_shift(1)]:Yx(r);return[n,(s[0]===0?rh:X_)[s[1]]]}function Yx(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function qx(r,t,e){r.l+=e&&e.biff==2?3:4}function Qx(r,t,e){if(r.l++,e&&e.biff==12)return[r.read_shift(4,"i"),0];var i=r.read_shift(2),n=r.read_shift(e&&e.biff==2?1:2);return[i,n]}function Zx(r){return r.l++,ks[r.read_shift(1)]}function Jx(r){return r.l++,r.read_shift(2)}function e_(r){return r.l++,r.read_shift(1)!==0}function t_(r){return r.l++,Vn(r,8)}function r_(r,t,e){return r.l++,Lu(r,t-1,e)}function i_(r,t){var e=[r.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=Xg(r,1)?"TRUE":"FALSE",t!=12&&(r.l+=7);break;case 37:case 16:e[1]=ks[r[r.l]],r.l+=t==12?4:8;break;case 0:r.l+=8;break;case 1:e[1]=Vn(r,8);break;case 2:e[1]=qg(r,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function n_(r,t,e){for(var i=r.read_shift(e.biff==12?4:2),n=[],s=0;s!=i;++s)n.push((e.biff==12?Zi:Jg)(r,8));return n}function s_(r,t,e){var i=0,n=0;e.biff==12?(i=r.read_shift(4),n=r.read_shift(4)):(n=1+r.read_shift(1),i=1+r.read_shift(2)),e.biff>=2&&e.biff<8&&(--i,--n==0&&(n=256));for(var s=0,a=[];s!=i&&(a[s]=[]);++s)for(var o=0;o!=n;++o)a[s][o]=i_(r,e.biff);return a}function a_(r,t,e){var i=r.read_shift(1)>>>5&3,n=!e||e.biff>=8?4:2,s=r.read_shift(n);switch(e.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[i,0,s]}function o_(r,t,e){if(e.biff==5)return l_(r,t,e);var i=r.read_shift(1)>>>5&3,n=r.read_shift(2),s=r.read_shift(4);return[i,n,s]}function l_(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2,"i");r.l+=8;var i=r.read_shift(2);return r.l+=12,[t,e,i]}function c_(r,t,e){var i=r.read_shift(1)>>>5&3;r.l+=e&&e.biff==2?3:4;var n=r.read_shift(e&&e.biff==2?1:2);return[i,n]}function u_(r,t,e){var i=r.read_shift(1)>>>5&3,n=r.read_shift(e&&e.biff==2?1:2);return[i,n]}function h_(r,t,e){var i=r.read_shift(1)>>>5&3;return r.l+=4,e.biff<8&&r.l--,e.biff==12&&(r.l+=2),[i]}function f_(r,t,e){var i=(r[r.l++]&96)>>5,n=r.read_shift(2),s=4;if(e)switch(e.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[i,n]}var d_=ii,p_=ii,m_=ii;function Fs(r,t,e){return r.l+=2,[kx(r,4,e)]}function fl(r){return r.l+=6,[]}var g_=Fs,x_=fl,__=fl,v_=Fs;function eh(r){return r.l+=2,[Mu(r),r.read_shift(2)&1]}var y_=Fs,w_=eh,b_=fl,C_=Fs,T_=Fs,S_=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function E_(r){r.l+=2;var t=r.read_shift(2),e=r.read_shift(2),i=r.read_shift(4),n=r.read_shift(2),s=r.read_shift(2),a=S_[e>>2&31];return{ixti:t,coltype:e&3,rt:a,idx:i,c:n,C:s}}function I_(r){return r.l+=2,[r.read_shift(4)]}function k_(r,t,e){return r.l+=5,r.l+=2,r.l+=e.biff==2?1:4,["PTGSHEET"]}function F_(r,t,e){return r.l+=e.biff==2?4:5,["PTGENDSHEET"]}function O_(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2);return[t,e]}function A_(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2);return[t,e]}function D_(r){return r.l+=4,[0,0]}var $0={1:{n:"PtgExp",f:Qx},2:{n:"PtgTbl",f:m_},3:{n:"PtgAdd",f:xt},4:{n:"PtgSub",f:xt},5:{n:"PtgMul",f:xt},6:{n:"PtgDiv",f:xt},7:{n:"PtgPower",f:xt},8:{n:"PtgConcat",f:xt},9:{n:"PtgLt",f:xt},10:{n:"PtgLe",f:xt},11:{n:"PtgEq",f:xt},12:{n:"PtgGe",f:xt},13:{n:"PtgGt",f:xt},14:{n:"PtgNe",f:xt},15:{n:"PtgIsect",f:xt},16:{n:"PtgUnion",f:xt},17:{n:"PtgRange",f:xt},18:{n:"PtgUplus",f:xt},19:{n:"PtgUminus",f:xt},20:{n:"PtgPercent",f:xt},21:{n:"PtgParen",f:xt},22:{n:"PtgMissArg",f:xt},23:{n:"PtgStr",f:r_},26:{n:"PtgSheet",f:k_},27:{n:"PtgEndSheet",f:F_},28:{n:"PtgErr",f:Zx},29:{n:"PtgBool",f:e_},30:{n:"PtgInt",f:Jx},31:{n:"PtgNum",f:t_},32:{n:"PtgArray",f:Rx},33:{n:"PtgFunc",f:jx},34:{n:"PtgFuncVar",f:Kx},35:{n:"PtgName",f:a_},36:{n:"PtgRef",f:Ux},37:{n:"PtgArea",f:Ax},38:{n:"PtgMemArea",f:c_},39:{n:"PtgMemErr",f:d_},40:{n:"PtgMemNoMem",f:p_},41:{n:"PtgMemFunc",f:u_},42:{n:"PtgRefErr",f:h_},43:{n:"PtgAreaErr",f:Mx},44:{n:"PtgRefN",f:Gx},45:{n:"PtgAreaN",f:Lx},46:{n:"PtgMemAreaN",f:O_},47:{n:"PtgMemNoMemN",f:A_},57:{n:"PtgNameX",f:o_},58:{n:"PtgRef3d",f:Xx},59:{n:"PtgArea3d",f:Dx},60:{n:"PtgRefErr3d",f:f_},61:{n:"PtgAreaErr3d",f:Px},255:{}},M_={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},P_={1:{n:"PtgElfLel",f:eh},2:{n:"PtgElfRw",f:C_},3:{n:"PtgElfCol",f:g_},6:{n:"PtgElfRwV",f:T_},7:{n:"PtgElfColV",f:v_},10:{n:"PtgElfRadical",f:y_},11:{n:"PtgElfRadicalS",f:b_},13:{n:"PtgElfColS",f:x_},15:{n:"PtgElfColSV",f:__},16:{n:"PtgElfRadicalLel",f:w_},25:{n:"PtgList",f:E_},29:{n:"PtgSxName",f:I_},255:{}},L_={0:{n:"PtgAttrNoop",f:D_},1:{n:"PtgAttrSemi",f:Hx},2:{n:"PtgAttrIf",f:Vx},4:{n:"PtgAttrChoose",f:Nx},8:{n:"PtgAttrGoto",f:Bx},16:{n:"PtgAttrSum",f:qx},32:{n:"PtgAttrBaxcel",f:V0},33:{n:"PtgAttrBaxcel",f:V0},64:{n:"PtgAttrSpace",f:Wx},65:{n:"PtgAttrSpaceSemi",f:zx},128:{n:"PtgAttrIfError",f:$x},255:{}};function R_(r,t,e,i){if(i.biff<8)return ii(r,t);for(var n=r.l+t,s=[],a=0;a!==e.length;++a)switch(e[a][0]){case"PtgArray":e[a][1]=s_(r,0,i),s.push(e[a][1]);break;case"PtgMemArea":e[a][2]=n_(r,e[a][1],i),s.push(e[a][2]);break;case"PtgExp":i&&i.biff==12&&(e[a][1][1]=r.read_shift(4),s.push(e[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[a][0];default:break}return t=n-r.l,t!==0&&s.push(ii(r,t)),s}function N_(r,t,e){for(var i=r.l+t,n,s,a=[];i!=r.l;)t=i-r.l,s=r[r.l],n=$0[s]||$0[M_[s]],(s===24||s===25)&&(n=(s===24?P_:L_)[r[r.l+1]]),!n||!n.f?ii(r,t):a.push([n.n,n.f(r,t,e)]);return a}function B_(r){for(var t=[],e=0;e<r.length;++e){for(var i=r[e],n=[],s=0;s<i.length;++s){var a=i[s];if(a)switch(a[0]){case 2:n.push('"'+a[1].replace(/"/g,'""')+'"');break;default:n.push(a[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var V_={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $_(r,t){if(!r&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function th(r,t,e){if(!r)return"SH33TJSERR0";if(e.biff>8&&(!r.XTI||!r.XTI[t]))return r.SheetNames[t];if(!r.XTI)return"SH33TJSERR6";var i=r.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":r.XTI[t-1];if(!i)return"SH33TJSERR1";var n="";if(e.biff>8)switch(r[i[0]][0]){case 357:return n=i[1]==-1?"#REF":r.SheetNames[i[1]],i[1]==i[2]?n:n+":"+r.SheetNames[i[2]];case 358:return e.SID!=null?r.SheetNames[e.SID]:"SH33TJSSAME"+r[i[0]][0];case 355:default:return"SH33TJSSRC"+r[i[0]][0]}switch(r[i[0]][0][0]){case 1025:return n=i[1]==-1?"#REF":r.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?n:n+":"+r.SheetNames[i[2]];case 14849:return r[i[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[i[0]][0][3]?(n=i[1]==-1?"#REF":r[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?n:n+":"+r[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function H0(r,t,e){var i=th(r,t,e);return i=="#REF"?i:$_(i,e)}function Pn(r,t,e,i,n){var s=n&&n.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,u,h=0,f=0,d,g="";if(!r[0]||!r[0][0])return"";for(var p=-1,x="",O=0,A=r[0].length;O<A;++O){var D=r[0][O];switch(D[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),p>=0){switch(r[0][p][1][0]){case 0:x=ht(" ",r[0][p][1][1]);break;case 1:x=ht("\r",r[0][p][1][1]);break;default:if(x="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][p][1][0])}l=l+x,p=-1}o.push(l+V_[D[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=gs(D[1][1],a,n),o.push(xs(u,s));break;case"PtgRefN":u=e?gs(D[1][1],e,n):D[1][1],o.push(xs(u,s));break;case"PtgRef3d":h=D[1][1],u=gs(D[1][2],a,n),g=H0(i,h,n);var G=g;o.push(g+"!"+xs(u,s));break;case"PtgFunc":case"PtgFuncVar":var te=D[1][0],me=D[1][1];te||(te=0),te&=127;var M=te==0?[]:o.slice(-te);o.length-=te,me==="User"&&(me=M.shift()),o.push(me+"("+M.join(",")+")");break;case"PtgBool":o.push(D[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(D[1]);break;case"PtgNum":o.push(String(D[1]));break;case"PtgStr":o.push('"'+D[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(D[1]);break;case"PtgAreaN":d=S0(D[1][1],e?{s:e}:a,n),o.push(Lo(d,n));break;case"PtgArea":d=S0(D[1][1],a,n),o.push(Lo(d,n));break;case"PtgArea3d":h=D[1][1],d=D[1][2],g=H0(i,h,n),o.push(g+"!"+Lo(d,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=D[1][2];var Q=(i.names||[])[f-1]||(i[0]||[])[f],U=Q?Q.Name:"SH33TJSNAME"+String(f);U&&U.slice(0,6)=="_xlfn."&&!n.xlfn&&(U=U.slice(6)),o.push(U);break;case"PtgNameX":var q=D[1][1];f=D[1][2];var ee;if(n.biff<=5)q<0&&(q=-q),i[q]&&(ee=i[q][f]);else{var re="";if(((i[q]||[])[0]||[])[0]==14849||(((i[q]||[])[0]||[])[0]==1025?i[q][f]&&i[q][f].itab>0&&(re=i.SheetNames[i[q][f].itab-1]+"!"):re=i.SheetNames[f-1]+"!"),i[q]&&i[q][f])re+=i[q][f].Name;else if(i[0]&&i[0][f])re+=i[0][f].Name;else{var Ce=(th(i,q,n)||"").split(";;");Ce[f-1]?re=Ce[f-1]:re+="SH33TJSERRX"}o.push(re);break}ee||(ee={Name:"SH33TJSERRY"}),o.push(ee.Name);break;case"PtgParen":var je="(",Te=")";if(p>=0){switch(x="",r[0][p][1][0]){case 2:je=ht(" ",r[0][p][1][1])+je;break;case 3:je=ht("\r",r[0][p][1][1])+je;break;case 4:Te=ht(" ",r[0][p][1][1])+Te;break;case 5:Te=ht("\r",r[0][p][1][1])+Te;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][p][1][0])}p=-1}o.push(je+o.pop()+Te);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:D[1][1],r:D[1][0]};var It={c:e.c,r:e.r};if(i.sharedf[Qe(u)]){var kt=i.sharedf[Qe(u)];o.push(Pn(kt,a,It,i,n))}else{var hr=!1;for(c=0;c!=i.arrayf.length;++c)if(l=i.arrayf[c],!(u.c<l[0].s.c||u.c>l[0].e.c)&&!(u.r<l[0].s.r||u.r>l[0].e.r)){o.push(Pn(l[1],a,It,i,n)),hr=!0;break}hr||o.push(D[1])}break;case"PtgArray":o.push("{"+B_(D[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=O;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+D[1].idx+"[#"+D[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(D));default:throw new Error("Unrecognized Formula Token: "+String(D))}var ar=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&ar.indexOf(r[0][O][0])==-1){D=r[0][p];var Rt=!0;switch(D[1][0]){case 4:Rt=!1;case 0:x=ht(" ",D[1][1]);break;case 5:Rt=!1;case 1:x=ht("\r",D[1][1]);break;default:if(x="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+D[1][0])}o.push((Rt?x:"")+o.pop()+(Rt?"":x)),p=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function H_(r){if(r==null){var t=H(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof r=="number")return Xi(r);return Xi(0)}function W_(r,t,e,i,n){var s=ji(t,e,n),a=H_(r.v),o=H(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=H(r.bf.length),u=0;u<r.bf.length;++u)l[u]=r.bf[u];var h=jt([s,a,o,l]);return h}function Ba(r,t,e){var i=r.read_shift(4),n=N_(r,i,e),s=r.read_shift(4),a=s>0?R_(r,s,n,e):null;return[n,a]}var z_=Ba,Va=Ba,U_=Ba,G_=Ba,X_={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},rh={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},j_={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function K_(r){var t="of:="+r.replace(ul,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Y_(r){return r.replace(/\./,"!")}var _s=typeof Map<"u";function dl(r,t,e){var i=0,n=r.length;if(e){if(_s?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var s=_s?e.get(t):e[t];i<s.length;++i)if(r[s[i]].t===t)return r.Count++,s[i]}}else for(;i<n;++i)if(r[i].t===t)return r.Count++,i;return r[n]={t},r.Count++,r.Unique++,e&&(_s?(e.has(t)||e.set(t,[]),e.get(t).push(n)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(n))),n}function $a(r,t){var e={min:r+1,max:r+1},i=-1;return t.MDW&&(pi=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?i=ka(t.wpx):t.wch!=null&&(i=t.wch),i>-1?(e.width=Uo(i),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function ih(r,t){if(r){var e=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(e=[1,1,1,1,.5,.5]),r.left==null&&(r.left=e[0]),r.right==null&&(r.right=e[1]),r.top==null&&(r.top=e[2]),r.bottom==null&&(r.bottom=e[3]),r.header==null&&(r.header=e[4]),r.footer==null&&(r.footer=e[5])}}function Ai(r,t,e){var i=e.revssf[t.z!=null?t.z:"General"],n=60,s=r.length;if(i==null&&e.ssf){for(;n<392;++n)if(e.ssf[n]==null){iu(t.z,n),e.ssf[n]=t.z,e.revssf[t.z]=i=n;break}}for(n=0;n!=s;++n)if(r[n].numFmtId===i)return n;return r[s]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function q_(r,t,e){if(r&&r["!ref"]){var i=st(r["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+e+"): "+r["!ref"])}}function Q_(r){if(r.length===0)return"";for(var t='<mergeCells count="'+r.length+'">',e=0;e!=r.length;++e)t+='<mergeCell ref="'+_t(r[e])+'"/>';return t+"</mergeCells>"}function Z_(r,t,e,i,n){var s=!1,a={},o=null;if(i.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[e];try{t.Workbook&&(c=t.Workbook.Sheets[e].CodeName||c)}catch{}s=!0,a.codeName=hi(qe(c))}if(r&&r["!outline"]){var l={summaryBelow:1,summaryRight:1};r["!outline"].above&&(l.summaryBelow=0),r["!outline"].left&&(l.summaryRight=0),o=(o||"")+ne("outlinePr",null,l)}!s&&!o||(n[n.length]=ne("sheetPr",o,a))}var J_=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ev=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function tv(r){var t={sheet:1};return J_.forEach(function(e){r[e]!=null&&r[e]&&(t[e]="1")}),ev.forEach(function(e){r[e]!=null&&!r[e]&&(t[e]="0")}),r.password&&(t.password=$u(r.password).toString(16).toUpperCase()),ne("sheetProtection",null,t)}function rv(r){return ih(r),ne("pageMargins",null,r)}function iv(r,t){for(var e=["<cols>"],i,n=0;n!=t.length;++n)(i=t[n])&&(e[e.length]=ne("col",null,$a(n,i)));return e[e.length]="</cols>",e.join("")}function nv(r,t,e,i){var n=typeof r.ref=="string"?r.ref:_t(r.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var s=e.Workbook.Names,a=Or(n);a.s.r==a.e.r&&(a.e.r=Or(t["!ref"]).e.r,n=_t(a));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==i){c.Ref="'"+e.SheetNames[i]+"'!"+n;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+n}),ne("autoFilter",null,{ref:n})}function sv(r,t,e,i){var n={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),ne("sheetViews",ne("sheetView",null,n),{})}function av(r,t,e,i){if(r.c&&e["!comments"].push([t,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var n="",s=r.t,a=r.v;if(r.t!=="z")switch(r.t){case"b":n=r.v?"1":"0";break;case"n":n=""+r.v;break;case"e":n=ks[r.v];break;case"d":i&&i.cellDates?n=ur(r.v,-1).toISOString():(r=_r(r),r.t="n",n=""+(r.v=xr(ur(r.v)))),typeof r.z>"u"&&(r.z=ft[14]);break;default:n=r.v;break}var o=Kt("v",qe(n)),c={r:t},l=Ai(i.cellXfs,r,i);switch(l!==0&&(c.s=l),r.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){o=Kt("v",""+dl(i.Strings,r.v,i.revStrings)),c.t="s";break}c.t="str";break}if(r.t!=s&&(r.t=s,r.v=a),typeof r.f=="string"&&r.f){var u=r.F&&r.F.slice(0,t.length)==t?{t:"array",ref:r.F}:null;o=ne("f",qe(r.f),u)+(r.v!=null?o:"")}return r.l&&e["!links"].push([t,r.l]),r.D&&(c.cm=1),ne("c",o,c)}function ov(r,t,e,i){var n=[],s=[],a=st(r["!ref"]),o="",c,l="",u=[],h=0,f=0,d=r["!rows"],g=Array.isArray(r),p={r:l},x,O=-1;for(f=a.s.c;f<=a.e.c;++f)u[f]=nr(f);for(h=a.s.r;h<=a.e.r;++h){for(s=[],l=Yt(h),f=a.s.c;f<=a.e.c;++f){c=u[f]+l;var A=g?(r[h]||[])[f]:r[c];A!==void 0&&(o=av(A,c,r,t,e,i))!=null&&s.push(o)}(s.length>0||d&&d[h])&&(p={r:l},d&&d[h]&&(x=d[h],x.hidden&&(p.hidden=1),O=-1,x.hpx?O=Fa(x.hpx):x.hpt&&(O=x.hpt),O>-1&&(p.ht=O,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),n[n.length]=ne("row",s.join(""),p))}if(d)for(;h<d.length;++h)d&&d[h]&&(p={r:h+1},x=d[h],x.hidden&&(p.hidden=1),O=-1,x.hpx?O=Fa(x.hpx):x.hpt&&(O=x.hpt),O>-1&&(p.ht=O,p.customHeight=1),x.level&&(p.outlineLevel=x.level),n[n.length]=ne("row","",p));return n.join("")}function nh(r,t,e,i){var n=[vt,ne("worksheet",null,{xmlns:Ln[0],"xmlns:r":Mt.r})],s=e.SheetNames[r],a=0,o="",c=e.Sheets[s];c==null&&(c={});var l=c["!ref"]||"A1",u=st(l);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),l=_t(u)}i||(i={}),c["!comments"]=[];var h=[];Z_(c,e,r,t,n),n[n.length]=ne("dimension",null,{ref:l}),n[n.length]=sv(c,t,r,e),t.sheetFormat&&(n[n.length]=ne("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=iv(c,c["!cols"])),n[a=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=ov(c,t,r,e,i),o.length>0&&(n[n.length]=o)),n.length>a+1&&(n[n.length]="</sheetData>",n[a]=n[a].replace("/>",">")),c["!protect"]&&(n[n.length]=tv(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=nv(c["!autofilter"],c,e,r)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=Q_(c["!merges"]));var f=-1,d,g=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(d={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=Ye(i,-1,qe(p[1].Target).replace(/#.*$/,""),Ge.HLINK),d["r:id"]="rId"+g),(f=p[1].Target.indexOf("#"))>-1&&(d.location=qe(p[1].Target.slice(f+1))),p[1].Tooltip&&(d.tooltip=qe(p[1].Tooltip)),n[n.length]=ne("hyperlink",null,d))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=rv(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=Kt("ignoredErrors",ne("ignoredError",null,{numberStoredAsText:1,sqref:l}))),h.length>0&&(g=Ye(i,-1,"../drawings/drawing"+(r+1)+".xml",Ge.DRAW),n[n.length]=ne("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=h),c["!comments"].length>0&&(g=Ye(i,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ge.VML),n[n.length]=ne("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function lv(r,t){var e={},i=r.l+t;e.r=r.read_shift(4),r.l+=4;var n=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=i,s&7&&(e.level=s&7),s&16&&(e.hidden=!0),s&32&&(e.hpt=n/20),e}function cv(r,t,e){var i=H(145),n=(e["!rows"]||[])[r]||{};i.write_shift(4,r),i.write_shift(4,0);var s=320;n.hpx?s=Fa(n.hpx)*20:n.hpt&&(s=n.hpt*20),i.write_shift(2,s),i.write_shift(1,0);var a=0;n.level&&(a|=n.level),n.hidden&&(a|=16),(n.hpx||n.hpt)&&(a|=32),i.write_shift(1,a),i.write_shift(1,0);var o=0,c=i.l;i.l+=4;for(var l={r,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,f=-1,d=u<<10;d<u+1<<10;++d){l.c=d;var g=Array.isArray(e)?(e[l.r]||[])[l.c]:e[Qe(l)];g&&(h<0&&(h=d),f=d)}h<0||(++o,i.write_shift(4,h),i.write_shift(4,f))}var p=i.l;return i.l=c,i.write_shift(4,o),i.l=p,i.length>i.l?i.slice(0,i.l):i}function uv(r,t,e,i){var n=cv(i,e,t);(n.length>17||(t["!rows"]||[])[i])&&Z(r,0,n)}var hv=Zi,fv=Bn;function dv(){}function pv(r,t){var e={},i=r[r.l];return++r.l,e.above=!(i&64),e.left=!(i&128),r.l+=18,e.name=Tg(r,t-19),e}function mv(r,t,e){e==null&&(e=H(84+4*r.length));var i=192;t&&(t.above&&(i&=-65),t.left&&(i&=-129)),e.write_shift(1,i);for(var n=1;n<3;++n)e.write_shift(1,0);return Sa({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),vu(r,e),e.slice(0,e.l)}function gv(r){var t=Nr(r);return[t]}function xv(r,t,e){return e==null&&(e=H(8)),Yi(t,e)}function _v(r){var t=qi(r);return[t]}function vv(r,t,e){return e==null&&(e=H(4)),Qi(t,e)}function yv(r){var t=Nr(r),e=r.read_shift(1);return[t,e,"b"]}function wv(r,t,e){return e==null&&(e=H(9)),Yi(t,e),e.write_shift(1,r.v?1:0),e}function bv(r){var t=qi(r),e=r.read_shift(1);return[t,e,"b"]}function Cv(r,t,e){return e==null&&(e=H(5)),Qi(t,e),e.write_shift(1,r.v?1:0),e}function Tv(r){var t=Nr(r),e=r.read_shift(1);return[t,e,"e"]}function Sv(r,t,e){return e==null&&(e=H(9)),Yi(t,e),e.write_shift(1,r.v),e}function Ev(r){var t=qi(r),e=r.read_shift(1);return[t,e,"e"]}function Iv(r,t,e){return e==null&&(e=H(8)),Qi(t,e),e.write_shift(1,r.v),e.write_shift(2,0),e.write_shift(1,0),e}function kv(r){var t=Nr(r),e=r.read_shift(4);return[t,e,"s"]}function Fv(r,t,e){return e==null&&(e=H(12)),Yi(t,e),e.write_shift(4,t.v),e}function Ov(r){var t=qi(r),e=r.read_shift(4);return[t,e,"s"]}function Av(r,t,e){return e==null&&(e=H(8)),Qi(t,e),e.write_shift(4,t.v),e}function Dv(r){var t=Nr(r),e=Vn(r);return[t,e,"n"]}function Mv(r,t,e){return e==null&&(e=H(16)),Yi(t,e),Xi(r.v,e),e}function Pv(r){var t=qi(r),e=Vn(r);return[t,e,"n"]}function Lv(r,t,e){return e==null&&(e=H(12)),Qi(t,e),Xi(r.v,e),e}function Rv(r){var t=Nr(r),e=yu(r);return[t,e,"n"]}function Nv(r,t,e){return e==null&&(e=H(12)),Yi(t,e),wu(r.v,e),e}function Bv(r){var t=qi(r),e=yu(r);return[t,e,"n"]}function Vv(r,t,e){return e==null&&(e=H(8)),Qi(t,e),wu(r.v,e),e}function $v(r){var t=Nr(r),e=sl(r);return[t,e,"is"]}function Hv(r){var t=Nr(r),e=sr(r);return[t,e,"str"]}function Wv(r,t,e){return e==null&&(e=H(12+4*r.v.length)),Yi(t,e),Lt(r.v,e),e.length>e.l?e.slice(0,e.l):e}function zv(r){var t=qi(r),e=sr(r);return[t,e,"str"]}function Uv(r,t,e){return e==null&&(e=H(8+4*r.v.length)),Qi(t,e),Lt(r.v,e),e.length>e.l?e.slice(0,e.l):e}function Gv(r,t,e){var i=r.l+t,n=Nr(r);n.r=e["!row"];var s=r.read_shift(1),a=[n,s,"b"];if(e.cellFormula){r.l+=2;var o=Va(r,i-r.l,e);a[3]=Pn(o,null,n,e.supbooks,e)}else r.l=i;return a}function Xv(r,t,e){var i=r.l+t,n=Nr(r);n.r=e["!row"];var s=r.read_shift(1),a=[n,s,"e"];if(e.cellFormula){r.l+=2;var o=Va(r,i-r.l,e);a[3]=Pn(o,null,n,e.supbooks,e)}else r.l=i;return a}function jv(r,t,e){var i=r.l+t,n=Nr(r);n.r=e["!row"];var s=Vn(r),a=[n,s,"n"];if(e.cellFormula){r.l+=2;var o=Va(r,i-r.l,e);a[3]=Pn(o,null,n,e.supbooks,e)}else r.l=i;return a}function Kv(r,t,e){var i=r.l+t,n=Nr(r);n.r=e["!row"];var s=sr(r),a=[n,s,"str"];if(e.cellFormula){r.l+=2;var o=Va(r,i-r.l,e);a[3]=Pn(o,null,n,e.supbooks,e)}else r.l=i;return a}var Yv=Zi,qv=Bn;function Qv(r,t){return t==null&&(t=H(4)),t.write_shift(4,r),t}function Zv(r,t){var e=r.l+t,i=Zi(r,16),n=al(r),s=sr(r),a=sr(r),o=sr(r);r.l=e;var c={rfx:i,relId:n,loc:s,display:o};return a&&(c.Tooltip=a),c}function Jv(r,t){var e=H(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));Bn({s:Pt(r[0]),e:Pt(r[0])},e),ol("rId"+t,e);var i=r[1].Target.indexOf("#"),n=i==-1?"":r[1].Target.slice(i+1);return Lt(n||"",e),Lt(r[1].Tooltip||"",e),Lt("",e),e.slice(0,e.l)}function ey(){}function ty(r,t,e){var i=r.l+t,n=bu(r,16),s=r.read_shift(1),a=[n];if(a[2]=s,e.cellFormula){var o=z_(r,i-r.l,e);a[1]=o}else r.l=i;return a}function ry(r,t,e){var i=r.l+t,n=Zi(r,16),s=[n];if(e.cellFormula){var a=G_(r,i-r.l,e);s[1]=a,r.l=i}else r.l=i;return s}function iy(r,t,e){e==null&&(e=H(18));var i=$a(r,t);e.write_shift(-4,r),e.write_shift(-4,r),e.write_shift(4,(i.width||10)*256),e.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof i.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),e.write_shift(2,n),e}var sh=["left","right","top","bottom","header","footer"];function ny(r){var t={};return sh.forEach(function(e){t[e]=Vn(r,8)}),t}function sy(r,t){return t==null&&(t=H(6*8)),ih(r),sh.forEach(function(e){Xi(r[e],t)}),t}function ay(r){var t=r.read_shift(2);return r.l+=28,{RTL:t&32}}function oy(r,t,e){e==null&&(e=H(30));var i=924;return(((t||{}).Views||[])[0]||{}).RTL&&(i|=32),e.write_shift(2,i),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function ly(r){var t=H(24);return t.write_shift(4,4),t.write_shift(4,1),Bn(r,t),t}function cy(r,t){return t==null&&(t=H(16*4+2)),t.write_shift(2,r.password?$u(r.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?t.write_shift(4,r[e[0]]!=null&&!r[e[0]]?1:0):t.write_shift(4,r[e[0]]!=null&&r[e[0]]?0:1)}),t}function uy(){}function hy(){}function fy(r,t,e,i,n,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=_r(t),t.z=t.z||ft[14],t.v=xr(ur(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r:e,c:i};switch(c.s=Ai(n.cellXfs,t,n),t.l&&s["!links"].push([Qe(c),t.l]),t.c&&s["!comments"].push([Qe(c),t.c]),t.t){case"s":case"str":return n.bookSST?(o=dl(n.Strings,t.v,n.revStrings),c.t="s",c.v=o,a?Z(r,18,Av(t,c)):Z(r,7,Fv(t,c))):(c.t="str",a?Z(r,17,Uv(t,c)):Z(r,6,Wv(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?Z(r,13,Vv(t,c)):Z(r,2,Nv(t,c)):a?Z(r,16,Lv(t,c)):Z(r,5,Mv(t,c)),!0;case"b":return c.t="b",a?Z(r,15,Cv(t,c)):Z(r,4,wv(t,c)),!0;case"e":return c.t="e",a?Z(r,14,Iv(t,c)):Z(r,3,Sv(t,c)),!0}return a?Z(r,12,vv(t,c)):Z(r,1,xv(t,c)),!0}function dy(r,t,e,i){var n=st(t["!ref"]||"A1"),s,a="",o=[];Z(r,145);var c=Array.isArray(t),l=n.e.r;t["!rows"]&&(l=Math.max(n.e.r,t["!rows"].length-1));for(var u=n.s.r;u<=l;++u){a=Yt(u),uv(r,t,n,u);var h=!1;if(u<=n.e.r)for(var f=n.s.c;f<=n.e.c;++f){u===n.s.r&&(o[f]=nr(f)),s=o[f]+a;var d=c?(t[u]||[])[f]:t[s];if(!d){h=!1;continue}h=fy(r,d,u,f,i,t,h)}}Z(r,146)}function py(r,t){!t||!t["!merges"]||(Z(r,177,Qv(t["!merges"].length)),t["!merges"].forEach(function(e){Z(r,176,qv(e))}),Z(r,178))}function my(r,t){!t||!t["!cols"]||(Z(r,390),t["!cols"].forEach(function(e,i){e&&Z(r,60,iy(i,e))}),Z(r,391))}function gy(r,t){!t||!t["!ref"]||(Z(r,648),Z(r,649,ly(st(t["!ref"]))),Z(r,650))}function xy(r,t,e){t["!links"].forEach(function(i){if(i[1].Target){var n=Ye(e,-1,i[1].Target.replace(/#.*$/,""),Ge.HLINK);Z(r,494,Jv(i,n))}}),delete t["!links"]}function _y(r,t,e,i){if(t["!comments"].length>0){var n=Ye(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ge.VML);Z(r,551,ol("rId"+n)),t["!legacy"]=n}}function vy(r,t,e,i){if(t["!autofilter"]){var n=t["!autofilter"],s=typeof n.ref=="string"?n.ref:_t(n.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,o=Or(s);o.s.r==o.e.r&&(o.e.r=Or(t["!ref"]).e.r,s=_t(o));for(var c=0;c<a.length;++c){var l=a[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==i){l.Ref="'"+e.SheetNames[i]+"'!"+s;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+s}),Z(r,161,Bn(st(s))),Z(r,162)}}function yy(r,t,e){Z(r,133),Z(r,137,oy(t,e)),Z(r,138),Z(r,134)}function wy(r,t){t["!protect"]&&Z(r,535,cy(t["!protect"]))}function by(r,t,e,i){var n=gr(),s=e.SheetNames[r],a=e.Sheets[s]||{},o=s;try{e&&e.Workbook&&(o=e.Workbook.Sheets[r].CodeName||o)}catch{}var c=st(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Z(n,129),(e.vbaraw||a["!outline"])&&Z(n,147,mv(o,a["!outline"])),Z(n,148,fv(c)),yy(n,a,e.Workbook),my(n,a,r,t,e),dy(n,a,r,t,e),wy(n,a),vy(n,a,e,r),py(n,a),xy(n,a,i),a["!margins"]&&Z(n,476,sy(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&gy(n,a),_y(n,a,r,i),Z(n,130),n.end()}function Cy(r,t){r.l+=10;var e=sr(r,t-10);return{name:e}}var Ty=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Sy(r){return!r.Workbook||!r.Workbook.WBProps?"false":tg(r.Workbook.WBProps.date1904)?"true":"false"}var Ey="][*?/\\".split("");function ah(r,t){if(r.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var e=!0;return Ey.forEach(function(i){if(r.indexOf(i)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");e=!1}}),e}function Iy(r,t,e){r.forEach(function(i,n){ah(i);for(var s=0;s<n;++s)if(i==r[s])throw new Error("Duplicate Sheet Name: "+i);if(e){var a=t&&t[n]&&t[n].CodeName||i;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function ky(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var t=r.Workbook&&r.Workbook.Sheets||[];Iy(r.SheetNames,t,!!r.vbaraw);for(var e=0;e<r.SheetNames.length;++e)q_(r.Sheets[r.SheetNames[e]],r.SheetNames[e],e)}function oh(r){var t=[vt];t[t.length]=ne("workbook",null,{xmlns:Ln[0],"xmlns:r":Mt.r});var e=r.Workbook&&(r.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(Ty.forEach(function(o){r.Workbook.WBProps[o[0]]!=null&&r.Workbook.WBProps[o[0]]!=o[1]&&(i[o[0]]=r.Workbook.WBProps[o[0]])}),r.Workbook.WBProps.CodeName&&(i.codeName=r.Workbook.WBProps.CodeName,delete i.CodeName)),t[t.length]=ne("workbookPr",null,i);var n=r.Workbook&&r.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==r.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var a={name:qe(r.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=ne("sheet",null,a)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=ne("definedName",qe(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Fy(r,t){var e={};return e.Hidden=r.read_shift(4),e.iTabID=r.read_shift(4),e.strRelID=zo(r,t-8),e.name=sr(r),e}function Oy(r,t){return t||(t=H(127)),t.write_shift(4,r.Hidden),t.write_shift(4,r.iTabID),ol(r.strRelID,t),Lt(r.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Ay(r,t){var e={},i=r.read_shift(4);e.defaultThemeVersion=r.read_shift(4);var n=t>8?sr(r):"";return n.length>0&&(e.CodeName=n),e.autoCompressPictures=!!(i&65536),e.backupFile=!!(i&64),e.checkCompatibility=!!(i&4096),e.date1904=!!(i&1),e.filterPrivacy=!!(i&8),e.hidePivotFieldList=!!(i&1024),e.promptedSolutions=!!(i&16),e.publishItems=!!(i&2048),e.refreshAllConnections=!!(i&262144),e.saveExternalLinkValues=!!(i&128),e.showBorderUnselectedTables=!!(i&4),e.showInkAnnotation=!!(i&32),e.showObjects=["all","placeholders","none"][i>>13&3],e.showPivotChartFilter=!!(i&32768),e.updateLinks=["userSet","never","always"][i>>8&3],e}function Dy(r,t){t||(t=H(72));var e=0;return r&&r.filterPrivacy&&(e|=8),t.write_shift(4,e),t.write_shift(4,0),vu(r&&r.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function My(r,t,e){var i=r.l+t;r.l+=4,r.l+=1;var n=r.read_shift(4),s=Sg(r),a=U_(r,0,e),o=al(r);r.l=i;var c={Name:s,Ptg:a};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function Py(r,t){Z(r,143);for(var e=0;e!=t.SheetNames.length;++e){var i=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[e]&&t.Workbook.Sheets[e].Hidden||0,n={Hidden:i,iTabID:e+1,strRelID:"rId"+(e+1),name:t.SheetNames[e]};Z(r,156,Oy(n))}Z(r,144)}function Ly(r,t){t||(t=H(127));for(var e=0;e!=4;++e)t.write_shift(4,0);return Lt("SheetJS",t),Lt(vs.version,t),Lt(vs.version,t),Lt("7262",t),t.length>t.l?t.slice(0,t.l):t}function Ry(r,t){t||(t=H(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,r),t.write_shift(4,r);var e=120;return t.write_shift(1,e),t.length>t.l?t.slice(0,t.l):t}function Ny(r,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var e=t.Workbook.Sheets,i=0,n=-1,s=-1;i<e.length;++i)!e[i]||!e[i].Hidden&&n==-1?n=i:e[i].Hidden==1&&s==-1&&(s=i);s>n||(Z(r,135),Z(r,158,Ry(n)),Z(r,136))}}function By(r,t){var e=gr();return Z(e,131),Z(e,128,Ly()),Z(e,153,Dy(r.Workbook&&r.Workbook.WBProps||null)),Ny(e,r,t),Py(e,r,t),Z(e,132),e.end()}function Vy(r,t,e){return(t.slice(-4)===".bin"?By:oh)(r,e)}function $y(r,t,e,i,n){return(t.slice(-4)===".bin"?by:nh)(r,e,i,n)}function Hy(r,t,e){return(t.slice(-4)===".bin"?sx:zu)(r,e)}function Wy(r,t,e){return(t.slice(-4)===".bin"?D1:Vu)(r,e)}function zy(r,t,e){return(t.slice(-4)===".bin"?wx:Ku)(r,e)}function Uy(r){return(r.slice(-4)===".bin"?dx:Xu)()}function Gy(r,t){var e=[];return r.Props&&e.push(Hg(r.Props,t)),r.Custprops&&e.push(Wg(r.Props,r.Custprops,t)),e.join("")}function Xy(){return""}function jy(r,t){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(i,n){var s=[];s.push(ne("NumberFormat",null,{"ss:Format":qe(ft[i.numFmtId])}));var a={"ss:ID":"s"+(21+n)};e.push(ne("Style",s.join(""),a))}),ne("Styles",e.join(""))}function lh(r){return ne("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+hl(r.Ref,{r:0,c:0})})}function Ky(r){if(!((r||{}).Workbook||{}).Names)return"";for(var t=r.Workbook.Names,e=[],i=0;i<t.length;++i){var n=t[i];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||e.push(lh(n)))}return ne("Names",e.join(""))}function Yy(r,t,e,i){if(!r||!((i||{}).Workbook||{}).Names)return"";for(var n=i.Workbook.Names,s=[],a=0;a<n.length;++a){var o=n[a];o.Sheet==e&&(o.Name.match(/^_xlfn\./)||s.push(lh(o)))}return s.join("")}function qy(r,t,e,i){if(!r)return"";var n=[];if(r["!margins"]&&(n.push("<PageSetup>"),r["!margins"].header&&n.push(ne("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&n.push(ne("Footer",null,{"x:Margin":r["!margins"].footer})),n.push(ne("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),n.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[e])if(i.Workbook.Sheets[e].Hidden)n.push(ne("Visible",i.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<e&&!(i.Workbook.Sheets[s]&&!i.Workbook.Sheets[s].Hidden);++s);s==e&&n.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),r["!protect"]&&(n.push(Kt("ProtectContents","True")),r["!protect"].objects&&n.push(Kt("ProtectObjects","True")),r["!protect"].scenarios&&n.push(Kt("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?n.push(Kt("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&n.push(Kt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){r["!protect"][a[0]]&&n.push("<"+a[1]+"/>")})),n.length==0?"":ne("WorksheetOptions",n.join(""),{xmlns:Fr.x})}function Qy(r){return r.map(function(t){var e=eg(t.t||""),i=ne("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return ne("Comment",i,{"ss:Author":t.a})}).join("")}function Zy(r,t,e,i,n,s,a){if(!r||r.v==null&&r.f==null)return"";var o={};if(r.f&&(o["ss:Formula"]="="+qe(hl(r.f,a))),r.F&&r.F.slice(0,t.length)==t){var c=Pt(r.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(r.l&&r.l.Target&&(o["ss:HRef"]=qe(r.l.Target),r.l.Tooltip&&(o["x:HRefScreenTip"]=qe(r.l.Tooltip))),e["!merges"])for(var l=e["!merges"],u=0;u!=l.length;++u)l[u].s.c!=a.c||l[u].s.r!=a.r||(l[u].e.c>l[u].s.c&&(o["ss:MergeAcross"]=l[u].e.c-l[u].s.c),l[u].e.r>l[u].s.r&&(o["ss:MergeDown"]=l[u].e.r-l[u].s.r));var h="",f="";switch(r.t){case"z":if(!i.sheetStubs)return"";break;case"n":h="Number",f=String(r.v);break;case"b":h="Boolean",f=r.v?"1":"0";break;case"e":h="Error",f=ks[r.v];break;case"d":h="DateTime",f=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||ft[14]);break;case"s":h="String",f=Jm(r.v||"");break}var d=Ai(i.cellXfs,r,i);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=a.c+1;var g=r.v!=null?f:"",p=r.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(r.c||[]).length>0&&(p+=Qy(r.c)),ne("Cell",p,o)}function Jy(r,t){var e='<Row ss:Index="'+(r+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Wu(t.hpt)),t.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(e+=' ss:Hidden="1"')),e+">"}function ew(r,t,e,i){if(!r["!ref"])return"";var n=st(r["!ref"]),s=r["!merges"]||[],a=0,o=[];r["!cols"]&&r["!cols"].forEach(function(x,O){cl(x);var A=!!x.width,D=$a(O,x),G={"ss:Index":O+1};A&&(G["ss:Width"]=Ia(D.width)),x.hidden&&(G["ss:Hidden"]="1"),o.push(ne("Column",null,G))});for(var c=Array.isArray(r),l=n.s.r;l<=n.e.r;++l){for(var u=[Jy(l,(r["!rows"]||[])[l])],h=n.s.c;h<=n.e.c;++h){var f=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>l)&&!(s[a].e.c<h)&&!(s[a].e.r<l)){(s[a].s.c!=h||s[a].s.r!=l)&&(f=!0);break}if(!f){var d={r:l,c:h},g=Qe(d),p=c?(r[l]||[])[h]:r[g];u.push(Zy(p,g,r,t,e,i,d))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function tw(r,t,e){var i=[],n=e.SheetNames[r],s=e.Sheets[n],a=s?Yy(s,t,r,e):"";return a.length>0&&i.push("<Names>"+a+"</Names>"),a=s?ew(s,t,r,e):"",a.length>0&&i.push("<Table>"+a+"</Table>"),i.push(qy(s,t,r,e)),i.join("")}function rw(r,t){t||(t={}),r.SSF||(r.SSF=_r(ft)),r.SSF&&(Pa(),Ma(r.SSF),t.revssf=La(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF,t.cellXfs=[],Ai(t.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(Gy(r,t)),e.push(Xy(r,t)),e.push(""),e.push("");for(var i=0;i<r.SheetNames.length;++i)e.push(ne("Worksheet",tw(i,t,r),{"ss:Name":qe(r.SheetNames[i])}));return e[2]=jy(r,t),e[3]=Ky(r,t),vt+ne("Workbook",e.join(""),{xmlns:Fr.ss,"xmlns:o":Fr.o,"xmlns:x":Fr.x,"xmlns:ss":Fr.ss,"xmlns:dt":Fr.dt,"xmlns:html":Fr.html})}var Bo={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function iw(r,t){var e=[],i=[],n=[],s=0,a,o=p0(I0,"n"),c=p0(k0,"n");if(r.Props)for(a=qt(r.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?e:Object.prototype.hasOwnProperty.call(c,a[s])?i:n).push([a[s],r.Props[a[s]]]);if(r.Custprops)for(a=qt(r.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?e:Object.prototype.hasOwnProperty.call(c,a[s])?i:n).push([a[s],r.Custprops[a[s]]]);var l=[];for(s=0;s<n.length;++s)Du.indexOf(n[s][0])>-1||Fu.indexOf(n[s][0])>-1||n[s][1]!=null&&l.push(n[s]);i.length&&Je.utils.cfb_add(t,"/SummaryInformation",M0(i,Bo.SI,c,k0)),(e.length||l.length)&&Je.utils.cfb_add(t,"/DocumentSummaryInformation",M0(e,Bo.DSI,o,I0,l.length?l:null,Bo.UDI))}function nw(r,t){var e=t||{},i=Je.utils.cfb_new({root:"R"}),n="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":n="/Workbook",e.biff=8;break;case"biff5":n="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Je.utils.cfb_add(i,n,ch(r,e)),e.biff==8&&(r.Props||r.Custprops)&&iw(r,i),e.biff==8&&r.vbaraw&&bx(i,Je.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),i}var sw={0:{f:lv},1:{f:gv},2:{f:Rv},3:{f:Tv},4:{f:yv},5:{f:Dv},6:{f:Hv},7:{f:kv},8:{f:Kv},9:{f:jv},10:{f:Gv},11:{f:Xv},12:{f:_v},13:{f:Bv},14:{f:Ev},15:{f:bv},16:{f:Pv},17:{f:zv},18:{f:Ov},19:{f:sl},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:My},40:{},42:{},43:{f:H1},44:{f:V1},45:{f:U1},46:{f:X1},47:{f:G1},48:{},49:{f:_g},50:{},51:{f:lx},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:v1},62:{f:$v},63:{f:px},64:{f:uy},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ii,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ay},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:pv},148:{f:hv,p:16},151:{f:ey},152:{},153:{f:Ay},154:{},155:{},156:{f:Fy},157:{},158:{},159:{T:1,f:F1},160:{T:-1},161:{T:1,f:Zi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Yv},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ax},336:{T:-1},337:{f:hx,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:zo},357:{},358:{},359:{},360:{T:1},361:{},362:{f:d1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ty},427:{f:ry},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:ny},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:dv},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Zv},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:zo},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:vx},633:{T:1},634:{T:-1},635:{T:1,f:xx},636:{T:-1},637:{f:bg},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Cy},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:hy},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function se(r,t,e,i){var n=t;if(!isNaN(n)){var s=i||(e||[]).length||0,a=r.next(4);a.write_shift(2,n),a.write_shift(2,s),s>0&&rl(e)&&r.push(e)}}function aw(r,t,e,i){var n=i||(e||[]).length||0;if(n<=8224)return se(r,t,e,n);var s=t;if(!isNaN(s)){for(var a=e.parts||[],o=0,c=0,l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;var u=r.next(4);for(u.write_shift(2,s),u.write_shift(2,l),r.push(e.slice(c,c+l)),c+=l;c<n;){for(u=r.next(4),u.write_shift(2,60),l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;u.write_shift(2,l),r.push(e.slice(c,c+l)),c+=l}}}function Os(r,t,e){return r||(r=H(7)),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,0),r.write_shift(1,0),r}function ow(r,t,e,i){var n=H(9);return Os(n,r,t),Pu(e,i||"b",n),n}function lw(r,t,e){var i=H(8+2*e.length);return Os(i,r,t),i.write_shift(1,e.length),i.write_shift(e.length,e,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function cw(r,t,e,i){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?xr(ur(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?se(r,2,C1(e,i,n)):se(r,3,b1(e,i,n));return;case"b":case"e":se(r,5,ow(e,i,t.v,t.t));return;case"s":case"str":se(r,4,lw(e,i,(t.v||"").slice(0,255)));return}se(r,1,Os(null,e,i))}function uw(r,t,e,i){var n=Array.isArray(t),s=st(t["!ref"]||"A1"),a,o="",c=[];if(s.e.c>255||s.e.r>16383){if(i.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=_t(s)}for(var l=s.s.r;l<=s.e.r;++l){o=Yt(l);for(var u=s.s.c;u<=s.e.c;++u){l===s.s.r&&(c[u]=nr(u)),a=c[u]+o;var h=n?(t[l]||[])[u]:t[a];h&&cw(r,h,l,u,i)}}}function hw(r,t){var e=t||{};ri!=null&&e.dense==null&&(e.dense=ri);for(var i=gr(),n=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==e.sheet&&(n=s);if(n==0&&e.sheet&&r.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return se(i,e.biff==4?1033:e.biff==3?521:9,ll(r,16,e)),uw(i,r.Sheets[r.SheetNames[n]],n,e,r),se(i,10),i.end()}function fw(r,t,e){se(r,49,s1({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},e))}function dw(r,t,e){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)t[n]!=null&&se(r,1054,l1(n,t[n],e))})}function pw(r,t){var e=H(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),se(r,2151,e),e=H(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),Nu(st(t["!ref"]||"A1"),e),e.write_shift(4,4),se(r,2152,e)}function mw(r,t){for(var e=0;e<16;++e)se(r,224,L0({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(i){se(r,224,L0(i,0,t))})}function gw(r,t){for(var e=0;e<t["!links"].length;++e){var i=t["!links"][e];se(r,440,g1(i)),i[1].Tooltip&&se(r,2048,x1(i))}delete t["!links"]}function xw(r,t){if(t){var e=0;t.forEach(function(i,n){++e<=256&&i&&se(r,125,y1($a(n,i),n))})}}function _w(r,t,e,i,n){var s=16+Ai(n.cellXfs,t,n);if(t.v==null&&!t.bf){se(r,513,ji(e,i,s));return}if(t.bf)se(r,6,W_(t,e,i,n,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?xr(ur(t.v)):t.v;se(r,515,f1(e,i,a,s,n));break;case"b":case"e":se(r,517,h1(e,i,t.v,s,n,t.t));break;case"s":case"str":if(n.bookSST){var o=dl(n.Strings,t.v,n.revStrings);se(r,253,a1(e,i,o,s,n))}else se(r,516,o1(e,i,(t.v||"").slice(0,255),s,n));break;default:se(r,513,ji(e,i,s))}}function vw(r,t,e){var i=gr(),n=e.SheetNames[r],s=e.Sheets[n]||{},a=(e||{}).Workbook||{},o=(a.Sheets||[])[r]||{},c=Array.isArray(s),l=t.biff==8,u,h="",f=[],d=st(s["!ref"]||"A1"),g=l?65536:16384;if(d.e.c>255||d.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,g-1)}se(i,2057,ll(e,16,t)),se(i,13,Rr(1)),se(i,12,Rr(100)),se(i,15,cr(!0)),se(i,17,cr(!1)),se(i,16,Xi(.001)),se(i,95,cr(!0)),se(i,42,cr(!1)),se(i,43,cr(!1)),se(i,130,Rr(1)),se(i,128,u1([0,0])),se(i,131,cr(!1)),se(i,132,cr(!1)),l&&xw(i,s["!cols"]),se(i,512,c1(d,t)),l&&(s["!links"]=[]);for(var p=d.s.r;p<=d.e.r;++p){h=Yt(p);for(var x=d.s.c;x<=d.e.c;++x){p===d.s.r&&(f[x]=nr(x)),u=f[x]+h;var O=c?(s[p]||[])[x]:s[u];O&&(_w(i,O,p,x,t),l&&O.l&&s["!links"].push([u,O.l]))}}var A=o.CodeName||o.name||n;return l&&se(i,574,n1((a.Views||[])[0])),l&&(s["!merges"]||[]).length&&se(i,229,m1(s["!merges"])),l&&gw(i,s),se(i,442,Ru(A,t)),l&&pw(i,s),se(i,10),i.end()}function yw(r,t,e){var i=gr(),n=(r||{}).Workbook||{},s=n.Sheets||[],a=n.WBProps||{},o=e.biff==8,c=e.biff==5;if(se(i,2057,ll(r,5,e)),e.bookType=="xla"&&se(i,135),se(i,225,o?Rr(1200):null),se(i,193,Gg(2)),c&&se(i,191),c&&se(i,192),se(i,226),se(i,92,e1("SheetJS",e)),se(i,66,Rr(o?1200:1252)),o&&se(i,353,Rr(0)),o&&se(i,448),se(i,317,w1(r.SheetNames.length)),o&&r.vbaraw&&se(i,211),o&&r.vbaraw){var l=a.CodeName||"ThisWorkbook";se(i,442,Ru(l,e))}se(i,156,Rr(17)),se(i,25,cr(!1)),se(i,18,cr(!1)),se(i,19,Rr(0)),o&&se(i,431,cr(!1)),o&&se(i,444,Rr(0)),se(i,61,i1(e)),se(i,64,cr(!1)),se(i,141,Rr(0)),se(i,34,cr(Sy(r)=="true")),se(i,14,cr(!0)),o&&se(i,439,cr(!1)),se(i,218,Rr(0)),fw(i,r,e),dw(i,r.SSF,e),mw(i,e),o&&se(i,352,cr(!1));var u=i.end(),h=gr();o&&se(h,140,_1()),o&&e.Strings&&aw(h,252,r1(e.Strings,e)),se(h,10);var f=h.end(),d=gr(),g=0,p=0;for(p=0;p<r.SheetNames.length;++p)g+=(o?12:11)+(o?2:1)*r.SheetNames[p].length;var x=u.length+g+f.length;for(p=0;p<r.SheetNames.length;++p){var O=s[p]||{};se(d,133,t1({pos:x,hs:O.Hidden||0,dt:0,name:r.SheetNames[p]},e)),x+=t[p].length}var A=d.end();if(g!=A.length)throw new Error("BS8 "+g+" != "+A.length);var D=[];return u.length&&D.push(u),A.length&&D.push(A),f.length&&D.push(f),jt(D)}function ww(r,t){var e=t||{},i=[];r&&!r.SSF&&(r.SSF=_r(ft)),r&&r.SSF&&(Pa(),Ma(r.SSF),e.revssf=La(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,pl(e),e.cellXfs=[],Ai(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var n=0;n<r.SheetNames.length;++n)i[i.length]=vw(n,e,r);return i.unshift(yw(r,i,e)),jt(i)}function ch(r,t){for(var e=0;e<=r.SheetNames.length;++e){var i=r.Sheets[r.SheetNames[e]];if(!(!i||!i["!ref"])){var n=Or(i["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return ww(r,t);case 4:case 3:case 2:return hw(r,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function bw(r,t,e,i){for(var n=r["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,c=0,l=0;l<n.length;++l)if(!(n[l].s.r>e||n[l].s.c>a)&&!(n[l].e.r<e||n[l].e.c<a)){if(n[l].s.r<e||n[l].s.c<a){o=-1;break}o=n[l].e.r-n[l].s.r+1,c=n[l].e.c-n[l].s.c+1;break}if(!(o<0)){var u=Qe({r:e,c:a}),h=i.dense?(r[e]||[])[a]:r[u],f=h&&h.v!=null&&(h.h||Zm(h.w||(gi(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),c>1&&(d.colspan=c),i.editable?f='<span contenteditable="true">'+f+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),d.id=(i.id||"sjs")+"-"+u,s.push(ne("td",f,d))}}var g="<tr>";return g+s.join("")+"</tr>"}var Cw='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Tw="</body></html>";function Sw(r,t,e){var i=[];return i.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function uh(r,t){var e=t||{},i=e.header!=null?e.header:Cw,n=e.footer!=null?e.footer:Tw,s=[i],a=Or(r["!ref"]);e.dense=Array.isArray(r),s.push(Sw(r,a,e));for(var o=a.s.r;o<=a.e.r;++o)s.push(bw(r,a,o,e));return s.push("</table>"+n),s.join("")}function hh(r,t,e){var i=e||{};ri!=null&&(i.dense=ri);var n=0,s=0;if(i.origin!=null)if(typeof i.origin=="number")n=i.origin;else{var a=typeof i.origin=="string"?Pt(i.origin):i.origin;n=a.r,s=a.c}var o=t.getElementsByTagName("tr"),c=Math.min(i.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:n,c:s}};if(r["!ref"]){var u=Or(r["!ref"]);l.s.r=Math.min(l.s.r,u.s.r),l.s.c=Math.min(l.s.c,u.s.c),l.e.r=Math.max(l.e.r,u.e.r),l.e.c=Math.max(l.e.c,u.e.c),n==-1&&(l.e.r=n=u.e.r+1)}var h=[],f=0,d=r["!rows"]||(r["!rows"]=[]),g=0,p=0,x=0,O=0,A=0,D=0;for(r["!cols"]||(r["!cols"]=[]);g<o.length&&p<c;++g){var G=o[g];if(W0(G)){if(i.display)continue;d[p]={hidden:!0}}var te=G.children;for(x=O=0;x<te.length;++x){var me=te[x];if(!(i.display&&W0(me))){var M=me.hasAttribute("data-v")?me.getAttribute("data-v"):me.hasAttribute("v")?me.getAttribute("v"):rg(me.innerHTML),Q=me.getAttribute("data-z")||me.getAttribute("z");for(f=0;f<h.length;++f){var U=h[f];U.s.c==O+s&&U.s.r<p+n&&p+n<=U.e.r&&(O=U.e.c+1-s,f=-1)}D=+me.getAttribute("colspan")||1,((A=+me.getAttribute("rowspan")||1)>1||D>1)&&h.push({s:{r:p+n,c:O+s},e:{r:p+n+(A||1)-1,c:O+s+(D||1)-1}});var q={t:"s",v:M},ee=me.getAttribute("data-t")||me.getAttribute("t")||"";M!=null&&(M.length==0?q.t=ee||"z":i.raw||M.trim().length==0||ee=="s"||(M==="TRUE"?q={t:"b",v:!0}:M==="FALSE"?q={t:"b",v:!1}:isNaN(di(M))?isNaN(bs(M).getDate())||(q={t:"d",v:ur(M)},i.cellDates||(q={t:"n",v:xr(q.v)}),q.z=i.dateNF||ft[14]):q={t:"n",v:di(M)})),q.z===void 0&&Q!=null&&(q.z=Q);var re="",Ce=me.getElementsByTagName("A");if(Ce&&Ce.length)for(var je=0;je<Ce.length&&!(Ce[je].hasAttribute("href")&&(re=Ce[je].getAttribute("href"),re.charAt(0)!="#"));++je);re&&re.charAt(0)!="#"&&(q.l={Target:re}),i.dense?(r[p+n]||(r[p+n]=[]),r[p+n][O+s]=q):r[Qe({c:O+s,r:p+n})]=q,l.e.c<O+s&&(l.e.c=O+s),O+=D}}++p}return h.length&&(r["!merges"]=(r["!merges"]||[]).concat(h)),l.e.r=Math.max(l.e.r,p-1+n),r["!ref"]=_t(l),p>=c&&(r["!fullref"]=_t((l.e.r=o.length-g+p-1+n,l))),r}function fh(r,t){var e=t||{},i=e.dense?[]:{};return hh(i,r,t)}function Ew(r,t){return Ki(fh(r,t),t)}function W0(r){var t="",e=Iw(r);return e&&(t=e(r).getPropertyValue("display")),t||(t=r.style&&r.style.display),t==="none"}function Iw(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var kw=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Cs({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return vt+t}}(),z0=function(){var r=function(s){return qe(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,i=function(s,a,o){var c=[];c.push('      <table:table table:name="'+qe(a.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,u=0,h=Or(s["!ref"]||"A1"),f=s["!merges"]||[],d=0,g=Array.isArray(s);if(s["!cols"])for(u=0;u<=h.e.c;++u)c.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",x=s["!rows"]||[];for(l=0;l<h.s.r;++l)p=x[l]?' table:style-name="ro'+x[l].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;l<=h.e.r;++l){for(p=x[l]?' table:style-name="ro'+x[l].ods+'"':"",c.push("        <table:table-row"+p+`>
`),u=0;u<h.s.c;++u)c.push(t);for(;u<=h.e.c;++u){var O=!1,A={},D="";for(d=0;d!=f.length;++d)if(!(f[d].s.c>u)&&!(f[d].s.r>l)&&!(f[d].e.c<u)&&!(f[d].e.r<l)){(f[d].s.c!=u||f[d].s.r!=l)&&(O=!0),A["table:number-columns-spanned"]=f[d].e.c-f[d].s.c+1,A["table:number-rows-spanned"]=f[d].e.r-f[d].s.r+1;break}if(O){c.push(e);continue}var G=Qe({r:l,c:u}),te=g?(s[l]||[])[u]:s[G];if(te&&te.f&&(A["table:formula"]=qe(K_(te.f)),te.F&&te.F.slice(0,G.length)==G)){var me=Or(te.F);A["table:number-matrix-columns-spanned"]=me.e.c-me.s.c+1,A["table:number-matrix-rows-spanned"]=me.e.r-me.s.r+1}if(!te){c.push(t);continue}switch(te.t){case"b":D=te.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=te.v?"true":"false";break;case"n":D=te.w||String(te.v||0),A["office:value-type"]="float",A["office:value"]=te.v||0;break;case"s":case"str":D=te.v==null?"":te.v,A["office:value-type"]="string";break;case"d":D=te.w||ur(te.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=ur(te.v).toISOString(),A["table:style-name"]="ce1";break;default:c.push(t);continue}var M=r(D);if(te.l&&te.l.Target){var Q=te.l.Target;Q=Q.charAt(0)=="#"?"#"+Y_(Q.slice(1)):Q,Q.charAt(0)!="#"&&!Q.match(/^\w+:/)&&(Q="../"+Q),M=ne("text:a",M,{"xlink:href":Q.replace(/&/g,"&amp;")})}c.push("          "+ne("table:table-cell",ne("text:p",M,{}),A)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var u=0;u<l["!cols"].length;++u)if(l["!cols"][u]){var h=l["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;cl(h),h.ods=o;var f=l["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var u=0;u<l["!rows"].length;++u)if(l["!rows"][u]){l["!rows"][u].ods=c;var h=l["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var c=[vt],l=Cs({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Cs({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+u+`>
`),c.push(Iu().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),n(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)c.push(i(a.Sheets[a.SheetNames[h]],a,h,o));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function dh(r,t){if(t.bookType=="fods")return z0(r,t);var e=Ko(),i="",n=[],s=[];return i="mimetype",De(e,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",De(e,i,z0(r,t)),n.push([i,"text/xml"]),s.push([i,"ContentFile"]),i="styles.xml",De(e,i,kw(r,t)),n.push([i,"text/xml"]),s.push([i,"StylesFile"]),i="meta.xml",De(e,i,vt+Iu()),n.push([i,"text/xml"]),s.push([i,"MetadataFile"]),i="manifest.rdf",De(e,i,$g(s)),n.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",De(e,i,Bg(n)),e}function Oa(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Fw(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):Gr(hi(r))}function Ow(r,t){e:for(var e=0;e<=r.length-t.length;++e){for(var i=0;i<t.length;++i)if(r[e+i]!=t[i])continue e;return!0}return!1}function Oi(r){var t=r.reduce(function(n,s){return n+s.length},0),e=new Uint8Array(t),i=0;return r.forEach(function(n){e.set(n,i),i+=n.length}),e}function Aw(r,t,e){var i=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,n=e/Math.pow(10,i-6176);r[t+15]|=i>>7,r[t+14]|=(i&127)<<1;for(var s=0;n>=1;++s,n/=256)r[t+s]=n&255;r[t+15]|=e>=0?0:128}function Ts(r,t){var e=t?t[0]:0,i=r[e]&127;e:if(r[e++]>=128&&(i|=(r[e]&127)<<7,r[e++]<128||(i|=(r[e]&127)<<14,r[e++]<128)||(i|=(r[e]&127)<<21,r[e++]<128)||(i+=(r[e]&127)*Math.pow(2,28),++e,r[e++]<128)||(i+=(r[e]&127)*Math.pow(2,35),++e,r[e++]<128)||(i+=(r[e]&127)*Math.pow(2,42),++e,r[e++]<128)))break e;return t&&(t[0]=e),i}function Ke(r){var t=new Uint8Array(7);t[0]=r&127;var e=1;e:if(r>127){if(t[e-1]|=128,t[e]=r>>7&127,++e,r<=16383||(t[e-1]|=128,t[e]=r>>14&127,++e,r<=2097151)||(t[e-1]|=128,t[e]=r>>21&127,++e,r<=268435455)||(t[e-1]|=128,t[e]=r/256>>>21&127,++e,r<=34359738367)||(t[e-1]|=128,t[e]=r/65536>>>21&127,++e,r<=4398046511103))break e;t[e-1]|=128,t[e]=r/16777216>>>21&127,++e}return t.slice(0,e)}function Dn(r){var t=0,e=r[t]&127;e:if(r[t++]>=128){if(e|=(r[t]&127)<<7,r[t++]<128||(e|=(r[t]&127)<<14,r[t++]<128)||(e|=(r[t]&127)<<21,r[t++]<128))break e;e|=(r[t]&127)<<28}return e}function Et(r){for(var t=[],e=[0];e[0]<r.length;){var i=e[0],n=Ts(r,e),s=n&7;n=Math.floor(n/8);var a=0,o;if(n==0)break;switch(s){case 0:{for(var c=e[0];r[e[0]++]>=128;);o=r.slice(c,e[0])}break;case 5:a=4,o=r.slice(e[0],e[0]+a),e[0]+=a;break;case 1:a=8,o=r.slice(e[0],e[0]+a),e[0]+=a;break;case 2:a=Ts(r,e),o=r.slice(e[0],e[0]+a),e[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(i))}var l={data:o,type:s};t[n]==null?t[n]=[l]:t[n].push(l)}return t}function Gt(r){var t=[];return r.forEach(function(e,i){e.forEach(function(n){n.data&&(t.push(Ke(i*8+n.type)),n.type==2&&t.push(Ke(n.data.length)),t.push(n.data))})}),Oi(t)}function zr(r){for(var t,e=[],i=[0];i[0]<r.length;){var n=Ts(r,i),s=Et(r.slice(i[0],i[0]+n));i[0]+=n;var a={id:Dn(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=Et(o.data),l=Dn(c[3][0].data);a.messages.push({meta:c,data:r.slice(i[0],i[0]+l)}),i[0]+=l}),(t=s[3])!=null&&t[0]&&(a.merge=Dn(s[3][0].data)>>>0>0),e.push(a)}return e}function Tn(r){var t=[];return r.forEach(function(e){var i=[];i[1]=[{data:Ke(e.id),type:0}],i[2]=[],e.merge!=null&&(i[3]=[{data:Ke(+!!e.merge),type:0}]);var n=[];e.messages.forEach(function(a){n.push(a.data),a.meta[3]=[{type:0,data:Ke(a.data.length)}],i[2].push({data:Gt(a.meta),type:2})});var s=Gt(i);t.push(Ke(s.length)),t.push(s),n.forEach(function(a){return t.push(a)})}),Oi(t)}function Dw(r,t){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var e=[0],i=Ts(t,e),n=[];e[0]<t.length;){var s=t[e[0]]&3;if(s==0){var a=t[e[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[e[0]],o>1&&(a|=t[e[0]+1]<<8),o>2&&(a|=t[e[0]+2]<<16),o>3&&(a|=t[e[0]+3]<<24),a>>>=0,a++,e[0]+=o}n.push(t.slice(e[0],e[0]+a)),e[0]+=a;continue}else{var c=0,l=0;if(s==1?(l=(t[e[0]]>>2&7)+4,c=(t[e[0]++]&224)<<3,c|=t[e[0]++]):(l=(t[e[0]++]>>2)+1,s==2?(c=t[e[0]]|t[e[0]+1]<<8,e[0]+=2):(c=(t[e[0]]|t[e[0]+1]<<8|t[e[0]+2]<<16|t[e[0]+3]<<24)>>>0,e[0]+=4)),n=[Oi(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(n.push(n[0].slice(-c)),l-=c;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-c,-c+l))}}var u=Oi(n);if(u.length!=i)throw new Error("Unexpected length: ".concat(u.length," != ").concat(i));return u}function Ur(r){for(var t=[],e=0;e<r.length;){var i=r[e++],n=r[e]|r[e+1]<<8|r[e+2]<<16;e+=3,t.push(Dw(i,r.slice(e,e+n))),e+=n}if(e!==r.length)throw new Error("data is not a valid framed stream!");return Oi(t)}function Sn(r){for(var t=[],e=0;e<r.length;){var i=Math.min(r.length-e,268435455),n=new Uint8Array(4);t.push(n);var s=Ke(i),a=s.length;t.push(s),i<=60?(a++,t.push(new Uint8Array([i-1<<2]))):i<=256?(a+=2,t.push(new Uint8Array([240,i-1&255]))):i<=65536?(a+=3,t.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(a+=4,t.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(a+=5,t.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),t.push(r.slice(e,e+i)),a+=i,n[0]=0,n[1]=a&255,n[2]=a>>8&255,n[3]=a>>16&255,e+=i}return Oi(t)}function Vo(r,t){var e=new Uint8Array(32),i=Oa(e),n=12,s=0;switch(e[0]=5,r.t){case"n":e[1]=2,Aw(e,n,r.v),s|=1,n+=16;break;case"b":e[1]=6,i.setFloat64(n,r.v?1:0,!0),s|=2,n+=8;break;case"s":if(t.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));e[1]=3,i.setUint32(n,t.indexOf(r.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+r.t}return i.setUint32(8,s,!0),e.slice(0,n)}function $o(r,t){var e=new Uint8Array(32),i=Oa(e),n=12,s=0;switch(e[0]=3,r.t){case"n":e[2]=2,i.setFloat64(n,r.v,!0),s|=32,n+=8;break;case"b":e[2]=6,i.setFloat64(n,r.v?1:0,!0),s|=32,n+=8;break;case"s":if(t.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));e[2]=3,i.setUint32(n,t.indexOf(r.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+r.t}return i.setUint32(4,s,!0),e.slice(0,n)}function Si(r){var t=Et(r);return Ts(t[1][0].data)}function Mw(r,t,e){var i,n,s,a;if(!((i=r[6])!=null&&i[0])||!((n=r[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=r[8])==null?void 0:s[0])==null?void 0:a.data)&&Dn(r[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=Oa(r[7][0].data),u=0,h=[],f=Oa(r[4][0].data),d=0,g=[],p=0;p<t.length;++p){if(t[p]==null){l.setUint16(p*2,65535,!0),f.setUint16(p*2,65535);continue}l.setUint16(p*2,u,!0),f.setUint16(p*2,d,!0);var x,O;switch(typeof t[p]){case"string":x=Vo({t:"s",v:t[p]},e),O=$o({t:"s",v:t[p]},e);break;case"number":x=Vo({t:"n",v:t[p]},e),O=$o({t:"n",v:t[p]},e);break;case"boolean":x=Vo({t:"b",v:t[p]},e),O=$o({t:"b",v:t[p]},e);break;default:throw new Error("Unsupported value "+t[p])}h.push(x),u+=x.length,g.push(O),d+=O.length,++c}for(r[2][0].data=Ke(c);p<r[7][0].data.length/2;++p)l.setUint16(p*2,65535,!0),f.setUint16(p*2,65535,!0);return r[6][0].data=Oi(h),r[3][0].data=Oi(g),c}function Pw(r,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=Or(e["!ref"]);i.s.r=i.s.c=0;var n=!1;i.e.c>9&&(n=!0,i.e.c=9),i.e.r>49&&(n=!0,i.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(_t(i)));var s=Aa(e,{range:i,header:1}),a=["~Sh33tJ5~"];s.forEach(function(k){return k.forEach(function(I){typeof I=="string"&&a.push(I)})});var o={},c=[],l=Je.read(t.numbers,{type:"base64"});l.FileIndex.map(function(k,I){return[k,l.FullPaths[I]]}).forEach(function(k){var I=k[0],J=k[1];if(I.type==2&&I.name.match(/\.iwa/)){var we=I.content,ke=Ur(we),xe=zr(ke);xe.forEach(function(le){c.push(le.id),o[le.id]={deps:[],location:J,type:Dn(le.messages[0].meta[1][0].data)}})}}),c.sort(function(k,I){return k-I});var u=c.filter(function(k){return k>1}).map(function(k){return[k,Ke(k)]});l.FileIndex.map(function(k,I){return[k,l.FullPaths[I]]}).forEach(function(k){var I=k[0],J=k[1];if(I.name.match(/\.iwa/)){var we=zr(Ur(I.content));we.forEach(function(ke){ke.messages.forEach(function(xe){u.forEach(function(le){ke.messages.some(function(Ze){return Dn(Ze.meta[1][0].data)!=11006&&Ow(Ze.data,le[1])})&&o[le[0]].deps.push(ke.id)})})})}});function h(){for(var k=927262;k<2e6;++k)if(!o[k])return k;throw new Error("Too many messages")}for(var f=Je.find(l,o[1].location),d=zr(Ur(f.content)),g,p=0;p<d.length;++p){var x=d[p];x.id==1&&(g=x)}var O=Si(Et(g.messages[0].data)[1][0].data);for(f=Je.find(l,o[O].location),d=zr(Ur(f.content)),p=0;p<d.length;++p)x=d[p],x.id==O&&(g=x);for(O=Si(Et(g.messages[0].data)[2][0].data),f=Je.find(l,o[O].location),d=zr(Ur(f.content)),p=0;p<d.length;++p)x=d[p],x.id==O&&(g=x);for(O=Si(Et(g.messages[0].data)[2][0].data),f=Je.find(l,o[O].location),d=zr(Ur(f.content)),p=0;p<d.length;++p)x=d[p],x.id==O&&(g=x);var A=Et(g.messages[0].data);{A[6][0].data=Ke(i.e.r+1),A[7][0].data=Ke(i.e.c+1);var D=Si(A[46][0].data),G=Je.find(l,o[D].location),te=zr(Ur(G.content));{for(var me=0;me<te.length&&te[me].id!=D;++me);if(te[me].id!=D)throw"Bad ColumnRowUIDMapArchive";var M=Et(te[me].messages[0].data);M[1]=[],M[2]=[],M[3]=[];for(var Q=0;Q<=i.e.c;++Q){var U=[];U[1]=U[2]=[{type:0,data:Ke(Q+420690)}],M[1].push({type:2,data:Gt(U)}),M[2].push({type:0,data:Ke(Q)}),M[3].push({type:0,data:Ke(Q)})}M[4]=[],M[5]=[],M[6]=[];for(var q=0;q<=i.e.r;++q)U=[],U[1]=U[2]=[{type:0,data:Ke(q+726270)}],M[4].push({type:2,data:Gt(U)}),M[5].push({type:0,data:Ke(q)}),M[6].push({type:0,data:Ke(q)});te[me].messages[0].data=Gt(M)}G.content=Sn(Tn(te)),G.size=G.content.length,delete A[46];var ee=Et(A[4][0].data);{ee[7][0].data=Ke(i.e.r+1);var re=Et(ee[1][0].data),Ce=Si(re[2][0].data);G=Je.find(l,o[Ce].location),te=zr(Ur(G.content));{if(te[0].id!=Ce)throw"Bad HeaderStorageBucket";var je=Et(te[0].messages[0].data);for(q=0;q<s.length;++q){var Te=Et(je[2][0].data);Te[1][0].data=Ke(q),Te[4][0].data=Ke(s[q].length),je[2][q]={type:je[2][0].type,data:Gt(Te)}}te[0].messages[0].data=Gt(je)}G.content=Sn(Tn(te)),G.size=G.content.length;var It=Si(ee[2][0].data);G=Je.find(l,o[It].location),te=zr(Ur(G.content));{if(te[0].id!=It)throw"Bad HeaderStorageBucket";for(je=Et(te[0].messages[0].data),Q=0;Q<=i.e.c;++Q)Te=Et(je[2][0].data),Te[1][0].data=Ke(Q),Te[4][0].data=Ke(i.e.r+1),je[2][Q]={type:je[2][0].type,data:Gt(Te)};te[0].messages[0].data=Gt(je)}G.content=Sn(Tn(te)),G.size=G.content.length;var kt=Si(ee[4][0].data);(function(){for(var k=Je.find(l,o[kt].location),I=zr(Ur(k.content)),J,we=0;we<I.length;++we){var ke=I[we];ke.id==kt&&(J=ke)}var xe=Et(J.messages[0].data);{xe[3]=[];var le=[];a.forEach(function(Nt,We){le[1]=[{type:0,data:Ke(We)}],le[2]=[{type:0,data:Ke(1)}],le[3]=[{type:2,data:Fw(Nt)}],xe[3].push({type:2,data:Gt(le)})})}J.messages[0].data=Gt(xe);var Ze=Tn(I),Ne=Sn(Ze);k.content=Ne,k.size=k.content.length})();var hr=Et(ee[3][0].data);{var ar=hr[1][0];delete hr[2];var Rt=Et(ar.data);{var fr=Si(Rt[2][0].data);(function(){for(var k=Je.find(l,o[fr].location),I=zr(Ur(k.content)),J,we=0;we<I.length;++we){var ke=I[we];ke.id==fr&&(J=ke)}var xe=Et(J.messages[0].data);{delete xe[6],delete hr[7];var le=new Uint8Array(xe[5][0].data);xe[5]=[];for(var Ze=0,Ne=0;Ne<=i.e.r;++Ne){var Nt=Et(le);Ze+=Mw(Nt,s[Ne],a),Nt[1][0].data=Ke(Ne),xe[5].push({data:Gt(Nt),type:2})}xe[1]=[{type:0,data:Ke(i.e.c+1)}],xe[2]=[{type:0,data:Ke(i.e.r+1)}],xe[3]=[{type:0,data:Ke(Ze)}],xe[4]=[{type:0,data:Ke(i.e.r+1)}]}J.messages[0].data=Gt(xe);var We=Tn(I),Vr=Sn(We);k.content=Vr,k.size=k.content.length})()}ar.data=Gt(Rt)}ee[3][0].data=Gt(hr)}A[4][0].data=Gt(ee)}g.messages[0].data=Gt(A);var E=Tn(d),K=Sn(E);return f.content=K,f.size=f.content.length,l}function Lw(r){return function(e){for(var i=0;i!=r.length;++i){var n=r[i];e[n[0]]===void 0&&(e[n[0]]=n[1]),n[2]==="n"&&(e[n[0]]=Number(e[n[0]]))}}}function pl(r){Lw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function Rw(r,t){return t.bookType=="ods"?dh(r,t):t.bookType=="numbers"?Pw(r,t):t.bookType=="xlsb"?Nw(r,t):Bw(r,t)}function Nw(r,t){In=1024,r&&!r.SSF&&(r.SSF=_r(ft)),r&&r.SSF&&(Pa(),Ma(r.SSF),t.revssf=La(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,_s?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e=t.bookType=="xlsb"?"bin":"xml",i=Yu.indexOf(t.bookType)>-1,n=Tu();pl(t=t||{});var s=Ko(),a="",o=0;if(t.cellXfs=[],Ai(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",De(s,a,ku(r.Props,t)),n.coreprops.push(a),Ye(t.rels,2,a,Ge.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],l=0;l<r.SheetNames.length;++l)(r.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(r.SheetNames[l]);r.Props.SheetNames=c}for(r.Props.Worksheets=r.Props.SheetNames.length,De(s,a,Ou(r.Props,t)),n.extprops.push(a),Ye(t.rels,3,a,Ge.EXT_PROPS),r.Custprops!==r.Props&&qt(r.Custprops||{}).length>0&&(a="docProps/custom.xml",De(s,a,Au(r.Custprops,t)),n.custprops.push(a),Ye(t.rels,4,a,Ge.CUST_PROPS)),o=1;o<=r.SheetNames.length;++o){var u={"!id":{}},h=r.Sheets[r.SheetNames[o-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:a="xl/worksheets/sheet"+o+"."+e,De(s,a,$y(o-1,a,t,r,u)),n.sheets.push(a),Ye(t.wbrels,-1,"worksheets/sheet"+o+"."+e,Ge.WS[0])}if(h){var d=h["!comments"],g=!1,p="";d&&d.length>0&&(p="xl/comments"+o+"."+e,De(s,p,zy(d,p,t)),n.comments.push(p),Ye(u,-1,"../comments"+o+"."+e,Ge.CMNT),g=!0),h["!legacy"]&&g&&De(s,"xl/drawings/vmlDrawing"+o+".vml",ju(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&De(s,Eu(a),On(u))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+e,De(s,a,Wy(t.Strings,a,t)),n.strs.push(a),Ye(t.wbrels,-1,"sharedStrings."+e,Ge.SST)),a="xl/workbook."+e,De(s,a,Vy(r,a,t)),n.workbooks.push(a),Ye(t.rels,1,a,Ge.WB),a="xl/theme/theme1.xml",De(s,a,Gu(r.Themes,t)),n.themes.push(a),Ye(t.wbrels,-1,"theme/theme1.xml",Ge.THEME),a="xl/styles."+e,De(s,a,Hy(r,a,t)),n.styles.push(a),Ye(t.wbrels,-1,"styles."+e,Ge.STY),r.vbaraw&&i&&(a="xl/vbaProject.bin",De(s,a,r.vbaraw),n.vba.push(a),Ye(t.wbrels,-1,"vbaProject.bin",Ge.VBA)),a="xl/metadata."+e,De(s,a,Uy(a)),n.metadata.push(a),Ye(t.wbrels,-1,"metadata."+e,Ge.XLMETA),De(s,"[Content_Types].xml",Su(n,t)),De(s,"_rels/.rels",On(t.rels)),De(s,"xl/_rels/workbook."+e+".rels",On(t.wbrels)),delete t.revssf,delete t.ssf,s}function Bw(r,t){In=1024,r&&!r.SSF&&(r.SSF=_r(ft)),r&&r.SSF&&(Pa(),Ma(r.SSF),t.revssf=La(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,_s?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",i=Yu.indexOf(t.bookType)>-1,n=Tu();pl(t=t||{});var s=Ko(),a="",o=0;if(t.cellXfs=[],Ai(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",De(s,a,ku(r.Props,t)),n.coreprops.push(a),Ye(t.rels,2,a,Ge.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],l=0;l<r.SheetNames.length;++l)(r.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(r.SheetNames[l]);r.Props.SheetNames=c}r.Props.Worksheets=r.Props.SheetNames.length,De(s,a,Ou(r.Props,t)),n.extprops.push(a),Ye(t.rels,3,a,Ge.EXT_PROPS),r.Custprops!==r.Props&&qt(r.Custprops||{}).length>0&&(a="docProps/custom.xml",De(s,a,Au(r.Custprops,t)),n.custprops.push(a),Ye(t.rels,4,a,Ge.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=r.SheetNames.length;++o){var h={"!id":{}},f=r.Sheets[r.SheetNames[o-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+e,De(s,a,nh(o-1,t,r,h)),n.sheets.push(a),Ye(t.wbrels,-1,"worksheets/sheet"+o+"."+e,Ge.WS[0])}if(f){var g=f["!comments"],p=!1,x="";if(g&&g.length>0){var O=!1;g.forEach(function(A){A[1].forEach(function(D){D.T==!0&&(O=!0)})}),O&&(x="xl/threadedComments/threadedComment"+o+"."+e,De(s,x,mx(g,u,t)),n.threadedcomments.push(x),Ye(h,-1,"../threadedComments/threadedComment"+o+"."+e,Ge.TCMNT)),x="xl/comments"+o+"."+e,De(s,x,Ku(g,t)),n.comments.push(x),Ye(h,-1,"../comments"+o+"."+e,Ge.CMNT),p=!0}f["!legacy"]&&p&&De(s,"xl/drawings/vmlDrawing"+o+".vml",ju(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&De(s,Eu(a),On(h))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+e,De(s,a,Vu(t.Strings,t)),n.strs.push(a),Ye(t.wbrels,-1,"sharedStrings."+e,Ge.SST)),a="xl/workbook."+e,De(s,a,oh(r,t)),n.workbooks.push(a),Ye(t.rels,1,a,Ge.WB),a="xl/theme/theme1.xml",De(s,a,Gu(r.Themes,t)),n.themes.push(a),Ye(t.wbrels,-1,"theme/theme1.xml",Ge.THEME),a="xl/styles."+e,De(s,a,zu(r,t)),n.styles.push(a),Ye(t.wbrels,-1,"styles."+e,Ge.STY),r.vbaraw&&i&&(a="xl/vbaProject.bin",De(s,a,r.vbaraw),n.vba.push(a),Ye(t.wbrels,-1,"vbaProject.bin",Ge.VBA)),a="xl/metadata."+e,De(s,a,Xu()),n.metadata.push(a),Ye(t.wbrels,-1,"metadata."+e,Ge.XLMETA),u.length>1&&(a="xl/persons/person.xml",De(s,a,gx(u,t)),n.people.push(a),Ye(t.wbrels,-1,"persons/person.xml",Ge.PEOPLE)),De(s,"[Content_Types].xml",Su(n,t)),De(s,"_rels/.rels",On(t.rels)),De(s,"xl/_rels/workbook."+e+".rels",On(t.wbrels)),delete t.revssf,delete t.ssf,s}function Vw(r,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":e=mi(r.slice(0,12));break;case"binary":e=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function ph(r,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Is(t.file,Je.write(r,{type:Xe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Je.write(r,t)}function $w(r,t){var e=_r(t||{}),i=Rw(r,e);return Hw(i,e)}function Hw(r,t){var e={},i=Xe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=i;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=i;break;default:throw new Error("Unrecognized type "+t.type)}var n=r.FullPaths?Je.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):r.generate(e);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(Da(n))}return t.password&&typeof encrypt_agile<"u"?ph(encrypt_agile(n,t.password),t):t.type==="file"?Is(t.file,n):t.type=="string"?ps(n):n}function Ww(r,t){var e=t||{},i=nw(r,e);return ph(i,e)}function ti(r,t,e){e||(e="");var i=e+r;switch(t.type){case"base64":return ws(hi(i));case"binary":return hi(i);case"string":return r;case"file":return Is(t.file,i,"utf8");case"buffer":return Xe?xi(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):ti(i,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function zw(r,t){switch(t.type){case"base64":return ws(r);case"binary":return r;case"string":return r;case"file":return Is(t.file,r,"binary");case"buffer":return Xe?xi(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function _a(r,t){switch(t.type){case"string":case"base64":case"binary":for(var e="",i=0;i<r.length;++i)e+=String.fromCharCode(r[i]);return t.type=="base64"?ws(e):t.type=="string"?ps(e):e;case"file":return Is(t.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+t.type)}}function mh(r,t){mm(),ky(r);var e=_r(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var i=mh(r,e);return e.type="array",Da(i)}var n=0;if(e.sheet&&(typeof e.sheet=="number"?n=e.sheet:n=r.SheetNames.indexOf(e.sheet),!r.SheetNames[n]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return ti(rw(r,e),e);case"slk":case"sylk":return ti(S1.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"htm":case"html":return ti(uh(r.Sheets[r.SheetNames[n]],e),e);case"txt":return zw(gh(r.Sheets[r.SheetNames[n]],e),e);case"csv":return ti(gl(r.Sheets[r.SheetNames[n]],e),e,"\uFEFF");case"dif":return ti(E1.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"dbf":return _a(T1.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"prn":return ti(I1.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"rtf":return ti(P1.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"eth":return ti(Bu.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"fods":return ti(dh(r,e),e);case"wk1":return _a(R0.sheet_to_wk1(r.Sheets[r.SheetNames[n]],e),e);case"wk3":return _a(R0.book_to_wk3(r,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),_a(ch(r,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),Ww(r,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return $w(r,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function Uw(r){if(!r.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(r.bookType=e.slice(1)),r.bookType=t[r.bookType]||r.bookType}}function ml(r,t,e){var i=e||{};return i.type="file",i.file=t,Uw(i),mh(r,i)}function Gw(r,t,e,i,n,s,a,o){var c=Yt(e),l=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,f=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:e,enumerable:!1})}catch{f.__rowNum__=e}else f.__rowNum__=e;if(!a||r[e])for(var d=t.s.c;d<=t.e.c;++d){var g=a?r[e][d]:r[i[d]+c];if(g===void 0||g.t===void 0){if(l===void 0)continue;s[d]!=null&&(f[s[d]]=l);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[d]!=null){if(p==null)if(g.t=="e"&&p===null)f[s[d]]=null;else if(l!==void 0)f[s[d]]=l;else if(u&&p===null)f[s[d]]=null;else continue;else f[s[d]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?p:gi(g,p,o);p!=null&&(h=!1)}}return{row:f,isempty:h}}function Aa(r,t){if(r==null||r["!ref"]==null)return[];var e={t:"n",v:0},i=0,n=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},u=l.range!=null?l.range:r["!ref"];switch(l.header===1?i=1:l.header==="A"?i=2:Array.isArray(l.header)?i=3:l.header==null&&(i=0),typeof u){case"string":c=st(u);break;case"number":c=st(r["!ref"]),c.s.r=u;break;default:c=u}i>0&&(n=0);var h=Yt(c.s.r),f=[],d=[],g=0,p=0,x=Array.isArray(r),O=c.s.r,A=0,D={};x&&!r[O]&&(r[O]=[]);var G=l.skipHidden&&r["!cols"]||[],te=l.skipHidden&&r["!rows"]||[];for(A=c.s.c;A<=c.e.c;++A)if(!(G[A]||{}).hidden)switch(f[A]=nr(A),e=x?r[O][A]:r[f[A]+h],i){case 1:s[A]=A-c.s.c;break;case 2:s[A]=f[A];break;case 3:s[A]=l.header[A-c.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),o=a=gi(e,null,l),p=D[a]||0,!p)D[a]=1;else{do o=a+"_"+p++;while(D[o]);D[a]=p,D[o]=1}s[A]=o}for(O=c.s.r+n;O<=c.e.r;++O)if(!(te[O]||{}).hidden){var me=Gw(r,c,O,f,i,s,x,l);(me.isempty===!1||(i===1?l.blankrows!==!1:l.blankrows))&&(d[g++]=me.row)}return d.length=g,d}var U0=/"/g;function Xw(r,t,e,i,n,s,a,o){for(var c=!0,l=[],u="",h=Yt(e),f=t.s.c;f<=t.e.c;++f)if(i[f]){var d=o.dense?(r[e]||[])[f]:r[i[f]+h];if(d==null)u="";else if(d.v!=null){c=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:gi(d,null,o));for(var g=0,p=0;g!==u.length;++g)if((p=u.charCodeAt(g))===n||p===s||p===34||o.forceQuotes){u='"'+u.replace(U0,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(c=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(U0,'""')+'"')):u="";l.push(u)}return o.blankrows===!1&&c?null:l.join(a)}function gl(r,t){var e=[],i=t??{};if(r==null||r["!ref"]==null)return"";var n=st(r["!ref"]),s=i.FS!==void 0?i.FS:",",a=s.charCodeAt(0),o=i.RS!==void 0?i.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];i.dense=Array.isArray(r);for(var f=i.skipHidden&&r["!cols"]||[],d=i.skipHidden&&r["!rows"]||[],g=n.s.c;g<=n.e.c;++g)(f[g]||{}).hidden||(h[g]=nr(g));for(var p=0,x=n.s.r;x<=n.e.r;++x)(d[x]||{}).hidden||(u=Xw(r,n,x,h,a,c,s,i),u!=null&&(i.strip&&(u=u.replace(l,"")),(u||i.blankrows!==!1)&&e.push((p++?o:"")+u)));return delete i.dense,e.join("")}function gh(r,t){t||(t={}),t.FS="	",t.RS=`
`;var e=gl(r,t);if(typeof rt>"u"||t.type=="string")return e;var i=rt.utils.encode(1200,e,"str");return"\xFF\xFE"+i}function jw(r){var t="",e,i="";if(r==null||r["!ref"]==null)return[];var n=st(r["!ref"]),s="",a=[],o,c=[],l=Array.isArray(r);for(o=n.s.c;o<=n.e.c;++o)a[o]=nr(o);for(var u=n.s.r;u<=n.e.r;++u)for(s=Yt(u),o=n.s.c;o<=n.e.c;++o)if(t=a[o]+s,e=l?(r[u]||[])[o]:r[t],i="",e!==void 0){if(e.F!=null){if(t=e.F,!e.f)continue;i=e.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(e.f!=null)i=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)i=""+e.v;else if(e.t=="b")i=e.v?"TRUE":"FALSE";else if(e.w!==void 0)i="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?i="'"+e.v:i=""+e.v}}c[c.length]=t+"="+i}return c}function xh(r,t,e){var i=e||{},n=+!i.skipHeader,s=r||{},a=0,o=0;if(s&&i.origin!=null)if(typeof i.origin=="number")a=i.origin;else{var c=typeof i.origin=="string"?Pt(i.origin):i.origin;a=c.r,o=c.c}var l,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+n}};if(s["!ref"]){var h=st(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(a=h.e.r+1,u.e.r=a+t.length-1+n)}else a==-1&&(a=0,u.e.r=t.length-1+n);var f=i.header||[],d=0;t.forEach(function(p,x){qt(p).forEach(function(O){(d=f.indexOf(O))==-1&&(f[d=f.length]=O);var A=p[O],D="z",G="",te=Qe({c:o+d,r:a+x+n});l=Ss(s,te),A&&typeof A=="object"&&!(A instanceof Date)?s[te]=A:(typeof A=="number"?D="n":typeof A=="boolean"?D="b":typeof A=="string"?D="s":A instanceof Date?(D="d",i.cellDates||(D="n",A=xr(A)),G=i.dateNF||ft[14]):A===null&&i.nullError&&(D="e",A=0),l?(l.t=D,l.v=A,delete l.w,delete l.R,G&&(l.z=G)):s[te]=l={t:D,v:A},G&&(l.z=G))})}),u.e.c=Math.max(u.e.c,o+f.length-1);var g=Yt(a);if(n)for(d=0;d<f.length;++d)s[nr(d+o)+g]={t:"s",v:f[d]};return s["!ref"]=_t(u),s}function Kw(r,t){return xh(null,r,t)}function Ss(r,t,e){if(typeof t=="string"){if(Array.isArray(r)){var i=Pt(t);return r[i.r]||(r[i.r]=[]),r[i.r][i.c]||(r[i.r][i.c]={t:"z"})}return r[t]||(r[t]={t:"z"})}return typeof t!="number"?Ss(r,Qe(t)):Ss(r,Qe({r:t,c:e||0}))}function Yw(r,t){if(typeof t=="number"){if(t>=0&&r.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=r.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function qw(){return{SheetNames:[],Sheets:{}}}function Qw(r,t,e,i){var n=1;if(!e)for(;n<=65535&&r.SheetNames.indexOf(e="Sheet"+n)!=-1;++n,e=void 0);if(!e||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&r.SheetNames.indexOf(e)>=0){var s=e.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var a=s&&s[1]||e;for(++n;n<=65535&&r.SheetNames.indexOf(e=a+n)!=-1;++n);}if(ah(e),r.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return r.SheetNames.push(e),r.Sheets[e]=t,e}function Zw(r,t,e){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var i=Yw(r,t);switch(r.Workbook.Sheets[i]||(r.Workbook.Sheets[i]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}r.Workbook.Sheets[i].Hidden=e}function Jw(r,t){return r.z=t,r}function _h(r,t,e){return t?(r.l={Target:t},e&&(r.l.Tooltip=e)):delete r.l,r}function e2(r,t,e){return _h(r,"#"+t,e)}function t2(r,t,e){r.c||(r.c=[]),r.c.push({t,a:e||"SheetJS"})}function r2(r,t,e,i){for(var n=typeof t!="string"?t:st(t),s=typeof t=="string"?t:_t(t),a=n.s.r;a<=n.e.r;++a)for(var o=n.s.c;o<=n.e.c;++o){var c=Ss(r,a,o);c.t="n",c.F=s,delete c.v,a==n.s.r&&o==n.s.c&&(c.f=e,i&&(c.D=!0))}return r}var Br={encode_col:nr,encode_row:Yt,encode_cell:Qe,encode_range:_t,decode_col:nl,decode_row:il,split_cell:xg,decode_cell:Pt,decode_range:Or,format_cell:gi,sheet_add_aoa:_u,sheet_add_json:xh,sheet_add_dom:hh,aoa_to_sheet:Nn,json_to_sheet:Kw,table_to_sheet:fh,table_to_book:Ew,sheet_to_csv:gl,sheet_to_txt:gh,sheet_to_json:Aa,sheet_to_html:uh,sheet_to_formulae:jw,sheet_to_row_object_array:Aa,sheet_get_cell:Ss,book_new:qw,book_append_sheet:Qw,book_set_sheet_visibility:Zw,cell_set_number_format:Jw,cell_set_hyperlink:_h,cell_set_internal_link:e2,cell_add_comment:t2,sheet_set_array_formula:r2,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var NI=vs.version;var _i=class r extends Ee{constructor(){super(),this.xAxisData=[],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}}}}getChartType(){return"line"}getDefaultSeriesOptions(){return{name:"Line Chart",type:"line",smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",aggregateBy:n,sortBy:s,sortOrder:a="asc",limit:o,dateFormat:c}=t;try{let l=this.data.map(u=>({name:u[e]||"Unknown",value:parseFloat(u[i])||0,originalItem:u}));if(n){let u=new Map;l.forEach(h=>{let f=h.name;u.set(f,(u.get(f)||0)+h.value)}),l=Array.from(u.entries()).map(([h,f])=>({name:h,value:f,originalItem:null}))}s==="name"?l.sort((u,h)=>a==="asc"?u.name.localeCompare(h.name):h.name.localeCompare(u.name)):s==="value"&&l.sort((u,h)=>a==="asc"?u.value-h.value:h.value-u.value),o&&o>0&&(l=l.slice(0,o)),this.seriesOptions.data=l.map(u=>u.value),this.xAxisData.length===0&&(this.xAxisData=l.map(u=>u.name),this.setXAxisData(this.xAxisData))}catch(l){console.error("Error transforming line chart data:",l)}return this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis=Y(F({},this.chartOptions.xAxis),{data:t}),this}setXAxisName(t){return this.chartOptions.xAxis=Y(F({},this.chartOptions.xAxis),{name:t}),this}setYAxisName(t){return this.chartOptions.yAxis=Y(F({},this.chartOptions.yAxis),{name:t}),this}setSmooth(t){return this.seriesOptions.smooth=t,this}setSymbol(t,e=6){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setLineStyle(t,e,i="solid"){return this.seriesOptions.lineStyle={width:t,color:e,type:i},this}setAreaStyle(t,e=.3){return this.seriesOptions.areaStyle={color:t,opacity:e},this}setShowSymbol(t){return this.seriesOptions.showSymbol=t,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&(this.setLineStyle(2,e[0]),this.seriesOptions.itemStyle=Y(F({},this.seriesOptions.itemStyle),{color:e[0]})),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setValueFormatter(i),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setValueFormatter(e),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setValueFormatter(i),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=12){let e=[],i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=100;for(let s=0;s<Math.min(t,i.length);s++){let a=(Math.random()-.5)*20;n+=a,e.push({name:i[s],value:Math.round(n),date:i[s],category:["Revenue","Profit","Expenses"][Math.floor(Math.random()*3)]})}return this.setData(e)}setTrendAnalysisConfiguration(){return this.setSmooth(!0).setSymbol("circle",4).setLineStyle(3,"#5470c6").setAreaStyle("#5470c6",.1).setYAxisName("Value").setXAxisName("Time Period").setPredefinedPalette("finance").setTooltip("axis","{b}: {c}")}setPerformanceConfiguration(){return this.setSmooth(!1).setSymbol("diamond",6).setLineStyle(2,"#91cc75").setYAxisName("Performance Score").setXAxisName("Metrics").setPredefinedPalette("business").setTooltip("axis","{b}: {c}%")}setTimeSeriesConfiguration(){return this.setSmooth(!0).setSymbol("none",0).setLineStyle(2,"#fac858").setShowSymbol(!1).setYAxisName("Value").setXAxisName("Time").setPredefinedPalette("modern").setTooltip("axis","{b}: {c}")}build(){let t=Y(F({},this.chartOptions),{series:[Y(F({},this.seriesOptions),{type:"line"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>parseFloat(l.value)||0));let o=t.chartInstance.getOption(),c=Y(F({},o),{series:[Y(F({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating line chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isLineChart(t){return Ee.isChartType(t,"line")}static createLineChartWidget(t,e){let i=r.create();return t&&i.setData(t),e&&i.setXAxisData(e),i.getWidgetBuilder()}static exportData(t){let e=[];if(t.echart_options?.series?.[0]?.data&&t.echart_options?.xAxis?.data){let i=t.echart_options.series[0].data,n=t.echart_options.xAxis.data;for(let s=0;s<i.length;s++){let a=i[s],o=n[s]||`Point ${s+1}`;e.push({Label:o,Value:a||0})}}return e}static getExportHeaders(t){return["Label","Value"]}static getExportSheetName(t){return"Line Chart Data"}};var $n=class r extends Ee{constructor(){super(),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"item",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},polar:{center:["50%","50%"],radius:["30%","80%"],startAngle:0,endAngle:360},angleAxis:{type:"value",startAngle:0,endAngle:360,min:0,max:100,axisLabel:{color:"#666",fontSize:12}},radiusAxis:{type:"value",min:0,max:100,axisLabel:{color:"#666",fontSize:12}}}}getChartType(){return"line"}getDefaultSeriesOptions(){return{name:"Polar Chart",type:"line",coordinateSystem:"polar",smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.3},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setPolarCenter(t){return this.chartOptions.polar.center=t,this}setPolarRadius(t){return this.chartOptions.polar.radius=t,this}setStartAngle(t){return this.chartOptions.polar.startAngle=t,this.chartOptions.angleAxis.startAngle=t,this}setEndAngle(t){return this.chartOptions.polar.endAngle=t,this.chartOptions.angleAxis.endAngle=t,this}setAngleAxisRange(t,e){return this.chartOptions.angleAxis.min=t,this.chartOptions.angleAxis.max=e,this}setRadiusAxisRange(t,e){return this.chartOptions.radiusAxis.min=t,this.chartOptions.radiusAxis.max=e,this}setSmooth(t){return this.seriesOptions.smooth=t,this}setSymbol(t,e=6){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setLineStyle(t,e,i="solid"){return this.seriesOptions.lineStyle={width:t,color:e,type:i},this}setItemStyle(t,e,i){return this.seriesOptions.itemStyle={color:t,borderColor:e,borderWidth:i},this}setAreaStyle(t,e=.3){return this.seriesOptions.areaStyle={color:t,opacity:e},this}setGradientAreaStyle(t,e,i=.3){return this.seriesOptions.areaStyle={color:{type:"radial",x:.5,y:.5,r:.5,colorStops:[{offset:0,color:t},{offset:1,color:e}]},opacity:i},this}setShowSymbol(t){return this.seriesOptions.showSymbol=t,this}setStack(t){return this.seriesOptions.stack=t,this}setSampling(t){return this.seriesOptions.sampling=t,this}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{valueField:e="value",nameField:i="name",categoryField:n="category",sortBy:s,sortOrder:a="desc",limit:o}=t;try{let c=[],l=this.data;t.filters&&t.filters.length>0&&(l=Ee.applyFilters(this.data,t.filters)),l.forEach(u=>{let h=parseFloat(u[e])||0;c.push(h)}),s==="value"&&c.sort((u,h)=>a==="asc"?u-h:h-u),o&&o>0&&(c=c.slice(0,o)),this.seriesOptions.data=c}catch(c){console.error("Error transforming polar chart data:",c)}return this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&(this.setItemStyle(e[0]),this.setLineStyle(2,e[0])),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("item",n=>`${n.seriesName}: ${i(n.value)}`),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("item",i=>`${i.seriesName}: ${e(i.value)}`),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("item",n=>`${n.seriesName}: ${i(n.value)}`),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=8){let e=[];for(let i=0;i<t;i++)e.push({value:Math.floor(Math.random()*100)+10,name:`Metric ${i+1}`,angle:360/t*i,category:["Performance","Quality","Efficiency"][Math.floor(Math.random()*3)],department:["Sales","Marketing","Operations"][Math.floor(Math.random()*3)]});return this.setData(e)}setPerformanceMetricsConfiguration(){return this.setPredefinedPalette("business").setPercentageFormatter(1).setPolarRadius(["20%","80%"]).setAreaStyle("#5470c6",.3).setSmooth(!0)}setRadarAnalysisConfiguration(){return this.setPredefinedPalette("finance").setCustomNumberFormatter(0,"en-US").setPolarRadius(["30%","90%"]).setLineStyle(3,"#91cc75","solid").setSymbol("circle",6)}set360ViewConfiguration(){return this.setPredefinedPalette("modern").setCurrencyFormatter("USD","en-US").setPolarRadius(["10%","95%"]).setStartAngle(0).setEndAngle(360).setAreaStyle("#ee6666",.4)}build(){return this.chartOptions.series=[this.seriesOptions],this.widgetBuilder.setEChartsOptions(this.chartOptions),this.widgetBuilder.build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>parseFloat(l.value)||0));let o=t.chartInstance.getOption(),c=Y(F({},o),{series:[Y(F({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating polar chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isPolarChart(t){return t.config?.options?.series?.[0]?.coordinateSystem==="polar"}static createPolarChartWidget(t){return new mr().setComponent("echart").setEChartsOptions({grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"item",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},polar:{center:["50%","50%"],radius:["30%","80%"],startAngle:0,endAngle:360},angleAxis:{type:"value",startAngle:0,endAngle:360,min:0,max:100,axisLabel:{color:"#666",fontSize:12}},radiusAxis:{type:"value",min:0,max:100,axisLabel:{color:"#666",fontSize:12}},series:[{name:"Polar Chart",type:"line",coordinateSystem:"polar",data:t||[],smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.3},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}static exportData(t){if(!r.isPolarChart(t))return[];let i=t.config?.options?.series;if(!i||i.length===0)return[];let n=[];return i.forEach((s,a)=>{s.data&&s.data.forEach((o,c)=>{a===0&&(n[c]=[`Point ${c+1}`]),n[c]&&n[c].push(o||0)})}),n}static getExportHeaders(t){let i=t.config?.options?.series;return!i||i.length===0?["Angle"]:["Angle",...i.map(n=>n.name||"Series")]}static getExportSheetName(t){return`PolarChart_${(t.config?.header?.title||"Polar Chart").replace(/[^a-zA-Z0-9]/g,"_")}`}};var Hn=class r extends Ee{constructor(){super(),this.xAxisData=[],this.multiSeriesData=[],this.colors=["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4"],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}}}}getChartType(){return"line"}getDefaultSeriesOptions(){return{name:"Stacked Area",type:"line",smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.6,origin:"auto"},stack:"total",emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}setMultiSeriesData(t){return this.multiSeriesData=t,this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{seriesField:e="series",valueField:i="value",categoryField:n="category",timeField:s="time",sortBy:a,sortOrder:o="asc",limit:c}=t;try{let l=this.data;t.filters&&t.filters.length>0&&(l=Ee.applyFilters(this.data,t.filters));let u=new Map,h=new Set;l.forEach(g=>{let p=g[e]||"Default",x=g[n]||g[s]||"Unknown",O=parseFloat(g[i])||0;u.has(p)||u.set(p,new Map),u.get(p).set(x,(u.get(p).get(x)||0)+O),h.add(x)});let f=Array.from(h).sort();this.setXAxisData(f);let d=[];u.forEach((g,p)=>{let x=f.map(O=>g.get(O)||0);d.push({name:p,data:x})}),a==="total"&&d.sort((g,p)=>{let x=g.data.reduce((A,D)=>A+D,0),O=p.data.reduce((A,D)=>A+D,0);return o==="asc"?x-O:O-x}),c&&c>0&&d.splice(c),this.setMultiSeriesData(d)}catch(l){console.error("Error transforming stacked area chart data:",l)}return this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis.data=t,this}setXAxisName(t){return this.chartOptions.xAxis.name=t,this}setYAxisName(t){return this.chartOptions.yAxis.name=t,this}setSmooth(t){return this.seriesOptions.smooth=t,this}setSymbol(t,e=6){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setLineStyle(t,e,i="solid"){return this.seriesOptions.lineStyle={width:t,color:e,type:i},this}setItemStyle(t,e,i){return this.seriesOptions.itemStyle={color:t,borderColor:e,borderWidth:i},this}setAreaStyle(t,e=.6){return this.seriesOptions.areaStyle={color:t,opacity:e,origin:"auto"},this}setGradientAreaStyle(t,e,i=.6){return this.seriesOptions.areaStyle={color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:t},{offset:1,color:e}]},opacity:i,origin:"auto"},this}setShowSymbol(t){return this.seriesOptions.showSymbol=t,this}setStack(t){return this.seriesOptions.stack=t,this}setSampling(t){return this.seriesOptions.sampling=t,this}setColors(t){return this.colors=t,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&this.setColors(e),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("axis",n=>{if(!Array.isArray(n))return"";let s=`${n[0].name}<br/>`;return n.forEach(a=>{s+=`${a.seriesName}: ${i(a.value)}<br/>`}),s}),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("axis",i=>{if(!Array.isArray(i))return"";let n=`${i[0].name}<br/>`;return i.forEach(s=>{n+=`${s.seriesName}: ${e(s.value)}<br/>`}),n}),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("axis",n=>{if(!Array.isArray(n))return"";let s=`${n[0].name}<br/>`;return n.forEach(a=>{s+=`${a.seriesName}: ${i(a.value)}<br/>`}),s}),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=3,e=7){let i=[],n=["Revenue","Expenses","Profit","Investment","Savings"].slice(0,t),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].slice(0,e);for(let a of n){let o=[];for(let c=0;c<e;c++)o.push(Math.floor(Math.random()*200)+50);i.push({name:a,data:o,category:["Primary","Secondary","Tertiary"][Math.floor(Math.random()*3)]})}return this.setMultiSeriesData(i),this.setXAxisData(s),this}setFinancialAnalysisConfiguration(){return this.setPredefinedPalette("finance").setCurrencyFormatter("USD","en-US").setXAxisName("Time Period").setYAxisName("Amount").setStack("financial").setSmooth(!0)}setPerformanceMonitoringConfiguration(){return this.setPredefinedPalette("business").setPercentageFormatter(1).setXAxisName("Metrics").setYAxisName("Performance").setStack("performance").setAreaStyle("#5470c6",.5)}setTrendAnalysisConfiguration(){return this.setPredefinedPalette("modern").setCustomNumberFormatter(0,"en-US").setXAxisName("Period").setYAxisName("Value").setStack("trend").setSmooth(!1).setSymbol("circle",4)}build(){let t=[];return this.multiSeriesData.length>0?this.multiSeriesData.forEach((e,i)=>{let n=Y(F({},this.seriesOptions),{name:e.name,data:e.data,itemStyle:{color:this.colors[i%this.colors.length]},areaStyle:{color:this.colors[i%this.colors.length],opacity:.6,origin:"auto"},lineStyle:{width:2,color:this.colors[i%this.colors.length],type:"solid"}});t.push(n)}):t.push(this.seriesOptions),this.chartOptions.series=t,this.widgetBuilder.setEChartsOptions(this.chartOptions),this.widgetBuilder.build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>({name:l.name||"Series",data:l.data||[],type:"line",stack:"total",areaStyle:{}})));let o=t.chartInstance.getOption(),c=Y(F({},o),{series:a});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating stacked area chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isStackedAreaChart(t){let e=t.config?.options;return e?.series?.[0]?.type==="line"&&e?.series?.[0]?.areaStyle&&e?.series?.[0]?.stack}static createStackedAreaChartWidget(t,e){let i=["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4"],n=[];return t&&t.length>0&&t.forEach((a,o)=>{n.push({name:a.name,type:"line",data:a.data,smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:i[o%i.length],type:"solid"},itemStyle:{color:i[o%i.length]},areaStyle:{color:i[o%i.length],opacity:.6,origin:"auto"},stack:"total",emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}})}),new mr().setComponent("echart").setEChartsOptions({grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:e||[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}},series:n})}static exportData(t){if(!r.isStackedAreaChart(t))return[];let e=t.config?.options,i=e?.series,n=e?.xAxis;if(!i||i.length===0)return[];let s=[];n&&(Array.isArray(n)?s=n[0]?.data||[]:n.data&&(s=n.data)),s.length===0&&i[0]?.data&&(s=i[0].data.map((o,c)=>`Point ${c+1}`));let a=[];return i.forEach((o,c)=>{o.data&&o.data.forEach((l,u)=>{c===0&&(a[u]=[s[u]||`Point ${u+1}`]),a[u]&&a[u].push(l||0)})}),a}static getExportHeaders(t){let i=t.config?.options?.series;return!i||i.length===0?["Category"]:["Category",...i.map(n=>n.name||"Series")]}static getExportSheetName(t){return`StackedAreaChart_${(t.config?.header?.title||"Stacked Area Chart").replace(/[^a-zA-Z0-9]/g,"_")}`}};var Wn=class r extends Ee{constructor(){super(),this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{tooltip:{trigger:"item",formatter:"{b}: {c}"},series:[]}}getChartType(){return"treemap"}getDefaultSeriesOptions(){return{name:"Treemap Chart",type:"treemap",breadcrumb:{show:!0,top:"10%",left:"10%",right:"10%",bottom:"10%"},itemStyle:{borderColor:"#fff",borderWidth:1,gapWidth:1},label:{show:!0,formatter:"{b}",fontSize:12,color:"#333"},levels:[{itemStyle:{borderColor:"#777",borderWidth:0,gapWidth:1},label:{show:!1}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},label:{show:!0}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},label:{show:!0}}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},roam:!0,nodeClick:"zoomToNode"}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setBreadcrumb(t,e,i,n,s){return this.seriesOptions.breadcrumb={show:t,top:e,left:i,right:n,bottom:s},this}setItemStyle(t,e,i){return this.seriesOptions.itemStyle={borderColor:t,borderWidth:e,gapWidth:i},this}setLabelFormatter(t){return this.seriesOptions.label||(this.seriesOptions.label={}),this.seriesOptions.label.formatter=t,this}setLevels(t){return this.seriesOptions.levels=t,this}setRoam(t){return this.seriesOptions.roam=t,this}setNodeClick(t){return this.seriesOptions.nodeClick=t,this}setSize(t,e){return this.seriesOptions.width=t,this.seriesOptions.height=e,this}build(){let t=Y(F({},this.chartOptions),{series:[Y(F({},this.seriesOptions),{type:"treemap"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e,i){Ee.updateData(t,e,i)}static transformToTreemapData(t,e){if(!t||t.length===0)return[];let i=e?.valueField||"value",n=e?.nameField||"name",s=e?.childrenField||"children",a=e?.maxDepth||3,o=e?.minValue||0,c=(l,u)=>{let h={name:String(l[n])||"Unknown",value:Number(l[i])||0};return h.value<o||u<a&&l[s]&&Array.isArray(l[s])&&(h.children=l[s].map(f=>c(f,u+1)).filter(f=>f.value>=o)),h};return t.map(l=>c(l,0))}static createHierarchyFromFlat(t,e){let{idField:i,parentField:n,valueField:s,nameField:a}=e,o=new Map,c=[];return t.forEach(l=>{let u={name:String(l[a])||"Unknown",value:Number(l[s])||0,children:[]};o.set(l[i],u)}),t.forEach(l=>{let u=o.get(l[i]);if(!u)return;let h=l[n];if(h&&o.has(h)){let f=o.get(h);f&&f.children&&f.children.push(u)}else c.push(u)}),c}setFinancialDisplay(t="USD",e="en-US"){this.setCurrencyFormatter(t,e);let i=new Intl.NumberFormat(e,{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0});return this.setLabelFormatter(n=>`${n.data.name}
${i.format(n.data.value)}`),this}setPercentageDisplay(t=1){return this.setPercentageFormatter(t),this.setLabelFormatter(e=>`${e.data.name}
${e.data.value.toFixed(t)}%`),this}setZoomBehavior(t=!0,e="zoomToNode",i=!0){return this.setRoam(i),e&&this.setNodeClick(e),this}setPortfolioConfiguration(){return this.setBreadcrumb(!0,"10%","10%","10%","10%").setItemStyle("#fff",1,1).setLevels([{itemStyle:{borderColor:"#777",borderWidth:0,gapWidth:1},label:{show:!1}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},label:{show:!0,formatter:`{b}
{c}%`}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},label:{show:!0,formatter:`{b}
{c}%`}}]).setEmphasis(10,0,"rgba(0, 0, 0, 0.5)").setZoomBehavior(!0,"zoomToNode",!0)}setExpenseConfiguration(){return this.setBreadcrumb(!0,"10%","10%","10%","10%").setItemStyle("#fff",1,1).setLevels([{itemStyle:{borderColor:"#777",borderWidth:0,gapWidth:1},label:{show:!1}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},label:{show:!0,formatter:"{b}\n${c}K"}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},label:{show:!0,formatter:"{b}\n${c}K"}}]).setEmphasis(10,0,"rgba(0, 0, 0, 0.5)").setZoomBehavior(!0,"zoomToNode",!0)}static isTreemapChart(t){return Ee.isChartType(t,"treemap")}static createTreemapChartWidget(t){let e=new r;return t&&e.setData(t),e.widgetBuilder}static exportData(t){let e=t.echartsOptions;if(!e||!e.series||!e.series[0]||!e.series[0].data)return[];let i=e.series[0].data;return this.flattenTreemapData(i)}static getExportHeaders(t){return["Name","Value","Level"]}static getExportSheetName(t){return"Treemap Data"}static flattenTreemapData(t,e=0){let i=[];for(let n of t)i.push({name:n.name,value:n.value,level:e}),n.children&&n.children.length>0&&i.push(...this.flattenTreemapData(n.children,e+1));return i}};var zn=class r extends Ee{constructor(){super(),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{tooltip:{trigger:"item",formatter:"{b}: {c}"},legend:{show:!0,orient:"vertical",left:"left",top:"middle"}}}getChartType(){return"sunburst"}getDefaultSeriesOptions(){return{name:"Sunburst Chart",type:"sunburst",radius:["20%","90%"],center:["50%","50%"],itemStyle:{borderWidth:2,borderColor:"#fff"},label:{show:!0,formatter:"{b}",position:"inside",fontSize:12,color:"#fff",rotate:"radial"},levels:[{itemStyle:{borderWidth:2,borderColor:"#777"}},{itemStyle:{borderWidth:1,borderColor:"#555"}},{itemStyle:{borderWidth:1,borderColor:"#333"}}],sort:"desc",animationDuration:1e3,animationEasing:"cubicOut"}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setRadius(t){return this.seriesOptions.radius=t,this}setCenter(t){return this.seriesOptions.center=t,this}setLevels(t){return this.seriesOptions.levels=t,this}setSort(t){return this.seriesOptions.sort=t,this}setAnimationDuration(t){return this.seriesOptions.animationDuration=t,this}setAnimationEasing(t){return this.seriesOptions.animationEasing=t,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&this.setLevels([{itemStyle:{color:e[0]}},{itemStyle:{color:e[1]||e[0]}},{itemStyle:{color:e[2]||e[0]}}]),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("item",n=>`${n.data.name}: ${i(n.data.value)}`),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("item",i=>`${i.data.name}: ${e(i.data.value)}`),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("item",n=>`${n.data.name}: ${i(n.data.value)}`),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(){let t=[{name:"Technology",value:100,children:[{name:"Software",value:60,children:[{name:"Frontend",value:30},{name:"Backend",value:30}]},{name:"Hardware",value:40,children:[{name:"Servers",value:25},{name:"Devices",value:15}]}]},{name:"Marketing",value:80,children:[{name:"Digital",value:50},{name:"Traditional",value:30}]},{name:"Operations",value:70,children:[{name:"Logistics",value:40},{name:"Support",value:30}]}];return this.setData(t)}setOrganizationalStructureConfiguration(){return this.setPredefinedPalette("business").setCustomNumberFormatter(0,"en-US").setRadius(["15%","85%"]).setLabelFormatter("{b}").setSort("desc")}setBudgetAllocationConfiguration(){return this.setPredefinedPalette("finance").setCurrencyFormatter("USD","en-US").setRadius(["20%","90%"]).setLabelFormatter("{b}: {c}").setSort("desc")}setCategoryAnalysisConfiguration(){return this.setPredefinedPalette("modern").setPercentageFormatter(1).setRadius(["25%","95%"]).setLabelFormatter("{b}").setSort("desc")}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",parentField:n="parent",levelField:s="level",categoryField:a="category",sortBy:o,sortOrder:c="desc",limit:l}=t;try{let u=this.data;t.filters&&t.filters.length>0&&(u=Ee.applyFilters(this.data,t.filters));let h=this.buildHierarchy(u,e,i,n,s);o==="value"&&this.sortHierarchy(h,c),l&&l>0&&h.length>l&&h.splice(l),this.seriesOptions.data=h}catch(u){console.error("Error transforming sunburst chart data:",u)}return this}buildHierarchy(t,e,i,n,s){let a=new Map,o=[];return t.forEach(c=>{let l=c[e]||"Unknown",u=parseFloat(c[i])||0,h=c[n],f={name:l,value:u,children:[]};a.set(l,f),h||o.push(f)}),t.forEach(c=>{let l=c[e]||"Unknown",u=c[n];if(u&&a.has(u)&&a.has(l)){let h=a.get(u),f=a.get(l);h.children||(h.children=[]),h.children.push(f)}}),o}sortHierarchy(t,e){t.sort((i,n)=>{let s=i.value||0,a=n.value||0;return e==="asc"?s-a:a-s}),t.forEach(i=>{i.children&&i.children.length>0&&this.sortHierarchy(i.children,e)})}build(){let t=Y(F({},this.chartOptions),{series:[Y(F({},this.seriesOptions),{type:"sunburst"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>({name:l.name||"Unknown",value:parseFloat(l.value)||0,children:l.children||[]})));let o=t.chartInstance.getOption(),c=Y(F({},o),{series:[Y(F({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating sunburst chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isSunburstChart(t){return Ee.isChartType(t,"sunburst")}static createSunburstChartWidget(t){return r.create().setData(t||[]).setHeader("Sunburst Chart").setPosition({x:0,y:0,cols:4,rows:4}).getWidgetBuilder()}static exportData(t){let e=t.data||[],i=[],n=(s,a=0,o="")=>{s.forEach(c=>{i.push({Level:a,Parent:o,Name:c.name,Value:c.value||0}),c.children&&c.children.length>0&&n(c.children,a+1,c.name)})};return n(e),i}static getExportHeaders(t){return["Level","Parent","Name","Value"]}static getExportSheetName(t){return(t.config?.header?.title||"Sunburst Chart").replace(/[^a-zA-Z0-9\s]/g,"").substring(0,31)}};var Un=class r extends Ee{constructor(){super(),this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{tooltip:{trigger:"item",triggerOn:"mousemove",formatter:"{b}: {c}"},legend:{show:!1}}}getChartType(){return"sankey"}getDefaultSeriesOptions(){return{name:"Sankey Chart",type:"sankey",emphasis:{focus:"adjacency"},lineStyle:{color:"source",curveness:.5}}}setData(t){return this.seriesOptions.data=t.nodes,this.seriesOptions.links=t.links,super.setData(t),this}setNodeWidth(t){return this.seriesOptions.nodeWidth=t,this}setNodeGap(t){return this.seriesOptions.nodeGap=t,this}setNodeAlign(t){return this.seriesOptions.nodeAlign=t,this}setLayoutIterations(t){return this.seriesOptions.layoutIterations=t,this}setLayout(t){return this.seriesOptions.layout=t,this}setCurveness(t){return this.seriesOptions.lineStyle||(this.seriesOptions.lineStyle={}),this.seriesOptions.lineStyle.curveness=t,this}setLineColor(t){return this.seriesOptions.lineStyle||(this.seriesOptions.lineStyle={}),this.seriesOptions.lineStyle.color=t,this}setNodeColors(t){return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.color=t,this}setEmphasisFocus(t){return this.seriesOptions.emphasis||(this.seriesOptions.emphasis={}),this.seriesOptions.emphasis.focus=t,this}build(){let t=this.seriesOptions.data?.nodes,e=this.seriesOptions.data?.links,i=Y(F({},this.chartOptions),{series:[Y(F({},this.seriesOptions),{type:"sankey",data:t,links:e})]});return this.widgetBuilder.setEChartsOptions(i).build()}static updateData(t,e,i){t.config?.options?.series?.[0]&&(t.config.options.series[0].data=e.nodes,t.config.options.series[0].links=e.links),t.data=e,Ee.updateData(t,e,i)}static transformToSankeyData(t,e){if(!t||t.length===0)return{nodes:[],links:[]};let i=e?.sourceField||"source",n=e?.targetField||"target",s=e?.valueField||"value",a=e?.aggregateBy||"sum",o=new Set;t.forEach(h=>{o.add(String(h[i])),o.add(String(h[n]))});let c=Array.from(o).map(h=>({name:h})),l=new Map;t.forEach(h=>{let f=String(h[i]),d=String(h[n]),g=Number(h[s])||1,p=`${f}->${d}`;if(l.has(p)){let x=l.get(p);l.set(p,a==="sum"?x+g:x+1)}else l.set(p,a==="sum"?g:1)});let u=Array.from(l.entries()).map(([h,f])=>{let[d,g]=h.split("->");return{source:d,target:g,value:f}});return{nodes:c,links:u}}setFinancialFlow(){return this.setNodeWidth(20).setNodeGap(8).setLayout("left").setCurveness(.5).setEmphasisFocus("adjacency").setNodeColors(["#5470c6","#91cc75","#fac858","#ee6666","#73c0de"])}setBudgetAllocation(){return this.setNodeWidth(15).setNodeGap(10).setLayout("left").setCurveness(.4).setEmphasisFocus("adjacency").setNodeColors(["#2E8B57","#4682B4","#DAA520","#DC143C","#9370DB"])}setInvestmentFlow(){return this.setNodeWidth(25).setNodeGap(12).setLayout("left").setCurveness(.3).setEmphasisFocus("adjacency").setNodeColors(["#667eea","#764ba2","#f093fb","#f5576c","#4facfe"])}setPercentageDisplay(){return this.setTooltip("item",t=>t.data.source?`${t.data.source} \u2192 ${t.data.target}<br/>Value: ${t.data.value}%`:`${t.data.name}<br/>Total: ${t.data.value||0}%`),this}setCurrencyDisplay(t="USD",e="en-US"){let i=new Intl.NumberFormat(e,{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0});return this.setTooltip("item",n=>n.data.source?`${n.data.source} \u2192 ${n.data.target}<br/>Amount: ${i.format(n.data.value)}`:`${n.data.name}<br/>Total: ${i.format(n.data.value||0)}`),this}setMinimalConfiguration(){return this.setNodeWidth(10).setNodeGap(5).setLayout("none").setCurveness(.5).setEmphasisFocus("adjacency")}static isSankeyChart(t){return t.config?.component==="echart"&&t.config?.options?.series?.[0]?.type==="sankey"}static exportData(t){let e=t.data;return!e||!e.links?[]:e.links.map(i=>({Source:i.source,Target:i.target,Value:i.value}))}static getExportHeaders(t){return["Source","Target","Value"]}static getExportSheetName(t){return(t.config?.header?.title||"Sankey Chart").replace(/[^a-zA-Z0-9\s]/g,"").substring(0,31)}};var vh=class r extends Ee{constructor(){super(),this.xAxisData=[],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:t=>{let e=Array.isArray(t)?t[0]:t,i=e.data;return`${e.name}<br/>
                  Open: ${i[1]}<br/>
                  Close: ${i[2]}<br/>
                  Low: ${i[3]}<br/>
                  High: ${i[4]}`}},xAxis:{type:"category",data:[]},yAxis:{type:"value",scale:!0}}}getChartType(){return"candlestick"}getDefaultSeriesOptions(){return{name:"Candlestick",type:"candlestick",data:[],itemStyle:{color:"#ec0000",color0:"#00da3c",borderColor:"#8A0000",borderColor0:"#008F28",borderWidth:1}}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{dateField:e="date",openField:i="open",closeField:n="close",lowField:s="low",highField:a="high",sortBy:o,sortOrder:c="asc",limit:l}=t;try{let u=[],h=[],f=this.data;if(t.filters&&t.filters.length>0&&(f=Ee.applyFilters(this.data,t.filters)),f.forEach(d=>{let g=d[e],p=parseFloat(d[i])||0,x=parseFloat(d[n])||0,O=parseFloat(d[s])||0,A=parseFloat(d[a])||0;h.push(g),u.push([p,x,O,A])}),o==="date"){let d=h.map((g,p)=>({label:g,data:u[p]}));d.sort((g,p)=>{let x=new Date(g.label).getTime(),O=new Date(p.label).getTime();return c==="asc"?x-O:O-x}),h=d.map(g=>g.label),u=d.map(g=>g.data)}l&&l>0&&(h=h.slice(0,l),u=u.slice(0,l)),this.seriesOptions.data=u,this.setXAxisData(h)}catch(u){console.error("Error transforming candlestick chart data:",u)}return this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis=Y(F({},this.chartOptions.xAxis),{data:t}),this}setXAxisName(t){return this.chartOptions.xAxis=Y(F({},this.chartOptions.xAxis),{name:t}),this}setYAxisName(t){return this.chartOptions.yAxis=Y(F({},this.chartOptions.yAxis),{name:t}),this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>=2&&(this.seriesOptions.itemStyle=Y(F({},this.seriesOptions.itemStyle),{color:e[0],color0:e[1],borderColor:e[0],borderColor0:e[1]})),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("axis",n=>{let s=Array.isArray(n)?n[0]:n,a=s.data;return`${s.name}<br/>
              Open: ${i(a[1])}<br/>
              Close: ${i(a[2])}<br/>
              Low: ${i(a[3])}<br/>
              High: ${i(a[4])}`}),this}setPercentageFormatter(t=2){let e=this.createPercentageFormatter(t);return this.setTooltip("axis",i=>{let n=Array.isArray(i)?i[0]:i,s=n.data;return`${n.name}<br/>
              Open: ${e(s[1])}<br/>
              Close: ${e(s[2])}<br/>
              Low: ${e(s[3])}<br/>
              High: ${e(s[4])}`}),this}setCustomNumberFormatter(t=2,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("axis",n=>{let s=Array.isArray(n)?n[0]:n,a=s.data;return`${s.name}<br/>
              Open: ${i(a[1])}<br/>
              Close: ${i(a[2])}<br/>
              Low: ${i(a[3])}<br/>
              High: ${i(a[4])}`}),this}setBorderColors(t,e){return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.borderColor=t,this.seriesOptions.itemStyle.borderColor0=e,this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=30){let e=[],i=100;for(let n=0;n<t;n++){let s=new Date;s.setDate(s.getDate()-(t-n));let a=i,o=(Math.random()-.5)*10,c=Math.max(.1,a+o),l=Math.max(a,c)+Math.random()*5,u=Math.min(a,c)-Math.random()*5;e.push({date:s.toISOString().split("T")[0],open:parseFloat(a.toFixed(2)),close:parseFloat(c.toFixed(2)),high:parseFloat(l.toFixed(2)),low:parseFloat(u.toFixed(2)),volume:Math.floor(Math.random()*1e6),symbol:"SAMPLE"}),i=c}return this.setData(e)}setStockAnalysisConfiguration(){return this.setPredefinedPalette("finance").setXAxisName("Date").setYAxisName("Price").setCurrencyFormatter("USD","en-US").setTooltip("axis")}setCryptoAnalysisConfiguration(){return this.setPredefinedPalette("modern").setXAxisName("Date").setYAxisName("Price (USD)").setCurrencyFormatter("USD","en-US")}setForexAnalysisConfiguration(){return this.setPredefinedPalette("business").setXAxisName("Date").setYAxisName("Exchange Rate").setCustomNumberFormatter(4,"en-US")}build(){let t=Y(F({},this.chartOptions),{series:[Y(F({},this.seriesOptions),{type:"candlestick"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>[parseFloat(l.open)||0,parseFloat(l.close)||0,parseFloat(l.low)||0,parseFloat(l.high)||0]));let o=t.chartInstance.getOption(),c=Y(F({},o),{series:[Y(F({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating candlestick chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isCandlestickChart(t){return Ee.isChartType(t,"candlestick")}static exportData(t){let e=[];if(t.echart_options?.series?.[0]?.data&&t.echart_options?.xAxis?.data){let i=t.echart_options.series[0].data,n=t.echart_options.xAxis.data;i.forEach((s,a)=>{e.push({Date:n[a]||`Day ${a+1}`,Open:s[0]||0,Close:s[1]||0,Low:s[2]||0,High:s[3]||0})})}return e}static getExportHeaders(t){return["Date","Open","Close","Low","High"]}static getExportSheetName(t){return"Candlestick Chart Data"}};var Ha=(()=>{let t=class t{exportDashboardToExcel(s){return Bt(this,arguments,function*(i,n={}){let{filename:a=`dashboard-export-${new Date().toISOString().split("T")[0]}.xlsx`,includeHeaders:o=!0,includeTimestamp:c=!0,sheetNamePrefix:l="Widget",autoColumnWidth:u=!0,includeWidgetTitles:h=!0}=n;try{let f=Br.book_new();c&&this.addTimestampSheet(f);for(let d of i)try{yield this.exportWidgetToSheet(f,d,{includeHeaders:o,sheetNamePrefix:l,autoColumnWidth:u,includeWidgetTitles:h})}catch(g){console.error(`Error exporting widget ${d.id} to Excel:`,g)}ml(f,a)}catch(f){throw console.error("Error exporting dashboard to Excel:",f),new Error("Failed to export dashboard to Excel")}})}exportWidgetToSheet(i,n,s){return Bt(this,null,function*(){let{includeHeaders:a,sheetNamePrefix:o,autoColumnWidth:c,includeWidgetTitles:l}=s,u=this.getDataExtractor(n);if(!u){console.warn(`No data extractor found for widget type: ${n.config?.component}`);return}try{let h=u.extractData(n),f=u.getHeaders(n),d=u.getSheetName(n);if(!h||h.length===0){console.warn(`No data found for widget: ${n.id}`);let x=[[n.config?.header?.title||"Widget Data"],[],["No data available for export"],["Widget ID:",n.id],["Component:",n.config?.component||"Unknown"],["Export Time:",new Date().toLocaleString()]],O=Br.aoa_to_sheet(x);Br.book_append_sheet(i,O,d);return}let g=[];l&&n.config?.header?.title&&(g.push([n.config.header.title]),g.push([])),a&&f.length>0&&g.push(f),g=g.concat(h);let p=Br.aoa_to_sheet(g);c&&this.autoResizeColumns(p,g),Br.book_append_sheet(i,p,d)}catch(h){console.error(`Error processing widget ${n.id}:`,h);let f=[[n.config?.header?.title||"Widget Data"],[],["Error occurred during export"],["Widget ID:",n.id],["Component:",n.config?.component||"Unknown"],["Error:",h instanceof Error?h.message:String(h)],["Export Time:",new Date().toLocaleString()]],d=Br.aoa_to_sheet(f),g=this.getErrorSheetName(n);Br.book_append_sheet(i,d,g)}})}addTimestampSheet(i){let n=new Date().toLocaleString(),s=[["Dashboard Export Information"],[],["Export Date:",n],["Generated by:","MoneyPlant Dashboard"],["Total Sheets:","Multiple"],["Export Type:","Dashboard Data Export"]],a=Br.aoa_to_sheet(s);Br.book_append_sheet(i,a,"Export Info")}autoResizeColumns(i,n){if(!n||n.length===0)return;let s=Math.max(...n.map(a=>a.length));for(let a=0;a<s;a++){let o=10;for(let l of n)if(l[a]!==void 0){let u=String(l[a]);o=Math.max(o,u.length)}let c=Br.encode_col(a);i["!cols"]=i["!cols"]||[],i["!cols"][a]={width:Math.min(o+2,50)}}}getDataExtractor(i){let n=i.config?.component,s=i.config?.options?.series?.[0]?.type;return n==="echart"&&s?this.getChartDataExtractor(s):n==="table"?{extractData:a=>a.config?.options?.data||[],getHeaders:a=>a.config?.options?.columns||[],getSheetName:a=>this.getWidgetSheetName(a,"Table")}:n==="tile"?{extractData:a=>{let o=a.config?.options;return[[o?.value||"",o?.change||"",o?.changeType||"",o?.description||""]]},getHeaders:()=>["Value","Change","Type","Description"],getSheetName:a=>this.getWidgetSheetName(a,"Tile")}:this.getGenericDataExtractor()}getChartDataExtractor(i){switch(i.toLowerCase()){case"pie":return{extractData:n=>gn.exportData(n),getHeaders:n=>gn.getExportHeaders(n),getSheetName:n=>gn.getExportSheetName(n)};case"bar":return{extractData:n=>xn.exportData(n),getHeaders:n=>xn.getExportHeaders(n),getSheetName:n=>xn.getExportSheetName(n)};case"line":return{extractData:n=>_i.exportData(n),getHeaders:n=>_i.getExportHeaders(n),getSheetName:n=>_i.getExportSheetName(n)};case"scatter":return{extractData:n=>_n.exportData(n),getHeaders:n=>_n.getExportHeaders(n),getSheetName:n=>_n.getExportSheetName(n)};case"gauge":return{extractData:n=>vn.exportData(n),getHeaders:n=>vn.getExportHeaders(n),getSheetName:n=>vn.getExportSheetName(n)};case"heatmap":return{extractData:n=>yn.exportData(n),getHeaders:n=>yn.getExportHeaders(n),getSheetName:n=>yn.getExportSheetName(n)};case"map":return{extractData:n=>wn.exportData(n),getHeaders:n=>wn.getExportHeaders(n),getSheetName:n=>wn.getExportSheetName(n)};case"treemap":return{extractData:n=>Wn.exportData(n),getHeaders:n=>Wn.getExportHeaders(n),getSheetName:n=>Wn.getExportSheetName(n)};case"sunburst":return{extractData:n=>zn.exportData(n),getHeaders:n=>zn.getExportHeaders(n),getSheetName:n=>zn.getExportSheetName(n)};case"sankey":return{extractData:n=>Un.exportData(n),getHeaders:n=>Un.getExportHeaders(n),getSheetName:n=>Un.getExportSheetName(n)};default:return this.getSpecialChartDataExtractor(i)}}getSpecialChartDataExtractor(i){return{extractData:n=>{let a=n.config?.options?.series?.[0];return a?.type==="line"&&a?.areaStyle?a?.stack?Hn.exportData(n):Gn.exportData(n):a?.type==="line"&&a?.coordinateSystem==="polar"?$n.exportData(n):_i.exportData(n)},getHeaders:n=>{let a=n.config?.options?.series?.[0];return a?.type==="line"&&a?.areaStyle?a?.stack?Hn.getExportHeaders(n):Gn.getExportHeaders(n):a?.type==="line"&&a?.coordinateSystem==="polar"?$n.getExportHeaders(n):_i.getExportHeaders(n)},getSheetName:n=>{let a=n.config?.options?.series?.[0];return a?.type==="line"&&a?.areaStyle?a?.stack?Hn.getExportSheetName(n):Gn.getExportSheetName(n):a?.type==="line"&&a?.coordinateSystem==="polar"?$n.getExportSheetName(n):_i.getExportSheetName(n)}}}getGenericDataExtractor(){return{extractData:i=>this.extractGenericData(i),getHeaders:()=>["Property","Value"],getSheetName:i=>this.getWidgetSheetName(i,"Generic")}}extractGenericData(i){let n=[];if(n.push(["Widget ID",i.id]),n.push(["Component Type",i.config?.component||"Unknown"]),n.push(["Title",i.config?.header?.title||"Untitled"]),i.config?.options){let s=i.config.options;Object.keys(s).forEach(a=>{(typeof s[a]!="object"||s[a]===null)&&n.push([a,s[a]])})}return i.series&&i.series.length>0&&n.push(["Series Data",JSON.stringify(i.series)]),n}getWidgetSheetName(i,n){let a=(i.config?.header?.title||i.id).replace(/[^a-zA-Z0-9\s]/g,"").substring(0,20);return`${n}_${a}`}getErrorSheetName(i){return`Error_${i.id}`}exportWidgetToExcel(s){return Bt(this,arguments,function*(i,n={}){let{filename:a=`${i.id}-export-${new Date().toISOString().split("T")[0]}.xlsx`,includeHeaders:o=!0,includeTimestamp:c=!0,autoColumnWidth:l=!0,includeWidgetTitles:u=!0}=n;try{let h=Br.book_new();c&&this.addTimestampSheet(h),yield this.exportWidgetToSheet(h,i,{includeHeaders:o,sheetNamePrefix:"Widget",autoColumnWidth:l,includeWidgetTitles:u}),ml(h,a)}catch(h){throw console.error("Error exporting widget to Excel:",h),new Error("Failed to export widget to Excel")}})}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=yt({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();var s2=()=>({width:"30%",height:"100%",padding:"0px","padding-right":"2px"});function a2(r,t){if(r&1){let e=ge();P(0,"p-button",9),ce("click",function(n){X(e);let s=y(2);return j(s.onDeleteWidgetClicked(n))}),L(),P(1,"p-button",10),ce("click",function(){X(e);let n=y(2);return j(n.sidebarVisible=!0)}),L()}r&2&&(w("outlined",!0),S(),w("outlined",!0)("outlined",!0))}function o2(r,t){if(r&1){let e=ge();dt(0,a2,2,3),P(1,"p-button",8,1),ce("click",function(n){X(e),y();let s=mt(3);return j(s.toggle(n))}),L()}if(r&2){let e=y();pt(e.onEditMode?0:-1),S(),w("outlined",!0)}}function l2(r,t){if(r&1&&(P(0,"div",11),Se(1),L()),r&2){let e=y();S(),yr(" ",e.title," Settings ")}}function c2(r,t){if(r&1){let e=ge();P(0,"vis-widget-config",12),ce("onUpdate",function(n){X(e);let s=y();return j(s.onUpdateOptions(n))}),L()}if(r&2){let e=y();w("selectedDashboardId",e.dashboardId)("widget",e.widget)}}var yh=(()=>{let t=class t{constructor(i){this.excelExportService=i,this.onUpdateWidget=new ve,this.onDeleteWidget=new ve,this.onToggleViewMode=new ve,this.onEditMode=!0,this.currentViewMode="chart",this.sidebarVisible=!1}get title(){return this.widget?.config?.header?.title}get menuItems(){let i=[];return this.currentViewMode==="chart"?i.push({label:"Show Data",icon:"pi pi-table",command:()=>this.toggleToTableView()}):i.push({label:"Show Chart",icon:"pi pi-chart-bar",command:()=>this.toggleToChartView()}),i.push({label:"Export to Excel/CSV",icon:"pi pi-file-excel",command:()=>this.exportToExcel()}),i}onUpdateOptions(i){this.onUpdateWidget.emit(i),this.sidebarVisible=!1}onEditModeClicked(){this.onEditMode=!this.onEditMode}onDeleteWidgetClicked(i){this.onDeleteWidget.emit(this.widget)}toggleToTableView(){this.onToggleViewMode.emit({widgetId:this.widget.id,viewMode:"table"})}toggleToChartView(){this.onToggleViewMode.emit({widgetId:this.widget.id,viewMode:"chart"})}exportToExcel(){return Bt(this,null,function*(){try{let i={filename:`${this.widget.id}-export.xlsx`,includeHeaders:!0,includeTimestamp:!0,autoColumnWidth:!0,includeWidgetTitles:!0};yield this.excelExportService.exportWidgetToExcel(this.widget,i)}catch(i){console.error("Error exporting widget to Excel:",i)}})}};t.\u0275fac=function(n){return new(n||t)(ze(Ha))},t.\u0275cmp=Oe({type:t,selectors:[["vis-widget-header"]],inputs:{widget:"widget",onEditMode:"onEditMode",dashboardId:"dashboardId",currentViewMode:"currentViewMode"},outputs:{onUpdateWidget:"onUpdateWidget",onDeleteWidget:"onDeleteWidget",onToggleViewMode:"onToggleViewMode"},decls:7,vars:8,consts:[["menu",""],["menuButton",""],[3,"header"],["pTemplate","icons"],["appendTo","body",3,"model","popup"],["position","right","model","false",3,"visibleChange","visible","appendTo"],["pTemplate","header"],["pTemplate","content"],["type","button","icon","pi pi-ellipsis-v",1,"p-button-sm","ml-2",3,"click","outlined"],["type","button","icon","pi pi-trash",1,"p-button-sm","mr-2",3,"click","outlined"],["type","button","icon","pi pi-cog",1,"p-button-sm",3,"click","outlined"],[1,"font-bold","ml-3","mb-3","text-lg"],[3,"onUpdate","selectedDashboardId","widget"]],template:function(n,s){if(n&1){let a=ge();P(0,"p-panel",2),z(1,o2,3,2,"ng-template",3),L(),he(2,"p-menu",4,0),P(4,"p-sidebar",5),Bs("visibleChange",function(c){return X(a),Ns(s.sidebarVisible,c)||(s.sidebarVisible=c),j(c)}),z(5,l2,2,1,"ng-template",6)(6,c2,1,2,"ng-template",7),L()}n&2&&(w("header",s.title),S(2),w("model",s.menuItems)("popup",!0),S(2),Qt(Zt(7,s2)),Rs("visible",s.sidebarVisible),w("appendTo","body"))},dependencies:[Le,Yc,Ao,er,aa,Oo,Jc,Jr,Ci,ca,bn],styles:[".panel-button[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:end}[_nghost-%COMP%]     .p-panel .p-panel-content{display:none}[_nghost-%COMP%]     .p-panel .p-panel-header{padding:.5rem 1rem}.widget-data-panel[_ngcontent-%COMP%]{padding:1rem;max-height:400px;overflow:hidden;display:flex;flex-direction:column}.data-header[_ngcontent-%COMP%]{margin-bottom:1rem;padding-bottom:.5rem;border-bottom:1px solid #e0e0e0}.data-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.1rem;font-weight:600;color:#333}.data-info[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:#666}.data-table-container[_ngcontent-%COMP%]{flex:1;overflow:auto;border:1px solid #e0e0e0;border-radius:4px}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.875rem}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:.5rem;text-align:left;font-weight:600;border-bottom:1px solid #e0e0e0;position:sticky;top:0;z-index:1}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem;border-bottom:1px solid #f0f0f0;word-break:break-word}.data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}.data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.no-data[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#666;font-style:italic}[_nghost-%COMP%]     .p-button.p-button-sm{padding:.25rem .5rem;font-size:.875rem}"]});let r=t;return r})();var wh=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=$t({type:r});static \u0275inj=Vt({})}return r})();var Wa=class{constructor(){this.widgets=[],this.filterValues=[],this.dashboardId="",this.isEditMode=!1,this.chartHeight=300,this.defaultChartHeight=400,this.containerConfig=this.getDefaultConfig()}setGridType(t){return this.containerConfig.gridType=t,this}setDisplayGrid(t){return this.containerConfig.displayGrid=t,this}setOuterMargin(t){return this.containerConfig.outerMargin=t,this}setDraggable(t,e){return this.containerConfig.draggable=F({enabled:t},e),this}setResizable(t,e){return this.containerConfig.resizable=F({enabled:t},e),this}setMaxCols(t){return this.containerConfig.maxCols=t,this}setMinCols(t){return this.containerConfig.minCols=t,this}setMaxRows(t){return this.containerConfig.maxRows=t,this}setMinRows(t){return this.containerConfig.minRows=t,this}setFixedColWidth(t){return this.containerConfig.fixedColWidth=t,this}setFixedRowHeight(t){return this.containerConfig.fixedRowHeight=t,this}setEmptyCellConfig(t){return Object.assign(this.containerConfig,t),this}setIgnoreMarginInRow(t){return this.containerConfig.ignoreMarginInRow=t,this}setMobileBreakpoint(t){return this.containerConfig.mobileBreakpoint=t,this}setWidgets(t){return this.widgets=t,this}addWidget(t){return this.widgets.push(t),this}setFilterValues(t){return this.filterValues=t,this}setDashboardId(t){return this.dashboardId=t,this}setEditMode(t){return this.isEditMode=t,this}setChartHeight(t){return this.chartHeight=t,this}setDefaultChartHeight(t){return this.defaultChartHeight=t,this}setCustomConfig(t){return this.containerConfig=F(F({},this.containerConfig),t),this}setItemResizeCallback(t){return this.containerConfig.itemResizeCallback=t,this}setItemChangeCallback(t){return this.containerConfig.itemChangeCallback=t,this}setFilterVisualization(t){return this.filterVisualization=t,this}enableFilterHighlighting(t=!0,e){let i={enableHighlighting:t,defaultFilteredOpacity:e?.filteredOpacity||.3,defaultHighlightedOpacity:e?.highlightedOpacity||1,defaultHighlightColor:e?.highlightColor||"#ff6b6b",defaultFilteredColor:e?.filteredColor||"#cccccc"};return this.setFilterVisualization(i)}build(){return{config:this.containerConfig,widgets:this.widgets,filterValues:this.filterValues,dashboardId:this.dashboardId,isEditMode:this.isEditMode,chartHeight:this.chartHeight,defaultChartHeight:this.defaultChartHeight}}getConfig(){return this.containerConfig}getWidgets(){return this.widgets}getFilterValues(){return this.filterValues}static create(){return new this}static updateConfig(t,e){return F(F({},t),e)}static calculateChartHeight(t,e,i=!1,n=400){let s=n,a=t/e,o=t*e,c=Math.log(o)/Math.log(2),l=.95,u=a<1?1/a:1;return i&&(u=u*a),Math.round(s*u*l)}static calculateMapCenter(t,e){let s=t/e,a=s>1?(s-1)*5:0,o=s<1?(1/s-1)*2:0;return[-95+a,38+o]}static calculateMapZoom(t,e){let n=t*e,s=Math.log(n)/Math.log(2),a=t/e,o=Math.abs(1-a)*.5;return 4-s*.1-o}};var vi=class r extends Wa{getDefaultConfig(){return{gridType:Me.VerticalFixed,displayGrid:Ti.None,outerMargin:!0,draggable:{enabled:!1},resizable:{enabled:!1},maxCols:Ie.MAX_COLS,minCols:Ie.MIN_COLS,maxRows:Ie.MAX_ROWS,minRows:Ie.MIN_ROWS,fixedColWidth:Ie.FIXED_COL_WIDTH,fixedRowHeight:Ie.FIXED_ROW_HEIGHT,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,mobileBreakpoint:Ie.MOBILE_BREAKPOINT}}enableEditMode(){return this.setDraggable(!0).setResizable(!0).setEditMode(!0).setDisplayGrid(Ti.Always)}disableEditMode(){return this.setDraggable(!1).setResizable(!1).setEditMode(!1).setDisplayGrid(Ti.None)}setResponsive(t=Ie.MOBILE_BREAKPOINT){return this.setMobileBreakpoint(t)}setCompactLayout(){return this.setOuterMargin($i.COMPACT.OUTER_MARGIN).setFixedColWidth($i.COMPACT.FIXED_COL_WIDTH).setFixedRowHeight($i.COMPACT.FIXED_ROW_HEIGHT)}setSpaciousLayout(){return this.setOuterMargin($i.SPACIOUS.OUTER_MARGIN).setFixedColWidth($i.SPACIOUS.FIXED_COL_WIDTH).setFixedRowHeight($i.SPACIOUS.FIXED_ROW_HEIGHT)}setGridLayout(){return this.setDisplayGrid(Ti.Always)}setFluidLayout(){return this.setGridType(Me.VerticalFixed).setMaxCols(24).setMinCols(1)}setFixedLayout(){return this.setGridType(Me.Fit).setMaxCols(Ie.MAX_COLS).setMinCols(Ie.MAX_COLS)}setMobileOptimized(){let t=fo;return this.setMobileBreakpoint(t.MOBILE_BREAKPOINT).setMaxCols(t.MAX_COLS).setFixedColWidth(t.FIXED_COL_WIDTH).setFixedRowHeight(t.FIXED_ROW_HEIGHT)}setTabletOptimized(){let t=po;return this.setMobileBreakpoint(t.MOBILE_BREAKPOINT).setMaxCols(t.MAX_COLS).setFixedColWidth(t.FIXED_COL_WIDTH).setFixedRowHeight(t.FIXED_ROW_HEIGHT)}setDesktopOptimized(){let t=Ie;return this.setMaxCols(t.MAX_COLS).setFixedColWidth(t.FIXED_COL_WIDTH).setFixedRowHeight(t.FIXED_ROW_HEIGHT).setMobileBreakpoint(ns.DESKTOP)}setLargeDesktopOptimized(){let t=mo;return this.setMaxCols(t.MAX_COLS).setFixedColWidth(t.FIXED_COL_WIDTH).setFixedRowHeight(t.FIXED_ROW_HEIGHT).setMobileBreakpoint(t.MOBILE_BREAKPOINT)}setGridDimensions(t,e){return this.setMaxCols(t).setMinCols(t).setMaxRows(e)}enableEmptyCellInteractions(){return this.setEmptyCellConfig({enableEmptyCellClick:!0,enableEmptyCellContextMenu:!0,enableEmptyCellDrop:!0,enableEmptyCellDrag:!0})}disableEmptyCellInteractions(){return this.setEmptyCellConfig({enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1})}setItemSizeConstraints(t=Ie.MIN_COLS,e=Ie.MAX_COLS,i=Ie.MIN_ROWS,n=50){return this.setMinCols(t).setMaxCols(e).setMinRows(i).setMaxRows(n)}setScreenSize(t){let e=Tc(t);return this.setMaxCols(e.MAX_COLS).setMinCols(e.MIN_COLS).setMaxRows(e.MAX_ROWS).setMinRows(e.MIN_ROWS).setFixedColWidth(e.FIXED_COL_WIDTH).setFixedRowHeight(e.FIXED_ROW_HEIGHT).setMobileBreakpoint(e.MOBILE_BREAKPOINT)}static createStandard(){return new r().setGridType(Me.VerticalFixed).setDisplayGrid(Ti.None).setOuterMargin(!0).setDraggable(!1).setResizable(!1).setMaxCols(Ie.MAX_COLS).setMinCols(Ie.MIN_COLS).setMaxRows(Ie.MAX_ROWS).setMinRows(Ie.MIN_ROWS).setFixedColWidth(Ie.FIXED_COL_WIDTH).setFixedRowHeight(Ie.FIXED_ROW_HEIGHT).setMobileBreakpoint(Ie.MOBILE_BREAKPOINT)}static createEditMode(){return new r().enableEditMode().setMaxCols(Ie.MAX_COLS).setMinCols(Ie.MIN_COLS).setMaxRows(Ie.MAX_ROWS).setMinRows(Ie.MIN_ROWS).setFixedColWidth(Ie.FIXED_COL_WIDTH).setFixedRowHeight(Ie.FIXED_ROW_HEIGHT).setMobileBreakpoint(Ie.MOBILE_BREAKPOINT)}static createMobile(){return new r().setScreenSize("MOBILE").setCompactLayout()}static createTablet(){return new r().setScreenSize("TABLET").setSpaciousLayout()}static createDesktop(){return new r().setScreenSize("DESKTOP").setSpaciousLayout()}static createLargeDesktop(){return new r().setScreenSize("LARGE_DESKTOP").setSpaciousLayout()}build(){return{config:this.containerConfig,widgets:this.widgets,filterValues:this.filterValues,dashboardId:this.dashboardId,isEditMode:this.isEditMode,chartHeight:this.chartHeight,defaultChartHeight:this.defaultChartHeight,filterVisualization:this.filterVisualization}}};var u2=["dashboardContainer"],h2=(r,t)=>t.id;function f2(r,t){if(r&1){let e=ge();P(0,"vis-widget-header",9),ce("onUpdateWidget",function(n){X(e);let s=y(2);return j(s.onUpdateWidget(n))})("onDeleteWidget",function(n){X(e);let s=y(2);return j(s.onDeleteWidget(n))})("onToggleViewMode",function(n){X(e);let s=y(2);return j(s.onToggleViewMode(n))}),L()}if(r&2){let e=y().$implicit,i=y();w("dashboardId",i.dashboardId)("widget",e)("currentViewMode",i.getWidgetViewMode(e.id))("onEditMode",i.isEditMode)}}function d2(r,t){if(r&1){let e=ge();P(0,"gridster-item",6),ce("itemResize",function(){X(e);let n=y();return j(n.updateString(n.container.editModeString))})("itemChange",function(){X(e);let n=y();return j(n.updateString(n.container.editModeString))}),dt(1,f2,1,4,"vis-widget-header",7),P(2,"vis-widget",8),ce("onDataLoad",function(n){X(e);let s=y();return j(s.onDataLoad(n))})("onUpdateFilter",function(n){X(e);let s=y();return j(s.onUpdateFilter(n))}),L()()}if(r&2){let e=t.$implicit,i=y();w("item",e.position),fe("data-widget-id",e.id),S(),pt(e.config.header?1:-1),S(),w("widget",e)("viewMode",i.getWidgetViewMode(e.id))}}var xl=(()=>{let t=class t{constructor(){this.filterValues=[],this.container=t,this.chartHeight=300,this.defaultChartHeight=400,this.containerTouchChanged=new ve,this.editModeStringChange=new ve,this.changesMade=new ve,this.filterValuesChanged=new ve,this.availableDashboards=[],this.isEditMode=!1,this.onShowConfirmation=!1,this.onShowNewDashboardDialog=!1,this.options={},this.mergedOptions={},this.widgetViewModes=new Map,this.dashboardBuilder=vi.createStandard()}ngOnInit(){this.initializeDashboard()}initializeDashboard(){let i=this.dashboardBuilder.setWidgets(this.widgets||[]).setFilterValues(this.filterValues||[]).setDashboardId(this.dashboardId||"").setEditMode(this.isEditMode).setChartHeight(this.chartHeight).setDefaultChartHeight(this.defaultChartHeight).setCustomConfig(this.options).setItemResizeCallback(this.onWidgetResize.bind(this)).setItemChangeCallback(this.onWidgetChange.bind(this)).build();this.applyDashboardConfig(i)}applyDashboardConfig(i){this.mergedOptions=i.config,this.widgets=i.widgets,this.filterValues=i.filterValues,this.dashboardId=i.dashboardId,this.isEditMode=i.isEditMode,this.chartHeight=i.chartHeight}updateDashboardConfig(i){i.config&&(this.mergedOptions=F(F({},this.mergedOptions),i.config)),i.widgets&&(this.widgets=i.widgets),i.filterValues&&(this.filterValues=i.filterValues),i.dashboardId&&(this.dashboardId=i.dashboardId),i.isEditMode!==void 0&&(this.isEditMode=i.isEditMode),i.chartHeight&&(this.chartHeight=i.chartHeight),this.dashboardBuilder=vi.createStandard().setWidgets(this.widgets).setFilterValues(this.filterValues).setDashboardId(this.dashboardId).setEditMode(this.isEditMode).setChartHeight(this.chartHeight).setDefaultChartHeight(this.defaultChartHeight),this.applyDashboardConfig(this.dashboardBuilder.build())}enableEditMode(){this.dashboardBuilder.enableEditMode();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}disableEditMode(){this.dashboardBuilder.disableEditMode();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}setResponsive(i=640){this.dashboardBuilder.setResponsive(i);let n=this.dashboardBuilder.build();this.applyDashboardConfig(n)}setCompactLayout(){this.dashboardBuilder.setCompactLayout();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}setSpaciousLayout(){this.dashboardBuilder.setSpaciousLayout();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}setMobileOptimized(){this.dashboardBuilder.setMobileOptimized();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}setDesktopOptimized(){this.dashboardBuilder.setDesktopOptimized();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}getCurrentConfig(){return this.dashboardBuilder.build()}getBuilder(){return this.dashboardBuilder}onDataLoad(i){return Bt(this,null,function*(){this.filterValues&&this.filterValues.length>0&&this.applyFiltersToWidget(i)})}applyFiltersToWidget(i){}getFilterParams(){return this.filterValues}onUpdateWidget(i){}onWidgetResize(i,n){}onWidgetChange(i,n){t.containerTouched=!0,t.editModeString="[Edit Mode - Pending Changes]"}updateString(i){this.editModeStringChange.emit(i)}getEditModeString(i){return t.editModeString}onUpdateFilter(i){let n=this.widgets.find(o=>o.config?.component==="filter");if(!n)return;let s=F({},n);s.config?s.config.options||(s.config.options={values:[]}):s.config={options:{values:[]}};let a=s.config.options;if(a.values||(a.values=[]),Array.isArray(i))a.values=i,this.filterValues=i,i.length===0&&(this.dashboardBuilder.setFilterValues([]),this.filterValues=[]);else if(i&&i.value&&i.widget){let o=i.value,c=i.widget,u=i.filterValue;if(!u&&o&&typeof o=="object"){let h=c.config?.filterColumn||c.config?.accessor||"unknown";if(o.name)u={accessor:"category",filterColumn:h,category:o.name,value:o.value||o.name};else if(o.seriesName)u={accessor:"series",filterColumn:h,series:o.seriesName,value:o.value||o.seriesName};else{let f=Object.keys(o);if(f.length>0){let d=f[0];u={accessor:d,filterColumn:h,[d]:o[d],value:o[d]}}}c.config?.header?.title&&(u.widgetTitle=c.config.header.title),c.id&&(u.widgetId=c.id)}u&&u.accessor&&u.value&&(a.values.push(u),this.filterValues.push(u))}this.dashboardBuilder.setFilterValues(this.filterValues),this.filterValuesChanged.emit(this.filterValues)}onDashboardSelectionChanged(i){}onDeleteWidget(i){this.widgets.splice(this.widgets.indexOf(i),1)}calculateChartHeight(i,n,s=!1,a=this.defaultChartHeight){return vi.calculateChartHeight(i,n,s,a)}calculateMapCenter(i,n){return vi.calculateMapCenter(i,n)}calculateMapZoom(i,n){return vi.calculateMapZoom(i,n)}getWidgetViewMode(i){return this.widgetViewModes.get(i)||"chart"}onToggleViewMode(i){this.widgetViewModes.set(i.widgetId,i.viewMode)}};t.editModeString="",t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-dashboard-container"]],viewQuery:function(n,s){if(n&1&&(Ae(ia,5),Ae(u2,7)),n&2){let a;de(a=pe())&&(s.gridster=a.first),de(a=pe())&&(s.dashboardContainer=a.first)}},inputs:{widgets:"widgets",filterValues:"filterValues",dashboardId:"dashboardId",isEditMode:"isEditMode",options:"options"},outputs:{containerTouchChanged:"containerTouchChanged",editModeStringChange:"editModeStringChange",changesMade:"changesMade",filterValuesChanged:"filterValuesChanged"},decls:7,vars:1,consts:[["dashboardContainer",""],[1,"gridster-container"],[1,"mt-2","dashboard-gridster",3,"options"],["id","dashboard",1,"print-body"],[3,"item"],["position","bottom-right","key","br"],[3,"itemResize","itemChange","item"],[3,"dashboardId","widget","currentViewMode","onEditMode"],[3,"onDataLoad","onUpdateFilter","widget","viewMode"],[3,"onUpdateWidget","onDeleteWidget","onToggleViewMode","dashboardId","widget","currentViewMode","onEditMode"]],template:function(n,s){n&1&&(P(0,"div",1,0)(2,"gridster",2)(3,"div",3),Ni(4,d2,3,5,"gridster-item",4,h2),L()()(),he(6,"p-toast",5)),n&2&&(S(2),w("options",s.mergedOptions),S(2),Bi(s.widgets))},dependencies:[Le,Qs,ia,Rc,Xc,yh,wh,ea,Js],styles:[".vis-chart-container[_ngcontent-%COMP%]{background-color:#fff;min-height:1000px;width:100%}.gridster-container[_ngcontent-%COMP%]{width:100%;height:100%}.editMode[_ngcontent-%COMP%]{color:red}.print-body[_ngcontent-%COMP%]{width:95%}@media print{#dashboard[_ngcontent-%COMP%]{width:95%;overflow-y:visible!important;position:relative}@page{size:landscape}}.vis-filter-component[_ngcontent-%COMP%]{font-size:.8rem!important;width:100%;height:40px}  .p-dropdown-custom{width:100%!important}  .p-dropdown-custom.p-dropdown .p-component{width:100%!important}.dashboard-gridster[_ngcontent-%COMP%]{background-color:var(--p-surface-50);padding:5px;height:100%!important;overflow-y:auto!important}[_nghost-%COMP%]     .no-border .p-panel-content{border:none!important;background:transparent!important}[_nghost-%COMP%]     .hide-panel-header .p-panel-header{display:none!important}"]});let r=t;return r})();var p2=["sublist"],m2=(r,t)=>({"p-tieredmenu-submenu":r,"p-tieredmenu-root-list":t}),Ch=r=>({"p-tieredmenu-item-link":!0,"p-disabled":r}),g2=()=>({exact:!1}),x2=(r,t)=>({$implicit:r,hasSubmenu:t}),_2=r=>({display:r});function v2(r,t){if(r&1&&he(0,"li",7),r&2){let e=y().$implicit,i=y();Qt(i.getItemProp(e,"style")),w("ngClass",i.getSeparatorItemClass(e)),fe("id",i.getItemId(e))("data-pc-section","separator")}}function y2(r,t){if(r&1&&he(0,"span",18),r&2){let e=y(4).$implicit,i=y();w("ngClass",i.getItemProp(e,"icon"))("ngStyle",i.getItemProp(e,"iconStyle")),fe("data-pc-section","icon")("tabindex",-1)}}function w2(r,t){if(r&1&&(P(0,"span",19),Se(1),L()),r&2){let e=y(4).$implicit,i=y();fe("data-pc-section","label"),S(),yr(" ",i.getItemLabel(e)," ")}}function b2(r,t){if(r&1&&he(0,"span",20),r&2){let e=y(4).$implicit,i=y();w("innerHTML",i.getItemLabel(e),$r),fe("data-pc-section","label")}}function C2(r,t){if(r&1&&(P(0,"span",21),Se(1),L()),r&2){let e=y(4).$implicit,i=y();w("ngClass",i.getItemProp(e,"badgeStyleClass")),S(),He(i.getItemProp(e,"badge"))}}function T2(r,t){r&1&&he(0,"AngleRightIcon",24),r&2&&(w("ngClass","p-tieredmenu-submenu-icon"),fe("data-pc-section","submenuicon")("aria-hidden",!0))}function S2(r,t){}function E2(r,t){r&1&&z(0,S2,0,0,"ng-template",25),r&2&&w("data-pc-section","submenuicon")("aria-hidden",!0)}function I2(r,t){if(r&1&&(Be(0),z(1,T2,1,3,"AngleRightIcon",22)(2,E2,1,2,null,23),Ve()),r&2){let e=y(5);S(),w("ngIf",!e.tieredMenu.submenuIconTemplate&&!e.tieredMenu._submenuIconTemplate),S(),w("ngTemplateOutlet",e.tieredMenu.submenuIconTemplate||e.tieredMenu._submenuIconTemplate)}}function k2(r,t){if(r&1&&(P(0,"a",14),z(1,y2,1,4,"span",15)(2,w2,2,2,"span",16)(3,b2,1,2,"ng-template",null,2,ct)(5,C2,2,2,"span",17)(6,I2,3,2,"ng-container",10),L()),r&2){let e=mt(4),i=y(3).$implicit,n=y();w("target",n.getItemProp(i,"target"))("ngClass",Re(11,Ch,n.getItemProp(i,"disabled"))),fe("href",n.getItemProp(i,"url"),rn)("data-automationid",n.getItemProp(i,"automationId"))("data-pc-section","action")("tabindex",-1),S(),w("ngIf",n.getItemProp(i,"icon")),S(),w("ngIf",n.getItemProp(i,"escape"))("ngIfElse",e),S(3),w("ngIf",n.getItemProp(i,"badge")),S(),w("ngIf",n.isItemGroup(i))}}function F2(r,t){if(r&1&&he(0,"span",18),r&2){let e=y(4).$implicit,i=y();w("ngClass",i.getItemProp(e,"icon"))("ngStyle",i.getItemProp(e,"iconStyle")),fe("data-pc-section","icon")("aria-hidden",!0)("tabindex",-1)}}function O2(r,t){if(r&1&&(P(0,"span",19),Se(1),L()),r&2){let e=y(4).$implicit,i=y();fe("data-pc-section","label"),S(),yr(" ",i.getItemLabel(e)," ")}}function A2(r,t){if(r&1&&he(0,"span",20),r&2){let e=y(4).$implicit,i=y();w("innerHTML",i.getItemLabel(e),$r),fe("data-pc-section","label")}}function D2(r,t){if(r&1&&(P(0,"span",21),Se(1),L()),r&2){let e=y(4).$implicit,i=y();w("ngClass",i.getItemProp(e,"badgeStyleClass")),S(),He(i.getItemProp(e,"badge"))}}function M2(r,t){r&1&&he(0,"AngleRightIcon",24),r&2&&(w("ngClass","p-tieredmenu-submenu-icon"),fe("data-pc-section","submenuicon")("aria-hidden",!0))}function P2(r,t){}function L2(r,t){r&1&&z(0,P2,0,0,"ng-template",25),r&2&&w("data-pc-section","submenuicon")("aria-hidden",!0)}function R2(r,t){if(r&1&&(Be(0),z(1,M2,1,3,"AngleRightIcon",22)(2,L2,1,2,null,23),Ve()),r&2){let e=y(5);S(),w("ngIf",!e.tieredMenu.submenuIconTemplate&&!e.tieredMenu._submenuIconTemplate),S(),w("ngTemplateOutlet",e.tieredMenu.submenuIconTemplate||e.tieredMenu._submenuIconTemplate)}}function N2(r,t){if(r&1&&(P(0,"a",26),z(1,F2,1,5,"span",15)(2,O2,2,2,"span",16)(3,A2,1,2,"ng-template",null,2,ct)(5,D2,2,2,"span",17)(6,R2,3,2,"ng-container",10),L()),r&2){let e=mt(4),i=y(3).$implicit,n=y();w("routerLink",n.getItemProp(i,"routerLink"))("queryParams",n.getItemProp(i,"queryParams"))("routerLinkActive","p-tieredmenu-item-link-active")("routerLinkActiveOptions",n.getItemProp(i,"routerLinkActiveOptions")||Zt(20,g2))("target",n.getItemProp(i,"target"))("ngClass",Re(21,Ch,n.getItemProp(i,"disabled")))("fragment",n.getItemProp(i,"fragment"))("queryParamsHandling",n.getItemProp(i,"queryParamsHandling"))("preserveFragment",n.getItemProp(i,"preserveFragment"))("skipLocationChange",n.getItemProp(i,"skipLocationChange"))("replaceUrl",n.getItemProp(i,"replaceUrl"))("state",n.getItemProp(i,"state")),fe("data-automationid",n.getItemProp(i,"automationId"))("tabindex",-1)("data-pc-section","action"),S(),w("ngIf",n.getItemProp(i,"icon")),S(),w("ngIf",n.getItemProp(i,"escape"))("ngIfElse",e),S(3),w("ngIf",n.getItemProp(i,"badge")),S(),w("ngIf",n.isItemGroup(i))}}function B2(r,t){if(r&1&&(Be(0),z(1,k2,7,13,"a",12)(2,N2,7,23,"a",13),Ve()),r&2){let e=y(2).$implicit,i=y();S(),w("ngIf",!i.getItemProp(e,"routerLink")),S(),w("ngIf",i.getItemProp(e,"routerLink"))}}function V2(r,t){}function $2(r,t){r&1&&z(0,V2,0,0,"ng-template")}function H2(r,t){if(r&1&&(Be(0),z(1,$2,1,0,null,27),Ve()),r&2){let e=y(2).$implicit,i=y();S(),w("ngTemplateOutlet",i.itemTemplate)("ngTemplateOutletContext",Ct(2,x2,e.item,i.getItemProp(e,"items")))}}function W2(r,t){if(r&1){let e=ge();P(0,"p-tieredmenusub",28),ce("itemClick",function(n){X(e);let s=y(3);return j(s.itemClick.emit(n))})("itemMouseEnter",function(n){X(e);let s=y(3);return j(s.onItemMouseEnter(n))}),L()}if(r&2){let e=y(2).$implicit,i=y();w("items",e.items)("itemTemplate",i.itemTemplate)("autoDisplay",i.autoDisplay)("menuId",i.menuId)("activeItemPath",i.activeItemPath())("focusedItemId",i.focusedItemId)("ariaLabelledBy",i.getItemId(e))("level",i.level+1)("inlineStyles",Re(9,_2,i.isItemActive(e)?"flex":"none"))}}function z2(r,t){if(r&1){let e=ge();P(0,"li",8,1)(2,"div",9),ce("click",function(n){X(e);let s=y().$implicit,a=y();return j(a.onItemClick(n,s))})("mouseenter",function(n){X(e);let s=y().$implicit,a=y();return j(a.onItemMouseEnter({$event:n,processedItem:s}))}),z(3,B2,3,2,"ng-container",10)(4,H2,2,5,"ng-container",10),L(),z(5,W2,1,11,"p-tieredmenusub",11),L()}if(r&2){let e=y(),i=e.$implicit,n=e.index,s=y();et(s.getItemProp(i,"styleClass")),w("ngStyle",s.getItemProp(i,"style"))("ngClass",s.getItemClass(i))("tooltipOptions",s.getItemProp(i,"tooltipOptions")),fe("id",s.getItemId(i))("data-pc-section","menuitem")("data-p-highlight",s.isItemActive(i))("data-p-focused",s.isItemFocused(i))("data-p-disabled",s.isItemDisabled(i))("aria-label",s.getItemLabel(i))("aria-disabled",s.isItemDisabled(i)||void 0)("aria-haspopup",s.isItemGroup(i)&&!s.getItemProp(i,"to")?"menu":void 0)("aria-expanded",s.isItemGroup(i)?s.isItemActive(i):void 0)("aria-setsize",s.getAriaSetSize())("aria-posinset",s.getAriaPosInset(n)),S(2),fe("data-pc-section","content"),S(),w("ngIf",!s.itemTemplate),S(),w("ngIf",s.itemTemplate),S(),w("ngIf",s.isItemVisible(i)&&s.isItemGroup(i))}}function U2(r,t){if(r&1&&z(0,v2,1,5,"li",5)(1,z2,6,20,"li",6),r&2){let e=t.$implicit,i=y();w("ngIf",i.isItemVisible(e)&&i.getItemProp(e,"separator")),S(),w("ngIf",i.isItemVisible(e)&&!i.getItemProp(e,"separator"))}}var G2=["submenuicon"],X2=["item"],j2=["rootmenu"],K2=["container"],Y2=(r,t)=>({"p-tieredmenu p-component":!0,"p-tieredmenu-mobile":r,"p-tieredmenu-overlay":t}),q2=(r,t)=>({showTransitionParams:r,hideTransitionParams:t}),Q2=r=>({value:"visible",params:r});function Z2(r,t){if(r&1){let e=ge();P(0,"div",3,0),ce("click",function(n){X(e);let s=y();return j(s.onOverlayClick(n))})("@overlayAnimation.start",function(n){X(e);let s=y();return j(s.onOverlayAnimationStart(n))})("@overlayAnimation.done",function(n){X(e);let s=y();return j(s.onOverlayAnimationEnd(n))}),P(2,"p-tieredMenuSub",4,1),ce("itemClick",function(n){X(e);let s=y();return j(s.onItemClick(n))})("menuFocus",function(n){X(e);let s=y();return j(s.onMenuFocus(n))})("menuBlur",function(n){X(e);let s=y();return j(s.onMenuBlur(n))})("menuKeydown",function(n){X(e);let s=y();return j(s.onKeyDown(n))})("itemMouseEnter",function(n){X(e);let s=y();return j(s.onItemMouseEnter(n))}),L()()}if(r&2){let e=y();et(e.styleClass),w("id",e.id)("ngClass",Ct(22,Y2,e.queryMatches,e.popup))("ngStyle",e.style)("@overlayAnimation",Re(28,Q2,Ct(25,q2,e.showTransitionOptions,e.hideTransitionOptions)))("@.disabled",e.popup!==!0),fe("data-pc-section","root")("data-pc-name","tieredmenu"),S(2),w("root",!0)("items",e.processedItems)("itemTemplate",e.itemTemplate||e._itemTemplate)("menuId",e.id)("tabindex",e.disabled?-1:e.tabindex)("ariaLabel",e.ariaLabel)("ariaLabelledBy",e.ariaLabelledBy)("baseZIndex",e.baseZIndex)("autoZIndex",e.autoZIndex)("autoDisplay",e.autoDisplay)("popup",e.popup)("focusedItemId",e.focused?e.focusedItemId:void 0)("activeItemPath",e.activeItemPath())}}var J2=({dt:r})=>`
.p-tieredmenu {
    background: ${r("tieredmenu.background")};
    color: ${r("tieredmenu.color")};
    border: 1px solid ${r("tieredmenu.border.color")};
    border-radius: ${r("tieredmenu.border.radius")};
    min-width: 12.5rem;
}

.p-tieredmenu-root-list,
.p-tieredmenu-submenu {
    margin: 0;
    padding: ${r("tieredmenu.list.padding")};
    list-style: none;
    outline: 0 none;
    display: flex;
    flex-direction: column;
    gap: ${r("tieredmenu.list.gap")};
}

.p-tieredmenu-submenu {
    position: absolute;
    min-width: 100%;
    z-index: 1;
    background: ${r("tieredmenu.background")};
    color: ${r("tieredmenu.color")};
    border: 1px solid ${r("tieredmenu.border.color")};
    border-radius: ${r("tieredmenu.border.radius")};
    box-shadow: ${r("tieredmenu.shadow")};
}

.p-tieredmenu-item {
    position: relative;
}

.p-tieredmenu-item-content {
    transition: background ${r("tieredmenu.transition.duration")}, color ${r("tieredmenu.transition.duration")};
    border-radius: ${r("tieredmenu.item.border.radius")};
    color: ${r("tieredmenu.item.color")};
}

.p-tieredmenu-item-link {
    cursor: pointer;
    display: flex;
    align-items: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
    color: inherit;
    padding: ${r("tieredmenu.item.padding")};
    gap: ${r("tieredmenu.item.gap")};
    user-select: none;
    outline: 0 none;
}

.p-tieredmenu-item-label {
    line-height: 1;
}

.p-tieredmenu-item-icon {
    color: ${r("tieredmenu.item.icon.color")};
}

.p-tieredmenu-submenu-icon {
    color: ${r("tieredmenu.submenu.icon.color")};
    margin-left: auto;
    font-size: ${r("tieredmenu.submenu.icon.size")};
    width: ${r("tieredmenu.submenu.icon.size")};
    height: ${r("tieredmenu.submenu.icon.size")};
}

.p-tieredmenu-submenu-icon:dir(rtl) {
    margin-left: 0;
    margin-right: auto;
}

.p-tieredmenu-item.p-focus > .p-tieredmenu-item-content {
    color: ${r("tieredmenu.item.focus.color")};
    background: ${r("tieredmenu.item.focus.background")};
}

.p-tieredmenu-item.p-focus > .p-tieredmenu-item-content .p-tieredmenu-item-icon {
    color: ${r("tieredmenu.item.icon.focus.color")};
}

.p-tieredmenu-item.p-focus > .p-tieredmenu-item-content .p-tieredmenu-submenu-icon {
    color: ${r("tieredmenu.submenu.icon.focus.color")};
}

.p-tieredmenu-item:not(.p-disabled) > .p-tieredmenu-item-content:hover {
    color: ${r("tieredmenu.item.focus.color")};
    background: ${r("tieredmenu.item.focus.background")};
}

.p-tieredmenu-item:not(.p-disabled) > .p-tieredmenu-item-content:hover .p-tieredmenu-item-icon {
    color: ${r("tieredmenu.item.icon.focus.color")};
}

.p-tieredmenu-item:not(.p-disabled) > .p-tieredmenu-item-content:hover .p-tieredmenu-submenu-icon {
    color: ${r("tieredmenu.submenu.icon.focus.color")};
}

.p-tieredmenu-item-active > .p-tieredmenu-item-content {
    color: ${r("tieredmenu.item.active.color")};
    background: ${r("tieredmenu.item.active.background")};
}

.p-tieredmenu-item-active > .p-tieredmenu-item-content .p-tieredmenu-item-icon {
    color: ${r("tieredmenu.item.icon.active.color")};
}

.p-tieredmenu-item-active > .p-tieredmenu-item-content .p-tieredmenu-submenu-icon {
    color: ${r("tieredmenu.submenu.icon.active.color")};
}

.p-tieredmenu-separator {
    border-block-start: 1px solid ${r("tieredmenu.separator.border.color")};
}

.p-tieredmenu-overlay {
    box-shadow: ${r("tieredmenu.shadow")};
}

.p-tieredmenu-enter-from,
.p-tieredmenu-leave-active {
    opacity: 0;
}

.p-tieredmenu-enter-active {
    transition: opacity 250ms;
}

.p-tieredmenu-mobile .p-tieredmenu-submenu {
    position: static;
    box-shadow: none;
    border: 0 none;
    padding-inline-start: ${r("tieredmenu.submenu.mobile.indent")};
    padding-inline-end: 0;
}

.p-tieredmenu-mobile .p-tieredmenu-submenu:dir(rtl) {
    padding-inline-start: 0;
    padding-inline-end: ${r("tieredmenu.submenu.mobile.indent")};
}

.p-tieredmenu-mobile .p-tieredmenu-submenu-icon {
    transition: transform 0.2s;
    transform: rotate(90deg);
}

.p-tieredmenu-mobile .p-tieredmenu-item-active > .p-tieredmenu-item-content .p-tieredmenu-submenu-icon {
    transform: rotate(-90deg);
}
`;var eb={root:({instance:r,props:t})=>["p-tieredmenu p-component",{"p-tieredmenu-overlay":t.popup}],start:"p-tieredmenu-start",rootList:"p-tieredmenu-root-list",item:({instance:r,processedItem:t})=>["p-tieredmenu-item",{"p-tieredmenu-item-active":r.isItemActive(t),"p-focus":r.isItemFocused(t),"p-disabled":r.isItemDisabled(t)}],itemContent:"p-tieredmenu-item-content",itemLink:"p-tieredmenu-item-link",itemIcon:"p-tieredmenu-item-icon",itemLabel:"p-tieredmenu-item-label",submenuIcon:"p-tieredmenu-submenu-icon",submenu:"p-tieredmenu-submenu",separator:"p-tieredmenu-separator",end:"p-tieredmenu-end"},bh=(()=>{class r extends pr{name="tieredmenu";theme=J2;classes=eb;static \u0275fac=(()=>{let e;return function(n){return(e||(e=bt(r)))(n||r)}})();static \u0275prov=yt({token:r,factory:r.\u0275fac})}return r})();var tb=(()=>{class r extends tr{el;renderer;tieredMenu;items;itemTemplate;root=!1;autoDisplay;autoZIndex=!0;baseZIndex=0;popup;menuId;ariaLabel;ariaLabelledBy;level=0;focusedItemId;activeItemPath=Hr([]);tabindex=0;inlineStyles;itemClick=new ve;itemMouseEnter=new ve;menuFocus=new ve;menuBlur=new ve;menuKeydown=new ve;sublistViewChild;constructor(e,i,n){super(),this.el=e,this.renderer=i,this.tieredMenu=n}positionSubmenu(){if(wr(this.tieredMenu.platformId)){let e=this.sublistViewChild&&this.sublistViewChild.nativeElement;e&&Jl(e,this.level)}}getItemProp(e,i,n=null){return e&&e.item?es(e.item[i],n):void 0}getItemId(e){return e.item?.id??`${this.menuId}_${e.key}`}getItemKey(e){return this.getItemId(e)}getItemClass(e){return Y(F({},this.getItemProp(e,"class")),{"p-tieredmenu-item":!0,"p-tieredmenu-item-active":this.isItemActive(e),"p-focus":this.isItemFocused(e),"p-disabled":this.isItemDisabled(e)})}getItemLabel(e){return this.getItemProp(e,"label")}getSeparatorItemClass(e){return Y(F({},this.getItemProp(e,"class")),{"p-tieredmenu-separator":!0})}getAriaSetSize(){return this.items.filter(e=>this.isItemVisible(e)&&!this.getItemProp(e,"separator")).length}getAriaPosInset(e){return e-this.items.slice(0,e).filter(i=>{let n=this.isItemVisible(i),s=n&&this.getItemProp(i,"separator");return!n||s}).length+1}isItemVisible(e){return this.getItemProp(e,"visible")!==!1}isItemActive(e){if(this.activeItemPath())return this.positionSubmenu(),this.activeItemPath().some(i=>i.key===e.key)}isItemDisabled(e){return this.getItemProp(e,"disabled")}isItemFocused(e){return this.focusedItemId===this.getItemId(e)}isItemGroup(e){return Wr(e.items)}onItemMouseEnter(e){if(this.autoDisplay){let{event:i,processedItem:n}=e;this.itemMouseEnter.emit({originalEvent:i,processedItem:n})}}onItemClick(e,i){this.getItemProp(i,"command",{originalEvent:e,item:i.item}),this.itemClick.emit({originalEvent:e,processedItem:i,isFocus:!0})}static \u0275fac=function(i){return new(i||r)(ze(oi),ze(Li),ze(tn(()=>_l)))};static \u0275cmp=Oe({type:r,selectors:[["p-tieredMenuSub"],["p-tieredmenusub"]],viewQuery:function(i,n){if(i&1&&Ae(p2,7),i&2){let s;de(s=pe())&&(n.sublistViewChild=s.first)}},inputs:{items:"items",itemTemplate:"itemTemplate",root:[2,"root","root",be],autoDisplay:[2,"autoDisplay","autoDisplay",be],autoZIndex:[2,"autoZIndex","autoZIndex",be],baseZIndex:[2,"baseZIndex","baseZIndex",Ot],popup:[2,"popup","popup",be],menuId:"menuId",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",level:[2,"level","level",Ot],focusedItemId:"focusedItemId",activeItemPath:[1,"activeItemPath"],tabindex:[2,"tabindex","tabindex",Ot],inlineStyles:"inlineStyles"},outputs:{itemClick:"itemClick",itemMouseEnter:"itemMouseEnter",menuFocus:"menuFocus",menuBlur:"menuBlur",menuKeydown:"menuKeydown"},features:[Ht],decls:3,vars:13,consts:[["sublist",""],["listItem",""],["htmlLabel",""],["role","menu",3,"keydown","focus","blur","ngClass","id","tabindex","ngStyle"],["ngFor","",3,"ngForOf"],["role","separator",3,"style","ngClass",4,"ngIf"],["role","menuitem","pTooltip","",3,"ngStyle","ngClass","class","tooltipOptions",4,"ngIf"],["role","separator",3,"ngClass"],["role","menuitem","pTooltip","",3,"ngStyle","ngClass","tooltipOptions"],[1,"p-tieredmenu-item-content",3,"click","mouseenter"],[4,"ngIf"],[3,"items","itemTemplate","autoDisplay","menuId","activeItemPath","focusedItemId","ariaLabelledBy","level","inlineStyles","itemClick","itemMouseEnter",4,"ngIf"],["pRipple","",3,"target","ngClass",4,"ngIf"],["pRipple","",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","ngClass","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state",4,"ngIf"],["pRipple","",3,"target","ngClass"],["class","p-tieredmenu-item-icon",3,"ngClass","ngStyle",4,"ngIf"],["class","p-tieredmenu-item-label",4,"ngIf","ngIfElse"],["class","p-menuitem-badge",3,"ngClass",4,"ngIf"],[1,"p-tieredmenu-item-icon",3,"ngClass","ngStyle"],[1,"p-tieredmenu-item-label"],[1,"p-tieredmenu-item-label",3,"innerHTML"],[1,"p-menuitem-badge",3,"ngClass"],[3,"ngClass",4,"ngIf"],[4,"ngTemplateOutlet"],[3,"ngClass"],[3,"data-pc-section","aria-hidden"],["pRipple","",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","ngClass","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"itemClick","itemMouseEnter","items","itemTemplate","autoDisplay","menuId","activeItemPath","focusedItemId","ariaLabelledBy","level","inlineStyles"]],template:function(i,n){if(i&1){let s=ge();P(0,"ul",3,0),ce("keydown",function(o){return X(s),j(n.menuKeydown.emit(o))})("focus",function(o){return X(s),j(n.menuFocus.emit(o))})("blur",function(o){return X(s),j(n.menuBlur.emit(o))}),z(2,U2,2,2,"ng-template",4),L()}i&2&&(w("ngClass",Ct(10,m2,!n.root,n.root))("id",n.menuId+"_list")("tabindex",n.tabindex)("ngStyle",n.inlineStyles),fe("aria-label",n.ariaLabel)("aria-labelledBy",n.ariaLabelledBy)("aria-activedescendant",n.focusedItemId)("aria-orientation","vertical")("data-pc-section","menu"),S(2),w("ngForOf",n.items))},dependencies:[r,Le,Wt,Yr,Tt,Jt,St,wi,ln,cn,Qr,Mr,Zr,sc,tt],encapsulation:2})}return r})(),_l=(()=>{class r extends tr{overlayService;set model(e){this._model=e,this._processedItems=this.createProcessedItems(this._model||[])}get model(){return this._model}popup;style;styleClass;appendTo;breakpoint="960px";autoZIndex=!0;baseZIndex=0;autoDisplay=!0;showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)";hideTransitionOptions=".1s linear";id;ariaLabel;ariaLabelledBy;disabled=!1;tabindex=0;onShow=new ve;onHide=new ve;rootmenu;containerViewChild;submenuIconTemplate;itemTemplate;templates;container;outsideClickListener;resizeListener;scrollHandler;target;relatedTarget;visible;relativeAlign;dirty=!1;focused=!1;activeItemPath=wt([]);number=wt(0);focusedItemInfo=wt({index:-1,level:0,parentKey:"",item:null});searchValue="";searchTimeout;_processedItems;_model;_componentStyle=at(bh);matchMediaListener;query;queryMatches;_submenuIconTemplate;_itemTemplate;get visibleItems(){let e=this.activeItemPath().find(i=>i.key===this.focusedItemInfo().parentKey);return e?e.items:this.processedItems}get processedItems(){return(!this._processedItems||!this._processedItems.length)&&(this._processedItems=this.createProcessedItems(this.model||[])),this._processedItems}get focusedItemId(){let e=this.focusedItemInfo();return e.item?.id?e.item.id:e.index!==-1?`${this.id}${Wr(e.parentKey)?"_"+e.parentKey:""}_${e.index}`:null}constructor(e){super(),this.overlayService=e,Qn(()=>{let i=this.activeItemPath();Wr(i)?(this.bindOutsideClickListener(),this.bindResizeListener()):(this.unbindOutsideClickListener(),this.unbindResizeListener())})}ngOnInit(){super.ngOnInit(),this.bindMatchMediaListener(),this.id=this.id||qr("pn_id_")}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"submenuicon":this._submenuIconTemplate=e.template;break;case"item":this._itemTemplate=e.template;break;default:this._itemTemplate=e.template;break}})}bindMatchMediaListener(){if(wr(this.platformId)&&!this.matchMediaListener){let e=window.matchMedia(`(max-width: ${this.breakpoint})`);this.query=e,this.queryMatches=e.matches,this.matchMediaListener=()=>{this.queryMatches=e.matches},e.addEventListener("change",this.matchMediaListener)}}unbindMatchMediaListener(){this.matchMediaListener&&(this.query.removeEventListener("change",this.matchMediaListener),this.matchMediaListener=null)}createProcessedItems(e,i=0,n={},s=""){let a=[];return e&&e.forEach((o,c)=>{let l=(s!==""?s+"_":"")+c,u={item:o,index:c,level:i,key:l,parent:n,parentKey:s};u.items=this.createProcessedItems(o.items,i+1,u,l),a.push(u)}),a}getItemProp(e,i){return e?es(e[i]):void 0}getProccessedItemLabel(e){return e?this.getItemLabel(e.item):void 0}getItemLabel(e){return this.getItemProp(e,"label")}isProcessedItemGroup(e){return e&&Wr(e.items)}isSelected(e){return this.activeItemPath().some(i=>i.key===e.key)}isValidSelectedItem(e){return this.isValidItem(e)&&this.isSelected(e)}isValidItem(e){return!!e&&!this.isItemDisabled(e.item)&&!this.isItemSeparator(e.item)&&this.isItemVisible(e.item)}isItemDisabled(e){return this.getItemProp(e,"disabled")}isItemVisible(e){return this.getItemProp(e,"visible")!==!1}isItemSeparator(e){return this.getItemProp(e,"separator")}isItemMatched(e){return this.isValidItem(e)&&this.getProccessedItemLabel(e).toLocaleLowerCase().startsWith(this.searchValue.toLocaleLowerCase())}isProccessedItemGroup(e){return e&&Wr(e.items)}onOverlayClick(e){this.popup&&this.overlayService.add({originalEvent:e,target:this.el.nativeElement})}onItemClick(e){let{originalEvent:i,processedItem:n}=e,s=this.isProcessedItemGroup(n),a=fn(n.parent);if(this.isSelected(n)){let{index:c,key:l,level:u,parentKey:h,item:f}=n;this.activeItemPath.set(this.activeItemPath().filter(d=>l!==d.key&&l.startsWith(d.key))),this.focusedItemInfo.set({index:c,level:u,parentKey:h,item:f}),this.dirty=!0,ut(this.rootmenu.sublistViewChild.nativeElement)}else if(s)this.onItemChange(e);else{let c=a?n:this.activeItemPath().find(l=>l.parentKey==="");this.hide(i),this.changeFocusedItemIndex(i,c?c.index:-1),ut(this.rootmenu.sublistViewChild.nativeElement)}}onItemMouseEnter(e){Jn()?this.onItemChange({event:e,processedItem:e.processedItem,focus:this.autoDisplay},"hover"):this.dirty&&this.onItemChange(e,"hover")}onKeyDown(e){let i=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"ArrowLeft":this.onArrowLeftKey(e);break;case"ArrowRight":this.onArrowRightKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"Space":this.onSpaceKey(e);break;case"Enter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"PageDown":case"PageUp":case"Backspace":case"ShiftLeft":case"ShiftRight":break;default:!i&&Us(e.key)&&this.searchItems(e,e.key);break}}onArrowDownKey(e){let i=this.focusedItemInfo().index!==-1?this.findNextItemIndex(this.focusedItemInfo().index):this.findFirstFocusedItemIndex();this.changeFocusedItemIndex(e,i),e.preventDefault()}onArrowRightKey(e){let i=this.visibleItems[this.focusedItemInfo().index],n=this.isProccessedItemGroup(i),s=i?.item;n&&(this.onItemChange({originalEvent:e,processedItem:i}),this.focusedItemInfo.set({index:-1,parentKey:i.key,item:s}),this.searchValue="",this.onArrowDownKey(e)),e.preventDefault()}onArrowUpKey(e){if(e.altKey){if(this.focusedItemInfo().index!==-1){let i=this.visibleItems[this.focusedItemInfo().index];!this.isProccessedItemGroup(i)&&this.onItemChange({originalEvent:e,processedItem:i})}this.popup&&this.hide(e,!0),e.preventDefault()}else{let i=this.focusedItemInfo().index!==-1?this.findPrevItemIndex(this.focusedItemInfo().index):this.findLastFocusedItemIndex();this.changeFocusedItemIndex(e,i),e.preventDefault()}}onArrowLeftKey(e){let i=this.visibleItems[this.focusedItemInfo().index],n=this.activeItemPath().find(o=>o.key===i.parentKey);fn(i.parent)||(this.focusedItemInfo.set({index:-1,parentKey:n?n.parentKey:"",item:i.item}),this.searchValue="",this.onArrowDownKey(e));let a=this.activeItemPath().filter(o=>o.parentKey!==this.focusedItemInfo().parentKey);this.activeItemPath.set(a),e.preventDefault()}onHomeKey(e){this.changeFocusedItemIndex(e,this.findFirstItemIndex()),e.preventDefault()}onEndKey(e){this.changeFocusedItemIndex(e,this.findLastItemIndex()),e.preventDefault()}onSpaceKey(e){this.onEnterKey(e)}onEscapeKey(e){this.hide(e,!0),this.focusedItemInfo().index=this.findFirstFocusedItemIndex(),e.preventDefault()}onTabKey(e){if(this.focusedItemInfo().index!==-1){let i=this.visibleItems[this.focusedItemInfo().index];!this.isProccessedItemGroup(i)&&this.onItemChange({originalEvent:e,processedItem:i})}this.hide()}onEnterKey(e){if(this.focusedItemInfo().index!==-1){let i=or(this.rootmenu.el.nativeElement,`li[id="${`${this.focusedItemId}`}"]`),n=i&&or(i,'a[data-pc-section="action"]');if(n?n.click():i&&i.click(),!this.popup){let s=this.visibleItems[this.focusedItemInfo().index];!this.isProccessedItemGroup(s)&&(this.focusedItemInfo().index=this.findFirstFocusedItemIndex())}}e.preventDefault()}onItemChange(e,i){let{processedItem:n,isFocus:s}=e;if(fn(n))return;let{index:a,key:o,level:c,parentKey:l,items:u,item:h}=n,f=Wr(u),d=this.activeItemPath().filter(g=>g.parentKey!==l&&g.parentKey!==o);f&&d.push(n),this.focusedItemInfo.set({index:a,level:c,parentKey:l,item:h}),f&&(this.dirty=!0),s&&ut(this.rootmenu.sublistViewChild.nativeElement),!(i==="hover"&&this.queryMatches)&&this.activeItemPath.set(d)}onMenuFocus(e){this.focused=!0,this.focusedItemInfo().index===-1&&this.popup}onMenuBlur(e){this.focused=!1,this.focusedItemInfo.set({index:-1,level:0,parentKey:"",item:null}),this.searchValue="",this.dirty=!1}onOverlayAnimationStart(e){switch(e.toState){case"visible":this.popup&&(this.container=e.element,this.moveOnTop(),this.onShow.emit({}),Yl(this.containerViewChild.nativeElement,{position:"absolute",top:0}),this.appendOverlay(),this.alignOverlay(),this.bindOutsideClickListener(),this.bindResizeListener(),this.bindScrollListener(),ut(this.rootmenu.sublistViewChild.nativeElement),this.scrollInView());break;case"void":this.onOverlayHide(),this.onHide.emit({});break}}alignOverlay(){this.relativeAlign?Ws(this.container,this.target):$s(this.container,this.target),Hs(this.target)>Hs(this.container)&&(this.container.style.minWidth=Hs(this.target)+"px")}onOverlayAnimationEnd(e){switch(e.toState){case"void":Sr.clear(e.element);break}}appendOverlay(){this.appendTo&&(this.appendTo==="body"?this.renderer.appendChild(this.document.body,this.container):un(this.appendTo,this.container))}restoreOverlayAppend(){this.container&&this.appendTo&&this.renderer.appendChild(this.el.nativeElement,this.container)}moveOnTop(){this.autoZIndex&&Sr.set("menu",this.container,this.baseZIndex+this.config.zIndex.menu)}hide(e,i){this.popup&&(this.onHide.emit({}),this.visible=!1),this.activeItemPath.set([]),this.focusedItemInfo.set({index:-1,level:0,parentKey:""}),i&&ut(this.relatedTarget||this.target||this.rootmenu.sublistViewChild.nativeElement),this.dirty=!1}toggle(e){this.visible?this.hide(e,!0):this.show(e)}show(e,i){this.popup&&(this.visible=!0,this.target=this.target||e.currentTarget,this.relatedTarget=e.relatedTarget||null,this.relativeAlign=e?.relativeAlign||null),this.focusedItemInfo.set({index:-1,level:0,parentKey:""}),i&&ut(this.rootmenu.sublistViewChild.nativeElement),this.cd.markForCheck()}searchItems(e,i){this.searchValue=(this.searchValue||"")+i;let n=-1,s=!1;return this.focusedItemInfo().index!==-1?(n=this.visibleItems.slice(this.focusedItemInfo().index).findIndex(a=>this.isItemMatched(a)),n=n===-1?this.visibleItems.slice(0,this.focusedItemInfo().index).findIndex(a=>this.isItemMatched(a)):n+this.focusedItemInfo().index):n=this.visibleItems.findIndex(a=>this.isItemMatched(a)),n!==-1&&(s=!0),n===-1&&this.focusedItemInfo().index===-1&&(n=this.findFirstFocusedItemIndex()),n!==-1&&this.changeFocusedItemIndex(e,n),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchValue="",this.searchTimeout=null},500),s}findLastFocusedItemIndex(){let e=this.findSelectedItemIndex();return e<0?this.findLastItemIndex():e}findLastItemIndex(){return pn(this.visibleItems,e=>this.isValidItem(e))}findPrevItemIndex(e){let i=e>0?pn(this.visibleItems.slice(0,e),n=>this.isValidItem(n)):-1;return i>-1?i:e}findNextItemIndex(e){let i=e<this.visibleItems.length-1?this.visibleItems.slice(e+1).findIndex(n=>this.isValidItem(n)):-1;return i>-1?i+e+1:e}findFirstFocusedItemIndex(){let e=this.findSelectedItemIndex();return e<0?this.findFirstItemIndex():e}findFirstItemIndex(){return this.visibleItems.findIndex(e=>this.isValidItem(e))}findSelectedItemIndex(){return this.visibleItems.findIndex(e=>this.isValidSelectedItem(e))}changeFocusedItemIndex(e,i){if(this.focusedItemInfo().index!==i){let n=this.focusedItemInfo();this.focusedItemInfo.set(Y(F({},n),{item:this.visibleItems[i].item,index:i})),this.scrollInView()}}scrollInView(e=-1){let i=e!==-1?`${this.id}_${e}`:this.focusedItemId,n=or(this.rootmenu.el.nativeElement,`li[id="${i}"]`);n&&n.scrollIntoView&&n.scrollIntoView({block:"nearest",inline:"nearest"})}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new Ks(this.target,e=>{this.visible&&this.hide(e,!0)})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&(this.scrollHandler.unbindScrollListener(),this.scrollHandler=null)}bindResizeListener(){wr(this.platformId)&&(this.resizeListener||(this.resizeListener=this.renderer.listen(this.document.defaultView,"resize",e=>{Jn()||this.hide(e,!0)})))}bindOutsideClickListener(){wr(this.platformId)&&(this.outsideClickListener||(this.outsideClickListener=this.renderer.listen(this.document,"click",e=>{let i=this.containerViewChild&&!this.containerViewChild.nativeElement.contains(e.target),n=this.popup?!(this.target&&(this.target===e.target||this.target.contains(e.target))):!0;i&&n&&this.hide()})))}unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)}unbindResizeListener(){this.resizeListener&&(this.resizeListener(),this.resizeListener=null)}onOverlayHide(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindScrollListener(),this.cd.destroyed||(this.target=null)}ngOnDestroy(){this.popup&&(this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.container&&this.autoZIndex&&Sr.clear(this.container),this.restoreOverlayAppend(),this.onOverlayHide()),this.unbindMatchMediaListener(),super.ngOnDestroy()}static \u0275fac=function(i){return new(i||r)(ze(Gs))};static \u0275cmp=Oe({type:r,selectors:[["p-tieredMenu"],["p-tieredmenu"],["p-tiered-menu"]],contentQueries:function(i,n,s){if(i&1&&(Ue(s,G2,4),Ue(s,X2,4),Ue(s,er,4)),i&2){let a;de(a=pe())&&(n.submenuIconTemplate=a.first),de(a=pe())&&(n.itemTemplate=a.first),de(a=pe())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&(Ae(j2,5),Ae(K2,5)),i&2){let s;de(s=pe())&&(n.rootmenu=s.first),de(s=pe())&&(n.containerViewChild=s.first)}},inputs:{model:"model",popup:[2,"popup","popup",be],style:"style",styleClass:"styleClass",appendTo:"appendTo",breakpoint:"breakpoint",autoZIndex:[2,"autoZIndex","autoZIndex",be],baseZIndex:[2,"baseZIndex","baseZIndex",Ot],autoDisplay:[2,"autoDisplay","autoDisplay",be],showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",id:"id",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",disabled:[2,"disabled","disabled",be],tabindex:[2,"tabindex","tabindex",Ot]},outputs:{onShow:"onShow",onHide:"onHide"},features:[Ft([bh]),Ht],decls:1,vars:1,consts:[["container",""],["rootmenu",""],[3,"id","ngClass","class","ngStyle","click",4,"ngIf"],[3,"click","id","ngClass","ngStyle"],[3,"itemClick","menuFocus","menuBlur","menuKeydown","itemMouseEnter","root","items","itemTemplate","menuId","tabindex","ariaLabel","ariaLabelledBy","baseZIndex","autoZIndex","autoDisplay","popup","focusedItemId","activeItemPath"]],template:function(i,n){i&1&&z(0,Z2,4,30,"div",2),i&2&&w("ngIf",!n.popup||n.visible)},dependencies:[Le,Wt,Tt,St,tb,wi,Mr,tt],encapsulation:2,data:{animation:[bi("overlayAnimation",[Tr(":enter",[Cr({opacity:0,transform:"scaleY(0.8)"}),br("{{showTransitionParams}}")]),Tr(":leave",[br("{{hideTransitionParams}}",Cr({opacity:0}))])])]},changeDetection:0})}return r})();var rb=["content"],ib=["dropdownicon"],nb=["container"],sb=["defaultbtn"],ab=["menu"];function ob(r,t){r&1&&$e(0)}function lb(r,t){if(r&1){let e=ge();Be(0),P(1,"button",10),ce("click",function(n){X(e);let s=y();return j(s.onDefaultButtonClick(n))}),z(2,ob,1,0,"ng-container",11),L(),Ve()}if(r&2){let e=y();S(),w("severity",e.severity)("text",e.text)("outlined",e.outlined)("size",e.size)("icon",e.icon)("iconPos",e.iconPos)("disabled",e.disabled)("pAutoFocus",e.autofocus)("pTooltip",e.tooltip)("tooltipOptions",e.tooltipOptions),fe("tabindex",e.tabindex)("aria-label",(e.buttonProps==null?null:e.buttonProps.ariaLabel)||e.label),S(),w("ngTemplateOutlet",e.contentTemplate||e._contentTemplate)}}function cb(r,t){if(r&1){let e=ge();P(0,"button",12,3),ce("click",function(n){X(e);let s=y();return j(s.onDefaultButtonClick(n))}),L()}if(r&2){let e=y();w("severity",e.severity)("text",e.text)("outlined",e.outlined)("size",e.size)("icon",e.icon)("iconPos",e.iconPos)("label",e.label)("disabled",e.buttonDisabled)("pAutoFocus",e.autofocus)("pTooltip",e.tooltip)("tooltipOptions",e.tooltipOptions),fe("tabindex",e.tabindex)("aria-label",e.buttonProps==null?null:e.buttonProps.ariaLabel)}}function ub(r,t){if(r&1&&he(0,"span"),r&2){let e=y();et(e.dropdownIcon)}}function hb(r,t){r&1&&he(0,"ChevronDownIcon")}function fb(r,t){}function db(r,t){r&1&&z(0,fb,0,0,"ng-template")}function pb(r,t){if(r&1&&(Be(0),z(1,hb,1,0,"ChevronDownIcon",8)(2,db,1,0,null,11),Ve()),r&2){let e=y();S(),w("ngIf",!e.dropdownIconTemplate&&!e._dropdownIconTemplate),S(),w("ngTemplateOutlet",e.dropdownIconTemplate||e._dropdownIconTemplate)}}var mb=({dt:r})=>`
.p-splitbutton {
    display: inline-flex;
    position: relative;
    border-radius: ${r("splitbutton.border.radius")};
}

.p-splitbutton-button.p-button {
    border-start-end-radius: 0;
    border-end-end-radius: 0;
    border-right: 0 none;
}

.p-splitbutton-button.p-button:focus-visible,
.p-splitbutton-dropdown.p-button:focus-visible {
    z-index: 1;
}

.p-splitbutton-button.p-button:not(:disabled):hover,
.p-splitbutton-button.p-button:not(:disabled):active {
    border-right: 0 none;
}

.p-splitbutton-dropdown.p-button {
    border-start-start-radius: 0;
    border-end-start-radius: 0;
}

.p-splitbutton .p-menu {
    min-width: 100%;
}

.p-splitbutton-fluid {
    display: flex;
}

.p-splitbutton-rounded .p-splitbutton-dropdown {
    border-start-end-radius: ${r("splitbutton.rounded.border.radius")};
    border-end-end-radius: ${r("splitbutton.rounded.border.radius")};
}

.p-splitbutton-rounded > .p-splitbutton-button {
    border-start-start-radius: ${r("splitbutton.rounded.border.radius")};
    border-end-start-radius: ${r("splitbutton.rounded.border.radius")};
}

.p-splitbutton-raised {
    box-shadow: ${r("splitbutton.raised.shadow")};
}
`,gb={root:({props:r})=>["p-splitbutton p-component",{"p-splitbutton-raised":r.raised,"p-splitbutton-rounded":r.rounded,"p-splitbutton-fluid":r.fluid}],pcButton:"p-splitbutton-button",pcDropdown:"p-splitbutton-dropdown"},Th=(()=>{class r extends pr{name="splitbutton";theme=mb;classes=gb;static \u0275fac=(()=>{let e;return function(n){return(e||(e=bt(r)))(n||r)}})();static \u0275prov=yt({token:r,factory:r.\u0275fac})}return r})();var xb=(()=>{class r extends tr{model;severity;raised=!1;rounded=!1;text=!1;outlined=!1;size=null;plain=!1;icon;iconPos="left";label;tooltip;tooltipOptions;style;styleClass;menuStyle;menuStyleClass;dropdownIcon;appendTo="body";dir;expandAriaLabel;showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)";hideTransitionOptions=".1s linear";buttonProps;menuButtonProps;autofocus;set disabled(e){this._disabled=e,this.buttonDisabled=e,this.menuButtonDisabled=e}get disabled(){return this._disabled}tabindex;menuButtonDisabled=!1;buttonDisabled=!1;onClick=new ve;onMenuHide=new ve;onMenuShow=new ve;onDropdownClick=new ve;containerViewChild;buttonViewChild;menu;contentTemplate;dropdownIconTemplate;templates;ariaId;isExpanded=wt(!1);_disabled;_componentStyle=at(Th);_contentTemplate;_dropdownIconTemplate;ngOnInit(){super.ngOnInit(),this.ariaId=qr("pn_id_")}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this._contentTemplate=e.template;break;case"dropdownicon":this._dropdownIconTemplate=e.template;break;default:this._contentTemplate=e.template;break}})}get containerClass(){let e={"p-splitbutton p-component":!0,"p-splitbutton-raised":this.raised,"p-splitbutton-rounded":this.rounded,"p-splitbutton-outlined":this.outlined,"p-splitbutton-text":this.text,[`p-splitbutton-${this.size==="small"?"sm":"lg"}`]:this.size};return F({},e)}onDefaultButtonClick(e){this.onClick.emit(e),this.menu.hide()}onDropdownButtonClick(e){this.onDropdownClick.emit(e),this.menu?.toggle({currentTarget:this.containerViewChild?.nativeElement,relativeAlign:this.appendTo==null})}onDropdownButtonKeydown(e){(e.code==="ArrowDown"||e.code==="ArrowUp")&&(this.onDropdownButtonClick(),e.preventDefault())}onHide(){this.isExpanded.set(!1),this.onMenuHide.emit()}onShow(){this.isExpanded.set(!0),this.onMenuShow.emit()}static \u0275fac=(()=>{let e;return function(n){return(e||(e=bt(r)))(n||r)}})();static \u0275cmp=Oe({type:r,selectors:[["p-splitbutton"],["p-splitButton"],["p-split-button"]],contentQueries:function(i,n,s){if(i&1&&(Ue(s,rb,4),Ue(s,ib,4),Ue(s,er,4)),i&2){let a;de(a=pe())&&(n.contentTemplate=a.first),de(a=pe())&&(n.dropdownIconTemplate=a.first),de(a=pe())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&(Ae(nb,5),Ae(sb,5),Ae(ab,5)),i&2){let s;de(s=pe())&&(n.containerViewChild=s.first),de(s=pe())&&(n.buttonViewChild=s.first),de(s=pe())&&(n.menu=s.first)}},inputs:{model:"model",severity:"severity",raised:[2,"raised","raised",be],rounded:[2,"rounded","rounded",be],text:[2,"text","text",be],outlined:[2,"outlined","outlined",be],size:"size",plain:[2,"plain","plain",be],icon:"icon",iconPos:"iconPos",label:"label",tooltip:"tooltip",tooltipOptions:"tooltipOptions",style:"style",styleClass:"styleClass",menuStyle:"menuStyle",menuStyleClass:"menuStyleClass",dropdownIcon:"dropdownIcon",appendTo:"appendTo",dir:"dir",expandAriaLabel:"expandAriaLabel",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",buttonProps:"buttonProps",menuButtonProps:"menuButtonProps",autofocus:[2,"autofocus","autofocus",be],disabled:[2,"disabled","disabled",be],tabindex:[2,"tabindex","tabindex",Ot],menuButtonDisabled:[2,"menuButtonDisabled","menuButtonDisabled",be],buttonDisabled:[2,"buttonDisabled","buttonDisabled",be]},outputs:{onClick:"onClick",onMenuHide:"onMenuHide",onMenuShow:"onMenuShow",onDropdownClick:"onDropdownClick"},features:[Ft([Th]),Ht],decls:10,vars:26,consts:[["container",""],["defaultButton",""],["menu",""],["defaultbtn",""],[3,"ngClass","ngStyle"],[4,"ngIf","ngIfElse"],["type","button","pButton","","pRipple","",1,"p-splitbutton-dropdown","p-button-icon-only",3,"click","keydown","size","severity","text","outlined","disabled"],[3,"class",4,"ngIf"],[4,"ngIf"],[3,"onHide","onShow","id","popup","model","styleClass","appendTo","showTransitionOptions","hideTransitionOptions"],["type","button","pButton","","pRipple","",1,"p-splitbutton-button",3,"click","severity","text","outlined","size","icon","iconPos","disabled","pAutoFocus","pTooltip","tooltipOptions"],[4,"ngTemplateOutlet"],["type","button","pButton","","pRipple","",1,"p-splitbutton-button",3,"click","severity","text","outlined","size","icon","iconPos","label","disabled","pAutoFocus","pTooltip","tooltipOptions"]],template:function(i,n){if(i&1){let s=ge();P(0,"div",4,0),z(2,lb,3,13,"ng-container",5)(3,cb,2,13,"ng-template",null,1,ct),P(5,"button",6),ce("click",function(o){return X(s),j(n.onDropdownButtonClick(o))})("keydown",function(o){return X(s),j(n.onDropdownButtonKeydown(o))}),z(6,ub,1,2,"span",7)(7,pb,3,2,"ng-container",8),L(),P(8,"p-tieredMenu",9,2),ce("onHide",function(){return X(s),j(n.onHide())})("onShow",function(){return X(s),j(n.onShow())}),L()()}if(i&2){let s=mt(4);et(n.styleClass),w("ngClass",n.containerClass)("ngStyle",n.style),S(2),w("ngIf",n.contentTemplate||n._contentTemplate)("ngIfElse",s),S(3),w("size",n.size)("severity",n.severity)("text",n.text)("outlined",n.outlined)("disabled",n.menuButtonDisabled),fe("aria-label",(n.menuButtonProps==null?null:n.menuButtonProps.ariaLabel)||n.expandAriaLabel)("aria-haspopup",(n.menuButtonProps==null?null:n.menuButtonProps.ariaHasPopup)||!0)("aria-expanded",(n.menuButtonProps==null?null:n.menuButtonProps.ariaExpanded)||n.isExpanded())("aria-controls",(n.menuButtonProps==null?null:n.menuButtonProps.ariaControls)||n.ariaId),S(),w("ngIf",n.dropdownIcon),S(),w("ngIf",!n.dropdownIcon),S(),Qt(n.menuStyle),w("id",n.ariaId)("popup",!0)("model",n.model)("styleClass",n.menuStyleClass)("appendTo",n.appendTo)("showTransitionOptions",n.showTransitionOptions)("hideTransitionOptions",n.hideTransitionOptions)}},dependencies:[Le,Wt,Tt,Jt,St,hc,_l,Ys,rs,Qr,Mr,Zr,tt],encapsulation:2,changeDetection:0})}return r})(),Sh=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=$t({type:r});static \u0275inj=Vt({imports:[xb,tt,tt]})}return r})();var As=r=>({height:r}),_b=(r,t,e)=>({"p-select-option":!0,"p-select-option-selected":r,"p-disabled":t,"p-focus":e}),vl=r=>({$implicit:r});function vb(r,t){r&1&&he(0,"CheckIcon",4),r&2&&w("styleClass","p-select-option-check-icon")}function yb(r,t){r&1&&he(0,"BlankIcon",4),r&2&&w("styleClass","p-select-option-blank-icon")}function wb(r,t){if(r&1&&(Be(0),z(1,vb,1,1,"CheckIcon",3)(2,yb,1,1,"BlankIcon",3),Ve()),r&2){let e=y();S(),w("ngIf",e.selected),S(),w("ngIf",!e.selected)}}function bb(r,t){if(r&1&&(P(0,"span"),Se(1),L()),r&2){let e=y();S(),He(e.label??"empty")}}function Cb(r,t){r&1&&$e(0)}var Tb=["container"],Sb=["filter"],Eb=["focusInput"],Ib=["editableInput"],kb=["items"],Fb=["scroller"],Ob=["overlay"],Ab=["firstHiddenFocusableEl"],Db=["lastHiddenFocusableEl"],Mb=()=>({class:"p-select-clear-icon"}),Pb=()=>({class:"p-select-dropdown-icon"}),kh=r=>({options:r}),Fh=(r,t)=>({$implicit:r,options:t}),Lb=()=>({});function Rb(r,t){if(r&1&&(Be(0),Se(1),Ve()),r&2){let e=y(2);S(),He(e.label()==="p-emptylabel"?"\xA0":e.label())}}function Nb(r,t){if(r&1&&$e(0,23),r&2){let e=y(2);w("ngTemplateOutlet",e.selectedItemTemplate)("ngTemplateOutletContext",Re(2,vl,e.selectedOption))}}function Bb(r,t){if(r&1&&(P(0,"span"),Se(1),L()),r&2){let e=y(3);S(),He(e.label()==="p-emptylabel"?"\xA0":e.label())}}function Vb(r,t){if(r&1&&z(0,Bb,2,1,"span",17),r&2){let e=y(2);w("ngIf",!e.selectedOption)}}function $b(r,t){if(r&1){let e=ge();P(0,"span",21,3),ce("focus",function(n){X(e);let s=y();return j(s.onInputFocus(n))})("blur",function(n){X(e);let s=y();return j(s.onInputBlur(n))})("keydown",function(n){X(e);let s=y();return j(s.onKeyDown(n))}),z(2,Rb,2,1,"ng-container",19)(3,Nb,1,4,"ng-container",22)(4,Vb,1,1,"ng-template",null,4,ct),L()}if(r&2){let e=mt(5),i=y();w("ngClass",i.inputClass)("pTooltip",i.tooltip)("tooltipPosition",i.tooltipPosition)("positionStyle",i.tooltipPositionStyle)("tooltipStyleClass",i.tooltipStyleClass)("pAutoFocus",i.autofocus),fe("aria-disabled",i.disabled)("id",i.inputId)("aria-label",i.ariaLabel||(i.label()==="p-emptylabel"?void 0:i.label()))("aria-labelledby",i.ariaLabelledBy)("aria-haspopup","listbox")("aria-expanded",i.overlayVisible??!1)("aria-controls",i.overlayVisible?i.id+"_list":null)("tabindex",i.disabled?-1:i.tabindex)("aria-activedescendant",i.focused?i.focusedOptionId:void 0)("aria-required",i.required)("required",i.required),S(2),w("ngIf",!i.selectedItemTemplate)("ngIfElse",e),S(),w("ngIf",i.selectedItemTemplate&&i.selectedOption)}}function Hb(r,t){if(r&1){let e=ge();P(0,"input",24,5),ce("input",function(n){X(e);let s=y();return j(s.onEditableInput(n))})("keydown",function(n){X(e);let s=y();return j(s.onKeyDown(n))})("focus",function(n){X(e);let s=y();return j(s.onInputFocus(n))})("blur",function(n){X(e);let s=y();return j(s.onInputBlur(n))}),L()}if(r&2){let e=y();w("ngClass",e.inputClass)("disabled",e.disabled)("pAutoFocus",e.autofocus),fe("id",e.inputId)("maxlength",e.maxlength)("placeholder",e.modelValue()===void 0||e.modelValue()===null?e.placeholder():void 0)("aria-label",e.ariaLabel||(e.label()==="p-emptylabel"?void 0:e.label()))("aria-activedescendant",e.focused?e.focusedOptionId:void 0)}}function Wb(r,t){if(r&1){let e=ge();P(0,"TimesIcon",26),ce("click",function(n){X(e);let s=y(2);return j(s.clear(n))}),L()}r&2&&fe("data-pc-section","clearicon")}function zb(r,t){}function Ub(r,t){r&1&&z(0,zb,0,0,"ng-template")}function Gb(r,t){if(r&1){let e=ge();P(0,"span",26),ce("click",function(n){X(e);let s=y(2);return j(s.clear(n))}),z(1,Ub,1,0,null,27),L()}if(r&2){let e=y(2);fe("data-pc-section","clearicon"),S(),w("ngTemplateOutlet",e.clearIconTemplate)("ngTemplateOutletContext",Zt(3,Mb))}}function Xb(r,t){if(r&1&&(Be(0),z(1,Wb,1,1,"TimesIcon",25)(2,Gb,2,4,"span",25),Ve()),r&2){let e=y();S(),w("ngIf",!e.clearIconTemplate),S(),w("ngIf",e.clearIconTemplate)}}function jb(r,t){r&1&&$e(0)}function Kb(r,t){if(r&1&&(Be(0),z(1,jb,1,0,"ng-container",28),Ve()),r&2){let e=y(2);S(),w("ngTemplateOutlet",e.loadingIconTemplate)}}function Yb(r,t){if(r&1&&he(0,"span",31),r&2){let e=y(3);w("ngClass","p-select-loading-icon pi-spin "+e.loadingIcon)}}function qb(r,t){r&1&&he(0,"span",32),r&2&&et("p-select-loading-icon pi pi-spinner pi-spin")}function Qb(r,t){if(r&1&&(Be(0),z(1,Yb,1,1,"span",29)(2,qb,1,2,"span",30),Ve()),r&2){let e=y(2);S(),w("ngIf",e.loadingIcon),S(),w("ngIf",!e.loadingIcon)}}function Zb(r,t){if(r&1&&(Be(0),z(1,Kb,2,1,"ng-container",17)(2,Qb,3,2,"ng-container",17),Ve()),r&2){let e=y();S(),w("ngIf",e.loadingIconTemplate),S(),w("ngIf",!e.loadingIconTemplate)}}function Jb(r,t){if(r&1&&he(0,"span",36),r&2){let e=y(3);w("ngClass",e.dropdownIcon)}}function eC(r,t){r&1&&he(0,"ChevronDownIcon",37),r&2&&w("styleClass","p-select-dropdown-icon")}function tC(r,t){if(r&1&&(Be(0),z(1,Jb,1,1,"span",34)(2,eC,1,1,"ChevronDownIcon",35),Ve()),r&2){let e=y(2);S(),w("ngIf",e.dropdownIcon),S(),w("ngIf",!e.dropdownIcon)}}function rC(r,t){}function iC(r,t){r&1&&z(0,rC,0,0,"ng-template")}function nC(r,t){if(r&1&&(P(0,"span",38),z(1,iC,1,0,null,27),L()),r&2){let e=y(2);S(),w("ngTemplateOutlet",e.dropdownIconTemplate)("ngTemplateOutletContext",Zt(2,Pb))}}function sC(r,t){if(r&1&&z(0,tC,3,2,"ng-container",17)(1,nC,2,3,"span",33),r&2){let e=y();w("ngIf",!e.dropdownIconTemplate),S(),w("ngIf",e.dropdownIconTemplate)}}function aC(r,t){r&1&&$e(0)}function oC(r,t){r&1&&$e(0)}function lC(r,t){if(r&1&&(Be(0),z(1,oC,1,0,"ng-container",27),Ve()),r&2){let e=y(3);S(),w("ngTemplateOutlet",e.filterTemplate)("ngTemplateOutletContext",Re(2,kh,e.filterOptions))}}function cC(r,t){r&1&&he(0,"SearchIcon")}function uC(r,t){}function hC(r,t){r&1&&z(0,uC,0,0,"ng-template")}function fC(r,t){if(r&1&&(P(0,"span"),z(1,hC,1,0,null,28),L()),r&2){let e=y(4);S(),w("ngTemplateOutlet",e.filterIconTemplate)}}function dC(r,t){if(r&1){let e=ge();P(0,"p-iconfield")(1,"input",45,10),ce("input",function(n){X(e);let s=y(3);return j(s.onFilterInputChange(n))})("keydown",function(n){X(e);let s=y(3);return j(s.onFilterKeyDown(n))})("blur",function(n){X(e);let s=y(3);return j(s.onFilterBlur(n))}),L(),P(3,"p-inputicon"),z(4,cC,1,0,"SearchIcon",17)(5,fC,2,1,"span",17),L()()}if(r&2){let e=y(3);S(),w("value",e._filterValue()||"")("variant",e.variant),fe("placeholder",e.filterPlaceholder)("aria-owns",e.id+"_list")("aria-label",e.ariaFilterLabel)("aria-activedescendant",e.focusedOptionId),S(3),w("ngIf",!e.filterIconTemplate),S(),w("ngIf",e.filterIconTemplate)}}function pC(r,t){if(r&1){let e=ge();P(0,"div",44),ce("click",function(n){return X(e),j(n.stopPropagation())}),z(1,lC,2,4,"ng-container",19)(2,dC,6,8,"ng-template",null,9,ct),L()}if(r&2){let e=mt(3),i=y(2);S(),w("ngIf",i.filterTemplate)("ngIfElse",e)}}function mC(r,t){r&1&&$e(0)}function gC(r,t){if(r&1&&z(0,mC,1,0,"ng-container",27),r&2){let e=t.$implicit,i=t.options;y(2);let n=mt(9);w("ngTemplateOutlet",n)("ngTemplateOutletContext",Ct(2,Fh,e,i))}}function xC(r,t){r&1&&$e(0)}function _C(r,t){if(r&1&&z(0,xC,1,0,"ng-container",27),r&2){let e=t.options,i=y(4);w("ngTemplateOutlet",i.loaderTemplate)("ngTemplateOutletContext",Re(2,kh,e))}}function vC(r,t){r&1&&(Be(0),z(1,_C,1,4,"ng-template",null,12,ct),Ve())}function yC(r,t){if(r&1){let e=ge();P(0,"p-scroller",46,11),ce("onLazyLoad",function(n){X(e);let s=y(2);return j(s.onLazyLoad.emit(n))}),z(2,gC,1,5,"ng-template",null,2,ct)(4,vC,3,0,"ng-container",17),L()}if(r&2){let e=y(2);Qt(Re(8,As,e.scrollHeight)),w("items",e.visibleOptions())("itemSize",e.virtualScrollItemSize||e._itemSize)("autoSize",!0)("lazy",e.lazy)("options",e.virtualScrollOptions),S(4),w("ngIf",e.loaderTemplate)}}function wC(r,t){r&1&&$e(0)}function bC(r,t){if(r&1&&(Be(0),z(1,wC,1,0,"ng-container",27),Ve()),r&2){y();let e=mt(9),i=y();S(),w("ngTemplateOutlet",e)("ngTemplateOutletContext",Ct(3,Fh,i.visibleOptions(),Zt(2,Lb)))}}function CC(r,t){if(r&1&&(P(0,"span"),Se(1),L()),r&2){let e=y(2).$implicit,i=y(3);S(),He(i.getOptionGroupLabel(e.optionGroup))}}function TC(r,t){r&1&&$e(0)}function SC(r,t){if(r&1&&(Be(0),P(1,"li",50),z(2,CC,2,1,"span",17)(3,TC,1,0,"ng-container",27),L(),Ve()),r&2){let e=y(),i=e.$implicit,n=e.index,s=y().options,a=y(2);S(),w("ngStyle",Re(5,As,s.itemSize+"px")),fe("id",a.id+"_"+a.getOptionIndex(n,s)),S(),w("ngIf",!a.groupTemplate),S(),w("ngTemplateOutlet",a.groupTemplate)("ngTemplateOutletContext",Re(7,vl,i.optionGroup))}}function EC(r,t){if(r&1){let e=ge();Be(0),P(1,"p-dropdownItem",51),ce("onClick",function(n){X(e);let s=y().$implicit,a=y(3);return j(a.onOptionSelect(n,s))})("onMouseEnter",function(n){X(e);let s=y().index,a=y().options,o=y(2);return j(o.onOptionMouseEnter(n,o.getOptionIndex(s,a)))}),L(),Ve()}if(r&2){let e=y(),i=e.$implicit,n=e.index,s=y().options,a=y(2);S(),w("id",a.id+"_"+a.getOptionIndex(n,s))("option",i)("checkmark",a.checkmark)("selected",a.isSelected(i))("label",a.getOptionLabel(i))("disabled",a.isOptionDisabled(i))("template",a.itemTemplate)("focused",a.focusedOptionIndex()===a.getOptionIndex(n,s))("ariaPosInset",a.getAriaPosInset(a.getOptionIndex(n,s)))("ariaSetSize",a.ariaSetSize)}}function IC(r,t){if(r&1&&z(0,SC,4,9,"ng-container",17)(1,EC,2,10,"ng-container",17),r&2){let e=t.$implicit,i=y(3);w("ngIf",i.isOptionGroup(e)),S(),w("ngIf",!i.isOptionGroup(e))}}function kC(r,t){if(r&1&&Se(0),r&2){let e=y(4);yr(" ",e.emptyFilterMessageLabel," ")}}function FC(r,t){r&1&&$e(0,null,14)}function OC(r,t){if(r&1&&z(0,FC,2,0,"ng-container",28),r&2){let e=y(4);w("ngTemplateOutlet",e.emptyFilterTemplate||e.emptyTemplate)}}function AC(r,t){if(r&1&&(P(0,"li",52),dt(1,kC,1,1)(2,OC,1,1,"ng-container"),L()),r&2){let e=y().options,i=y(2);w("ngStyle",Re(2,As,e.itemSize+"px")),S(),pt(!i.emptyFilterTemplate&&!i.emptyTemplate?1:2)}}function DC(r,t){if(r&1&&Se(0),r&2){let e=y(4);yr(" ",e.emptyMessageLabel," ")}}function MC(r,t){r&1&&$e(0)}function PC(r,t){if(r&1&&z(0,MC,1,0,"ng-container",28),r&2){let e=y(4);w("ngTemplateOutlet",e.emptyTemplate)}}function LC(r,t){if(r&1&&(P(0,"li",52),dt(1,DC,1,1)(2,PC,1,1,"ng-container"),L()),r&2){let e=y().options,i=y(2);w("ngStyle",Re(2,As,e.itemSize+"px")),S(),pt(i.emptyTemplate?2:1)}}function RC(r,t){if(r&1&&(P(0,"ul",47,13),z(2,IC,2,2,"ng-template",48)(3,AC,3,4,"li",49)(4,LC,3,4,"li",49),L()),r&2){let e=t.$implicit,i=t.options,n=y(2);Qt(i.contentStyle),w("ngClass",i.contentStyleClass),fe("id",n.id+"_list")("aria-label",n.listLabel),S(2),w("ngForOf",e),S(),w("ngIf",n.filterValue&&n.isEmpty()),S(),w("ngIf",!n.filterValue&&n.isEmpty())}}function NC(r,t){r&1&&$e(0)}function BC(r,t){if(r&1){let e=ge();P(0,"div",39)(1,"span",40,6),ce("focus",function(n){X(e);let s=y();return j(s.onFirstHiddenFocus(n))}),L(),z(3,aC,1,0,"ng-container",28)(4,pC,4,2,"div",41),P(5,"div",42),z(6,yC,5,10,"p-scroller",43)(7,bC,2,6,"ng-container",17)(8,RC,5,8,"ng-template",null,7,ct),L(),z(10,NC,1,0,"ng-container",28),P(11,"span",40,8),ce("focus",function(n){X(e);let s=y();return j(s.onLastHiddenFocus(n))}),L()()}if(r&2){let e=y();et(e.panelStyleClass),w("ngClass","p-select-overlay p-component")("ngStyle",e.panelStyle),S(),fe("tabindex",0)("data-p-hidden-accessible",!0)("data-p-hidden-focusable",!0),S(2),w("ngTemplateOutlet",e.headerTemplate),S(),w("ngIf",e.filter),S(),Dr("max-height",e.virtualScroll?"auto":e.scrollHeight||"auto"),S(),w("ngIf",e.virtualScroll),S(),w("ngIf",!e.virtualScroll),S(3),w("ngTemplateOutlet",e.footerTemplate),S(),fe("tabindex",0)("data-p-hidden-accessible",!0)("data-p-hidden-focusable",!0)}}var VC=({dt:r})=>`
.p-select {
    display: inline-flex;
    cursor: pointer;
    position: relative;
    user-select: none;
    background: ${r("select.background")};
    border: 1px solid ${r("select.border.color")};
    transition: background ${r("select.transition.duration")}, color ${r("select.transition.duration")}, border-color ${r("select.transition.duration")},
        outline-color ${r("select.transition.duration")}, box-shadow ${r("select.transition.duration")};
    border-radius: ${r("select.border.radius")};
    outline-color: transparent;
    box-shadow: ${r("select.shadow")};
}

.p-select:not(.p-disabled):hover {
    border-color: ${r("select.hover.border.color")};
}

.p-select:not(.p-disabled).p-focus {
    border-color: ${r("select.focus.border.color")};
    box-shadow: ${r("select.focus.ring.shadow")};
    outline: ${r("select.focus.ring.width")} ${r("select.focus.ring.style")} ${r("select.focus.ring.color")};
    outline-offset: ${r("select.focus.ring.offset")};
}

.p-select.p-variant-filled {
    background: ${r("select.filled.background")};
}

.p-select.p-variant-filled.p-focus {
    background: ${r("select.filled.focus.background")};
}

.p-select.p-disabled {
    opacity: 1;
    background: ${r("select.disabled.background")};
}

.p-select-clear-icon {
    position: absolute;
    top: 50%;
    margin-top: -0.5rem;
    color: ${r("select.clear.icon.color")};
    right: ${r("select.dropdown.width")};
}

.p-select-dropdown {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    background: transparent;
    color: ${r("select.dropdown.color")};
    width: ${r("select.dropdown.width")};
    border-start-end-radius: ${r("select.border.radius")};
    border-end-end-radius: ${r("select.border.radius")};
}

.p-select-label {
    display: block;
    white-space: nowrap;
    overflow: hidden;
    flex: 1 1 auto;
    width: 1%;
    padding: ${r("select.padding.y")} ${r("select.padding.x")};
    text-overflow: ellipsis;
    cursor: pointer;
    color: ${r("select.color")};
    background: transparent;
    border: 0 none;
    outline: 0 none;
}

.p-select-label.p-placeholder {
    color: ${r("select.placeholder.color")};
}

.p-select:has(.p-select-clear-icon) .p-select-label {
    padding-right: calc(1rem + ${r("select.padding.x")});
}

.p-select.p-disabled .p-select-label {
    color: ${r("select.disabled.color")};
}

.p-select-label-empty {
    overflow: hidden;
    opacity: 0;
}

input.p-select-label {
    cursor: default;
}

.p-select .p-select-overlay {
    min-width: 100%;
}

.p-select-overlay {
    position: absolute;
    top: 0;
    left: 0;
    background: ${r("select.overlay.background")};
    color: ${r("select.overlay.color")};
    border: 1px solid ${r("select.overlay.border.color")};
    border-radius: ${r("select.overlay.border.radius")};
    box-shadow: ${r("select.overlay.shadow")};
}

.p-select-header {
    padding: ${r("select.list.header.padding")};
}

.p-select-filter {
    width: 100%;
}

.p-select-list-container {
    overflow: auto;
}

.p-select-option-group {
    cursor: auto;
    margin: 0;
    padding: ${r("select.option.group.padding")};
    background: ${r("select.option.group.background")};
    color: ${r("select.option.group.color")};
    font-weight: ${r("select.option.group.font.weight")};
}

.p-select-list {
    margin: 0;
    padding: 0;
    list-style-type: none;
    padding: ${r("select.list.padding")};
    gap: ${r("select.list.gap")};
    display: flex;
    flex-direction: column;
}

.p-select-option {
    cursor: pointer;
    font-weight: normal;
    white-space: nowrap;
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    padding: ${r("select.option.padding")};
    border: 0 none;
    color: ${r("select.option.color")};
    background: transparent;
    transition: background ${r("select.transition.duration")}, color ${r("select.transition.duration")}, border-color ${r("select.transition.duration")},
    box-shadow ${r("select.transition.duration")}, outline-color ${r("select.transition.duration")};
    border-radius: ${r("select.option.border.radius")};
}

.p-select-option:not(.p-select-option-selected):not(.p-disabled).p-focus {
    background: ${r("select.option.focus.background")};
    color: ${r("select.option.focus.color")};
}

.p-select-option.p-select-option-selected {
    background: ${r("select.option.selected.background")};
    color: ${r("select.option.selected.color")};
}

.p-select-option.p-select-option-selected.p-focus {
    background: ${r("select.option.selected.focus.background")};
    color: ${r("select.option.selected.focus.color")};
}

.p-select-option-check-icon {
    position: relative;
    margin-inline-start: ${r("select.checkmark.gutter.start")};
    margin-inline-end: ${r("select.checkmark.gutter.end")};
    color: ${r("select.checkmark.color")};
}

.p-select-empty-message {
    padding: ${r("select.empty.message.padding")};
}

.p-select-fluid {
    display: flex;
}

/*For PrimeNG*/

.p-dropdown.ng-invalid.ng-dirty,
.p-select.ng-invalid.ng-dirty {
    outline: 1px solid ${r("select.invalid.border.color")};
    outline-offset: 0;
}

.p-dropdown.ng-invalid.ng-dirty .p-dropdown-label.p-placeholder,
.p-select.ng-invalid.ng-dirty .p-select-label.p-placeholder {
    color: ${r("select.invalid.placeholder.color")};
}
`,$C={root:({instance:r})=>["p-dropdown p-select p-component p-inputwrapper",{"p-disabled":r.disabled,"p-variant-filled":r.variant==="filled"||r.config.inputVariant()==="filled"||r.config.inputStyle()==="filled","p-focus":r.focused,"p-inputwrapper-filled":r.modelValue()!==void 0&&r.modelValue()!==null&&!r.modelValue().length,"p-inputwrapper-focus":r.focused||r.overlayVisible,"p-select-open":r.overlayVisible,"p-select-fluid":r.hasFluid,"p-select-sm p-inputfield-sm":r.size==="small","p-select-lg p-inputfield-lg":r.size==="large"}],label:({instance:r,props:t})=>["p-select-label",{"p-placeholder":!t.editable&&r.label===t.placeholder,"p-select-label-empty":!t.editable&&!r.$slots.value&&(r.label==="p-emptylabel"||r.label.length===0)}],clearIcon:"p-select-clear-icon",dropdown:"p-select-dropdown",loadingicon:"p-select-loading-icon",dropdownIcon:"p-select-dropdown-icon",overlay:"p-select-overlay p-component",header:"p-select-header",pcFilter:"p-select-filter",listContainer:"p-select-list-container",list:"p-select-list",optionGroup:"p-select-option-group",optionGroupLabel:"p-select-option-group-label",option:({instance:r,props:t,state:e,option:i,focusedOption:n})=>["p-select-option",{"p-select-option-selected":r.isSelected(i)&&t.highlightOnSelect,"p-focus":e.focusedOptionIndex===n,"p-disabled":r.isOptionDisabled(i)}],optionLabel:"p-select-option-label",optionCheckIcon:"p-select-option-check-icon",optionBlankIcon:"p-select-option-blank-icon",emptyMessage:"p-select-empty-message"},Eh=(()=>{class r extends pr{name="select";theme=VC;classes=$C;static \u0275fac=(()=>{let e;return function(n){return(e||(e=bt(r)))(n||r)}})();static \u0275prov=yt({token:r,factory:r.\u0275fac})}return r})(),Ih;Ih||(Ih={});var HC={provide:fc,useExisting:tn(()=>zC),multi:!0},WC=(()=>{class r extends tr{id;option;selected;focused;label;disabled;visible;itemSize;ariaPosInset;ariaSetSize;template;checkmark;onClick=new ve;onMouseEnter=new ve;onOptionClick(e){this.onClick.emit(e)}onOptionMouseEnter(e){this.onMouseEnter.emit(e)}static \u0275fac=(()=>{let e;return function(n){return(e||(e=bt(r)))(n||r)}})();static \u0275cmp=Oe({type:r,selectors:[["p-dropdownItem"]],inputs:{id:"id",option:"option",selected:[2,"selected","selected",be],focused:[2,"focused","focused",be],label:"label",disabled:[2,"disabled","disabled",be],visible:[2,"visible","visible",be],itemSize:[2,"itemSize","itemSize",Ot],ariaPosInset:"ariaPosInset",ariaSetSize:"ariaSetSize",template:"template",checkmark:[2,"checkmark","checkmark",be]},outputs:{onClick:"onClick",onMouseEnter:"onMouseEnter"},standalone:!1,features:[Ht],decls:4,vars:22,consts:[["role","option","pRipple","",3,"click","mouseenter","id","ngStyle","ngClass"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"styleClass",4,"ngIf"],[3,"styleClass"]],template:function(i,n){i&1&&(P(0,"li",0),ce("click",function(a){return n.onOptionClick(a)})("mouseenter",function(a){return n.onOptionMouseEnter(a)}),z(1,wb,3,2,"ng-container",1)(2,bb,2,1,"span",1)(3,Cb,1,0,"ng-container",2),L()),i&2&&(w("id",n.id)("ngStyle",Re(14,As,n.itemSize+"px"))("ngClass",nn(16,_b,n.selected,n.disabled,n.focused)),fe("aria-label",n.label)("aria-setsize",n.ariaSetSize)("aria-posinset",n.ariaPosInset)("aria-selected",n.selected)("data-p-focused",n.focused)("data-p-highlight",n.selected)("data-p-disabled",n.disabled),S(),w("ngIf",n.checkmark),S(),w("ngIf",!n.template),S(),w("ngTemplateOutlet",n.template)("ngTemplateOutletContext",Re(20,vl,n.option)))},dependencies:()=>[Wt,Tt,Jt,St,Qr,ro,io],encapsulation:2})}return r})(),zC=(()=>{class r extends tr{zone;filterService;id;scrollHeight="200px";filter;name;style;panelStyle;styleClass;panelStyleClass;readonly;required;editable;appendTo;tabindex=0;set placeholder(e){this._placeholder.set(e)}get placeholder(){return this._placeholder.asReadonly()}loadingIcon;filterPlaceholder;filterLocale;variant;inputId;dataKey;filterBy;filterFields;autofocus;resetFilterOnHide=!1;checkmark=!1;dropdownIcon;loading=!1;optionLabel;optionValue;optionDisabled;optionGroupLabel="label";optionGroupChildren="items";autoDisplayFirst=!0;group;showClear;emptyFilterMessage="";emptyMessage="";lazy=!1;virtualScroll;virtualScrollItemSize;virtualScrollOptions;overlayOptions;ariaFilterLabel;ariaLabel;ariaLabelledBy;filterMatchMode="contains";maxlength;tooltip="";tooltipPosition="right";tooltipPositionStyle="absolute";tooltipStyleClass;focusOnHover=!1;selectOnFocus=!1;autoOptionFocus=!0;autofocusFilter=!0;fluid;get disabled(){return this._disabled}set disabled(e){e&&(this.focused=!1,this.overlayVisible&&this.hide()),this._disabled=e,this.cd.destroyed||this.cd.detectChanges()}get itemSize(){return this._itemSize}set itemSize(e){this._itemSize=e,console.log("The itemSize property is deprecated, use virtualScrollItemSize property instead.")}_itemSize;get autoZIndex(){return this._autoZIndex}set autoZIndex(e){this._autoZIndex=e,console.log("The autoZIndex property is deprecated since v14.2.0, use overlayOptions property instead.")}_autoZIndex;get baseZIndex(){return this._baseZIndex}set baseZIndex(e){this._baseZIndex=e,console.log("The baseZIndex property is deprecated since v14.2.0, use overlayOptions property instead.")}_baseZIndex;get showTransitionOptions(){return this._showTransitionOptions}set showTransitionOptions(e){this._showTransitionOptions=e,console.log("The showTransitionOptions property is deprecated since v14.2.0, use overlayOptions property instead.")}_showTransitionOptions;get hideTransitionOptions(){return this._hideTransitionOptions}set hideTransitionOptions(e){this._hideTransitionOptions=e,console.log("The hideTransitionOptions property is deprecated since v14.2.0, use overlayOptions property instead.")}_hideTransitionOptions;get filterValue(){return this._filterValue()}set filterValue(e){setTimeout(()=>{this._filterValue.set(e)})}get options(){return this._options()}set options(e){tc(e,this._options())||this._options.set(e)}onChange=new ve;onFilter=new ve;onFocus=new ve;onBlur=new ve;onClick=new ve;onShow=new ve;onHide=new ve;onClear=new ve;onLazyLoad=new ve;_componentStyle=at(Eh);containerViewChild;filterViewChild;focusInputViewChild;editableInputViewChild;itemsViewChild;scroller;overlayViewChild;firstHiddenFocusableElementOnOverlay;lastHiddenFocusableElementOnOverlay;get hostClass(){return this._componentStyle.classes.root({instance:this}).map(i=>typeof i=="string"?i:Object.keys(i).filter(n=>i[n]).join(" ")).join(" ")+" "+this.styleClass}get hostStyle(){return this.style}_disabled;itemsWrapper;itemTemplate;groupTemplate;loaderTemplate;selectedItemTemplate;headerTemplate;filterTemplate;footerTemplate;emptyFilterTemplate;emptyTemplate;dropdownIconTemplate;loadingIconTemplate;clearIconTemplate;filterIconTemplate;filterOptions;_options=wt(null);_placeholder=wt(void 0);modelValue=wt(null);value;onModelChange=()=>{};onModelTouched=()=>{};hover;focused;overlayVisible;optionsChanged;panel;selectedOptionUpdated;_filterValue=wt(null);searchValue;searchTimeout;preventModelTouched;focusedOptionIndex=wt(-1);clicked=wt(!1);get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(Xs.EMPTY_MESSAGE)}get emptyFilterMessageLabel(){return this.emptyFilterMessage||this.config.getTranslation(Xs.EMPTY_FILTER_MESSAGE)}get isVisibleClearIcon(){return this.modelValue()!=null&&this.hasSelectedOption()&&this.showClear&&!this.disabled}get listLabel(){return this.config.getTranslation(Xs.ARIA).listLabel}get hasFluid(){let i=this.el.nativeElement.closest("p-fluid");return this.fluid||!!i}get inputClass(){let e=this.label();return{"p-select-label":!0,"p-placeholder":this.placeholder()&&e===this.placeholder(),"p-select-label-empty":!this.editable&&!this.selectedItemTemplate&&(e==null||e==="p-emptylabel"||e.length===0)}}get focusedOptionId(){return this.focusedOptionIndex()!==-1?`${this.id}_${this.focusedOptionIndex()}`:null}visibleOptions=yi(()=>{let e=this.getAllVisibleAndNonVisibleOptions();if(this._filterValue()){let n=!(this.filterBy||this.optionLabel)&&!this.filterFields&&!this.optionValue?this.options.filter(s=>s.label?s.label.toString().toLowerCase().indexOf(this._filterValue().toLowerCase().trim())!==-1:s.toString().toLowerCase().indexOf(this._filterValue().toLowerCase().trim())!==-1):this.filterService.filter(e,this.searchFields(),this._filterValue().trim(),this.filterMatchMode,this.filterLocale);if(this.group){let s=this.options||[],a=[];return s.forEach(o=>{let l=this.getOptionGroupChildren(o).filter(u=>n.includes(u));l.length>0&&a.push(Y(F({},o),{[typeof this.optionGroupChildren=="string"?this.optionGroupChildren:"items"]:[...l]}))}),this.flatOptions(a)}return n}return e});label=yi(()=>{let e=this.getAllVisibleAndNonVisibleOptions(),i=e.findIndex(n=>this.isOptionValueEqualsModelValue(n));return i!==-1?this.getOptionLabel(e[i]):this.placeholder()||"p-emptylabel"});filled=yi(()=>typeof this.modelValue()=="string"?!!this.modelValue():this.label()!=="p-emptylabel"&&this.modelValue()!==void 0&&this.modelValue()!==null);selectedOption;editableInputValue=yi(()=>this.getOptionLabel(this.selectedOption)||this.modelValue()||"");constructor(e,i){super(),this.zone=e,this.filterService=i,Qn(()=>{let n=this.modelValue(),s=this.visibleOptions();if(s&&Wr(s)){let a=this.findSelectedOptionIndex();(a!==-1||n===void 0||typeof n=="string"&&n.length===0||this.isModelValueNotSet()||this.editable)&&(this.selectedOption=s[a])}fn(s)&&(n===void 0||this.isModelValueNotSet())&&Wr(this.selectedOption)&&(this.selectedOption=null),n!==void 0&&this.editable&&this.updateEditableLabel(),this.cd.markForCheck()})}isModelValueNotSet(){return this.modelValue()===null&&!this.isOptionValueEqualsModelValue(this.selectedOption)}getAllVisibleAndNonVisibleOptions(){return this.group?this.flatOptions(this.options):this.options||[]}ngOnInit(){super.ngOnInit(),console.log("Dropdown component is deprecated as of v18, use Select component instead."),this.id=this.id||qr("pn_id_"),this.autoUpdateModel(),this.filterBy&&(this.filterOptions={filter:e=>this.onFilterInputChange(e),reset:()=>this.resetFilter()})}ngAfterViewChecked(){if(this.optionsChanged&&this.overlayVisible&&(this.optionsChanged=!1,this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.overlayViewChild&&this.overlayViewChild.alignOverlay()},1)})),this.selectedOptionUpdated&&this.itemsWrapper){let e=or(this.overlayViewChild?.overlayViewChild?.nativeElement,"li.p-highlight");e&&ec(this.itemsWrapper,e),this.selectedOptionUpdated=!1}}templates;ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"item":this.itemTemplate=e.template;break;case"selectedItem":this.selectedItemTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"filter":this.filterTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"emptyfilter":this.emptyFilterTemplate=e.template;break;case"empty":this.emptyTemplate=e.template;break;case"group":this.groupTemplate=e.template;break;case"loader":this.loaderTemplate=e.template;break;case"dropdownicon":this.dropdownIconTemplate=e.template;break;case"loadingicon":this.loadingIconTemplate=e.template;break;case"clearicon":this.clearIconTemplate=e.template;break;case"filtericon":this.filterIconTemplate=e.template;break;default:this.itemTemplate=e.template;break}})}flatOptions(e){return(e||[]).reduce((i,n,s)=>{i.push({optionGroup:n,group:!0,index:s});let a=this.getOptionGroupChildren(n);return a&&a.forEach(o=>i.push(o)),i},[])}autoUpdateModel(){if(this.selectOnFocus&&this.autoOptionFocus&&!this.hasSelectedOption()&&(this.focusedOptionIndex.set(this.findFirstFocusedOptionIndex()),this.onOptionSelect(null,this.visibleOptions()[this.focusedOptionIndex()],!1)),this.autoDisplayFirst&&(this.modelValue()===null||this.modelValue()===void 0)&&!this.placeholder()){let e=this.findFirstOptionIndex();this.onOptionSelect(null,this.visibleOptions()[e],!1,!0)}}onOptionSelect(e,i,n=!0,s=!1){if(!this.isSelected(i)){let a=this.getOptionValue(i);this.updateModel(a,e),this.focusedOptionIndex.set(this.findSelectedOptionIndex()),s===!1&&this.onChange.emit({originalEvent:e,value:a})}n&&this.hide(!0)}onOptionMouseEnter(e,i){this.focusOnHover&&this.changeFocusedOptionIndex(e,i)}updateModel(e,i){this.value=e,this.onModelChange(e),this.modelValue.set(e),this.selectedOptionUpdated=!0}writeValue(e){this.filter&&this.resetFilter(),this.value=e,this.allowModelChange()&&this.onModelChange(e),this.modelValue.set(this.value),this.updateEditableLabel(),this.cd.markForCheck()}allowModelChange(){return this.autoDisplayFirst&&!this.placeholder()&&(this.modelValue()===void 0||this.modelValue()===null)&&!this.editable&&this.options&&this.options.length}isSelected(e){return this.isValidOption(e)&&this.isOptionValueEqualsModelValue(e)}isOptionValueEqualsModelValue(e){return rc(this.modelValue(),this.getOptionValue(e),this.equalityKey())}ngAfterViewInit(){super.ngAfterViewInit(),this.editable&&this.updateEditableLabel(),this.updatePlaceHolderForFloatingLabel()}updatePlaceHolderForFloatingLabel(){let e=this.el.nativeElement.parentElement,i=e?.classList.contains("p-float-label");if(e&&i&&!this.selectedOption){let n=e.querySelector("label");n&&this._placeholder.set(n.textContent)}}updateEditableLabel(){this.editableInputViewChild&&(this.editableInputViewChild.nativeElement.value=this.getOptionLabel(this.selectedOption)||this.modelValue()||"")}clearEditableLabel(){this.editableInputViewChild&&(this.editableInputViewChild.nativeElement.value="")}getOptionIndex(e,i){return this.virtualScrollerDisabled?e:i&&i.getItemOptions(e).index}getOptionLabel(e){return this.optionLabel!==void 0&&this.optionLabel!==null?dn(e,this.optionLabel):e&&e.label!==void 0?e.label:e}getOptionValue(e){return this.optionValue&&this.optionValue!==null?dn(e,this.optionValue):!this.optionLabel&&e&&e.value!==void 0?e.value:e}isOptionDisabled(e){return this.getOptionValue(this.modelValue())===this.getOptionValue(e)||this.getOptionLabel(this.modelValue()===this.getOptionLabel(e))&&e.disabled===!1?!1:this.optionDisabled?dn(e,this.optionDisabled):e&&e.disabled!==void 0?e.disabled:!1}getOptionGroupLabel(e){return this.optionGroupLabel!==void 0&&this.optionGroupLabel!==null?dn(e,this.optionGroupLabel):e&&e.label!==void 0?e.label:e}getOptionGroupChildren(e){return this.optionGroupChildren!==void 0&&this.optionGroupChildren!==null?dn(e,this.optionGroupChildren):e.items}getAriaPosInset(e){return(this.optionGroupLabel?e-this.visibleOptions().slice(0,e).filter(i=>this.isOptionGroup(i)).length:e)+1}get ariaSetSize(){return this.visibleOptions().filter(e=>!this.isOptionGroup(e)).length}resetFilter(){this._filterValue.set(null),this.filterViewChild&&this.filterViewChild.nativeElement&&(this.filterViewChild.nativeElement.value="")}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onContainerClick(e){this.disabled||this.readonly||this.loading||(this.focusInputViewChild?.nativeElement.focus({preventScroll:!0}),!(e.target.tagName==="INPUT"||e.target.getAttribute("data-pc-section")==="clearicon"||e.target.closest('[data-pc-section="clearicon"]'))&&((!this.overlayViewChild||!this.overlayViewChild.el.nativeElement.contains(e.target))&&(this.overlayVisible?this.hide(!0):this.show(!0)),this.onClick.emit(e),this.clicked.set(!0),this.cd.detectChanges()))}isEmpty(){return!this._options()||this.visibleOptions()&&this.visibleOptions().length===0}onEditableInput(e){let i=e.target.value;this.searchValue="",!this.searchOptions(e,i)&&this.focusedOptionIndex.set(-1),this.onModelChange(i),this.updateModel(i,e),setTimeout(()=>{this.onChange.emit({originalEvent:e,value:i})},1),!this.overlayVisible&&Wr(i)&&this.show()}show(e){this.overlayVisible=!0;let i=this.focusedOptionIndex()!==-1?this.focusedOptionIndex():this.autoOptionFocus?this.findFirstFocusedOptionIndex():this.editable?-1:this.findSelectedOptionIndex();this.focusedOptionIndex.set(i),e&&ut(this.focusInputViewChild?.nativeElement),this.cd.markForCheck()}onOverlayAnimationStart(e){if(e.toState==="visible"){if(this.itemsWrapper=or(this.overlayViewChild?.overlayViewChild?.nativeElement,this.virtualScroll?".p-scroller":".p-dropdown-items-wrapper"),this.virtualScroll&&this.scroller?.setContentEl(this.itemsViewChild?.nativeElement),this.options&&this.options.length)if(this.virtualScroll){let i=this.modelValue()?this.focusedOptionIndex():-1;i!==-1&&this.scroller?.scrollToIndex(i)}else{let i=or(this.itemsWrapper,".p-dropdown-item.p-highlight");i&&i.scrollIntoView({block:"nearest",inline:"nearest"})}this.filterViewChild&&this.filterViewChild.nativeElement&&(this.preventModelTouched=!0,this.autofocusFilter&&!this.editable&&this.filterViewChild.nativeElement.focus()),this.onShow.emit(e)}e.toState==="void"&&(this.itemsWrapper=null,this.onModelTouched(),this.onHide.emit(e))}hide(e){this.overlayVisible=!1,this.focusedOptionIndex.set(-1),this.clicked.set(!1),this.searchValue="",this.overlayOptions?.mode==="modal"&&Kl(),this.filter&&this.resetFilterOnHide&&this.resetFilter(),e&&(this.focusInputViewChild&&ut(this.focusInputViewChild?.nativeElement),this.editable&&this.editableInputViewChild&&ut(this.editableInputViewChild?.nativeElement)),this.cd.markForCheck()}onInputFocus(e){if(this.disabled)return;this.focused=!0;let i=this.focusedOptionIndex()!==-1?this.focusedOptionIndex():this.overlayVisible&&this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1;this.focusedOptionIndex.set(i),this.overlayVisible&&this.scrollInView(this.focusedOptionIndex()),this.onFocus.emit(e)}onInputBlur(e){this.focused=!1,this.onBlur.emit(e),this.preventModelTouched||this.onModelTouched(),this.preventModelTouched=!1}onKeyDown(e,i){if(!(this.disabled||this.readonly||this.loading)){switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e,this.editable);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(e,this.editable);break;case"Delete":this.onDeleteKey(e);break;case"Home":this.onHomeKey(e,this.editable);break;case"End":this.onEndKey(e,this.editable);break;case"PageDown":this.onPageDownKey(e);break;case"PageUp":this.onPageUpKey(e);break;case"Space":this.onSpaceKey(e,i);break;case"Enter":case"NumpadEnter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"Backspace":this.onBackspaceKey(e,this.editable);break;case"ShiftLeft":case"ShiftRight":break;default:!e.metaKey&&Us(e.key)&&(!this.overlayVisible&&this.show(),!this.editable&&this.searchOptions(e,e.key));break}this.clicked.set(!1)}}onFilterKeyDown(e){switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e,!0);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(e,!0);break;case"Home":this.onHomeKey(e,!0);break;case"End":this.onEndKey(e,!0);break;case"Enter":case"NumpadEnter":this.onEnterKey(e,!0);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e,!0);break;default:break}}onFilterBlur(e){this.focusedOptionIndex.set(-1)}onArrowDownKey(e){if(!this.overlayVisible)this.show(),this.editable&&this.changeFocusedOptionIndex(e,this.findSelectedOptionIndex());else{let i=this.focusedOptionIndex()!==-1?this.findNextOptionIndex(this.focusedOptionIndex()):this.clicked()?this.findFirstOptionIndex():this.findFirstFocusedOptionIndex();this.changeFocusedOptionIndex(e,i)}e.preventDefault(),e.stopPropagation()}changeFocusedOptionIndex(e,i){if(this.focusedOptionIndex()!==i&&(this.focusedOptionIndex.set(i),this.scrollInView(),this.selectOnFocus)){let n=this.visibleOptions()[i];this.onOptionSelect(e,n,!1)}}get virtualScrollerDisabled(){return!this.virtualScroll}scrollInView(e=-1){let i=e!==-1?`${this.id}_${e}`:this.focusedOptionId;if(this.itemsViewChild&&this.itemsViewChild.nativeElement){let n=or(this.itemsViewChild.nativeElement,`li[id="${i}"]`);n?n.scrollIntoView&&n.scrollIntoView({block:"nearest",inline:"nearest"}):this.virtualScrollerDisabled||setTimeout(()=>{this.virtualScroll&&this.scroller?.scrollToIndex(e!==-1?e:this.focusedOptionIndex())},0)}}hasSelectedOption(){return this.modelValue()!==void 0}isValidSelectedOption(e){return this.isValidOption(e)&&this.isSelected(e)}equalityKey(){return this.optionValue?null:this.dataKey}findFirstFocusedOptionIndex(){let e=this.findSelectedOptionIndex();return e<0?this.findFirstOptionIndex():e}findFirstOptionIndex(){return this.visibleOptions().findIndex(e=>this.isValidOption(e))}findSelectedOptionIndex(){return this.hasSelectedOption()?this.visibleOptions().findIndex(e=>this.isValidSelectedOption(e)):-1}findNextOptionIndex(e){let i=e<this.visibleOptions().length-1?this.visibleOptions().slice(e+1).findIndex(n=>this.isValidOption(n)):-1;return i>-1?i+e+1:e}findPrevOptionIndex(e){let i=e>0?pn(this.visibleOptions().slice(0,e),n=>this.isValidOption(n)):-1;return i>-1?i:e}findLastOptionIndex(){return pn(this.visibleOptions(),e=>this.isValidOption(e))}findLastFocusedOptionIndex(){let e=this.findSelectedOptionIndex();return e<0?this.findLastOptionIndex():e}isValidOption(e){return e!=null&&!(this.isOptionDisabled(e)||this.isOptionGroup(e))}isOptionGroup(e){return this.optionGroupLabel!==void 0&&this.optionGroupLabel!==null&&e.optionGroup!==void 0&&e.optionGroup!==null&&e.group}onArrowUpKey(e,i=!1){if(e.altKey&&!i){if(this.focusedOptionIndex()!==-1){let n=this.visibleOptions()[this.focusedOptionIndex()];this.onOptionSelect(e,n)}this.overlayVisible&&this.hide()}else{let n=this.focusedOptionIndex()!==-1?this.findPrevOptionIndex(this.focusedOptionIndex()):this.clicked()?this.findLastOptionIndex():this.findLastFocusedOptionIndex();this.changeFocusedOptionIndex(e,n),!this.overlayVisible&&this.show()}e.preventDefault(),e.stopPropagation()}onArrowLeftKey(e,i=!1){i&&this.focusedOptionIndex.set(-1)}onDeleteKey(e){this.showClear&&(this.clear(e),e.preventDefault())}onHomeKey(e,i=!1){if(i){let n=e.currentTarget;e.shiftKey?n.setSelectionRange(0,n.value.length):(n.setSelectionRange(0,0),this.focusedOptionIndex.set(-1))}else this.changeFocusedOptionIndex(e,this.findFirstOptionIndex()),!this.overlayVisible&&this.show();e.preventDefault()}onEndKey(e,i=!1){if(i){let n=e.currentTarget;if(e.shiftKey)n.setSelectionRange(0,n.value.length);else{let s=n.value.length;n.setSelectionRange(s,s),this.focusedOptionIndex.set(-1)}}else this.changeFocusedOptionIndex(e,this.findLastOptionIndex()),!this.overlayVisible&&this.show();e.preventDefault()}onPageDownKey(e){this.scrollInView(this.visibleOptions().length-1),e.preventDefault()}onPageUpKey(e){this.scrollInView(0),e.preventDefault()}onSpaceKey(e,i=!1){!this.editable&&!i&&this.onEnterKey(e)}onEnterKey(e,i=!1){if(!this.overlayVisible)this.focusedOptionIndex.set(-1),this.onArrowDownKey(e);else{if(this.focusedOptionIndex()!==-1){let n=this.visibleOptions()[this.focusedOptionIndex()];this.onOptionSelect(e,n)}!i&&this.hide()}e.preventDefault()}onEscapeKey(e){this.overlayVisible&&this.hide(!0),e.preventDefault()}onTabKey(e,i=!1){if(!i)if(this.overlayVisible&&this.hasFocusableElements())ut(e.shiftKey?this.lastHiddenFocusableElementOnOverlay.nativeElement:this.firstHiddenFocusableElementOnOverlay.nativeElement),e.preventDefault();else{if(this.focusedOptionIndex()!==-1&&this.overlayVisible){let n=this.visibleOptions()[this.focusedOptionIndex()];this.onOptionSelect(e,n)}this.overlayVisible&&this.hide(this.filter)}e.stopPropagation()}onFirstHiddenFocus(e){let i=e.relatedTarget===this.focusInputViewChild?.nativeElement?Ql(this.overlayViewChild.el?.nativeElement,":not(.p-hidden-focusable)"):this.focusInputViewChild?.nativeElement;ut(i)}onLastHiddenFocus(e){let i=e.relatedTarget===this.focusInputViewChild?.nativeElement?Zl(this.overlayViewChild?.overlayViewChild?.nativeElement,':not([data-p-hidden-focusable="true"])'):this.focusInputViewChild?.nativeElement;ut(i)}hasFocusableElements(){return ql(this.overlayViewChild.overlayViewChild.nativeElement,':not([data-p-hidden-focusable="true"])').length>0}onBackspaceKey(e,i=!1){i&&!this.overlayVisible&&this.show()}searchFields(){return this.filterBy?.split(",")||this.filterFields||[this.optionLabel]}searchOptions(e,i){this.searchValue=(this.searchValue||"")+i;let n=-1,s=!1;return n=this.visibleOptions().findIndex(a=>this.isOptionExactMatched(a)),n===-1&&(n=this.visibleOptions().findIndex(a=>this.isOptionStartsWith(a))),n!==-1&&(s=!0),n===-1&&this.focusedOptionIndex()===-1&&(n=this.findFirstFocusedOptionIndex()),n!==-1&&this.changeFocusedOptionIndex(e,n),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchValue="",this.searchTimeout=null},500),s}isOptionStartsWith(e){return this.isValidOption(e)&&this.getOptionLabel(e).toString().toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))}isOptionExactMatched(e){return this.isValidOption(e)&&this.getOptionLabel(e).toString().toLocaleLowerCase(this.filterLocale)===this.searchValue.toLocaleLowerCase(this.filterLocale)}onFilterInputChange(e){let i=e.target.value;this._filterValue.set(i),this.focusedOptionIndex.set(-1),this.onFilter.emit({originalEvent:e,filter:this._filterValue()}),!this.virtualScrollerDisabled&&this.scroller.scrollToIndex(0),setTimeout(()=>{this.overlayViewChild.alignOverlay()}),this.cd.markForCheck()}applyFocus(){this.editable?or(this.el.nativeElement,".p-dropdown-label.p-inputtext").focus():ut(this.focusInputViewChild?.nativeElement)}focus(){this.applyFocus()}clear(e){this.updateModel(null,e),this.clearEditableLabel(),this.onModelTouched(),this.onChange.emit({originalEvent:e,value:this.value}),this.onClear.emit(e),this.resetFilter()}static \u0275fac=function(i){return new(i||r)(ze(Ri),ze(ic))};static \u0275cmp=Oe({type:r,selectors:[["p-dropdown"]],contentQueries:function(i,n,s){if(i&1&&Ue(s,er,4),i&2){let a;de(a=pe())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&(Ae(Tb,5),Ae(Sb,5),Ae(Eb,5),Ae(Ib,5),Ae(kb,5),Ae(Fb,5),Ae(Ob,5),Ae(Ab,5),Ae(Db,5)),i&2){let s;de(s=pe())&&(n.containerViewChild=s.first),de(s=pe())&&(n.filterViewChild=s.first),de(s=pe())&&(n.focusInputViewChild=s.first),de(s=pe())&&(n.editableInputViewChild=s.first),de(s=pe())&&(n.itemsViewChild=s.first),de(s=pe())&&(n.scroller=s.first),de(s=pe())&&(n.overlayViewChild=s.first),de(s=pe())&&(n.firstHiddenFocusableElementOnOverlay=s.first),de(s=pe())&&(n.lastHiddenFocusableElementOnOverlay=s.first)}},hostVars:5,hostBindings:function(i,n){i&1&&ce("click",function(a){return n.onContainerClick(a)}),i&2&&(fe("id",n.id),Qt(n.hostStyle),et(n.hostClass))},inputs:{id:"id",scrollHeight:"scrollHeight",filter:[2,"filter","filter",be],name:"name",style:"style",panelStyle:"panelStyle",styleClass:"styleClass",panelStyleClass:"panelStyleClass",readonly:[2,"readonly","readonly",be],required:[2,"required","required",be],editable:[2,"editable","editable",be],appendTo:"appendTo",tabindex:[2,"tabindex","tabindex",Ot],placeholder:"placeholder",loadingIcon:"loadingIcon",filterPlaceholder:"filterPlaceholder",filterLocale:"filterLocale",variant:"variant",inputId:"inputId",dataKey:"dataKey",filterBy:"filterBy",filterFields:"filterFields",autofocus:[2,"autofocus","autofocus",be],resetFilterOnHide:[2,"resetFilterOnHide","resetFilterOnHide",be],checkmark:[2,"checkmark","checkmark",be],dropdownIcon:"dropdownIcon",loading:[2,"loading","loading",be],optionLabel:"optionLabel",optionValue:"optionValue",optionDisabled:"optionDisabled",optionGroupLabel:"optionGroupLabel",optionGroupChildren:"optionGroupChildren",autoDisplayFirst:[2,"autoDisplayFirst","autoDisplayFirst",be],group:[2,"group","group",be],showClear:[2,"showClear","showClear",be],emptyFilterMessage:"emptyFilterMessage",emptyMessage:"emptyMessage",lazy:[2,"lazy","lazy",be],virtualScroll:[2,"virtualScroll","virtualScroll",be],virtualScrollItemSize:[2,"virtualScrollItemSize","virtualScrollItemSize",Ot],virtualScrollOptions:"virtualScrollOptions",overlayOptions:"overlayOptions",ariaFilterLabel:"ariaFilterLabel",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",filterMatchMode:"filterMatchMode",maxlength:[2,"maxlength","maxlength",Ot],tooltip:"tooltip",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",tooltipStyleClass:"tooltipStyleClass",focusOnHover:[2,"focusOnHover","focusOnHover",be],selectOnFocus:[2,"selectOnFocus","selectOnFocus",be],autoOptionFocus:[2,"autoOptionFocus","autoOptionFocus",be],autofocusFilter:[2,"autofocusFilter","autofocusFilter",be],fluid:[2,"fluid","fluid",be],disabled:"disabled",itemSize:"itemSize",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",filterValue:"filterValue",options:"options"},outputs:{onChange:"onChange",onFilter:"onFilter",onFocus:"onFocus",onBlur:"onBlur",onClick:"onClick",onShow:"onShow",onHide:"onHide",onClear:"onClear",onLazyLoad:"onLazyLoad"},standalone:!1,features:[Ft([HC,Eh]),Ht],decls:11,vars:15,consts:[["elseBlock",""],["overlay",""],["content",""],["focusInput",""],["defaultPlaceholder",""],["editableInput",""],["firstHiddenFocusableEl",""],["buildInItems",""],["lastHiddenFocusableEl",""],["builtInFilterElement",""],["filter",""],["scroller",""],["loader",""],["items",""],["emptyFilter",""],["role","combobox",3,"ngClass","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass","pAutoFocus","focus","blur","keydown",4,"ngIf"],["type","text","aria-haspopup","listbox",3,"ngClass","disabled","pAutoFocus","input","keydown","focus","blur",4,"ngIf"],[4,"ngIf"],["role","button","aria-label","dropdown trigger","aria-haspopup","listbox",1,"p-select-dropdown"],[4,"ngIf","ngIfElse"],[3,"visibleChange","onAnimationStart","onHide","visible","options","target","appendTo","autoZIndex","baseZIndex","showTransitionOptions","hideTransitionOptions"],["role","combobox",3,"focus","blur","keydown","ngClass","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass","pAutoFocus"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["type","text","aria-haspopup","listbox",3,"input","keydown","focus","blur","ngClass","disabled","pAutoFocus"],["class","p-select-clear-icon",3,"click",4,"ngIf"],[1,"p-select-clear-icon",3,"click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],["aria-hidden","true",3,"ngClass",4,"ngIf"],["aria-hidden","true",3,"class",4,"ngIf"],["aria-hidden","true",3,"ngClass"],["aria-hidden","true"],["class","p-select-dropdown-icon",4,"ngIf"],["class","p-select-dropdown-icon",3,"ngClass",4,"ngIf"],[3,"styleClass",4,"ngIf"],[1,"p-select-dropdown-icon",3,"ngClass"],[3,"styleClass"],[1,"p-select-dropdown-icon"],[3,"ngClass","ngStyle"],["role","presentation",1,"p-hidden-accessible","p-hidden-focusable",3,"focus"],["class","p-select-header",3,"click",4,"ngIf"],[1,"p-select-list-container"],[3,"items","style","itemSize","autoSize","lazy","options","onLazyLoad",4,"ngIf"],[1,"p-select-header",3,"click"],["pInputText","","type","text","role","searchbox","autocomplete","off",1,"p-select-filter",3,"input","keydown","blur","value","variant"],[3,"onLazyLoad","items","itemSize","autoSize","lazy","options"],["role","listbox",1,"p-select-list",3,"ngClass"],["ngFor","",3,"ngForOf"],["class","p-select-empty-message","role","option",3,"ngStyle",4,"ngIf"],["role","option",1,"p-select-option-group",3,"ngStyle"],[3,"onClick","onMouseEnter","id","option","checkmark","selected","label","disabled","template","focused","ariaPosInset","ariaSetSize"],["role","option",1,"p-select-empty-message",3,"ngStyle"]],template:function(i,n){if(i&1){let s=ge();z(0,$b,6,20,"span",15)(1,Hb,2,8,"input",16)(2,Xb,3,2,"ng-container",17),P(3,"div",18),z(4,Zb,3,2,"ng-container",19)(5,sC,2,2,"ng-template",null,0,ct),L(),P(7,"p-overlay",20,1),Bs("visibleChange",function(o){return X(s),Ns(n.overlayVisible,o)||(n.overlayVisible=o),j(o)}),ce("onAnimationStart",function(o){return X(s),j(n.onOverlayAnimationStart(o))})("onHide",function(){return X(s),j(n.hide())}),z(9,BC,13,17,"ng-template",null,2,ct),L()}if(i&2){let s=mt(6);w("ngIf",!n.editable),S(),w("ngIf",n.editable),S(),w("ngIf",n.isVisibleClearIcon),S(),fe("aria-expanded",n.overlayVisible??!1)("data-pc-section","trigger"),S(),w("ngIf",n.loading)("ngIfElse",s),S(3),Rs("visible",n.overlayVisible),w("options",n.overlayOptions)("target","@parent")("appendTo",n.appendTo)("autoZIndex",n.autoZIndex)("baseZIndex",n.baseZIndex)("showTransitionOptions",n.showTransitionOptions)("hideTransitionOptions",n.hideTransitionOptions)}},dependencies:()=>[Wt,Yr,Tt,Jt,St,_c,Zr,lo,Ys,is,rs,no,xc,so,ao,WC],encapsulation:2,changeDetection:0})}return r})(),Oh=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=$t({type:r});static \u0275inj=Vt({imports:[Le,oo,tt,Mr,lo,uc,is,rs,no,ro,io,Zs,so,ao,oo,tt]})}return r})();var UC=()=>({display:"none"});function GC(r,t){r&1&&he(0,"i",18)}function XC(r,t){r&1&&he(0,"i",19)}function jC(r,t){r&1&&he(0,"div",14)}function KC(r,t){if(r&1){let e=ge();P(0,"div",11),ce("click",function(){X(e);let n=y(2);return j(n.testCustomClick("subtle"))}),he(1,"i",20),Se(2," Subtle (40%) "),L()}}function YC(r,t){if(r&1){let e=ge();P(0,"div",11),ce("click",function(){X(e);let n=y(2);return j(n.testCustomClick("medium"))}),he(1,"i",20),Se(2," Medium (25%) "),L()}}function qC(r,t){if(r&1){let e=ge();P(0,"div",11),ce("click",function(){X(e);let n=y(2);return j(n.testCustomClick("strong"))}),he(1,"i",20),Se(2," Strong (10%) "),L()}}function QC(r,t){if(r&1){let e=ge();P(0,"div",10)(1,"div",11),ce("click",function(){X(e);let n=y();return j(n.testCustomClick("excel"))}),z(2,GC,1,0,"i",12)(3,XC,1,0,"i",13),Se(4),L(),he(5,"div",14),P(6,"div",11),ce("click",function(){X(e);let n=y();return j(n.testCustomClick("toggle"))}),he(7,"i",15),Se(8),L(),z(9,jC,1,0,"div",16)(10,KC,3,0,"div",17)(11,YC,3,0,"div",17)(12,qC,3,0,"div",17),L()}if(r&2){let e=y();S(),Qa("loading",e.isExportingExcel),S(),w("ngIf",!e.isExportingExcel),S(),w("ngIf",e.isExportingExcel),S(),yr(" ",e.isExportingExcel?"Exporting Excel...":"Export to Excel"," "),S(3),Qa("pi-eye-slash",e.isHighlightingEnabled)("pi-eye",!e.isHighlightingEnabled),S(),yr(" ",e.isHighlightingEnabled?"Disable":"Enable"," Highlighting "),S(),w("ngIf",e.isHighlightingEnabled),S(),w("ngIf",e.isHighlightingEnabled),S(),w("ngIf",e.isHighlightingEnabled),S(),w("ngIf",e.isHighlightingEnabled)}}var kO=(()=>{let t=class t{constructor(){this.title="Dashboard",this.isHighlightingEnabled=!0,this.isExportingExcel=!1,this.onExportToExcel=new ve,this.onToggleHighlighting=new ve,this.onSetHighlightingPreset=new ve,this.menuItems=[],this.showCustomMenu=!1,this.boundExportToExcel=()=>{console.log("Dashboard header: Export to Excel clicked (bound method)"),this.exportToExcel()},this.boundToggleHighlighting=()=>{console.log("Dashboard header: Toggle highlighting clicked (bound method)"),this.toggleHighlighting()},this.boundSetSubtle=()=>{console.log("Dashboard header: Set subtle preset (bound method)"),this.setHighlightingPreset("subtle")},this.boundSetMedium=()=>{console.log("Dashboard header: Set medium preset (bound method)"),this.setHighlightingPreset("medium")},this.boundSetStrong=()=>{console.log("Dashboard header: Set strong preset (bound method)"),this.setHighlightingPreset("strong")}}ngOnChanges(i){(i.isHighlightingEnabled||i.isExportingExcel)&&this.updateMenuItems()}ngOnInit(){this.updateMenuItems()}updateMenuItems(){let i=[];i.push({label:"\u{1F9EA} Simple Test",command:()=>{console.log("SIMPLE TEST CLICKED!"),alert("Simple test works!")}}),i.push({separator:!0}),i.push({label:"Export to Excel",command:()=>{console.log("EXCEL EXPORT CLICKED!"),this.exportToExcel()}}),i.push({separator:!0}),i.push({label:this.isHighlightingEnabled?"Disable Highlighting":"Enable Highlighting",command:()=>{console.log("HIGHLIGHTING TOGGLE CLICKED!"),this.toggleHighlighting()}}),this.isHighlightingEnabled&&(i.push({separator:!0}),i.push({label:"Highlighting Intensity",items:[{label:"Subtle (40%)",command:this.boundSetSubtle},{label:"Medium (25%)",command:this.boundSetMedium},{label:"Strong (10%)",command:this.boundSetStrong}]})),console.log("Menu items updated - highlighting enabled:",this.isHighlightingEnabled),console.log("Menu structure:",i),this.menuItems=i}exportToExcel(){console.log("Dashboard header: Export to Excel clicked"),this.onExportToExcel.emit()}toggleHighlighting(){console.log("Dashboard header: Toggle highlighting clicked"),this.onToggleHighlighting.emit(),setTimeout(()=>{this.updateMenuItems()},100)}setHighlightingPreset(i){console.log("Dashboard header: setHighlightingPreset called with preset:",i),this.onSetHighlightingPreset.emit(i)}onMenuButtonClick(i,n){console.log("Menu button clicked"),n.toggle(i)}onMenuShow(){console.log("Menu shown")}onMenuHide(){console.log("Menu hidden")}testMainAction(){console.log("SPLIT BUTTON MAIN ACTION CLICKED!"),alert("Split button main action works!")}toggleCustomMenu(){console.log("Custom menu toggle clicked"),this.showCustomMenu=!this.showCustomMenu}testCustomClick(i){switch(console.log("CUSTOM MENU ITEM CLICKED:",i),this.showCustomMenu=!1,i){case"test":alert("Custom test menu item works!");break;case"excel":this.exportToExcel();break;case"toggle":this.toggleHighlighting();break;case"subtle":this.setHighlightingPreset("subtle");break;case"medium":this.setHighlightingPreset("medium");break;case"strong":this.setHighlightingPreset("strong");break}}onDocumentClick(i){if(this.showCustomMenu){let n=i.target;n&&!n.closest(".custom-menu-container")&&(this.showCustomMenu=!1)}}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Oe({type:t,selectors:[["vis-dashboard-header"]],hostBindings:function(n,s){n&1&&ce("click",function(o){return s.onDocumentClick(o)},Bl)},inputs:{title:"title",isHighlightingEnabled:"isHighlightingEnabled",isExportingExcel:"isExportingExcel"},outputs:{onExportToExcel:"onExportToExcel",onToggleHighlighting:"onToggleHighlighting",onSetHighlightingPreset:"onSetHighlightingPreset"},features:[ai],decls:11,vars:7,consts:[["menu",""],[1,"dashboard-header"],[1,"dashboard-header-left"],[1,"dashboard-title"],[1,"dashboard-header-right"],[1,"custom-menu-container"],[1,"custom-menu-button",3,"click"],[1,"pi","pi-ellipsis-v"],["class","custom-menu",4,"ngIf"],["appendTo","body",3,"onShow","onHide","model","popup"],[1,"custom-menu"],[1,"custom-menu-item",3,"click"],["class","pi pi-file-excel",4,"ngIf"],["class","pi pi-spin pi-spinner",4,"ngIf"],[1,"custom-menu-separator"],[1,"pi"],["class","custom-menu-separator",4,"ngIf"],["class","custom-menu-item",3,"click",4,"ngIf"],[1,"pi","pi-file-excel"],[1,"pi","pi-spin","pi-spinner"],[1,"pi","pi-circle"]],template:function(n,s){if(n&1){let a=ge();P(0,"div",1)(1,"div",2)(2,"h2",3),Se(3),L()(),P(4,"div",4)(5,"div",5)(6,"button",6),ce("click",function(){return X(a),j(s.toggleCustomMenu())}),he(7,"i",7),L(),z(8,QC,13,14,"div",8),L()()(),P(9,"p-menu",9,0),ce("onShow",function(){return X(a),j(s.onMenuShow())})("onHide",function(){return X(a),j(s.onMenuHide())}),L()}n&2&&(S(3),He(s.title),S(5),w("ngIf",s.showCustomMenu),S(),Qt(Zt(6,UC)),w("model",s.menuItems)("popup",!0))},dependencies:[Le,Tt,Jr,ca,bn,Sh,Oh],styles:[".dashboard-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:2px 16px;margin:4px 0;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border:1px solid #dee2e6;border-radius:8px;box-shadow:0 2px 4px #0000000d;transition:all .3s ease;position:relative;z-index:10}.dashboard-header[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #0000001a;transform:translateY(-1px)}.dashboard-header-left[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center}.dashboard-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#495057;margin:0;padding:0}.dashboard-header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;position:relative}[_nghost-%COMP%]     .p-button.p-button-sm{transition:all .2s ease;font-size:13px;position:relative;z-index:11}[_nghost-%COMP%]     .p-button.p-button-sm:hover{transform:translateY(-1px);box-shadow:0 3px 6px #0000001a}[_nghost-%COMP%]     .p-button.p-button-outlined{background:#ffffffe6}[_nghost-%COMP%]     .p-button.p-button-outlined:hover{background:#fff}[_nghost-%COMP%]     .p-menu{z-index:99999!important;box-shadow:0 8px 16px #0003!important;border:1px solid #ccc!important;background:#fff!important}[_nghost-%COMP%]     .p-menu .p-menuitem{pointer-events:auto!important;cursor:pointer!important;position:relative!important;background:transparent!important}[_nghost-%COMP%]     .p-menu .p-menuitem-link{pointer-events:auto!important;cursor:pointer!important;display:block!important;padding:12px 16px!important;color:#333!important;text-decoration:none!important;width:100%!important;background:transparent!important;border:none!important;outline:none!important}[_nghost-%COMP%]     .p-menu .p-menuitem:hover{background-color:#f0f0f0!important}[_nghost-%COMP%]     .p-menu .p-menuitem-link:hover{background-color:#f0f0f0!important;color:#000!important}[_nghost-%COMP%]     .p-menu .p-menuitem-icon{pointer-events:none!important;margin-right:8px!important}[_nghost-%COMP%]     .p-menu .p-menuitem-text{pointer-events:none!important}[_nghost-%COMP%]     .p-menu .p-separator{pointer-events:none!important;background:#eee!important;height:1px!important;margin:4px 0!important}[_nghost-%COMP%]     .p-menu .p-submenu-list{z-index:100000!important;box-shadow:0 4px 12px #00000026!important;background:#fff!important;border:1px solid #ccc!important}@media (max-width: 768px){.dashboard-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.dashboard-header-left[_ngcontent-%COMP%]{text-align:center}.dashboard-title[_ngcontent-%COMP%]{font-size:1.1rem}.dashboard-header-right[_ngcontent-%COMP%]{justify-content:center}}.custom-menu-container[_ngcontent-%COMP%]{position:relative;display:inline-block}.custom-menu-button[_ngcontent-%COMP%]{background:#ffffffe6;border:1px solid #ccc;border-radius:4px;padding:8px 12px;cursor:pointer;font-size:14px;transition:all .2s ease}.custom-menu-button[_ngcontent-%COMP%]:hover{background:#fff;transform:translateY(-1px);box-shadow:0 3px 6px #0000001a}.custom-menu[_ngcontent-%COMP%]{position:absolute;right:0;top:100%;margin-top:4px;background:#fff;border:1px solid #ccc;border-radius:4px;box-shadow:0 8px 16px #0003;z-index:99999;min-width:200px;overflow:hidden}.custom-menu-item[_ngcontent-%COMP%]{padding:12px 16px;cursor:pointer;color:#333;background:#fff;border:none;width:100%;text-align:left;font-size:14px;transition:background-color .2s ease;display:flex;align-items:center;gap:8px}.custom-menu-item[_ngcontent-%COMP%]:hover{background-color:#f0f0f0;color:#000}.custom-menu-item.loading[_ngcontent-%COMP%]{opacity:.7;cursor:wait}.custom-menu-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:16px;font-size:14px}.custom-menu-item[_ngcontent-%COMP%]   i.pi-spin[_ngcontent-%COMP%]{animation:spin 1s linear infinite}.custom-menu-separator[_ngcontent-%COMP%]{height:1px;background:#eee;margin:4px 0}"]});let r=t;return r})();var ZC=["dashboardContainer"],JC=(()=>{let t=class t{constructor(i,n,s){this.cdr=i,this.excelExportService=n,this.filterService=s,this.isExportingExcel=!1,this.isUpdatingFilters=!1,this.isHighlightingEnabled=!0,this.highlightingOpacity=.25}ngOnInit(){this.initializeDashboardConfig(),this.filterSubscription=this.filterService.filterValues$.subscribe(i=>{this.updateWidgetsWithFilters(i)}),this.onChildInit()}onFilterValuesChanged(i){this.isUpdatingFilters||(this.isUpdatingFilters=!0,this.filterService.setFilterValues(i),this.isUpdatingFilters=!1)}updateWidgetsWithFilters(i){if(this.isUpdatingFilters)return;let n=i||this.filterService.getFilterValues();this.applyFiltersToDashboardData(n),this.dashboardConfig.widgets.filter(a=>a.config?.component==="echart").forEach(a=>{this.updateWidgetWithFilters(a,n)}),this.updateMetricTilesWithFilters(n),setTimeout(()=>{this.cdr.detectChanges(),setTimeout(()=>{this.cdr.detectChanges()},100)},50)}updateMetricTilesWithFilters(i){let n=this.dashboardConfig.widgets.filter(a=>a.config?.component==="tile"),s=this.createMetricTiles(this.dashboardData);n.forEach((a,o)=>{if(o<s.length){let c=s[o];a.config?.options?.updateOnDataChange!==!1&&a.config?.options&&Object.assign(a.config.options,c.config?.options)}})}applyFiltersToDashboardData(i){if(i.length===0){this.dashboardData=[...this.initialDashboardData];return}this.dashboardConfig?.filterVisualization?.enableHighlighting?this.dashboardData=[...this.initialDashboardData]:this.dashboardData=this.applyFiltersToFlatData(this.initialDashboardData,i)}applyFiltersToFlatData(i,n){return!n||n.length===0?i:i.filter(s=>n.every(a=>this.matchesFlatDataFilter(s,a)))}matchesFlatDataFilter(i,n){let s=i,a=n.value||n[n.accessor];if(n.accessor&&s.hasOwnProperty(n.accessor))return s[n.accessor]===a;let o=["category","month","type","name"];for(let c of o)if(s.hasOwnProperty(c)&&s[c]===a)return!0;return Object.values(s).includes(a)}getFilteredDataForWidgetFromOriginalData(i,n){let s=this.applyFiltersToFlatData(this.initialDashboardData,n);return this.getFilteredDataForWidget(i,s)}groupByAndSum(i,n,s){let a=i.reduce((o,c)=>{let l=c,u=l[n];o[u]||(o[u]=0);let h=Number(l[s])||0;return o[u]+=h,o},{});return Object.entries(a).map(([o,c])=>({name:o,value:c}))}groupByAndCount(i,n){let s=i.reduce((a,o)=>{let l=o[n];return a[l]||(a[l]=0),a[l]++,a},{});return Object.entries(s).map(([a,o])=>({name:a,value:o}))}groupByAndAverage(i,n,s){let a=i.reduce((o,c)=>{let l=c,u=l[n];o[u]||(o[u]={sum:0,count:0});let h=Number(l[s])||0;return o[u].sum+=h,o[u].count++,o},{});return Object.entries(a).map(([o,{sum:c,count:l}])=>({name:o,value:l>0?c/l:0}))}filterByFieldValues(i,n,s){return i.filter(a=>{let o=a;return s.includes(o[n])})}getUniqueFieldValues(i,n){let s=i.map(a=>a[n]);return[...new Set(s)]}sortByField(i,n,s=!0){return[...i].sort((a,o)=>{let c=a[n],l=o[n];return c<l?s?-1:1:c>l?s?1:-1:0})}aggregateByFields(i,n,s){let a=i.reduce((o,c)=>{let l=c,u=n.map(h=>l[h]).join("|");return o[u]||(o[u]={groupKey:u,groupValues:n.reduce((h,f)=>(h[f]=l[f],h),{}),aggregations:s.reduce((h,f)=>(h[f.field]={operation:f.operation,values:[]},h),{})}),s.forEach(h=>{let f=Number(l[h.field])||0;o[u].aggregations[h.field].values.push(f)}),o},{});return Object.values(a).map(o=>{let c=F({},o.groupValues);return Object.entries(o.aggregations).forEach(([l,u])=>{let h=u.values;switch(u.operation){case"sum":c[`${l}_sum`]=h.reduce((f,d)=>f+d,0);break;case"count":c[`${l}_count`]=h.length;break;case"avg":c[`${l}_avg`]=h.length>0?h.reduce((f,d)=>f+d,0)/h.length:0;break;case"min":c[`${l}_min`]=Math.min(...h);break;case"max":c[`${l}_max`]=Math.max(...h);break}}),c})}createHeatmapData(i,n="x",s="y",a="value"){return[]}createMultiSeriesData(i,n="category",s="x",a="y"){return[]}updateWidgetWithFilters(i,n){if(!i.config||!i.config.component)return;let s=i.config?.header?.title,a=n.some(u=>{let h=u.widgetId===i.id,f=u.widgetTitle===s;return h||f}),o=this.dashboardConfig?.filterVisualization?.enableHighlighting,c=null;if(s&&(o&&!a&&n.length>0?c=this.getFilteredDataForWidgetFromOriginalData(s,n):c=this.getFilteredDataForWidget(s)),c||(c=this.getDataByChartType(i)),!c)return;let l=c;if(o&&n.length>0&&a){let u=i.config?.options,h="other";u?.series?.[0]?.type&&(h=u.series[0].type);let f={filteredOpacity:this.dashboardConfig.filterVisualization?.defaultFilteredOpacity||.25,highlightedOpacity:this.dashboardConfig.filterVisualization?.defaultHighlightedOpacity||1,highlightColor:this.dashboardConfig.filterVisualization?.defaultHighlightColor||"#ff6b6b",filteredColor:this.dashboardConfig.filterVisualization?.defaultFilteredColor||"#e0e0e0"};l=this.filterService.applyHighlightingToEChartsData(c,n,h,f)}else n.length>0&&(Array.isArray(c)?(l=this.filterService.applyFiltersToData(c,n),l.length===0&&(l=[{name:"No data matches filter",value:0,itemStyle:{color:"#cccccc"}}])):l=c);i.config.component==="echart"&&this.updateEchartWidget(i,l)}updateEchartWidget(i,n){if(!i.config?.options)return;let s=i.config?.header?.title,a=F({},i.config.options);if(a.series&&a.series.length>0){let o=a.series[0];n&&n.length>0&&(o.data=n,a.xAxis&&a.xAxis[0]&&a.xAxis[0].data&&(a.xAxis[0].data=n.map(c=>c.name)))}i.config.options=a,this.scheduleWidgetUpdate(i)}scheduleWidgetUpdate(i){this.widgetUpdateTimeout&&clearTimeout(this.widgetUpdateTimeout),this.widgetUpdateTimeout=setTimeout(()=>{this.retryWidgetUpdate(i,0)},50)}retryWidgetUpdate(i,n){let o=i.config?.header?.title||i.id;if(!(n>=5))try{this.cdr.detectChanges(),setTimeout(()=>{this.cdr.detectChanges()},50)}catch{let l=100*Math.pow(2,n);setTimeout(()=>{this.retryWidgetUpdate(i,n+1)},l)}}getScatterChartData(i){return[]}getGaugeChartData(i){return[{name:"Progress",value:50}]}exportDashboardToExcel(){return Bt(this,null,function*(){this.isExportingExcel=!0,this.cdr.detectChanges();try{yield new Promise(i=>setTimeout(i,50)),yield new Promise((i,n)=>{setTimeout(()=>Bt(this,null,function*(){try{yield this.excelExportService.exportDashboardToExcel(this.dashboardConfig.widgets,{filename:`financial-dashboard-data-${new Date().toISOString().split("T")[0]}.xlsx`,includeHeaders:!0,includeTimestamp:!0,sheetNamePrefix:"Widget",autoColumnWidth:!0,includeWidgetTitles:!0}),i()}catch(s){console.error("Excel export failed:",s),n(s)}}),100)})}catch(i){console.error("Excel export error:",i)}finally{this.isExportingExcel=!1,this.cdr.detectChanges()}})}updateAllCharts(){return Bt(this,null,function*(){try{let i=yield this.getUpdatedChartData();this.dashboardConfig.widgets.forEach((n,s)=>{if(n.config?.component==="echart"&&i[s]&&n.config?.options){let a=n.config.options;a.series&&a.series.forEach((o,c)=>{i[s][c]&&(o.data=i[s][c])})}})}catch{}})}getUpdatedChartData(){return Bt(this,null,function*(){return yield new Promise(i=>setTimeout(i,1e3)),[{name:"Updated Data 1",value:Math.random()*100},{name:"Updated Data 2",value:Math.random()*100},{name:"Updated Data 3",value:Math.random()*100}]})}clearAllFilters(){this.isUpdatingFilters=!0;try{this.filterService.clearAllFilters()}finally{this.isUpdatingFilters=!1}}getCurrentFilters(){return this.filterService.getFilterValues()}toggleHighlightingMode(){this.isHighlightingEnabled=!this.isHighlightingEnabled,this.updateDashboardHighlightingConfig();let i=this.getCurrentFilters();this.updateWidgetsWithFilters(i),this.cdr.detectChanges()}updateHighlightingOpacity(i){this.highlightingOpacity=Math.max(.1,Math.min(1,i)),this.updateDashboardHighlightingConfig();let n=this.getCurrentFilters();this.updateWidgetsWithFilters(n),this.cdr.detectChanges()}updateDashboardHighlightingConfig(){this.dashboardConfig?.filterVisualization&&(this.dashboardConfig.filterVisualization.enableHighlighting=this.isHighlightingEnabled,this.dashboardConfig.filterVisualization.defaultFilteredOpacity=this.highlightingOpacity)}getHighlightingStatusMessage(){return this.isHighlightingEnabled?`Highlighting Mode: ON - Source widgets highlighted (${Math.round(this.highlightingOpacity*100)}% opacity), others filtered`:"Highlighting Mode: OFF - All widgets use traditional filtering"}setHighlightingPreset(i){let n;switch(i){case"subtle":n=.4;break;case"medium":n=.25;break;case"strong":n=.1;break}this.updateHighlightingOpacity(n)}populateWidgetsWithInitialData(){if(!this.dashboardConfig?.widgets)return;this.dashboardConfig.widgets.filter(n=>n.config?.component==="echart").forEach(n=>{let s=n.config?.header?.title,a=null;s&&(a=this.getFilteredDataForWidget(s)),a||(a=this.getDataByChartType(n)),a&&this.updateEchartWidget(n,a)}),this.updateMetricTilesWithFilters([]),setTimeout(()=>{this.cdr.detectChanges()},100)}ngOnDestroy(){this.widgetUpdateTimeout&&clearTimeout(this.widgetUpdateTimeout),this.filterSubscription&&this.filterSubscription.unsubscribe(),this.onChildDestroy()}};t.\u0275fac=function(n){return new(n||t)(ze(on),ze(Ha),ze(Ah))},t.\u0275dir=qn({type:t,viewQuery:function(n,s){if(n&1&&(Ae(ZC,5),Ae(xl,5)),n&2){let a;de(a=pe())&&(s.dashboardContainer=a.first),de(a=pe())&&(s.dashboardContainerComponent=a.first)}}});let r=t;return r})();var Ah=(()=>{let t=class t{constructor(){this.filterValuesSubject=new Ka([]),this.filterEventsSubject=new Ka([]),this.isUpdating=!1,this.filterValues$=this.filterValuesSubject.asObservable(),this.filterEvents$=this.filterEventsSubject.asObservable()}getFilterValues(){return this.filterValuesSubject.value}getFilterEvents(){return this.filterEventsSubject.value}addFilterValue(i,n,s){if(this.isUpdating)return;let a=this.createFilterValueFromClickData(s);if(a){a.widgetId=i,a.widgetTitle=n;let o=this.filterValuesSubject.value;if(o.some(d=>this.isSameFilter(d,a)))return;let l=[...o,a];this.debouncedUpdate(l);let u={widgetId:i,widgetTitle:n,filterValue:a,timestamp:new Date},f=[...this.filterEventsSubject.value,u];this.filterEventsSubject.next(f)}}removeFilterValue(i){if(this.isUpdating)return;let s=this.filterValuesSubject.value.filter(a=>!this.isSameFilter(a,i));this.debouncedUpdate(s)}clearAllFilters(){if(!this.isUpdating){this.isUpdating=!0;try{this.filterValuesSubject.next([]),this.filterEventsSubject.next([])}finally{this.isUpdating=!1}}}setFilterValues(i){this.isUpdating||this.debouncedUpdate(i)}debouncedUpdate(i){this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>{this.isUpdating=!0;try{this.filterValuesSubject.next(i)}finally{this.isUpdating=!1}},50)}getFiltersForWidget(i){return this.filterValuesSubject.value.filter(n=>n.widgetId===i)}getFiltersByAccessor(i){return this.filterValuesSubject.value.filter(n=>n.accessor===i||n.filterColumn===i)}hasActiveFilters(i){return this.getFiltersForWidget(i).length>0}createFilterValueFromClickData(i){if(!i||typeof i!="object")return null;let n={accessor:"unknown"};if(i.name)n={accessor:"category",category:i.name,value:i.value||i.name};else if(i.seriesName)n={accessor:"series",series:i.seriesName,value:i.value||i.seriesName};else if(i.value&&Array.isArray(i.value))n={accessor:"coordinates",x:i.value[0]?.toString(),y:i.value[1]?.toString(),value:`(${i.value[0]}, ${i.value[1]})`};else{let s=Object.keys(i);if(s.length>0){let a=s[0];n={accessor:a,[a]:i[a],value:i[a]?.toString()}}}return n.accessor!=="unknown"?n:null}isSameFilter(i,n){return JSON.stringify(i)===JSON.stringify(n)}applyFiltersToData(i,n){if(!Array.isArray(i))return console.warn("FilterService.applyFiltersToData: data is not an array, returning as-is",i),i;if(!n||n.length===0)return i;let s=n.filter(o=>{if(o.accessor==="category")return i.some(l=>l.name===o.category||l.category===o.category);let c=o.filterColumn||o.accessor;return i.some(l=>l.hasOwnProperty(c))});return s.length===0?i:i.filter(o=>s.every(c=>this.matchesFilter(o,c)))}matchesFilter(i,n){let s=n.filterColumn||n.accessor,a=!1;switch(n.accessor){case"category":a=i.name===n.category||i.category===n.category;break;case"series":a=i.seriesName===n.series||i.series===n.series;break;case"coordinates":a=i.value&&Array.isArray(i.value)&&i.value[0]?.toString()===n.x&&i.value[1]?.toString()===n.y;break;default:let o=n.filterColumn||n.accessor;a=i[o]===n[n.accessor]||i[o]?.toString()===n.value;break}return a}applyHighlightingFiltersToData(i,n,s){if(!n||n.length===0)return i.map(c=>Y(F({},c),{_filterState:"normal"}));let o=F(F({},{filteredOpacity:.3,highlightedOpacity:1,highlightColor:void 0,filteredColor:"#cccccc"}),s);return i.map(c=>n.some(u=>this.matchesFilter(c,u))?Y(F({},c),{_filterState:"highlighted",_visualOptions:{opacity:o.highlightedOpacity,color:o.highlightColor}}):Y(F({},c),{_filterState:"filtered",_visualOptions:{opacity:o.filteredOpacity,color:o.filteredColor}}))}applyHighlightingToEChartsData(i,n,s="other",a){if(!n||n.length===0)return i;let c=F(F({},{filteredOpacity:.3,highlightedOpacity:1,highlightColor:void 0,filteredColor:"#cccccc"}),a);return s==="pie"?i.map((l,u)=>n.some(f=>this.matchesPieSliceFilter(l,f))?Y(F({},l),{itemStyle:Y(F({},l.itemStyle),{opacity:c.highlightedOpacity,borderWidth:3,borderColor:c.highlightColor||"#ff6b6b"})}):Y(F({},l),{itemStyle:Y(F({},l.itemStyle),{opacity:c.filteredOpacity,color:c.filteredColor})})):s==="bar"?i.map(l=>n.some(h=>this.matchesBarDataFilter(l,h))?Y(F({},l),{itemStyle:Y(F({},l.itemStyle),{opacity:c.highlightedOpacity,borderWidth:2,borderColor:c.highlightColor||"#ff6b6b"})}):Y(F({},l),{itemStyle:Y(F({},l.itemStyle),{opacity:c.filteredOpacity,color:c.filteredColor})})):i}matchesPieSliceFilter(i,n){if(!i||!n)return!1;if(i.name&&n.value){let s=i.name.toString().toLowerCase(),a=n.value.toString().toLowerCase();if(s===a)return!0}if(i.name&&n.category){let s=i.name.toString().toLowerCase(),a=n.category.toString().toLowerCase();if(s===a)return!0}return!1}matchesBarDataFilter(i,n){return!i||!n?!1:i.name&&n.category?i.name.toString().toLowerCase()===n.category.toString().toLowerCase():i.name&&n.value?i.name.toString().toLowerCase()===n.value.toString().toLowerCase():!1}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=yt({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();var Dh=class r{constructor(){this.widgetBuilder=new mr().setId(mn()).setComponent("tile"),this.tileOptions=this.getDefaultTileOptions(),this.styleOptions=this.getDefaultStyleOptions(),this.layoutOptions=this.getDefaultLayoutOptions(),this.customData={}}static create(){return new r}static createFromData(t){return new r().setData(t).setValue(t.value).setChange(t.change||"").setChangeType(t.changeType||"neutral").setDescription(t.description||"").setIcon(t.icon||"fas fa-chart-bar").setColor(t.color||"#6b7280").setBackgroundColor(t.backgroundColor||"").setHeader(t.title||"").setSubHeader(t.subtitle||"")}getDefaultTileOptions(){return{value:"",change:"",changeType:"neutral",icon:"fas fa-chart-bar",color:"#6b7280",description:"",updateOnDataChange:!0}}getDefaultStyleOptions(){return{color:"#6b7280",backgroundColor:"",borderColor:"",borderWidth:0,borderRadius:8,padding:"1.5rem",margin:"0",fontSize:"1rem",fontWeight:"normal",textAlign:"left",iconSize:"2rem",iconColor:"inherit",backgroundOpacity:1}}getDefaultLayoutOptions(){return{width:"100%",height:"100%",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",gap:"1rem"}}setData(t){return this.customData=F(F({},this.customData),t),this.widgetBuilder.setData(this.customData),this}setValue(t){let e=String(t);return this.tileOptions.value=e,this.customData.value=e,this}setChange(t){return this.tileOptions.change=t,this.customData.change=t,this}setChangeType(t){return this.tileOptions.changeType=t,this.customData.changeType=t,this}setDescription(t){return this.tileOptions.description=t,this.customData.description=t,this}setHeader(t,e){return this.widgetBuilder.setHeader(t,e),this.customData.title=t,this}setSubHeader(t){return this.customData.subtitle=t,this}setHeaders(t,e,i){return this.setHeader(t,i),e&&this.setSubHeader(e),this}setColor(t){return this.tileOptions.color=t,this.styleOptions.color=t,this}setBackgroundColor(t){return this.styleOptions.backgroundColor=t,this.customData.backgroundColor=t,this}setBackgroundOpacity(t){return this.styleOptions.backgroundOpacity=t,this.customData.backgroundOpacity=t,this}setUpdateOnDataChange(t){return this.tileOptions.updateOnDataChange=t,this.customData.updateOnDataChange=t,this}setIcon(t){return this.tileOptions.icon=t,this.customData.icon=t,this}setIconSize(t){return this.styleOptions.iconSize=t,this}setIconColor(t){return this.styleOptions.iconColor=t,this}setBorder(t,e=1,i=8){return this.styleOptions.borderColor=t,this.styleOptions.borderWidth=e,this.styleOptions.borderRadius=i,this}setPadding(t){return this.styleOptions.padding=t,this}setMargin(t){return this.styleOptions.margin=t,this}setFont(t,e="normal"){return this.styleOptions.fontSize=t,this.styleOptions.fontWeight=e,this}setTextAlign(t){return this.styleOptions.textAlign=t,this}setStyle(t){return this.styleOptions=F(F({},this.styleOptions),t),this}setPosition(t){return this.widgetBuilder.setPosition(t),this}setSize(t,e){return this.layoutOptions.width=t,this.layoutOptions.height=e,this}setMinSize(t,e){return this.layoutOptions.minWidth=t,this.layoutOptions.minHeight=e,this}setMaxSize(t,e){return this.layoutOptions.maxWidth=t,this.layoutOptions.maxHeight=e,this}setFlexDirection(t){return this.layoutOptions.flexDirection=t,this}setJustifyContent(t){return this.layoutOptions.justifyContent=t,this}setAlignItems(t){return this.layoutOptions.alignItems=t,this}setGap(t){return this.layoutOptions.gap=t,this}setLayout(t){return this.layoutOptions=F(F({},this.layoutOptions),t),this}setAccessor(t){return this.tileOptions.accessor=t,this}setTileOptions(t){return this.tileOptions=F(F({},this.tileOptions),t),this}setEvents(t){return t&&this.widgetBuilder.setEvents(t),this}setInitialState(t){return this.widgetBuilder.setInitialState(t),this}setState(t){return this.widgetBuilder.setState(t),this}setProperty(t,e){return this.customData[t]=e,this}setProperties(t){return this.customData=F(F({},this.customData),t),this}build(){let t=Y(F(F({},this.tileOptions),this.customData),{style:this.styleOptions,layout:this.layoutOptions});return this.widgetBuilder.setTileOptions(t),this.widgetBuilder.build()}getTileOptions(){return F({},this.tileOptions)}getStyleOptions(){return F({},this.styleOptions)}getLayoutOptions(){return F({},this.layoutOptions)}getCustomData(){return F({},this.customData)}getWidgetBuilder(){return this.widgetBuilder}static updateData(t,e){if(r.isTileWidget(t)){let i=t.config?.options;i&&(Object.assign(i,e),t.data=F(F({},t.data),e))}}static isTileWidget(t){return t.config?.component==="tile"}static createTileWidget(t){let e=new mr().setId(mn()).setComponent("tile");if(t){let i=F({change:t.change||"",changeType:t.changeType||"neutral",icon:t.icon||"fas fa-chart-bar",color:t.color||"#6b7280",description:t.description||"",title:t.title||"",subtitle:t.subtitle||"",backgroundColor:t.backgroundColor||""},t);e.setTileOptions(i)}else e.setTileOptions({value:"",change:"",changeType:"neutral",icon:"fas fa-chart-bar",color:"#6b7280",description:""});return e}static exportData(t){if(!r.isTileWidget(t))return[];let e=t.config?.options;return e?[[e.title||t.config?.header?.title||"Metric",e.value||"",e.change||"",e.changeType||"neutral",e.description||"",e.subtitle||""]]:[]}static getExportHeaders(t){return["Title","Value","Change","Change Type","Description","Subtitle"]}static getExportSheetName(t){return`Tile_${(t.config?.header?.title||"Tile").replace(/[^a-zA-Z0-9]/g,"_")}`}static createMetricTile(t,e,i,n="fas fa-chart-line",s="#10b981"){return r.create().setValue(t).setChange(e).setChangeType("positive").setDescription(i).setIcon(n).setColor(s)}static createWarningTile(t,e,i,n="fas fa-exclamation-triangle",s="#ef4444"){return r.create().setValue(t).setChange(e).setChangeType("negative").setDescription(i).setIcon(n).setColor(s)}static createNeutralTile(t,e,i="fas fa-chart-bar",n="#6b7280"){return r.create().setValue(t).setChange("0%").setChangeType("neutral").setDescription(e).setIcon(i).setColor(n)}static createFinancialTile(t,e,i,n="$",s="fas fa-dollar-sign"){let a=`${n}${t.toLocaleString()}`,o=e>0?"positive":e<0?"negative":"neutral",c=`${e>0?"+":""}${e.toFixed(1)}%`,l=e>0?"#10b981":e<0?"#ef4444":"#6b7280";return r.create().setValue(a).setChange(c).setChangeType(o).setDescription(i).setIcon(s).setColor(l)}static createPercentageTile(t,e,i="fas fa-percentage",n="#3b82f6"){let s=t>0?"positive":t<0?"negative":"neutral",a=`${t>0?"+":""}${t.toFixed(1)}%`,o=t>0?"#10b981":t<0?"#ef4444":n;return r.create().setValue(`${t.toFixed(1)}%`).setChange(a).setChangeType(s).setDescription(e).setIcon(i).setColor(o)}static createInfoTile(t,e,i,n="fas fa-info-circle",s="#3b82f6"){return r.create().setValue(e).setDescription(i).setIcon(n).setColor(s)}static createStatusTile(t,e,i=!0,n="fas fa-circle",s="#10b981"){let a=i?s:"#6b7280",o=i?n:"fas fa-circle";return r.create().setValue(e).setDescription(t).setIcon(o).setColor(a).setChangeType(i?"positive":"neutral")}};var Gn=class r extends Ee{constructor(){super(),this.xAxisData=[],this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}}}}getChartType(){return"line"}getDefaultSeriesOptions(){return{name:"Area Chart",type:"line",smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.3,origin:"auto"},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis.data=t,this}setXAxisName(t){return this.chartOptions.xAxis.name=t,this}setYAxisName(t){return this.chartOptions.yAxis.name=t,this}setSmooth(t){return this.seriesOptions.smooth=t,this}setSymbol(t,e=6){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setLineStyle(t,e,i="solid"){return this.seriesOptions.lineStyle={width:t,color:e,type:i},this}setItemStyle(t,e,i){return this.seriesOptions.itemStyle={color:t,borderColor:e,borderWidth:i},this}setAreaStyle(t,e=.3){return this.seriesOptions.areaStyle={color:t,opacity:e,origin:"auto"},this}setGradientAreaStyle(t,e,i=.3){return this.seriesOptions.areaStyle={color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:t},{offset:1,color:e}]},opacity:i,origin:"auto"},this}setShowSymbol(t){return this.seriesOptions.showSymbol=t,this}setStack(t){return this.seriesOptions.stack=t,this}setSampling(t){return this.seriesOptions.sampling=t,this}build(){return this.chartOptions.series=[this.seriesOptions],this.widgetBuilder.setEChartsOptions(this.chartOptions),this.widgetBuilder.build()}static updateData(t,e,i){if(r.isAreaChart(t)){let n=t.config?.options;n?.series&&n.series.length>0&&(n.series[0].data=e)}Ee.updateData(t,e,i)}static transformToAreaData(t,e){if(!t||t.length===0)return{data:[]};let i=e?.valueField||"value",n=e?.nameField||"name",s=e?.xAxisField||n;if(e?.multiSeries){let o=e.seriesNameField||"series",c=new Map;t.forEach(u=>{let h=u[o]||"Series 1";c.has(h)||c.set(h,[]),c.get(h).push({name:String(u[n])||"Unknown",value:Number(u[i])||0})});let l=Array.from(c.values())[0]||[];return{data:l,xAxisData:l.map(u=>u.name)}}return{data:t.map(o=>({name:String(o[n])||"Unknown",value:Number(o[i])||0})),xAxisData:t.map(o=>String(o[s])||"Unknown")}}setFinancialTrend(t="USD",e="en-US"){return this.setCurrencyFormatter(t,e),this.setSmooth(!0).setSymbol("circle",6).setLineStyle(3,"#5470c6","solid").setGradientAreaStyle("#5470c6","#91cc75",.4)}setPerformanceMonitoring(){return this.setSmooth(!0).setSampling("average").setShowSymbol(!1).setLineStyle(1,"#ff6b6b","solid").setGradientAreaStyle("#ff6b6b","#4ecdc4",.3)}static addRandomVariation(t,e=25){return t.map(i=>Y(F({},i),{value:Math.max(0,i.value+(Math.random()-.5)*2*(i.value*e/100))}))}static isAreaChart(t){let e=t.config?.options;return e?.series?.[0]?.type==="line"&&e?.series?.[0]?.areaStyle}static createAreaChartWidget(t,e){return new mr().setComponent("echart").setEChartsOptions({grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:e||[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}},series:[{name:"Area Chart",type:"line",data:t||[],smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.3,origin:"auto"},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}static exportData(t){if(!r.isAreaChart(t))return[];let e=t.config?.options,i=e?.series,n=e?.xAxis;if(!i||i.length===0)return[];let s=[];n&&(Array.isArray(n)?s=n[0]?.data||[]:n.data&&(s=n.data)),s.length===0&&i[0]?.data&&(s=i[0].data.map((o,c)=>`Point ${c+1}`));let a=[];return i.forEach((o,c)=>{o.data&&o.data.forEach((l,u)=>{c===0&&(a[u]=[s[u]||`Point ${u+1}`]),a[u]&&a[u].push(l||0)})}),a}static getExportHeaders(t){let i=t.config?.options?.series;return!i||i.length===0?["Category"]:["Category",...i.map(n=>n.name||"Series")]}static getExportSheetName(t){return`AreaChart_${(t.config?.header?.title||"Area Chart").replace(/[^a-zA-Z0-9]/g,"_")}`}};export{mr as a,Ee as b,gn as c,xn as d,_n as e,vn as f,yn as g,wn as h,Gn as i,$n as j,Wn as k,zn as l,Un as m,vh as n,Ha as o,vi as p,xl as q,kO as r,JC as s,Ah as t,Dh as u};
