import{a as Ds,b as Ms}from"./chunk-QAPOPI7A.js";import{a as Xl,b as jl}from"./chunk-ZJBDZQYM.js";import{e as Yl}from"./chunk-QPKQT6Y7.js";import{A as Gl,a as Ol,c as Al,f as Dl,g as Ml,l as Hl,m as Os,o as $l,p as Vl,q as As,r as Ul,w as zl}from"./chunk-W443MQAL.js";import{$ as hi,A as Ai,B as yr,Ba as ur,Ca as en,Da as fi,Ea as Bl,Ga as Wl,Ha as ui,Ia as di,N as Hn,O as El,Q as Ba,R as ks,T as Di,X as Wa,Y as Ha,_ as kl,c as ci,d as cr,ea as Is,f as hr,g as Cs,ga as Il,h as fr,ha as wr,i as La,ia as at,k as Ra,la as $r,na as Cr,oa as Fl,pa as $a,q as Na,r as Tl,sa as Pl,t as bs,ta as Ji,u as Sl,v as Ts,va as Ll,w as Ss,wa as Rl,xa as Nl,y as Es,ya as Fs,z as Wn}from"./chunk-LW7FD3SB.js";import{k as ys,l as ws,o as Zi}from"./chunk-23NDRVOG.js";import{$a as gt,$b as yl,Aa as A,Ab as Oa,Ac as Fr,Bb as It,Bc as bl,C as hl,Cb as ve,Db as Ie,Ea as Ei,Eb as je,Fa as Ke,Fb as Wr,Hc as Ne,Ib as xl,Jb as vl,Kb as _l,La as Me,Lb as Ut,Lc as Qr,M as xs,Ma as sr,Mb as Hr,N as Rn,Na as Nn,Nb as ut,Oa as ar,Ob as qr,P as fl,Q as ul,Qa as ce,R as vs,S as Vt,Sa as Ce,T as nr,Ta as Bn,V as dl,Vb as Aa,Wb as Da,X as ht,Zb as or,_a as ke,a as ol,aa as te,ab as xt,ba as re,bb as Fa,bc as Ki,c as Ln,ca as Rr,cb as ml,cc as Ma,db as ki,eb as Ii,ec as Pa,f as Yi,fa as Ia,fb as M,fc as Qt,g as ka,gb as U,h as gs,hb as G,i as ll,ia as Nr,ib as xe,ic as qi,jb as vt,kb as _t,kc as Le,la as Si,lb as ft,lc as lr,ma as qt,mb as Te,nb as gl,oa as Yr,ob as me,pb as I,qb as Fi,rb as Kr,sb as $e,tb as et,ub as Se,vb as Ee,vc as wl,w as cl,wa as li,wc as Cl,xa as _s,xc as Qi,yb as _r,yc as Zt,za as pl,zb as Br,zc as Oi}from"./chunk-2IYA7GNV.js";import{wa as Kl}from"./chunk-ZOFRZBD6.js";import{a as k,b as j,e as kt}from"./chunk-JKOY2XUY.js";var Jt=class{constructor(){this.widget={id:"",x:0,y:0,cols:1,rows:1,position:{x:0,y:0,cols:1,rows:1},config:{options:{}}}}setId(t){return this.widget.id=t,this}setPosition(t){return this.widget.position=t,this}setComponent(t){return this.widget.config.component=t,this}setInitialState(t){return this.widget.config.initialState=t,this}setState(t){return this.widget.config.state=t,this}setHeader(t,e){return this.widget.config.header={title:t,options:e},this}setSize(t){return this.widget.config.size=t,this}setEChartsOptions(t){return this.widget.config.options=t,this}setFilterOptions(t){return this.widget.config.options=t,this}setTileOptions(t){return this.widget.config.options=t,this}setMarkdownCellOptions(t){return this.widget.config.options=t,this}setCodeCellOptions(t){return this.widget.config.options=t,this}setTableOptions(t){return this.widget.config.options=t,this}setEvents(t){return this.widget.config.events={onChartOptions:t},this}setEventChartOptions(t){return this.widget.config.events={onChartOptions:t},this}setSeries(t){return this.widget.series=t,this}setData(t){return this.widget.data=t,this}setChartInstance(t){return this.widget.chartInstance=t,this}setEChartsTitle(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.title=t,this}setEChartsGrid(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.grid=t,this}setEChartsTooltip(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.tooltip=t,this}setEChartsLegend(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.legend=t,this}setEChartsXAxis(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.xAxis=t,this}setEChartsYAxis(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.yAxis=t,this}setEChartsSeries(t){return this.widget.config.options||(this.widget.config.options={}),this.widget.config.options.series=t,this}build(){return this.widget}static setData(t,e){if(t.data=e,t.config.options&&"series"in t.config.options){let i=t.config.options;i.series&&Array.isArray(i.series)&&i.series.forEach(n=>{n&&typeof n=="object"&&"data"in n&&(n.data=e)}),t.chartInstance&&t.chartInstance.setOption(i)}if(t.config.component==="table"&&t.config.options){let i=t.config.options;i.data&&(i.data=e)}if(t.config.component==="tile"&&t.config.options){let i=t.config.options;e&&typeof e=="object"&&Object.assign(i,e)}}static exportTableData(t){let e=t.config?.options;return!e?.data||!e?.columns?[]:e.data.map(i=>e.columns.map(n=>i[n]||""))}static getTableExportHeaders(t){return t.config?.options?.columns||[]}static getTableExportSheetName(t){return`${(t.config?.header?.title||"Table").replace(/[^\w\s]/gi,"").substring(0,20)} (Table)`}static exportTileData(t){let e=t.config?.options;return e?[[t.config?.header?.title||"Metric",e.value||"",e.change||"",e.changeType||"neutral",e.description||""]]:[]}static getTileExportHeaders(t){return["Metric","Value","Change","Change Type","Description"]}static getTileExportSheetName(t){return`${(t.config?.header?.title||"Tile").replace(/[^\w\s]/gi,"").substring(0,20)} (Tile)`}};var Ft=[];for(let r=0;r<256;++r)Ft.push((r+256).toString(16).slice(1));function ql(r,t=0){return(Ft[r[t+0]]+Ft[r[t+1]]+Ft[r[t+2]]+Ft[r[t+3]]+"-"+Ft[r[t+4]]+Ft[r[t+5]]+"-"+Ft[r[t+6]]+Ft[r[t+7]]+"-"+Ft[r[t+8]]+Ft[r[t+9]]+"-"+Ft[r[t+10]]+Ft[r[t+11]]+Ft[r[t+12]]+Ft[r[t+13]]+Ft[r[t+14]]+Ft[r[t+15]]).toLowerCase()}var Va,_f=new Uint8Array(16);function Ua(){if(!Va){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Va=crypto.getRandomValues.bind(crypto)}return Va(_f)}var yf=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),za={randomUUID:yf};function wf(r,t,e){if(za.randomUUID&&!t&&!r)return za.randomUUID();r=r||{};let i=r.random??r.rng?.()??Ua();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){if(e=e||0,e<0||e+16>t.length)throw new RangeError(`UUID byte range ${e}:${e+15} is out of buffer bounds`);for(let n=0;n<16;++n)t[e+n]=i[n];return t}return ql(i)}var tn=wf;var ye=class{constructor(){this.data=[],this.widgetBuilder=new Jt().setId(tn()).setComponent("echart"),this.chartOptions=this.getDefaultOptions()}static exportData(t){throw new Error("exportData must be implemented by subclass")}static getExportHeaders(t){throw new Error("getExportHeaders must be implemented by subclass")}static getExportSheetName(t){throw new Error("getExportSheetName must be implemented by subclass")}setData(t){return this.data=Array.isArray(t)?t:[t],this.widgetBuilder.setData(t),this}setLabelFormatter(t){return this.seriesOptions.label||(this.seriesOptions.label={}),this.seriesOptions.label.formatter=t,this}setLabelShow(t){return this.seriesOptions.label||(this.seriesOptions.label={}),this.seriesOptions.label.show=t,this}setLabelPosition(t){return this.seriesOptions.label||(this.seriesOptions.label={}),this.seriesOptions.label.position=t,this}setColors(t){return this.getChartType()==="pie"?this.seriesOptions.color=t:(this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.color=t),this}setBorderRadius(t){return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.borderRadius=t,this}setBorder(t,e=1){return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.borderColor=t,this.seriesOptions.itemStyle.borderWidth=e,this}setEmphasis(t=10,e=0,i="rgba(0, 0, 0, 0.5)"){return this.seriesOptions.emphasis={itemStyle:{shadowBlur:t,shadowOffsetX:e,shadowColor:i}},this}setTitle(t,e){return this.chartOptions.title={text:t,subtext:e,left:"center",top:"10",textStyle:{fontSize:16,color:"#333"}},this}setTitleOptions(t){return this.chartOptions.title=k(k({},this.chartOptions.title),t),this}setTooltip(t,e){return this.chartOptions.tooltip={trigger:t,formatter:e||"{b}: {c}"},this}setTooltipOptions(t){return this.chartOptions.tooltip=k(k({},this.chartOptions.tooltip),t),this}setLegend(t="vertical",e="left"){return this.chartOptions.legend={show:!0,orient:t,left:e==="left"?"left":e==="right"?"right":"center",top:t==="horizontal"?"bottom":"middle",bottom:t==="horizontal"?"10":void 0},this}setLegendOptions(t){return this.chartOptions.legend=k(k({},this.chartOptions.legend),t),this}setGrid(t){return this.chartOptions.grid=k(k({},this.chartOptions.grid),t),this}setXAxis(t){return this.chartOptions.xAxis=t,this}setYAxis(t){return this.chartOptions.yAxis=t,this}setSeries(t){return this.chartOptions.series=t,this}addSeries(t){return this.chartOptions.series||(this.chartOptions.series=[]),this.chartOptions.series.push(t),this}setAnimation(t){return this.chartOptions.animation=t,this}setBackgroundColor(t){return this.chartOptions.backgroundColor=t,this}setHeader(t,e){return this.widgetBuilder.setHeader(t,e),this}setPosition(t){return this.widgetBuilder.setPosition(t),this}setCustomOptions(t){return this.widgetBuilder.setEChartsOptions(t),this}setEvents(t){return this.widgetBuilder.setEvents(t),this}setChartInstance(t){return this.widgetBuilder.setChartInstance(t),this}build(){return this.widgetBuilder.setEChartsOptions(this.chartOptions).build()}getChartOptions(){return k({},this.chartOptions)}getWidgetBuilder(){return this.widgetBuilder}static updateData(t,e,i){if(Jt.setData(t,e),t.chartInstance)try{t.chartInstance.setOption(t.config?.options,!0)}catch(n){console.error("Error updating chart:",n)}else this.retryChartUpdate(t,i)}static retryChartUpdate(t,e){let i=e?.maxAttempts||10,n=e?.baseDelay||100,s=0,a=()=>{if(s++,t.chartInstance)try{t.chartInstance.setOption(t.config?.options,!0);return}catch(o){console.error("Error updating chart on retry:",o)}if(s<i){let o=Math.min(n*Math.pow(1.5,s-1),2e3);setTimeout(a,o)}};setTimeout(a,n)}static isChartType(t,e){return t.config.component==="echart"&&t.config.options?.series?.[0]?.type===e}static getChartType(t){return t.config.component==="echart"&&t.config.options?.series?.[0]?.type?t.config.options.series[0].type:null}static transformData(t,e){return t}static applyFilters(t,e){return!e||e.length===0?t:t.filter(i=>e.every(n=>{let s=n.column||n.property;if(!s)return!0;let a=this.getNestedProperty(i,s);return this.matchesFilter(a,n)}))}static getNestedProperty(t,e){return e.split(".").reduce((i,n)=>i?.[n],t)}static matchesFilter(t,e){switch(e.operator){case"equals":return t===e.value;case"contains":return String(t).toLowerCase().includes(String(e.value).toLowerCase());case"greaterThan":return Number(t)>Number(e.value);case"lessThan":return Number(t)<Number(e.value);case"greaterThanOrEqual":return Number(t)>=Number(e.value);case"lessThanOrEqual":return Number(t)<=Number(e.value);case"in":return Array.isArray(e.value)&&e.value.includes(t);default:return!0}}static generateSampleData(t,e){return t.map(i=>{let n=k({},i);return e?.randomizeNumericFields&&Object.keys(n).forEach(s=>{if(typeof n[s]=="number"){let a=(Math.random()-.5)*2*(e.variationPercentage||.2);n[s]=Math.max(0,n[s]*(1+a))}}),n})}setCurrencyFormatter(t="USD",e="en-US"){let i=n=>new Intl.NumberFormat(e,{style:"currency",currency:t}).format(n);return this.setTooltip(this.chartOptions.tooltip?.trigger||"item",n=>Array.isArray(n)?n.map(s=>`${s.seriesName}<br/>${s.name}: ${i(s.value)}`).join("<br/>"):`${n.name}: ${i(n.value)}`),this}setPercentageFormatter(t=1){let e=i=>`${i.toFixed(t)}%`;return this.setTooltip(this.chartOptions.tooltip?.trigger||"item",i=>Array.isArray(i)?i.map(n=>`${n.seriesName}<br/>${n.name}: ${e(n.value)}`).join("<br/>"):`${i.name}: ${e(i.value)}`),this}setNumberFormatter(t="en-US",e){let i=n=>new Intl.NumberFormat(t,e).format(n);return this.setTooltip(this.chartOptions.tooltip?.trigger||"item",n=>Array.isArray(n)?n.map(s=>`${s.seriesName}<br/>${s.name}: ${i(s.value)}`).join("<br/>"):`${n.name}: ${i(n.value)}`),this}setFilterColumn(t){let e=this.widgetBuilder.build();return e.config&&(e.config.filterColumn=t),this}static createFilterFromChartData(t,e){return!t||!e?null:{property:e,operator:"equals",value:t.name||t.value,displayValue:t.name||String(t.value)}}setGradientColors(t,e,i="vertical"){let n={type:"linear",x:0,y:i==="vertical"?0:1,x2:i==="vertical"?0:1,y2:i==="vertical"?1:0,colorStops:[{offset:0,color:t},{offset:1,color:e}]};return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.color=n,this}setPredefinedPalette(t){let e={business:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],finance:["#2E8B57","#4682B4","#DAA520","#DC143C","#9370DB","#20B2AA","#FF6347","#4169E1","#32CD32"],modern:["#667eea","#764ba2","#f093fb","#f5576c","#4facfe","#00f2fe","#43e97b","#38f9d7","#ffecd2"],pastel:["#FFB6C1","#87CEEB","#98FB98","#F0E68C","#DDA0DD","#F5DEB3","#FFE4E1","#E0FFFF","#FAFAD2"],dark:["#2c3e50","#34495e","#7f8c8d","#95a5a6","#bdc3c7","#ecf0f1","#f39c12","#e67e22","#e74c3c"]};return this.setColors(e[t]||e.business)}getPaletteColors(t){let e={business:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],finance:["#2E8B57","#4682B4","#DAA520","#DC143C","#9370DB","#20B2AA","#FF6347","#4169E1","#32CD32"],modern:["#667eea","#764ba2","#f093fb","#f5576c","#4facfe","#00f2fe","#43e97b","#38f9d7","#ffecd2"],pastel:["#FFB6C1","#87CEEB","#98FB98","#F0E68C","#DDA0DD","#F5DEB3","#FFE4E1","#E0FFFF","#FAFAD2"],dark:["#2c3e50","#34495e","#7f8c8d","#95a5a6","#bdc3c7","#ecf0f1","#f39c12","#e67e22","#e74c3c"]};return e[t]||e.business}createCurrencyFormatter(t="USD",e="en-US"){return i=>new Intl.NumberFormat(e,{style:"currency",currency:t}).format(i)}createPercentageFormatter(t=1){return e=>`${e.toFixed(t)}%`}createNumberFormatter(t=0,e="en-US"){return i=>new Intl.NumberFormat(e,{minimumFractionDigits:t,maximumFractionDigits:t}).format(i)}setValueFormatter(t){return this.setTooltip(this.chartOptions.tooltip?.trigger||"item",e=>Array.isArray(e)?e.map(i=>`${i.seriesName}<br/>${i.name}: ${t(i.value)}`).join("<br/>"):`${e.name}: ${t(e.value)}`),this}};var rn=class r extends ye{constructor(){super(),this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"5%",right:"5%",bottom:"15%",height:"70%"},tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{show:!0,orient:"vertical",left:"left",top:"middle"}}}getChartType(){return"pie"}getDefaultSeriesOptions(){return{name:"Pie Chart",type:"pie",radius:["30%","60%"],center:["50%","50%"],itemStyle:{borderRadius:2},label:{formatter:`{b}
{c}%
({d})%`,show:!0},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setRadius(t){return this.seriesOptions.radius=t,this}setCenter(t){return this.seriesOptions.center=t,this}build(){let t=j(k({},this.chartOptions),{series:[j(k({},this.seriesOptions),{type:"pie"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e,i){ye.updateData(t,e,i)}static transformData(t,e){if(!t||t.length===0)return[];let i=e?.valueField||"value",n=e?.nameField||"name",s=t.map(a=>({value:Number(a[i])||0,name:String(a[n])||"Unknown"}));return e?.sortBy==="value"?s.sort((a,o)=>o.value-a.value):e?.sortBy==="name"&&s.sort((a,o)=>a.name.localeCompare(o.name)),s}static addPercentages(t){let e=t.reduce((i,n)=>i+n.value,0);return t.map(i=>j(k({},i),{percentage:e>0?i.value/e*100:0}))}static createFilterFromPieClick(t,e){return!t||!t.name?null:{accessor:e,filterColumn:e,[e]:t.name,value:t.name,percentage:t.value?.toString()||"0"}}setDonutStyle(t="40%",e="70%"){return this.seriesOptions.radius=[t,e],this}setPercentageLabels(t=!0,e=1){return t&&(this.seriesOptions.label=j(k({},this.seriesOptions.label),{formatter:"{b}: {c} ({d}%)"})),this}setFinancialDisplay(t="USD",e="en-US"){return this.setCurrencyFormatter(t,e),this.seriesOptions.label=j(k({},this.seriesOptions.label),{formatter:i=>{let n=new Intl.NumberFormat(e,{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0});return`${i.data.name}
${n.format(i.data.value)}
(${i.percent}%)`}}),this}static isPieChart(t){return ye.isChartType(t,"pie")}static createPieChartWidget(t){let e=r.create();t&&e.setData(t);let i=j(k({},e.chartOptions),{series:[j(k({},e.seriesOptions),{type:"pie"})]});return e.widgetBuilder.setEChartsOptions(i).setData(t||[])}static exportData(t){let e=t.config?.options?.series?.[0];return e?.data?e.data.map(i=>[i.name||"Unknown",i.value||0,r.calculatePercentage(i.value,e.data)]):(console.warn("PieChartBuilder.exportData - No series data found"),[])}static getExportHeaders(t){return["Category","Value","Percentage"]}static getExportSheetName(t){return(t.config?.header?.title||"Sheet").replace(/[^\w\s]/gi,"").substring(0,31).trim()}static calculatePercentage(t,e){let i=e.reduce((n,s)=>n+(s.value||0),0);return i===0?"0%":`${(t/i*100).toFixed(2)}%`}};var nn=class r extends ye{constructor(){super(),this.categories=[],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"3%",right:"4%",bottom:"15%"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{show:!0,orient:"horizontal",top:"10"},xAxis:{type:"category",data:[]},yAxis:{type:"value"}}}getChartType(){return"bar"}getDefaultSeriesOptions(){return{name:"Bar Chart",type:"bar",itemStyle:{borderRadius:2},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",aggregateBy:n,sortBy:s,sortOrder:a="desc",limit:o}=t;try{let c=this.data.map(l=>({name:l[e]||"Unknown",value:parseFloat(l[i])||0}));if(n){let l=new Map;c.forEach(h=>{let f=h.name;l.set(f,(l.get(f)||0)+h.value)}),c=Array.from(l.entries()).map(([h,f])=>({name:h,value:f}))}s==="name"?c.sort((l,h)=>a==="asc"?l.name.localeCompare(h.name):h.name.localeCompare(l.name)):s==="value"&&c.sort((l,h)=>a==="asc"?l.value-h.value:h.value-l.value),o&&o>0&&(c=c.slice(0,o)),this.seriesOptions.data=c,this.categories.length===0&&(this.categories=c.map(l=>l.name),this.setCategories(this.categories))}catch(c){console.error("Error transforming bar chart data:",c)}return this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setCategories(t){return this.categories=t,this.chartOptions.xAxis=j(k({},this.chartOptions.xAxis),{data:t}),this}setColors(t){return this.seriesOptions.color=t,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return this.setColors(e)}setBarWidth(t){return this.seriesOptions.barWidth=t,this}setBarBorderRadius(t){return this.seriesOptions.itemStyle=j(k({},this.seriesOptions.itemStyle),{borderRadius:t}),this}setYAxisName(t){return this.chartOptions.yAxis=j(k({},this.chartOptions.yAxis),{name:t,nameLocation:"middle",nameGap:30}),this}setXAxisName(t){return this.chartOptions.xAxis=j(k({},this.chartOptions.xAxis),{name:t,nameLocation:"middle",nameGap:30}),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setValueFormatter(i),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setValueFormatter(e),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setValueFormatter(i),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=5){let e=[],i=["Q1","Q2","Q3","Q4","Q5"];for(let n=0;n<Math.min(t,i.length);n++)e.push({name:i[n],value:Math.floor(Math.random()*100)+10,category:i[n],department:["Sales","Marketing","Operations"][Math.floor(Math.random()*3)]});return this.setData(e)}setSalesRevenueConfiguration(){return this.setBarWidth("60%").setBarBorderRadius(4).setYAxisName("Revenue ($)").setXAxisName("Time Period").setPredefinedPalette("finance").setTooltip("axis","{b}: ${c}")}setPerformanceConfiguration(){return this.setBarWidth("70%").setBarBorderRadius(6).setYAxisName("Performance Score").setXAxisName("Metrics").setPredefinedPalette("business").setTooltip("axis","{b}: {c}%")}setComparisonConfiguration(){return this.setBarWidth("50%").setBarBorderRadius(2).setYAxisName("Value").setXAxisName("Categories").setPredefinedPalette("modern").setTooltip("axis","{b}: {c}")}build(){let t=j(k({},this.chartOptions),{series:[j(k({},this.seriesOptions),{type:"bar"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>({name:l.name||l.category||"Unknown",value:parseFloat(l.value)||0})));let o=t.chartInstance.getOption(),c=j(k({},o),{series:[j(k({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating bar chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isBarChart(t){return ye.isChartType(t,"bar")}static exportData(t){let e=[];if(t.echart_options?.series?.[0]?.data&&t.echart_options?.xAxis?.data){let i=t.echart_options.series[0].data,n=t.echart_options.xAxis.data;for(let s=0;s<i.length;s++){let a=i[s],o=n[s]||`Category ${s+1}`;typeof a=="object"&&a!==null?e.push(k({Category:a.name||o,Value:a.value||0},a)):e.push({Category:o,Value:a||0})}}return e}static getExportHeaders(t){return["Category","Value"]}static getExportSheetName(t){return"Bar Chart Data"}};var sn=class r extends ye{constructor(){super(),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"item",formatter:"{b}: ({c})"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"value",nameLocation:"middle",scale:!0,axisLabel:{color:"#666"}},yAxis:{type:"value",nameLocation:"middle",scale:!0,axisLabel:{color:"#666"}}}}getChartType(){return"scatter"}getDefaultSeriesOptions(){return{name:"Scatter Chart",type:"scatter",symbolSize:8,symbol:"circle",itemStyle:{color:"#5470c6",opacity:.8},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},large:!1,largeThreshold:2e3}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{xField:e="x",yField:i="y",nameField:n="name",sizeField:s,sortBy:a,sortOrder:o="asc",limit:c}=t;try{let l=this.data.map((h,f)=>({value:[parseFloat(h[e])||0,parseFloat(h[i])||0],name:h[n]||`Point ${f+1}`,symbolSize:s&&parseFloat(h[s])||8,originalItem:h}));a==="x"?l.sort((h,f)=>o==="asc"?h.value[0]-f.value[0]:f.value[0]-h.value[0]):a==="y"&&l.sort((h,f)=>o==="asc"?h.value[1]-f.value[1]:f.value[1]-h.value[1]),c&&c>0&&(l=l.slice(0,c)),this.seriesOptions.data=l}catch(l){console.error("Error transforming scatter chart data:",l)}return this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisName(t){return this.chartOptions.xAxis=j(k({},this.chartOptions.xAxis),{name:t}),this}setYAxisName(t){return this.chartOptions.yAxis=j(k({},this.chartOptions.yAxis),{name:t}),this}setSymbol(t,e=8){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setSymbolSizeFunction(t){return this.seriesOptions.symbolSize=t,this}setItemStyle(t,e=.8,i,n){return this.seriesOptions.itemStyle={color:t,opacity:e,borderColor:i,borderWidth:n},this}setLargeScatter(t,e=2e3){return this.seriesOptions.large=t,this.seriesOptions.largeThreshold=e,this}setProgressive(t,e=3e3){return this.seriesOptions.progressive=t,this.seriesOptions.progressiveThreshold=e,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&this.setItemStyle(e[0]),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setValueFormatter(i),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setValueFormatter(e),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setValueFormatter(i),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=20){let e=[];for(let i=0;i<t;i++)e.push({x:Math.random()*100,y:Math.random()*100,name:`Point ${i+1}`,size:Math.random()*15+5,category:["A","B","C"][Math.floor(Math.random()*3)],department:["Sales","Marketing","Operations"][Math.floor(Math.random()*3)]});return this.setData(e)}setCorrelationAnalysisConfiguration(){return this.setSymbol("circle",6).setItemStyle("#5470c6",.7).setLargeScatter(!0,1e3).setXAxisName("X Variable").setYAxisName("Y Variable").setPredefinedPalette("finance").setTooltip("item","{b}: ({c})")}setPerformanceAnalysisConfiguration(){return this.setSymbol("diamond",8).setItemStyle("#91cc75",.8).setXAxisName("Performance Score").setYAxisName("Efficiency Rating").setPredefinedPalette("business").setTooltip("item","{b}: Performance {c}")}setRiskAnalysisConfiguration(){return this.setSymbol("triangle",7).setItemStyle("#ee6666",.7).setXAxisName("Risk Level").setYAxisName("Return Potential").setPredefinedPalette("modern").setTooltip("item","Risk: {c}")}build(){let t=j(k({},this.chartOptions),{series:[j(k({},this.seriesOptions),{type:"scatter"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>({value:[parseFloat(l.x)||0,parseFloat(l.y)||0],name:l.name||"Point"})));let o=t.chartInstance.getOption(),c=j(k({},o),{series:[j(k({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating scatter chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isScatterChart(t){return ye.isChartType(t,"scatter")}static createScatterChartWidget(t){let e=r.create();return t&&e.setData(t),e.getWidgetBuilder()}static exportData(t){let e=[];return t.echart_options?.series?.[0]?.data&&t.echart_options.series[0].data.forEach((n,s)=>{n&&n.value&&Array.isArray(n.value)&&e.push({Name:n.name||`Point ${s+1}`,"X Value":n.value[0]||0,"Y Value":n.value[1]||0,"Symbol Size":n.symbolSize||8})}),e}static getExportHeaders(t){return["Name","X Value","Y Value","Symbol Size"]}static getExportSheetName(t){return"Scatter Chart Data"}};var an=class r extends ye{constructor(){super(),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{tooltip:{trigger:"item",formatter:"{b}: {c}"}}}getChartType(){return"gauge"}getDefaultSeriesOptions(){return{name:"Gauge Chart",type:"gauge",min:0,max:100,startAngle:180,endAngle:0,radius:"75%",center:["50%","60%"],axisLine:{lineStyle:{width:30,color:[[.3,"#ff6e76"],[.7,"#fddd60"],[1,"#58d9f9"]]}},progress:{show:!0,width:8},pointer:{show:!0,length:"60%",width:8},axisTick:{show:!0,splitNumber:5,length:8,lineStyle:{width:2,color:"#999"}},splitLine:{show:!0,length:30,lineStyle:{width:4,color:"#999"}},axisLabel:{show:!0,distance:5,color:"#999",fontSize:12},title:{show:!0,offsetCenter:[0,70],color:"#464646",fontSize:14},detail:{show:!0,offsetCenter:[0,40],color:"#464646",fontSize:30,formatter:"{value}%"}}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",sortBy:n,sortOrder:s="desc",limit:a}=t;try{let o=this.data.map(c=>({value:parseFloat(c[i])||0,name:c[e]||"Gauge",originalItem:c}));n==="value"?o.sort((c,l)=>s==="asc"?c.value-l.value:l.value-c.value):n==="name"&&o.sort((c,l)=>s==="asc"?c.name.localeCompare(l.name):l.name.localeCompare(c.name)),a&&a>0&&(o=o.slice(0,a)),this.seriesOptions.data=o.length>0?[o[0]]:[]}catch(o){console.error("Error transforming gauge chart data:",o)}return this}setData(t){return this.seriesOptions.data=Array.isArray(t)?t:[t],super.setData(t),this}setRange(t,e){return this.seriesOptions.min=t,this.seriesOptions.max=e,this}setAngles(t,e){return this.seriesOptions.startAngle=t,this.seriesOptions.endAngle=e,this}setRadius(t){return this.seriesOptions.radius=t,this}setCenter(t){return this.seriesOptions.center=t,this}setAxisLine(t,e){return this.seriesOptions.axisLine={lineStyle:{width:t,color:e}},this}setProgress(t,e=8){return this.seriesOptions.progress={show:t,width:e},this}setPointer(t,e="60%",i=8){return this.seriesOptions.pointer={show:t,length:e,width:i},this}setAxisTick(t,e=5,i=8,n=2,s="#999"){return this.seriesOptions.axisTick={show:t,splitNumber:e,length:i,lineStyle:{width:n,color:s}},this}setSplitLine(t,e=30,i=4,n="#999"){return this.seriesOptions.splitLine={show:t,length:e,lineStyle:{width:i,color:n}},this}setAxisLabel(t,e=5,i="#999",n=12){return this.seriesOptions.axisLabel={show:t,distance:e,color:i,fontSize:n},this}setGaugeTitle(t,e=[0,70],i="#464646",n=14){return this.seriesOptions.title={show:t,offsetCenter:e,color:i,fontSize:n},this}setDetail(t,e=[0,40],i="#464646",n=30,s="{value}%"){return this.seriesOptions.detail={show:t,offsetCenter:e,color:i,fontSize:n,formatter:s},this}setPredefinedPalette(t){let e=this.getPaletteColors(t),i=[];for(let n=0;n<e.length&&n<3;n++)i.push([(n+1)/3,e[n]]);return i.length===0&&i.push([.3,"#ff6e76"],[.7,"#fddd60"],[1,"#58d9f9"]),this.setAxisLine(30,i),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setDetail(!0,[0,40],"#464646",30,`{value | ${i.name}}`),this}setPercentageFormatter(t=1){return this.setDetail(!0,[0,40],"#464646",30,"{value}%"),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setDetail(!0,[0,40],"#464646",30,"{value}"),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=1){let e=[];for(let i=0;i<t;i++)e.push({value:Math.floor(Math.random()*100),name:`Gauge ${i+1}`,progress:Math.floor(Math.random()*100),target:100,category:["Performance","Efficiency","Quality"][Math.floor(Math.random()*3)]});return this.setData(e)}setKPIMonitoringConfiguration(){return this.setRange(0,100).setRadius("70%").setCenter(["50%","55%"]).setProgress(!0,10).setPointer(!0,"70%",6).setPredefinedPalette("business").setDetail(!0,[0,70],"#333",24,"{value}%").setGaugeTitle(!0,[0,-30],"#666",16)}setPerformanceTrackingConfiguration(){return this.setRange(0,100).setRadius("80%").setCenter(["50%","60%"]).setProgress(!0,15).setPointer(!1).setPredefinedPalette("finance").setDetail(!0,[0,10],"#333",32,"{value}%").setGaugeTitle(!0,[0,-40],"#666",18)}setProgressIndicatorConfiguration(){return this.setRange(0,100).setRadius("60%").setCenter(["50%","50%"]).setProgress(!0,8).setPointer(!0,"60%",4).setPredefinedPalette("modern").setDetail(!0,[0,60],"#333",20,"{value}%").setGaugeTitle(!0,[0,-50],"#666",14)}build(){let t=j(k({},this.chartOptions),{series:[j(k({},this.seriesOptions),{type:"gauge"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"?a=e.map(l=>({value:parseFloat(l.value)||0,name:l.name||"Gauge"})):typeof e=="number"&&(a=[{value:e,name:"Gauge"}]);let o=t.chartInstance.getOption(),c=j(k({},o),{series:[j(k({},o.series[0]),{data:Array.isArray(a)?a:[a]})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating gauge chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isGaugeChart(t){return ye.isChartType(t,"gauge")}static createGaugeChartWidget(t){let e=r.create();return t&&e.setData(t),e.getWidgetBuilder()}static exportData(t){let e=[];return t.echart_options?.series?.[0]?.data&&t.echart_options.series[0].data.forEach(n=>{n&&e.push({Name:n.name||"Gauge",Value:n.value||0,Percentage:this.calculatePercentage(n.value||0,t.echart_options.series[0].max||100)})}),e}static getExportHeaders(t){return["Name","Value","Percentage"]}static getExportSheetName(t){return"Gauge Chart Data"}static calculatePercentage(t,e){return`${(t/e*100).toFixed(1)}%`}};var on=class r extends ye{constructor(){super(),this.xAxisData=[],this.yAxisData=[],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"15%",bottom:"15%"},tooltip:{trigger:"item",formatter:"{b}: {c}"},xAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{color:"#666"}},visualMap:{show:!0,min:0,max:10,calculable:!0,orient:"horizontal",left:"center",top:"5%",inRange:{color:["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffcc","#fee090","#fdae61","#f46d43","#d73027","#a50026"]},text:["High","Low"]}}}getChartType(){return"heatmap"}getDefaultSeriesOptions(){return{name:"Heatmap Chart",type:"heatmap",itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},progressive:1e3,progressiveThreshold:3e3,animation:!0}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{xField:e="x",yField:i="y",valueField:n="value",nameField:s="name",sortBy:a,sortOrder:o="desc",limit:c}=t;try{let l=[],h=new Set,f=new Set,u=this.data;t.filters&&t.filters.length>0&&(u=ye.applyFilters(this.data,t.filters)),u.forEach((x,E)=>{let F=x[e]||E%10,O=x[i]||Math.floor(E/10),V=parseFloat(x[n])||0,Z=x[s]||`${F}-${O}`,he=typeof F=="string"?this.getAxisIndex(F,h):F,D=typeof O=="string"?this.getAxisIndex(O,f):O;l.push({value:[he,D,V],name:Z,originalItem:x}),typeof F=="string"&&h.add(F),typeof O=="string"&&f.add(O)}),a==="value"&&l.sort((x,E)=>o==="asc"?x.value[2]-E.value[2]:E.value[2]-x.value[2]),c&&c>0&&(l=l.slice(0,c)),this.seriesOptions.data=l,h.size>0&&this.setXAxisData(Array.from(h).sort()),f.size>0&&this.setYAxisData(Array.from(f).sort());let d=l.map(x=>x.value[2]),g=Math.min(...d),p=Math.max(...d);this.setVisualMap(g,p)}catch(l){console.error("Error transforming heatmap chart data:",l)}return this}getAxisIndex(t,e){let i=Array.from(e).sort(),n=i.indexOf(t);return n!==-1?n:i.length}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis=j(k({},this.chartOptions.xAxis),{data:t}),this}setYAxisData(t){return this.yAxisData=t,this.chartOptions.yAxis=j(k({},this.chartOptions.yAxis),{data:t}),this}setXAxisName(t){return this.chartOptions.xAxis=j(k({},this.chartOptions.xAxis),{name:t}),this}setYAxisName(t){return this.chartOptions.yAxis=j(k({},this.chartOptions.yAxis),{name:t}),this}setVisualMap(t,e,i,n=["High","Low"]){return this.chartOptions.visualMap=j(k({},this.chartOptions.visualMap),{min:t,max:e,inRange:{color:i||["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffcc","#fee090","#fdae61","#f46d43","#d73027","#a50026"]},text:n}),this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&(this.chartOptions.visualMap=j(k({},this.chartOptions.visualMap),{inRange:{color:e}})),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("item",n=>{let[s,a,o]=n.data.value;return`${n.data.name||`(${s}, ${a})`}: ${i(o)}`}),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("item",i=>{let[n,s,a]=i.data.value;return`${i.data.name||`(${n}, ${s})`}: ${e(a)}`}),this}setCustomNumberFormatter(t=1,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("item",n=>{let[s,a,o]=n.data.value;return`${n.data.name||`(${s}, ${a})`}: ${i(o)}`}),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=7,e=5){let i=[],n=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].slice(0,t),s=["Morning","Afternoon","Evening","Night","Late Night"].slice(0,e);for(let a=0;a<t;a++)for(let o=0;o<e;o++)i.push({x:n[a],y:s[o],value:Math.floor(Math.random()*100),category:["High","Medium","Low"][Math.floor(Math.random()*3)],department:["Sales","Marketing","Operations"][Math.floor(Math.random()*3)]});return this.setData(i)}setActivityAnalysisConfiguration(){return this.setPredefinedPalette("business").setCustomNumberFormatter(0,"en-US").setXAxisName("Time Period").setYAxisName("Activity Type").setVisualMapPosition("horizontal","center","5%")}setCorrelationAnalysisConfiguration(){return this.setPredefinedPalette("modern").setPercentageFormatter(2).setXAxisName("Variable X").setYAxisName("Variable Y").setVisualMapPosition("vertical","right","center")}setPerformanceMatrixConfiguration(){return this.setPredefinedPalette("finance").setCurrencyFormatter("USD","en-US").setXAxisName("Time").setYAxisName("Metrics").setVisualMapPosition("horizontal","center","bottom")}setVisualMapPosition(t="horizontal",e="center",i="5%"){return this.chartOptions.visualMap=j(k({},this.chartOptions.visualMap),{orient:t,left:e,top:i}),this}setItemStyle(t="#fff",e=1){return this.seriesOptions.itemStyle={borderColor:t,borderWidth:e},this}setProgressive(t,e=3e3){return this.seriesOptions.progressive=t,this.seriesOptions.progressiveThreshold=e,this}setAnimation(t){return this.seriesOptions.animation=t,this}build(){let t=j(k({},this.chartOptions),{series:[j(k({},this.seriesOptions),{type:"heatmap"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map((l,h)=>k({value:[l.x||h%10,l.y||Math.floor(h/10),parseFloat(l.value)||0],name:l.name||`${l.x||h%10}-${l.y||Math.floor(h/10)}`},l)));let o=t.chartInstance.getOption(),c=j(k({},o),{series:[j(k({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating heatmap chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isHeatmapChart(t){return ye.isChartType(t,"heatmap")}static createHeatmapChartWidget(t,e,i){let n=r.create();return t&&n.setData(t),e&&n.setXAxisData(e),i&&n.setYAxisData(i),n.getWidgetBuilder()}static exportData(t){let e=[];if(t.echart_options?.series?.[0]?.data){let i=t.echart_options.series[0].data,n=t.echart_options?.xAxis?.data||[],s=t.echart_options?.yAxis?.data||[];i.forEach(a=>{if(a&&a.value){let[o,c,l]=a.value;e.push({X:n[o]||o,Y:s[c]||c,Value:l,Name:a.name||`${o}-${c}`})}})}return e}static getExportHeaders(t){return["X","Y","Value","Name"]}static getExportSheetName(t){return"Heatmap Chart Data"}};var $n={MOBILE:480,TABLET:768,DESKTOP:1024,LARGE_DESKTOP:1440},yt={MOBILE:{COLS:.5,ROWS:.8,WIDTH:.6,HEIGHT:1.2},TABLET:{COLS:.75,ROWS:.9,WIDTH:.8,HEIGHT:1},DESKTOP:{COLS:1,ROWS:1,WIDTH:1,HEIGHT:1},LARGE_DESKTOP:{COLS:1.33,ROWS:1.1,WIDTH:1.2,HEIGHT:.9}},we={MAX_COLS:12,MIN_COLS:1,MAX_ROWS:100,MIN_ROWS:1,FIXED_COL_WIDTH:100,FIXED_ROW_HEIGHT:50,MOBILE_BREAKPOINT:640},Ga={MAX_COLS:Math.round(we.MAX_COLS*yt.MOBILE.COLS),MIN_COLS:Math.round(we.MIN_COLS*yt.MOBILE.COLS),MAX_ROWS:Math.round(we.MAX_ROWS*yt.MOBILE.ROWS),MIN_ROWS:Math.round(we.MIN_ROWS*yt.MOBILE.ROWS),FIXED_COL_WIDTH:Math.round(we.FIXED_COL_WIDTH*yt.MOBILE.WIDTH),FIXED_ROW_HEIGHT:Math.round(we.FIXED_ROW_HEIGHT*yt.MOBILE.HEIGHT),MOBILE_BREAKPOINT:$n.MOBILE},Xa={MAX_COLS:Math.round(we.MAX_COLS*yt.TABLET.COLS),MIN_COLS:Math.round(we.MIN_COLS*yt.TABLET.COLS),MAX_ROWS:Math.round(we.MAX_ROWS*yt.TABLET.ROWS),MIN_ROWS:Math.round(we.MIN_ROWS*yt.TABLET.ROWS),FIXED_COL_WIDTH:Math.round(we.FIXED_COL_WIDTH*yt.TABLET.WIDTH),FIXED_ROW_HEIGHT:Math.round(we.FIXED_ROW_HEIGHT*yt.TABLET.HEIGHT),MOBILE_BREAKPOINT:$n.TABLET},ja={MAX_COLS:Math.round(we.MAX_COLS*yt.LARGE_DESKTOP.COLS),MIN_COLS:Math.round(we.MIN_COLS*yt.LARGE_DESKTOP.COLS),MAX_ROWS:Math.round(we.MAX_ROWS*yt.LARGE_DESKTOP.ROWS),MIN_ROWS:Math.round(we.MIN_ROWS*yt.LARGE_DESKTOP.ROWS),FIXED_COL_WIDTH:Math.round(we.FIXED_COL_WIDTH*yt.LARGE_DESKTOP.WIDTH),FIXED_ROW_HEIGHT:Math.round(we.FIXED_ROW_HEIGHT*yt.LARGE_DESKTOP.HEIGHT),MOBILE_BREAKPOINT:$n.LARGE_DESKTOP},Mi={COMPACT:{FIXED_COL_WIDTH:80,FIXED_ROW_HEIGHT:40,OUTER_MARGIN:!1},STANDARD:{FIXED_COL_WIDTH:we.FIXED_COL_WIDTH,FIXED_ROW_HEIGHT:we.FIXED_ROW_HEIGHT,OUTER_MARGIN:!0},SPACIOUS:{FIXED_COL_WIDTH:120,FIXED_ROW_HEIGHT:80,OUTER_MARGIN:!0}};function Zl(r){switch(r){case"MOBILE":return Ga;case"TABLET":return Xa;case"DESKTOP":return we;case"LARGE_DESKTOP":return ja;default:return we}}var Nt=function(r){return r.DENSITY_BLUE="density_blue",r.DENSITY_GREEN="density_green",r.DENSITY_RED="density_red",r.DENSITY_PURPLE="density_purple",r.DENSITY_ORANGE="density_orange",r.RAINBOW="rainbow",r.DIVERGING="diverging",r.CATEGORICAL="categorical",r.GRAYSCALE="grayscale",r.PROFIT_LOSS="profit_loss",r.PERFORMANCE="performance",r}(Nt||{}),Ql={[Nt.DENSITY_BLUE]:["#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],[Nt.DENSITY_GREEN]:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],[Nt.DENSITY_RED]:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],[Nt.DENSITY_PURPLE]:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],[Nt.DENSITY_ORANGE]:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],[Nt.RAINBOW]:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],[Nt.DIVERGING]:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],[Nt.CATEGORICAL]:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],[Nt.GRAYSCALE]:["#f7f7f7","#cccccc","#969696","#636363","#252525"],[Nt.PROFIT_LOSS]:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91d47c","#4575b4"],[Nt.PERFORMANCE]:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#41ab5d"]},Ya=function(r){return r.DENSITY_MAP="map",r.HEATMAP="heatmap",r.LINE="line",r.BAR="bar",r.PIE="pie",r.SCATTER="scatter",r.AREA="area",r.GAUGE="gauge",r.SANKEY="sankey",r.TREEMAP="treemap",r.SUNBURST="sunburst",r.POLAR="polar",r}(Ya||{}),Ka=function(r){return r.WORLD="world",r.USA="usa",r.CHINA="china",r.JAPAN="japan",r.UK="uk",r.FRANCE="france",r.GERMANY="germany",r.ITALY="italy",r.SPAIN="spain",r.RUSSIA="russia",r.CANADA="canada",r.AUSTRALIA="australia",r.BRAZIL="brazil",r.INDIA="india",r}(Ka||{});var Jl={WORLD:[0,30],NORTH_AMERICA:[-100,45],EUROPE:[10,50],ASIA:[100,30],AFRICA:[20,0],SOUTH_AMERICA:[-60,-15],OCEANIA:[140,-25]};function Ps(r){return Ql[r]||Ql[Nt.DENSITY_BLUE]}var ln=class r extends ye{constructor(){super(),this.mapName="world",this.roamEnabled=!1,this.zoomLevel=1,this.centerCoords=[0,0],this.visualMapRange=[0,100],this.visualMapColors=Ps(Nt.DENSITY_BLUE),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}static registerMap(t,e){try{Kl(t,e)}catch{}}static getAvailableMaps(){return Object.values(Ka)}getDefaultOptions(){return{tooltip:{trigger:"item",formatter:"{b}: {c}"},legend:{show:!1},visualMap:{type:"continuous",min:0,max:100,left:"left",top:"bottom",text:["High","Low"],calculable:!0,inRange:{color:[...Ps(Nt.DENSITY_BLUE)]},textStyle:{color:"#333"}}}}getChartType(){return Ya.DENSITY_MAP}getDefaultSeriesOptions(){return{name:"Density Map",type:"map",map:"world",roam:!1,zoom:1,center:[0,0],label:{show:!1,position:"inside",formatter:"{b}",fontSize:12,color:"#333"},itemStyle:{areaColor:"#eee",borderColor:"#999",borderWidth:.5,shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.3)"},emphasis:{itemStyle:{areaColor:"#b8e186",shadowBlur:20,shadowColor:"rgba(0, 0, 0, 0.5)"}},select:{itemStyle:{areaColor:"#b8e186"}}}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setMap(t){return this.mapName=t,this.seriesOptions.map=t,this}setMapType(t){return this.setMap(t)}setRoam(t){return this.roamEnabled=t,this.seriesOptions.roam=t,this}setZoom(t){return this.zoomLevel=t,this.seriesOptions.zoom=t,this}setCenter(t){return this.centerCoords=t,this.seriesOptions.center=t,this}setVisualMap(t,e,i){return this.visualMapRange=[t,e],i&&(this.visualMapColors=i),this.chartOptions.visualMap={type:"continuous",min:t,max:e,left:"left",top:"bottom",text:["High","Low"],calculable:!0,inRange:{color:[...this.visualMapColors]},textStyle:{color:"#333"}},this}setColorScheme(t,e=0,i=100){return this.visualMapColors=Ps(t),this.setVisualMap(e,i)}setLabelShow(t,e="inside",i){return this.seriesOptions.label={show:t,position:e,formatter:i||"{b}",fontSize:12,color:"#333"},this}setConditionalLabels(t=!0,e="inside",i,n=!0){return n?this.seriesOptions.label={show:!0,position:e,formatter:s=>typeof s.value=="number"&&isFinite(s.value)?i?i.replace("{b}",s.name).replace("{c}",s.value.toString()):`${s.name}
${s.value}`:"",fontSize:12,color:"#333"}:this.seriesOptions.label={show:t,position:e,formatter:i||`{b}
{c}`,fontSize:12,color:"#333"},this}setAreaColor(t){return this.seriesOptions.itemStyle=j(k({},this.seriesOptions.itemStyle),{areaColor:t}),this}setBorderColor(t,e=.5){return this.seriesOptions.itemStyle=j(k({},this.seriesOptions.itemStyle),{borderColor:t,borderWidth:e}),this}setEmphasisColor(t){return this.seriesOptions.emphasis={itemStyle:{areaColor:t,shadowBlur:20,shadowColor:"rgba(0, 0, 0, 0.5)"}},this}setShadow(t=10,e="rgba(0, 0, 0, 0.3)"){return this.seriesOptions.itemStyle=j(k({},this.seriesOptions.itemStyle),{shadowBlur:t,shadowColor:e}),this}setVisualMapOptions(t){return this.chartOptions.visualMap=k(k({},this.chartOptions.visualMap),t),this}setGeoOptions(t){return this.chartOptions.geo=k(k({},this.chartOptions.geo),t),this}setPosition(t){super.setPosition(t);let e=this.calculateMapCenter(t.cols,t.rows);return this.setCenter(e),this}autoAdjustMapSettings(){let t=this.widgetBuilder.build().position;if(t){let e=this.calculateMapCenter(t.cols,t.rows),i=this.calculateMapZoom(t.cols,t.rows);this.setCenter(e)}return this}build(){return this.autoAdjustMapSettings(),this.seriesOptions=j(k({},this.seriesOptions),{map:this.mapName,roam:this.roamEnabled,zoom:this.zoomLevel,center:this.centerCoords}),this.chartOptions.series=[this.seriesOptions],this.widgetBuilder.setEChartsOptions(this.chartOptions).build()}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",regionField:n="region",sortBy:s,sortOrder:a="desc",limit:o}=t;try{let c=[],l=this.data;t.filters&&t.filters.length>0&&(l=ye.applyFilters(this.data,t.filters)),l.forEach(d=>{let g=d[e]||d[n]||"Unknown",p=parseFloat(d[i])||0;c.push({name:g,value:p,originalItem:d})}),s==="value"?c.sort((d,g)=>a==="asc"?d.value-g.value:g.value-d.value):s==="name"&&c.sort((d,g)=>a==="asc"?d.name.localeCompare(g.name):g.name.localeCompare(d.name)),o&&o>0&&(c=c.slice(0,o)),this.seriesOptions.data=c;let h=c.map(d=>d.value),f=Math.min(...h),u=Math.max(...h);this.setVisualMap(f,u)}catch(c){console.error("Error transforming density map data:",c)}return this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&this.setVisualMap(this.visualMapRange[0],this.visualMapRange[1],e),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("item",n=>`${n.name}: ${i(n.value)}`),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("item",i=>`${i.name}: ${e(i.value)}`),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("item",n=>`${n.name}: ${i(n.value)}`),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=10,e="world"){let i=[],n=e==="world"?["China","United States","India","Brazil","Russia","Japan","Germany","United Kingdom","France","Italy"]:["Region 1","Region 2","Region 3","Region 4","Region 5","Region 6","Region 7","Region 8","Region 9","Region 10"];for(let s=0;s<Math.min(t,n.length);s++)i.push({name:n[s],value:Math.floor(Math.random()*1e3)+100,density:Math.floor(Math.random()*500)+50,population:Math.floor(Math.random()*1e6)+1e5,category:["High","Medium","Low"][Math.floor(Math.random()*3)]});return this.setData(i)}setPopulationDensityConfiguration(){return this.setMap("world").setPredefinedPalette("business").setCustomNumberFormatter(0,"en-US").setVisualMapOptions({text:["High Density","Low Density"],orient:"vertical",left:"left",top:"center"})}setEconomicIndicatorsConfiguration(){return this.setMap("world").setPredefinedPalette("finance").setCurrencyFormatter("USD","en-US").setVisualMapOptions({text:["Highest","Lowest"],orient:"horizontal",left:"center",bottom:"10%"})}setRiskAssessmentConfiguration(){return this.setMap("world").setPredefinedPalette("modern").setPercentageFormatter(1).setVisualMapOptions({text:["High Risk","Low Risk"],orient:"vertical",right:"10%",top:"center"})}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>j(k({},l),{name:l.name||"Unknown",value:typeof l.value=="number"?l.value:parseFloat(l.value)||0})));let o=t.chartInstance.getOption(),c=j(k({},o),{series:[j(k({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating density map data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static updateMapSettings(t,e){if(t.chartInstance)try{let i=t.chartInstance.getOption(),n=j(k({},i),{series:i.series?.map(s=>j(k({},s),{zoom:e?.zoom??s.zoom,center:e?.center??s.center,roam:e?.roam??s.roam}))});t.chartInstance.setOption(n,!0)}catch(i){console.error("Error updating density map settings:",i)}}static isDensityMap(t){return ye.isChartType(t,"map")}static isDensityMapEnhanced(t){if(ye.isChartType(t,"map"))return!0;let e=t.config?.options;if(e?.series?.[0]){let i=e.series[0];return i.type==="map"||i.map!==void 0}return!!e?.visualMap}static getDefaultData(){return[{name:"United States",value:100},{name:"China",value:85},{name:"Japan",value:70},{name:"Germany",value:65},{name:"United Kingdom",value:60},{name:"France",value:55},{name:"Canada",value:50},{name:"Australia",value:45},{name:"Brazil",value:40},{name:"India",value:35}]}static exportData(t){let e=t.config?.options?.series?.[0];return e?.data?e.data.map(i=>[i.name||"Unknown Region",i.value||0]):[]}static getExportHeaders(t){return["Region","Value"]}static getExportSheetName(t){return(t.config?.header?.title||"Sheet").replace(/[^\w\s]/gi,"").substring(0,31).trim()}static createDensityMapWidget(t,e){let i=r.create();return t&&i.setData(t),e&&i.setMap(e),i.getWidgetBuilder()}calculateMapCenter(t,e){let[i,n]=Jl.WORLD,s=t/e,a=s>1?(s-1)*5:0,o=s<1?(1/s-1)*2:0;return[i+a,n+o]}calculateMapZoom(t,e){let n=t*e,s=Math.log(n)/Math.log(2),a=t/e,o=Math.abs(1-a)*.5;return 4-s*.1-o}};var rc=["*"];function Cf(r,t){if(r&1&&xe(0,"div",0),r&2){let e=t.$index,i=I();M("ngStyle",i.gridRenderer.getGridColumnStyle(e))}}function bf(r,t){if(r&1&&xe(0,"div",1),r&2){let e=t.$index,i=I();M("ngStyle",i.gridRenderer.getGridRowStyle(e))}}function Tf(r,t){if(r&1){let e=Te();U(0,"div",8),me("mousedown",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))})("touchstart",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))}),G()}}function Sf(r,t){if(r&1){let e=Te();U(0,"div",9),me("mousedown",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))})("touchstart",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))}),G()}}function Ef(r,t){if(r&1){let e=Te();U(0,"div",10),me("mousedown",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))})("touchstart",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))}),G()}}function kf(r,t){if(r&1){let e=Te();U(0,"div",11),me("mousedown",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))})("touchstart",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))}),G()}}function If(r,t){if(r&1){let e=Te();U(0,"div",12),me("mousedown",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))})("touchstart",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))}),G()}}function Ff(r,t){if(r&1){let e=Te();U(0,"div",13),me("mousedown",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))})("touchstart",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))}),G()}}function Of(r,t){if(r&1){let e=Te();U(0,"div",14),me("mousedown",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))})("touchstart",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))}),G()}}function Af(r,t){if(r&1){let e=Te();U(0,"div",15),me("mousedown",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))})("touchstart",function(n){te(e);let s=I();return re(s.resize.dragStartDelay(n))}),G()}}var Ae=function(r){return r.Fit="fit",r.ScrollVertical="scrollVertical",r.ScrollHorizontal="scrollHorizontal",r.Fixed="fixed",r.VerticalFixed="verticalFixed",r.HorizontalFixed="horizontalFixed",r}(Ae||{}),pi=function(r){return r.Always="always",r.OnDragAndResize="onDrag&Resize",r.None="none",r}(pi||{}),Qe=function(r){return r.None="none",r.CompactUp="compactUp",r.CompactLeft="compactLeft",r.CompactUpAndLeft="compactUp&Left",r.CompactLeftAndUp="compactLeft&Up",r.CompactRight="compactRight",r.CompactUpAndRight="compactUp&Right",r.CompactRightAndUp="compactRight&Up",r.CompactDown="compactDown",r.CompactDownAndLeft="compactDown&Left",r.CompactLeftAndDown="compactLeft&Down",r.CompactDownAndRight="compactDown&Right",r.CompactRightAndDown="compactRight&Down",r}(Qe||{}),Ot=function(r){return r.LTR="ltr",r.RTL="rtl",r}(Ot||{}),qa=class{gridster;constructor(t){this.gridster=t}destroy(){this.gridster=null}checkCompact(){this.gridster.$options.compactType!==Qe.None&&(this.gridster.$options.compactType===Qe.CompactUp?this.checkCompactMovement("y",-1):this.gridster.$options.compactType===Qe.CompactLeft?this.checkCompactMovement("x",-1):this.gridster.$options.compactType===Qe.CompactUpAndLeft?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===Qe.CompactLeftAndUp?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===Qe.CompactRight?this.checkCompactMovement("x",1):this.gridster.$options.compactType===Qe.CompactUpAndRight?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===Qe.CompactRightAndUp?(this.checkCompactMovement("x",1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===Qe.CompactDown?this.checkCompactMovement("y",1):this.gridster.$options.compactType===Qe.CompactDownAndLeft?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===Qe.CompactDownAndRight?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===Qe.CompactLeftAndDown?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",1)):this.gridster.$options.compactType===Qe.CompactRightAndDown&&(this.checkCompactMovement("x",1),this.checkCompactMovement("y",1)))}checkCompactItem(t){this.gridster.$options.compactType!==Qe.None&&(this.gridster.$options.compactType===Qe.CompactUp?this.moveTillCollision(t,"y",-1):this.gridster.$options.compactType===Qe.CompactLeft?this.moveTillCollision(t,"x",-1):this.gridster.$options.compactType===Qe.CompactUpAndLeft?(this.moveTillCollision(t,"y",-1),this.moveTillCollision(t,"x",-1)):this.gridster.$options.compactType===Qe.CompactLeftAndUp?(this.moveTillCollision(t,"x",-1),this.moveTillCollision(t,"y",-1)):this.gridster.$options.compactType===Qe.CompactUpAndRight?(this.moveTillCollision(t,"y",-1),this.moveTillCollision(t,"x",1)):this.gridster.$options.compactType===Qe.CompactDown?this.moveTillCollision(t,"y",1):this.gridster.$options.compactType===Qe.CompactDownAndLeft?(this.moveTillCollision(t,"y",1),this.moveTillCollision(t,"x",-1)):this.gridster.$options.compactType===Qe.CompactLeftAndDown?(this.moveTillCollision(t,"x",-1),this.moveTillCollision(t,"y",1)):this.gridster.$options.compactType===Qe.CompactDownAndRight?(this.moveTillCollision(t,"y",1),this.moveTillCollision(t,"x",1)):this.gridster.$options.compactType===Qe.CompactRightAndDown&&(this.moveTillCollision(t,"x",1),this.moveTillCollision(t,"y",1)))}checkCompactMovement(t,e){let i=!1;this.gridster.grid.forEach(n=>{n.$item.compactEnabled!==!1&&this.moveTillCollision(n.$item,t,e)&&(i=!0,n.item[t]=n.$item[t],n.itemChanged())}),i&&this.checkCompact()}moveTillCollision(t,e,i){return t[e]+=i,this.gridster.checkCollision(t)?(t[e]-=i,!1):(this.moveTillCollision(t,e,i),!0)}},Df={gridType:Ae.Fit,scale:1,fixedColWidth:250,fixedRowHeight:250,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,setGridSize:!1,compactType:Qe.None,mobileBreakpoint:640,useBodyForBreakpoint:!1,allowMultiLayer:!1,defaultLayerIndex:0,maxLayerIndex:2,baseLayerIndex:1,minCols:1,maxCols:100,minRows:1,maxRows:100,defaultItemCols:1,defaultItemRows:1,maxItemCols:50,maxItemRows:50,minItemCols:1,minItemRows:1,minItemArea:1,maxItemArea:2500,addEmptyRowsCount:0,rowHeightRatio:1,margin:10,outerMargin:!0,outerMarginTop:null,outerMarginRight:null,outerMarginBottom:null,outerMarginLeft:null,useTransformPositioning:!0,scrollSensitivity:10,scrollSpeed:20,initCallback:void 0,destroyCallback:void 0,gridSizeChangedCallback:void 0,itemChangeCallback:void 0,itemResizeCallback:void 0,itemInitCallback:void 0,itemRemovedCallback:void 0,itemValidateCallback:void 0,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,enableOccupiedCellDrop:!1,emptyCellClickCallback:void 0,emptyCellContextMenuCallback:void 0,emptyCellDropCallback:void 0,emptyCellDragCallback:void 0,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,draggable:{delayStart:0,enabled:!1,ignoreContentClass:"gridster-item-content",ignoreContent:!1,dragHandleClass:"drag-handler",stop:void 0,start:void 0,dropOverItems:!1,dropOverItemsCallback:void 0},resizable:{delayStart:0,enabled:!1,handles:{s:!0,e:!0,n:!0,w:!0,se:!0,ne:!0,sw:!0,nw:!0},stop:void 0,start:void 0},swap:!0,swapWhileDragging:!1,pushItems:!1,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushResizeItems:!1,displayGrid:pi.OnDragAndResize,disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1,disableScrollHorizontal:!1,disableScrollVertical:!1,enableBoundaryControl:!1,disableAutoPositionOnConflict:!1,dirType:Ot.LTR},Bt=class r{static merge(t,e,i){for(let n in e)e[n]!==void 0&&i.hasOwnProperty(n)&&(typeof e[n]=="object"?(n in t||(t[n]={}),t[n]=r.merge(t[n],e[n],i[n])):t[n]=e[n]);return t}static checkTouchEvent(t){t.clientX===void 0&&t.touches&&(t.touches&&t.touches.length?(t.clientX=t.touches[0].clientX,t.clientY=t.touches[0].clientY):t.changedTouches&&t.changedTouches.length&&(t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY))}static checkContentClassForEvent(t,e){if(t.$options.draggable.ignoreContent){if(!r.checkDragHandleClass(e.target,e.currentTarget,t.$options.draggable.dragHandleClass,t.$options.draggable.ignoreContentClass))return!0}else if(r.checkContentClass(e.target,e.currentTarget,t.$options.draggable.ignoreContentClass))return!0;return!1}static checkContentClassForEmptyCellClickEvent(t,e){return r.checkContentClass(e.target,e.currentTarget,t.$options.draggable.ignoreContentClass)||r.checkContentClass(e.target,e.currentTarget,t.$options.draggable.dragHandleClass)}static checkDragHandleClass(t,e,i,n){if(!t||t===e)return!1;if(t.hasAttribute("class")){let s=t.getAttribute("class").split(" ");if(s.indexOf(i)>-1)return!0;if(s.indexOf(n)>-1)return!1}return r.checkDragHandleClass(t.parentNode,e,i,n)}static checkContentClass(t,e,i){return!t||t===e?!1:t.hasAttribute("class")&&t.getAttribute("class").split(" ").indexOf(i)>-1?!0:r.checkContentClass(t.parentNode,e,i)}static compareItems(t,e){return t.y>e.y?-1:t.y<e.y?1:t.x>e.x?-1:1}},Qa=class{gridster;initialItem;removeEmptyCellClickListenerFn;removeEmptyCellTouchendListenerFn;removeEmptyCellContextMenuListenerFn;removeEmptyCellDropListenerFn;removeEmptyCellMousedownListenerFn;removeEmptyCellTouchstartListenerFn;removeWindowMousemoveListenerFn;removeWindowTouchmoveListenerFn;removeWindowMouseupListenerFn;removeWindowTouchendListenerFn;removeEmptyCellDragoverListenerFn;removeDocumentDragendListenerFn;constructor(t){this.gridster=t}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(),this.gridster.movingItem=null,this.initialItem=this.gridster=null,this.removeDocumentDragendListenerFn&&(this.removeDocumentDragendListenerFn(),this.removeDocumentDragendListenerFn=null)}updateOptions(){this.gridster.$options.enableEmptyCellClick&&!this.removeEmptyCellClickListenerFn&&this.gridster.options.emptyCellClickCallback?(this.removeEmptyCellClickListenerFn=this.gridster.renderer.listen(this.gridster.el,"click",this.emptyCellClickCb),this.removeEmptyCellTouchendListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchend",this.emptyCellClickCb)):!this.gridster.$options.enableEmptyCellClick&&this.removeEmptyCellClickListenerFn&&this.removeEmptyCellTouchendListenerFn&&(this.removeEmptyCellClickListenerFn(),this.removeEmptyCellTouchendListenerFn(),this.removeEmptyCellClickListenerFn=null,this.removeEmptyCellTouchendListenerFn=null),this.gridster.$options.enableEmptyCellContextMenu&&!this.removeEmptyCellContextMenuListenerFn&&this.gridster.options.emptyCellContextMenuCallback?this.removeEmptyCellContextMenuListenerFn=this.gridster.renderer.listen(this.gridster.el,"contextmenu",this.emptyCellContextMenuCb):!this.gridster.$options.enableEmptyCellContextMenu&&this.removeEmptyCellContextMenuListenerFn&&(this.removeEmptyCellContextMenuListenerFn(),this.removeEmptyCellContextMenuListenerFn=null),this.gridster.$options.enableEmptyCellDrop&&!this.removeEmptyCellDropListenerFn&&this.gridster.options.emptyCellDropCallback?(this.removeEmptyCellDropListenerFn=this.gridster.renderer.listen(this.gridster.el,"drop",this.emptyCellDragDrop),this.gridster.zone.runOutsideAngular(()=>{this.removeEmptyCellDragoverListenerFn=this.gridster.renderer.listen(this.gridster.el,"dragover",this.emptyCellDragOver)}),this.removeDocumentDragendListenerFn=this.gridster.renderer.listen("document","dragend",()=>{this.gridster.movingItem=null,this.gridster.previewStyle()})):!this.gridster.$options.enableEmptyCellDrop&&this.removeEmptyCellDropListenerFn&&this.removeEmptyCellDragoverListenerFn&&this.removeDocumentDragendListenerFn&&(this.removeEmptyCellDropListenerFn(),this.removeEmptyCellDragoverListenerFn(),this.removeDocumentDragendListenerFn(),this.removeEmptyCellDragoverListenerFn=null,this.removeEmptyCellDropListenerFn=null,this.removeDocumentDragendListenerFn=null),this.gridster.$options.enableEmptyCellDrag&&!this.removeEmptyCellMousedownListenerFn&&this.gridster.options.emptyCellDragCallback?(this.removeEmptyCellMousedownListenerFn=this.gridster.renderer.listen(this.gridster.el,"mousedown",this.emptyCellMouseDown),this.removeEmptyCellTouchstartListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchstart",this.emptyCellMouseDown)):!this.gridster.$options.enableEmptyCellDrag&&this.removeEmptyCellMousedownListenerFn&&this.removeEmptyCellTouchstartListenerFn&&(this.removeEmptyCellMousedownListenerFn(),this.removeEmptyCellTouchstartListenerFn(),this.removeEmptyCellMousedownListenerFn=null,this.removeEmptyCellTouchstartListenerFn=null)}emptyCellClickCb=t=>{if(!this.gridster||this.gridster.movingItem||Bt.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;let e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellClickCallback&&this.gridster.options.emptyCellClickCallback(t,e),this.gridster.cdRef.markForCheck())};emptyCellContextMenuCb=t=>{if(this.gridster.movingItem||Bt.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellContextMenuCallback&&this.gridster.options.emptyCellContextMenuCallback(t,e),this.gridster.cdRef.markForCheck())};emptyCellDragDrop=t=>{let e=this.getValidItemFromEvent(t);e&&(this.gridster.options.emptyCellDropCallback&&this.gridster.options.emptyCellDropCallback(t,e),this.gridster.cdRef.markForCheck())};emptyCellDragOver=t=>{t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t);e?(t.dataTransfer&&(t.dataTransfer.dropEffect="move"),this.gridster.movingItem=e):(t.dataTransfer&&(t.dataTransfer.dropEffect="none"),this.gridster.movingItem=null),this.gridster.previewStyle()};emptyCellMouseDown=t=>{if(Bt.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t);!e||t.buttons!==1&&!(t instanceof TouchEvent)||(this.initialItem=e,this.gridster.movingItem=e,this.gridster.previewStyle(),this.gridster.zone.runOutsideAngular(()=>{this.removeWindowMousemoveListenerFn=this.gridster.renderer.listen("window","mousemove",this.emptyCellMouseMove),this.removeWindowTouchmoveListenerFn=this.gridster.renderer.listen("window","touchmove",this.emptyCellMouseMove)}),this.removeWindowMouseupListenerFn=this.gridster.renderer.listen("window","mouseup",this.emptyCellMouseUp),this.removeWindowTouchendListenerFn=this.gridster.renderer.listen("window","touchend",this.emptyCellMouseUp))};emptyCellMouseMove=t=>{t.preventDefault(),t.stopPropagation();let e=this.getValidItemFromEvent(t,this.initialItem);e&&(this.gridster.movingItem=e,this.gridster.previewStyle())};emptyCellMouseUp=t=>{this.removeWindowMousemoveListenerFn(),this.removeWindowTouchmoveListenerFn(),this.removeWindowMouseupListenerFn(),this.removeWindowTouchendListenerFn();let e=this.getValidItemFromEvent(t,this.initialItem);e&&(this.gridster.movingItem=e),this.gridster.options.emptyCellDragCallback&&this.gridster.movingItem&&this.gridster.options.emptyCellDragCallback(t,this.gridster.movingItem),setTimeout(()=>{this.initialItem=null,this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())}),this.gridster.cdRef.markForCheck()};getPixelsX(t,e){let i=this.gridster.options.scale;return i?(t.clientX-e.left)/i+this.gridster.el.scrollLeft-this.gridster.gridRenderer.getLeftMargin():t.clientX+this.gridster.el.scrollLeft-e.left-this.gridster.gridRenderer.getLeftMargin()}getPixelsY(t,e){let i=this.gridster.options.scale;return i?(t.clientY-e.top)/i+this.gridster.el.scrollTop-this.gridster.gridRenderer.getTopMargin():t.clientY+this.gridster.el.scrollTop-e.top-this.gridster.gridRenderer.getTopMargin()}getValidItemFromEvent(t,e){t.preventDefault(),t.stopPropagation(),Bt.checkTouchEvent(t);let i=this.gridster.el.getBoundingClientRect(),n=this.getPixelsX(t,i),s=this.getPixelsY(t,i),a={x:this.gridster.pixelsToPositionX(n,Math.floor,!0),y:this.gridster.pixelsToPositionY(s,Math.floor,!0),cols:this.gridster.$options.defaultItemCols,rows:this.gridster.$options.defaultItemRows};if(e&&(a.cols=Math.min(Math.abs(e.x-a.x)+1,this.gridster.$options.emptyCellDragMaxCols),a.rows=Math.min(Math.abs(e.y-a.y)+1,this.gridster.$options.emptyCellDragMaxRows),e.x<a.x?a.x=e.x:e.x-a.x>this.gridster.$options.emptyCellDragMaxCols-1&&(a.x=this.gridster.movingItem?this.gridster.movingItem.x:0),e.y<a.y?a.y=e.y:e.y-a.y>this.gridster.$options.emptyCellDragMaxRows-1&&(a.y=this.gridster.movingItem?this.gridster.movingItem.y:0)),!(!this.gridster.$options.enableOccupiedCellDrop&&this.gridster.checkCollision(a)))return a}},Za=class{gridster;lastGridColumnStyles={};lastGridRowStyles={};constructor(t){this.gridster=t}destroy(){this.gridster=null}updateItem(t,e,i){if(this.gridster.mobile)this.clearCellPosition(i,t),this.gridster.$options.keepFixedHeightInMobile?i.setStyle(t,"height",(e.rows-1)*this.gridster.$options.margin+e.rows*this.gridster.$options.fixedRowHeight+"px"):i.setStyle(t,"height",e.rows*this.gridster.curWidth/e.cols+"px"),this.gridster.$options.keepFixedWidthInMobile?i.setStyle(t,"width",this.gridster.$options.fixedColWidth+"px"):i.setStyle(t,"width",""),i.setStyle(t,"margin-bottom",this.gridster.$options.margin+"px"),i.setStyle(t,Ot.LTR?"margin-right":"margin-left","");else{let n=Math.round(this.gridster.curColWidth*e.x),s=Math.round(this.gridster.curRowHeight*e.y),a=this.gridster.curColWidth*e.cols-this.gridster.$options.margin,o=this.gridster.curRowHeight*e.rows-this.gridster.$options.margin;this.setCellPosition(i,t,n,s),i.setStyle(t,"width",a+"px"),i.setStyle(t,"height",o+"px");let c=null,l=null;this.gridster.$options.outerMargin&&(this.gridster.rows===e.rows+e.y&&(this.gridster.$options.outerMarginBottom!==null?c=this.gridster.$options.outerMarginBottom+"px":c=this.gridster.$options.margin+"px"),this.gridster.columns===e.cols+e.x&&(this.gridster.$options.outerMarginBottom!==null?l=this.gridster.$options.outerMarginRight+"px":l=this.gridster.$options.margin+"px")),i.setStyle(t,"margin-bottom",c),i.setStyle(t,Ot.LTR?"margin-right":"margin-left",l)}}updateGridster(){let t="",e="",i="",n="";if(this.gridster.$options.gridType===Ae.Fit)t=Ae.Fit,e=Ae.ScrollVertical,i=Ae.ScrollHorizontal,n=Ae.Fixed;else if(this.gridster.$options.gridType===Ae.ScrollVertical)this.gridster.curRowHeight=this.gridster.curColWidth*this.gridster.$options.rowHeightRatio,t=Ae.ScrollVertical,e=Ae.Fit,i=Ae.ScrollHorizontal,n=Ae.Fixed;else if(this.gridster.$options.gridType===Ae.ScrollHorizontal){let s=this.gridster.$options.rowHeightRatio,a=s>=1?s:s+1;this.gridster.curColWidth=this.gridster.curRowHeight*a,t=Ae.ScrollHorizontal,e=Ae.Fit,i=Ae.ScrollVertical,n=Ae.Fixed}else this.gridster.$options.gridType===Ae.Fixed?(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),t=Ae.Fixed,e=Ae.Fit,i=Ae.ScrollVertical,n=Ae.ScrollHorizontal):this.gridster.$options.gridType===Ae.VerticalFixed?(this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),t=Ae.ScrollVertical,e=Ae.Fit,i=Ae.ScrollHorizontal,n=Ae.Fixed):this.gridster.$options.gridType===Ae.HorizontalFixed&&(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),t=Ae.ScrollHorizontal,e=Ae.Fit,i=Ae.ScrollVertical,n=Ae.Fixed);this.gridster.mobile||this.gridster.$options.setGridSize&&this.gridster.$options.gridType!==Ae.Fit?this.gridster.renderer.removeClass(this.gridster.el,t):this.gridster.renderer.addClass(this.gridster.el,t),this.gridster.renderer.removeClass(this.gridster.el,e),this.gridster.renderer.removeClass(this.gridster.el,i),this.gridster.renderer.removeClass(this.gridster.el,n)}getGridColumnStyle(t){let e={left:this.gridster.curColWidth*t,width:this.gridster.curColWidth-this.gridster.$options.margin,height:this.gridster.gridRows.length*this.gridster.curRowHeight-this.gridster.$options.margin,style:{}};e.style=j(k({},this.getLeftPosition(e.left)),{width:e.width+"px",height:e.height+"px"});let i=this.lastGridColumnStyles[t];return i&&i.left===e.left&&i.width===e.width&&i.height===e.height?i.style:(this.lastGridColumnStyles[t]=e,e.style)}getGridRowStyle(t){let e={top:this.gridster.curRowHeight*t,width:this.gridster.gridColumns.length*this.gridster.curColWidth+this.gridster.$options.margin,height:this.gridster.curRowHeight-this.gridster.$options.margin,style:{}};e.style=j(k({},this.getTopPosition(e.top)),{width:e.width+"px",height:e.height+"px"});let i=this.lastGridRowStyles[t];return i&&i.top===e.top&&i.width===e.width&&i.height===e.height?i.style:(this.lastGridRowStyles[t]=e,e.style)}getLeftPosition(t){let e=this.gridster.$options.dirType===Ot.RTL?-t:t;return this.gridster.$options.useTransformPositioning?{transform:"translateX("+e+"px)"}:{left:this.getLeftMargin()+e+"px"}}getTopPosition(t){return this.gridster.$options.useTransformPositioning?{transform:"translateY("+t+"px)"}:{top:this.getTopMargin()+t+"px"}}clearCellPosition(t,e){this.gridster.$options.useTransformPositioning?t.setStyle(e,"transform",""):(t.setStyle(e,"top",""),t.setStyle(e,"left",""))}setCellPosition(t,e,i,n){let s=this.gridster.$options.dirType===Ot.RTL?-i:i;if(this.gridster.$options.useTransformPositioning){let a="translate3d("+s+"px, "+n+"px, 0)";t.setStyle(e,"transform",a)}else t.setStyle(e,"left",this.getLeftMargin()+s+"px"),t.setStyle(e,"top",this.getTopMargin()+n+"px")}getLeftMargin(){return this.gridster.$options.outerMargin?this.gridster.$options.outerMarginLeft!==null?this.gridster.$options.outerMarginLeft:this.gridster.$options.margin:0}getTopMargin(){return this.gridster.$options.outerMargin?this.gridster.$options.outerMarginTop!==null?this.gridster.$options.outerMarginTop:this.gridster.$options.margin:0}},Mf=(()=>{class r{renderer;previewStyle$;gridRenderer;el;sub;constructor(e,i){this.renderer=i,this.el=e.nativeElement}ngOnInit(){this.sub=this.previewStyle$.subscribe(e=>this.previewStyle(e))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}previewStyle(e){e?(this.renderer.setStyle(this.el,"display","block"),this.gridRenderer.updateItem(this.el,e,this.renderer)):this.renderer.setStyle(this.el,"display","")}static \u0275fac=function(i){return new(i||r)(Ke(Yr),Ke(Ei))};static \u0275cmp=Me({type:r,selectors:[["gridster-preview"]],inputs:{previewStyle$:"previewStyle$",gridRenderer:"gridRenderer"},decls:0,vars:0,template:function(i,n){},styles:[`gridster-preview{position:absolute;display:none;background:#00000026}
`],encapsulation:2})}return r})(),Rs=(()=>{class r{renderer;cdRef;zone;options;movingItem;el;$options;mobile;curWidth;curHeight;grid;columns=0;rows=0;curColWidth;curRowHeight;gridColumns=[];gridRows=[];windowResize;dragInProgress;emptyCell;compact;gridRenderer;previewStyle$=new Ce;calculateLayout$=new Yi;resize$=new Yi;destroy$=new Yi;constructor(e,i,n,s){this.renderer=i,this.cdRef=n,this.zone=s,this.el=e.nativeElement,this.$options=JSON.parse(JSON.stringify(Df)),this.mobile=!1,this.curWidth=0,this.curHeight=0,this.grid=[],this.curColWidth=0,this.curRowHeight=0,this.dragInProgress=!1,this.emptyCell=new Qa(this),this.compact=new qa(this),this.gridRenderer=new Za(this)}static checkCollisionTwoItemsForSwaping(e,i){let n=e.cols===1?0:1,s=i.cols===1?0:1,a=e.rows===1?0:1,o=i.rows===1?0:1;return e.x+n<i.x+i.cols&&e.x+e.cols>i.x+s&&e.y+a<i.y+i.rows&&e.y+e.rows>i.y+o}checkCollisionTwoItems(e,i){if(!(e.x<i.x+i.cols&&e.x+e.cols>i.x&&e.y<i.y+i.rows&&e.y+e.rows>i.y))return!1;if(!this.$options.allowMultiLayer)return!0;let s=this.$options.defaultLayerIndex,a=e.layerIndex===void 0?s:e.layerIndex,o=i.layerIndex===void 0?s:i.layerIndex;return a===o}ngOnInit(){this.options.initCallback&&this.options.initCallback(this),this.calculateLayout$.pipe(hl(0),Rn(this.destroy$)).subscribe(()=>this.calculateLayout()),this.resize$.pipe(xs(()=>cl(100)),Rn(this.destroy$)).subscribe(()=>this.resize())}ngOnChanges(e){e.options&&(this.setOptions(),this.options.api={optionsChanged:this.optionsChanged,resize:this.onResize,getNextPossiblePosition:this.getNextPossiblePosition,getFirstPossiblePosition:this.getFirstPossiblePosition,getLastPossiblePosition:this.getLastPossiblePosition,getItemComponent:i=>this.getItemComponent(i)},this.columns=this.$options.minCols,this.rows=this.$options.minRows+this.$options.addEmptyRowsCount,this.setGridSize(),this.calculateLayout())}resize(){let e,i;this.$options.gridType==="fit"&&!this.mobile?(i=this.el.offsetWidth,e=this.el.offsetHeight):(i=this.el.clientWidth,e=this.el.clientHeight),(i!==this.curWidth||e!==this.curHeight)&&this.checkIfToResize()&&this.onResize()}setOptions(){this.$options=Bt.merge(this.$options,this.options,this.$options),!this.$options.disableWindowResize&&!this.windowResize?this.windowResize=this.renderer.listen("window","resize",this.onResize):this.$options.disableWindowResize&&this.windowResize&&(this.windowResize(),this.windowResize=null),this.emptyCell.updateOptions()}optionsChanged=()=>{this.setOptions();let e=this.grid.length-1,i;for(;e>=0;e--)i=this.grid[e],i.updateOptions();this.calculateLayout()};ngOnDestroy(){this.destroy$.next(),this.previewStyle$.complete(),this.windowResize&&this.windowResize(),this.options&&this.options.destroyCallback&&this.options.destroyCallback(this),this.options&&this.options.api&&(this.options.api.resize=void 0,this.options.api.optionsChanged=void 0,this.options.api.getNextPossiblePosition=void 0,this.options.api=void 0),this.emptyCell.destroy(),this.emptyCell=null,this.compact.destroy(),this.compact=null}onResize=()=>{this.el.clientWidth&&(this.options.setGridSize&&(this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.setGridSize(),this.calculateLayout())};checkIfToResize(){let e=this.el.clientWidth,i=this.el.offsetWidth,n=this.el.scrollWidth,s=this.el.clientHeight,a=this.el.offsetHeight,o=this.el.scrollHeight,c=e<i&&o>a&&o-a<i-e,l=s<a&&n>i&&n-i<a-s;return c?!1:!l}checkIfMobile(){return this.$options.useBodyForBreakpoint?this.$options.mobileBreakpoint>document.body.clientWidth:this.$options.mobileBreakpoint>this.curWidth}setGridSize(){let e=this.el,i,n;this.$options.setGridSize||this.$options.gridType===Ae.Fit&&!this.mobile?(i=e.offsetWidth,n=e.offsetHeight):(i=e.clientWidth,n=e.clientHeight),this.curWidth=i,this.curHeight=n}setGridDimensions(){this.setGridSize(),!this.mobile&&this.checkIfMobile()?(this.mobile=!this.mobile,this.renderer.addClass(this.el,"mobile")):this.mobile&&!this.checkIfMobile()&&(this.mobile=!this.mobile,this.renderer.removeClass(this.el,"mobile"));let e=this.$options.minRows,i=this.$options.minCols,n=this.grid.length-1,s;for(;n>=0;n--)s=this.grid[n],s.notPlaced||(e=Math.max(e,s.$item.y+s.$item.rows),i=Math.max(i,s.$item.x+s.$item.cols));e+=this.$options.addEmptyRowsCount,(this.columns!==i||this.rows!==e)&&(this.columns=i,this.rows=e,this.options.gridSizeChangedCallback&&this.options.gridSizeChangedCallback(this))}calculateLayout(){if(this.compact&&this.compact.checkCompact(),this.setGridDimensions(),this.$options.outerMargin){let n=-this.$options.margin;this.$options.outerMarginLeft!==null?(n+=this.$options.outerMarginLeft,this.renderer.setStyle(this.el,"padding-left",this.$options.outerMarginLeft+"px")):(n+=this.$options.margin,this.renderer.setStyle(this.el,"padding-left",this.$options.margin+"px")),this.$options.outerMarginRight!==null?(n+=this.$options.outerMarginRight,this.renderer.setStyle(this.el,"padding-right",this.$options.outerMarginRight+"px")):(n+=this.$options.margin,this.renderer.setStyle(this.el,"padding-right",this.$options.margin+"px")),this.curColWidth=(this.curWidth-n)/this.columns;let s=-this.$options.margin;this.$options.outerMarginTop!==null?(s+=this.$options.outerMarginTop,this.renderer.setStyle(this.el,"padding-top",this.$options.outerMarginTop+"px")):(s+=this.$options.margin,this.renderer.setStyle(this.el,"padding-top",this.$options.margin+"px")),this.$options.outerMarginBottom!==null?(s+=this.$options.outerMarginBottom,this.renderer.setStyle(this.el,"padding-bottom",this.$options.outerMarginBottom+"px")):(s+=this.$options.margin,this.renderer.setStyle(this.el,"padding-bottom",this.$options.margin+"px")),this.curRowHeight=(this.curHeight-s)/this.rows*this.$options.rowHeightRatio}else this.curColWidth=(this.curWidth+this.$options.margin)/this.columns,this.curRowHeight=(this.curHeight+this.$options.margin)/this.rows*this.$options.rowHeightRatio,this.renderer.setStyle(this.el,"padding-left","0px"),this.renderer.setStyle(this.el,"padding-right","0px"),this.renderer.setStyle(this.el,"padding-top","0px"),this.renderer.setStyle(this.el,"padding-bottom","0px");this.gridRenderer.updateGridster(),this.$options.setGridSize?(this.renderer.addClass(this.el,"gridSize"),this.mobile||(this.renderer.setStyle(this.el,"width",this.columns*this.curColWidth+this.$options.margin+"px"),this.renderer.setStyle(this.el,"height",this.rows*this.curRowHeight+this.$options.margin+"px"))):(this.renderer.removeClass(this.el,"gridSize"),this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.updateGrid();let e=this.grid.length-1,i;for(;e>=0;e--)i=this.grid[e],i.setSize(),i.drag.toggle(),i.resize.toggle();this.resize$.next()}updateGrid(){this.$options.displayGrid==="always"&&!this.mobile?this.renderer.addClass(this.el,"display-grid"):this.$options.displayGrid==="onDrag&Resize"&&this.dragInProgress?this.renderer.addClass(this.el,"display-grid"):(this.$options.displayGrid==="none"||!this.dragInProgress||this.mobile)&&this.renderer.removeClass(this.el,"display-grid"),this.setGridDimensions(),this.gridColumns.length=r.getNewArrayLength(this.columns,this.curWidth,this.curColWidth),this.gridRows.length=r.getNewArrayLength(this.rows,this.curHeight,this.curRowHeight),this.cdRef.markForCheck()}addItem(e){e.$item.cols===void 0&&(e.$item.cols=this.$options.defaultItemCols,e.item.cols=e.$item.cols,e.itemChanged()),e.$item.rows===void 0&&(e.$item.rows=this.$options.defaultItemRows,e.item.rows=e.$item.rows,e.itemChanged()),e.$item.x===-1||e.$item.y===-1?this.autoPositionItem(e):this.checkCollision(e.$item)&&(this.$options.disableWarnings||(e.notPlaced=!0,console.warn("Can't be placed in the bounds of the dashboard, trying to auto position!/n"+JSON.stringify(e.item,["cols","rows","x","y"]))),this.$options.disableAutoPositionOnConflict?e.notPlaced=!0:this.autoPositionItem(e)),this.grid.push(e),this.calculateLayout$.next()}removeItem(e){this.grid.splice(this.grid.indexOf(e),1),this.calculateLayout$.next(),this.options.itemRemovedCallback&&this.options.itemRemovedCallback(e.item,e)}checkCollision(e){let i=!1;if(this.options.itemValidateCallback&&(i=!this.options.itemValidateCallback(e)),!i&&this.checkGridCollision(e)&&(i=!0),!i){let n=this.findItemWithItem(e);n&&(i=n)}return i}checkGridCollision(e){let i=e.y>-1&&e.x>-1,n=e.cols+e.x<=this.$options.maxCols,s=e.rows+e.y<=this.$options.maxRows,a=e.maxItemCols===void 0?this.$options.maxItemCols:e.maxItemCols,o=e.minItemCols===void 0?this.$options.minItemCols:e.minItemCols,c=e.maxItemRows===void 0?this.$options.maxItemRows:e.maxItemRows,l=e.minItemRows===void 0?this.$options.minItemRows:e.minItemRows,h=e.cols<=a&&e.cols>=o,f=e.rows<=c&&e.rows>=l,u=e.minItemArea===void 0?this.$options.minItemArea:e.minItemArea,d=e.maxItemArea===void 0?this.$options.maxItemArea:e.maxItemArea,g=e.cols*e.rows,p=u<=g,x=d>=g;return!(i&&n&&s&&h&&f&&p&&x)}findItemWithItem(e){let i=0,n;for(;i<this.grid.length;i++)if(n=this.grid[i],n.$item!==e&&this.checkCollisionTwoItems(n.$item,e))return n;return!1}findItemsWithItem(e){let i=[],n=0,s;for(;n<this.grid.length;n++)s=this.grid[n],s.$item!==e&&this.checkCollisionTwoItems(s.$item,e)&&i.push(s);return i}autoPositionItem(e){this.getNextPossiblePosition(e.$item)?(e.notPlaced=!1,e.item.x=e.$item.x,e.item.y=e.$item.y,e.itemChanged()):(e.notPlaced=!0,this.$options.disableWarnings||console.warn("Can't be placed in the bounds of the dashboard!/n"+JSON.stringify(e.item,["cols","rows","x","y"])))}getNextPossiblePosition=(e,i={})=>{e.cols===-1&&(e.cols=this.$options.defaultItemCols),e.rows===-1&&(e.rows=this.$options.defaultItemRows),this.setGridDimensions();let n=i.y||0,s;for(;n<this.rows;n++)for(e.y=n,s=i.x||0;s<this.columns;s++)if(e.x=s,!this.checkCollision(e))return!0;let a=this.$options.maxRows>=this.rows+e.rows,o=this.$options.maxCols>=this.columns+e.cols;return!(this.rows<=this.columns&&a)&&o?(e.x=this.columns,e.y=0,!0):a?(e.y=this.rows,e.x=0,!0):!1};getFirstPossiblePosition=e=>{let i=Object.assign({},e);return this.getNextPossiblePosition(i),i};getLastPossiblePosition=e=>{let i={y:0,x:0};i=this.grid.reduce((s,a)=>{let o={y:a.$item.y+a.$item.rows-1,x:a.$item.x+a.$item.cols-1};return Bt.compareItems(s,o)===1?o:s},i);let n=Object.assign({},e);return this.getNextPossiblePosition(n,i),n};pixelsToPositionX(e,i,n){let s=i(e/this.curColWidth);return n?s:Math.max(s,0)}pixelsToPositionY(e,i,n){let s=i(e/this.curRowHeight);return n?s:Math.max(s,0)}positionXToPixels(e){return e*this.curColWidth}positionYToPixels(e){return e*this.curRowHeight}getItemComponent(e){return this.grid.find(i=>i.item===e)}checkCollisionForSwaping(e){let i=!1;if(this.options.itemValidateCallback&&(i=!this.options.itemValidateCallback(e)),!i&&this.checkGridCollision(e)&&(i=!0),!i){let n=this.findItemWithItemForSwapping(e);n&&(i=n)}return i}findItemWithItemForSwapping(e){let i=this.grid.length-1,n;for(;i>-1;i--)if(n=this.grid[i],n.$item!==e&&r.checkCollisionTwoItemsForSwaping(n.$item,e))return n;return!1}previewStyle(e=!1){this.movingItem?(this.compact&&e&&this.compact.checkCompactItem(this.movingItem),this.previewStyle$.next(this.movingItem)):this.previewStyle$.next(null)}static getNewArrayLength(e,i,n){let s=Math.max(e,Math.floor(i/n));return s<0?0:Number.isFinite(s)?Math.floor(s):0}static \u0275fac=function(i){return new(i||r)(Ke(Yr),Ke(Ei),Ke(qi),Ke(Bn))};static \u0275cmp=Me({type:r,selectors:[["gridster"]],inputs:{options:"options"},features:[Si],ngContentSelectors:rc,decls:6,vars:2,consts:[[1,"gridster-column",3,"ngStyle"],[1,"gridster-row",3,"ngStyle"],[1,"gridster-preview",3,"gridRenderer","previewStyle$"]],template:function(i,n){i&1&&(Fi(),ki(0,Cf,1,1,"div",0,Fa),ki(2,bf,1,1,"div",1,Fa),Kr(4),xe(5,"gridster-preview",2)),i&2&&(Ii(n.gridColumns),A(2),Ii(n.gridRows),A(3),M("gridRenderer",n.gridRenderer)("previewStyle$",n.previewStyle$))},dependencies:[Oi,Mf],styles:[`gridster{position:relative;box-sizing:border-box;background:gray;width:100%;height:100%;-webkit-user-select:none;user-select:none;display:block}gridster.fit{overflow-x:hidden;overflow-y:hidden}gridster.scrollVertical{overflow-x:hidden;overflow-y:auto}gridster.scrollHorizontal{overflow-x:auto;overflow-y:hidden}gridster.fixed{overflow:auto}gridster.mobile{overflow-x:hidden;overflow-y:auto}gridster.mobile gridster-item{position:relative}gridster.gridSize{height:initial;width:initial}gridster.gridSize.fit{height:100%;width:100%}gridster .gridster-column,gridster .gridster-row{position:absolute;display:none;transition:.3s;box-sizing:border-box}gridster.display-grid .gridster-column,gridster.display-grid .gridster-row{display:block}gridster .gridster-column{border-left:1px solid white;border-right:1px solid white}gridster .gridster-row{border-top:1px solid white;border-bottom:1px solid white}
`],encapsulation:2})}return r})(),Ls=class{fromSouth;fromNorth;fromEast;fromWest;pushedItems;pushedItemsTemp;pushedItemsTempPath;pushedItemsPath;gridsterItem;gridster;pushedItemsOrder;tryPattern;iteration=0;constructor(t){this.pushedItems=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],this.pushedItemsPath=[],this.gridsterItem=t,this.gridster=t.gridster,this.tryPattern={fromEast:[this.tryWest,this.trySouth,this.tryNorth,this.tryEast],fromWest:[this.tryEast,this.trySouth,this.tryNorth,this.tryWest],fromNorth:[this.trySouth,this.tryEast,this.tryWest,this.tryNorth],fromSouth:[this.tryNorth,this.tryEast,this.tryWest,this.trySouth]},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(t,e){if(this.gridster.$options.pushItems&&!e){this.pushedItemsOrder=[],this.iteration=0;let i=this.push(this.gridsterItem,t);return i||this.restoreTempItems(),this.pushedItemsOrder=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],i}else return!1}restoreTempItems(){let t=this.pushedItemsTemp.length-1;for(;t>-1;t--)this.removeFromTempPushed(this.pushedItemsTemp[t])}restoreItems(){let t=0,e=this.pushedItems.length,i;for(;t<e;t++)i=this.pushedItems[t],i.$item.x=i.item.x||0,i.$item.y=i.item.y||0,i.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let t=0,e=this.pushedItems.length,i;for(;t<e;t++)i=this.pushedItems[t],i.checkItemChanges(i.$item,i.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let t=this.pushedItems.length-1,e=!1;for(;t>-1;t--)this.checkPushedItem(this.pushedItems[t],t)&&(e=!0);e&&this.checkPushBack()}push(t,e){if(this.iteration>100)return console.warn("max iteration reached"),!1;if(this.gridster.checkGridCollision(t.$item)||e==="")return!1;let i=this.gridster.findItemsWithItem(t.$item),n=e===this.fromNorth||e===this.fromWest;i.sort((l,h)=>n?h.$item.y-l.$item.y||h.$item.x-l.$item.x:l.$item.y-h.$item.y||l.$item.x-h.$item.x);let s=0,a,o=!0,c=[];for(;s<i.length;s++){if(a=i[s],a===this.gridsterItem)continue;if(!a.canBeDragged()){o=!1;break}let l=this.pushedItemsTemp.indexOf(a);if(l>-1&&this.pushedItemsTempPath[l].length>10){o=!1;break}if(this.tryPattern[e][0].call(this,a,t))this.pushedItemsOrder.push(a),c.push(a);else if(this.tryPattern[e][1].call(this,a,t))this.pushedItemsOrder.push(a),c.push(a);else if(this.tryPattern[e][2].call(this,a,t))this.pushedItemsOrder.push(a),c.push(a);else if(this.tryPattern[e][3].call(this,a,t))this.pushedItemsOrder.push(a),c.push(a);else{o=!1;break}}if(!o&&(s=this.pushedItemsOrder.lastIndexOf(c[0]),s>-1)){let l=this.pushedItemsOrder.length-1;for(;l>=s;l--)a=this.pushedItemsOrder[l],this.pushedItemsOrder.pop(),this.removeFromTempPushed(a),this.removeFromPushedItem(a)}return this.iteration++,o}trySouth(t,e){return this.gridster.$options.pushDirections.south?(this.addToTempPushed(t),t.$item.y=e.$item.y+e.$item.rows,this.push(t,this.fromNorth)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1)):!1}tryNorth(t,e){return this.gridster.$options.pushDirections.north?(this.addToTempPushed(t),t.$item.y=e.$item.y-t.$item.rows,this.push(t,this.fromSouth)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1)):!1}tryEast(t,e){return this.gridster.$options.pushDirections.east?(this.addToTempPushed(t),t.$item.x=e.$item.x+e.$item.cols,this.push(t,this.fromWest)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1)):!1}tryWest(t,e){return this.gridster.$options.pushDirections.west?(this.addToTempPushed(t),t.$item.x=e.$item.x-t.$item.cols,this.push(t,this.fromEast)?(t.setSize(),this.addToPushed(t),!0):(this.removeFromTempPushed(t),!1)):!1}addToTempPushed(t){let e=this.pushedItemsTemp.indexOf(t);e===-1&&(e=this.pushedItemsTemp.push(t)-1,this.pushedItemsTempPath[e]=[]),this.pushedItemsTempPath[e].push({x:t.$item.x,y:t.$item.y})}removeFromTempPushed(t){let e=this.pushedItemsTemp.indexOf(t),i=this.pushedItemsTempPath[e].pop();i&&(t.$item.x=i.x,t.$item.y=i.y,t.setSize(),this.pushedItemsTempPath[e].length||(this.pushedItemsTemp.splice(e,1),this.pushedItemsTempPath.splice(e,1)))}addToPushed(t){if(this.pushedItems.indexOf(t)<0)this.pushedItems.push(t),this.pushedItemsPath.push([{x:t.item.x||0,y:t.item.y||0},{x:t.$item.x,y:t.$item.y}]);else{let e=this.pushedItems.indexOf(t);this.pushedItemsPath[e].push({x:t.$item.x,y:t.$item.y})}}removeFromPushed(t){t>-1&&(this.pushedItems.splice(t,1),this.pushedItemsPath.splice(t,1))}removeFromPushedItem(t){let e=this.pushedItems.indexOf(t);e>-1&&(this.pushedItemsPath[e].pop(),this.pushedItemsPath.length||(this.pushedItems.splice(e,1),this.pushedItemsPath.splice(e,1)))}checkPushedItem(t,e){let i=this.pushedItemsPath[e],n=i.length-2,s,a,o,c=!1;for(;n>-1;n--)s=i[n],a=t.$item.x,o=t.$item.y,t.$item.x=s.x,t.$item.y=s.y,this.gridster.findItemWithItem(t.$item)?(t.$item.x=a,t.$item.y=o):(t.setSize(),i.splice(n+1,i.length-n-1),c=!0);return i.length<2&&this.removeFromPushed(e),c}},Vn,Pi,ic=50,br,Un,Zr,zn,Gn,Xn,jn;function nc(r,t,e,i,n,s,a,o,c,l){Vn=r.$options.scrollSensitivity,Pi=r.$options.scrollSpeed,br=r.el,Un=c,Zr=l;let h=br.offsetWidth,f=br.offsetHeight,u=br.scrollLeft,d=br.scrollTop,g=e-d,p=f+d-e-n,{clientX:x,clientY:E}=s;if(!r.$options.disableScrollVertical)if(a.clientY<E&&p<Vn){if(cc(),Un&&Zr&&!Zr.south||jn)return;jn=ec(1,o,a)}else if(a.clientY>E&&d>0&&g<Vn){if(lc(),Un&&Zr&&!Zr.north||Xn)return;Xn=ec(-1,o,a)}else a.clientY!==E&&no();let F=u+h-t-i,O=t-u;if(!r.$options.disableScrollHorizontal)if(a.clientX<x&&F<=Vn){if(oc(),Un&&Zr&&!Zr.east||zn)return;zn=tc(1,o,a)}else if(a.clientX>x&&u>0&&O<Vn){if(ac(),Un&&Zr&&!Zr.west||Gn)return;Gn=tc(-1,o,a)}else a.clientX!==x&&io()}function ec(r,t,e){let i=e.clientY;return window.setInterval(()=>{(!br||r===-1&&br.scrollTop-Pi<0)&&no(),br.scrollTop+=r*Pi,i+=r*Pi,t({clientX:e.clientX,clientY:i})},ic)}function tc(r,t,e){let i=e.clientX;return window.setInterval(()=>{(!br||r===-1&&br.scrollLeft-Pi<0)&&io(),br.scrollLeft+=r*Pi,i+=r*Pi,t({clientX:i,clientY:e.clientY})},ic)}function sc(){io(),no(),br=null}function io(){ac(),oc()}function no(){cc(),lc()}function ac(){zn&&(clearInterval(zn),zn=0)}function oc(){Gn&&(clearInterval(Gn),Gn=0)}function lc(){jn&&(clearInterval(jn),jn=0)}function cc(){Xn&&(clearInterval(Xn),Xn=0)}var Ja=class{swapedItem;gridsterItem;gridster;constructor(t){this.gridsterItem=t,this.gridster=t.gridster}destroy(){this.gridster=this.gridsterItem=this.swapedItem=null}swapItems(){this.gridster.$options.swap&&(this.checkSwapBack(),this.checkSwap(this.gridsterItem))}checkSwapBack(){if(this.swapedItem){let t=this.swapedItem.$item.x,e=this.swapedItem.$item.y;this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.gridster.checkCollision(this.swapedItem.$item)?(this.swapedItem.$item.x=t,this.swapedItem.$item.y=e):(this.swapedItem.setSize(),this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.swapedItem=void 0)}}restoreSwapItem(){this.swapedItem&&(this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.swapedItem.setSize(),this.swapedItem=void 0)}setSwapItem(){this.swapedItem&&(this.swapedItem.checkItemChanges(this.swapedItem.$item,this.swapedItem.item),this.swapedItem=void 0)}checkSwap(t){let e;if(this.gridster.$options.swapWhileDragging?e=this.gridster.checkCollisionForSwaping(t.$item):e=this.gridster.checkCollision(t.$item),e&&e!==!0&&e.canBeDragged()){let i=e,n=i.$item.x,s=i.$item.y,a=t.$item.x,o=t.$item.y,c=a-n,l=o-s;i.$item.x=t.item.x-c,i.$item.y=t.item.y-l,t.$item.x=i.item.x+c,t.$item.y=i.item.y+l,this.gridster.checkCollision(i.$item)||this.gridster.checkCollision(t.$item)?(t.$item.x=a,t.$item.y=o,i.$item.x=n,i.$item.y=s):(i.setSize(),this.swapedItem=i,this.gridster.$options.swapWhileDragging&&(this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.setSwapItem()))}}},Pf="gridster-item-resizable-handler",dr=function(r){return r.UP="UP",r.DOWN="DOWN",r.LEFT="LEFT",r.RIGHT="RIGHT",r}(dr||{}),eo=class{zone;gridsterItem;gridster;lastMouse;offsetLeft;offsetTop;margin;outerMarginTop;outerMarginRight;outerMarginBottom;outerMarginLeft;diffTop;diffLeft;originalClientX;originalClientY;top;left;height;width;positionX;positionY;positionXBackup;positionYBackup;enabled;mousemove;mouseup;mouseleave;cancelOnBlur;touchmove;touchend;touchcancel;mousedown;touchstart;push;swap;path;collision=!1;constructor(t,e,i){this.zone=i,this.gridsterItem=t,this.gridster=e,this.lastMouse={clientX:0,clientY:0},this.path=[]}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(!0),this.gridsterItem=this.gridster=this.collision=null,this.mousedown&&(this.mousedown(),this.touchstart())}dragStart(t){t.which&&t.which!==1||(this.gridster.options.draggable&&this.gridster.options.draggable.start&&this.gridster.options.draggable.start(this.gridsterItem.item,this.gridsterItem,t),t.stopPropagation(),t.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-moving"),this.margin=this.gridster.$options.margin,this.outerMarginTop=this.gridster.$options.outerMarginTop,this.outerMarginRight=this.gridster.$options.outerMarginRight,this.outerMarginBottom=this.gridster.$options.outerMarginBottom,this.outerMarginLeft=this.gridster.$options.outerMarginLeft,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.left=this.gridsterItem.left-this.margin,this.top=this.gridsterItem.top-this.margin,this.originalClientX=t.clientX,this.originalClientY=t.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.gridster.$options.dirType===Ot.RTL?this.diffLeft=t.clientX-this.gridster.el.scrollWidth+this.gridsterItem.left:this.diffLeft=t.clientX+this.offsetLeft-this.margin-this.left,this.diffTop=t.clientY+this.offsetTop-this.margin-this.top,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(!0),this.push=new Ls(this.gridsterItem),this.swap=new Ja(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid(),this.path.push({x:this.gridsterItem.item.x||0,y:this.gridsterItem.item.y||0}))}dragMove=t=>{t.stopPropagation(),t.preventDefault(),Bt.checkTouchEvent(t);let e=this.getDirections(t);this.gridster.options.enableBoundaryControl&&(e.includes(dr.UP)&&this.gridsterItem.el.getBoundingClientRect().top<this.gridster.el.getBoundingClientRect().top+(this.outerMarginTop??this.margin)&&(e=e.filter(i=>i!=dr.UP),t=new MouseEvent(t.type,{clientX:t.clientX,clientY:this.lastMouse.clientY})),e.includes(dr.LEFT)&&this.gridsterItem.el.getBoundingClientRect().left<this.gridster.el.getBoundingClientRect().left+(this.outerMarginLeft??this.margin)&&(e=e.filter(i=>i!=dr.LEFT),t=new MouseEvent(t.type,{clientX:this.lastMouse.clientX,clientY:t.clientY})),e.includes(dr.RIGHT)&&this.gridsterItem.el.getBoundingClientRect().right>this.gridster.el.getBoundingClientRect().right-(this.outerMarginRight??this.margin)&&(e=e.filter(i=>i!=dr.RIGHT),t=new MouseEvent(t.type,{clientX:this.lastMouse.clientX,clientY:t.clientY})),e.includes(dr.DOWN)&&this.gridsterItem.el.getBoundingClientRect().bottom>this.gridster.el.getBoundingClientRect().bottom-(this.outerMarginBottom??this.margin)&&(e=e.filter(i=>i!=dr.DOWN),t=new MouseEvent(t.type,{clientX:t.clientX,clientY:this.lastMouse.clientY}))),e.length&&(this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,nc(this.gridster,this.left,this.top,this.width,this.height,t,this.lastMouse,this.calculateItemPositionFromMousePosition),this.calculateItemPositionFromMousePosition(t))};calculateItemPositionFromMousePosition=t=>{this.gridster.options.scale?this.calculateItemPositionWithScale(t,this.gridster.options.scale):this.calculateItemPositionWithoutScale(t),this.calculateItemPosition(),this.lastMouse.clientX=t.clientX,this.lastMouse.clientY=t.clientY,this.zone.run(()=>{this.gridster.updateGrid()})};calculateItemPositionWithScale(t,e){this.gridster.$options.dirType===Ot.RTL?this.left=this.gridster.el.scrollWidth-this.originalClientX+(t.clientX-this.originalClientX)/e+this.diffLeft:this.left=this.originalClientX+(t.clientX-this.originalClientX)/e+this.offsetLeft-this.diffLeft,this.top=this.originalClientY+(t.clientY-this.originalClientY)/e+this.offsetTop-this.diffTop}calculateItemPositionWithoutScale(t){this.gridster.$options.dirType===Ot.RTL?this.left=this.gridster.el.scrollWidth-t.clientX+this.diffLeft:this.left=t.clientX+this.offsetLeft-this.diffLeft,this.top=t.clientY+this.offsetTop-this.diffTop}dragStop=t=>{t.stopPropagation(),t.preventDefault(),sc(),this.cancelOnBlur(),this.mousemove(),this.mouseup(),this.mouseleave(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-moving"),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.path=[],this.gridster.options.draggable&&this.gridster.options.draggable.stop?Promise.resolve(this.gridster.options.draggable.stop(this.gridsterItem.item,this.gridsterItem,t)).then(this.makeDrag,this.cancelDrag):this.makeDrag(),setTimeout(()=>{this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle(!0))})};cancelDrag=()=>{this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push&&this.push.restoreItems(),this.swap&&this.swap.restoreSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)};makeDrag=()=>{this.gridster.$options.draggable.dropOverItems&&this.gridster.options.draggable&&this.gridster.options.draggable.dropOverItemsCallback&&this.collision&&this.collision!==!0&&this.collision.$item&&this.gridster.options.draggable.dropOverItemsCallback(this.gridsterItem.item,this.collision.item,this.gridster),this.collision=!1,this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push&&this.push.setPushedItems(),this.swap&&this.swap.setSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)};calculateItemPosition(){if(this.gridster.movingItem=this.gridsterItem.$item,this.positionX=this.gridster.pixelsToPositionX(this.left,Math.round),this.positionY=this.gridster.pixelsToPositionY(this.top,Math.round),this.positionXBackup=this.gridsterItem.$item.x,this.positionYBackup=this.gridsterItem.$item.y,this.gridsterItem.$item.x=this.positionX,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.x=this.positionXBackup),this.gridsterItem.$item.y=this.positionY,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.y=this.positionYBackup),this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,this.top),this.positionXBackup!==this.gridsterItem.$item.x||this.positionYBackup!==this.gridsterItem.$item.y){let t=this.path[this.path.length-1],e="";t.x<this.gridsterItem.$item.x?e=this.push.fromWest:t.x>this.gridsterItem.$item.x?e=this.push.fromEast:t.y<this.gridsterItem.$item.y?e=this.push.fromNorth:t.y>this.gridsterItem.$item.y&&(e=this.push.fromSouth),this.push.pushItems(e,this.gridster.$options.disablePushOnDrag),this.swap.swapItems(),this.collision=this.gridster.checkCollision(this.gridsterItem.$item),this.collision?(this.gridsterItem.$item.x=this.positionXBackup,this.gridsterItem.$item.y=this.positionYBackup,this.gridster.$options.draggable.dropOverItems&&this.collision!==!0&&this.collision.$item&&(this.gridster.movingItem=null)):this.path.push({x:this.gridsterItem.$item.x,y:this.gridsterItem.$item.y}),this.push.checkPushBack()}else this.collision=!1;this.gridster.previewStyle(!0)}toggle(){let t=this.gridsterItem.canBeDragged();!this.enabled&&t?(this.enabled=!this.enabled,this.mousedown=this.gridsterItem.renderer.listen(this.gridsterItem.el,"mousedown",this.dragStartDelay),this.touchstart=this.gridsterItem.renderer.listen(this.gridsterItem.el,"touchstart",this.dragStartDelay)):this.enabled&&!t&&(this.enabled=!this.enabled,this.mousedown(),this.touchstart())}dragStartDelay=t=>{if(t.target.classList.contains(Pf)||Bt.checkContentClassForEvent(this.gridster,t))return;if(Bt.checkTouchEvent(t),!this.gridster.$options.draggable.delayStart){this.dragStart(t);return}let i=setTimeout(()=>{this.dragStart(t),f()},this.gridster.$options.draggable.delayStart),n=this.gridsterItem.renderer.listen("document","mouseup",f),s=this.gridsterItem.renderer.listen("document","mouseleave",f),a=this.gridsterItem.renderer.listen("window","blur",f),o=this.gridsterItem.renderer.listen("document","touchmove",h),c=this.gridsterItem.renderer.listen("document","touchend",f),l=this.gridsterItem.renderer.listen("document","touchcancel",f);function h(u){Bt.checkTouchEvent(u),(Math.abs(u.clientX-t.clientX)>9||Math.abs(u.clientY-t.clientY)>9)&&f()}function f(){clearTimeout(i),a(),n(),s(),o(),c(),l()}};getDirections(t){let e=[];return this.lastMouse.clientX===0&&this.lastMouse.clientY===0&&(this.lastMouse.clientY=t.clientY,this.lastMouse.clientX=t.clientX),this.lastMouse.clientY>t.clientY&&e.push(dr.UP),this.lastMouse.clientY<t.clientY&&e.push(dr.DOWN),this.lastMouse.clientX<t.clientX&&e.push(dr.RIGHT),this.lastMouse.clientX>t.clientX&&e.push(dr.LEFT),e}},to=class{fromSouth;fromNorth;fromEast;fromWest;pushedItems;pushedItemsPath;gridsterItem;gridster;tryPattern;constructor(t){this.pushedItems=[],this.pushedItemsPath=[],this.gridsterItem=t,this.gridster=t.gridster,this.tryPattern={fromEast:this.tryWest,fromWest:this.tryEast,fromNorth:this.trySouth,fromSouth:this.tryNorth},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(t){return this.gridster.$options.pushResizeItems?this.push(this.gridsterItem,t):!1}restoreItems(){let t=0,e=this.pushedItems.length,i;for(;t<e;t++)i=this.pushedItems[t],i.$item.x=i.item.x||0,i.$item.y=i.item.y||0,i.$item.cols=i.item.cols||1,i.$item.row=i.item.row||1,i.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let t=0,e=this.pushedItems.length,i;for(;t<e;t++)i=this.pushedItems[t],i.checkItemChanges(i.$item,i.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let t=this.pushedItems.length-1,e=!1;for(;t>-1;t--)this.checkPushedItem(this.pushedItems[t],t)&&(e=!0);e&&this.checkPushBack()}push(t,e){let i=this.gridster.checkCollision(t.$item);if(i&&i!==!0&&i!==this.gridsterItem&&i.canBeResized()){if(this.tryPattern[e].call(this,i,t,e))return!0}else if(i===!1)return!0;return!1}trySouth(t,e,i){let n=t.$item.y,s=t.$item.rows;return t.$item.y=e.$item.y+e.$item.rows,t.$item.rows=s+n-t.$item.y,!this.gridster.checkCollisionTwoItems(t.$item,e.$item)&&!this.gridster.checkGridCollision(t.$item)?(t.setSize(),this.addToPushed(t),this.push(e,i),!0):(t.$item.y=n,t.$item.rows=s,!1)}tryNorth(t,e,i){let n=t.$item.rows;return t.$item.rows=e.$item.y-t.$item.y,!this.gridster.checkCollisionTwoItems(t.$item,e.$item)&&!this.gridster.checkGridCollision(t.$item)?(t.setSize(),this.addToPushed(t),this.push(e,i),!0):(t.$item.rows=n,!1)}tryEast(t,e,i){let n=t.$item.x,s=t.$item.cols;return t.$item.x=e.$item.x+e.$item.cols,t.$item.cols=s+n-t.$item.x,!this.gridster.checkCollisionTwoItems(t.$item,e.$item)&&!this.gridster.checkGridCollision(t.$item)?(t.setSize(),this.addToPushed(t),this.push(e,i),!0):(t.$item.x=n,t.$item.cols=s,!1)}tryWest(t,e,i){let n=t.$item.cols;return t.$item.cols=e.$item.x-t.$item.x,!this.gridster.checkCollisionTwoItems(t.$item,e.$item)&&!this.gridster.checkGridCollision(t.$item)?(t.setSize(),this.addToPushed(t),this.push(e,i),!0):(t.$item.cols=n,!1)}addToPushed(t){if(this.pushedItems.indexOf(t)<0)this.pushedItems.push(t),this.pushedItemsPath.push([{x:t.item.x||0,y:t.item.y||0,cols:t.item.cols||0,rows:t.item.rows||0},{x:t.$item.x,y:t.$item.y,cols:t.$item.cols,rows:t.$item.rows}]);else{let e=this.pushedItems.indexOf(t);this.pushedItemsPath[e].push({x:t.$item.x,y:t.$item.y,cols:t.$item.cols,rows:t.$item.rows})}}removeFromPushed(t){t>-1&&(this.pushedItems.splice(t,1),this.pushedItemsPath.splice(t,1))}checkPushedItem(t,e){let i=this.pushedItemsPath[e],n=i.length-2,s,a,o,c,l;for(;n>-1;n--)s=i[n],a=t.$item.x,o=t.$item.y,c=t.$item.cols,l=t.$item.rows,t.$item.x=s.x,t.$item.y=s.y,t.$item.cols=s.cols,t.$item.rows=s.rows,this.gridster.findItemWithItem(t.$item)?(t.$item.x=a,t.$item.y=o,t.$item.cols=c,t.$item.rows=l):(t.setSize(),i.splice(n+1,i.length-1-n));return i.length<2?(this.removeFromPushed(e),!0):!1}},ro=class{zone;gridsterItem;gridster;lastMouse;itemBackup;resizeEventScrollType;directionFunction=null;resizeEnabled;resizableHandles;mousemove;mouseup;mouseleave;cancelOnBlur;touchmove;touchend;touchcancel;push;pushResize;minHeight;minWidth;offsetTop;offsetLeft;diffTop;diffLeft;diffRight;diffBottom;margin;outerMarginTop;outerMarginRight;outerMarginBottom;outerMarginLeft;originalClientX;originalClientY;top;left;bottom;right;width;height;newPosition;constructor(t,e,i){this.zone=i,this.gridsterItem=t,this.gridster=e,this.lastMouse={clientX:0,clientY:0},this.itemBackup=[0,0,0,0],this.resizeEventScrollType={west:!1,east:!1,north:!1,south:!1}}destroy(){this.gridster?.previewStyle(),this.gridster=this.gridsterItem=null}dragStart(t){if(t.which&&t.which!==1)return;this.gridster.options.resizable&&this.gridster.options.resizable.start&&this.gridster.options.resizable.start(this.gridsterItem.item,this.gridsterItem,t),t.stopPropagation(),t.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-resizing"),this.lastMouse.clientX=t.clientX,this.lastMouse.clientY=t.clientY,this.left=this.gridsterItem.left,this.top=this.gridsterItem.top,this.originalClientX=t.clientX,this.originalClientY=t.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.bottom=this.gridsterItem.top+this.gridsterItem.height,this.right=this.gridsterItem.left+this.gridsterItem.width,this.margin=this.gridster.$options.margin,this.outerMarginTop=this.gridster.$options.outerMarginTop,this.outerMarginRight=this.gridster.$options.outerMarginRight,this.outerMarginBottom=this.gridster.$options.outerMarginBottom,this.outerMarginLeft=this.gridster.$options.outerMarginLeft,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.diffLeft=t.clientX+this.offsetLeft-this.left,this.diffRight=t.clientX+this.offsetLeft-this.right,this.diffTop=t.clientY+this.offsetTop-this.top,this.diffBottom=t.clientY+this.offsetTop-this.bottom,this.minHeight=this.gridster.positionYToPixels(this.gridsterItem.$item.minItemRows||this.gridster.$options.minItemRows)-this.margin,this.minWidth=this.gridster.positionXToPixels(this.gridsterItem.$item.minItemCols||this.gridster.$options.minItemCols)-this.margin,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(),this.push=new Ls(this.gridsterItem),this.pushResize=new to(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid();let{classList:e}=t.target;e.contains("handle-n")?(this.resizeEventScrollType.north=!0,this.directionFunction=this.handleNorth):e.contains("handle-w")?this.gridster.$options.dirType===Ot.RTL?(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):e.contains("handle-s")?(this.resizeEventScrollType.south=!0,this.directionFunction=this.handleSouth):e.contains("handle-e")?this.gridster.$options.dirType===Ot.RTL?(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):e.contains("handle-nw")?this.gridster.$options.dirType===Ot.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):e.contains("handle-ne")?this.gridster.$options.dirType===Ot.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):e.contains("handle-sw")?this.gridster.$options.dirType===Ot.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):e.contains("handle-se")&&(this.gridster.$options.dirType===Ot.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast))}dragMove=t=>{if(this.directionFunction===null)throw new Error("The `directionFunction` has not been set before calling `dragMove`.");t.stopPropagation(),t.preventDefault(),Bt.checkTouchEvent(t),this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,nc(this.gridster,this.left,this.top,this.width,this.height,t,this.lastMouse,this.directionFunction,!0,this.resizeEventScrollType);let e=this.gridster.options.scale||1;this.directionFunction({clientX:this.originalClientX+(t.clientX-this.originalClientX)/e,clientY:this.originalClientY+(t.clientY-this.originalClientY)/e}),this.lastMouse.clientX=t.clientX,this.lastMouse.clientY=t.clientY,this.zone.run(()=>{this.gridster.updateGrid()})};dragStop=t=>{t.stopPropagation(),t.preventDefault(),sc(),this.mousemove(),this.mouseup(),this.mouseleave(),this.cancelOnBlur(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.gridster.options.resizable&&this.gridster.options.resizable.stop?Promise.resolve(this.gridster.options.resizable.stop(this.gridsterItem.item,this.gridsterItem,t)).then(this.makeResize,this.cancelResize):this.makeResize(),setTimeout(()=>{this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-resizing"),this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())})};cancelResize=()=>{this.gridsterItem.$item.cols=this.gridsterItem.item.cols||1,this.gridsterItem.$item.rows=this.gridsterItem.item.rows||1,this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push.restoreItems(),this.pushResize.restoreItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null};makeResize=()=>{this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push.setPushedItems(),this.pushResize.setPushedItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null};handleNorth=t=>{this.top=t.clientY+this.offsetTop-this.diffTop,this.height=this.bottom-this.top,this.minHeight>this.height?(this.height=this.minHeight,this.top=this.bottom-this.minHeight):this.gridster.options.enableBoundaryControl&&(this.top=Math.max(0,this.top),this.height=this.bottom-this.top);let e=this.gridster.options.pushItems?this.margin:0;if(this.newPosition=this.gridster.pixelsToPositionY(this.top+e,Math.floor),this.gridsterItem.$item.y!==this.newPosition){if(this.itemBackup[1]=this.gridsterItem.$item.y,this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows+=this.gridsterItem.$item.y-this.newPosition,this.gridsterItem.$item.y=this.newPosition,this.pushResize.pushItems(this.pushResize.fromSouth),this.push.pushItems(this.push.fromSouth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item)){this.gridsterItem.$item.y=this.itemBackup[1],this.gridsterItem.$item.rows=this.itemBackup[3],this.top=this.gridster.positionYToPixels(this.gridsterItem.$item.y),this.setItemTop(this.gridster.positionYToPixels(this.gridsterItem.$item.y)),this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);return}else this.gridster.previewStyle();this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemTop(this.top),this.setItemHeight(this.height)};handleWest=t=>{let e=this.gridster.$options.dirType===Ot.RTL?this.originalClientX+(this.originalClientX-t.clientX):t.clientX;this.left=e+this.offsetLeft-this.diffLeft,this.width=this.right-this.left,this.minWidth>this.width?(this.width=this.minWidth,this.left=this.right-this.minWidth):this.gridster.options.enableBoundaryControl&&(this.left=Math.max(0,this.left),this.width=this.right-this.left);let i=this.gridster.options.pushItems?this.margin:0;if(this.newPosition=this.gridster.pixelsToPositionX(this.left+i,Math.floor),this.gridsterItem.$item.x!==this.newPosition){if(this.itemBackup[0]=this.gridsterItem.$item.x,this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols+=this.gridsterItem.$item.x-this.newPosition,this.gridsterItem.$item.x=this.newPosition,this.pushResize.pushItems(this.pushResize.fromEast),this.push.pushItems(this.push.fromEast,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item)){this.gridsterItem.$item.x=this.itemBackup[0],this.gridsterItem.$item.cols=this.itemBackup[2],this.left=this.gridster.positionXToPixels(this.gridsterItem.$item.x),this.setItemLeft(this.gridster.positionXToPixels(this.gridsterItem.$item.x)),this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);return}else this.gridster.previewStyle();this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemLeft(this.left),this.setItemWidth(this.width)};handleSouth=t=>{if(this.height=t.clientY+this.offsetTop-this.diffBottom-this.top,this.minHeight>this.height&&(this.height=this.minHeight),this.bottom=this.top+this.height,this.gridster.options.enableBoundaryControl){let i=this.outerMarginBottom??this.margin,n=this.gridster.el.getBoundingClientRect();this.bottom=Math.min(this.bottom,n.bottom-n.top-2*i),this.height=this.bottom-this.top}let e=this.gridster.options.pushItems?0:this.margin;if(this.newPosition=this.gridster.pixelsToPositionY(this.bottom+e,Math.ceil),this.gridsterItem.$item.y+this.gridsterItem.$item.rows!==this.newPosition){if(this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows=this.newPosition-this.gridsterItem.$item.y,this.pushResize.pushItems(this.pushResize.fromNorth),this.push.pushItems(this.push.fromNorth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item)){this.gridsterItem.$item.rows=this.itemBackup[3],this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);return}else this.gridster.previewStyle();this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemHeight(this.height)};handleEast=t=>{let e=this.gridster.$options.dirType===Ot.RTL?this.originalClientX+(this.originalClientX-t.clientX):t.clientX;if(this.width=e+this.offsetLeft-this.diffRight-this.left,this.minWidth>this.width&&(this.width=this.minWidth),this.right=this.left+this.width,this.gridster.options.enableBoundaryControl){let n=this.outerMarginRight??this.margin,s=this.gridster.el.getBoundingClientRect();this.right=Math.min(this.right,s.right-s.left-2*n),this.width=this.right-this.left}let i=this.gridster.options.pushItems?0:this.margin;if(this.newPosition=this.gridster.pixelsToPositionX(this.right+i,Math.ceil),this.gridsterItem.$item.x+this.gridsterItem.$item.cols!==this.newPosition){if(this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols=this.newPosition-this.gridsterItem.$item.x,this.pushResize.pushItems(this.pushResize.fromWest),this.push.pushItems(this.push.fromWest,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item)){this.gridsterItem.$item.cols=this.itemBackup[2],this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);return}else this.gridster.previewStyle();this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemWidth(this.width)};handleNorthWest=t=>{this.handleNorth(t),this.handleWest(t)};handleNorthEast=t=>{this.handleNorth(t),this.handleEast(t)};handleSouthWest=t=>{this.handleSouth(t),this.handleWest(t)};handleSouthEast=t=>{this.handleSouth(t),this.handleEast(t)};toggle(){this.resizeEnabled=this.gridsterItem.canBeResized(),this.resizableHandles=this.gridsterItem.getResizableHandles()}dragStartDelay(t){if(Bt.checkTouchEvent(t),!this.gridster.$options.resizable.delayStart){this.dragStart(t);return}let e=setTimeout(()=>{this.dragStart(t),h()},this.gridster.$options.resizable.delayStart),{cancelMouse:i,cancelMouseLeave:n,cancelOnBlur:s,cancelTouchMove:a,cancelTouchEnd:o,cancelTouchCancel:c}=this.zone.runOutsideAngular(()=>{let f=this.gridsterItem.renderer.listen("document","mouseup",h),u=this.gridsterItem.renderer.listen("document","mouseleave",h),d=this.gridsterItem.renderer.listen("window","blur",h),g=this.gridsterItem.renderer.listen("document","touchmove",l),p=this.gridsterItem.renderer.listen("document","touchend",h),x=this.gridsterItem.renderer.listen("document","touchcancel",h);return{cancelMouse:f,cancelMouseLeave:u,cancelOnBlur:d,cancelTouchMove:g,cancelTouchEnd:p,cancelTouchCancel:x}});function l(f){Bt.checkTouchEvent(f),(Math.abs(f.clientX-t.clientX)>9||Math.abs(f.clientY-t.clientY)>9)&&h()}function h(){clearTimeout(e),s(),i(),n(),a(),o(),c()}}setItemTop(t){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,t)}setItemLeft(t){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,t,this.top)}setItemHeight(t){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"height",t+"px")}setItemWidth(t){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"width",t+"px")}},hc=(()=>{class r{renderer;zone;item;itemInit=new Ce;itemChange=new Ce;itemResize=new Ce;$item;el;gridster;top;left;width;height;drag;resize;notPlaced;init;get zIndex(){return this.getLayerIndex()+this.gridster.$options.baseLayerIndex}constructor(e,i,n,s){this.renderer=n,this.zone=s,this.el=e.nativeElement,this.$item={cols:-1,rows:-1,x:-1,y:-1},this.gridster=i,this.drag=new eo(this,i,this.zone),this.resize=new ro(this,i,this.zone)}ngOnInit(){this.gridster.addItem(this)}ngOnChanges(e){e.item&&(this.updateOptions(),this.init||this.gridster.calculateLayout$.next()),e.item&&e.item.previousValue&&this.setSize()}updateOptions(){this.$item=Bt.merge(this.$item,this.item,{cols:void 0,rows:void 0,x:void 0,y:void 0,layerIndex:void 0,dragEnabled:void 0,resizeEnabled:void 0,compactEnabled:void 0,maxItemRows:void 0,minItemRows:void 0,maxItemCols:void 0,minItemCols:void 0,maxItemArea:void 0,minItemArea:void 0,resizableHandles:{s:void 0,e:void 0,n:void 0,w:void 0,se:void 0,ne:void 0,sw:void 0,nw:void 0}})}ngOnDestroy(){this.gridster.removeItem(this),this.drag.destroy(),this.resize.destroy(),this.gridster=this.drag=this.resize=null}setSize(){this.renderer.setStyle(this.el,"display",this.notPlaced?"":"block"),this.gridster.gridRenderer.updateItem(this.el,this.$item,this.renderer),this.updateItemSize()}updateItemSize(){let e=this.$item.y*this.gridster.curRowHeight,i=this.$item.x*this.gridster.curColWidth,n=this.$item.cols*this.gridster.curColWidth-this.gridster.$options.margin,s=this.$item.rows*this.gridster.curRowHeight-this.gridster.$options.margin;this.top=e,this.left=i,!this.init&&n>0&&s>0&&(this.init=!0,this.item.initCallback&&this.item.initCallback(this.item,this),this.gridster.options.itemInitCallback&&this.gridster.options.itemInitCallback(this.item,this),this.itemInit.next({item:this.item,itemComponent:this}),this.gridster.$options.scrollToNewItems&&this.el.scrollIntoView(!1)),(n!==this.width||s!==this.height)&&(this.width=n,this.height=s,this.gridster.options.itemResizeCallback&&this.gridster.options.itemResizeCallback(this.item,this),this.itemResize.next({item:this.item,itemComponent:this}))}itemChanged(){this.gridster.options.itemChangeCallback&&this.gridster.options.itemChangeCallback(this.item,this),this.itemChange.next({item:this.item,itemComponent:this})}checkItemChanges(e,i){e.rows===i.rows&&e.cols===i.cols&&e.x===i.x&&e.y===i.y||(this.gridster.checkCollision(this.$item)?(this.$item.x=i.x||0,this.$item.y=i.y||0,this.$item.cols=i.cols||1,this.$item.rows=i.rows||1,this.setSize()):(this.item.cols=this.$item.cols,this.item.rows=this.$item.rows,this.item.x=this.$item.x,this.item.y=this.$item.y,this.gridster.calculateLayout$.next(),this.itemChanged()))}canBeDragged(){let e=this.gridster.$options.draggable.enabled,i=this.$item.dragEnabled===void 0?e:this.$item.dragEnabled;return!this.gridster.mobile&&e&&i}canBeResized(){let e=this.gridster.$options.resizable.enabled,i=this.$item.resizeEnabled===void 0?e:this.$item.resizeEnabled;return!this.gridster.mobile&&e&&i}getResizableHandles(){let e=this.gridster.$options.resizable.handles,i=this.$item.resizableHandles;return i===void 0?e:k(k({},e),i)}bringToFront(e){if(e&&e<=0)return;let i=this.getLayerIndex(),n=this.gridster.$options.maxLayerIndex;if(i<n){let s=e?i+e:n;this.item.layerIndex=this.$item.layerIndex=s>n?n:s}}sendToBack(e){if(e&&e<=0)return;let i=this.getLayerIndex();if(i>0){let n=e?i-e:0;this.item.layerIndex=this.$item.layerIndex=n<0?0:n}}getLayerIndex(){return this.item.layerIndex!==void 0?this.item.layerIndex:this.gridster.$options.defaultLayerIndex!==void 0?this.gridster.$options.defaultLayerIndex:0}static \u0275fac=function(i){return new(i||r)(Ke(Yr),Ke(Rs),Ke(Ei),Ke(Bn))};static \u0275cmp=Me({type:r,selectors:[["gridster-item"]],hostVars:2,hostBindings:function(i,n){i&2&&Br("z-index",n.zIndex)},inputs:{item:"item"},outputs:{itemInit:"itemInit",itemChange:"itemChange",itemResize:"itemResize"},features:[Si],ngContentSelectors:rc,decls:9,vars:8,consts:[[1,"gridster-item-resizable-handler","handle-s"],[1,"gridster-item-resizable-handler","handle-e"],[1,"gridster-item-resizable-handler","handle-n"],[1,"gridster-item-resizable-handler","handle-w"],[1,"gridster-item-resizable-handler","handle-se"],[1,"gridster-item-resizable-handler","handle-ne"],[1,"gridster-item-resizable-handler","handle-sw"],[1,"gridster-item-resizable-handler","handle-nw"],[1,"gridster-item-resizable-handler","handle-s",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-e",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-n",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-w",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-se",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-ne",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-sw",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-nw",3,"mousedown","touchstart"]],template:function(i,n){i&1&&(Fi(),Kr(0),gt(1,Tf,1,0,"div",0),gt(2,Sf,1,0,"div",1),gt(3,Ef,1,0,"div",2),gt(4,kf,1,0,"div",3),gt(5,If,1,0,"div",4),gt(6,Ff,1,0,"div",5),gt(7,Of,1,0,"div",6),gt(8,Af,1,0,"div",7)),i&2&&(A(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.s&&n.resize.resizeEnabled?1:-1),A(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.e&&n.resize.resizeEnabled?2:-1),A(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.n&&n.resize.resizeEnabled?3:-1),A(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.w&&n.resize.resizeEnabled?4:-1),A(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.se&&n.resize.resizeEnabled?5:-1),A(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.ne&&n.resize.resizeEnabled?6:-1),A(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.sw&&n.resize.resizeEnabled?7:-1),A(),xt(n.resize.resizableHandles!=null&&n.resize.resizableHandles.nw&&n.resize.resizeEnabled?8:-1))},styles:[`gridster-item{box-sizing:border-box;z-index:1;position:absolute;overflow:hidden;transition:.3s;display:none;background:#fff;-webkit-user-select:text;user-select:text}gridster-item.gridster-item-moving{cursor:move}gridster-item.gridster-item-resizing,gridster-item.gridster-item-moving{transition:0s;z-index:2;box-shadow:0 0 5px 5px #0003,0 6px 10px #00000024,0 1px 18px #0000001f}.gridster-item-resizable-handler{position:absolute;z-index:2}.gridster-item-resizable-handler.handle-n{cursor:ns-resize;height:10px;right:0;top:0;left:0}.gridster-item-resizable-handler.handle-e{cursor:ew-resize;width:10px;bottom:0;right:0;top:0}.gridster-item-resizable-handler.handle-s{cursor:ns-resize;height:10px;right:0;bottom:0;left:0}.gridster-item-resizable-handler.handle-w{cursor:ew-resize;width:10px;left:0;top:0;bottom:0}.gridster-item-resizable-handler.handle-ne{cursor:ne-resize;width:10px;height:10px;right:0;top:0}.gridster-item-resizable-handler.handle-nw{cursor:nw-resize;width:10px;height:10px;left:0;top:0}.gridster-item-resizable-handler.handle-se{cursor:se-resize;width:0;height:0;right:0;bottom:0;border-style:solid;border-width:0 0 10px 10px;border-color:transparent}.gridster-item-resizable-handler.handle-sw{cursor:sw-resize;width:10px;height:10px;left:0;bottom:0}gridster-item:hover .gridster-item-resizable-handler.handle-se{border-color:transparent transparent #ccc}
`],encapsulation:2})}return r})();function Lf(r){r||(r=ht(Ia));let t=new Ln(e=>{if(r.destroyed){e.next();return}return r.onDestroy(e.next.bind(e))});return e=>e.pipe(Rn(t))}var so=class{source;destroyed=!1;destroyRef=ht(Ia);constructor(t){this.source=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}subscribe(t){if(this.destroyed)throw new ul(953,!1);let e=this.source.pipe(Lf(this.destroyRef)).subscribe({next:i=>t(i)});return{unsubscribe:()=>e.unsubscribe()}}};function De(r,t){return new so(r)}function fc(r){let t=yl(r);return new Ln(e=>{let i=t?.onDestroy(()=>e.complete()),n=r.subscribe(s=>e.next(s));return()=>{n.unsubscribe(),i?.()}})}var uc=new dl("NGX_ECHARTS_CONFIG"),ao=class{constructor(){this.subject=new gs(1),this.subscriptions=new ol}doFilter(t){this.subject.next(t)}dispose(){this.subscriptions.unsubscribe()}notEmpty(t,e){this.subscriptions.add(this.subject.subscribe(i=>{if(i[t]){let n=i[t].currentValue;n!=null&&e(n)}}))}has(t,e){this.subscriptions.add(this.subject.subscribe(i=>{if(i[t]){let n=i[t].currentValue;e(n)}}))}notFirst(t,e){this.subscriptions.add(this.subject.subscribe(i=>{if(i[t]&&!i[t].isFirstChange()){let n=i[t].currentValue;e(n)}}))}notFirstAndEmpty(t,e){this.subscriptions.add(this.subject.subscribe(i=>{if(i[t]&&!i[t].isFirstChange()){let n=i[t].currentValue;n!=null&&e(n)}}))}},dc=(()=>{let t=class t{constructor(){this.el=ht(Yr),this.ngZone=ht(Bn),this.config=ht(uc),this.options=Qt(null),this.theme=Qt(this.config.theme??null),this.initOpts=Qt(null),this.merge=Qt(null),this.autoResize=Qt(!0),this.loading=Qt(!1),this.loadingType=Qt("default"),this.loadingOpts=Qt(null),this.chartInit=Pa(),this.optionsError=Pa(),this.chartClick=De(this.createLazyEvent("click")),this.chartDblClick=De(this.createLazyEvent("dblclick")),this.chartMouseDown=De(this.createLazyEvent("mousedown")),this.chartMouseMove=De(this.createLazyEvent("mousemove")),this.chartMouseUp=De(this.createLazyEvent("mouseup")),this.chartMouseOver=De(this.createLazyEvent("mouseover")),this.chartMouseOut=De(this.createLazyEvent("mouseout")),this.chartGlobalOut=De(this.createLazyEvent("globalout")),this.chartContextMenu=De(this.createLazyEvent("contextmenu")),this.chartHighlight=De(this.createLazyEvent("highlight")),this.chartDownplay=De(this.createLazyEvent("downplay")),this.chartSelectChanged=De(this.createLazyEvent("selectchanged")),this.chartLegendSelectChanged=De(this.createLazyEvent("legendselectchanged")),this.chartLegendSelected=De(this.createLazyEvent("legendselected")),this.chartLegendUnselected=De(this.createLazyEvent("legendunselected")),this.chartLegendLegendSelectAll=De(this.createLazyEvent("legendselectall")),this.chartLegendLegendInverseSelect=De(this.createLazyEvent("legendinverseselect")),this.chartLegendScroll=De(this.createLazyEvent("legendscroll")),this.chartDataZoom=De(this.createLazyEvent("datazoom")),this.chartDataRangeSelected=De(this.createLazyEvent("datarangeselected")),this.chartGraphRoam=De(this.createLazyEvent("graphroam")),this.chartGeoRoam=De(this.createLazyEvent("georoam")),this.chartTreeRoam=De(this.createLazyEvent("treeroam")),this.chartTimelineChanged=De(this.createLazyEvent("timelinechanged")),this.chartTimelinePlayChanged=De(this.createLazyEvent("timelineplaychanged")),this.chartRestore=De(this.createLazyEvent("restore")),this.chartDataViewChanged=De(this.createLazyEvent("dataviewchanged")),this.chartMagicTypeChanged=De(this.createLazyEvent("magictypechanged")),this.chartGeoSelectChanged=De(this.createLazyEvent("geoselectchanged")),this.chartGeoSelected=De(this.createLazyEvent("geoselected")),this.chartGeoUnselected=De(this.createLazyEvent("geounselected")),this.chartAxisAreaSelected=De(this.createLazyEvent("axisareaselected")),this.chartBrush=De(this.createLazyEvent("brush")),this.chartBrushEnd=De(this.createLazyEvent("brushend")),this.chartBrushSelected=De(this.createLazyEvent("brushselected")),this.chartGlobalCursorTaken=De(this.createLazyEvent("globalcursortaken")),this.chartRendered=De(this.createLazyEvent("rendered")),this.chartFinished=De(this.createLazyEvent("finished")),this.animationFrameID=null,this.chart$=new gs(1),this.resize$=new Yi,this.changeFilter=new ao,this.resizeObFired=!1,this.echarts=this.config.echarts}ngOnChanges(i){this.changeFilter.doFilter(i)}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe(fl(100,ll,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize()&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(i=>{for(let n of i)n.target===this.el.nativeElement&&(this.resizeObFired?this.animationFrameID=window.requestAnimationFrame(()=>{this.resize$.next()}):this.resizeObFired=!0)})),this.resizeOb.observe(this.el.nativeElement)),this.changeFilter.notFirstAndEmpty("options",i=>this.onOptionsChange(i)),this.changeFilter.notFirstAndEmpty("merge",i=>this.setOption(i)),this.changeFilter.has("loading",i=>this.toggleLoading(!!i)),this.changeFilter.notFirst("theme",()=>this.refreshChart())}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.loadingSub&&this.loadingSub.unsubscribe(),this.changeFilter.dispose(),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(i){this.chart?i?this.chart.showLoading(this.loadingType(),this.loadingOpts()):this.chart.hideLoading():this.loadingSub=this.chart$.subscribe(n=>i?n.showLoading(this.loadingType(),this.loadingOpts()):n.hideLoading())}setOption(i,n){if(this.chart)try{this.chart.setOption(i,n)}catch(s){console.error(s),this.optionsError.emit(s)}}refreshChart(){return kt(this,null,function*(){this.dispose(),yield this.initChart()})}createChart(){let i=this.el.nativeElement;if(window&&window.getComputedStyle){let n=window.getComputedStyle(i,null).getPropertyValue("height");(!n||n==="0px")&&(!i.style.height||i.style.height==="0px")&&(i.style.height="400px")}return this.ngZone.runOutsideAngular(()=>(typeof this.echarts=="function"?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:s})=>s(i,this.theme??this.config?.theme,this.initOpts())))}initChart(){return kt(this,null,function*(){yield this.onOptionsChange(this.options());let i=this.merge();i&&this.chart&&this.setOption(i)})}onOptionsChange(i){return kt(this,null,function*(){i&&(this.chart?this.setOption(this.options(),!0):(this.chart=yield this.createChart(),this.chart$.next(this.chart),this.chartInit.emit(this.chart),this.setOption(this.options(),!0)))})}createLazyEvent(i){return fc(this.chartInit).pipe(xs(n=>new Ln(s=>(n.on(i,a=>this.ngZone.run(()=>s.next(a))),()=>{this.chart&&(this.chart.isDisposed()||n.off(i))}))))}};t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=Nn({type:t,selectors:[["echarts"],["","echarts",""]],inputs:{options:[1,"options"],theme:[1,"theme"],initOpts:[1,"initOpts"],merge:[1,"merge"],autoResize:[1,"autoResize"],loading:[1,"loading"],loadingType:[1,"loadingType"],loadingOpts:[1,"loadingOpts"]},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartHighlight:"chartHighlight",chartDownplay:"chartDownplay",chartSelectChanged:"chartSelectChanged",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendLegendSelectAll:"chartLegendLegendSelectAll",chartLegendLegendInverseSelect:"chartLegendLegendInverseSelect",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartGraphRoam:"chartGraphRoam",chartGeoRoam:"chartGeoRoam",chartTreeRoam:"chartTreeRoam",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartGeoSelectChanged:"chartGeoSelectChanged",chartGeoSelected:"chartGeoSelected",chartGeoUnselected:"chartGeoUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartGlobalCursorTaken:"chartGlobalCursorTaken",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],features:[Si]});let r=t;return r})();function Ns(r){return{provide:uc,useValue:r}}var Rf=["chart"],Bs=(()=>{let t=class t{constructor(i){this.cdr=i,this.isSingleClick=!0}get chartOptions(){return this.widget?.config?.options}onChartInit(i){this.widget.chartInstance=i,setTimeout(()=>{this.onDataLoad?.emit(this.widget)})}onChartDblClick(i){this.isSingleClick=!1}onClick(i){this.isSingleClick=!0,setTimeout(()=>{let n=i.data;if(i.seriesType==="scatter"){let a=i.data.find(o=>o.name===this.widget.config.state?.accessor);n=k(k({},n),a)}let s=this.createFilterValueFromClickData(n,i);s?(s.widgetId=this.widget.id,this.widget.config?.header?.title&&(s.widgetTitle=this.widget.config.header.title),this.onUpdateFilter.emit({value:n,widget:this.widget,filterValue:s})):this.onUpdateFilter.emit({value:n,widget:this.widget})},250)}createFilterValueFromClickData(i,n){if(!i||typeof i!="object")return null;let s=this.widget.config?.filterColumn||this.widget.config?.accessor||"unknown",a={accessor:"unknown",filterColumn:s};if(i&&typeof i=="object"&&i.name&&n.seriesType==="pie")a={accessor:"category",filterColumn:s,category:i.name,value:i.name,percentage:i.value?.toString()||"0"};else if(n.seriesType==="bar"){let o,c;if(i&&typeof i=="object"&&i.name)o=i.name,c=i.value||i.name;else{c=i;let l=this.widget.config?.options,h=[];if(l?.xAxis&&(Array.isArray(l.xAxis)?h=l.xAxis[0]?.data||[]:h=l.xAxis.data||[]),h.length===0&&l?.series?.[0]?.data){let f=l.series[0].data;Array.isArray(f)&&f.length>0&&typeof f[0]=="object"&&f[0].name&&(h=f.map(u=>u.name))}h&&Array.isArray(h)&&n.dataIndex!==void 0?o=h[n.dataIndex]:o=c?.toString()||"Unknown"}a={accessor:"category",filterColumn:s,category:o,value:c,seriesName:n.seriesName}}else if(n.seriesType==="line")a={accessor:"series",filterColumn:s,series:n.seriesName||(i&&typeof i=="object"?i.name:null),value:i&&typeof i=="object"?i.value:i,xAxis:i&&Array.isArray(i)?i[0]?.toString():null,yAxis:i&&Array.isArray(i)?i[1]?.toString():null};else if(n.seriesType==="scatter"&&i&&typeof i=="object"&&i.value&&Array.isArray(i.value))a={accessor:"coordinates",filterColumn:s,x:i.value[0]?.toString(),y:i.value[1]?.toString(),value:`(${i.value[0]}, ${i.value[1]})`,seriesName:n.seriesName};else if(i&&typeof i=="object"){let o=Object.keys(i);if(o.length>0){let c=o[0];a={accessor:c,filterColumn:s,[c]:i[c],value:i[c]?.toString(),seriesName:n.seriesName}}}else return null;return a.accessor!=="unknown"?a:null}forceChartUpdate(){this.widget.chartInstance&&this.widget.chartInstance.setOption(this.chartOptions),this.cdr.detectChanges()}};t.\u0275fac=function(n){return new(n||t)(Ke(qi))},t.\u0275cmp=Me({type:t,selectors:[["vis-echart"]],viewQuery:function(n,s){if(n&1&&et(Rf,5),n&2){let a;Se(a=Ee())&&(s.chart=a.first)}},inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},features:[Ut([Ns({echarts:()=>import("./chunk-VTG26B3E.js")})])],decls:2,vars:1,consts:[["chart",""],["echarts","",3,"chartInit","chartClick","chartDblClick","options"]],template:function(n,s){if(n&1){let a=Te();U(0,"div",1,0),me("chartInit",function(c){return te(a),re(s.onChartInit(c))})("chartClick",function(c){return te(a),re(s.onClick(c))})("chartDblClick",function(c){return te(a),re(s.onChartDblClick(c))}),G()}n&2&&M("options",s.chartOptions)},dependencies:[Ne,dc],encapsulation:2});let r=t;return r})();function Nf(r,t){if(r&1&&(U(0,"span",11),Ie(1),Aa(2,"uppercase"),G(),U(3,"span",12),Ie(4,":"),G(),U(5,"span",13),Ie(6),G()),r&2){let e=I().$implicit;A(),je(Da(2,2,e.filterColumn||e.accessor)),A(5),je(e.value)}}function Bf(r,t){if(r&1&&(U(0,"span",11),Ie(1),G(),U(2,"span",12),Ie(3,":"),G(),U(4,"span",13),Ie(5),G()),r&2){let e=I().$implicit;A(),je(e.widgetTitle),A(4),je(e.value)}}function Wf(r,t){if(r&1&&(U(0,"span",11),Ie(1),Aa(2,"uppercase"),G(),U(3,"span",12),Ie(4,"="),G(),U(5,"span",13),Ie(6),G()),r&2){let e=I().$implicit;A(),je(Da(2,2,e.accessor)),A(5),je(e.value)}}function Hf(r,t){if(r&1){let e=Te();U(0,"button",8),me("click",function(){let n=te(e).$implicit,s=I(2);return re(s.clearFilter(n))}),xe(1,"i",9),gt(2,Nf,7,4)(3,Bf,6,2)(4,Wf,7,4),xe(5,"i",10),G()}if(r&2){let e=t.$implicit;M("title","Remove "+(e.filterColumn||e.accessor||e.widgetTitle)+" filter"),A(2),xt(e.filterColumn||e.accessor?2:e.widgetTitle?3:4)}}function $f(r,t){if(r&1){let e=Te();U(0,"div",0)(1,"span",2),Ie(2,"Applied Filters"),G(),U(3,"div",3),ki(4,Hf,6,2,"button",4,ml),G(),U(6,"div",5)(7,"button",6),me("click",function(){te(e);let n=I();return re(n.clearAllFilters(!0))}),xe(8,"i",7),U(9,"span"),Ie(10,"Clear All"),G()()()()}if(r&2){let e=I();A(4),Ii(e.filterValues)}}function Vf(r,t){r&1&&(U(0,"div",1)(1,"div",14),xe(2,"i",15),U(3,"div",16)(4,"p",17),Ie(5,"No Filters Applied"),G(),U(6,"p",18),Ie(7," Click on any chart element to slice and dice data. You can use annotations to save a specific state of dashboard after applying filters. "),G()()()())}var pc=(()=>{let t=class t{get filterValues(){let i=this.widget?.config?.options;return i&&i.values&&Array.isArray(i.values)&&i.values.length>0?i.values:[]}set filterValues(i){i&&i.length>0&&(this.widget.config?this.widget.config.options||(this.widget.config.options={values:[]}):this.widget.config={options:{values:[]}},this.widget.config.options.values=i)}clearAllFilters(i){i&&(this.filterValues=[],this.widget?.config?.options&&(this.widget.config.options.values=[]),this.onUpdateFilter.emit([]))}clearFilter(i){if(JSON.stringify(i).length>0){let n=this.filterValues.splice(this.filterValues.indexOf(i),1);this.widget?.config?.options&&(this.widget.config.options.values=this.filterValues),this.onUpdateFilter.emit(this.filterValues)}}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Me({type:t,selectors:[["vis-filters"]],inputs:{widget:"widget",onUpdateFilter:"onUpdateFilter",onDataLoad:"onDataLoad"},decls:2,vars:1,consts:[[1,"filter-component"],[1,"filter-component","empty-state"],[1,"filter-label"],[1,"filter-badges"],[1,"btn-wide","btn","btn-outline-primary","btn-sm","chip",3,"title"],[1,"filter-actions"],["title","Clear all applied filters",1,"btn-wide","btn","btn-outline-warning","btn-sm","chip","clear-all-btn",3,"click"],[1,"pi","pi-trash"],[1,"btn-wide","btn","btn-outline-primary","btn-sm","chip",3,"click","title"],[1,"pi","pi-tag","filter-badge-icon"],["title","Remove filter",1,"pi","pi-times","close-icon"],[1,"filter-key"],[1,"filter-separator"],[1,"filter-value"],[1,"empty-state-content"],[1,"pi","pi-info-circle","empty-state-icon"],[1,"empty-state-text"],[1,"empty-state-title"],[1,"empty-state-description"]],template:function(n,s){n&1&&gt(0,$f,11,0,"div",0)(1,Vf,8,0,"div",1),n&2&&xt(s.filterValues&&s.filterValues.length>0?0:1)},dependencies:[Ne,bl],styles:[".filter-component[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:1rem;margin:0;padding:.5rem;font-size:.8rem;font-weight:500;background:linear-gradient(135deg,var(--p-surface-0) 0%,var(--p-surface-100) 100%);border-radius:8px;border:1px solid var(--p-surface-300);box-shadow:0 2px 4px #0000000d;transition:all .3s ease-in-out;flex-wrap:nowrap;overflow-x:auto;white-space:nowrap}.filter-component[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #0000001a;transform:translateY(-1px)}.filter-label[_ngcontent-%COMP%]{font-weight:700;color:var(--p-primary-700);font-size:.8rem;text-transform:uppercase;letter-spacing:.3px;margin:0;white-space:nowrap;flex-shrink:0}.filter-badges[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;gap:.5rem;align-items:center;overflow-x:auto;flex:1}.filter-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:0;border:none;flex-shrink:0}.clear-all-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.3rem;padding:.3rem .6rem;font-size:.8rem}.chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem;border-radius:16px;font-size:.8rem;font-weight:600;text-transform:uppercase;letter-spacing:.2px;border:none;cursor:pointer;transition:all .2s ease-in-out;position:relative;min-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex-shrink:0}.filter-badge-icon[_ngcontent-%COMP%]{font-size:.8rem;opacity:.8;color:var(--p-primary-600)}.filter-key[_ngcontent-%COMP%]{font-weight:700;color:var(--p-primary-800);font-size:.8rem}.filter-separator[_ngcontent-%COMP%]{color:var(--p-primary-800);font-weight:400;font-size:.8rem}.filter-value[_ngcontent-%COMP%]{font-weight:600;color:var(--p-primary-800);font-size:.8rem}.btn-outline-primary.chip[_ngcontent-%COMP%]{background:var(--p-surface-0);color:var(--p-primary-800);border:1px solid var(--p-primary-300)}.btn-outline-primary.chip[_ngcontent-%COMP%]:hover{background:var(--p-primary-50);color:var(--p-primary-900);border:1px solid var(--p-primary-400);transform:translateY(-1px);box-shadow:0 3px 6px var(--p-primary-200)}.btn-outline-warning.chip[_ngcontent-%COMP%]{background:var(--p-surface-0);color:var(--p-orange-700);border:1px solid var(--p-orange-300)}.btn-outline-warning.chip[_ngcontent-%COMP%]:hover{background:var(--p-orange-50);color:var(--p-orange-900);border:1px solid var(--p-orange-400);transform:translateY(-1px);box-shadow:0 3px 6px var(--p-orange-200)}.close-icon[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:14px;height:14px;border-radius:50%;background-color:var(--p-primary-100);color:var(--p-primary-700);font-size:.8rem;transition:all .2s ease-in-out;flex-shrink:0}.empty-state[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--p-surface-0) 0%,var(--p-surface-100) 100%);border:2px dashed var(--p-surface-300);box-shadow:none;justify-content:center}.empty-state[_ngcontent-%COMP%]:hover{transform:none;box-shadow:none}.empty-state-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:0;width:100%;overflow:hidden}.empty-state-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--p-surface-600);opacity:.6;flex-shrink:0}.empty-state-text[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex:1;overflow:hidden;white-space:nowrap}.empty-state-title[_ngcontent-%COMP%]{font-weight:700;color:var(--p-surface-700);margin:0;font-size:1rem;white-space:nowrap;flex-shrink:0}.empty-state-description[_ngcontent-%COMP%]{color:var(--p-surface-600);margin:0;font-size:1rem;line-height:1.2;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1}@media (max-width: 768px){.filter-component[_ngcontent-%COMP%]{padding:.4rem .6rem;gap:.3rem;font-size:.7rem}.filter-badges[_ngcontent-%COMP%]{gap:.2rem}.chip[_ngcontent-%COMP%]{font-size:.65rem;padding:.25rem .4rem;max-width:120px;min-height:20px}.empty-state-content[_ngcontent-%COMP%]{gap:.3rem}.empty-state-icon[_ngcontent-%COMP%]{font-size:1rem}.empty-state-title[_ngcontent-%COMP%]{font-size:.7rem}.empty-state-description[_ngcontent-%COMP%]{font-size:.65rem}}@keyframes _ngcontent-%COMP%_filterSlideIn{0%{opacity:0;transform:translateY(-5px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.chip[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_filterSlideIn .2s ease-out}.chip[_ngcontent-%COMP%]:focus{outline:2px solid var(--p-primary-500);outline-offset:1px}.chip[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none!important;background:var(--p-surface-200);color:var(--p-surface-500);border-color:var(--p-surface-300)}"]});let r=t;return r})();function Uf(r,t){if(r&1&&(U(0,"th"),Ie(1),G()),r&2){let e=t.$implicit;A(),je(e)}}function zf(r,t){if(r&1&&(U(0,"td"),Ie(1),G()),r&2){let e=t.$implicit,i=I().$implicit;A(),je(i[e])}}function Gf(r,t){if(r&1&&(U(0,"tr"),ce(1,zf,2,1,"td",2),G()),r&2){let e=I();A(),M("ngForOf",e.tableOptions.columns)}}var mc=(()=>{let t=class t{get tableOptions(){return this.widget?.config?.options}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Me({type:t,selectors:[["vis-table"]],inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},decls:7,vars:2,consts:[[1,"table-container"],[1,"data-table"],[4,"ngFor","ngForOf"]],template:function(n,s){n&1&&(U(0,"div",0)(1,"table",1)(2,"thead")(3,"tr"),ce(4,Uf,2,1,"th",2),G()(),U(5,"tbody"),ce(6,Gf,2,1,"tr",2),G()()()),n&2&&(A(4),M("ngForOf",s.tableOptions.columns),A(2),M("ngForOf",s.tableOptions.data))},dependencies:[Ne,Qi],styles:[".table-container[_ngcontent-%COMP%]{padding:1rem;overflow-x:auto}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.875rem}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem;text-align:left;border-bottom:1px solid #e5e7eb}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f9fafb;font-weight:600}.data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9fafb}"]});let r=t;return r})();var gc=(()=>{let t=class t{get tileOptions(){return this.widget?.config?.options}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Me({type:t,selectors:[["vis-tile"]],inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},decls:12,vars:19,consts:[[1,"tile-container"],[1,"tile-content"],[1,"tile-left"],[1,"tile-value"],[1,"tile-description"],[1,"tile-right"],[1,"tile-change"],[1,"tile-icon"]],template:function(n,s){n&1&&(U(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),Ie(4),G(),U(5,"div",4),Ie(6),G()(),U(7,"div",5)(8,"div",6),Ie(9),G(),U(10,"div",7),xe(11,"i"),G()()()()),n&2&&(Br("background-color",s.tileOptions.backgroundColor||s.tileOptions.color)("opacity",s.tileOptions.backgroundOpacity||1),A(3),Br("color",s.tileOptions.color),A(),je(s.tileOptions.value),A(),Br("color",s.tileOptions.color),A(),je(s.tileOptions.description),A(2),ve("change-"+s.tileOptions.changeType),Br("color",s.tileOptions.color),A(),Wr(" ",s.tileOptions.change," "),A(),Br("color",s.tileOptions.color),A(),ve(s.tileOptions.icon))},dependencies:[Ne],styles:[".tile-container[_ngcontent-%COMP%]{padding:1.5rem;border-radius:.5rem;color:#fff;height:100%;display:flex;align-items:center}.tile-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%;gap:1rem}.tile-left[_ngcontent-%COMP%]{flex:1}.tile-right[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:.5rem}.tile-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin-bottom:.25rem}.tile-description[_ngcontent-%COMP%]{font-size:1.2rem;opacity:.8}.tile-change[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#fff}.tile-icon[_ngcontent-%COMP%]{font-size:1.5rem;opacity:.9;color:#fff}.change-positive[_ngcontent-%COMP%]{color:#10b981!important}.change-negative[_ngcontent-%COMP%]{color:#ef4444!important}.change-neutral[_ngcontent-%COMP%]{color:#6b7280!important}"]});let r=t;return r})();var xc=(()=>{let t=class t{get markdownOptions(){return this.widget?.config?.options}get markdownContent(){return this.markdownOptions?.content||""}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Me({type:t,selectors:[["vis-markdown-cell"]],inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},decls:2,vars:1,consts:[[1,"markdown-container"],[1,"markdown-content",3,"innerHTML"]],template:function(n,s){n&1&&(U(0,"div",0),xe(1,"div",1),G()),n&2&&(A(),M("innerHTML",s.markdownContent,li))},dependencies:[Ne],styles:[".markdown-container[_ngcontent-%COMP%]{padding:1rem;height:100%;overflow-y:auto}.markdown-content[_ngcontent-%COMP%]{line-height:1.6;color:#374151}.markdown-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin-top:1.5rem;margin-bottom:.5rem;font-weight:600;color:#111827}.markdown-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.875rem}.markdown-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem}.markdown-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem}.markdown-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:1rem}.markdown-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .markdown-content[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin-bottom:1rem;padding-left:1.5rem}.markdown-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.25rem}.markdown-content[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background-color:#f3f4f6;padding:.125rem .25rem;border-radius:.25rem;font-family:Courier New,monospace;font-size:.875rem}.markdown-content[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{background-color:#f3f4f6;padding:1rem;border-radius:.5rem;overflow-x:auto;margin-bottom:1rem}.markdown-content[_ngcontent-%COMP%]   blockquote[_ngcontent-%COMP%]{border-left:4px solid #d1d5db;padding-left:1rem;margin:1rem 0;font-style:italic;color:#6b7280}"]});let r=t;return r})();var vc=(()=>{let t=class t{get codeOptions(){return this.widget?.config?.options}get codeContent(){return this.widget?.data||"// Code content will be displayed here"}get codeLanguage(){let i=this.codeOptions?.accessor||"";return i.endsWith(".ts")?"typescript":i.endsWith(".js")?"javascript":i.endsWith(".py")?"python":i.endsWith(".java")?"java":i.endsWith(".cpp")?"cpp":i.endsWith(".cs")?"csharp":"text"}copyCode(){navigator.clipboard.writeText(this.codeContent).then(()=>{}).catch(i=>{})}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Me({type:t,selectors:[["vis-code-cell"]],inputs:{widget:"widget",onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},decls:9,vars:2,consts:[[1,"code-container"],[1,"code-header"],[1,"code-language"],["title","Copy code",1,"copy-button",3,"click"],[1,"fas","fa-copy"],[1,"code-content"]],template:function(n,s){n&1&&(U(0,"div",0)(1,"div",1)(2,"span",2),Ie(3),G(),U(4,"button",3),me("click",function(){return s.copyCode()}),xe(5,"i",4),G()(),U(6,"pre",5)(7,"code"),Ie(8),G()()()),n&2&&(A(3),je(s.codeLanguage),A(5),je(s.codeContent))},dependencies:[Ne],styles:[".code-container[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;background-color:#1f2937;border-radius:.5rem;overflow:hidden}.code-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem 1rem;background-color:#374151;border-bottom:1px solid #4b5563}.code-language[_ngcontent-%COMP%]{color:#d1d5db;font-size:.875rem;font-weight:500;text-transform:uppercase}.copy-button[_ngcontent-%COMP%]{background:none;border:none;color:#9ca3af;cursor:pointer;padding:.25rem;border-radius:.25rem;transition:color .2s}.copy-button[_ngcontent-%COMP%]:hover{color:#d1d5db;background-color:#4b5563}.code-content[_ngcontent-%COMP%]{flex:1;margin:0;padding:1rem;overflow:auto;font-family:Courier New,Monaco,Menlo,monospace;font-size:.875rem;line-height:1.5;color:#e5e7eb;background-color:#1f2937}.code-content[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:none;padding:0;border-radius:0;font-family:inherit;font-size:inherit;color:inherit}"]});let r=t;return r})();function Xf(r,t){r&1&&ft(0)}var _c=r=>{switch(r?.config?.component){case"echart":return Bs;case"filter":return pc;case"table":return mc;case"tile":return gc;case"markdownCell":return xc;case"codeCell":return vc;default:return Bs}},yc=(()=>{let t=class t{constructor(){this.viewMode="chart",this.onDataLoad=new Ce,this.onUpdateFilter=new Ce,this.originalWidget=null,this.tableWidget=null,this.cachedCurrentWidget=null,this.lastWidgetId=null,this.lastViewMode=null}get currentWidget(){let i=this.widget?.id,n=this.viewMode;if(this.cachedCurrentWidget&&this.lastWidgetId===i&&this.lastViewMode===n)return this.cachedCurrentWidget;let s=this.getWidgetForCurrentMode();return this.cachedCurrentWidget={component:_c(s),inputs:{widget:s,onDataLoad:this.onDataLoad,onUpdateFilter:this.onUpdateFilter}},this.lastWidgetId=i,this.lastViewMode=n,this.cachedCurrentWidget}get isEchartComponent(){let i=this.getWidgetForCurrentMode();return _c(i)===Bs}getWidgetForCurrentMode(){return this.viewMode==="table"?this.getTableWidget():this.getOriginalWidget()}getOriginalWidget(){return this.originalWidget||(this.originalWidget=k({},this.widget)),this.originalWidget}getTableWidget(){return this.tableWidget||(this.tableWidget=this.createTableWidget()),this.tableWidget}createTableWidget(){let i=this.getOriginalWidget(),n=this.getDataExtractor(i),s=[],a=[];n?(s=n.getHeaders(i),a=n.extractData(i).map((l,h)=>{let f={};return s.forEach((u,d)=>{f[u]=l[d]||""}),f})):(s=["Property","Value"],a=[{Property:"Widget ID",Value:i.id},{Property:"Component Type",Value:i.config?.component||"Unknown"},{Property:"Title",Value:i.config?.header?.title||"Untitled"}]);let o={columns:s,data:a};return j(k({},i),{config:j(k({},i.config),{component:"table",options:o})})}getDataExtractor(i){let n=i.config?.component;if(n==="echart"){let s=this.getChartType(i);if(s)return this.getChartDataExtractor(s)}else return n==="table"?{extractData:s=>s.config?.options?.data||[],getHeaders:s=>s.config?.options?.columns||[],getSheetName:s=>this.getWidgetSheetName(s,"Table")}:n==="tile"?{extractData:s=>{let a=s.config?.options;return[[a?.value||"",a?.change||"",a?.changeType||"",a?.description||""]]},getHeaders:()=>["Value","Change","Type","Description"],getSheetName:s=>this.getWidgetSheetName(s,"Tile")}:this.getGenericDataExtractor()}getChartType(i){return i.config?.component==="echart"&&i.config?.options?.series?.[0]?.type?i.config.options.series[0].type:null}getChartDataExtractor(i){switch(i){case"pie":return{extractData:n=>{let s=n.config?.options?.series?.[0];return s?.data?s.data.map(a=>[a.name||"Unknown",a.value||0,this.calculatePercentage(a.value,s.data)]):[]},getHeaders:()=>["Category","Value","Percentage"],getSheetName:n=>this.getWidgetSheetName(n,"PieChart")};case"bar":return{extractData:n=>{let s=n.config?.options?.series?.[0],a=n.config?.options?.xAxis;if(!s?.data)return[];let o=[];return a&&(Array.isArray(a)?o=a[0]?.data||[]:a.data&&(o=a.data)),o.length===0&&(o=s.data.map((c,l)=>`Category ${l+1}`)),s.data.map((c,l)=>[o[l]||`Category ${l+1}`,c||0])},getHeaders:()=>["Category","Value"],getSheetName:n=>this.getWidgetSheetName(n,"BarChart")};case"line":return{extractData:n=>{let s=n.config?.options?.series,a=n.config?.options?.xAxis;if(!s||s.length===0)return[];let o=[];a&&(Array.isArray(a)?o=a[0]?.data||[]:a.data&&(o=a.data)),o.length===0&&s[0]?.data&&(o=s[0].data.map((l,h)=>`Point ${h+1}`));let c=[];return s.forEach((l,h)=>{l.data&&l.data.forEach((f,u)=>{h===0&&(c[u]=[o[u]||`Point ${u+1}`]),c[u]&&c[u].push(f||0)})}),c},getHeaders:n=>{let s=n.config?.options?.series;return!s||s.length===0?["Category"]:["Category",...s.map(a=>a.name||"Series")]},getSheetName:n=>this.getWidgetSheetName(n,"LineChart")};case"scatter":return{extractData:n=>{let s=n.config?.options?.series?.[0];return s?.data?s.data.map(a=>[a.name||"Point",Array.isArray(a.value)?a.value[0]||0:a.value||0,Array.isArray(a.value)?a.value[1]||0:""]):[]},getHeaders:()=>["Name","X","Y"],getSheetName:n=>this.getWidgetSheetName(n,"ScatterChart")};default:return this.getGenericDataExtractor()}}getGenericDataExtractor(){return{extractData:i=>{let n=[];if(n.push(["Widget ID",i.id]),n.push(["Component Type",i.config?.component||"Unknown"]),n.push(["Title",i.config?.header?.title||"Untitled"]),i.config?.options){let s=i.config.options;Object.keys(s).forEach(a=>{(typeof s[a]!="object"||s[a]===null)&&n.push([a,s[a]])})}return i.series&&i.series.length>0&&n.push(["Series Data",JSON.stringify(i.series)]),n},getHeaders:()=>["Property","Value"],getSheetName:i=>this.getWidgetSheetName(i,"Widget")}}getWidgetSheetName(i,n){let s=i.config?.header?.title||i.id;return`${n}_${s}`.replace(/[^a-zA-Z0-9_]/g,"_").substring(0,31)}calculatePercentage(i,n){let s=n.reduce((a,o)=>a+(o.value||0),0);return s===0?"0%":`${(i/s*100).toFixed(1)}%`}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Me({type:t,selectors:[["vis-widget"]],inputs:{widget:"widget",viewMode:"viewMode"},outputs:{onDataLoad:"onDataLoad",onUpdateFilter:"onUpdateFilter"},features:[Ut([Ns({echarts:()=>import("./chunk-VTG26B3E.js")})])],decls:2,vars:4,consts:[[4,"ngComponentOutlet","ngComponentOutletInputs"]],template:function(n,s){n&1&&(U(0,"div"),ce(1,Xf,1,0,"ng-container",0),G()),n&2&&(Br("height",s.widget.height,"px"),A(),M("ngComponentOutlet",s.currentWidget.component)("ngComponentOutletInputs",s.currentWidget.inputs))},dependencies:[Cl],encapsulation:2});let r=t;return r})();var wc=`
    .p-panel {
        display: block;
        border: 1px solid dt('panel.border.color');
        border-radius: dt('panel.border.radius');
        background: dt('panel.background');
        color: dt('panel.color');
    }

    .p-panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: dt('panel.header.padding');
        background: dt('panel.header.background');
        color: dt('panel.header.color');
        border-style: solid;
        border-width: dt('panel.header.border.width');
        border-color: dt('panel.header.border.color');
        border-radius: dt('panel.header.border.radius');
    }

    .p-panel-toggleable .p-panel-header {
        padding: dt('panel.toggleable.header.padding');
    }

    .p-panel-title {
        line-height: 1;
        font-weight: dt('panel.title.font.weight');
    }

    .p-panel-content {
        padding: dt('panel.content.padding');
    }

    .p-panel-footer {
        padding: dt('panel.footer.padding');
    }
`;var jf=["header"],Yf=["icons"],Kf=["content"],qf=["footer"],Qf=["headericons"],Zf=["contentWrapper"],Jf=["*",[["p-header"]],[["p-footer"]]],eu=["*","p-header","p-footer"],tu=r=>({transitionParams:r,height:"0",opacity:"0"}),ru=r=>({value:"hidden",params:r}),iu=r=>({transitionParams:r,height:"*",opacity:"1"}),nu=r=>({value:"visible",params:r}),su=r=>({$implicit:r});function au(r,t){if(r&1&&(U(0,"span"),Ie(1),G()),r&2){let e=I(2);ve(e.cx("title")),ke("id",e.id+"_header"),A(),je(e._header)}}function ou(r,t){r&1&&ft(0)}function lu(r,t){}function cu(r,t){r&1&&ce(0,lu,0,0,"ng-template")}function hu(r,t){r&1&&(vt(0),Rr(),xe(1,"svg",11),_t())}function fu(r,t){r&1&&(vt(0),Rr(),xe(1,"svg",12),_t())}function uu(r,t){if(r&1&&(vt(0),ce(1,hu,2,0,"ng-container",9)(2,fu,2,0,"ng-container",9),_t()),r&2){let e=I(4);A(),M("ngIf",!e.collapsed),A(),M("ngIf",e.collapsed)}}function du(r,t){}function pu(r,t){r&1&&ce(0,du,0,0,"ng-template")}function mu(r,t){if(r&1&&ce(0,uu,3,2,"ng-container",9)(1,pu,1,0,null,10),r&2){let e=I(3);M("ngIf",!e.headerIconsTemplate&&!e._headerIconsTemplate&&!(e.toggleButtonProps!=null&&e.toggleButtonProps.icon)),A(),M("ngTemplateOutlet",e.headerIconsTemplate||e._headerIconsTemplate)("ngTemplateOutletContext",ut(3,su,e.collapsed))}}function gu(r,t){if(r&1){let e=Te();U(0,"p-button",8),me("click",function(n){te(e);let s=I(2);return re(s.onIconClick(n))})("keydown",function(n){te(e);let s=I(2);return re(s.onKeyDown(n))}),ce(1,mu,2,5,"ng-template",null,1,or),G()}if(r&2){let e=I(2);M("text",!0)("rounded",!0)("styleClass",e.cx("pcToggleButton"))("buttonProps",e.toggleButtonProps),ke("id",e.id+"_header")("aria-label",e.buttonAriaLabel)("aria-controls",e.id+"_content")("aria-expanded",!e.collapsed)}}function xu(r,t){if(r&1){let e=Te();U(0,"div",6),me("click",function(n){te(e);let s=I();return re(s.onHeaderClick(n))}),ce(1,au,2,4,"span",5),Kr(2,1),ce(3,ou,1,0,"ng-container",4),U(4,"div"),ce(5,cu,1,0,null,4)(6,gu,3,8,"p-button",7),G()()}if(r&2){let e=I();ve(e.cx("header")),ke("id",e.id+"-titlebar"),A(),M("ngIf",e._header),A(2),M("ngTemplateOutlet",e.headerTemplate||e._headerTemplate),A(),ve(e.cx("icons")),A(),M("ngTemplateOutlet",e.iconTemplate||e._iconTemplate),A(),M("ngIf",e.toggleable)}}function vu(r,t){r&1&&ft(0)}function _u(r,t){r&1&&ft(0)}function yu(r,t){if(r&1&&(U(0,"div"),Kr(1,2),ce(2,_u,1,0,"ng-container",4),G()),r&2){let e=I();ve(e.cx("footer")),A(2),M("ngTemplateOutlet",e.footerTemplate||e._footerTemplate)}}var wu=`
    ${wc}

    /* For PrimeNG */
    .p-panel-collapsed > .p-panel-content-container,
    .p-panel-content-container.ng-animating {
        overflow: hidden;
    }
`,Cu={root:({instance:r})=>["p-panel p-component",{"p-panel-toggleable":r.toggleable,"p-panel-expanded":!r.collapsed&&r.toggleable,"p-panel-collapsed":r.collapsed&&r.toggleable}],icons:({instance:r})=>["p-panel-icons",{"p-panel-icons-start":r.iconPos==="start","p-panel-icons-end":r.iconPos==="end","p-panel-icons-center":r.iconPos==="center"}],header:"p-panel-header",title:"p-panel-title",headerActions:"p-panel-header-actions",pcToggleButton:"p-panel-toggle-button",contentContainer:"p-panel-content-container",content:"p-panel-content",footer:"p-panel-footer"},Cc=(()=>{class r extends $r{name="panel";theme=wu;classes=Cu;static \u0275fac=(()=>{let e;return function(n){return(e||(e=qt(r)))(n||r)}})();static \u0275prov=Vt({token:r,factory:r.\u0275fac})}return r})();var oo=(()=>{class r extends Cr{toggleable;_header;collapsed;id=hi("pn_id_");styleClass;iconPos="end";showHeader=!0;toggler="icon";transitionOptions="400ms cubic-bezier(0.86, 0, 0.07, 1)";toggleButtonProps;collapsedChange=new Ce;onBeforeToggle=new Ce;onAfterToggle=new Ce;footerFacet;animating;headerTemplate;iconTemplate;contentTemplate;footerTemplate;headerIconsTemplate;_headerTemplate;_iconTemplate;_contentTemplate;_footerTemplate;_headerIconsTemplate;contentWrapperViewChild;get buttonAriaLabel(){return this._header}_componentStyle=ht(Cc);onHeaderClick(e){this.toggler==="header"&&this.toggle(e)}onIconClick(e){this.toggler==="icon"&&this.toggle(e)}toggle(e){if(this.animating)return!1;this.animating=!0,this.onBeforeToggle.emit({originalEvent:e,collapsed:this.collapsed}),this.toggleable&&(this.collapsed?this.expand():this.collapse()),this.cd.markForCheck(),e.preventDefault()}expand(){this.collapsed=!1,this.collapsedChange.emit(this.collapsed),this.updateTabIndex()}collapse(){this.collapsed=!0,this.collapsedChange.emit(this.collapsed),this.updateTabIndex()}getBlockableElement(){return this.el.nativeElement}updateTabIndex(){this.contentWrapperViewChild&&this.contentWrapperViewChild.nativeElement.querySelectorAll('input, button, select, a, textarea, [tabindex]:not([tabindex="-1"])').forEach(i=>{this.collapsed?i.setAttribute("tabindex","-1"):i.removeAttribute("tabindex")})}onKeyDown(e){(e.code==="Enter"||e.code==="Space")&&(this.toggle(e),e.preventDefault())}onToggleDone(e){this.animating=!1,this.onAfterToggle.emit({originalEvent:e,collapsed:this.collapsed})}templates;ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"header":this._headerTemplate=e.template;break;case"content":this._contentTemplate=e.template;break;case"footer":this._footerTemplate=e.template;break;case"icons":this._iconTemplate=e.template;break;case"headericons":this._headerIconsTemplate=e.template;break;default:this._contentTemplate=e.template;break}})}static \u0275fac=(()=>{let e;return function(n){return(e||(e=qt(r)))(n||r)}})();static \u0275cmp=Me({type:r,selectors:[["p-panel"]],contentQueries:function(i,n,s){if(i&1&&($e(s,Il,5),$e(s,jf,4),$e(s,Yf,4),$e(s,Kf,4),$e(s,qf,4),$e(s,Qf,4),$e(s,wr,4)),i&2){let a;Se(a=Ee())&&(n.footerFacet=a.first),Se(a=Ee())&&(n.headerTemplate=a.first),Se(a=Ee())&&(n.iconTemplate=a.first),Se(a=Ee())&&(n.contentTemplate=a.first),Se(a=Ee())&&(n.footerTemplate=a.first),Se(a=Ee())&&(n.headerIconsTemplate=a.first),Se(a=Ee())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&et(Zf,5),i&2){let s;Se(s=Ee())&&(n.contentWrapperViewChild=s.first)}},hostAttrs:["data-pc-name","panel"],hostVars:3,hostBindings:function(i,n){i&2&&(gl("id",n.id),ve(n.cn(n.cx("root"),n.styleClass)))},inputs:{toggleable:[2,"toggleable","toggleable",Le],_header:[0,"header","_header"],collapsed:[2,"collapsed","collapsed",Le],id:"id",styleClass:"styleClass",iconPos:"iconPos",showHeader:[2,"showHeader","showHeader",Le],toggler:"toggler",transitionOptions:"transitionOptions",toggleButtonProps:"toggleButtonProps"},outputs:{collapsedChange:"collapsedChange",onBeforeToggle:"onBeforeToggle",onAfterToggle:"onAfterToggle"},features:[Ut([Cc]),ar],ngContentSelectors:eu,decls:7,vars:20,consts:[["contentWrapper",""],["icon",""],[3,"class","click",4,"ngIf"],["role","region",3,"id"],[4,"ngTemplateOutlet"],[3,"class",4,"ngIf"],[3,"click"],["severity","secondary","type","button","role","button",3,"text","rounded","styleClass","buttonProps","click","keydown",4,"ngIf"],["severity","secondary","type","button","role","button",3,"click","keydown","text","rounded","styleClass","buttonProps"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["data-p-icon","minus"],["data-p-icon","plus"]],template:function(i,n){if(i&1){let s=Te();Fi(Jf),ce(0,xu,7,9,"div",2),U(1,"div",3),me("@panelContent.done",function(o){return te(s),re(n.onToggleDone(o))}),U(2,"div",null,0),Kr(4),ce(5,vu,1,0,"ng-container",4),G(),ce(6,yu,3,3,"div",5),G()}i&2&&(M("ngIf",n.showHeader),A(),ve(n.cx("contentContainer")),M("id",n.id+"_content")("@panelContent",n.collapsed?ut(14,ru,ut(12,tu,n.animating?n.transitionOptions:"0ms")):ut(18,nu,ut(16,iu,n.animating?n.transitionOptions:"0ms"))),ke("aria-labelledby",n.id+"_header")("aria-hidden",n.collapsed)("tabindex",n.collapsed?"-1":void 0),A(),ve(n.cx("content")),A(3),M("ngTemplateOutlet",n.contentTemplate||n._contentTemplate),A(),M("ngIf",n.footerFacet||n.footerTemplate||n._footerTemplate))},dependencies:[Ne,Zt,Fr,Ml,Dl,di,ui,at],encapsulation:2,data:{animation:[ci("panelContent",[Cs("hidden",hr({height:"0"})),Cs("void",hr({height:"{{height}}"}),{params:{height:"0"}}),Cs("visible",hr({height:"*"})),fr("visible <=> hidden",[cr("{{transitionParams}}")]),fr("void => hidden",cr("{{transitionParams}}")),fr("void => visible",cr("{{transitionParams}}"))])]},changeDetection:0})}return r})(),Ws=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=sr({type:r});static \u0275inj=nr({imports:[oo,at,at]})}return r})();var Tc=`
    .p-drawer {
        display: flex;
        flex-direction: column;
        transform: translate3d(0px, 0px, 0px);
        position: relative;
        transition: transform 0.3s;
        background: dt('drawer.background');
        color: dt('drawer.color');
        border: 1px solid dt('drawer.border.color');
        box-shadow: dt('drawer.shadow');
    }

    .p-drawer-content {
        overflow-y: auto;
        flex-grow: 1;
        padding: dt('drawer.content.padding');
    }

    .p-drawer-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-shrink: 0;
        padding: dt('drawer.header.padding');
    }

    .p-drawer-footer {
        padding: dt('drawer.footer.padding');
    }

    .p-drawer-title {
        font-weight: dt('drawer.title.font.weight');
        font-size: dt('drawer.title.font.size');
    }

    .p-drawer-full .p-drawer {
        transition: none;
        transform: none;
        width: 100vw !important;
        height: 100vh !important;
        max-height: 100%;
        top: 0px !important;
        left: 0px !important;
        border-width: 1px;
    }

    .p-drawer-left .p-drawer-enter-from,
    .p-drawer-left .p-drawer-leave-to {
        transform: translateX(-100%);
    }

    .p-drawer-right .p-drawer-enter-from,
    .p-drawer-right .p-drawer-leave-to {
        transform: translateX(100%);
    }

    .p-drawer-top .p-drawer-enter-from,
    .p-drawer-top .p-drawer-leave-to {
        transform: translateY(-100%);
    }

    .p-drawer-bottom .p-drawer-enter-from,
    .p-drawer-bottom .p-drawer-leave-to {
        transform: translateY(100%);
    }

    .p-drawer-full .p-drawer-enter-from,
    .p-drawer-full .p-drawer-leave-to {
        opacity: 0;
    }

    .p-drawer-full .p-drawer-enter-active,
    .p-drawer-full .p-drawer-leave-active {
        transition: opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1);
    }

    .p-drawer-left .p-drawer {
        width: 20rem;
        height: 100%;
        border-inline-end-width: 1px;
    }

    .p-drawer-right .p-drawer {
        width: 20rem;
        height: 100%;
        border-inline-start-width: 1px;
    }

    .p-drawer-top .p-drawer {
        height: 10rem;
        width: 100%;
        border-block-end-width: 1px;
    }

    .p-drawer-bottom .p-drawer {
        height: 10rem;
        width: 100%;
        border-block-start-width: 1px;
    }

    .p-drawer-left .p-drawer-content,
    .p-drawer-right .p-drawer-content,
    .p-drawer-top .p-drawer-content,
    .p-drawer-bottom .p-drawer-content {
        width: 100%;
        height: 100%;
    }

    .p-drawer-open {
        display: flex;
    }

    .p-drawer-mask:dir(rtl) {
        flex-direction: row-reverse;
    }
`;var Tu=["header"],Su=["footer"],Eu=["content"],ku=["closeicon"],Iu=["headless"],Fu=["container"],Ou=["closeButton"],Au=["*"],Du=(r,t)=>({transform:r,transition:t}),Mu=r=>({value:"visible",params:r});function Pu(r,t){r&1&&ft(0)}function Lu(r,t){if(r&1&&ce(0,Pu,1,0,"ng-container",4),r&2){let e=I(2);M("ngTemplateOutlet",e.headlessTemplate||e._headlessTemplate)}}function Ru(r,t){r&1&&ft(0)}function Nu(r,t){if(r&1&&(U(0,"div"),Ie(1),G()),r&2){let e=I(3);ve(e.cx("title")),A(),je(e.header)}}function Bu(r,t){r&1&&(Rr(),xe(0,"svg",11)),r&2&&ke("data-pc-section","closeicon")}function Wu(r,t){}function Hu(r,t){r&1&&ce(0,Wu,0,0,"ng-template")}function $u(r,t){if(r&1&&ce(0,Bu,1,1,"svg",10)(1,Hu,1,0,null,4),r&2){let e=I(4);M("ngIf",!e.closeIconTemplate&&!e._closeIconTemplate),A(),M("ngTemplateOutlet",e.closeIconTemplate||e._closeIconTemplate)}}function Vu(r,t){if(r&1){let e=Te();U(0,"p-button",9),me("onClick",function(n){te(e);let s=I(3);return re(s.close(n))})("keydown.enter",function(n){te(e);let s=I(3);return re(s.close(n))}),ce(1,$u,2,2,"ng-template",null,1,or),G()}if(r&2){let e=I(3);M("ngClass",e.cx("pcCloseButton"))("buttonProps",e.closeButtonProps)("ariaLabel",e.ariaCloseLabel),ke("data-pc-section","closebutton")("data-pc-group-section","iconcontainer")}}function Uu(r,t){r&1&&ft(0)}function zu(r,t){r&1&&ft(0)}function Gu(r,t){if(r&1&&(vt(0),U(1,"div",5),ce(2,zu,1,0,"ng-container",4),G(),_t()),r&2){let e=I(3);A(),M("ngClass",e.cx("footer")),ke("data-pc-section","footer"),A(),M("ngTemplateOutlet",e.footerTemplate||e._footerTemplate)}}function Xu(r,t){if(r&1&&(U(0,"div",5),ce(1,Ru,1,0,"ng-container",4)(2,Nu,2,3,"div",6)(3,Vu,3,5,"p-button",7),G(),U(4,"div",5),Kr(5),ce(6,Uu,1,0,"ng-container",4),G(),ce(7,Gu,3,3,"ng-container",8)),r&2){let e=I(2);M("ngClass",e.cx("header")),ke("data-pc-section","header"),A(),M("ngTemplateOutlet",e.headerTemplate||e._headerTemplate),A(),M("ngIf",e.header),A(),M("ngIf",e.showCloseIcon&&e.closable),A(),M("ngClass",e.cx("content")),ke("data-pc-section","content"),A(2),M("ngTemplateOutlet",e.contentTemplate||e._contentTemplate),A(),M("ngIf",e.footerTemplate||e._footerTemplate)}}function ju(r,t){if(r&1){let e=Te();U(0,"div",3,0),me("@panelState.start",function(n){te(e);let s=I();return re(s.onAnimationStart(n))})("@panelState.done",function(n){te(e);let s=I();return re(s.onAnimationEnd(n))})("keydown",function(n){te(e);let s=I();return re(s.onKeyDown(n))}),gt(2,Lu,1,1,"ng-container")(3,Xu,8,9),G()}if(r&2){let e=I();It(e.style),ve(e.cn(e.cx("root"),e.styleClass)),M("@panelState",ut(11,Mu,qr(8,Du,e.transformOptions,e.transitionOptions))),ke("data-pc-name","sidebar")("data-pc-section","root"),A(2),xt(e.headlessTemplate||e._headlessTemplate?2:3)}}var Yu=`
    ${Tc}

    /** For PrimeNG **/
    .p-drawer {
        position: fixed;
        display: flex;
        flex-direction: column;
    }

    .p-drawer-left {
        top: 0;
        left: 0;
        width: 20rem;
        height: 100%;
    }

    .p-drawer-right {
        top: 0;
        right: 0;
        width: 20rem;
        height: 100%;
    }

    .p-drawer-top {
        top: 0;
        left: 0;
        width: 100%;
        height: 10rem;
    }

    .p-drawer-bottom {
        bottom: 0;
        left: 0;
        width: 100%;
        height: 10rem;
    }

    .p-drawer-full {
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        -webkit-transition: none;
        transition: none;
    }

    .p-overlay-mask-enter {
        animation: p-overlay-mask-enter-animation 150ms forwards;
    }

    .p-overlay-mask-leave {
        animation: p-overlay-mask-leave-animation 150ms forwards;
    }

    @keyframes p-overlay-mask-enter-animation {
        from {
            background-color: transparent;
        }
        to {
            background-color: rgba(0, 0, 0, 0.4);
        }
    }
    @keyframes p-overlay-mask-leave-animation {
        from {
            background-color: rgba(0, 0, 0, 0.4);
        }
        to {
            background-color: transparent;
        }
    }
`,Ku={mask:({instance:r})=>["p-drawer-mask",{"p-overlay-mask p-overlay-mask-enter":r.modal},{"p-drawer-full":r.fullScreen}],root:({instance:r})=>["p-drawer p-component",{"p-drawer-full":r.fullScreen,"p-drawer-open":r.visible},`p-drawer-${r.position}`],header:"p-drawer-header",title:"p-drawer-title",pcCloseButton:"p-drawer-close-button",content:"p-drawer-content",footer:"p-drawer-footer"},Sc=(()=>{class r extends $r{name="drawer";theme=Yu;classes=Ku;static \u0275fac=(()=>{let e;return function(n){return(e||(e=qt(r)))(n||r)}})();static \u0275prov=Vt({token:r,factory:r.\u0275fac})}return r})();var qu=La([hr({transform:"{{transform}}",opacity:0}),cr("{{transition}}")]),Qu=La([cr("{{transition}}",hr({transform:"{{transform}}",opacity:0}))]),lo=(()=>{class r extends Cr{appendTo="body";blockScroll=!1;style;styleClass;ariaCloseLabel;autoZIndex=!0;baseZIndex=0;modal=!0;closeButtonProps={severity:"secondary",text:!0,rounded:!0};dismissible=!0;showCloseIcon=!0;closeOnEscape=!0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";get visible(){return this._visible}set visible(e){this._visible=e}get position(){return this._position}set position(e){if(this._position=e,e==="full"){this.transformOptions="none";return}switch(e){case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break}}get fullScreen(){return this._fullScreen}set fullScreen(e){this._fullScreen=e,e&&(this.transformOptions="none")}header;maskStyle;closable=!0;onShow=new Ce;onHide=new Ce;visibleChange=new Ce;containerViewChild;closeButtonViewChild;initialized;_visible;_position="left";_fullScreen=!1;container;transformOptions="translate3d(-100%, 0px, 0px)";mask;maskClickListener;documentEscapeListener;animationEndListener;_componentStyle=ht(Sc);ngAfterViewInit(){super.ngAfterViewInit(),this.initialized=!0}headerTemplate;footerTemplate;contentTemplate;closeIconTemplate;headlessTemplate;_headerTemplate;_footerTemplate;_contentTemplate;_closeIconTemplate;_headlessTemplate;templates;ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this._contentTemplate=e.template;break;case"header":this._headerTemplate=e.template;break;case"footer":this._footerTemplate=e.template;break;case"closeicon":this._closeIconTemplate=e.template;break;case"headless":this._headlessTemplate=e.template;break;default:this._contentTemplate=e.template;break}})}onKeyDown(e){e.code==="Escape"&&this.hide(!1)}show(){this.container.setAttribute(this.attrSelector,""),this.autoZIndex&&ur.set("modal",this.container,this.baseZIndex||this.config.zIndex.modal),this.modal&&this.enableModality(),this.onShow.emit({}),this.visibleChange.emit(!0)}hide(e=!0){e&&this.onHide.emit({}),this.modal&&this.disableModality()}close(e){this.hide(),this.visibleChange.emit(!1),e.preventDefault()}enableModality(){let e=this.document.querySelectorAll(".p-drawer-open"),i=e.length,n=i==1?String(parseInt(this.container.style.zIndex)-1):String(parseInt(e[i-1].style.zIndex)-1);this.mask||(this.mask=this.renderer.createElement("div"),Ba(this.mask,"style",this.getMaskStyle()),Ba(this.mask,"style",`z-index: ${n}`),Na(this.mask,this.cx("mask")),this.dismissible&&(this.maskClickListener=this.renderer.listen(this.mask,"click",s=>{this.dismissible&&this.close(s)})),this.renderer.appendChild(this.document.body,this.mask),this.blockScroll&&Rl())}getMaskStyle(){return this.maskStyle?Object.entries(this.maskStyle).map(([e,i])=>`${e}: ${i}`).join("; "):""}disableModality(){this.mask&&(Tl(this.mask,"p-overlay-mask-enter"),Na(this.mask,"p-overlay-mask-leave"),this.animationEndListener=this.renderer.listen(this.mask,"animationend",this.destroyModal.bind(this)))}destroyModal(){this.unbindMaskClickListener(),this.mask&&this.renderer.removeChild(this.document.body,this.mask),this.blockScroll&&Nl(),this.unbindAnimationEndListener(),this.mask=null}onAnimationStart(e){switch(e.toState){case"visible":this.container=e.element,this.appendContainer(),this.show(),this.closeOnEscape&&this.bindDocumentEscapeListener();break}}onAnimationEnd(e){switch(e.toState){case"void":this.hide(!1),ur.clear(this.container),this.unbindGlobalListeners();break}}appendContainer(){this.appendTo&&(this.appendTo==="body"?this.renderer.appendChild(this.document.body,this.container):Es(this.appendTo,this.container))}bindDocumentEscapeListener(){let e=this.el?this.el.nativeElement.ownerDocument:this.document;this.documentEscapeListener=this.renderer.listen(e,"keydown",i=>{i.which==27&&parseInt(this.container.style.zIndex)===ur.get(this.container)&&this.close(i)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}unbindGlobalListeners(){this.unbindMaskClickListener(),this.unbindDocumentEscapeListener()}unbindAnimationEndListener(){this.animationEndListener&&this.mask&&(this.animationEndListener(),this.animationEndListener=null)}ngOnDestroy(){this.initialized=!1,this.visible&&this.modal&&this.destroyModal(),this.appendTo&&this.container&&this.renderer.appendChild(this.el.nativeElement,this.container),this.container&&this.autoZIndex&&ur.clear(this.container),this.container=null,this.unbindGlobalListeners(),this.unbindAnimationEndListener()}static \u0275fac=(()=>{let e;return function(n){return(e||(e=qt(r)))(n||r)}})();static \u0275cmp=Me({type:r,selectors:[["p-drawer"]],contentQueries:function(i,n,s){if(i&1&&($e(s,Tu,4),$e(s,Su,4),$e(s,Eu,4),$e(s,ku,4),$e(s,Iu,4),$e(s,wr,4)),i&2){let a;Se(a=Ee())&&(n.headerTemplate=a.first),Se(a=Ee())&&(n.footerTemplate=a.first),Se(a=Ee())&&(n.contentTemplate=a.first),Se(a=Ee())&&(n.closeIconTemplate=a.first),Se(a=Ee())&&(n.headlessTemplate=a.first),Se(a=Ee())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&(et(Fu,5),et(Ou,5)),i&2){let s;Se(s=Ee())&&(n.containerViewChild=s.first),Se(s=Ee())&&(n.closeButtonViewChild=s.first)}},inputs:{appendTo:"appendTo",blockScroll:[2,"blockScroll","blockScroll",Le],style:"style",styleClass:"styleClass",ariaCloseLabel:"ariaCloseLabel",autoZIndex:[2,"autoZIndex","autoZIndex",Le],baseZIndex:[2,"baseZIndex","baseZIndex",lr],modal:[2,"modal","modal",Le],closeButtonProps:"closeButtonProps",dismissible:[2,"dismissible","dismissible",Le],showCloseIcon:[2,"showCloseIcon","showCloseIcon",Le],closeOnEscape:[2,"closeOnEscape","closeOnEscape",Le],transitionOptions:"transitionOptions",visible:"visible",position:"position",fullScreen:"fullScreen",header:"header",maskStyle:"maskStyle",closable:[2,"closable","closable",Le]},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange"},features:[Ut([Sc]),ar],ngContentSelectors:Au,decls:1,vars:1,consts:[["container",""],["icon",""],["role","complementary",3,"class","style","keydown",4,"ngIf"],["role","complementary",3,"keydown"],[4,"ngTemplateOutlet"],[3,"ngClass"],[3,"class",4,"ngIf"],[3,"ngClass","buttonProps","ariaLabel","onClick","keydown.enter",4,"ngIf"],[4,"ngIf"],[3,"onClick","keydown.enter","ngClass","buttonProps","ariaLabel"],["data-p-icon","times",4,"ngIf"],["data-p-icon","times"]],template:function(i,n){i&1&&(Fi(),ce(0,ju,4,13,"div",2)),i&2&&M("ngIf",n.visible)},dependencies:[Ne,wl,Zt,Fr,ui,Pl,at],encapsulation:2,data:{animation:[ci("panelState",[fr("void => visible",[Ra(qu)]),fr("visible => void",[Ra(Qu)])])]},changeDetection:0})}return r})(),Ec=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=sr({type:r});static \u0275inj=nr({imports:[lo,at,at]})}return r})();var ed=()=>({height:"85vh",width:"100%","overflow-x":"hidden",overflow:"auto"}),kc=(()=>{let t=class t{constructor(){this.sidebarVisible=!0,this.onUpdate=new Ce,this.formModel={},this.items=[{label:"Positions",value:0},{label:"Options",value:1},{label:"Data Options",value:2}],this.activeItem=this.items[0],this.formWidgetOptions=new Os({}),this.form=new Os({}),this.formSeriesOptions=new Os({})}set widget(i){this._widget=i,setTimeout(()=>{this.formWidgetOptions.patchValue({position:i?.position,config:i?.config})},1e3)}get title(){return this.widget?.config?.header?.title}ngOnInit(){this.formModel={}}onActiveTabItemChange(i){this.activeItem=i}onWidgetSave(){let i=k(k({},this._widget),this.formModel);i.config.options.series=this.formModel.series,this.onUpdate.emit(i),this._widget&&this._widget.series&&this._widget.series?.push({})}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Me({type:t,selectors:[["vis-widget-config"]],inputs:{selectedDashboardId:"selectedDashboardId",widget:"widget"},outputs:{onUpdate:"onUpdate"},decls:11,vars:7,consts:[["id","panelId",2,"height","100%","overflow-y","visible"],[3,"ngSubmit","formGroup"],[1,"form-buttons"],[1,"form-button"],["type","button","label","Save",3,"click","outlined"],["type","button","label","Edit",1,"ui-button-warning","ml-2","mr-2",3,"outlined"],["type","reset","label","Reset",1,"ui-button-danger",3,"outlined"],["position","bottom-right","key","br"]],template:function(n,s){n&1&&(U(0,"div",0)(1,"p-scrollPanel")(2,"form",1),me("ngSubmit",function(){return s.onWidgetSave()}),G()(),U(3,"div",2)(4,"div",3)(5,"p-button",4),me("click",function(){return s.onWidgetSave()}),G()(),U(6,"div",3),xe(7,"p-button",5),G(),U(8,"div",3),xe(9,"p-button",6),G()()(),xe(10,"p-toast",7)),n&2&&(A(),It(Hr(6,ed)),A(),M("formGroup",s.form),A(3),M("outlined",!0),A(2),M("outlined",!0),A(2),M("outlined",!0))},dependencies:[Ne,As,$l,Hl,Ul,Vl,di,ui,jl,Xl,Ws,Yl,zl,Ms,Ds],styles:[".form-buttons[_ngcontent-%COMP%]{display:flex;justify-content:end;margin-top:2rem;padding:1.2rem;align-items:end;position:absolute;bottom:0;right:0}  .p-sidebar .p-sidebar-header .p-sidebar-close, .p-sidebar[_ngcontent-%COMP%]   .p-sidebar-header[_ngcontent-%COMP%]   .p-sidebar-icon[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-top-left-radius:5px;border-bottom-left-radius:5px;background:#fff;position:absolute;top:.625rem;padding:.4166666667rem!important;box-shadow:0 .125rem .25rem #00000014;z-index:20;left:-39px;height:3rem;width:3.25rem;color:red}  .form-alignment{margin-left:1rem;margin-right:1rem;width:86.2%}"]});let r=t;return r})();var Ic=`
    .p-menu {
        background: dt('menu.background');
        color: dt('menu.color');
        border: 1px solid dt('menu.border.color');
        border-radius: dt('menu.border.radius');
        min-width: 12.5rem;
    }

    .p-menu-list {
        margin: 0;
        padding: dt('menu.list.padding');
        outline: 0 none;
        list-style: none;
        display: flex;
        flex-direction: column;
        gap: dt('menu.list.gap');
    }

    .p-menu-item-content {
        transition:
            background dt('menu.transition.duration'),
            color dt('menu.transition.duration');
        border-radius: dt('menu.item.border.radius');
        color: dt('menu.item.color');
    }

    .p-menu-item-link {
        cursor: pointer;
        display: flex;
        align-items: center;
        text-decoration: none;
        overflow: hidden;
        position: relative;
        color: inherit;
        padding: dt('menu.item.padding');
        gap: dt('menu.item.gap');
        user-select: none;
        outline: 0 none;
    }

    .p-menu-item-label {
        line-height: 1;
    }

    .p-menu-item-icon {
        color: dt('menu.item.icon.color');
    }

    .p-menu-item.p-focus .p-menu-item-content {
        color: dt('menu.item.focus.color');
        background: dt('menu.item.focus.background');
    }

    .p-menu-item.p-focus .p-menu-item-icon {
        color: dt('menu.item.icon.focus.color');
    }

    .p-menu-item:not(.p-disabled) .p-menu-item-content:hover {
        color: dt('menu.item.focus.color');
        background: dt('menu.item.focus.background');
    }

    .p-menu-item:not(.p-disabled) .p-menu-item-content:hover .p-menu-item-icon {
        color: dt('menu.item.icon.focus.color');
    }

    .p-menu-overlay {
        box-shadow: dt('menu.shadow');
    }

    .p-menu-submenu-label {
        background: dt('menu.submenu.label.background');
        padding: dt('menu.submenu.label.padding');
        color: dt('menu.submenu.label.color');
        font-weight: dt('menu.submenu.label.font.weight');
    }

    .p-menu-separator {
        border-block-start: 1px solid dt('menu.separator.border.color');
    }
`;var rd=["pMenuItemContent",""],$s=r=>({$implicit:r}),id=()=>({exact:!1}),nd=r=>({item:r});function sd(r,t){r&1&&ft(0)}function ad(r,t){if(r&1&&(U(0,"a",6),ce(1,sd,1,0,"ng-container",7),G()),r&2){let e=I(2),i=_r(4);ve(e.cx("itemLink")),M("target",e.item.target),ke("title",e.item.title)("href",e.item.url||null,_s)("data-automationid",e.item.automationId)("tabindex",-1)("data-pc-section","action"),A(),M("ngTemplateOutlet",i)("ngTemplateOutletContext",ut(10,$s,e.item))}}function od(r,t){r&1&&ft(0)}function ld(r,t){if(r&1&&(U(0,"a",8),ce(1,od,1,0,"ng-container",7),G()),r&2){let e=I(2),i=_r(4);ve(e.cx("itemLink")),M("routerLink",e.item.routerLink)("queryParams",e.item.queryParams)("routerLinkActiveOptions",e.item.routerLinkActiveOptions||Hr(18,id))("target",e.item.target)("fragment",e.item.fragment)("queryParamsHandling",e.item.queryParamsHandling)("preserveFragment",e.item.preserveFragment)("skipLocationChange",e.item.skipLocationChange)("replaceUrl",e.item.replaceUrl)("state",e.item.state),ke("data-automationid",e.item.automationId)("tabindex",-1)("data-pc-section","action")("title",e.item.title),A(),M("ngTemplateOutlet",i)("ngTemplateOutletContext",ut(19,$s,e.item))}}function cd(r,t){if(r&1&&(vt(0),ce(1,ad,2,12,"a",4)(2,ld,2,21,"a",5),_t()),r&2){let e=I();A(),M("ngIf",!(e.item!=null&&e.item.routerLink)),A(),M("ngIf",e.item==null?null:e.item.routerLink)}}function hd(r,t){}function fd(r,t){r&1&&ce(0,hd,0,0,"ng-template")}function ud(r,t){if(r&1&&(vt(0),ce(1,fd,1,0,null,7),_t()),r&2){let e=I();A(),M("ngTemplateOutlet",e.itemTemplate)("ngTemplateOutletContext",ut(2,$s,e.item))}}function dd(r,t){if(r&1&&xe(0,"span"),r&2){let e=I(2);It(e.item.iconStyle),ve(e.cx("itemIcon",ut(4,nd,e.item)))}}function pd(r,t){if(r&1&&(U(0,"span"),Ie(1),G()),r&2){let e=I(2);ve(e.cx("itemLabel")),A(),je(e.item.label)}}function md(r,t){if(r&1&&xe(0,"span",12),r&2){let e=I(2);M("innerHTML",e.sanitizeHtml(e.item.label),li)}}function gd(r,t){if(r&1&&xe(0,"p-badge",13),r&2){let e=I(2);M("styleClass",e.item.badgeStyleClass)("value",e.item.badge)}}function xd(r,t){if(r&1&&ce(0,dd,1,6,"span",9)(1,pd,2,3,"span",10)(2,md,1,1,"ng-template",null,1,or)(4,gd,1,2,"p-badge",11),r&2){let e=_r(3),i=I();M("ngIf",i.item.icon),A(),M("ngIf",i.item.escape!==!1)("ngIfElse",e),A(3),M("ngIf",i.item.badge)}}var vd=["start"],_d=["end"],yd=["header"],wd=["item"],Cd=["submenuheader"],bd=["list"],Td=["container"],Sd=(r,t)=>({showTransitionParams:r,hideTransitionParams:t}),Ed=r=>({value:"visible",params:r}),Ac=(r,t)=>({item:r,id:t});function kd(r,t){r&1&&ft(0)}function Id(r,t){if(r&1&&(U(0,"div"),ce(1,kd,1,0,"ng-container",8),G()),r&2){let e=I(2);ve(e.cx("start")),ke("data-pc-section","start"),A(),M("ngTemplateOutlet",e.startTemplate??e._startTemplate)}}function Fd(r,t){if(r&1&&xe(0,"li",12),r&2){let e=I(4);ve(e.cx("separator"))}}function Od(r,t){if(r&1&&(U(0,"span"),Ie(1),G()),r&2){let e=I(3).$implicit;A(),je(e.label)}}function Ad(r,t){if(r&1&&xe(0,"span",16),r&2){let e=I(3).$implicit,i=I(3);M("innerHTML",i.sanitizeHtml(e.label),li)}}function Dd(r,t){if(r&1&&(vt(0),ce(1,Od,2,1,"span",15)(2,Ad,1,1,"ng-template",null,2,or),_t()),r&2){let e=_r(3),i=I(2).$implicit;A(),M("ngIf",i.escape!==!1)("ngIfElse",e)}}function Md(r,t){r&1&&ft(0)}function Pd(r,t){if(r&1&&(U(0,"li",13),ce(1,Dd,4,2,"ng-container",7)(2,Md,1,0,"ng-container",14),G()),r&2){let e=I(),i=e.$implicit,n=e.index,s=I(3);ve(s.cx("submenuLabel")),M("tooltipOptions",i.tooltipOptions),ke("data-automationid",i.automationId)("id",s.menuitemId(i,s.id,n)),A(),M("ngIf",!s.submenuHeaderTemplate&&!s._submenuHeaderTemplate),A(),M("ngTemplateOutlet",s.submenuHeaderTemplate??s._submenuHeaderTemplate)("ngTemplateOutletContext",ut(8,$s,i))}}function Ld(r,t){if(r&1&&xe(0,"li",12),r&2){let e=I(5);ve(e.cx("separator"))}}function Rd(r,t){if(r&1){let e=Te();U(0,"li",18),me("onMenuItemClick",function(n){te(e);let s=I(),a=s.$implicit,o=s.index,c=I().index,l=I(3);return re(l.itemClick(n,l.menuitemId(a,l.id,c,o)))}),G()}if(r&2){let e=I(),i=e.$implicit,n=e.index,s=I().index,a=I(3);It(i.style),ve(a.cn(a.cx("item",qr(13,Ac,i,a.menuitemId(i,a.id,s,n))),i==null?null:i.styleClass)),M("pMenuItemContent",i)("itemTemplate",a.itemTemplate??a._itemTemplate)("tooltipOptions",i.tooltipOptions),ke("data-pc-section","menuitem")("aria-label",a.label(i.label))("data-p-focused",a.isItemFocused(a.menuitemId(i,a.id,s,n)))("data-p-disabled",a.disabled(i.disabled))("aria-disabled",a.disabled(i.disabled))("id",a.menuitemId(i,a.id,s,n))}}function Nd(r,t){if(r&1&&ce(0,Ld,1,2,"li",10)(1,Rd,1,16,"li",17),r&2){let e=t.$implicit,i=I().$implicit;M("ngIf",e.separator&&(e.visible!==!1||i.visible!==!1)),A(),M("ngIf",!e.separator&&e.visible!==!1&&(e.visible!==void 0||i.visible!==!1))}}function Bd(r,t){if(r&1&&ce(0,Fd,1,2,"li",10)(1,Pd,3,10,"li",11)(2,Nd,2,2,"ng-template",9),r&2){let e=t.$implicit;M("ngIf",e.separator&&e.visible!==!1),A(),M("ngIf",!e.separator),A(),M("ngForOf",e.items)}}function Wd(r,t){if(r&1&&ce(0,Bd,3,3,"ng-template",9),r&2){let e=I(2);M("ngForOf",e.model)}}function Hd(r,t){if(r&1&&xe(0,"li",12),r&2){let e=I(4);ve(e.cx("separator"))}}function $d(r,t){if(r&1){let e=Te();U(0,"li",20),me("onMenuItemClick",function(n){te(e);let s=I(),a=s.$implicit,o=s.index,c=I(3);return re(c.itemClick(n,c.menuitemId(a,c.id,o)))}),G()}if(r&2){let e=I(),i=e.$implicit,n=e.index,s=I(3);ve(s.cn(s.cx("item",qr(12,Ac,i,s.menuitemId(i,s.id,n))),i==null?null:i.styleClass)),M("pMenuItemContent",i)("itemTemplate",s.itemTemplate??s._itemTemplate)("ngStyle",i.style)("tooltipOptions",i.tooltipOptions),ke("data-pc-section","menuitem")("aria-label",s.label(i.label))("data-p-focused",s.isItemFocused(s.menuitemId(i,s.id,n)))("data-p-disabled",s.disabled(i.disabled))("aria-disabled",s.disabled(i.disabled))("id",s.menuitemId(i,s.id,n))}}function Vd(r,t){if(r&1&&ce(0,Hd,1,2,"li",10)(1,$d,1,15,"li",19),r&2){let e=t.$implicit;M("ngIf",e.separator&&e.visible!==!1),A(),M("ngIf",!e.separator&&e.visible!==!1)}}function Ud(r,t){if(r&1&&ce(0,Vd,2,2,"ng-template",9),r&2){let e=I(2);M("ngForOf",e.model)}}function zd(r,t){r&1&&ft(0)}function Gd(r,t){if(r&1&&(U(0,"div"),ce(1,zd,1,0,"ng-container",8),G()),r&2){let e=I(2);ve(e.cx("end")),ke("data-pc-section","end"),A(),M("ngTemplateOutlet",e.endTemplate??e._endTemplate)}}function Xd(r,t){if(r&1){let e=Te();U(0,"div",4,0),me("click",function(n){te(e);let s=I();return re(s.onOverlayClick(n))})("@overlayAnimation.start",function(n){te(e);let s=I();return re(s.onOverlayAnimationStart(n))})("@overlayAnimation.done",function(n){te(e);let s=I();return re(s.onOverlayAnimationEnd(n))}),ce(2,Id,2,4,"div",5),U(3,"ul",6,1),me("focus",function(n){te(e);let s=I();return re(s.onListFocus(n))})("blur",function(n){te(e);let s=I();return re(s.onListBlur(n))})("keydown",function(n){te(e);let s=I();return re(s.onListKeyDown(n))}),ce(5,Wd,1,1,null,7)(6,Ud,1,1,null,7),G(),ce(7,Gd,2,4,"div",5),G()}if(r&2){let e=I();It(e.sx("root")),ve(e.cn(e.cx("root"),e.styleClass)),M("ngStyle",e.style)("@overlayAnimation",ut(24,Ed,qr(21,Sd,e.showTransitionOptions,e.hideTransitionOptions)))("@.disabled",e.popup!==!0),ke("data-pc-name","menu")("id",e.id),A(2),M("ngIf",e.startTemplate??e._startTemplate),A(),ve(e.cx("list")),ke("id",e.id+"_list")("tabindex",e.getTabIndexValue())("data-pc-section","menu")("aria-activedescendant",e.activedescendant())("aria-label",e.ariaLabel)("aria-labelledBy",e.ariaLabelledBy),A(2),M("ngIf",e.hasSubMenu()),A(),M("ngIf",!e.hasSubMenu()),A(),M("ngIf",e.endTemplate??e._endTemplate)}}var jd={root:({instance:r})=>({position:r.popup?"absolute":"relative"})},Yd={root:({instance:r})=>["p-menu p-component",{"p-menu-overlay":r.popup}],start:"p-menu-start",list:"p-menu-list",submenuLabel:"p-menu-submenu-label",separator:"p-menu-separator",end:"p-menu-end",item:({instance:r,item:t,id:e})=>["p-menu-item",{"p-focus":r.focusedOptionId()&&e===r.focusedOptionId(),"p-disabled":r.disabled(t.disabled)},t.styleClass],itemContent:"p-menu-item-content",itemLink:"p-menu-item-link",itemIcon:({item:r})=>["p-menu-item-icon",r.icon,r.iconClass],itemLabel:"p-menu-item-label"},Hs=(()=>{class r extends $r{name="menu";theme=Ic;classes=Yd;inlineStyles=jd;static \u0275fac=(()=>{let e;return function(n){return(e||(e=qt(r)))(n||r)}})();static \u0275prov=Vt({token:r,factory:r.\u0275fac})}return r})();var Kd=(()=>{class r extends Cr{item;itemTemplate;onMenuItemClick=new Ce;menu;_componentStyle=ht(Hs);constructor(e){super(),this.menu=e}onItemClick(e,i){this.onMenuItemClick.emit({originalEvent:e,item:i})}static \u0275fac=function(i){return new(i||r)(Ke(vs(()=>cn)))};static \u0275cmp=Me({type:r,selectors:[["","pMenuItemContent",""]],inputs:{item:[0,"pMenuItemContent","item"],itemTemplate:"itemTemplate"},outputs:{onMenuItemClick:"onMenuItemClick"},features:[Ut([Hs]),ar],attrs:rd,decls:5,vars:5,consts:[["itemContent",""],["htmlLabel",""],[3,"click"],[4,"ngIf"],["pRipple","",3,"class","target",4,"ngIf"],["routerLinkActive","p-menu-item-link-active","pRipple","",3,"routerLink","queryParams","routerLinkActiveOptions","class","target","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state",4,"ngIf"],["pRipple","",3,"target"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["routerLinkActive","p-menu-item-link-active","pRipple","",3,"routerLink","queryParams","routerLinkActiveOptions","target","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state"],[3,"class","style",4,"ngIf"],[3,"class",4,"ngIf","ngIfElse"],[3,"styleClass","value",4,"ngIf"],[1,"p-menu-item-label",3,"innerHTML"],[3,"styleClass","value"]],template:function(i,n){if(i&1){let s=Te();U(0,"div",2),me("click",function(o){return te(s),re(n.onItemClick(o,n.item))}),ce(1,cd,3,2,"ng-container",3)(2,ud,2,4,"ng-container",3)(3,xd,5,4,"ng-template",null,0,or),G()}i&2&&(ve(n.cx("itemContent")),ke("data-pc-section","content"),A(),M("ngIf",!n.itemTemplate),A(),M("ngIf",n.itemTemplate))},dependencies:[Ne,Zt,Fr,Zi,ys,ws,Ji,fi,$a,Fl,at],encapsulation:2})}return r})(),cn=(()=>{class r extends Cr{overlayService;model;popup;style;styleClass;autoZIndex=!0;baseZIndex=0;showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)";hideTransitionOptions=".1s linear";ariaLabel;ariaLabelledBy;id;tabindex=0;appendTo=Qt(void 0);onShow=new Ce;onHide=new Ce;onBlur=new Ce;onFocus=new Ce;listViewChild;containerViewChild;$appendTo=Ki(()=>this.appendTo()||this.config.overlayAppendTo());container;scrollHandler;documentClickListener;documentResizeListener;preventDocumentDefault;target;visible;focusedOptionId=Ki(()=>this.focusedOptionIndex()!==-1?this.focusedOptionIndex():null);focusedOptionIndex=Nr(-1);selectedOptionIndex=Nr(-1);focused=!1;overlayVisible=!1;relativeAlign;_componentStyle=ht(Hs);constructor(e){super(),this.overlayService=e,this.id=this.id||hi("pn_id_")}toggle(e){this.visible?this.hide():this.show(e),this.preventDocumentDefault=!0}show(e){this.target=e.currentTarget,this.relativeAlign=e.relativeAlign,this.visible=!0,this.preventDocumentDefault=!0,this.overlayVisible=!0,this.cd.markForCheck()}ngOnInit(){super.ngOnInit(),this.popup||this.bindDocumentClickListener()}startTemplate;_startTemplate;endTemplate;_endTemplate;headerTemplate;_headerTemplate;itemTemplate;_itemTemplate;submenuHeaderTemplate;_submenuHeaderTemplate;templates;ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"start":this._startTemplate=e.template;break;case"end":this._endTemplate=e.template;break;case"item":this._itemTemplate=e.template;break;case"submenuheader":this._submenuHeaderTemplate=e.template;break;default:this._itemTemplate=e.template;break}})}getTabIndexValue(){return this.tabindex!==void 0?this.tabindex.toString():null}onOverlayAnimationStart(e){switch(e.toState){case"visible":this.popup&&(this.container=e.element,this.moveOnTop(),this.onShow.emit({}),this.attrSelector&&this.container.setAttribute(this.attrSelector,""),this.appendOverlay(),this.alignOverlay(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener(),yr(this.listViewChild.nativeElement));break;case"void":this.onOverlayHide(),this.onHide.emit({});break}}onOverlayAnimationEnd(e){switch(e.toState){case"void":this.autoZIndex&&ur.clear(e.element);break}}alignOverlay(){this.relativeAlign?Ss(this.container,this.target):bs(this.container,this.target)}appendOverlay(){Ll.appendOverlay(this.container,this.$appendTo()==="body"?this.document.body:this.$appendTo(),this.$appendTo())}restoreOverlayAppend(){this.container&&this.$appendTo()!=="self"&&this.renderer.appendChild(this.el.nativeElement,this.container)}moveOnTop(){this.autoZIndex&&ur.set("menu",this.container,this.baseZIndex+this.config.zIndex.menu)}hide(){this.visible=!1,this.relativeAlign=!1,this.cd.markForCheck()}onWindowResize(){this.visible&&!Hn()&&this.hide()}menuitemId(e,i,n,s){return e?.id??`${i}_${n}${s!==void 0?"_"+s:""}`}isItemFocused(e){return this.focusedOptionId()===e}label(e){return typeof e=="function"?e():e}disabled(e){return typeof e=="function"?e():typeof e>"u"?!1:e}activedescendant(){return this.focused?this.focusedOptionId():void 0}onListFocus(e){this.focused||(this.focused=!0,!this.popup&&this.changeFocusedOptionIndex(0),this.onFocus.emit(e))}onListBlur(e){this.focused&&(this.focused=!1,this.changeFocusedOptionIndex(-1),this.selectedOptionIndex.set(-1),this.focusedOptionIndex.set(-1),this.onBlur.emit(e))}onListKeyDown(e){switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"Enter":this.onEnterKey(e);break;case"NumpadEnter":this.onEnterKey(e);break;case"Space":this.onSpaceKey(e);break;case"Escape":case"Tab":this.popup&&(yr(this.target),this.hide()),this.overlayVisible&&this.hide();break;default:break}}onArrowDownKey(e){let i=this.findNextOptionIndex(this.focusedOptionIndex());this.changeFocusedOptionIndex(i),e.preventDefault()}onArrowUpKey(e){if(e.altKey&&this.popup)yr(this.target),this.hide(),e.preventDefault();else{let i=this.findPrevOptionIndex(this.focusedOptionIndex());this.changeFocusedOptionIndex(i),e.preventDefault()}}onHomeKey(e){this.changeFocusedOptionIndex(0),e.preventDefault()}onEndKey(e){this.changeFocusedOptionIndex(Wn(this.containerViewChild.nativeElement,'li[data-pc-section="menuitem"][data-p-disabled="false"]').length-1),e.preventDefault()}onEnterKey(e){let i=Ai(this.containerViewChild.nativeElement,`li[id="${`${this.focusedOptionIndex()}`}"]`),n=i&&Ai(i,'a[data-pc-section="action"]');this.popup&&yr(this.target),n?n.click():i&&i.click(),e.preventDefault()}onSpaceKey(e){this.onEnterKey(e)}findNextOptionIndex(e){let n=[...Wn(this.containerViewChild.nativeElement,'li[data-pc-section="menuitem"][data-p-disabled="false"]')].findIndex(s=>s.id===e);return n>-1?n+1:0}findPrevOptionIndex(e){let n=[...Wn(this.containerViewChild.nativeElement,'li[data-pc-section="menuitem"][data-p-disabled="false"]')].findIndex(s=>s.id===e);return n>-1?n-1:0}changeFocusedOptionIndex(e){let i=Wn(this.containerViewChild.nativeElement,'li[data-pc-section="menuitem"][data-p-disabled="false"]');if(i.length>0){let n=e>=i.length?i.length-1:e<0?0:e;n>-1&&this.focusedOptionIndex.set(i[n].getAttribute("id"))}}itemClick(e,i){let{originalEvent:n,item:s}=e;if(this.focused||(this.focused=!0,this.onFocus.emit()),s.disabled){n.preventDefault();return}!s.url&&!s.routerLink&&n.preventDefault(),s.command&&s.command({originalEvent:n,item:s}),this.popup&&this.hide(),!this.popup&&this.focusedOptionIndex()!==i&&this.focusedOptionIndex.set(i)}onOverlayClick(e){this.popup&&this.overlayService.add({originalEvent:e,target:this.el.nativeElement}),this.preventDocumentDefault=!0}bindDocumentClickListener(){if(!this.documentClickListener&&Qr(this.platformId)){let e=this.el?this.el.nativeElement.ownerDocument:"document";this.documentClickListener=this.renderer.listen(e,"click",i=>{let n=this.containerViewChild?.nativeElement&&!this.containerViewChild?.nativeElement.contains(i.target),s=!(this.target&&(this.target===i.target||this.target.contains(i.target)));!this.popup&&n&&s&&this.onListBlur(i),this.preventDocumentDefault&&this.overlayVisible&&n&&s&&(this.hide(),this.preventDocumentDefault=!1)})}}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){if(!this.documentResizeListener&&Qr(this.platformId)){let e=this.document.defaultView;this.documentResizeListener=this.renderer.listen(e,"resize",this.onWindowResize.bind(this))}}unbindDocumentResizeListener(){this.documentResizeListener&&(this.documentResizeListener(),this.documentResizeListener=null)}bindScrollListener(){!this.scrollHandler&&Qr(this.platformId)&&(this.scrollHandler=new Fs(this.target,()=>{this.visible&&this.hide()})),this.scrollHandler?.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&(this.scrollHandler.unbindScrollListener(),this.scrollHandler=null)}onOverlayHide(){this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.preventDocumentDefault=!1,this.cd.destroyed||(this.target=null)}ngOnDestroy(){this.popup&&(this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.container&&this.autoZIndex&&ur.clear(this.container),this.restoreOverlayAppend(),this.onOverlayHide()),this.popup||this.unbindDocumentClickListener(),super.ngOnDestroy()}hasSubMenu(){return this.model?.some(e=>e.items)??!1}isItemHidden(e){return e.separator?e.visible===!1||e.items&&e.items.some(i=>i.visible!==!1):e.visible===!1}static \u0275fac=function(i){return new(i||r)(Ke(Is))};static \u0275cmp=Me({type:r,selectors:[["p-menu"]],contentQueries:function(i,n,s){if(i&1&&($e(s,vd,4),$e(s,_d,4),$e(s,yd,4),$e(s,wd,4),$e(s,Cd,4),$e(s,wr,4)),i&2){let a;Se(a=Ee())&&(n.startTemplate=a.first),Se(a=Ee())&&(n.endTemplate=a.first),Se(a=Ee())&&(n.headerTemplate=a.first),Se(a=Ee())&&(n.itemTemplate=a.first),Se(a=Ee())&&(n.submenuHeaderTemplate=a.first),Se(a=Ee())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&(et(bd,5),et(Td,5)),i&2){let s;Se(s=Ee())&&(n.listViewChild=s.first),Se(s=Ee())&&(n.containerViewChild=s.first)}},inputs:{model:"model",popup:[2,"popup","popup",Le],style:"style",styleClass:"styleClass",autoZIndex:[2,"autoZIndex","autoZIndex",Le],baseZIndex:[2,"baseZIndex","baseZIndex",lr],showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",id:"id",tabindex:[2,"tabindex","tabindex",lr],appendTo:[1,"appendTo"]},outputs:{onShow:"onShow",onHide:"onHide",onBlur:"onBlur",onFocus:"onFocus"},features:[Ut([Hs]),ar],decls:1,vars:1,consts:[["container",""],["list",""],["htmlSubmenuLabel",""],[3,"class","style","ngStyle","click",4,"ngIf"],[3,"click","ngStyle"],[3,"class",4,"ngIf"],["role","menu",3,"focus","blur","keydown"],[4,"ngIf"],[4,"ngTemplateOutlet"],["ngFor","",3,"ngForOf"],["role","separator",3,"class",4,"ngIf"],["pTooltip","","role","none",3,"class","tooltipOptions",4,"ngIf"],["role","separator"],["pTooltip","","role","none",3,"tooltipOptions"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngIf","ngIfElse"],[3,"innerHTML"],["pTooltip","","role","menuitem",3,"class","pMenuItemContent","itemTemplate","style","tooltipOptions","onMenuItemClick",4,"ngIf"],["pTooltip","","role","menuitem",3,"onMenuItemClick","pMenuItemContent","itemTemplate","tooltipOptions"],["pTooltip","","role","menuitem",3,"class","pMenuItemContent","itemTemplate","ngStyle","tooltipOptions","onMenuItemClick",4,"ngIf"],["pTooltip","","role","menuitem",3,"onMenuItemClick","pMenuItemContent","itemTemplate","ngStyle","tooltipOptions"]],template:function(i,n){i&1&&ce(0,Xd,8,26,"div",3),i&2&&M("ngIf",!n.popup||n.visible)},dependencies:[Ne,Qi,Zt,Fr,Oi,Zi,Kd,fi,en,$a,at],encapsulation:2,data:{animation:[ci("overlayAnimation",[fr(":enter",[hr({opacity:0,transform:"scaleY(0.8)"}),cr("{{showTransitionParams}}")]),fr(":leave",[cr("{{hideTransitionParams}}",hr({opacity:0}))])])]},changeDetection:0})}return r})(),Vs=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=sr({type:r});static \u0275inj=nr({imports:[cn,at,at]})}return r})();var rs={};rs.version="0.18.5";var Ni=1200,yn=1252,qd=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Qd={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},_0=function(r){qd.indexOf(r)!=-1&&(yn=Qd[0]=r)};function Zd(){_0(1252)}var is=function(r){Ni=r,_0(r)};function Jd(){is(1200),Zd()}function ep(r){for(var t=[],e=0;e<r.length>>1;++e)t[e]=String.fromCharCode(r.charCodeAt(2*e+1)+(r.charCodeAt(2*e)<<8));return t.join("")}var Us=function(t){return String.fromCharCode(t)},Mc=function(t){return String.fromCharCode(t)},qe;var zr=null,Yn=!0,gi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ns(r){for(var t="",e=0,i=0,n=0,s=0,a=0,o=0,c=0,l=0;l<r.length;)e=r.charCodeAt(l++),s=e>>2,i=r.charCodeAt(l++),a=(e&3)<<4|i>>4,n=r.charCodeAt(l++),o=(i&15)<<2|n>>6,c=n&63,isNaN(i)?o=c=64:isNaN(n)&&(c=64),t+=gi.charAt(s)+gi.charAt(a)+gi.charAt(o)+gi.charAt(c);return t}function ii(r){var t="",e=0,i=0,n=0,s=0,a=0,o=0,c=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<r.length;)s=gi.indexOf(r.charAt(l++)),a=gi.indexOf(r.charAt(l++)),e=s<<2|a>>4,t+=String.fromCharCode(e),o=gi.indexOf(r.charAt(l++)),i=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(i)),c=gi.indexOf(r.charAt(l++)),n=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var We=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),si=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Wi(r){return We?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function Pc(r){return We?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Dr=function(t){return We?si(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function fa(r){if(typeof ArrayBuffer>"u")return Dr(r);for(var t=new ArrayBuffer(r.length),e=new Uint8Array(t),i=0;i!=r.length;++i)e[i]=r.charCodeAt(i)&255;return t}function cs(r){if(Array.isArray(r))return r.map(function(i){return String.fromCharCode(i)}).join("");for(var t=[],e=0;e<r.length;++e)t[e]=String.fromCharCode(r[e]);return t.join("")}function tp(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}var Mt=We?function(r){return Buffer.concat(r.map(function(t){return Buffer.isBuffer(t)?t:si(t)}))}:function(r){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<r.length;++t)e+=r[t].length;var i=new Uint8Array(e),n=0;for(t=0,e=0;t<r.length;e+=n,++t)if(n=r[t].length,r[t]instanceof Uint8Array)i.set(r[t],e);else{if(typeof r[t]=="string")throw"wtf";i.set(new Uint8Array(r[t]),e)}return i}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function rp(r){for(var t=[],e=0,i=r.length+250,n=Wi(r.length+255),s=0;s<r.length;++s){var a=r.charCodeAt(s);if(a<128)n[e++]=a;else if(a<2048)n[e++]=192|a>>6&31,n[e++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=r.charCodeAt(++s)&1023;n[e++]=240|a>>8&7,n[e++]=128|a>>2&63,n[e++]=128|o>>6&15|(a&3)<<4,n[e++]=128|o&63}else n[e++]=224|a>>12&15,n[e++]=128|a>>6&63,n[e++]=128|a&63;e>i&&(t.push(n.slice(0,e)),e=0,n=Wi(65535),i=65530)}return t.push(n.slice(0,e)),Mt(t)}var mn=/\u0000/g,zs=/[\u0001-\u0006]/g;function gn(r){for(var t="",e=r.length-1;e>=0;)t+=r.charAt(e--);return t}function Mr(r,t){var e=""+r;return e.length>=t?e:rt("0",t-e.length)+e}function Co(r,t){var e=""+r;return e.length>=t?e:rt(" ",t-e.length)+e}function Zs(r,t){var e=""+r;return e.length>=t?e:e+rt(" ",t-e.length)}function ip(r,t){var e=""+Math.round(r);return e.length>=t?e:rt("0",t-e.length)+e}function np(r,t){var e=""+r;return e.length>=t?e:rt("0",t-e.length)+e}var Lc=Math.pow(2,32);function hn(r,t){if(r>Lc||r<-Lc)return ip(r,t);var e=Math.round(r);return np(e,t)}function Js(r,t){return t=t||0,r.length>=7+t&&(r.charCodeAt(t)|32)===103&&(r.charCodeAt(t+1)|32)===101&&(r.charCodeAt(t+2)|32)===110&&(r.charCodeAt(t+3)|32)===101&&(r.charCodeAt(t+4)|32)===114&&(r.charCodeAt(t+5)|32)===97&&(r.charCodeAt(t+6)|32)===108}var Rc=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],co=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function sp(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',r}var it={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},Nc={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ap={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ea(r,t,e){for(var i=r<0?-1:1,n=r*i,s=0,a=1,o=0,c=1,l=0,h=0,f=Math.floor(n);l<t&&(f=Math.floor(n),o=f*a+s,h=f*l+c,!(n-f<5e-8));)n=1/(n-f),s=a,a=o,c=l,l=h;if(h>t&&(l>t?(h=c,o=s):(h=l,o=a)),!e)return[0,i*o,h];var u=Math.floor(i*o/h);return[u,i*o-u*h,h]}function Gs(r,t,e){if(r>2958465||r<0)return null;var i=r|0,n=Math.floor(86400*(r-i)),s=0,a=[],o={D:i,T:n,u:86400*(r-i)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(i+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++i,++o.D)),i===60)a=e?[1317,10,29]:[1900,2,29],s=3;else if(i===0)a=e?[1317,8,29]:[1900,1,0],s=6;else{i>60&&--i;var c=new Date(1900,0,1);c.setDate(c.getDate()+i-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),i<60&&(s=(s+6)%7),e&&(s=dp(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=s,o}var y0=new Date(1899,11,31,0,0,0),op=y0.getTime(),lp=new Date(1900,2,1,0,0,0);function w0(r,t){var e=r.getTime();return t?e-=1461*24*60*60*1e3:r>=lp&&(e+=24*60*60*1e3),(e-(op+(r.getTimezoneOffset()-y0.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function bo(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function cp(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function hp(r){var t=r<0?12:11,e=bo(r.toFixed(12));return e.length<=t||(e=r.toPrecision(10),e.length<=t)?e:r.toExponential(5)}function fp(r){var t=bo(r.toFixed(11));return t.length>(r<0?12:11)||t==="0"||t==="-0"?r.toPrecision(6):t}function up(r){var t=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),e;return t>=-4&&t<=-1?e=r.toPrecision(10+t):Math.abs(t)<=9?e=hp(r):t===10?e=r.toFixed(10).substr(0,12):e=fp(r),bo(cp(e.toUpperCase()))}function vo(r,t){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):up(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return vi(14,w0(r,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+r)}function dp(r,t){t[0]-=581;var e=r.getDay();return r<60&&(e=(e+6)%7),e}function pp(r,t,e,i){var n="",s=0,a=0,o=e.y,c,l=0;switch(r){case 98:o=e.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(t.length){case 1:case 2:c=e.m,l=t.length;break;case 3:return co[e.m-1][1];case 5:return co[e.m-1][0];default:return co[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=e.d,l=t.length;break;case 3:return Rc[e.q][0];default:return Rc[e.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(e.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=e.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=e.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?Mr(e.S,t.length):(i>=2?a=i===3?1e3:100:a=i===1?10:1,s=Math.round(a*(e.S+e.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(n=Mr(s,2+i),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=e.D*24+e.H;break;case"[m]":case"[mm]":c=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":c=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+t}l=t.length===3?1:2;break;case 101:c=o,l=1;break}var h=l>0?Mr(c,l):"";return h}function xi(r){var t=3;if(r.length<=t)return r;for(var e=r.length%t,i=r.substr(0,e);e!=r.length;e+=t)i+=(i.length>0?",":"")+r.substr(e,t);return i}var C0=/%/g;function mp(r,t,e){var i=t.replace(C0,""),n=t.length-i.length;return ei(r,i,e*Math.pow(10,2*n))+rt("%",n)}function gp(r,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return ei(r,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function b0(r,t){var e,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+b0(r,-t);var n=r.indexOf(".");n===-1&&(n=r.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),e=(t/Math.pow(10,s)).toPrecision(i+1+(n+s)%n),e.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+s):e+="E+"+(a-s);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,n)+"."+e.substr(2+n),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,h){return c+l+h.substr(0,(n+s)%n)+"."+h.substr(s)+"E"})}else e=t.toExponential(i);return r.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),r.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var T0=/# (\?+)( ?)\/( ?)(\d+)/;function xp(r,t,e){var i=parseInt(r[4],10),n=Math.round(t*i),s=Math.floor(n/i),a=n-s*i,o=i;return e+(s===0?"":""+s)+" "+(a===0?rt(" ",r[1].length+1+r[4].length):Co(a,r[1].length)+r[2]+"/"+r[3]+Mr(o,r[4].length))}function vp(r,t,e){return e+(t===0?"":""+t)+rt(" ",r[1].length+2+r[4].length)}var S0=/^#*0*\.([0#]+)/,E0=/\).*[0#]/,k0=/\(###\) ###\\?-####/;function zt(r){for(var t="",e,i=0;i!=r.length;++i)switch(e=r.charCodeAt(i)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function Bc(r,t){var e=Math.pow(10,t);return""+Math.round(r*e)/e}function Wc(r,t){var e=r-Math.floor(r),i=Math.pow(10,t);return t<(""+Math.round(e*i)).length?0:Math.round(e*i)}function _p(r,t){return t<(""+Math.round((r-Math.floor(r))*Math.pow(10,t))).length?1:0}function yp(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function Tr(r,t,e){if(r.charCodeAt(0)===40&&!t.match(E0)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Tr("n",i,e):"("+Tr("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return gp(r,t,e);if(t.indexOf("%")!==-1)return mp(r,t,e);if(t.indexOf("E")!==-1)return b0(t,e);if(t.charCodeAt(0)===36)return"$"+Tr(r,t.substr(t.charAt(1)==" "?2:1),e);var n,s,a,o,c=Math.abs(e),l=e<0?"-":"";if(t.match(/^00+$/))return l+hn(c,t.length);if(t.match(/^[#?]+$/))return n=hn(e,0),n==="0"&&(n=""),n.length>t.length?n:zt(t.substr(0,t.length-n.length))+n;if(s=t.match(T0))return xp(s,c,l);if(t.match(/^#+0+$/))return l+hn(c,t.length-t.indexOf("0"));if(s=t.match(S0))return n=Bc(e,s[1].length).replace(/^([^\.]+)$/,"$1."+zt(s[1])).replace(/\.$/,"."+zt(s[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+rt("0",zt(s[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+Bc(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+xi(hn(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Tr(r,t,-e):xi(""+(Math.floor(e)+_p(e,s[1].length)))+"."+Mr(Wc(e,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Tr(r,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=gn(Tr(r,t.replace(/[\\-]/g,""),e)),a=0,gn(gn(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<n.length?n.charAt(a++):g==="0"?"0":""}));if(t.match(k0))return n=Tr(r,"##########",e),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=ea(c,Math.pow(10,a)-1,!1),n=""+l,h=ei("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),n+=h+s[2]+"/"+s[3],h=Zs(o[2],a),h.length<s[4].length&&(h=zt(s[4].substr(s[4].length-h.length))+h),n+=h,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=ea(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Co(o[1],a)+s[2]+"/"+s[3]+Zs(o[2],a):rt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=hn(e,0),t.length<=n.length?n:zt(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var f=t.indexOf(".")-a,u=t.length-n.length-f;return zt(t.substr(0,f)+n+t.substr(t.length-u))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=Wc(e,s[1].length),e<0?"-"+Tr(r,t,-e):xi(yp(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Mr(0,3-g.length):"")+g})+"."+Mr(a,s[1].length);switch(t){case"###,##0.00":return Tr(r,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var d=xi(hn(c,0));return d!=="0"?l+d:"";case"###,###.00":return Tr(r,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Tr(r,"#,##0.00",e).replace(/^0\./,".");default:}throw new Error("unsupported format |"+t+"|")}function wp(r,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return ei(r,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function Cp(r,t,e){var i=t.replace(C0,""),n=t.length-i.length;return ei(r,i,e*Math.pow(10,2*n))+rt("%",n)}function I0(r,t){var e,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+I0(r,-t);var n=r.indexOf(".");n===-1&&(n=r.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),e=(t/Math.pow(10,s)).toPrecision(i+1+(n+s)%n),!e.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+s):e+="E+"+(a-s),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,h){return c+l+h.substr(0,(n+s)%n)+"."+h.substr(s)+"E"})}else e=t.toExponential(i);return r.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),r.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Vr(r,t,e){if(r.charCodeAt(0)===40&&!t.match(E0)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Vr("n",i,e):"("+Vr("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return wp(r,t,e);if(t.indexOf("%")!==-1)return Cp(r,t,e);if(t.indexOf("E")!==-1)return I0(t,e);if(t.charCodeAt(0)===36)return"$"+Vr(r,t.substr(t.charAt(1)==" "?2:1),e);var n,s,a,o,c=Math.abs(e),l=e<0?"-":"";if(t.match(/^00+$/))return l+Mr(c,t.length);if(t.match(/^[#?]+$/))return n=""+e,e===0&&(n=""),n.length>t.length?n:zt(t.substr(0,t.length-n.length))+n;if(s=t.match(T0))return vp(s,c,l);if(t.match(/^#+0+$/))return l+Mr(c,t.length-t.indexOf("0"));if(s=t.match(S0))return n=(""+e).replace(/^([^\.]+)$/,"$1."+zt(s[1])).replace(/\.$/,"."+zt(s[1])),n=n.replace(/\.(\d*)$/,function(g,p){return"."+p+rt("0",zt(s[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+xi(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Vr(r,t,-e):xi(""+e)+"."+rt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Vr(r,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=gn(Vr(r,t.replace(/[\\-]/g,""),e)),a=0,gn(gn(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<n.length?n.charAt(a++):g==="0"?"0":""}));if(t.match(k0))return n=Vr(r,"##########",e),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=ea(c,Math.pow(10,a)-1,!1),n=""+l,h=ei("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),n+=h+s[2]+"/"+s[3],h=Zs(o[2],a),h.length<s[4].length&&(h=zt(s[4].substr(s[4].length-h.length))+h),n+=h,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=ea(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Co(o[1],a)+s[2]+"/"+s[3]+Zs(o[2],a):rt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+e,t.length<=n.length?n:zt(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var f=t.indexOf(".")-a,u=t.length-n.length-f;return zt(t.substr(0,f)+n+t.substr(t.length-u))}if(s=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Vr(r,t,-e):xi(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Mr(0,3-g.length):"")+g})+"."+Mr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=xi(""+c);return d!=="0"?l+d:"";default:if(t.match(/\.[0#?]*$/))return Vr(r,t.slice(0,t.lastIndexOf(".")),e)+zt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ei(r,t,e){return(e|0)===e?Vr(r,t,e):Tr(r,t,e)}function bp(r){for(var t=[],e=!1,i=0,n=0;i<r.length;++i)switch(r.charCodeAt(i)){case 34:e=!e;break;case 95:case 42:case 92:++i;break;case 59:t[t.length]=r.substr(n,i-n),n=i+1}if(t[t.length]=r.substr(n),e===!0)throw new Error("Format |"+r+"| unterminated string ");return t}var F0=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function O0(r){for(var t=0,e="",i="";t<r.length;)switch(e=r.charAt(t)){case"G":Js(r,t)&&(t+=6),t++;break;case'"':for(;r.charCodeAt(++t)!==34&&t<r.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(r.charAt(t+1)==="1"||r.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(r.substr(t,3).toUpperCase()==="A/P"||r.substr(t,5).toUpperCase()==="AM/PM"||r.substr(t,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++t;break;case"[":for(i=e;r.charAt(t++)!=="]"&&t<r.length;)i+=r.charAt(t);if(i.match(F0))return!0;break;case".":case"0":case"#":for(;t<r.length&&("0#?.,E+-%".indexOf(e=r.charAt(++t))>-1||e=="\\"&&r.charAt(t+1)=="-"&&"0#".indexOf(r.charAt(t+2))>-1););break;case"?":for(;r.charAt(++t)===e;);break;case"*":++t,(r.charAt(t)==" "||r.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<r.length&&"0123456789".indexOf(r.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Tp(r,t,e,i){for(var n=[],s="",a=0,o="",c="t",l,h,f,u="H";a<r.length;)switch(o=r.charAt(a)){case"G":if(!Js(r,a))throw new Error("unrecognized character "+o+" in "+r);n[n.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=r.charCodeAt(++a))!==34&&a<r.length;)s+=String.fromCharCode(f);n[n.length]={t:"t",v:s},++a;break;case"\\":var d=r.charAt(++a),g=d==="("||d===")"?d:"t";n[n.length]={t:g,v:d},++a;break;case"_":n[n.length]={t:"t",v:" "},a+=2;break;case"@":n[n.length]={t:"T",v:t},++a;break;case"B":case"b":if(r.charAt(a+1)==="1"||r.charAt(a+1)==="2"){if(l==null&&(l=Gs(t,e,r.charAt(a+1)==="2"),l==null))return"";n[n.length]={t:"X",v:r.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||l==null&&(l=Gs(t,e),l==null))return"";for(s=o;++a<r.length&&r.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=u),n[n.length]={t:o,v:s},c=o;break;case"A":case"a":case"\u4E0A":var p={t:o,v:o};if(l==null&&(l=Gs(t,e)),r.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",u="h",a+=3):r.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",a+=5,u="h"):r.substr(a,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(l!=null&&(p.v=l.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),p.t="T",a+=5,u="h"):(p.t="t",++a),l==null&&p.t==="T")return"";n[n.length]=p,c=o;break;case"[":for(s=o;r.charAt(a++)!=="]"&&a<r.length;)s+=r.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(F0)){if(l==null&&(l=Gs(t,e),l==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",O0(r)||(n[n.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++a<r.length&&(o=r.charAt(a))==="0";)s+=o;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(a))>-1;)s+=o;n[n.length]={t:"n",v:s};break;case"?":for(s=o;r.charAt(++a)===o;)s+=o;n[n.length]={t:o,v:s},c=o;break;case"*":++a,(r.charAt(a)==" "||r.charAt(a)=="*")&&++a;break;case"(":case")":n[n.length]={t:i===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<r.length&&"0123456789".indexOf(r.charAt(++a))>-1;)s+=r.charAt(a);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:o,v:o},++a;break;case"$":n[n.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);n[n.length]={t:"t",v:o},++a;break}var x=0,E=0,F;for(a=n.length-1,c="t";a>=0;--a)switch(n[a].t){case"h":case"H":n[a].t=u,c="h",x<1&&(x=1);break;case"s":(F=n[a].v.match(/\.0+$/))&&(E=Math.max(E,F[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=n[a].t;break;case"m":c==="s"&&(n[a].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&n[a].v.match(/[Hh]/)&&(x=1),x<2&&n[a].v.match(/[Mm]/)&&(x=2),x<3&&n[a].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var O="",V;for(a=0;a<n.length;++a)switch(n[a].t){case"t":case"T":case" ":case"D":break;case"X":n[a].v="",n[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[a].v=pp(n[a].t.charCodeAt(0),n[a].v,l,E),n[a].t="t";break;case"n":case"?":for(V=a+1;n[V]!=null&&((o=n[V].t)==="?"||o==="D"||(o===" "||o==="t")&&n[V+1]!=null&&(n[V+1].t==="?"||n[V+1].t==="t"&&n[V+1].v==="/")||n[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[V].v==="/"||n[V].v===" "&&n[V+1]!=null&&n[V+1].t=="?"));)n[a].v+=n[V].v,n[V]={v:"",t:";"},++V;O+=n[a].v,a=V-1;break;case"G":n[a].t="t",n[a].v=vo(t,e);break}var Z="",he,D;if(O.length>0){O.charCodeAt(0)==40?(he=t<0&&O.charCodeAt(0)===45?-t:t,D=ei("n",O,he)):(he=t<0&&i>1?-t:t,D=ei("n",O,he),he<0&&n[0]&&n[0].t=="t"&&(D=D.substr(1),n[0].v="-"+n[0].v)),V=D.length-1;var Y=n.length;for(a=0;a<n.length;++a)if(n[a]!=null&&n[a].t!="t"&&n[a].v.indexOf(".")>-1){Y=a;break}var H=n.length;if(Y===n.length&&D.indexOf("E")===-1){for(a=n.length-1;a>=0;--a)n[a]==null||"n?".indexOf(n[a].t)===-1||(V>=n[a].v.length-1?(V-=n[a].v.length,n[a].v=D.substr(V+1,n[a].v.length)):V<0?n[a].v="":(n[a].v=D.substr(0,V+1),V=-1),n[a].t="t",H=a);V>=0&&H<n.length&&(n[H].v=D.substr(0,V+1)+n[H].v)}else if(Y!==n.length&&D.indexOf("E")===-1){for(V=D.indexOf(".")-1,a=Y;a>=0;--a)if(!(n[a]==null||"n?".indexOf(n[a].t)===-1)){for(h=n[a].v.indexOf(".")>-1&&a===Y?n[a].v.indexOf(".")-1:n[a].v.length-1,Z=n[a].v.substr(h+1);h>=0;--h)V>=0&&(n[a].v.charAt(h)==="0"||n[a].v.charAt(h)==="#")&&(Z=D.charAt(V--)+Z);n[a].v=Z,n[a].t="t",H=a}for(V>=0&&H<n.length&&(n[H].v=D.substr(0,V+1)+n[H].v),V=D.indexOf(".")+1,a=Y;a<n.length;++a)if(!(n[a]==null||"n?(".indexOf(n[a].t)===-1&&a!==Y)){for(h=n[a].v.indexOf(".")>-1&&a===Y?n[a].v.indexOf(".")+1:0,Z=n[a].v.substr(0,h);h<n[a].v.length;++h)V<D.length&&(Z+=D.charAt(V++));n[a].v=Z,n[a].t="t",H=a}}}for(a=0;a<n.length;++a)n[a]!=null&&"n?".indexOf(n[a].t)>-1&&(he=i>1&&t<0&&a>0&&n[a-1].v==="-"?-t:t,n[a].v=ei(n[a].t,n[a].v,he),n[a].t="t");var X="";for(a=0;a!==n.length;++a)n[a]!=null&&(X+=n[a].v);return X}var Hc=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $c(r,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(r==e)return!0;break;case">":if(r>e)return!0;break;case"<":if(r<e)return!0;break;case"<>":if(r!=e)return!0;break;case">=":if(r>=e)return!0;break;case"<=":if(r<=e)return!0;break}return!1}function Sp(r,t){var e=bp(r),i=e.length,n=e[i-1].indexOf("@");if(i<4&&n>-1&&--i,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||n>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=n>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=n>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=n>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break;case 4:break}var s=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[i,s];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var a=e[0].match(Hc),o=e[1].match(Hc);return $c(t,a)?[i,e[0]]:$c(t,o)?[i,e[1]]:[i,e[a!=null&&o!=null?2:1]]}return[i,s]}function vi(r,t,e){e==null&&(e={});var i="";switch(typeof r){case"string":r=="m/d/yy"&&e.dateNF?i=e.dateNF:i=r;break;case"number":r==14&&e.dateNF?i=e.dateNF:i=(e.table!=null?e.table:it)[r],i==null&&(i=e.table&&e.table[Nc[r]]||it[Nc[r]]),i==null&&(i=ap[r]||"General");break}if(Js(i,0))return vo(t,e);t instanceof Date&&(t=w0(t,e.date1904));var n=Sp(i,t);if(Js(n[1]))return vo(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Tp(n[1],t,e,n[0])}function A0(r,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(it[e]==null){t<0&&(t=e);continue}if(it[e]==r){t=e;break}}t<0&&(t=391)}return it[t]=r,t}function ua(r){for(var t=0;t!=392;++t)r[t]!==void 0&&A0(r[t],t)}function da(){it=sp()}var D0=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Ep(r){var t=typeof r=="number"?it[r]:r;return t=t.replace(D0,"(\\d+)"),new RegExp("^"+t+"$")}function kp(r,t,e){var i=-1,n=-1,s=-1,a=-1,o=-1,c=-1;(t.match(D0)||[]).forEach(function(f,u){var d=parseInt(e[u+1],10);switch(f.toLowerCase().charAt(0)){case"y":i=d;break;case"d":s=d;break;case"h":a=d;break;case"s":c=d;break;case"m":a>=0?o=d:n=d;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var l=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?l:i==-1&&n==-1&&s==-1?h:l+"T"+h}var Ip=function(){var r={};r.version="1.2.0";function t(){for(var D=0,Y=new Array(256),H=0;H!=256;++H)D=H,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,Y[H]=D;return typeof Int32Array<"u"?new Int32Array(Y):Y}var e=t();function i(D){var Y=0,H=0,X=0,Q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(X=0;X!=256;++X)Q[X]=D[X];for(X=0;X!=256;++X)for(H=D[X],Y=256+X;Y<4096;Y+=256)H=Q[Y]=H>>>8^D[H&255];var J=[];for(X=1;X!=16;++X)J[X-1]=typeof Int32Array<"u"?Q.subarray(X*256,X*256+256):Q.slice(X*256,X*256+256);return J}var n=i(e),s=n[0],a=n[1],o=n[2],c=n[3],l=n[4],h=n[5],f=n[6],u=n[7],d=n[8],g=n[9],p=n[10],x=n[11],E=n[12],F=n[13],O=n[14];function V(D,Y){for(var H=Y^-1,X=0,Q=D.length;X<Q;)H=H>>>8^e[(H^D.charCodeAt(X++))&255];return~H}function Z(D,Y){for(var H=Y^-1,X=D.length-15,Q=0;Q<X;)H=O[D[Q++]^H&255]^F[D[Q++]^H>>8&255]^E[D[Q++]^H>>16&255]^x[D[Q++]^H>>>24]^p[D[Q++]]^g[D[Q++]]^d[D[Q++]]^u[D[Q++]]^f[D[Q++]]^h[D[Q++]]^l[D[Q++]]^c[D[Q++]]^o[D[Q++]]^a[D[Q++]]^s[D[Q++]]^e[D[Q++]];for(X+=15;Q<X;)H=H>>>8^e[(H^D[Q++])&255];return~H}function he(D,Y){for(var H=Y^-1,X=0,Q=D.length,J=0,ge=0;X<Q;)J=D.charCodeAt(X++),J<128?H=H>>>8^e[(H^J)&255]:J<2048?(H=H>>>8^e[(H^(192|J>>6&31))&255],H=H>>>8^e[(H^(128|J&63))&255]):J>=55296&&J<57344?(J=(J&1023)+64,ge=D.charCodeAt(X++)&1023,H=H>>>8^e[(H^(240|J>>8&7))&255],H=H>>>8^e[(H^(128|J>>2&63))&255],H=H>>>8^e[(H^(128|ge>>6&15|(J&3)<<4))&255],H=H>>>8^e[(H^(128|ge&63))&255]):(H=H>>>8^e[(H^(224|J>>12&15))&255],H=H>>>8^e[(H^(128|J>>6&63))&255],H=H>>>8^e[(H^(128|J&63))&255]);return~H}return r.table=e,r.bstr=V,r.buf=Z,r.str=he,r}(),Ye=function(){var t={};t.version="1.2.1";function e(m,y){for(var v=m.split("/"),_=y.split("/"),w=0,C=0,P=Math.min(v.length,_.length);w<P;++w){if(C=v[w].length-_[w].length)return C;if(v[w]!=_[w])return v[w]<_[w]?-1:1}return v.length-_.length}function i(m){if(m.charAt(m.length-1)=="/")return m.slice(0,-1).indexOf("/")===-1?m:i(m.slice(0,-1));var y=m.lastIndexOf("/");return y===-1?m:m.slice(0,y+1)}function n(m){if(m.charAt(m.length-1)=="/")return n(m.slice(0,-1));var y=m.lastIndexOf("/");return y===-1?m:m.slice(y+1)}function s(m,y){typeof y=="string"&&(y=new Date(y));var v=y.getHours();v=v<<6|y.getMinutes(),v=v<<5|y.getSeconds()>>>1,m.write_shift(2,v);var _=y.getFullYear()-1980;_=_<<4|y.getMonth()+1,_=_<<5|y.getDate(),m.write_shift(2,_)}function a(m){var y=m.read_shift(2)&65535,v=m.read_shift(2)&65535,_=new Date,w=v&31;v>>>=5;var C=v&15;v>>>=4,_.setMilliseconds(0),_.setFullYear(v+1980),_.setMonth(C-1),_.setDate(w);var P=y&31;y>>>=5;var W=y&63;return y>>>=6,_.setHours(y),_.setMinutes(W),_.setSeconds(P<<1),_}function o(m){mr(m,0);for(var y={},v=0;m.l<=m.length-4;){var _=m.read_shift(2),w=m.read_shift(2),C=m.l+w,P={};switch(_){case 21589:v=m.read_shift(1),v&1&&(P.mtime=m.read_shift(4)),w>5&&(v&2&&(P.atime=m.read_shift(4)),v&4&&(P.ctime=m.read_shift(4))),P.mtime&&(P.mt=new Date(P.mtime*1e3));break}m.l=C,y[_]=P}return y}var c;function l(){return c||(c={})}function h(m,y){if(m[0]==80&&m[1]==75)return al(m,y);if((m[0]|32)==109&&(m[1]|32)==105)return df(m,y);if(m.length<512)throw new Error("CFB file size "+m.length+" < 512");var v=3,_=512,w=0,C=0,P=0,W=0,R=0,L=[],N=m.slice(0,512);mr(N,0);var ee=f(N);switch(v=ee[0],v){case 3:_=512;break;case 4:_=4096;break;case 0:if(ee[1]==0)return al(m,y);default:throw new Error("Major Version: Expected 3 or 4 saw "+v)}_!==512&&(N=m.slice(0,_),mr(N,28));var se=m.slice(0,_);u(N,v);var ue=N.read_shift(4,"i");if(v===3&&ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ue);N.l+=4,P=N.read_shift(4,"i"),N.l+=4,N.chk("00100000","Mini Stream Cutoff Size: "),W=N.read_shift(4,"i"),w=N.read_shift(4,"i"),R=N.read_shift(4,"i"),C=N.read_shift(4,"i");for(var ae=-1,le=0;le<109&&(ae=N.read_shift(4,"i"),!(ae<0));++le)L[le]=ae;var Fe=d(m,_);x(R,C,Fe,_,L);var Ze=F(Fe,P,L,_);Ze[P].name="!Directory",w>0&&W!==ge&&(Ze[W].name="!MiniFAT"),Ze[L[0]].name="!FAT",Ze.fat_addrs=L,Ze.ssz=_;var Kt={},st=[],ir=[],Mn=[];O(P,Ze,Fe,st,w,Kt,ir,W),g(ir,Mn,st),st.shift();var Pn={FileIndex:ir,FullPaths:Mn};return y&&y.raw&&(Pn.raw={header:se,sectors:Fe}),Pn}function f(m){if(m[m.l]==80&&m[m.l+1]==75)return[0,0];m.chk(He,"Header Signature: "),m.l+=16;var y=m.read_shift(2,"u");return[m.read_shift(2,"u"),y]}function u(m,y){var v=9;switch(m.l+=2,v=m.read_shift(2)){case 9:if(y!=3)throw new Error("Sector Shift: Expected 9 saw "+v);break;case 12:if(y!=4)throw new Error("Sector Shift: Expected 12 saw "+v);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+v)}m.chk("0600","Mini Sector Shift: "),m.chk("000000000000","Reserved: ")}function d(m,y){for(var v=Math.ceil(m.length/y)-1,_=[],w=1;w<v;++w)_[w-1]=m.slice(w*y,(w+1)*y);return _[v-1]=m.slice(v*y),_}function g(m,y,v){for(var _=0,w=0,C=0,P=0,W=0,R=v.length,L=[],N=[];_<R;++_)L[_]=N[_]=_,y[_]=v[_];for(;W<N.length;++W)_=N[W],w=m[_].L,C=m[_].R,P=m[_].C,L[_]===_&&(w!==-1&&L[w]!==w&&(L[_]=L[w]),C!==-1&&L[C]!==C&&(L[_]=L[C])),P!==-1&&(L[P]=_),w!==-1&&_!=L[_]&&(L[w]=L[_],N.lastIndexOf(w)<W&&N.push(w)),C!==-1&&_!=L[_]&&(L[C]=L[_],N.lastIndexOf(C)<W&&N.push(C));for(_=1;_<R;++_)L[_]===_&&(C!==-1&&L[C]!==C?L[_]=L[C]:w!==-1&&L[w]!==w&&(L[_]=L[w]));for(_=1;_<R;++_)if(m[_].type!==0){if(W=_,W!=L[W])do W=L[W],y[_]=y[W]+"/"+y[_];while(W!==0&&L[W]!==-1&&W!=L[W]);L[_]=-1}for(y[0]+="/",_=1;_<R;++_)m[_].type!==2&&(y[_]+="/")}function p(m,y,v){for(var _=m.start,w=m.size,C=[],P=_;v&&w>0&&P>=0;)C.push(y.slice(P*J,P*J+J)),w-=J,P=Ri(v,P*4);return C.length===0?B(0):Mt(C).slice(0,m.size)}function x(m,y,v,_,w){var C=ge;if(m===ge){if(y!==0)throw new Error("DIFAT chain shorter than expected")}else if(m!==-1){var P=v[m],W=(_>>>2)-1;if(!P)return;for(var R=0;R<W&&(C=Ri(P,R*4))!==ge;++R)w.push(C);x(Ri(P,_-4),y-1,v,_,w)}}function E(m,y,v,_,w){var C=[],P=[];w||(w=[]);var W=_-1,R=0,L=0;for(R=y;R>=0;){w[R]=!0,C[C.length]=R,P.push(m[R]);var N=v[Math.floor(R*4/_)];if(L=R*4&W,_<4+L)throw new Error("FAT boundary crossed: "+R+" 4 "+_);if(!m[N])break;R=Ri(m[N],L)}return{nodes:C,data:Kc([P])}}function F(m,y,v,_){var w=m.length,C=[],P=[],W=[],R=[],L=_-1,N=0,ee=0,se=0,ue=0;for(N=0;N<w;++N)if(W=[],se=N+y,se>=w&&(se-=w),!P[se]){R=[];var ae=[];for(ee=se;ee>=0;){ae[ee]=!0,P[ee]=!0,W[W.length]=ee,R.push(m[ee]);var le=v[Math.floor(ee*4/_)];if(ue=ee*4&L,_<4+ue)throw new Error("FAT boundary crossed: "+ee+" 4 "+_);if(!m[le]||(ee=Ri(m[le],ue),ae[ee]))break}C[se]={nodes:W,data:Kc([R])}}return C}function O(m,y,v,_,w,C,P,W){for(var R=0,L=_.length?2:0,N=y[m].data,ee=0,se=0,ue;ee<N.length;ee+=128){var ae=N.slice(ee,ee+128);mr(ae,64),se=ae.read_shift(2),ue=ga(ae,0,se-L),_.push(ue);var le={name:ue,type:ae.read_shift(1),color:ae.read_shift(1),L:ae.read_shift(4,"i"),R:ae.read_shift(4,"i"),C:ae.read_shift(4,"i"),clsid:ae.read_shift(16),state:ae.read_shift(4,"i"),start:0,size:0},Fe=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);Fe!==0&&(le.ct=V(ae,ae.l-8));var Ze=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);Ze!==0&&(le.mt=V(ae,ae.l-8)),le.start=ae.read_shift(4,"i"),le.size=ae.read_shift(4,"i"),le.size<0&&le.start<0&&(le.size=le.type=0,le.start=ge,le.name=""),le.type===5?(R=le.start,w>0&&R!==ge&&(y[R].name="!StreamData")):le.size>=4096?(le.storage="fat",y[le.start]===void 0&&(y[le.start]=E(v,le.start,y.fat_addrs,y.ssz)),y[le.start].name=le.name,le.content=y[le.start].data.slice(0,le.size)):(le.storage="minifat",le.size<0?le.size=0:R!==ge&&le.start!==ge&&y[R]&&(le.content=p(le,y[R].data,(y[W]||{}).data))),le.content&&mr(le.content,0),C[ue]=le,P.push(le)}}function V(m,y){return new Date((wt(m,y+4)/1e7*Math.pow(2,32)+wt(m,y)/1e7-11644473600)*1e3)}function Z(m,y){return l(),h(c.readFileSync(m),y)}function he(m,y){var v=y&&y.type;switch(v||We&&Buffer.isBuffer(m)&&(v="buffer"),v||"base64"){case"file":return Z(m,y);case"base64":return h(Dr(ii(m)),y);case"binary":return h(Dr(m),y)}return h(m,y)}function D(m,y){var v=y||{},_=v.root||"Root Entry";if(m.FullPaths||(m.FullPaths=[]),m.FileIndex||(m.FileIndex=[]),m.FullPaths.length!==m.FileIndex.length)throw new Error("inconsistent CFB structure");m.FullPaths.length===0&&(m.FullPaths[0]=_+"/",m.FileIndex[0]={name:_,type:5}),v.CLSID&&(m.FileIndex[0].clsid=v.CLSID),Y(m)}function Y(m){var y="Sh33tJ5";if(!Ye.find(m,"/"+y)){var v=B(4);v[0]=55,v[1]=v[3]=50,v[2]=54,m.FileIndex.push({name:y,type:2,content:v,size:4,L:69,R:69,C:69}),m.FullPaths.push(m.FullPaths[0]+y),H(m)}}function H(m,y){D(m);for(var v=!1,_=!1,w=m.FullPaths.length-1;w>=0;--w){var C=m.FileIndex[w];switch(C.type){case 0:_?v=!0:(m.FileIndex.pop(),m.FullPaths.pop());break;case 1:case 2:case 5:_=!0,isNaN(C.R*C.L*C.C)&&(v=!0),C.R>-1&&C.L>-1&&C.R==C.L&&(v=!0);break;default:v=!0;break}}if(!(!v&&!y)){var P=new Date(1987,1,19),W=0,R=Object.create?Object.create(null):{},L=[];for(w=0;w<m.FullPaths.length;++w)R[m.FullPaths[w]]=!0,m.FileIndex[w].type!==0&&L.push([m.FullPaths[w],m.FileIndex[w]]);for(w=0;w<L.length;++w){var N=i(L[w][0]);_=R[N],_||(L.push([N,{name:n(N).replace("/",""),type:1,clsid:pt,ct:P,mt:P,content:null}]),R[N]=!0)}for(L.sort(function(ue,ae){return e(ue[0],ae[0])}),m.FullPaths=[],m.FileIndex=[],w=0;w<L.length;++w)m.FullPaths[w]=L[w][0],m.FileIndex[w]=L[w][1];for(w=0;w<L.length;++w){var ee=m.FileIndex[w],se=m.FullPaths[w];if(ee.name=n(se).replace("/",""),ee.L=ee.R=ee.C=-(ee.color=1),ee.size=ee.content?ee.content.length:0,ee.start=0,ee.clsid=ee.clsid||pt,w===0)ee.C=L.length>1?1:-1,ee.size=0,ee.type=5;else if(se.slice(-1)=="/"){for(W=w+1;W<L.length&&i(m.FullPaths[W])!=se;++W);for(ee.C=W>=L.length?-1:W,W=w+1;W<L.length&&i(m.FullPaths[W])!=i(se);++W);ee.R=W>=L.length?-1:W,ee.type=1}else i(m.FullPaths[w+1]||"")==i(se)&&(ee.R=w+1),ee.type=2}}}function X(m,y){var v=y||{};if(v.fileType=="mad")return pf(m,v);switch(H(m),v.fileType){case"zip":return of(m,v)}var _=function(ue){for(var ae=0,le=0,Fe=0;Fe<ue.FileIndex.length;++Fe){var Ze=ue.FileIndex[Fe];if(Ze.content){var Kt=Ze.content.length;Kt>0&&(Kt<4096?ae+=Kt+63>>6:le+=Kt+511>>9)}}for(var st=ue.FullPaths.length+3>>2,ir=ae+7>>3,Mn=ae+127>>7,Pn=ir+le+st+Mn,Ti=Pn+127>>7,Ea=Ti<=109?0:Math.ceil((Ti-109)/127);Pn+Ti+Ea+127>>7>Ti;)Ea=++Ti<=109?0:Math.ceil((Ti-109)/127);var jr=[1,Ea,Ti,Mn,st,le,ae,0];return ue.FileIndex[0].size=ae<<6,jr[7]=(ue.FileIndex[0].start=jr[0]+jr[1]+jr[2]+jr[3]+jr[4]+jr[5])+(jr[6]+7>>3),jr}(m),w=B(_[7]<<9),C=0,P=0;{for(C=0;C<8;++C)w.write_shift(1,_e[C]);for(C=0;C<8;++C)w.write_shift(2,0);for(w.write_shift(2,62),w.write_shift(2,3),w.write_shift(2,65534),w.write_shift(2,9),w.write_shift(2,6),C=0;C<3;++C)w.write_shift(2,0);for(w.write_shift(4,0),w.write_shift(4,_[2]),w.write_shift(4,_[0]+_[1]+_[2]+_[3]-1),w.write_shift(4,0),w.write_shift(4,4096),w.write_shift(4,_[3]?_[0]+_[1]+_[2]-1:ge),w.write_shift(4,_[3]),w.write_shift(-4,_[1]?_[0]-1:ge),w.write_shift(4,_[1]),C=0;C<109;++C)w.write_shift(-4,C<_[2]?_[1]+C:-1)}if(_[1])for(P=0;P<_[1];++P){for(;C<236+P*127;++C)w.write_shift(-4,C<_[2]?_[1]+C:-1);w.write_shift(-4,P===_[1]-1?ge:P+1)}var W=function(ue){for(P+=ue;C<P-1;++C)w.write_shift(-4,C+1);ue&&(++C,w.write_shift(-4,ge))};for(P=C=0,P+=_[1];C<P;++C)w.write_shift(-4,mt.DIFSECT);for(P+=_[2];C<P;++C)w.write_shift(-4,mt.FATSECT);W(_[3]),W(_[4]);for(var R=0,L=0,N=m.FileIndex[0];R<m.FileIndex.length;++R)N=m.FileIndex[R],N.content&&(L=N.content.length,!(L<4096)&&(N.start=P,W(L+511>>9)));for(W(_[6]+7>>3);w.l&511;)w.write_shift(-4,mt.ENDOFCHAIN);for(P=C=0,R=0;R<m.FileIndex.length;++R)N=m.FileIndex[R],N.content&&(L=N.content.length,!(!L||L>=4096)&&(N.start=P,W(L+63>>6)));for(;w.l&511;)w.write_shift(-4,mt.ENDOFCHAIN);for(C=0;C<_[4]<<2;++C){var ee=m.FullPaths[C];if(!ee||ee.length===0){for(R=0;R<17;++R)w.write_shift(4,0);for(R=0;R<3;++R)w.write_shift(4,-1);for(R=0;R<12;++R)w.write_shift(4,0);continue}N=m.FileIndex[C],C===0&&(N.start=N.size?N.start-1:ge);var se=C===0&&v.root||N.name;if(L=2*(se.length+1),w.write_shift(64,se,"utf16le"),w.write_shift(2,L),w.write_shift(1,N.type),w.write_shift(1,N.color),w.write_shift(-4,N.L),w.write_shift(-4,N.R),w.write_shift(-4,N.C),N.clsid)w.write_shift(16,N.clsid,"hex");else for(R=0;R<4;++R)w.write_shift(4,0);w.write_shift(4,N.state||0),w.write_shift(4,0),w.write_shift(4,0),w.write_shift(4,0),w.write_shift(4,0),w.write_shift(4,N.start),w.write_shift(4,N.size),w.write_shift(4,0)}for(C=1;C<m.FileIndex.length;++C)if(N=m.FileIndex[C],N.size>=4096)if(w.l=N.start+1<<9,We&&Buffer.isBuffer(N.content))N.content.copy(w,w.l,0,N.size),w.l+=N.size+511&-512;else{for(R=0;R<N.size;++R)w.write_shift(1,N.content[R]);for(;R&511;++R)w.write_shift(1,0)}for(C=1;C<m.FileIndex.length;++C)if(N=m.FileIndex[C],N.size>0&&N.size<4096)if(We&&Buffer.isBuffer(N.content))N.content.copy(w,w.l,0,N.size),w.l+=N.size+63&-64;else{for(R=0;R<N.size;++R)w.write_shift(1,N.content[R]);for(;R&63;++R)w.write_shift(1,0)}if(We)w.l=w.length;else for(;w.l<w.length;)w.write_shift(1,0);return w}function Q(m,y){var v=m.FullPaths.map(function(R){return R.toUpperCase()}),_=v.map(function(R){var L=R.split("/");return L[L.length-(R.slice(-1)=="/"?2:1)]}),w=!1;y.charCodeAt(0)===47?(w=!0,y=v[0].slice(0,-1)+y):w=y.indexOf("/")!==-1;var C=y.toUpperCase(),P=w===!0?v.indexOf(C):_.indexOf(C);if(P!==-1)return m.FileIndex[P];var W=!C.match(zs);for(C=C.replace(mn,""),W&&(C=C.replace(zs,"!")),P=0;P<v.length;++P)if((W?v[P].replace(zs,"!"):v[P]).replace(mn,"")==C||(W?_[P].replace(zs,"!"):_[P]).replace(mn,"")==C)return m.FileIndex[P];return null}var J=64,ge=-2,He="d0cf11e0a1b11ae1",_e=[208,207,17,224,161,177,26,225],pt="00000000000000000000000000000000",mt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ge,FREESECT:-1,HEADER_SIGNATURE:He,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:pt,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function jt(m,y,v){l();var _=X(m,v);c.writeFileSync(y,_)}function $t(m){for(var y=new Array(m.length),v=0;v<m.length;++v)y[v]=String.fromCharCode(m[v]);return y.join("")}function St(m,y){var v=X(m,y);switch(y&&y.type||"buffer"){case"file":return l(),c.writeFileSync(y.filename,v),v;case"binary":return typeof v=="string"?v:$t(v);case"base64":return ns(typeof v=="string"?v:$t(v));case"buffer":if(We)return Buffer.isBuffer(v)?v:si(v);case"array":return typeof v=="string"?Dr(v):v}return v}var Yt;function b(m){try{var y=m.InflateRaw,v=new y;if(v._processChunk(new Uint8Array([3,0]),v._finishFlushFlag),v.bytesRead)Yt=m;else throw new Error("zlib does not expose bytesRead")}catch(_){console.error("cannot use native zlib: "+(_.message||_))}}function z(m,y){if(!Yt)return nl(m,y);var v=Yt.InflateRaw,_=new v,w=_._processChunk(m.slice(m.l),_._finishFlushFlag);return m.l+=_.bytesRead,w}function S(m){return Yt?Yt.deflateRawSync(m):Zo(m)}var T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function be(m){var y=(m<<1|m<<11)&139536|(m<<5|m<<15)&558144;return(y>>16|y>>8|y)&255}for(var fe=typeof Uint8Array<"u",oe=fe?new Uint8Array(256):[],Xe=0;Xe<256;++Xe)oe[Xe]=be(Xe);function Pe(m,y){var v=oe[m&255];return y<=8?v>>>8-y:(v=v<<8|oe[m>>8&255],y<=16?v>>>16-y:(v=v<<8|oe[m>>16&255],v>>>24-y))}function Et(m,y){var v=y&7,_=y>>>3;return(m[_]|(v<=6?0:m[_+1]<<8))>>>v&3}function Re(m,y){var v=y&7,_=y>>>3;return(m[_]|(v<=5?0:m[_+1]<<8))>>>v&7}function Ir(m,y){var v=y&7,_=y>>>3;return(m[_]|(v<=4?0:m[_+1]<<8))>>>v&15}function tt(m,y){var v=y&7,_=y>>>3;return(m[_]|(v<=3?0:m[_+1]<<8))>>>v&31}function de(m,y){var v=y&7,_=y>>>3;return(m[_]|(v<=1?0:m[_+1]<<8))>>>v&127}function vr(m,y,v){var _=y&7,w=y>>>3,C=(1<<v)-1,P=m[w]>>>_;return v<8-_||(P|=m[w+1]<<8-_,v<16-_)||(P|=m[w+2]<<16-_,v<24-_)||(P|=m[w+3]<<24-_),P&C}function Xr(m,y,v){var _=y&7,w=y>>>3;return _<=5?m[w]|=(v&7)<<_:(m[w]|=v<<_&255,m[w+1]=(v&7)>>8-_),y+3}function Ci(m,y,v){var _=y&7,w=y>>>3;return v=(v&1)<<_,m[w]|=v,y+1}function ji(m,y,v){var _=y&7,w=y>>>3;return v<<=_,m[w]|=v&255,v>>>=8,m[w+1]=v,y+8}function Qo(m,y,v){var _=y&7,w=y>>>3;return v<<=_,m[w]|=v&255,v>>>=8,m[w+1]=v&255,m[w+2]=v>>>8,y+16}function Ca(m,y){var v=m.length,_=2*v>y?2*v:y+5,w=0;if(v>=y)return m;if(We){var C=Pc(_);if(m.copy)m.copy(C);else for(;w<m.length;++w)C[w]=m[w];return C}else if(fe){var P=new Uint8Array(_);if(P.set)P.set(m);else for(;w<v;++w)P[w]=m[w];return P}return m.length=_,m}function Lr(m){for(var y=new Array(m),v=0;v<m;++v)y[v]=0;return y}function ps(m,y,v){var _=1,w=0,C=0,P=0,W=0,R=m.length,L=fe?new Uint16Array(32):Lr(32);for(C=0;C<32;++C)L[C]=0;for(C=R;C<v;++C)m[C]=0;R=m.length;var N=fe?new Uint16Array(R):Lr(R);for(C=0;C<R;++C)L[w=m[C]]++,_<w&&(_=w),N[C]=0;for(L[0]=0,C=1;C<=_;++C)L[C+16]=W=W+L[C-1]<<1;for(C=0;C<R;++C)W=m[C],W!=0&&(N[C]=L[W+16]++);var ee=0;for(C=0;C<R;++C)if(ee=m[C],ee!=0)for(W=Pe(N[C],_)>>_-ee,P=(1<<_+4-ee)-1;P>=0;--P)y[W|P<<ee]=ee&15|C<<4;return _}var ba=fe?new Uint16Array(512):Lr(512),Ta=fe?new Uint16Array(32):Lr(32);if(!fe){for(var bi=0;bi<512;++bi)ba[bi]=0;for(bi=0;bi<32;++bi)Ta[bi]=0}(function(){for(var m=[],y=0;y<32;y++)m.push(5);ps(m,Ta,32);var v=[];for(y=0;y<=143;y++)v.push(8);for(;y<=255;y++)v.push(9);for(;y<=279;y++)v.push(7);for(;y<=287;y++)v.push(8);ps(v,ba,288)})();var rf=function(){for(var y=fe?new Uint8Array(32768):[],v=0,_=0;v<pe.length-1;++v)for(;_<pe[v+1];++_)y[_]=v;for(;_<32768;++_)y[_]=29;var w=fe?new Uint8Array(259):[];for(v=0,_=0;v<q.length-1;++v)for(;_<q[v+1];++_)w[_]=v;function C(W,R){for(var L=0;L<W.length;){var N=Math.min(65535,W.length-L),ee=L+N==W.length;for(R.write_shift(1,+ee),R.write_shift(2,N),R.write_shift(2,~N&65535);N-- >0;)R[R.l++]=W[L++]}return R.l}function P(W,R){for(var L=0,N=0,ee=fe?new Uint16Array(32768):[];N<W.length;){var se=Math.min(65535,W.length-N);if(se<10){for(L=Xr(R,L,+(N+se==W.length)),L&7&&(L+=8-(L&7)),R.l=L/8|0,R.write_shift(2,se),R.write_shift(2,~se&65535);se-- >0;)R[R.l++]=W[N++];L=R.l*8;continue}L=Xr(R,L,+(N+se==W.length)+2);for(var ue=0;se-- >0;){var ae=W[N];ue=(ue<<5^ae)&32767;var le=-1,Fe=0;if((le=ee[ue])&&(le|=N&-32768,le>N&&(le-=32768),le<N))for(;W[le+Fe]==W[N+Fe]&&Fe<250;)++Fe;if(Fe>2){ae=w[Fe],ae<=22?L=ji(R,L,oe[ae+1]>>1)-1:(ji(R,L,3),L+=5,ji(R,L,oe[ae-23]>>5),L+=3);var Ze=ae<8?0:ae-4>>2;Ze>0&&(Qo(R,L,Fe-q[ae]),L+=Ze),ae=y[N-le],L=ji(R,L,oe[ae]>>3),L-=3;var Kt=ae<4?0:ae-2>>1;Kt>0&&(Qo(R,L,N-le-pe[ae]),L+=Kt);for(var st=0;st<Fe;++st)ee[ue]=N&32767,ue=(ue<<5^W[N])&32767,++N;se-=Fe-1}else ae<=143?ae=ae+48:L=Ci(R,L,1),L=ji(R,L,oe[ae]),ee[ue]=N&32767,++N}L=ji(R,L,0)-1}return R.l=(L+7)/8|0,R.l}return function(R,L){return R.length<8?C(R,L):P(R,L)}}();function Zo(m){var y=B(50+Math.floor(m.length*1.1)),v=rf(m,y);return y.slice(0,v)}var Jo=fe?new Uint16Array(32768):Lr(32768),el=fe?new Uint16Array(32768):Lr(32768),tl=fe?new Uint16Array(128):Lr(128),rl=1,il=1;function nf(m,y){var v=tt(m,y)+257;y+=5;var _=tt(m,y)+1;y+=5;var w=Ir(m,y)+4;y+=4;for(var C=0,P=fe?new Uint8Array(19):Lr(19),W=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],R=1,L=fe?new Uint8Array(8):Lr(8),N=fe?new Uint8Array(8):Lr(8),ee=P.length,se=0;se<w;++se)P[T[se]]=C=Re(m,y),R<C&&(R=C),L[C]++,y+=3;var ue=0;for(L[0]=0,se=1;se<=R;++se)N[se]=ue=ue+L[se-1]<<1;for(se=0;se<ee;++se)(ue=P[se])!=0&&(W[se]=N[ue]++);var ae=0;for(se=0;se<ee;++se)if(ae=P[se],ae!=0){ue=oe[W[se]]>>8-ae;for(var le=(1<<7-ae)-1;le>=0;--le)tl[ue|le<<ae]=ae&7|se<<3}var Fe=[];for(R=1;Fe.length<v+_;)switch(ue=tl[de(m,y)],y+=ue&7,ue>>>=3){case 16:for(C=3+Et(m,y),y+=2,ue=Fe[Fe.length-1];C-- >0;)Fe.push(ue);break;case 17:for(C=3+Re(m,y),y+=3;C-- >0;)Fe.push(0);break;case 18:for(C=11+de(m,y),y+=7;C-- >0;)Fe.push(0);break;default:Fe.push(ue),R<ue&&(R=ue);break}var Ze=Fe.slice(0,v),Kt=Fe.slice(v);for(se=v;se<286;++se)Ze[se]=0;for(se=_;se<30;++se)Kt[se]=0;return rl=ps(Ze,Jo,286),il=ps(Kt,el,30),y}function sf(m,y){if(m[0]==3&&!(m[1]&3))return[Wi(y),2];for(var v=0,_=0,w=Pc(y||1<<18),C=0,P=w.length>>>0,W=0,R=0;(_&1)==0;){if(_=Re(m,v),v+=3,_>>>1)_>>1==1?(W=9,R=5):(v=nf(m,v),W=rl,R=il);else{v&7&&(v+=8-(v&7));var L=m[v>>>3]|m[(v>>>3)+1]<<8;if(v+=32,L>0)for(!y&&P<C+L&&(w=Ca(w,C+L),P=w.length);L-- >0;)w[C++]=m[v>>>3],v+=8;continue}for(;;){!y&&P<C+32767&&(w=Ca(w,C+32767),P=w.length);var N=vr(m,v,W),ee=_>>>1==1?ba[N]:Jo[N];if(v+=ee&15,ee>>>=4,(ee>>>8&255)===0)w[C++]=ee;else{if(ee==256)break;ee-=257;var se=ee<8?0:ee-4>>2;se>5&&(se=0);var ue=C+q[ee];se>0&&(ue+=vr(m,v,se),v+=se),N=vr(m,v,R),ee=_>>>1==1?Ta[N]:el[N],v+=ee&15,ee>>>=4;var ae=ee<4?0:ee-2>>1,le=pe[ee];for(ae>0&&(le+=vr(m,v,ae),v+=ae),!y&&P<ue&&(w=Ca(w,ue+100),P=w.length);C<ue;)w[C]=w[C-le],++C}}}return y?[w,v+7>>>3]:[w.slice(0,C),v+7>>>3]}function nl(m,y){var v=m.slice(m.l||0),_=sf(v,y);return m.l+=_[1],_[0]}function sl(m,y){if(m)typeof console<"u"&&console.error(y);else throw new Error(y)}function al(m,y){var v=m;mr(v,0);var _=[],w=[],C={FileIndex:_,FullPaths:w};D(C,{root:y.root});for(var P=v.length-4;(v[P]!=80||v[P+1]!=75||v[P+2]!=5||v[P+3]!=6)&&P>=0;)--P;v.l=P+4,v.l+=4;var W=v.read_shift(2);v.l+=6;var R=v.read_shift(4);for(v.l=R,P=0;P<W;++P){v.l+=20;var L=v.read_shift(4),N=v.read_shift(4),ee=v.read_shift(2),se=v.read_shift(2),ue=v.read_shift(2);v.l+=8;var ae=v.read_shift(4),le=o(v.slice(v.l+ee,v.l+ee+se));v.l+=ee+se+ue;var Fe=v.l;v.l=ae+4,af(v,L,N,C,le),v.l=Fe}return C}function af(m,y,v,_,w){m.l+=2;var C=m.read_shift(2),P=m.read_shift(2),W=a(m);if(C&8257)throw new Error("Unsupported ZIP encryption");for(var R=m.read_shift(4),L=m.read_shift(4),N=m.read_shift(4),ee=m.read_shift(2),se=m.read_shift(2),ue="",ae=0;ae<ee;++ae)ue+=String.fromCharCode(m[m.l++]);if(se){var le=o(m.slice(m.l,m.l+se));(le[21589]||{}).mt&&(W=le[21589].mt),((w||{})[21589]||{}).mt&&(W=w[21589].mt)}m.l+=se;var Fe=m.slice(m.l,m.l+L);switch(P){case 8:Fe=z(m,N);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+P)}var Ze=!1;C&8&&(R=m.read_shift(4),R==134695760&&(R=m.read_shift(4),Ze=!0),L=m.read_shift(4),N=m.read_shift(4)),L!=y&&sl(Ze,"Bad compressed size: "+y+" != "+L),N!=v&&sl(Ze,"Bad uncompressed size: "+v+" != "+N),Sa(_,ue,Fe,{unsafe:!0,mt:W})}function of(m,y){var v=y||{},_=[],w=[],C=B(1),P=v.compression?8:0,W=0,R=!1;R&&(W|=8);var L=0,N=0,ee=0,se=0,ue=m.FullPaths[0],ae=ue,le=m.FileIndex[0],Fe=[],Ze=0;for(L=1;L<m.FullPaths.length;++L)if(ae=m.FullPaths[L].slice(ue.length),le=m.FileIndex[L],!(!le.size||!le.content||ae=="Sh33tJ5")){var Kt=ee,st=B(ae.length);for(N=0;N<ae.length;++N)st.write_shift(1,ae.charCodeAt(N)&127);st=st.slice(0,st.l),Fe[se]=Ip.buf(le.content,0);var ir=le.content;P==8&&(ir=S(ir)),C=B(30),C.write_shift(4,67324752),C.write_shift(2,20),C.write_shift(2,W),C.write_shift(2,P),le.mt?s(C,le.mt):C.write_shift(4,0),C.write_shift(-4,W&8?0:Fe[se]),C.write_shift(4,W&8?0:ir.length),C.write_shift(4,W&8?0:le.content.length),C.write_shift(2,st.length),C.write_shift(2,0),ee+=C.length,_.push(C),ee+=st.length,_.push(st),ee+=ir.length,_.push(ir),W&8&&(C=B(12),C.write_shift(-4,Fe[se]),C.write_shift(4,ir.length),C.write_shift(4,le.content.length),ee+=C.l,_.push(C)),C=B(46),C.write_shift(4,33639248),C.write_shift(2,0),C.write_shift(2,20),C.write_shift(2,W),C.write_shift(2,P),C.write_shift(4,0),C.write_shift(-4,Fe[se]),C.write_shift(4,ir.length),C.write_shift(4,le.content.length),C.write_shift(2,st.length),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(4,0),C.write_shift(4,Kt),Ze+=C.l,w.push(C),Ze+=st.length,w.push(st),++se}return C=B(22),C.write_shift(4,101010256),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,se),C.write_shift(2,se),C.write_shift(4,Ze),C.write_shift(4,ee),C.write_shift(2,0),Mt([Mt(_),Mt(w),C])}var ms={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function lf(m,y){if(m.ctype)return m.ctype;var v=m.name||"",_=v.match(/\.([^\.]+)$/);return _&&ms[_[1]]||y&&(_=(v=y).match(/[\.\\]([^\.\\])+$/),_&&ms[_[1]])?ms[_[1]]:"application/octet-stream"}function cf(m){for(var y=ns(m),v=[],_=0;_<y.length;_+=76)v.push(y.slice(_,_+76));return v.join(`\r
`)+`\r
`}function hf(m){var y=m.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(L){var N=L.charCodeAt(0).toString(16).toUpperCase();return"="+(N.length==1?"0"+N:N)});y=y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),y.charAt(0)==`
`&&(y="=0D"+y.slice(1)),y=y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var v=[],_=y.split(`\r
`),w=0;w<_.length;++w){var C=_[w];if(C.length==0){v.push("");continue}for(var P=0;P<C.length;){var W=76,R=C.slice(P,P+W);R.charAt(W-1)=="="?W--:R.charAt(W-2)=="="?W-=2:R.charAt(W-3)=="="&&(W-=3),R=C.slice(P,P+W),P+=W,P<C.length&&(R+="="),v.push(R)}}return v.join(`\r
`)}function ff(m){for(var y=[],v=0;v<m.length;++v){for(var _=m[v];v<=m.length&&_.charAt(_.length-1)=="=";)_=_.slice(0,_.length-1)+m[++v];y.push(_)}for(var w=0;w<y.length;++w)y[w]=y[w].replace(/[=][0-9A-Fa-f]{2}/g,function(C){return String.fromCharCode(parseInt(C.slice(1),16))});return Dr(y.join(`\r
`))}function uf(m,y,v){for(var _="",w="",C="",P,W=0;W<10;++W){var R=y[W];if(!R||R.match(/^\s*$/))break;var L=R.match(/^(.*?):\s*([^\s].*)$/);if(L)switch(L[1].toLowerCase()){case"content-location":_=L[2].trim();break;case"content-type":C=L[2].trim();break;case"content-transfer-encoding":w=L[2].trim();break}}switch(++W,w.toLowerCase()){case"base64":P=Dr(ii(y.slice(W).join("")));break;case"quoted-printable":P=ff(y.slice(W));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+w)}var N=Sa(m,_.slice(v.length),P,{unsafe:!0});C&&(N.ctype=C)}function df(m,y){if($t(m.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var v=y&&y.root||"",_=(We&&Buffer.isBuffer(m)?m.toString("binary"):$t(m)).split(`\r
`),w=0,C="";for(w=0;w<_.length;++w)if(C=_[w],!!/^Content-Location:/i.test(C)&&(C=C.slice(C.indexOf("file")),v||(v=C.slice(0,C.lastIndexOf("/")+1)),C.slice(0,v.length)!=v))for(;v.length>0&&(v=v.slice(0,v.length-1),v=v.slice(0,v.lastIndexOf("/")+1),C.slice(0,v.length)!=v););var P=(_[1]||"").match(/boundary="(.*?)"/);if(!P)throw new Error("MAD cannot find boundary");var W="--"+(P[1]||""),R=[],L=[],N={FileIndex:R,FullPaths:L};D(N);var ee,se=0;for(w=0;w<_.length;++w){var ue=_[w];ue!==W&&ue!==W+"--"||(se++&&uf(N,_.slice(ee,w),v),ee=w)}return N}function pf(m,y){var v=y||{},_=v.boundary||"SheetJS";_="------="+_;for(var w=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+_.slice(2)+'"',"","",""],C=m.FullPaths[0],P=C,W=m.FileIndex[0],R=1;R<m.FullPaths.length;++R)if(P=m.FullPaths[R].slice(C.length),W=m.FileIndex[R],!(!W.size||!W.content||P=="Sh33tJ5")){P=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Fe){return"_x"+Fe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Fe){return"_u"+Fe.charCodeAt(0).toString(16)+"_"});for(var L=W.content,N=We&&Buffer.isBuffer(L)?L.toString("binary"):$t(L),ee=0,se=Math.min(1024,N.length),ue=0,ae=0;ae<=se;++ae)(ue=N.charCodeAt(ae))>=32&&ue<128&&++ee;var le=ee>=se*4/5;w.push(_),w.push("Content-Location: "+(v.root||"file:///C:/SheetJS/")+P),w.push("Content-Transfer-Encoding: "+(le?"quoted-printable":"base64")),w.push("Content-Type: "+lf(W,P)),w.push(""),w.push(le?hf(N):cf(N))}return w.push(_+`--\r
`),w.join(`\r
`)}function mf(m){var y={};return D(y,m),y}function Sa(m,y,v,_){var w=_&&_.unsafe;w||D(m);var C=!w&&Ye.find(m,y);if(!C){var P=m.FullPaths[0];y.slice(0,P.length)==P?P=y:(P.slice(-1)!="/"&&(P+="/"),P=(P+y).replace("//","/")),C={name:n(y),type:2},m.FileIndex.push(C),m.FullPaths.push(P),w||Ye.utils.cfb_gc(m)}return C.content=v,C.size=v?v.length:0,_&&(_.CLSID&&(C.clsid=_.CLSID),_.mt&&(C.mt=_.mt),_.ct&&(C.ct=_.ct)),C}function gf(m,y){D(m);var v=Ye.find(m,y);if(v){for(var _=0;_<m.FileIndex.length;++_)if(m.FileIndex[_]==v)return m.FileIndex.splice(_,1),m.FullPaths.splice(_,1),!0}return!1}function xf(m,y,v){D(m);var _=Ye.find(m,y);if(_){for(var w=0;w<m.FileIndex.length;++w)if(m.FileIndex[w]==_)return m.FileIndex[w].name=n(v),m.FullPaths[w]=v,!0}return!1}function vf(m){H(m,!0)}return t.find=Q,t.read=he,t.parse=h,t.write=St,t.writeFile=jt,t.utils={cfb_new:mf,cfb_add:Sa,cfb_del:gf,cfb_mov:xf,cfb_gc:vf,ReadShift:Zn,CheckField:G0,prep_blob:mr,bconcat:Mt,use_zlib:b,_deflateRaw:Zo,_inflateRaw:nl,consts:mt},t}(),Xs;function Fp(r){return typeof r=="string"?fa(r):Array.isArray(r)?tp(r):r}function hs(r,t,e){if(typeof Xs<"u"&&Xs.writeFileSync)return e?Xs.writeFileSync(r,t,e):Xs.writeFileSync(r,t);if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=fa(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(r,t)}var i=e=="utf8"?Jr(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,r);if(typeof Blob<"u"){var n=new Blob([Fp(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,r);if(typeof saveAs<"u")return saveAs(n,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=r,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(r);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=cs(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+r)}function Rt(r){for(var t=Object.keys(r),e=[],i=0;i<t.length;++i)Object.prototype.hasOwnProperty.call(r,t[i])&&e.push(t[i]);return e}function Vc(r,t){for(var e=[],i=Rt(r),n=0;n!==i.length;++n)e[r[i[n]][t]]==null&&(e[r[i[n]][t]]=i[n]);return e}function To(r){for(var t=[],e=Rt(r),i=0;i!==e.length;++i)t[r[e[i]]]=e[i];return t}function pa(r){for(var t=[],e=Rt(r),i=0;i!==e.length;++i)t[r[e[i]]]=parseInt(e[i],10);return t}function Op(r){for(var t=[],e=Rt(r),i=0;i!==e.length;++i)t[r[e[i]]]==null&&(t[r[e[i]]]=[]),t[r[e[i]]].push(e[i]);return t}var ta=new Date(1899,11,30,0,0,0);function tr(r,t){var e=r.getTime();t&&(e-=1462*24*60*60*1e3);var i=ta.getTime()+(r.getTimezoneOffset()-ta.getTimezoneOffset())*6e4;return(e-i)/(24*60*60*1e3)}var M0=new Date,Ap=ta.getTime()+(M0.getTimezoneOffset()-ta.getTimezoneOffset())*6e4,Uc=M0.getTimezoneOffset();function P0(r){var t=new Date;return t.setTime(r*24*60*60*1e3+Ap),t.getTimezoneOffset()!==Uc&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Uc)*6e4),t}var zc=new Date("2017-02-19T19:06:09.000Z"),L0=isNaN(zc.getFullYear())?new Date("2/19/17"):zc,Dp=L0.getFullYear()==2017;function Xt(r,t){var e=new Date(r);if(Dp)return t>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):t<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(r instanceof Date)return r;if(L0.getFullYear()==1917&&!isNaN(e.getFullYear())){var i=e.getFullYear();return r.indexOf(""+i)>-1||e.setFullYear(e.getFullYear()+100),e}var n=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ma(r,t){if(We&&Buffer.isBuffer(r)){if(t){if(r[0]==255&&r[1]==254)return Jr(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return Jr(ep(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(r[0]==255&&r[1]==254)return Jr(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return Jr(new TextDecoder("utf-16be").decode(r.slice(2)))}var e={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return e[s]||s})}catch{}for(var i=[],n=0;n!=r.length;++n)i.push(String.fromCharCode(r[n]));return i.join("")}function rr(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var t={};for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=rr(r[e]));return t}function rt(r,t){for(var e="";e.length<t;)e+=r;return e}function ti(r){var t=Number(r);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(r))return t;var e=1,i=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(i))||(i=i.replace(/[(](.*)[)]/,function(n,s){return e=-e,s}),!isNaN(t=Number(i)))?t/e:t}var Mp=["january","february","march","april","may","june","july","august","september","october","november","december"];function ss(r){var t=new Date(r),e=new Date(NaN),i=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return e;var a=r.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&Mp.indexOf(a)==-1)return e}else if(a.match(/[a-z]/))return e;return i<0||i>8099?e:(n>0||s>1)&&i!=101?t:r.match(/[^-0-9:,\/\\]/)?e:t}function Oe(r,t,e){if(r.FullPaths){if(typeof e=="string"){var i;return We?i=si(e):i=rp(e),Ye.utils.cfb_add(r,t,i)}Ye.utils.cfb_add(r,t,e)}else r.file(t,e)}function So(){return Ye.utils.cfb_new()}var ct=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var Pp={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Eo=To(Pp);var ko=/[&<>'"]/g,Lp=/[\u0000-\u0008\u000b-\u001f]/g;function ze(r){var t=r+"";return t.replace(ko,function(e){return Eo[e]}).replace(Lp,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Gc(r){return ze(r).replace(/ /g,"_x0020_")}var R0=/[\u0000-\u001f]/g;function Rp(r){var t=r+"";return t.replace(ko,function(e){return Eo[e]}).replace(/\n/g,"<br/>").replace(R0,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function Np(r){var t=r+"";return t.replace(ko,function(e){return Eo[e]}).replace(R0,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function Bp(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function Wp(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ho(r){for(var t="",e=0,i=0,n=0,s=0,a=0,o=0;e<r.length;){if(i=r.charCodeAt(e++),i<128){t+=String.fromCharCode(i);continue}if(n=r.charCodeAt(e++),i>191&&i<224){a=(i&31)<<6,a|=n&63,t+=String.fromCharCode(a);continue}if(s=r.charCodeAt(e++),i<240){t+=String.fromCharCode((i&15)<<12|(n&63)<<6|s&63);continue}a=r.charCodeAt(e++),o=((i&7)<<18|(n&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Xc(r){var t=Wi(2*r.length),e,i,n=1,s=0,a=0,o;for(i=0;i<r.length;i+=n)n=1,(o=r.charCodeAt(i))<128?e=o:o<224?(e=(o&31)*64+(r.charCodeAt(i+1)&63),n=2):o<240?(e=(o&15)*4096+(r.charCodeAt(i+1)&63)*64+(r.charCodeAt(i+2)&63),n=3):(n=4,e=(o&7)*262144+(r.charCodeAt(i+1)&63)*4096+(r.charCodeAt(i+2)&63)*64+(r.charCodeAt(i+3)&63),e-=65536,a=55296+(e>>>10&1023),e=56320+(e&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=e%256,t[s++]=e>>>8;return t.slice(0,s).toString("ucs2")}function jc(r){return si(r,"binary").toString("utf8")}var js="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",Qn=We&&(jc(js)==ho(js)&&jc||Xc(js)==ho(js)&&Xc)||ho,Jr=We?function(r){return si(r,"utf8").toString("binary")}:function(r){for(var t=[],e=0,i=0,n=0;e<r.length;)switch(i=r.charCodeAt(e++),!0){case i<128:t.push(String.fromCharCode(i));break;case i<2048:t.push(String.fromCharCode(192+(i>>6))),t.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,n=r.charCodeAt(e++)-56320+(i<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(i>>12))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)))}return t.join("")};var Hp=function(){var r=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var i=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<r.length;++n)i=i.replace(r[n][0],r[n][1]);return i}}();var N0=/(^\s|\s$|\n)/;function Pt(r,t){return"<"+r+(t.match(N0)?' xml:space="preserve"':"")+">"+t+"</"+r+">"}function as(r){return Rt(r).map(function(t){return" "+t+'="'+r[t]+'"'}).join("")}function ie(r,t,e){return"<"+r+(e!=null?as(e):"")+(t!=null?(t.match(N0)?' xml:space="preserve"':"")+">"+t+"</"+r:"/")+">"}function _o(r,t){try{return r.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function $p(r,t){switch(typeof r){case"string":var e=ie("vt:lpwstr",ze(r));return t&&(e=e.replace(/&quot;/g,"_x0022_")),e;case"number":return ie((r|0)==r?"vt:i4":"vt:r8",ze(String(r)));case"boolean":return ie("vt:bool",r?"true":"false")}if(r instanceof Date)return ie("vt:filetime",_o(r));throw new Error("Unable to serialize "+r)}var Ct={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Cn=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],gr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Vp(r,t){for(var e=1-2*(r[t+7]>>>7),i=((r[t+7]&127)<<4)+(r[t+6]>>>4&15),n=r[t+6]&15,s=5;s>=0;--s)n=n*256+r[t+s];return i==2047?n==0?e*(1/0):NaN:(i==0?i=-1022:(i-=1023,n+=Math.pow(2,52)),e*Math.pow(2,i-52)*n)}function Up(r,t,e){var i=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,a=i?-t:t;isFinite(a)?a==0?n=s=0:(n=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)r[e+o]=s&255;r[e+6]=(n&15)<<4|s&15,r[e+7]=n>>4|i}var Yc=function(r){for(var t=[],e=10240,i=0;i<r[0].length;++i)if(r[0][i])for(var n=0,s=r[0][i].length;n<s;n+=e)t.push.apply(t,r[0][i].slice(n,n+e));return t},Kc=We?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(t){return Buffer.isBuffer(t)?t:si(t)})):Yc(r)}:Yc,qc=function(r,t,e){for(var i=[],n=t;n<e;n+=2)i.push(String.fromCharCode(qn(r,n)));return i.join("").replace(mn,"")},ga=We?function(r,t,e){return Buffer.isBuffer(r)?r.toString("utf16le",t,e).replace(mn,""):qc(r,t,e)}:qc,Qc=function(r,t,e){for(var i=[],n=t;n<t+e;++n)i.push(("0"+r[n].toString(16)).slice(-2));return i.join("")},B0=We?function(r,t,e){return Buffer.isBuffer(r)?r.toString("hex",t,t+e):Qc(r,t,e)}:Qc,Zc=function(r,t,e){for(var i=[],n=t;n<e;n++)i.push(String.fromCharCode(dn(r,n)));return i.join("")},bn=We?function(t,e,i){return Buffer.isBuffer(t)?t.toString("utf8",e,i):Zc(t,e,i)}:Zc,W0=function(r,t){var e=wt(r,t);return e>0?bn(r,t+4,t+4+e-1):""},Io=W0,H0=function(r,t){var e=wt(r,t);return e>0?bn(r,t+4,t+4+e-1):""},Fo=H0,$0=function(r,t){var e=2*wt(r,t);return e>0?bn(r,t+4,t+4+e-1):""},Oo=$0,V0=function(t,e){var i=wt(t,e);return i>0?ga(t,e+4,e+4+i):""},Ao=V0,U0=function(r,t){var e=wt(r,t);return e>0?bn(r,t+4,t+4+e):""},Do=U0,z0=function(r,t){return Vp(r,t)},ra=z0,Mo=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};We&&(Io=function(t,e){if(!Buffer.isBuffer(t))return W0(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},Fo=function(t,e){if(!Buffer.isBuffer(t))return H0(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},Oo=function(t,e){if(!Buffer.isBuffer(t))return $0(t,e);var i=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i-1)},Ao=function(t,e){if(!Buffer.isBuffer(t))return V0(t,e);var i=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i)},Do=function(t,e){if(!Buffer.isBuffer(t))return U0(t,e);var i=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+i)},ra=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):z0(t,e)},Mo=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function zp(){ga=function(r,t,e){return qe.utils.decode(1200,r.slice(t,e)).replace(mn,"")},bn=function(r,t,e){return qe.utils.decode(65001,r.slice(t,e))},Io=function(r,t){var e=wt(r,t);return e>0?qe.utils.decode(yn,r.slice(t+4,t+4+e-1)):""},Fo=function(r,t){var e=wt(r,t);return e>0?qe.utils.decode(Ni,r.slice(t+4,t+4+e-1)):""},Oo=function(r,t){var e=2*wt(r,t);return e>0?qe.utils.decode(1200,r.slice(t+4,t+4+e-1)):""},Ao=function(r,t){var e=wt(r,t);return e>0?qe.utils.decode(1200,r.slice(t+4,t+4+e)):""},Do=function(r,t){var e=wt(r,t);return e>0?qe.utils.decode(65001,r.slice(t+4,t+4+e)):""}}typeof qe<"u"&&zp();var dn=function(r,t){return r[t]},qn=function(r,t){return r[t+1]*256+r[t]},Gp=function(r,t){var e=r[t+1]*256+r[t];return e<32768?e:(65535-e+1)*-1},wt=function(r,t){return r[t+3]*(1<<24)+(r[t+2]<<16)+(r[t+1]<<8)+r[t]},Ri=function(r,t){return r[t+3]<<24|r[t+2]<<16|r[t+1]<<8|r[t]},Xp=function(r,t){return r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3]};function Zn(r,t){var e="",i,n,s=[],a,o,c,l;switch(t){case"dbcs":if(l=this.l,We&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*r).toString("utf16le");else for(c=0;c<r;++c)e+=String.fromCharCode(qn(this,l)),l+=2;r*=2;break;case"utf8":e=bn(this,this.l,this.l+r);break;case"utf16le":r*=2,e=ga(this,this.l,this.l+r);break;case"wstr":if(typeof qe<"u")e=qe.utils.decode(Ni,this.slice(this.l,this.l+2*r));else return Zn.call(this,r,"dbcs");r=2*r;break;case"lpstr-ansi":e=Io(this,this.l),r=4+wt(this,this.l);break;case"lpstr-cp":e=Fo(this,this.l),r=4+wt(this,this.l);break;case"lpwstr":e=Oo(this,this.l),r=4+2*wt(this,this.l);break;case"lpp4":r=4+wt(this,this.l),e=Ao(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+wt(this,this.l),e=Do(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,e="";(a=dn(this,this.l+r++))!==0;)s.push(Us(a));e=s.join("");break;case"_wstr":for(r=0,e="";(a=qn(this,this.l+r))!==0;)s.push(Us(a)),r+=2;r+=2,e=s.join("");break;case"dbcs-cont":for(e="",l=this.l,c=0;c<r;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=dn(this,l),this.l=l+1,o=Zn.call(this,r-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Us(qn(this,l))),l+=2}e=s.join(""),r*=2;break;case"cpstr":if(typeof qe<"u"){e=qe.utils.decode(Ni,this.slice(this.l,this.l+r));break}case"sbcs-cont":for(e="",l=this.l,c=0;c!=r;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=dn(this,l),this.l=l+1,o=Zn.call(this,r-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Us(dn(this,l))),l+=1}e=s.join("");break;default:switch(r){case 1:return i=dn(this,this.l),this.l++,i;case 2:return i=(t==="i"?Gp:qn)(this,this.l),this.l+=2,i;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(i=(r>0?Ri:Xp)(this,this.l),this.l+=4,i):(n=wt(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return r==8?n=ra(this,this.l):n=ra([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;r=8;case 16:e=B0(this,this.l,r);break}}return this.l+=r,e}var jp=function(r,t,e){r[e]=t&255,r[e+1]=t>>>8&255,r[e+2]=t>>>16&255,r[e+3]=t>>>24&255},Yp=function(r,t,e){r[e]=t&255,r[e+1]=t>>8&255,r[e+2]=t>>16&255,r[e+3]=t>>24&255},Kp=function(r,t,e){r[e]=t&255,r[e+1]=t>>>8&255};function qp(r,t,e){var i=0,n=0;if(e==="dbcs"){for(n=0;n!=t.length;++n)Kp(this,t.charCodeAt(n),this.l+2*n);i=2*t.length}else if(e==="sbcs"){if(typeof qe<"u"&&yn==874)for(n=0;n!=t.length;++n){var s=qe.utils.encode(yn,t.charAt(n));this[this.l+n]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;i=t.length}else if(e==="hex"){for(;n<r;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(e==="utf16le"){var a=Math.min(this.l+r,this.length);for(n=0;n<Math.min(t.length,r);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(r){case 1:i=1,this[this.l]=t&255;break;case 2:i=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:i=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:i=4,jp(this,t,this.l);break;case 8:if(i=8,e==="f"){Up(this,t,this.l);break}case 16:break;case-4:i=4,Yp(this,t,this.l);break}return this.l+=i,this}function G0(r,t){var e=B0(this,this.l,r.length>>1);if(e!==r)throw new Error(t+"Expected "+r+" saw "+e);this.l+=r.length>>1}function mr(r,t){r.l=t,r.read_shift=Zn,r.chk=G0,r.write_shift=qp}function Gr(r,t){r.l+=t}function B(r){var t=Wi(r);return mr(t,0),t}function er(){var r=[],t=We?256:2048,e=function(l){var h=B(l);return mr(h,0),h},i=e(t),n=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&r.push(i),i=null)},s=function(l){return i&&l<i.length-i.l?i:(n(),i=e(Math.max(l+1,t)))},a=function(){return n(),Mt(r)},o=function(l){n(),i=l,i.l==null&&(i.l=i.length),s(t)};return{next:s,push:o,end:a,_bufs:r}}function K(r,t,e,i){var n=+t,s;if(!isNaN(n)){i||(i=U_[n].p||(e||[]).length||0),s=1+(n>=128?1:0)+1,i>=128&&++s,i>=16384&&++s,i>=2097152&&++s;var a=r.next(s);n<=127?a.write_shift(1,n):(a.write_shift(1,(n&127)+128),a.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(i>=128)a.write_shift(1,(i&127)+128),i>>=7;else{a.write_shift(1,i);break}i>0&&Mo(e)&&r.push(e)}}function Jn(r,t,e){var i=rr(r);if(t.s?(i.cRel&&(i.c+=t.s.c),i.rRel&&(i.r+=t.s.r)):(i.cRel&&(i.c+=t.c),i.rRel&&(i.r+=t.r)),!e||e.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function Jc(r,t,e){var i=rr(r);return i.s=Jn(i.s,t.s,e),i.e=Jn(i.e,t.s,e),i}function es(r,t){if(r.cRel&&r.c<0)for(r=rr(r);r.c<0;)r.c+=t>8?16384:256;if(r.rRel&&r.r<0)for(r=rr(r);r.r<0;)r.r+=t>8?1048576:t>5?65536:16384;var e=Ge(r);return!r.cRel&&r.cRel!=null&&(e=Jp(e)),!r.rRel&&r.rRel!=null&&(e=Qp(e)),e}function fo(r,t){return r.s.r==0&&!r.s.rRel&&r.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+Wt(r.s.c)+":"+(r.e.cRel?"":"$")+Wt(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(t.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Lt(r.s.r)+":"+(r.e.rRel?"":"$")+Lt(r.e.r):es(r.s,t.biff)+":"+es(r.e,t.biff)}function Po(r){return parseInt(Zp(r),10)-1}function Lt(r){return""+(r+1)}function Qp(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Zp(r){return r.replace(/\$(\d+)$/,"$1")}function Lo(r){for(var t=em(r),e=0,i=0;i!==t.length;++i)e=26*e+t.charCodeAt(i)-64;return e-1}function Wt(r){if(r<0)throw new Error("invalid column "+r);var t="";for(++r;r;r=Math.floor((r-1)/26))t=String.fromCharCode((r-1)%26+65)+t;return t}function Jp(r){return r.replace(/^([A-Z])/,"$$$1")}function em(r){return r.replace(/^\$([A-Z])/,"$1")}function tm(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function bt(r){for(var t=0,e=0,i=0;i<r.length;++i){var n=r.charCodeAt(i);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(e=26*e+(n-64))}return{c:e-1,r:t-1}}function Ge(r){for(var t=r.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(r.r+1)}function xr(r){var t=r.indexOf(":");return t==-1?{s:bt(r),e:bt(r)}:{s:bt(r.slice(0,t)),e:bt(r.slice(t+1))}}function lt(r,t){return typeof t>"u"||typeof t=="number"?lt(r.s,r.e):(typeof r!="string"&&(r=Ge(r)),typeof t!="string"&&(t=Ge(t)),r==t?r:r+":"+t)}function Je(r){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,i=0,n=0,s=r.length;for(e=0;i<s&&!((n=r.charCodeAt(i)-64)<1||n>26);++i)e=26*e+n;for(t.s.c=--e,e=0;i<s&&!((n=r.charCodeAt(i)-48)<0||n>9);++i)e=10*e+n;if(t.s.r=--e,i===s||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++i,e=0;i!=s&&!((n=r.charCodeAt(i)-64)<1||n>26);++i)e=26*e+n;for(t.e.c=--e,e=0;i!=s&&!((n=r.charCodeAt(i)-48)<0||n>9);++i)e=10*e+n;return t.e.r=--e,t}function e0(r,t){var e=r.t=="d"&&t instanceof Date;if(r.z!=null)try{return r.w=vi(r.z,e?tr(t):t)}catch{}try{return r.w=vi((r.XF||{}).numFmtId||(e?14:0),e?tr(t):t)}catch{return""+t}}function ni(r,t,e){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&e&&e.dateNF&&(r.z=e.dateNF),r.t=="e"?fs[r.v]||r.v:t==null?e0(r,r.v):e0(r,t))}function Vi(r,t){var e=t&&t.sheet?t.sheet:"Sheet1",i={};return i[e]=r,{SheetNames:[e],Sheets:i}}function X0(r,t,e){var i=e||{},n=r?Array.isArray(r):i.dense;zr!=null&&n==null&&(n=zr);var s=r||(n?[]:{}),a=0,o=0;if(s&&i.origin!=null){if(typeof i.origin=="number")a=i.origin;else{var c=typeof i.origin=="string"?bt(i.origin):i.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=Je(s["!ref"]);l.s.c=h.s.c,l.s.r=h.s.r,l.e.c=Math.max(l.e.c,h.e.c),l.e.r=Math.max(l.e.r,h.e.r),a==-1&&(l.e.r=a=h.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=t[f].length;++u)if(!(typeof t[f][u]>"u")){var d={v:t[f][u]},g=a+f,p=o+u;if(l.s.r>g&&(l.s.r=g),l.s.c>p&&(l.s.c=p),l.e.r<g&&(l.e.r=g),l.e.c<p&&(l.e.c=p),t[f][u]&&typeof t[f][u]=="object"&&!Array.isArray(t[f][u])&&!(t[f][u]instanceof Date))d=t[f][u];else if(Array.isArray(d.v)&&(d.f=t[f][u][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(i.nullError)d.t="e",d.v=0;else if(i.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=i.dateNF||it[14],i.cellDates?(d.t="d",d.w=vi(d.z,tr(d.v))):(d.t="n",d.v=tr(d.v),d.w=vi(d.z,d.v))):d.t="s";if(n)s[g]||(s[g]=[]),s[g][p]&&s[g][p].z&&(d.z=s[g][p].z),s[g][p]=d;else{var x=Ge({c:p,r:g});s[x]&&s[x].z&&(d.z=s[x].z),s[x]=d}}}return l.s.c<1e7&&(s["!ref"]=lt(l)),s}function Tn(r,t){return X0(null,r,t)}function rm(r){return r.read_shift(4,"i")}function Pr(r,t){return t||(t=B(4)),t.write_shift(4,r),t}function Ht(r){var t=r.read_shift(4);return t===0?"":r.read_shift(t,"dbcs")}function Tt(r,t){var e=!1;return t==null&&(e=!0,t=B(4+2*r.length)),t.write_shift(4,r.length),r.length>0&&t.write_shift(0,r,"dbcs"),e?t.slice(0,t.l):t}function im(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function nm(r,t){return t||(t=B(4)),t.write_shift(2,r.ich||0),t.write_shift(2,r.ifnt||0),t}function Ro(r,t){var e=r.l,i=r.read_shift(1),n=Ht(r),s=[],a={t:n,h:n};if((i&1)!==0){for(var o=r.read_shift(4),c=0;c!=o;++c)s.push(im(r));a.r=s}else a.r=[{ich:0,ifnt:0}];return r.l=e+t,a}function sm(r,t){var e=!1;return t==null&&(e=!0,t=B(15+4*r.t.length)),t.write_shift(1,0),Tt(r.t,t),e?t.slice(0,t.l):t}var am=Ro;function om(r,t){var e=!1;return t==null&&(e=!0,t=B(23+4*r.t.length)),t.write_shift(1,1),Tt(r.t,t),t.write_shift(4,1),nm({ich:0,ifnt:0},t),e?t.slice(0,t.l):t}function Er(r){var t=r.read_shift(4),e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:t,iStyleRef:e}}function Ui(r,t){return t==null&&(t=B(8)),t.write_shift(-4,r.c),t.write_shift(3,r.iStyleRef||r.s),t.write_shift(1,0),t}function zi(r){var t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:t}}function Gi(r,t){return t==null&&(t=B(4)),t.write_shift(3,r.iStyleRef||r.s),t.write_shift(1,0),t}var lm=Ht,j0=Tt;function No(r){var t=r.read_shift(4);return t===0||t===4294967295?"":r.read_shift(t,"dbcs")}function ia(r,t){var e=!1;return t==null&&(e=!0,t=B(127)),t.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&t.write_shift(0,r,"dbcs"),e?t.slice(0,t.l):t}var cm=Ht,yo=No,Bo=ia;function Y0(r){var t=r.slice(r.l,r.l+4),e=t[0]&1,i=t[0]&2;r.l+=4;var n=i===0?ra([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ri(t,0)>>2;return e?n/100:n}function K0(r,t){t==null&&(t=B(4));var e=0,i=0,n=r*100;if(r==(r|0)&&r>=-(1<<29)&&r<1<<29?i=1:n==(n|0)&&n>=-(1<<29)&&n<1<<29&&(i=1,e=1),i)t.write_shift(-4,((e?n:r)<<2)+(e+2));else throw new Error("unsupported RkNumber "+r)}function q0(r){var t={s:{},e:{}};return t.s.r=r.read_shift(4),t.e.r=r.read_shift(4),t.s.c=r.read_shift(4),t.e.c=r.read_shift(4),t}function hm(r,t){return t||(t=B(16)),t.write_shift(4,r.s.r),t.write_shift(4,r.e.r),t.write_shift(4,r.s.c),t.write_shift(4,r.e.c),t}var Xi=q0,Sn=hm;function En(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function Hi(r,t){return(t||B(8)).write_shift(8,r,"f")}function fm(r){var t={},e=r.read_shift(1),i=e>>>1,n=r.read_shift(1),s=r.read_shift(2,"i"),a=r.read_shift(1),o=r.read_shift(1),c=r.read_shift(1);switch(r.l++,i){case 0:t.auto=1;break;case 1:t.index=n;var l=ym[n];l&&(t.rgb=f0(l));break;case 2:t.rgb=f0([a,o,c]);break;case 3:t.theme=n;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function na(r,t){if(t||(t=B(8)),!r||r.auto)return t.write_shift(4,0),t.write_shift(4,0),t;r.index!=null?(t.write_shift(1,2),t.write_shift(1,r.index)):r.theme!=null?(t.write_shift(1,6),t.write_shift(1,r.theme)):(t.write_shift(1,5),t.write_shift(1,0));var e=r.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),t.write_shift(2,e),!r.rgb||r.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var i=r.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),t.write_shift(1,parseInt(i.slice(0,2),16)),t.write_shift(1,parseInt(i.slice(2,4),16)),t.write_shift(1,parseInt(i.slice(4,6),16)),t.write_shift(1,255)}return t}function um(r){var t=r.read_shift(1);r.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function dm(r,t){t||(t=B(2));var e=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return t.write_shift(1,e),t.write_shift(1,0),t}var Q0=2,pr=3,Ys=11;var sa=19;var Ks=64,pm=65,mm=71;var gm=4108,xm=4126,Dt=80;var t0={1:{n:"CodePage",t:Q0},2:{n:"Category",t:Dt},3:{n:"PresentationFormat",t:Dt},4:{n:"ByteCount",t:pr},5:{n:"LineCount",t:pr},6:{n:"ParagraphCount",t:pr},7:{n:"SlideCount",t:pr},8:{n:"NoteCount",t:pr},9:{n:"HiddenCount",t:pr},10:{n:"MultimediaClipCount",t:pr},11:{n:"ScaleCrop",t:Ys},12:{n:"HeadingPairs",t:gm},13:{n:"TitlesOfParts",t:xm},14:{n:"Manager",t:Dt},15:{n:"Company",t:Dt},16:{n:"LinksUpToDate",t:Ys},17:{n:"CharacterCount",t:pr},19:{n:"SharedDoc",t:Ys},22:{n:"HyperlinksChanged",t:Ys},23:{n:"AppVersion",t:pr,p:"version"},24:{n:"DigSig",t:pm},26:{n:"ContentType",t:Dt},27:{n:"ContentStatus",t:Dt},28:{n:"Language",t:Dt},29:{n:"Version",t:Dt},255:{},2147483648:{n:"Locale",t:sa},2147483651:{n:"Behavior",t:sa},1919054434:{}},r0={1:{n:"CodePage",t:Q0},2:{n:"Title",t:Dt},3:{n:"Subject",t:Dt},4:{n:"Author",t:Dt},5:{n:"Keywords",t:Dt},6:{n:"Comments",t:Dt},7:{n:"Template",t:Dt},8:{n:"LastAuthor",t:Dt},9:{n:"RevNumber",t:Dt},10:{n:"EditTime",t:Ks},11:{n:"LastPrinted",t:Ks},12:{n:"CreatedDate",t:Ks},13:{n:"ModifiedDate",t:Ks},14:{n:"PageCount",t:pr},15:{n:"WordCount",t:pr},16:{n:"CharCount",t:pr},17:{n:"Thumbnail",t:mm},18:{n:"Application",t:Dt},19:{n:"DocSecurity",t:pr},255:{},2147483648:{n:"Locale",t:sa},2147483651:{n:"Behavior",t:sa},1919054434:{}};function vm(r){return r.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var _m=vm([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ym=rr(_m),fs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var wm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},qs={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Z0(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function J0(r,t){var e=Op(wm),i=[],n;i[i.length]=ct,i[i.length]=ie("Types",null,{xmlns:Ct.CT,"xmlns:xsd":Ct.xsd,"xmlns:xsi":Ct.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ie("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){r[c]&&r[c].length>0&&(n=r[c][0],i[i.length]=ie("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:qs[c][t.bookType]||qs[c].xlsx}))},a=function(c){(r[c]||[]).forEach(function(l){i[i.length]=ie("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:qs[c][t.bookType]||qs[c].xlsx})})},o=function(c){(r[c]||[]).forEach(function(l){i[i.length]=ie("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:e[c][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var Be={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function eh(r){var t=r.lastIndexOf("/");return r.slice(0,t+1)+"_rels/"+r.slice(t+1)+".rels"}function xn(r){var t=[ct,ie("Relationships",null,{xmlns:Ct.RELS})];return Rt(r["!id"]).forEach(function(e){t[t.length]=ie("Relationship",null,r["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ue(r,t,e,i,n,s){if(n||(n={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),t<0)for(t=r["!idx"];r["!id"]["rId"+t];++t);if(r["!idx"]=t+1,n.Id="rId"+t,n.Type=i,n.Target=e,s?n.TargetMode=s:[Be.HLINK,Be.XPATH,Be.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),r["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return r["!id"][n.Id]=n,r[("/"+n.Target).replace("//","/")]=n,t}function Cm(r){var t=[ct];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<r.length;++e)t.push('  <manifest:file-entry manifest:full-path="'+r[e][0]+'" manifest:media-type="'+r[e][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function i0(r,t,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function bm(r,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Tm(r){var t=[ct];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=r.length;++e)t.push(i0(r[e][0],r[e][1])),t.push(bm("",r[e][0]));return t.push(i0("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function th(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+rs.version+"</meta:generator></office:meta></office:document-meta>"}var Bi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function uo(r,t,e,i,n){n[r]!=null||t==null||t===""||(n[r]=t,t=ze(t),i[i.length]=e?ie(r,t,e):Pt(r,t))}function rh(r,t){var e=t||{},i=[ct,ie("cp:coreProperties",null,{"xmlns:cp":Ct.CORE_PROPS,"xmlns:dc":Ct.dc,"xmlns:dcterms":Ct.dcterms,"xmlns:dcmitype":Ct.dcmitype,"xmlns:xsi":Ct.xsi})],n={};if(!r&&!e.Props)return i.join("");r&&(r.CreatedDate!=null&&uo("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:_o(r.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,n),r.ModifiedDate!=null&&uo("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:_o(r.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,n));for(var s=0;s!=Bi.length;++s){var a=Bi[s],o=e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:r?r[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&uo(a[0],o,null,i,n)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var vn=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],ih=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function nh(r){var t=[],e=ie;return r||(r={}),r.Application="SheetJS",t[t.length]=ct,t[t.length]=ie("Properties",null,{xmlns:Ct.EXT_PROPS,"xmlns:vt":Ct.vt}),vn.forEach(function(i){if(r[i[1]]!==void 0){var n;switch(i[2]){case"string":n=ze(String(r[i[1]]));break;case"bool":n=r[i[1]]?"true":"false";break}n!==void 0&&(t[t.length]=e(i[0],n))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",r.SheetNames.map(function(i){return"<vt:lpstr>"+ze(i)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function sh(r){var t=[ct,ie("Properties",null,{xmlns:Ct.CUST_PROPS,"xmlns:vt":Ct.vt})];if(!r)return t.join("");var e=1;return Rt(r).forEach(function(n){++e,t[t.length]=ie("property",$p(r[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:ze(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var n0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Sm(r,t){var e=[];return Rt(n0).map(function(i){for(var n=0;n<Bi.length;++n)if(Bi[n][1]==i)return Bi[n];for(n=0;n<vn.length;++n)if(vn[n][1]==i)return vn[n];throw i}).forEach(function(i){if(r[i[1]]!=null){var n=t&&t.Props&&t.Props[i[1]]!=null?t.Props[i[1]]:r[i[1]];switch(i[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),e.push(Pt(n0[i[1]]||i[1],n))}}),ie("DocumentProperties",e.join(""),{xmlns:gr.o})}function Em(r,t){var e=["Worksheets","SheetNames"],i="CustomDocumentProperties",n=[];return r&&Rt(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var a=0;a<Bi.length;++a)if(s==Bi[a][1])return;for(a=0;a<vn.length;++a)if(s==vn[a][1])return;for(a=0;a<e.length;++a)if(s==e[a])return;var o=r[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),n.push(ie(Gc(s),o,{"dt:dt":c}))}}),t&&Rt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),n.push(ie(Gc(s),a,{"dt:dt":o}))}}),"<"+i+' xmlns="'+gr.o+'">'+n.join("")+"</"+i+">"}function km(r){var t=typeof r=="string"?new Date(Date.parse(r)):r,e=t.getTime()/1e3+11644473600,i=e%Math.pow(2,32),n=(e-i)/Math.pow(2,32);i*=1e7,n*=1e7;var s=i/Math.pow(2,32)|0;s>0&&(i=i%Math.pow(2,32),n+=s);var a=B(8);return a.write_shift(4,i),a.write_shift(4,n),a}function s0(r,t){var e=B(4),i=B(4);switch(e.write_shift(4,r==80?31:r),r){case 3:i.write_shift(-4,t);break;case 5:i=B(8),i.write_shift(8,t,"f");break;case 11:i.write_shift(4,t?1:0);break;case 64:i=km(t);break;case 31:case 80:for(i=B(4+2*(t.length+1)+(t.length%2?0:2)),i.write_shift(4,t.length+1),i.write_shift(0,t,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+t)}return Mt([e,i])}var ah=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Im(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function a0(r,t,e){var i=B(8),n=[],s=[],a=8,o=0,c=B(8),l=B(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),s.push(c),n.push(l),a+=8+c.length,!t){l=B(8),l.write_shift(4,0),n.unshift(l);var h=[B(4)];for(h[0].write_shift(4,r.length),o=0;o<r.length;++o){var f=r[o][0];for(c=B(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=Mt(h),s.unshift(c),a+=8+c.length}for(o=0;o<r.length;++o)if(!(t&&!t[r[o][0]])&&!(ah.indexOf(r[o][0])>-1||ih.indexOf(r[o][0])>-1)&&r[o][1]!=null){var u=r[o][1],d=0;if(t){d=+t[r[o][0]];var g=e[d];if(g.p=="version"&&typeof u=="string"){var p=u.split(".");u=(+p[0]<<16)+(+p[1]||0)}c=s0(g.t,u)}else{var x=Im(u);x==-1&&(x=31,u=String(u)),c=s0(x,u)}s.push(c),l=B(8),l.write_shift(4,t?d:2+o),n.push(l),a+=8+c.length}var E=8*(s.length+1);for(o=0;o<s.length;++o)n[o].write_shift(4,E),E+=s[o].length;return i.write_shift(4,a),i.write_shift(4,s.length),Mt([i].concat(n).concat(s))}function o0(r,t,e,i,n,s){var a=B(n?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Ye.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,n?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,n?68:48);var c=a0(r,e,i);if(o.push(c),n){var l=a0(n,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+c.length),o.push(l)}return Mt(o)}function Fm(r,t){t||(t=B(r));for(var e=0;e<r;++e)t.write_shift(1,0);return t}function Om(r,t){return r.read_shift(t)===1}function Gt(r,t){return t||(t=B(2)),t.write_shift(2,+!!r),t}function oh(r){return r.read_shift(2,"u")}function Sr(r,t){return t||(t=B(2)),t.write_shift(2,r),t}function lh(r,t,e){return e||(e=B(2)),e.write_shift(1,t=="e"?+r:+!!r),e.write_shift(1,t=="e"?1:0),e}function ch(r,t,e){var i=r.read_shift(e&&e.biff>=12?2:1),n="sbcs-cont",s=Ni;if(e&&e.biff>=8&&(Ni=1200),!e||e.biff==8){var a=r.read_shift(1);a&&(n="dbcs-cont")}else e.biff==12&&(n="wstr");e.biff>=2&&e.biff<=5&&(n="cpstr");var o=i?r.read_shift(i,n):"";return Ni=s,o}function Am(r){var t=r.t||"",e=1,i=B(3+(e>1?2:0));i.write_shift(2,t.length),i.write_shift(1,(e>1?8:0)|1),e>1&&i.write_shift(2,e);var n=B(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[i,n];return Mt(s)}function Dm(r,t,e){var i;if(e){if(e.biff>=2&&e.biff<=5)return r.read_shift(t,"cpstr");if(e.biff>=12)return r.read_shift(t,"dbcs-cont")}var n=r.read_shift(1);return n===0?i=r.read_shift(t,"sbcs-cont"):i=r.read_shift(t,"dbcs-cont"),i}function Mm(r,t,e){var i=r.read_shift(e&&e.biff==2?1:2);return i===0?(r.l++,""):Dm(r,i,e)}function Pm(r,t,e){if(e.biff>5)return Mm(r,t,e);var i=r.read_shift(1);return i===0?(r.l++,""):r.read_shift(i,e.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function hh(r,t,e){return e||(e=B(3+2*r.length)),e.write_shift(2,r.length),e.write_shift(1,1),e.write_shift(31,r,"utf16le"),e}function l0(r,t){t||(t=B(6+r.length*2)),t.write_shift(4,1+r.length);for(var e=0;e<r.length;++e)t.write_shift(2,r.charCodeAt(e));return t.write_shift(2,0),t}function Lm(r){var t=B(512),e=0,i=r.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var n=i.indexOf("#"),s=n>-1?31:23;switch(i.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(e=0;e<a.length;++e)t.write_shift(4,a[e]);if(s==28)i=i.slice(1),l0(i,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<a.length;++e)t.write_shift(1,parseInt(a[e],16));var o=n>-1?i.slice(0,n):i;for(t.write_shift(4,2*(o.length+1)),e=0;e<o.length;++e)t.write_shift(2,o.charCodeAt(e));t.write_shift(2,0),s&8&&l0(n>-1?i.slice(n+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<a.length;++e)t.write_shift(1,parseInt(a[e],16));for(var c=0;i.slice(c*3,c*3+3)=="../"||i.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,i.length-3*c+1),e=0;e<i.length-3*c;++e)t.write_shift(1,i.charCodeAt(e+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),e=0;e<6;++e)t.write_shift(4,0)}return t.slice(0,t.l)}function $i(r,t,e,i){return i||(i=B(6)),i.write_shift(2,r),i.write_shift(2,t),i.write_shift(2,e||0),i}function Rm(r,t,e){var i=e.biff>8?4:2,n=r.read_shift(i),s=r.read_shift(i,"i"),a=r.read_shift(i,"i");return[n,s,a]}function Nm(r){var t=r.read_shift(2),e=r.read_shift(2),i=r.read_shift(2),n=r.read_shift(2);return{s:{c:i,r:t},e:{c:n,r:e}}}function fh(r,t){return t||(t=B(8)),t.write_shift(2,r.s.r),t.write_shift(2,r.e.r),t.write_shift(2,r.s.c),t.write_shift(2,r.e.c),t}function Wo(r,t,e){var i=1536,n=16;switch(e.bookType){case"biff8":break;case"biff5":i=1280,n=8;break;case"biff4":i=4,n=6;break;case"biff3":i=3,n=6;break;case"biff2":i=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=B(n);return s.write_shift(2,i),s.write_shift(2,t),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Bm(r,t){var e=!t||t.biff==8,i=B(e?112:54);for(i.write_shift(t.biff==8?2:1,7),e&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(e?0:536870912));i.l<i.length;)i.write_shift(1,e?0:32);return i}function Wm(r,t){var e=!t||t.biff>=8?2:1,i=B(8+e*r.name.length);i.write_shift(4,r.pos),i.write_shift(1,r.hs||0),i.write_shift(1,r.dt),i.write_shift(1,r.name.length),t.biff>=8&&i.write_shift(1,1),i.write_shift(e*r.name.length,r.name,t.biff<8?"sbcs":"utf16le");var n=i.slice(0,i.l);return n.l=i.l,n}function Hm(r,t){var e=B(8);e.write_shift(4,r.Count),e.write_shift(4,r.Unique);for(var i=[],n=0;n<r.length;++n)i[n]=Am(r[n],t);var s=Mt([e].concat(i));return s.parts=[e.length].concat(i.map(function(a){return a.length})),s}function $m(){var r=B(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function Vm(r){var t=B(18),e=1718;return r&&r.RTL&&(e|=64),t.write_shift(2,e),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Um(r,t){var e=r.name||"Arial",i=t&&t.biff==5,n=i?15+e.length:16+2*e.length,s=B(n);return s.write_shift(2,(r.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,e.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le"),s}function zm(r,t,e,i){var n=B(10);return $i(r,t,i,n),n.write_shift(4,e),n}function Gm(r,t,e,i,n){var s=!n||n.biff==8,a=B(8+ +s+(1+s)*e.length);return $i(r,t,i,a),a.write_shift(2,e.length),s&&a.write_shift(1,1),a.write_shift((1+s)*e.length,e,s?"utf16le":"sbcs"),a}function Xm(r,t,e,i){var n=e&&e.biff==5;i||(i=B(n?3+t.length:5+2*t.length)),i.write_shift(2,r),i.write_shift(n?1:2,t.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var s=i.length>i.l?i.slice(0,i.l):i;return s.l==null&&(s.l=s.length),s}function jm(r,t){var e=t.biff==8||!t.biff?4:2,i=B(2*e+6);return i.write_shift(e,r.s.r),i.write_shift(e,r.e.r+1),i.write_shift(2,r.s.c),i.write_shift(2,r.e.c+1),i.write_shift(2,0),i}function c0(r,t,e,i){var n=e&&e.biff==5;i||(i=B(n?16:20)),i.write_shift(2,0),r.style?(i.write_shift(2,r.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,r.numFmtId||0),i.write_shift(2,t<<4));var s=0;return r.numFmtId>0&&n&&(s|=1024),i.write_shift(4,s),i.write_shift(4,0),n||i.write_shift(4,0),i.write_shift(2,0),i}function Ym(r){var t=B(8);return t.write_shift(4,0),t.write_shift(2,r[0]?r[0]+1:0),t.write_shift(2,r[1]?r[1]+1:0),t}function Km(r,t,e,i,n,s){var a=B(8);return $i(r,t,i,a),lh(e,s,a),a}function qm(r,t,e,i){var n=B(14);return $i(r,t,i,n),Hi(e,n),n}function Qm(r,t,e){if(e.biff<8)return Zm(r,t,e);for(var i=[],n=r.l+t,s=r.read_shift(e.biff>8?4:2);s--!==0;)i.push(Rm(r,e.biff>8?12:6,e));if(r.l!=n)throw new Error("Bad ExternSheet: "+r.l+" != "+n);return i}function Zm(r,t,e){r[r.l+1]==3&&r[r.l]++;var i=ch(r,t,e);return i.charCodeAt(0)==3?i.slice(1):i}function Jm(r){var t=B(2+r.length*8);t.write_shift(2,r.length);for(var e=0;e<r.length;++e)fh(r[e],t);return t}function eg(r){var t=B(24),e=bt(r[0]);t.write_shift(2,e.r),t.write_shift(2,e.r),t.write_shift(2,e.c),t.write_shift(2,e.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(i[n],16));return Mt([t,Lm(r[1])])}function tg(r){var t=r[1].Tooltip,e=B(10+2*(t.length+1));e.write_shift(2,2048);var i=bt(r[0]);e.write_shift(2,i.r),e.write_shift(2,i.r),e.write_shift(2,i.c),e.write_shift(2,i.c);for(var n=0;n<t.length;++n)e.write_shift(2,t.charCodeAt(n));return e.write_shift(2,0),e}function rg(r){return r||(r=B(4)),r.write_shift(2,1),r.write_shift(2,1),r}function ig(r,t,e){if(!e.cellStyles)return Gr(r,t);var i=e&&e.biff>=12?4:2,n=r.read_shift(i),s=r.read_shift(i),a=r.read_shift(i),o=r.read_shift(i),c=r.read_shift(2);i==2&&(r.l+=2);var l={s:n,e:s,w:a,ixfe:o,flags:c};return(e.biff>=5||!e.biff)&&(l.level=c>>8&7),l}function ng(r,t){var e=B(12);e.write_shift(2,t),e.write_shift(2,t),e.write_shift(2,r.width*256),e.write_shift(2,0);var i=0;return r.hidden&&(i|=1),e.write_shift(1,i),i=r.level||0,e.write_shift(1,i),e.write_shift(2,0),e}function sg(r){for(var t=B(2*r),e=0;e<r;++e)t.write_shift(2,e+1);return t}function ag(r,t,e){var i=B(15);return ds(i,r,t),i.write_shift(8,e,"f"),i}function og(r,t,e){var i=B(9);return ds(i,r,t),i.write_shift(2,e),i}var lg=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=To({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(o,c){var l=[],h=Wi(1);switch(c.type){case"base64":h=Dr(ii(o));break;case"binary":h=Dr(o);break;case"buffer":case"array":h=o;break}mr(h,0);var f=h.read_shift(1),u=!!(f&136),d=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:d=!0,u=!0;break;case 49:d=!0,u=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,x=521;f==2&&(p=h.read_shift(2)),h.l+=3,f!=2&&(p=h.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(x=h.read_shift(2));var E=h.read_shift(2),F=c.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(F=r[h[h.l]]),h.l+=1,h.l+=2),g&&(h.l+=36);for(var O=[],V={},Z=Math.min(h.length,f==2?521:x-10-(d?264:0)),he=g?32:11;h.l<Z&&h[h.l]!=13;)switch(V={},V.name=qe.utils.decode(F,h.slice(h.l,h.l+he)).replace(/[\u0000\r\n].*$/g,""),h.l+=he,V.type=String.fromCharCode(h.read_shift(1)),f!=2&&!g&&(V.offset=h.read_shift(4)),V.len=h.read_shift(1),f==2&&(V.offset=h.read_shift(2)),V.dec=h.read_shift(1),V.name.length&&O.push(V),f!=2&&(h.l+=g?13:14),V.type){case"B":(!d||V.len!=8)&&c.WTF&&console.log("Skipping "+V.name+":"+V.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+V.name+":"+V.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+V.type)}if(h[h.l]!==13&&(h.l=x-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=x;var D=0,Y=0;for(l[0]=[],Y=0;Y!=O.length;++Y)l[0][Y]=O[Y].name;for(;p-- >0;){if(h[h.l]===42){h.l+=E;continue}for(++h.l,l[++D]=[],Y=0,Y=0;Y!=O.length;++Y){var H=h.slice(h.l,h.l+O[Y].len);h.l+=O[Y].len,mr(H,0);var X=qe.utils.decode(F,H);switch(O[Y].type){case"C":X.trim().length&&(l[D][Y]=X.replace(/\s+$/,""));break;case"D":X.length===8?l[D][Y]=new Date(+X.slice(0,4),+X.slice(4,6)-1,+X.slice(6,8)):l[D][Y]=X;break;case"F":l[D][Y]=parseFloat(X.trim());break;case"+":case"I":l[D][Y]=g?H.read_shift(-4,"i")^2147483648:H.read_shift(4,"i");break;case"L":switch(X.trim().toUpperCase()){case"Y":case"T":l[D][Y]=!0;break;case"N":case"F":l[D][Y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+X+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));l[D][Y]="##MEMO##"+(g?parseInt(X.trim(),10):H.read_shift(4));break;case"N":X=X.replace(/\u0000/g,"").trim(),X&&X!="."&&(l[D][Y]=+X||0);break;case"@":l[D][Y]=new Date(H.read_shift(-8,"f")-621356832e5);break;case"T":l[D][Y]=new Date((H.read_shift(4)-2440588)*864e5+H.read_shift(4));break;case"Y":l[D][Y]=H.read_shift(4,"i")/1e4+H.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[D][Y]=-H.read_shift(-8,"f");break;case"B":if(d&&O[Y].len==8){l[D][Y]=H.read_shift(8,"f");break}case"G":case"P":H.l+=O[Y].len;break;case"0":if(O[Y].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+O[Y].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=O,l}function i(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var h=Tn(e(o,l),l);return h["!cols"]=l.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete l.DBF,h}function n(o,c){try{return Vi(i(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var l=c||{};if(+l.codepage>=0&&is(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var h=er(),f=ha(o,{header:1,raw:!0,cellDates:!0}),u=f[0],d=f.slice(1),g=o["!cols"]||[],p=0,x=0,E=0,F=1;for(p=0;p<u.length;++p){if(((g[p]||{}).DBF||{}).name){u[p]=g[p].DBF.name,++E;continue}if(u[p]!=null){if(++E,typeof u[p]=="number"&&(u[p]=u[p].toString(10)),typeof u[p]!="string")throw new Error("DBF Invalid column name "+u[p]+" |"+typeof u[p]+"|");if(u.indexOf(u[p])!==p){for(x=0;x<1024;++x)if(u.indexOf(u[p]+"_"+x)==-1){u[p]+="_"+x;break}}}}var O=Je(o["!ref"]),V=[],Z=[],he=[];for(p=0;p<=O.e.c-O.s.c;++p){var D="",Y="",H=0,X=[];for(x=0;x<d.length;++x)d[x][p]!=null&&X.push(d[x][p]);if(X.length==0||u[p]==null){V[p]="?";continue}for(x=0;x<X.length;++x){switch(typeof X[x]){case"number":Y="B";break;case"string":Y="C";break;case"boolean":Y="L";break;case"object":Y=X[x]instanceof Date?"D":"C";break;default:Y="C"}H=Math.max(H,String(X[x]).length),D=D&&D!=Y?"C":Y}H>250&&(H=250),Y=((g[p]||{}).DBF||{}).type,Y=="C"&&g[p].DBF.len>H&&(H=g[p].DBF.len),D=="B"&&Y=="N"&&(D="N",he[p]=g[p].DBF.dec,H=g[p].DBF.len),Z[p]=D=="C"||Y=="N"?H:s[D]||0,F+=Z[p],V[p]=D}var Q=h.next(32);for(Q.write_shift(4,318902576),Q.write_shift(4,d.length),Q.write_shift(2,296+32*E),Q.write_shift(2,F),p=0;p<4;++p)Q.write_shift(4,0);for(Q.write_shift(4,0|(+t[yn]||3)<<8),p=0,x=0;p<u.length;++p)if(u[p]!=null){var J=h.next(32),ge=(u[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);J.write_shift(1,ge,"sbcs"),J.write_shift(1,V[p]=="?"?"C":V[p],"sbcs"),J.write_shift(4,x),J.write_shift(1,Z[p]||s[V[p]]||0),J.write_shift(1,he[p]||0),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(1,0),J.write_shift(4,0),J.write_shift(4,0),x+=Z[p]||s[V[p]]||0}var He=h.next(264);for(He.write_shift(4,13),p=0;p<65;++p)He.write_shift(4,0);for(p=0;p<d.length;++p){var _e=h.next(F);for(_e.write_shift(1,0),x=0;x<u.length;++x)if(u[x]!=null)switch(V[x]){case"L":_e.write_shift(1,d[p][x]==null?63:d[p][x]?84:70);break;case"B":_e.write_shift(8,d[p][x]||0,"f");break;case"N":var pt="0";for(typeof d[p][x]=="number"&&(pt=d[p][x].toFixed(he[x]||0)),E=0;E<Z[x]-pt.length;++E)_e.write_shift(1,32);_e.write_shift(1,pt,"sbcs");break;case"D":d[p][x]?(_e.write_shift(4,("0000"+d[p][x].getFullYear()).slice(-4),"sbcs"),_e.write_shift(2,("00"+(d[p][x].getMonth()+1)).slice(-2),"sbcs"),_e.write_shift(2,("00"+d[p][x].getDate()).slice(-2),"sbcs")):_e.write_shift(8,"00000000","sbcs");break;case"C":var mt=String(d[p][x]!=null?d[p][x]:"").slice(0,Z[x]);for(_e.write_shift(1,mt,"sbcs"),E=0;E<Z[x]-mt.length;++E)_e.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:n,to_sheet:i,from_sheet:a}}(),cg=function(){var r={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Rt(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(u,d){var g=r[d];return typeof g=="number"?Mc(g):g},i=function(u,d,g){var p=d.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?u:Mc(p)};r["|"]=254;function n(u,d){switch(d.type){case"base64":return s(ii(u),d);case"binary":return s(u,d);case"buffer":return s(We&&Buffer.isBuffer(u)?u.toString("binary"):cs(u),d);case"array":return s(ma(u),d)}throw new Error("Unrecognized type "+d.type)}function s(u,d){var g=u.split(/[\n\r]+/),p=-1,x=-1,E=0,F=0,O=[],V=[],Z=null,he={},D=[],Y=[],H=[],X=0,Q;for(+d.codepage>=0&&is(+d.codepage);E!==g.length;++E){X=0;var J=g[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(t,e),ge=J.replace(/;;/g,"\0").split(";").map(function(T){return T.replace(/\u0000/g,";")}),He=ge[0],_e;if(J.length>0)switch(He){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ge[1].charAt(0)=="P"&&V.push(J.slice(3).replace(/;;/g,";"));break;case"C":var pt=!1,mt=!1,jt=!1,$t=!1,St=-1,Yt=-1;for(F=1;F<ge.length;++F)switch(ge[F].charAt(0)){case"A":break;case"X":x=parseInt(ge[F].slice(1))-1,mt=!0;break;case"Y":for(p=parseInt(ge[F].slice(1))-1,mt||(x=0),Q=O.length;Q<=p;++Q)O[Q]=[];break;case"K":_e=ge[F].slice(1),_e.charAt(0)==='"'?_e=_e.slice(1,_e.length-1):_e==="TRUE"?_e=!0:_e==="FALSE"?_e=!1:isNaN(ti(_e))?isNaN(ss(_e).getDate())||(_e=Xt(_e)):(_e=ti(_e),Z!==null&&O0(Z)&&(_e=P0(_e))),typeof qe<"u"&&typeof _e=="string"&&(d||{}).type!="string"&&(d||{}).codepage&&(_e=qe.utils.decode(d.codepage,_e)),pt=!0;break;case"E":$t=!0;var b=o1(ge[F].slice(1),{r:p,c:x});O[p][x]=[O[p][x],b];break;case"S":jt=!0,O[p][x]=[O[p][x],"S5S"];break;case"G":break;case"R":St=parseInt(ge[F].slice(1))-1;break;case"C":Yt=parseInt(ge[F].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+J)}if(pt&&(O[p][x]&&O[p][x].length==2?O[p][x][0]=_e:O[p][x]=_e,Z=null),jt){if($t)throw new Error("SYLK shared formula cannot have own formula");var z=St>-1&&O[St][Yt];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");O[p][x][1]=l1(z[1],{r:p-St,c:x-Yt})}break;case"F":var S=0;for(F=1;F<ge.length;++F)switch(ge[F].charAt(0)){case"X":x=parseInt(ge[F].slice(1))-1,++S;break;case"Y":for(p=parseInt(ge[F].slice(1))-1,Q=O.length;Q<=p;++Q)O[Q]=[];break;case"M":X=parseInt(ge[F].slice(1))/20;break;case"F":break;case"G":break;case"P":Z=V[parseInt(ge[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(H=ge[F].slice(1).split(" "),Q=parseInt(H[0],10);Q<=parseInt(H[1],10);++Q)X=parseInt(H[2],10),Y[Q-1]=X===0?{hidden:!0}:{wch:X},Ho(Y[Q-1]);break;case"C":x=parseInt(ge[F].slice(1))-1,Y[x]||(Y[x]={});break;case"R":p=parseInt(ge[F].slice(1))-1,D[p]||(D[p]={}),X>0?(D[p].hpt=X,D[p].hpx=gh(X)):X===0&&(D[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+J)}S<1&&(Z=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+J)}}return D.length>0&&(he["!rows"]=D),Y.length>0&&(he["!cols"]=Y),d&&d.sheetRows&&(O=O.slice(0,d.sheetRows)),[O,he]}function a(u,d){var g=n(u,d),p=g[0],x=g[1],E=Tn(p,d);return Rt(x).forEach(function(F){E[F]=x[F]}),E}function o(u,d){return Vi(a(u,d),d)}function c(u,d,g,p){var x="C;Y"+(g+1)+";X"+(p+1)+";K";switch(u.t){case"n":x+=u.v||0,u.f&&!u.F&&(x+=";E"+Vo(u.f,{r:g,c:p}));break;case"b":x+=u.v?"TRUE":"FALSE";break;case"e":x+=u.w||u.v;break;case"d":x+='"'+(u.w||u.v)+'"';break;case"s":x+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function l(u,d){d.forEach(function(g,p){var x="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?x+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=aa(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=oa(g.wpx)),typeof g.wch=="number"&&(x+=Math.round(g.wch))),x.charAt(x.length-1)!=" "&&u.push(x)})}function h(u,d){d.forEach(function(g,p){var x="F;";g.hidden?x+="M0;":g.hpt?x+="M"+20*g.hpt+";":g.hpx&&(x+="M"+20*la(g.hpx)+";"),x.length>2&&u.push(x+"R"+(p+1))})}function f(u,d){var g=["ID;PWXL;N;E"],p=[],x=Je(u["!ref"]),E,F=Array.isArray(u),O=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),u["!cols"]&&l(g,u["!cols"]),u["!rows"]&&h(g,u["!rows"]),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var V=x.s.r;V<=x.e.r;++V)for(var Z=x.s.c;Z<=x.e.c;++Z){var he=Ge({r:V,c:Z});E=F?(u[V]||[])[Z]:u[he],!(!E||E.v==null&&(!E.f||E.F))&&p.push(c(E,u,V,Z,d))}return g.join(O)+O+p.join(O)+O+"E"+O}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),hg=function(){function r(s,a){switch(a.type){case"base64":return t(ii(s),a);case"binary":return t(s,a);case"buffer":return t(We&&Buffer.isBuffer(s)?s.toString("binary"):cs(s),a);case"array":return t(ma(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),c=-1,l=-1,h=0,f=[];h!==o.length;++h){if(o[h].trim()==="BOT"){f[++c]=[],l=0;continue}if(!(c<0)){var u=o[h].trim().split(","),d=u[0],g=u[1];++h;for(var p=o[h]||"";(p.match(/["]/g)||[]).length&1&&h<o.length-1;)p+=`
`+o[++h];switch(p=p.trim(),+d){case-1:if(p==="BOT"){f[++c]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][l]=!0:p==="FALSE"?f[c][l]=!1:isNaN(ti(g))?isNaN(ss(g).getDate())?f[c][l]=g:f[c][l]=Xt(g):f[c][l]=ti(g),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),Yn&&p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][l++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function e(s,a){return Tn(r(s,a),a)}function i(s,a){return Vi(e(s,a),a)}var n=function(){var s=function(c,l,h,f,u){c.push(l),c.push(h+","+f),c.push('"'+u.replace(/"/g,'""')+'"')},a=function(c,l,h,f){c.push(l+","+h),c.push(l==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var l=[],h=Je(c["!ref"]),f,u=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,h.e.r-h.s.r+1,""),s(l,"TUPLES",0,h.e.c-h.s.c+1,""),s(l,"DATA",0,0,"");for(var d=h.s.r;d<=h.e.r;++d){a(l,-1,0,"BOT");for(var g=h.s.c;g<=h.e.c;++g){var p=Ge({r:d,c:g});if(f=u?(c[d]||[])[g]:c[p],!f){a(l,1,0,"");continue}switch(f.t){case"n":var x=Yn?f.w:f.v;!x&&f.v!=null&&(x=f.v),x==null?Yn&&f.f&&!f.F?a(l,1,0,"="+f.f):a(l,1,0,""):a(l,0,x,"V");break;case"b":a(l,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(l,1,0,!Yn||isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=vi(f.z||it[14],tr(Xt(f.v)))),Yn?a(l,0,f.w,"V"):a(l,1,0,f.w);break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var E=`\r
`,F=l.join(E);return F}}();return{to_workbook:i,to_sheet:e,from_sheet:n}}(),uh=function(){function r(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(f,u){for(var d=f.split(`
`),g=-1,p=-1,x=0,E=[];x!==d.length;++x){var F=d[x].trim().split(":");if(F[0]==="cell"){var O=bt(F[1]);if(E.length<=O.r)for(g=E.length;g<=O.r;++g)E[g]||(E[g]=[]);switch(g=O.r,p=O.c,F[2]){case"t":E[g][p]=r(F[3]);break;case"v":E[g][p]=+F[3];break;case"vtf":var V=F[F.length-1];case"vtc":switch(F[3]){case"nl":E[g][p]=!!+F[4];break;default:E[g][p]=+F[4];break}F[2]=="vtf"&&(E[g][p]=[E[g][p],V])}}}return u&&u.sheetRows&&(E=E.slice(0,u.sheetRows)),E}function i(f,u){return Tn(e(f,u),u)}function n(f,u){return Vi(i(f,u),u)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(f){if(!f||!f["!ref"])return"";for(var u=[],d=[],g,p="",x=xr(f["!ref"]),E=Array.isArray(f),F=x.s.r;F<=x.e.r;++F)for(var O=x.s.c;O<=x.e.c;++O)if(p=Ge({r:F,c:O}),g=E?(f[F]||[])[O]:f[p],!(!g||g.v==null||g.t==="z")){switch(d=["cell",p,"t"],g.t){case"s":case"str":d.push(t(g.v));break;case"n":g.f?(d[2]="vtf",d[3]="n",d[4]=g.v,d[5]=t(g.f)):(d[2]="v",d[3]=g.v);break;case"b":d[2]="vt"+(g.f?"f":"c"),d[3]="nl",d[4]=g.v?"1":"0",d[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var V=tr(Xt(g.v));d[2]="vtc",d[3]="nd",d[4]=""+V,d[5]=g.w||vi(g.z||it[14],V);break;case"e":continue}u.push(d.join(":"))}return u.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function h(f){return[s,a,o,a,l(f),c].join(`
`)}return{to_workbook:n,to_sheet:i,from_sheet:h}}(),fg=function(){function r(h,f,u,d,g){g.raw?f[u][d]=h:h===""||(h==="TRUE"?f[u][d]=!0:h==="FALSE"?f[u][d]=!1:isNaN(ti(h))?isNaN(ss(h).getDate())?f[u][d]=h:f[u][d]=Xt(h):f[u][d]=ti(h))}function t(h,f){var u=f||{},d=[];if(!h||h.length===0)return d;for(var g=h.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var x=10,E=0,F=0;F<=p;++F)E=g[F].indexOf(" "),E==-1?E=g[F].length:E++,x=Math.max(x,E);for(F=0;F<=p;++F){d[F]=[];var O=0;for(r(g[F].slice(0,x).trim(),d,F,O,u),O=1;O<=(g[F].length-x)/10+1;++O)r(g[F].slice(x+(O-1)*10,x+O*10).trim(),d,F,O,u)}return u.sheetRows&&(d=d.slice(0,u.sheetRows)),d}var e={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function n(h){for(var f={},u=!1,d=0,g=0;d<h.length;++d)(g=h.charCodeAt(d))==34?u=!u:!u&&g in e&&(f[g]=(f[g]||0)+1);g=[];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&g.push([f[d],d]);if(!g.length){f=i;for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&g.push([f[d],d])}return g.sort(function(p,x){return p[0]-x[0]||i[p[1]]-i[x[1]]}),e[g.pop()[1]]||44}function s(h,f){var u=f||{},d="";zr!=null&&u.dense==null&&(u.dense=zr);var g=u.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(d=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(d=h.charAt(4),h=h.slice(6)):d=n(h.slice(0,1024)):u&&u.FS?d=u.FS:d=n(h.slice(0,1024));var x=0,E=0,F=0,O=0,V=0,Z=d.charCodeAt(0),he=!1,D=0,Y=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var H=u.dateNF!=null?Ep(u.dateNF):null;function X(){var Q=h.slice(O,V),J={};if(Q.charAt(0)=='"'&&Q.charAt(Q.length-1)=='"'&&(Q=Q.slice(1,-1).replace(/""/g,'"')),Q.length===0)J.t="z";else if(u.raw)J.t="s",J.v=Q;else if(Q.trim().length===0)J.t="s",J.v=Q;else if(Q.charCodeAt(0)==61)Q.charCodeAt(1)==34&&Q.charCodeAt(Q.length-1)==34?(J.t="s",J.v=Q.slice(2,-1).replace(/""/g,'"')):c1(Q)?(J.t="n",J.f=Q.slice(1)):(J.t="s",J.v=Q);else if(Q=="TRUE")J.t="b",J.v=!0;else if(Q=="FALSE")J.t="b",J.v=!1;else if(!isNaN(F=ti(Q)))J.t="n",u.cellText!==!1&&(J.w=Q),J.v=F;else if(!isNaN(ss(Q).getDate())||H&&Q.match(H)){J.z=u.dateNF||it[14];var ge=0;H&&Q.match(H)&&(Q=kp(Q,u.dateNF,Q.match(H)||[]),ge=1),u.cellDates?(J.t="d",J.v=Xt(Q,ge)):(J.t="n",J.v=tr(Xt(Q,ge))),u.cellText!==!1&&(J.w=vi(J.z,J.v instanceof Date?tr(J.v):J.v)),u.cellNF||delete J.z}else J.t="s",J.v=Q;if(J.t=="z"||(u.dense?(g[x]||(g[x]=[]),g[x][E]=J):g[Ge({c:E,r:x})]=J),O=V+1,Y=h.charCodeAt(O),p.e.c<E&&(p.e.c=E),p.e.r<x&&(p.e.r=x),D==Z)++E;else if(E=0,++x,u.sheetRows&&u.sheetRows<=x)return!0}e:for(;V<h.length;++V)switch(D=h.charCodeAt(V)){case 34:Y===34&&(he=!he);break;case Z:case 10:case 13:if(!he&&X())break e;break;default:break}return V-O>0&&X(),g["!ref"]=lt(p),g}function a(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,f):Tn(t(h,f),f)}function o(h,f){var u="",d=f.type=="string"?[0,0,0,0]:by(h,f);switch(f.type){case"base64":u=ii(h);break;case"binary":u=h;break;case"buffer":f.codepage==65001?u=h.toString("utf8"):f.codepage&&typeof qe<"u"?u=qe.utils.decode(f.codepage,h):u=We&&Buffer.isBuffer(h)?h.toString("binary"):cs(h);break;case"array":u=ma(h);break;case"string":u=h;break;default:throw new Error("Unrecognized type "+f.type)}return d[0]==239&&d[1]==187&&d[2]==191?u=Qn(u.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?u=Qn(u):f.type=="binary"&&typeof qe<"u"&&f.codepage&&(u=qe.utils.decode(f.codepage,qe.utils.encode(28591,u))),u.slice(0,19)=="socialcalc:version:"?uh.to_sheet(f.type=="string"?u:Qn(u),f):a(u,f)}function c(h,f){return Vi(o(h,f),f)}function l(h){for(var f=[],u=Je(h["!ref"]),d,g=Array.isArray(h),p=u.s.r;p<=u.e.r;++p){for(var x=[],E=u.s.c;E<=u.e.c;++E){var F=Ge({r:p,c:E});if(d=g?(h[p]||[])[E]:h[F],!d||d.v==null){x.push("          ");continue}for(var O=(d.w||(ni(d),d.w)||"").slice(0,10);O.length<10;)O+=" ";x.push(O+(E===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();var h0=function(){function r(b,z,S){if(b){mr(b,b.l||0);for(var T=S.Enum||St;b.l<b.length;){var q=b.read_shift(2),pe=T[q]||T[65535],be=b.read_shift(2),fe=b.l+be,oe=pe.f&&pe.f(b,be,S);if(b.l=fe,z(oe,pe,q))return}}}function t(b,z){switch(z.type){case"base64":return e(Dr(ii(b)),z);case"binary":return e(Dr(b),z);case"buffer":case"array":return e(b,z)}throw"Unsupported type "+z.type}function e(b,z){if(!b)return b;var S=z||{};zr!=null&&S.dense==null&&(S.dense=zr);var T=S.dense?[]:{},q="Sheet1",pe="",be=0,fe={},oe=[],Xe=[],Pe={s:{r:0,c:0},e:{r:0,c:0}},Et=S.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)S.Enum=St,r(b,function(de,vr,Xr){switch(Xr){case 0:S.vers=de,de>=4096&&(S.qpro=!0);break;case 6:Pe=de;break;case 204:de&&(pe=de);break;case 222:pe=de;break;case 15:case 51:S.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:Xr==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=S.dateNF||it[14],S.cellDates&&(de[1].t="d",de[1].v=P0(de[1].v))),S.qpro&&de[3]>be&&(T["!ref"]=lt(Pe),fe[q]=T,oe.push(q),T=S.dense?[]:{},Pe={s:{r:0,c:0},e:{r:0,c:0}},be=de[3],q=pe||"Sheet"+(be+1),pe="");var Ci=S.dense?(T[de[0].r]||[])[de[0].c]:T[Ge(de[0])];if(Ci){Ci.t=de[1].t,Ci.v=de[1].v,de[1].z!=null&&(Ci.z=de[1].z),de[1].f!=null&&(Ci.f=de[1].f);break}S.dense?(T[de[0].r]||(T[de[0].r]=[]),T[de[0].r][de[0].c]=de[1]):T[Ge(de[0])]=de[1];break;default:}},S);else if(b[2]==26||b[2]==14)S.Enum=Yt,b[2]==14&&(S.qpro=!0,b.l=0),r(b,function(de,vr,Xr){switch(Xr){case 204:q=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>be&&(T["!ref"]=lt(Pe),fe[q]=T,oe.push(q),T=S.dense?[]:{},Pe={s:{r:0,c:0},e:{r:0,c:0}},be=de[3],q="Sheet"+(be+1)),Et>0&&de[0].r>=Et)break;S.dense?(T[de[0].r]||(T[de[0].r]=[]),T[de[0].r][de[0].c]=de[1]):T[Ge(de[0])]=de[1],Pe.e.c<de[0].c&&(Pe.e.c=de[0].c),Pe.e.r<de[0].r&&(Pe.e.r=de[0].r);break;case 27:de[14e3]&&(Xe[de[14e3][0]]=de[14e3][1]);break;case 1537:Xe[de[0]]=de[1],de[0]==be&&(q=de[1]);break;default:break}},S);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(T["!ref"]=lt(Pe),fe[pe||q]=T,oe.push(pe||q),!Xe.length)return{SheetNames:oe,Sheets:fe};for(var Re={},Ir=[],tt=0;tt<Xe.length;++tt)fe[oe[tt]]?(Ir.push(Xe[tt]||oe[tt]),Re[Xe[tt]]=fe[Xe[tt]]||fe[oe[tt]]):(Ir.push(Xe[tt]),Re[Xe[tt]]={"!ref":"A1"});return{SheetNames:Ir,Sheets:Re}}function i(b,z){var S=z||{};if(+S.codepage>=0&&is(+S.codepage),S.type=="string")throw new Error("Cannot write WK1 to JS string");var T=er(),q=Je(b["!ref"]),pe=Array.isArray(b),be=[];ne(T,0,s(1030)),ne(T,6,c(q));for(var fe=Math.min(q.e.r,8191),oe=q.s.r;oe<=fe;++oe)for(var Xe=Lt(oe),Pe=q.s.c;Pe<=q.e.c;++Pe){oe===q.s.r&&(be[Pe]=Wt(Pe));var Et=be[Pe]+Xe,Re=pe?(b[oe]||[])[Pe]:b[Et];if(!(!Re||Re.t=="z"))if(Re.t=="n")(Re.v|0)==Re.v&&Re.v>=-32768&&Re.v<=32767?ne(T,13,d(oe,Pe,Re.v)):ne(T,14,p(oe,Pe,Re.v));else{var Ir=ni(Re);ne(T,15,f(oe,Pe,Ir.slice(0,239)))}}return ne(T,1),T.end()}function n(b,z){var S=z||{};if(+S.codepage>=0&&is(+S.codepage),S.type=="string")throw new Error("Cannot write WK3 to JS string");var T=er();ne(T,0,a(b));for(var q=0,pe=0;q<b.SheetNames.length;++q)(b.Sheets[b.SheetNames[q]]||{})["!ref"]&&ne(T,27,$t(b.SheetNames[q],pe++));var be=0;for(q=0;q<b.SheetNames.length;++q){var fe=b.Sheets[b.SheetNames[q]];if(!(!fe||!fe["!ref"])){for(var oe=Je(fe["!ref"]),Xe=Array.isArray(fe),Pe=[],Et=Math.min(oe.e.r,8191),Re=oe.s.r;Re<=Et;++Re)for(var Ir=Lt(Re),tt=oe.s.c;tt<=oe.e.c;++tt){Re===oe.s.r&&(Pe[tt]=Wt(tt));var de=Pe[tt]+Ir,vr=Xe?(fe[Re]||[])[tt]:fe[de];if(!(!vr||vr.t=="z"))if(vr.t=="n")ne(T,23,X(Re,tt,be,vr.v));else{var Xr=ni(vr);ne(T,22,D(Re,tt,be,Xr.slice(0,239)))}}++be}}return ne(T,1),T.end()}function s(b){var z=B(2);return z.write_shift(2,b),z}function a(b){var z=B(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var S=0,T=0,q=0,pe=0;pe<b.SheetNames.length;++pe){var be=b.SheetNames[pe],fe=b.Sheets[be];if(!(!fe||!fe["!ref"])){++q;var oe=xr(fe["!ref"]);S<oe.e.r&&(S=oe.e.r),T<oe.e.c&&(T=oe.e.c)}}return S>8191&&(S=8191),z.write_shift(2,S),z.write_shift(1,q),z.write_shift(1,T),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function o(b,z,S){var T={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&S.qpro?(T.s.c=b.read_shift(1),b.l++,T.s.r=b.read_shift(2),T.e.c=b.read_shift(1),b.l++,T.e.r=b.read_shift(2),T):(T.s.c=b.read_shift(2),T.s.r=b.read_shift(2),z==12&&S.qpro&&(b.l+=2),T.e.c=b.read_shift(2),T.e.r=b.read_shift(2),z==12&&S.qpro&&(b.l+=2),T.s.c==65535&&(T.s.c=T.e.c=T.s.r=T.e.r=0),T)}function c(b){var z=B(8);return z.write_shift(2,b.s.c),z.write_shift(2,b.s.r),z.write_shift(2,b.e.c),z.write_shift(2,b.e.r),z}function l(b,z,S){var T=[{c:0,r:0},{t:"n",v:0},0,0];return S.qpro&&S.vers!=20768?(T[0].c=b.read_shift(1),T[3]=b.read_shift(1),T[0].r=b.read_shift(2),b.l+=2):(T[2]=b.read_shift(1),T[0].c=b.read_shift(2),T[0].r=b.read_shift(2)),T}function h(b,z,S){var T=b.l+z,q=l(b,z,S);if(q[1].t="s",S.vers==20768){b.l++;var pe=b.read_shift(1);return q[1].v=b.read_shift(pe,"utf8"),q}return S.qpro&&b.l++,q[1].v=b.read_shift(T-b.l,"cstr"),q}function f(b,z,S){var T=B(7+S.length);T.write_shift(1,255),T.write_shift(2,z),T.write_shift(2,b),T.write_shift(1,39);for(var q=0;q<T.length;++q){var pe=S.charCodeAt(q);T.write_shift(1,pe>=128?95:pe)}return T.write_shift(1,0),T}function u(b,z,S){var T=l(b,z,S);return T[1].v=b.read_shift(2,"i"),T}function d(b,z,S){var T=B(7);return T.write_shift(1,255),T.write_shift(2,z),T.write_shift(2,b),T.write_shift(2,S,"i"),T}function g(b,z,S){var T=l(b,z,S);return T[1].v=b.read_shift(8,"f"),T}function p(b,z,S){var T=B(13);return T.write_shift(1,255),T.write_shift(2,z),T.write_shift(2,b),T.write_shift(8,S,"f"),T}function x(b,z,S){var T=b.l+z,q=l(b,z,S);if(q[1].v=b.read_shift(8,"f"),S.qpro)b.l=T;else{var pe=b.read_shift(2);V(b.slice(b.l,b.l+pe),q),b.l+=pe}return q}function E(b,z,S){var T=z&32768;return z&=-32769,z=(T?b:0)+(z>=8192?z-16384:z),(T?"":"$")+(S?Wt(z):Lt(z))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},O=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function V(b,z){mr(b,0);for(var S=[],T=0,q="",pe="",be="",fe="";b.l<b.length;){var oe=b[b.l++];switch(oe){case 0:S.push(b.read_shift(8,"f"));break;case 1:pe=E(z[0].c,b.read_shift(2),!0),q=E(z[0].r,b.read_shift(2),!1),S.push(pe+q);break;case 2:{var Xe=E(z[0].c,b.read_shift(2),!0),Pe=E(z[0].r,b.read_shift(2),!1);pe=E(z[0].c,b.read_shift(2),!0),q=E(z[0].r,b.read_shift(2),!1),S.push(Xe+Pe+":"+pe+q)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:S.push("("+S.pop()+")");break;case 5:S.push(b.read_shift(2));break;case 6:{for(var Et="";oe=b[b.l++];)Et+=String.fromCharCode(oe);S.push('"'+Et.replace(/"/g,'""')+'"')}break;case 8:S.push("-"+S.pop());break;case 23:S.push("+"+S.pop());break;case 22:S.push("NOT("+S.pop()+")");break;case 20:case 21:fe=S.pop(),be=S.pop(),S.push(["AND","OR"][oe-20]+"("+be+","+fe+")");break;default:if(oe<32&&O[oe])fe=S.pop(),be=S.pop(),S.push(be+O[oe]+fe);else if(F[oe]){if(T=F[oe][1],T==69&&(T=b[b.l++]),T>S.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+S.join("|")+"|");return}var Re=S.slice(-T);S.length-=T,S.push(F[oe][0]+"("+Re.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}S.length==1?z[1].f=""+S[0]:console.error("WK1 bad formula parse |"+S.join("|")+"|")}function Z(b){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=b.read_shift(2),z[3]=b[b.l++],z[0].c=b[b.l++],z}function he(b,z){var S=Z(b,z);return S[1].t="s",S[1].v=b.read_shift(z-4,"cstr"),S}function D(b,z,S,T){var q=B(6+T.length);q.write_shift(2,b),q.write_shift(1,S),q.write_shift(1,z),q.write_shift(1,39);for(var pe=0;pe<T.length;++pe){var be=T.charCodeAt(pe);q.write_shift(1,be>=128?95:be)}return q.write_shift(1,0),q}function Y(b,z){var S=Z(b,z);S[1].v=b.read_shift(2);var T=S[1].v>>1;if(S[1].v&1)switch(T&7){case 0:T=(T>>3)*5e3;break;case 1:T=(T>>3)*500;break;case 2:T=(T>>3)/20;break;case 3:T=(T>>3)/200;break;case 4:T=(T>>3)/2e3;break;case 5:T=(T>>3)/2e4;break;case 6:T=(T>>3)/16;break;case 7:T=(T>>3)/64;break}return S[1].v=T,S}function H(b,z){var S=Z(b,z),T=b.read_shift(4),q=b.read_shift(4),pe=b.read_shift(2);if(pe==65535)return T===0&&q===3221225472?(S[1].t="e",S[1].v=15):T===0&&q===3489660928?(S[1].t="e",S[1].v=42):S[1].v=0,S;var be=pe&32768;return pe=(pe&32767)-16446,S[1].v=(1-be*2)*(q*Math.pow(2,pe+32)+T*Math.pow(2,pe)),S}function X(b,z,S,T){var q=B(14);if(q.write_shift(2,b),q.write_shift(1,S),q.write_shift(1,z),T==0)return q.write_shift(4,0),q.write_shift(4,0),q.write_shift(2,65535),q;var pe=0,be=0,fe=0,oe=0;return T<0&&(pe=1,T=-T),be=Math.log2(T)|0,T/=Math.pow(2,be-31),oe=T>>>0,(oe&2147483648)==0&&(T/=2,++be,oe=T>>>0),T-=oe,oe|=2147483648,oe>>>=0,T*=Math.pow(2,32),fe=T>>>0,q.write_shift(4,fe),q.write_shift(4,oe),be+=16383+(pe?32768:0),q.write_shift(2,be),q}function Q(b,z){var S=H(b,14);return b.l+=z-14,S}function J(b,z){var S=Z(b,z),T=b.read_shift(4);return S[1].v=T>>6,S}function ge(b,z){var S=Z(b,z),T=b.read_shift(8,"f");return S[1].v=T,S}function He(b,z){var S=ge(b,14);return b.l+=z-10,S}function _e(b,z){return b[b.l+z-1]==0?b.read_shift(z,"cstr"):""}function pt(b,z){var S=b[b.l++];S>z-1&&(S=z-1);for(var T="";T.length<S;)T+=String.fromCharCode(b[b.l++]);return T}function mt(b,z,S){if(!(!S.qpro||z<21)){var T=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var q=b.read_shift(z-21,"cstr");return[T,q]}}function jt(b,z){for(var S={},T=b.l+z;b.l<T;){var q=b.read_shift(2);if(q==14e3){for(S[q]=[0,""],S[q][0]=b.read_shift(2);b[b.l];)S[q][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return S}function $t(b,z){var S=B(5+b.length);S.write_shift(2,14e3),S.write_shift(2,z);for(var T=0;T<b.length;++T){var q=b.charCodeAt(T);S[S.l++]=q>127?95:q}return S[S.l++]=0,S}var St={0:{n:"BOF",f:oh},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_e},222:{n:"SHEETNAMELP",f:pt},65535:{n:""}},Yt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:he},23:{n:"NUMBER17",f:H},24:{n:"NUMBER18",f:Y},25:{n:"FORMULA19",f:Q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:jt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:J},38:{n:"??"},39:{n:"NUMBER27",f:ge},40:{n:"FORMULA28",f:He},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:mt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:n,to_workbook:t}}();var ug=/^\s|\s$|[\t\n\r]/;function dh(r,t){if(!t.bookSST)return"";var e=[ct];e[e.length]=ie("sst",null,{xmlns:Cn[0],count:r.Count,uniqueCount:r.Unique});for(var i=0;i!=r.length;++i)if(r[i]!=null){var n=r[i],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(ug)&&(s+=' xml:space="preserve"'),s+=">"+ze(n.t)+"</t>"),s+="</si>",e[e.length]=s}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function dg(r){return[r.read_shift(4),r.read_shift(4)]}function pg(r,t){return t||(t=B(8)),t.write_shift(4,r.Count),t.write_shift(4,r.Unique),t}var mg=sm;function gg(r){var t=er();K(t,159,pg(r));for(var e=0;e<r.length;++e)K(t,19,mg(r[e]));return K(t,160),t.end()}function xg(r){if(typeof qe<"u")return qe.utils.encode(yn,r);for(var t=[],e=r.split(""),i=0;i<e.length;++i)t[i]=e[i].charCodeAt(0);return t}function ph(r){var t=0,e,i=xg(r),n=i.length+1,s,a,o,c,l;for(e=Wi(n),e[0]=i.length,s=1;s!=n;++s)e[s]=i[s-1];for(s=n-1;s>=0;--s)a=e[s],o=(t&16384)===0?0:1,c=t<<1&32767,l=o|c,t=l^a;return t^52811}var vg=function(){function r(n,s){switch(s.type){case"base64":return t(ii(n),s);case"binary":return t(n,s);case"buffer":return t(We&&Buffer.isBuffer(n)?n.toString("binary"):cs(n),s);case"array":return t(ma(n),s)}throw new Error("Unrecognized type "+s.type)}function t(n,s){var a=s||{},o=a.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,f){Array.isArray(o)&&(o[f]=[]);for(var u=/\\\w+\b/g,d=0,g,p=-1;g=u.exec(h);){switch(g[0]){case"\\cell":var x=h.slice(d,u.lastIndex-g[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var E={v:x,t:"s"};Array.isArray(o)?o[f][p]=E:o[Ge({r:f,c:p})]=E}break}d=u.lastIndex}p>l.e.c&&(l.e.c=p)}),o["!ref"]=lt(l),o}function e(n,s){return Vi(r(n,s),s)}function i(n){for(var s=["{\\rtf1\\ansi"],a=Je(n["!ref"]),o,c=Array.isArray(n),l=a.s.r;l<=a.e.r;++l){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var f=Ge({r:l,c:h});o=c?(n[l]||[])[h]:n[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ni(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:e,to_sheet:r,from_sheet:i}}();function f0(r){for(var t=0,e=1;t!=3;++t)e=e*256+(r[t]>255?255:r[t]<0?0:r[t]);return e.toString(16).toUpperCase().slice(1)}var _g=6;var ri=_g;function aa(r){return Math.floor((r+Math.round(128/ri)/256)*ri)}function oa(r){return Math.floor((r-5)/ri*100+.5)/100}function wo(r){return Math.round((r*ri+5)/ri*256)/256}function Ho(r){r.width?(r.wpx=aa(r.width),r.wch=oa(r.wpx),r.MDW=ri):r.wpx?(r.wch=oa(r.wpx),r.width=wo(r.wch),r.MDW=ri):typeof r.wch=="number"&&(r.width=wo(r.wch),r.wpx=aa(r.width),r.MDW=ri),r.customWidth&&delete r.customWidth}var yg=96,mh=yg;function la(r){return r*96/mh}function gh(r){return r*mh/96}function wg(r){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var i=e[0];i<=e[1];++i)r[i]!=null&&(t[t.length]=ie("numFmt",null,{numFmtId:i,formatCode:ze(r[i])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ie("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Cg(r){var t=[];return t[t.length]=ie("cellXfs",null),r.forEach(function(e){t[t.length]=ie("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ie("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function xh(r,t){var e=[ct,ie("styleSheet",null,{xmlns:Cn[0],"xmlns:vt":Ct.vt})],i;return r.SSF&&(i=wg(r.SSF))!=null&&(e[e.length]=i),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=Cg(t.cellXfs))&&(e[e.length]=i),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function bg(r,t){var e=r.read_shift(2),i=Ht(r,t-2);return[e,i]}function Tg(r,t,e){e||(e=B(6+4*t.length)),e.write_shift(2,r),Tt(t,e);var i=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),i}function Sg(r,t,e){var i={};i.sz=r.read_shift(2)/20;var n=um(r,2,e);n.fItalic&&(i.italic=1),n.fCondense&&(i.condense=1),n.fExtend&&(i.extend=1),n.fShadow&&(i.shadow=1),n.fOutline&&(i.outline=1),n.fStrikeout&&(i.strike=1);var s=r.read_shift(2);switch(s===700&&(i.bold=1),r.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var a=r.read_shift(1);a!=0&&(i.underline=a);var o=r.read_shift(1);o>0&&(i.family=o);var c=r.read_shift(1);switch(c>0&&(i.charset=c),r.l++,i.color=fm(r,8),r.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=Ht(r,t-21),i}function Eg(r,t){t||(t=B(25+4*32)),t.write_shift(2,r.sz*20),dm(r,t),t.write_shift(2,r.bold?700:400);var e=0;r.vertAlign=="superscript"?e=1:r.vertAlign=="subscript"&&(e=2),t.write_shift(2,e),t.write_shift(1,r.underline||0),t.write_shift(1,r.family||0),t.write_shift(1,r.charset||0),t.write_shift(1,0),na(r.color,t);var i=0;return r.scheme=="major"&&(i=1),r.scheme=="minor"&&(i=2),t.write_shift(1,i),Tt(r.name,t),t.length>t.l?t.slice(0,t.l):t}var kg=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],po,Ig=Gr;function u0(r,t){t||(t=B(4*3+8*7+16*1)),po||(po=To(kg));var e=po[r.patternType];e==null&&(e=40),t.write_shift(4,e);var i=0;if(e!=40)for(na({auto:1},t),na({auto:1},t);i<12;++i)t.write_shift(4,0);else{for(;i<4;++i)t.write_shift(4,0);for(;i<12;++i)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Fg(r,t){var e=r.l+t,i=r.read_shift(2),n=r.read_shift(2);return r.l=e,{ixfe:i,numFmtId:n}}function vh(r,t,e){e||(e=B(16)),e.write_shift(2,t||0),e.write_shift(2,r.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var i=0;return e.write_shift(1,i),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function Kn(r,t){return t||(t=B(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Og=Gr;function Ag(r,t){return t||(t=B(51)),t.write_shift(1,0),Kn(null,t),Kn(null,t),Kn(null,t),Kn(null,t),Kn(null,t),t.length>t.l?t.slice(0,t.l):t}function Dg(r,t){return t||(t=B(12+4*10)),t.write_shift(4,r.xfId),t.write_shift(2,1),t.write_shift(1,+r.builtinId),t.write_shift(1,0),ia(r.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Mg(r,t,e){var i=B(2052);return i.write_shift(4,r),ia(t,i),ia(e,i),i.length>i.l?i.slice(0,i.l):i}function Pg(r,t){if(t){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)t[n]!=null&&++e}),e!=0&&(K(r,615,Pr(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)t[n]!=null&&K(r,44,Tg(n,t[n]))}),K(r,616))}}function Lg(r){var t=1;t!=0&&(K(r,611,Pr(t)),K(r,43,Eg({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),K(r,612))}function Rg(r){var t=2;t!=0&&(K(r,603,Pr(t)),K(r,45,u0({patternType:"none"})),K(r,45,u0({patternType:"gray125"})),K(r,604))}function Ng(r){var t=1;t!=0&&(K(r,613,Pr(t)),K(r,46,Ag({})),K(r,614))}function Bg(r){var t=1;K(r,626,Pr(t)),K(r,47,vh({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),K(r,627)}function Wg(r,t){K(r,617,Pr(t.length)),t.forEach(function(e){K(r,47,vh(e,0))}),K(r,618)}function Hg(r){var t=1;K(r,619,Pr(t)),K(r,48,Dg({xfId:0,builtinId:0,name:"Normal"})),K(r,620)}function $g(r){var t=0;K(r,505,Pr(t)),K(r,506)}function Vg(r){var t=0;K(r,508,Mg(t,"TableStyleMedium9","PivotStyleMedium4")),K(r,509)}function Ug(r,t){var e=er();return K(e,278),Pg(e,r.SSF),Lg(e,r),Rg(e,r),Ng(e,r),Bg(e,r),Wg(e,t.cellXfs),Hg(e,r),$g(e,r),Vg(e,r),K(e,279),e.end()}function _h(r,t){if(t&&t.themeXLSX)return t.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var e=[ct];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function zg(r,t){return{flags:r.read_shift(4),version:r.read_shift(4),name:Ht(r,t-8)}}function Gg(r){var t=B(12+2*r.name.length);return t.write_shift(4,r.flags),t.write_shift(4,r.version),Tt(r.name,t),t.slice(0,t.l)}function Xg(r){for(var t=[],e=r.read_shift(4);e-- >0;)t.push([r.read_shift(4),r.read_shift(4)]);return t}function jg(r){var t=B(4+8*r.length);t.write_shift(4,r.length);for(var e=0;e<r.length;++e)t.write_shift(4,r[e][0]),t.write_shift(4,r[e][1]);return t}function Yg(r,t){var e=B(8+2*t.length);return e.write_shift(4,r),Tt(t,e),e.slice(0,e.l)}function Kg(r){return r.l+=4,r.read_shift(4)!=0}function qg(r,t){var e=B(8);return e.write_shift(4,r),e.write_shift(4,t?1:0),e}function Qg(){var r=er();return K(r,332),K(r,334,Pr(1)),K(r,335,Gg({name:"XLDAPR",version:12e4,flags:3496657072})),K(r,336),K(r,339,Yg(1,"XLDAPR")),K(r,52),K(r,35,Pr(514)),K(r,4096,Pr(0)),K(r,4097,Sr(1)),K(r,36),K(r,53),K(r,340),K(r,337,qg(1,!0)),K(r,51,jg([[1,0]])),K(r,338),K(r,333),r.end()}function yh(){var r=[ct];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function Zg(r){var t={};t.i=r.read_shift(4);var e={};e.r=r.read_shift(4),e.c=r.read_shift(4),t.r=Ge(e);var i=r.read_shift(1);return i&2&&(t.l="1"),i&8&&(t.a="1"),t}var pn=1024;function wh(r,t){for(var e=[21600,21600],i=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),n=[ie("xml",null,{"xmlns:v":gr.v,"xmlns:o":gr.o,"xmlns:x":gr.x,"xmlns:mv":gr.mv}).replace(/\/>/,">"),ie("o:shapelayout",ie("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),ie("v:shapetype",[ie("v:stroke",null,{joinstyle:"miter"}),ie("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:i})];pn<r*1e3;)pn+=1e3;return t.forEach(function(s){var a=bt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ie("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=ie("v:fill",c,o),h={on:"t",obscured:"t"};++pn,n=n.concat(["<v:shape"+as({id:"_x0000_s"+pn,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,ie("v:shadow",null,h),ie("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Pt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Pt("x:AutoFill","False"),Pt("x:Row",String(a.r)),Pt("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function Ch(r){var t=[ct,ie("comments",null,{xmlns:Cn[0]})],e=[];return t.push("<authors>"),r.forEach(function(i){i[1].forEach(function(n){var s=ze(n.a);e.indexOf(s)==-1&&(e.push(s),t.push("<author>"+s+"</author>")),n.T&&n.ID&&e.indexOf("tc="+n.ID)==-1&&(e.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),r.forEach(function(i){var n=0,s=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?n=e.indexOf("tc="+i[1][0].ID):i[1].forEach(function(c){c.a&&(n=e.indexOf(ze(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+i[0]+'" authorId="'+n+'"><text>'),s.length<=1)t.push(Pt("t",ze(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(Pt("t",ze(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Jg(r,t,e){var i=[ct,ie("ThreadedComments",null,{xmlns:Ct.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(n){var s="";(n[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),i.push(ie("threadedComment",Pt("text",a.t||""),c))})}),i.push("</ThreadedComments>"),i.join("")}function e1(r){var t=[ct,ie("personList",null,{xmlns:Ct.TCMNT,"xmlns:x":Cn[0]}).replace(/[\/]>/,">")];return r.forEach(function(e,i){t.push(ie("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function t1(r){var t={};t.iauthor=r.read_shift(4);var e=Xi(r,16);return t.rfx=e.s,t.ref=Ge(e.s),r.l+=16,t}function r1(r,t){return t==null&&(t=B(36)),t.write_shift(4,r[1].iauthor),Sn(r[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var i1=Ht;function n1(r){return Tt(r.slice(0,54))}function s1(r){var t=er(),e=[];return K(t,628),K(t,630),r.forEach(function(i){i[1].forEach(function(n){e.indexOf(n.a)>-1||(e.push(n.a.slice(0,54)),K(t,632,n1(n.a)))})}),K(t,631),K(t,633),r.forEach(function(i){i[1].forEach(function(n){n.iauthor=e.indexOf(n.a);var s={s:bt(i[0]),e:bt(i[0])};K(t,635,r1([s,n])),n.t&&n.t.length>0&&K(t,637,om(n)),K(t,636),delete n.iauthor})}),K(t,634),K(t,629),t.end()}function a1(r,t){t.FullPaths.forEach(function(e,i){if(i!=0){var n=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Ye.utils.cfb_add(r,n,t.FileIndex[i].content)}})}var bh=["xlsb","xlsm","xlam","biff8","xla"];var o1=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(i,n,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=t.c:--h,c?l+=t.r:--l,n+(o?"":"$")+Wt(h)+(c?"":"$")+Lt(l)}return function(n,s){return t=s,n.replace(r,e)}}(),$o=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Vo=function(){return function(t,e){return t.replace($o,function(i,n,s,a,o,c){var l=Lo(a)-(s?0:e.c),h=Po(c)-(o?0:e.r),f=h==0?"":o?h+1:"["+h+"]",u=l==0?"":s?l+1:"["+l+"]";return n+"R"+f+"C"+u})}}();function l1(r,t){return r.replace($o,function(e,i,n,s,a,o){return i+(n=="$"?n+s:Wt(Lo(s)+t.c))+(a=="$"?a+o:Lt(Po(o)+t.r))})}function c1(r){return r.length!=1}function ot(r){r.l+=1}function _i(r,t){var e=r.read_shift(t==1?1:2);return[e&16383,e>>14&1,e>>15&1]}function Th(r,t,e){var i=2;if(e){if(e.biff>=2&&e.biff<=5)return Sh(r,t,e);e.biff==12&&(i=4)}var n=r.read_shift(i),s=r.read_shift(i),a=_i(r,2),o=_i(r,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Sh(r){var t=_i(r,2),e=_i(r,2),i=r.read_shift(1),n=r.read_shift(1);return{s:{r:t[0],c:i,cRel:t[1],rRel:t[2]},e:{r:e[0],c:n,cRel:e[1],rRel:e[2]}}}function h1(r,t,e){if(e.biff<8)return Sh(r,t,e);var i=r.read_shift(e.biff==12?4:2),n=r.read_shift(e.biff==12?4:2),s=_i(r,2),a=_i(r,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:a[0],cRel:a[1],rRel:a[2]}}}function Eh(r,t,e){if(e&&e.biff>=2&&e.biff<=5)return f1(r,t,e);var i=r.read_shift(e&&e.biff==12?4:2),n=_i(r,2);return{r:i,c:n[0],cRel:n[1],rRel:n[2]}}function f1(r){var t=_i(r,2),e=r.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function u1(r){var t=r.read_shift(2),e=r.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function d1(r,t,e){var i=e&&e.biff?e.biff:8;if(i>=2&&i<=5)return p1(r,t,e);var n=r.read_shift(i>=12?4:2),s=r.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;n>524287;)n-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:a,rRel:o}}function p1(r){var t=r.read_shift(2),e=r.read_shift(1),i=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,i==1&&t>=8192&&(t=t-16384),n==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:n,rRel:i}}function m1(r,t,e){var i=(r[r.l++]&96)>>5,n=Th(r,e.biff>=2&&e.biff<=5?6:8,e);return[i,n]}function g1(r,t,e){var i=(r[r.l++]&96)>>5,n=r.read_shift(2,"i"),s=8;if(e)switch(e.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var a=Th(r,s,e);return[i,n,a]}function x1(r,t,e){var i=(r[r.l++]&96)>>5;return r.l+=e&&e.biff>8?12:e.biff<8?6:8,[i]}function v1(r,t,e){var i=(r[r.l++]&96)>>5,n=r.read_shift(2),s=8;if(e)switch(e.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[i,n]}function _1(r,t,e){var i=(r[r.l++]&96)>>5,n=h1(r,t-1,e);return[i,n]}function y1(r,t,e){var i=(r[r.l++]&96)>>5;return r.l+=e.biff==2?6:e.biff==12?14:7,[i]}function d0(r){var t=r[r.l+1]&1,e=1;return r.l+=4,[t,e]}function w1(r,t,e){r.l+=2;for(var i=r.read_shift(e&&e.biff==2?1:2),n=[],s=0;s<=i;++s)n.push(r.read_shift(e&&e.biff==2?1:2));return n}function C1(r,t,e){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(e&&e.biff==2?1:2)]}function b1(r,t,e){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(e&&e.biff==2?1:2)]}function T1(r){var t=r[r.l+1]&255?1:0;return r.l+=2,[t,r.read_shift(2)]}function S1(r,t,e){var i=r[r.l+1]&255?1:0;return r.l+=e&&e.biff==2?3:4,[i]}function kh(r){var t=r.read_shift(1),e=r.read_shift(1);return[t,e]}function E1(r){return r.read_shift(2),kh(r,2)}function k1(r){return r.read_shift(2),kh(r,2)}function I1(r,t,e){var i=(r[r.l]&96)>>5;r.l+=1;var n=Eh(r,0,e);return[i,n]}function F1(r,t,e){var i=(r[r.l]&96)>>5;r.l+=1;var n=d1(r,0,e);return[i,n]}function O1(r,t,e){var i=(r[r.l]&96)>>5;r.l+=1;var n=r.read_shift(2);e&&e.biff==5&&(r.l+=12);var s=Eh(r,0,e);return[i,n,s]}function A1(r,t,e){var i=(r[r.l]&96)>>5;r.l+=1;var n=r.read_shift(e&&e.biff<=3?1:2);return[Ax[n],Oh[n],i]}function D1(r,t,e){var i=r[r.l++],n=r.read_shift(1),s=e&&e.biff<=3?[i==88?-1:0,r.read_shift(1)]:M1(r);return[n,(s[0]===0?Oh:Ox)[s[1]]]}function M1(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function P1(r,t,e){r.l+=e&&e.biff==2?3:4}function L1(r,t,e){if(r.l++,e&&e.biff==12)return[r.read_shift(4,"i"),0];var i=r.read_shift(2),n=r.read_shift(e&&e.biff==2?1:2);return[i,n]}function R1(r){return r.l++,fs[r.read_shift(1)]}function N1(r){return r.l++,r.read_shift(2)}function B1(r){return r.l++,r.read_shift(1)!==0}function W1(r){return r.l++,En(r,8)}function H1(r,t,e){return r.l++,ch(r,t-1,e)}function $1(r,t){var e=[r.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=Om(r,1)?"TRUE":"FALSE",t!=12&&(r.l+=7);break;case 37:case 16:e[1]=fs[r[r.l]],r.l+=t==12?4:8;break;case 0:r.l+=8;break;case 1:e[1]=En(r,8);break;case 2:e[1]=Pm(r,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function V1(r,t,e){for(var i=r.read_shift(e.biff==12?4:2),n=[],s=0;s!=i;++s)n.push((e.biff==12?Xi:Nm)(r,8));return n}function U1(r,t,e){var i=0,n=0;e.biff==12?(i=r.read_shift(4),n=r.read_shift(4)):(n=1+r.read_shift(1),i=1+r.read_shift(2)),e.biff>=2&&e.biff<8&&(--i,--n==0&&(n=256));for(var s=0,a=[];s!=i&&(a[s]=[]);++s)for(var o=0;o!=n;++o)a[s][o]=$1(r,e.biff);return a}function z1(r,t,e){var i=r.read_shift(1)>>>5&3,n=!e||e.biff>=8?4:2,s=r.read_shift(n);switch(e.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[i,0,s]}function G1(r,t,e){if(e.biff==5)return X1(r,t,e);var i=r.read_shift(1)>>>5&3,n=r.read_shift(2),s=r.read_shift(4);return[i,n,s]}function X1(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2,"i");r.l+=8;var i=r.read_shift(2);return r.l+=12,[t,e,i]}function j1(r,t,e){var i=r.read_shift(1)>>>5&3;r.l+=e&&e.biff==2?3:4;var n=r.read_shift(e&&e.biff==2?1:2);return[i,n]}function Y1(r,t,e){var i=r.read_shift(1)>>>5&3,n=r.read_shift(e&&e.biff==2?1:2);return[i,n]}function K1(r,t,e){var i=r.read_shift(1)>>>5&3;return r.l+=4,e.biff<8&&r.l--,e.biff==12&&(r.l+=2),[i]}function q1(r,t,e){var i=(r[r.l++]&96)>>5,n=r.read_shift(2),s=4;if(e)switch(e.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[i,n]}var Q1=Gr,Z1=Gr,J1=Gr;function us(r,t,e){return r.l+=2,[u1(r,4,e)]}function Uo(r){return r.l+=6,[]}var ex=us,tx=Uo,rx=Uo,ix=us;function Ih(r){return r.l+=2,[oh(r),r.read_shift(2)&1]}var nx=us,sx=Ih,ax=Uo,ox=us,lx=us,cx=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function hx(r){r.l+=2;var t=r.read_shift(2),e=r.read_shift(2),i=r.read_shift(4),n=r.read_shift(2),s=r.read_shift(2),a=cx[e>>2&31];return{ixti:t,coltype:e&3,rt:a,idx:i,c:n,C:s}}function fx(r){return r.l+=2,[r.read_shift(4)]}function ux(r,t,e){return r.l+=5,r.l+=2,r.l+=e.biff==2?1:4,["PTGSHEET"]}function dx(r,t,e){return r.l+=e.biff==2?4:5,["PTGENDSHEET"]}function px(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2);return[t,e]}function mx(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2);return[t,e]}function gx(r){return r.l+=4,[0,0]}var p0={1:{n:"PtgExp",f:L1},2:{n:"PtgTbl",f:J1},3:{n:"PtgAdd",f:ot},4:{n:"PtgSub",f:ot},5:{n:"PtgMul",f:ot},6:{n:"PtgDiv",f:ot},7:{n:"PtgPower",f:ot},8:{n:"PtgConcat",f:ot},9:{n:"PtgLt",f:ot},10:{n:"PtgLe",f:ot},11:{n:"PtgEq",f:ot},12:{n:"PtgGe",f:ot},13:{n:"PtgGt",f:ot},14:{n:"PtgNe",f:ot},15:{n:"PtgIsect",f:ot},16:{n:"PtgUnion",f:ot},17:{n:"PtgRange",f:ot},18:{n:"PtgUplus",f:ot},19:{n:"PtgUminus",f:ot},20:{n:"PtgPercent",f:ot},21:{n:"PtgParen",f:ot},22:{n:"PtgMissArg",f:ot},23:{n:"PtgStr",f:H1},26:{n:"PtgSheet",f:ux},27:{n:"PtgEndSheet",f:dx},28:{n:"PtgErr",f:R1},29:{n:"PtgBool",f:B1},30:{n:"PtgInt",f:N1},31:{n:"PtgNum",f:W1},32:{n:"PtgArray",f:y1},33:{n:"PtgFunc",f:A1},34:{n:"PtgFuncVar",f:D1},35:{n:"PtgName",f:z1},36:{n:"PtgRef",f:I1},37:{n:"PtgArea",f:m1},38:{n:"PtgMemArea",f:j1},39:{n:"PtgMemErr",f:Q1},40:{n:"PtgMemNoMem",f:Z1},41:{n:"PtgMemFunc",f:Y1},42:{n:"PtgRefErr",f:K1},43:{n:"PtgAreaErr",f:x1},44:{n:"PtgRefN",f:F1},45:{n:"PtgAreaN",f:_1},46:{n:"PtgMemAreaN",f:px},47:{n:"PtgMemNoMemN",f:mx},57:{n:"PtgNameX",f:G1},58:{n:"PtgRef3d",f:O1},59:{n:"PtgArea3d",f:g1},60:{n:"PtgRefErr3d",f:q1},61:{n:"PtgAreaErr3d",f:v1},255:{}},xx={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},vx={1:{n:"PtgElfLel",f:Ih},2:{n:"PtgElfRw",f:ox},3:{n:"PtgElfCol",f:ex},6:{n:"PtgElfRwV",f:lx},7:{n:"PtgElfColV",f:ix},10:{n:"PtgElfRadical",f:nx},11:{n:"PtgElfRadicalS",f:ax},13:{n:"PtgElfColS",f:tx},15:{n:"PtgElfColSV",f:rx},16:{n:"PtgElfRadicalLel",f:sx},25:{n:"PtgList",f:hx},29:{n:"PtgSxName",f:fx},255:{}},_x={0:{n:"PtgAttrNoop",f:gx},1:{n:"PtgAttrSemi",f:S1},2:{n:"PtgAttrIf",f:b1},4:{n:"PtgAttrChoose",f:w1},8:{n:"PtgAttrGoto",f:C1},16:{n:"PtgAttrSum",f:P1},32:{n:"PtgAttrBaxcel",f:d0},33:{n:"PtgAttrBaxcel",f:d0},64:{n:"PtgAttrSpace",f:E1},65:{n:"PtgAttrSpaceSemi",f:k1},128:{n:"PtgAttrIfError",f:T1},255:{}};function yx(r,t,e,i){if(i.biff<8)return Gr(r,t);for(var n=r.l+t,s=[],a=0;a!==e.length;++a)switch(e[a][0]){case"PtgArray":e[a][1]=U1(r,0,i),s.push(e[a][1]);break;case"PtgMemArea":e[a][2]=V1(r,e[a][1],i),s.push(e[a][2]);break;case"PtgExp":i&&i.biff==12&&(e[a][1][1]=r.read_shift(4),s.push(e[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[a][0];default:break}return t=n-r.l,t!==0&&s.push(Gr(r,t)),s}function wx(r,t,e){for(var i=r.l+t,n,s,a=[];i!=r.l;)t=i-r.l,s=r[r.l],n=p0[s]||p0[xx[s]],(s===24||s===25)&&(n=(s===24?vx:_x)[r[r.l+1]]),!n||!n.f?Gr(r,t):a.push([n.n,n.f(r,t,e)]);return a}function Cx(r){for(var t=[],e=0;e<r.length;++e){for(var i=r[e],n=[],s=0;s<i.length;++s){var a=i[s];if(a)switch(a[0]){case 2:n.push('"'+a[1].replace(/"/g,'""')+'"');break;default:n.push(a[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var bx={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Tx(r,t){if(!r&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function Fh(r,t,e){if(!r)return"SH33TJSERR0";if(e.biff>8&&(!r.XTI||!r.XTI[t]))return r.SheetNames[t];if(!r.XTI)return"SH33TJSERR6";var i=r.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":r.XTI[t-1];if(!i)return"SH33TJSERR1";var n="";if(e.biff>8)switch(r[i[0]][0]){case 357:return n=i[1]==-1?"#REF":r.SheetNames[i[1]],i[1]==i[2]?n:n+":"+r.SheetNames[i[2]];case 358:return e.SID!=null?r.SheetNames[e.SID]:"SH33TJSSAME"+r[i[0]][0];case 355:default:return"SH33TJSSRC"+r[i[0]][0]}switch(r[i[0]][0][0]){case 1025:return n=i[1]==-1?"#REF":r.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?n:n+":"+r.SheetNames[i[2]];case 14849:return r[i[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[i[0]][0][3]?(n=i[1]==-1?"#REF":r[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?n:n+":"+r[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function m0(r,t,e){var i=Fh(r,t,e);return i=="#REF"?i:Tx(i,e)}function wn(r,t,e,i,n){var s=n&&n.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,h,f=0,u=0,d,g="";if(!r[0]||!r[0][0])return"";for(var p=-1,x="",E=0,F=r[0].length;E<F;++E){var O=r[0][E];switch(O[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),p>=0){switch(r[0][p][1][0]){case 0:x=rt(" ",r[0][p][1][1]);break;case 1:x=rt("\r",r[0][p][1][1]);break;default:if(x="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][p][1][0])}l=l+x,p=-1}o.push(l+bx[O[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Jn(O[1][1],a,n),o.push(es(h,s));break;case"PtgRefN":h=e?Jn(O[1][1],e,n):O[1][1],o.push(es(h,s));break;case"PtgRef3d":f=O[1][1],h=Jn(O[1][2],a,n),g=m0(i,f,n);var V=g;o.push(g+"!"+es(h,s));break;case"PtgFunc":case"PtgFuncVar":var Z=O[1][0],he=O[1][1];Z||(Z=0),Z&=127;var D=Z==0?[]:o.slice(-Z);o.length-=Z,he==="User"&&(he=D.shift()),o.push(he+"("+D.join(",")+")");break;case"PtgBool":o.push(O[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(O[1]);break;case"PtgNum":o.push(String(O[1]));break;case"PtgStr":o.push('"'+O[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(O[1]);break;case"PtgAreaN":d=Jc(O[1][1],e?{s:e}:a,n),o.push(fo(d,n));break;case"PtgArea":d=Jc(O[1][1],a,n),o.push(fo(d,n));break;case"PtgArea3d":f=O[1][1],d=O[1][2],g=m0(i,f,n),o.push(g+"!"+fo(d,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=O[1][2];var Y=(i.names||[])[u-1]||(i[0]||[])[u],H=Y?Y.Name:"SH33TJSNAME"+String(u);H&&H.slice(0,6)=="_xlfn."&&!n.xlfn&&(H=H.slice(6)),o.push(H);break;case"PtgNameX":var X=O[1][1];u=O[1][2];var Q;if(n.biff<=5)X<0&&(X=-X),i[X]&&(Q=i[X][u]);else{var J="";if(((i[X]||[])[0]||[])[0]==14849||(((i[X]||[])[0]||[])[0]==1025?i[X][u]&&i[X][u].itab>0&&(J=i.SheetNames[i[X][u].itab-1]+"!"):J=i.SheetNames[u-1]+"!"),i[X]&&i[X][u])J+=i[X][u].Name;else if(i[0]&&i[0][u])J+=i[0][u].Name;else{var ge=(Fh(i,X,n)||"").split(";;");ge[u-1]?J=ge[u-1]:J+="SH33TJSERRX"}o.push(J);break}Q||(Q={Name:"SH33TJSERRY"}),o.push(Q.Name);break;case"PtgParen":var He="(",_e=")";if(p>=0){switch(x="",r[0][p][1][0]){case 2:He=rt(" ",r[0][p][1][1])+He;break;case 3:He=rt("\r",r[0][p][1][1])+He;break;case 4:_e=rt(" ",r[0][p][1][1])+_e;break;case 5:_e=rt("\r",r[0][p][1][1])+_e;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][p][1][0])}p=-1}o.push(He+o.pop()+_e);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:O[1][1],r:O[1][0]};var pt={c:e.c,r:e.r};if(i.sharedf[Ge(h)]){var mt=i.sharedf[Ge(h)];o.push(wn(mt,a,pt,i,n))}else{var jt=!1;for(c=0;c!=i.arrayf.length;++c)if(l=i.arrayf[c],!(h.c<l[0].s.c||h.c>l[0].e.c)&&!(h.r<l[0].s.r||h.r>l[0].e.r)){o.push(wn(l[1],a,pt,i,n)),jt=!0;break}jt||o.push(O[1])}break;case"PtgArray":o.push("{"+Cx(O[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+O[1].idx+"[#"+O[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(O));default:throw new Error("Unrecognized Formula Token: "+String(O))}var $t=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&$t.indexOf(r[0][E][0])==-1){O=r[0][p];var St=!0;switch(O[1][0]){case 4:St=!1;case 0:x=rt(" ",O[1][1]);break;case 5:St=!1;case 1:x=rt("\r",O[1][1]);break;default:if(x="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+O[1][0])}o.push((St?x:"")+o.pop()+(St?"":x)),p=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function Sx(r){if(r==null){var t=B(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof r=="number")return Hi(r);return Hi(0)}function Ex(r,t,e,i,n){var s=$i(t,e,n),a=Sx(r.v),o=B(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=B(r.bf.length),h=0;h<r.bf.length;++h)l[h]=r.bf[h];var f=Mt([s,a,o,l]);return f}function xa(r,t,e){var i=r.read_shift(4),n=wx(r,i,e),s=r.read_shift(4),a=s>0?yx(r,s,n,e):null;return[n,a]}var kx=xa,va=xa,Ix=xa,Fx=xa,Ox={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Oh={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Ax={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Dx(r){var t="of:="+r.replace($o,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Mx(r){return r.replace(/\./,"!")}var ts=typeof Map<"u";function zo(r,t,e){var i=0,n=r.length;if(e){if(ts?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var s=ts?e.get(t):e[t];i<s.length;++i)if(r[s[i]].t===t)return r.Count++,s[i]}}else for(;i<n;++i)if(r[i].t===t)return r.Count++,i;return r[n]={t},r.Count++,r.Unique++,e&&(ts?(e.has(t)||e.set(t,[]),e.get(t).push(n)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(n))),n}function _a(r,t){var e={min:r+1,max:r+1},i=-1;return t.MDW&&(ri=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?i=oa(t.wpx):t.wch!=null&&(i=t.wch),i>-1?(e.width=wo(i),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function Ah(r,t){if(r){var e=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(e=[1,1,1,1,.5,.5]),r.left==null&&(r.left=e[0]),r.right==null&&(r.right=e[1]),r.top==null&&(r.top=e[2]),r.bottom==null&&(r.bottom=e[3]),r.header==null&&(r.header=e[4]),r.footer==null&&(r.footer=e[5])}}function wi(r,t,e){var i=e.revssf[t.z!=null?t.z:"General"],n=60,s=r.length;if(i==null&&e.ssf){for(;n<392;++n)if(e.ssf[n]==null){A0(t.z,n),e.ssf[n]=t.z,e.revssf[t.z]=i=n;break}}for(n=0;n!=s;++n)if(r[n].numFmtId===i)return n;return r[s]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Px(r,t,e){if(r&&r["!ref"]){var i=Je(r["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+e+"): "+r["!ref"])}}function Lx(r){if(r.length===0)return"";for(var t='<mergeCells count="'+r.length+'">',e=0;e!=r.length;++e)t+='<mergeCell ref="'+lt(r[e])+'"/>';return t+"</mergeCells>"}function Rx(r,t,e,i,n){var s=!1,a={},o=null;if(i.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[e];try{t.Workbook&&(c=t.Workbook.Sheets[e].CodeName||c)}catch{}s=!0,a.codeName=Jr(ze(c))}if(r&&r["!outline"]){var l={summaryBelow:1,summaryRight:1};r["!outline"].above&&(l.summaryBelow=0),r["!outline"].left&&(l.summaryRight=0),o=(o||"")+ie("outlinePr",null,l)}!s&&!o||(n[n.length]=ie("sheetPr",o,a))}var Nx=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Bx=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Wx(r){var t={sheet:1};return Nx.forEach(function(e){r[e]!=null&&r[e]&&(t[e]="1")}),Bx.forEach(function(e){r[e]!=null&&!r[e]&&(t[e]="0")}),r.password&&(t.password=ph(r.password).toString(16).toUpperCase()),ie("sheetProtection",null,t)}function Hx(r){return Ah(r),ie("pageMargins",null,r)}function $x(r,t){for(var e=["<cols>"],i,n=0;n!=t.length;++n)(i=t[n])&&(e[e.length]=ie("col",null,_a(n,i)));return e[e.length]="</cols>",e.join("")}function Vx(r,t,e,i){var n=typeof r.ref=="string"?r.ref:lt(r.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var s=e.Workbook.Names,a=xr(n);a.s.r==a.e.r&&(a.e.r=xr(t["!ref"]).e.r,n=lt(a));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==i){c.Ref="'"+e.SheetNames[i]+"'!"+n;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+n}),ie("autoFilter",null,{ref:n})}function Ux(r,t,e,i){var n={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),ie("sheetViews",ie("sheetView",null,n),{})}function zx(r,t,e,i){if(r.c&&e["!comments"].push([t,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var n="",s=r.t,a=r.v;if(r.t!=="z")switch(r.t){case"b":n=r.v?"1":"0";break;case"n":n=""+r.v;break;case"e":n=fs[r.v];break;case"d":i&&i.cellDates?n=Xt(r.v,-1).toISOString():(r=rr(r),r.t="n",n=""+(r.v=tr(Xt(r.v)))),typeof r.z>"u"&&(r.z=it[14]);break;default:n=r.v;break}var o=Pt("v",ze(n)),c={r:t},l=wi(i.cellXfs,r,i);switch(l!==0&&(c.s=l),r.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){o=Pt("v",""+zo(i.Strings,r.v,i.revStrings)),c.t="s";break}c.t="str";break}if(r.t!=s&&(r.t=s,r.v=a),typeof r.f=="string"&&r.f){var h=r.F&&r.F.slice(0,t.length)==t?{t:"array",ref:r.F}:null;o=ie("f",ze(r.f),h)+(r.v!=null?o:"")}return r.l&&e["!links"].push([t,r.l]),r.D&&(c.cm=1),ie("c",o,c)}function Gx(r,t,e,i){var n=[],s=[],a=Je(r["!ref"]),o="",c,l="",h=[],f=0,u=0,d=r["!rows"],g=Array.isArray(r),p={r:l},x,E=-1;for(u=a.s.c;u<=a.e.c;++u)h[u]=Wt(u);for(f=a.s.r;f<=a.e.r;++f){for(s=[],l=Lt(f),u=a.s.c;u<=a.e.c;++u){c=h[u]+l;var F=g?(r[f]||[])[u]:r[c];F!==void 0&&(o=zx(F,c,r,t,e,i))!=null&&s.push(o)}(s.length>0||d&&d[f])&&(p={r:l},d&&d[f]&&(x=d[f],x.hidden&&(p.hidden=1),E=-1,x.hpx?E=la(x.hpx):x.hpt&&(E=x.hpt),E>-1&&(p.ht=E,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),n[n.length]=ie("row",s.join(""),p))}if(d)for(;f<d.length;++f)d&&d[f]&&(p={r:f+1},x=d[f],x.hidden&&(p.hidden=1),E=-1,x.hpx?E=la(x.hpx):x.hpt&&(E=x.hpt),E>-1&&(p.ht=E,p.customHeight=1),x.level&&(p.outlineLevel=x.level),n[n.length]=ie("row","",p));return n.join("")}function Dh(r,t,e,i){var n=[ct,ie("worksheet",null,{xmlns:Cn[0],"xmlns:r":Ct.r})],s=e.SheetNames[r],a=0,o="",c=e.Sheets[s];c==null&&(c={});var l=c["!ref"]||"A1",h=Je(l);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),l=lt(h)}i||(i={}),c["!comments"]=[];var f=[];Rx(c,e,r,t,n),n[n.length]=ie("dimension",null,{ref:l}),n[n.length]=Ux(c,t,r,e),t.sheetFormat&&(n[n.length]=ie("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=$x(c,c["!cols"])),n[a=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=Gx(c,t,r,e,i),o.length>0&&(n[n.length]=o)),n.length>a+1&&(n[n.length]="</sheetData>",n[a]=n[a].replace("/>",">")),c["!protect"]&&(n[n.length]=Wx(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=Vx(c["!autofilter"],c,e,r)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=Lx(c["!merges"]));var u=-1,d,g=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(d={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=Ue(i,-1,ze(p[1].Target).replace(/#.*$/,""),Be.HLINK),d["r:id"]="rId"+g),(u=p[1].Target.indexOf("#"))>-1&&(d.location=ze(p[1].Target.slice(u+1))),p[1].Tooltip&&(d.tooltip=ze(p[1].Tooltip)),n[n.length]=ie("hyperlink",null,d))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=Hx(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=Pt("ignoredErrors",ie("ignoredError",null,{numberStoredAsText:1,sqref:l}))),f.length>0&&(g=Ue(i,-1,"../drawings/drawing"+(r+1)+".xml",Be.DRAW),n[n.length]=ie("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=f),c["!comments"].length>0&&(g=Ue(i,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Be.VML),n[n.length]=ie("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Xx(r,t){var e={},i=r.l+t;e.r=r.read_shift(4),r.l+=4;var n=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=i,s&7&&(e.level=s&7),s&16&&(e.hidden=!0),s&32&&(e.hpt=n/20),e}function jx(r,t,e){var i=B(145),n=(e["!rows"]||[])[r]||{};i.write_shift(4,r),i.write_shift(4,0);var s=320;n.hpx?s=la(n.hpx)*20:n.hpt&&(s=n.hpt*20),i.write_shift(2,s),i.write_shift(1,0);var a=0;n.level&&(a|=n.level),n.hidden&&(a|=16),(n.hpx||n.hpt)&&(a|=32),i.write_shift(1,a),i.write_shift(1,0);var o=0,c=i.l;i.l+=4;for(var l={r,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var f=-1,u=-1,d=h<<10;d<h+1<<10;++d){l.c=d;var g=Array.isArray(e)?(e[l.r]||[])[l.c]:e[Ge(l)];g&&(f<0&&(f=d),u=d)}f<0||(++o,i.write_shift(4,f),i.write_shift(4,u))}var p=i.l;return i.l=c,i.write_shift(4,o),i.l=p,i.length>i.l?i.slice(0,i.l):i}function Yx(r,t,e,i){var n=jx(i,e,t);(n.length>17||(t["!rows"]||[])[i])&&K(r,0,n)}var Kx=Xi,qx=Sn;function Qx(){}function Zx(r,t){var e={},i=r[r.l];return++r.l,e.above=!(i&64),e.left=!(i&128),r.l+=18,e.name=lm(r,t-19),e}function Jx(r,t,e){e==null&&(e=B(84+4*r.length));var i=192;t&&(t.above&&(i&=-65),t.left&&(i&=-129)),e.write_shift(1,i);for(var n=1;n<3;++n)e.write_shift(1,0);return na({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),j0(r,e),e.slice(0,e.l)}function ev(r){var t=Er(r);return[t]}function tv(r,t,e){return e==null&&(e=B(8)),Ui(t,e)}function rv(r){var t=zi(r);return[t]}function iv(r,t,e){return e==null&&(e=B(4)),Gi(t,e)}function nv(r){var t=Er(r),e=r.read_shift(1);return[t,e,"b"]}function sv(r,t,e){return e==null&&(e=B(9)),Ui(t,e),e.write_shift(1,r.v?1:0),e}function av(r){var t=zi(r),e=r.read_shift(1);return[t,e,"b"]}function ov(r,t,e){return e==null&&(e=B(5)),Gi(t,e),e.write_shift(1,r.v?1:0),e}function lv(r){var t=Er(r),e=r.read_shift(1);return[t,e,"e"]}function cv(r,t,e){return e==null&&(e=B(9)),Ui(t,e),e.write_shift(1,r.v),e}function hv(r){var t=zi(r),e=r.read_shift(1);return[t,e,"e"]}function fv(r,t,e){return e==null&&(e=B(8)),Gi(t,e),e.write_shift(1,r.v),e.write_shift(2,0),e.write_shift(1,0),e}function uv(r){var t=Er(r),e=r.read_shift(4);return[t,e,"s"]}function dv(r,t,e){return e==null&&(e=B(12)),Ui(t,e),e.write_shift(4,t.v),e}function pv(r){var t=zi(r),e=r.read_shift(4);return[t,e,"s"]}function mv(r,t,e){return e==null&&(e=B(8)),Gi(t,e),e.write_shift(4,t.v),e}function gv(r){var t=Er(r),e=En(r);return[t,e,"n"]}function xv(r,t,e){return e==null&&(e=B(16)),Ui(t,e),Hi(r.v,e),e}function vv(r){var t=zi(r),e=En(r);return[t,e,"n"]}function _v(r,t,e){return e==null&&(e=B(12)),Gi(t,e),Hi(r.v,e),e}function yv(r){var t=Er(r),e=Y0(r);return[t,e,"n"]}function wv(r,t,e){return e==null&&(e=B(12)),Ui(t,e),K0(r.v,e),e}function Cv(r){var t=zi(r),e=Y0(r);return[t,e,"n"]}function bv(r,t,e){return e==null&&(e=B(8)),Gi(t,e),K0(r.v,e),e}function Tv(r){var t=Er(r),e=Ro(r);return[t,e,"is"]}function Sv(r){var t=Er(r),e=Ht(r);return[t,e,"str"]}function Ev(r,t,e){return e==null&&(e=B(12+4*r.v.length)),Ui(t,e),Tt(r.v,e),e.length>e.l?e.slice(0,e.l):e}function kv(r){var t=zi(r),e=Ht(r);return[t,e,"str"]}function Iv(r,t,e){return e==null&&(e=B(8+4*r.v.length)),Gi(t,e),Tt(r.v,e),e.length>e.l?e.slice(0,e.l):e}function Fv(r,t,e){var i=r.l+t,n=Er(r);n.r=e["!row"];var s=r.read_shift(1),a=[n,s,"b"];if(e.cellFormula){r.l+=2;var o=va(r,i-r.l,e);a[3]=wn(o,null,n,e.supbooks,e)}else r.l=i;return a}function Ov(r,t,e){var i=r.l+t,n=Er(r);n.r=e["!row"];var s=r.read_shift(1),a=[n,s,"e"];if(e.cellFormula){r.l+=2;var o=va(r,i-r.l,e);a[3]=wn(o,null,n,e.supbooks,e)}else r.l=i;return a}function Av(r,t,e){var i=r.l+t,n=Er(r);n.r=e["!row"];var s=En(r),a=[n,s,"n"];if(e.cellFormula){r.l+=2;var o=va(r,i-r.l,e);a[3]=wn(o,null,n,e.supbooks,e)}else r.l=i;return a}function Dv(r,t,e){var i=r.l+t,n=Er(r);n.r=e["!row"];var s=Ht(r),a=[n,s,"str"];if(e.cellFormula){r.l+=2;var o=va(r,i-r.l,e);a[3]=wn(o,null,n,e.supbooks,e)}else r.l=i;return a}var Mv=Xi,Pv=Sn;function Lv(r,t){return t==null&&(t=B(4)),t.write_shift(4,r),t}function Rv(r,t){var e=r.l+t,i=Xi(r,16),n=No(r),s=Ht(r),a=Ht(r),o=Ht(r);r.l=e;var c={rfx:i,relId:n,loc:s,display:o};return a&&(c.Tooltip=a),c}function Nv(r,t){var e=B(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));Sn({s:bt(r[0]),e:bt(r[0])},e),Bo("rId"+t,e);var i=r[1].Target.indexOf("#"),n=i==-1?"":r[1].Target.slice(i+1);return Tt(n||"",e),Tt(r[1].Tooltip||"",e),Tt("",e),e.slice(0,e.l)}function Bv(){}function Wv(r,t,e){var i=r.l+t,n=q0(r,16),s=r.read_shift(1),a=[n];if(a[2]=s,e.cellFormula){var o=kx(r,i-r.l,e);a[1]=o}else r.l=i;return a}function Hv(r,t,e){var i=r.l+t,n=Xi(r,16),s=[n];if(e.cellFormula){var a=Fx(r,i-r.l,e);s[1]=a,r.l=i}else r.l=i;return s}function $v(r,t,e){e==null&&(e=B(18));var i=_a(r,t);e.write_shift(-4,r),e.write_shift(-4,r),e.write_shift(4,(i.width||10)*256),e.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof i.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),e.write_shift(2,n),e}var Mh=["left","right","top","bottom","header","footer"];function Vv(r){var t={};return Mh.forEach(function(e){t[e]=En(r,8)}),t}function Uv(r,t){return t==null&&(t=B(6*8)),Ah(r),Mh.forEach(function(e){Hi(r[e],t)}),t}function zv(r){var t=r.read_shift(2);return r.l+=28,{RTL:t&32}}function Gv(r,t,e){e==null&&(e=B(30));var i=924;return(((t||{}).Views||[])[0]||{}).RTL&&(i|=32),e.write_shift(2,i),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function Xv(r){var t=B(24);return t.write_shift(4,4),t.write_shift(4,1),Sn(r,t),t}function jv(r,t){return t==null&&(t=B(16*4+2)),t.write_shift(2,r.password?ph(r.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?t.write_shift(4,r[e[0]]!=null&&!r[e[0]]?1:0):t.write_shift(4,r[e[0]]!=null&&r[e[0]]?0:1)}),t}function Yv(){}function Kv(){}function qv(r,t,e,i,n,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=rr(t),t.z=t.z||it[14],t.v=tr(Xt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r:e,c:i};switch(c.s=wi(n.cellXfs,t,n),t.l&&s["!links"].push([Ge(c),t.l]),t.c&&s["!comments"].push([Ge(c),t.c]),t.t){case"s":case"str":return n.bookSST?(o=zo(n.Strings,t.v,n.revStrings),c.t="s",c.v=o,a?K(r,18,mv(t,c)):K(r,7,dv(t,c))):(c.t="str",a?K(r,17,Iv(t,c)):K(r,6,Ev(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?K(r,13,bv(t,c)):K(r,2,wv(t,c)):a?K(r,16,_v(t,c)):K(r,5,xv(t,c)),!0;case"b":return c.t="b",a?K(r,15,ov(t,c)):K(r,4,sv(t,c)),!0;case"e":return c.t="e",a?K(r,14,fv(t,c)):K(r,3,cv(t,c)),!0}return a?K(r,12,iv(t,c)):K(r,1,tv(t,c)),!0}function Qv(r,t,e,i){var n=Je(t["!ref"]||"A1"),s,a="",o=[];K(r,145);var c=Array.isArray(t),l=n.e.r;t["!rows"]&&(l=Math.max(n.e.r,t["!rows"].length-1));for(var h=n.s.r;h<=l;++h){a=Lt(h),Yx(r,t,n,h);var f=!1;if(h<=n.e.r)for(var u=n.s.c;u<=n.e.c;++u){h===n.s.r&&(o[u]=Wt(u)),s=o[u]+a;var d=c?(t[h]||[])[u]:t[s];if(!d){f=!1;continue}f=qv(r,d,h,u,i,t,f)}}K(r,146)}function Zv(r,t){!t||!t["!merges"]||(K(r,177,Lv(t["!merges"].length)),t["!merges"].forEach(function(e){K(r,176,Pv(e))}),K(r,178))}function Jv(r,t){!t||!t["!cols"]||(K(r,390),t["!cols"].forEach(function(e,i){e&&K(r,60,$v(i,e))}),K(r,391))}function e_(r,t){!t||!t["!ref"]||(K(r,648),K(r,649,Xv(Je(t["!ref"]))),K(r,650))}function t_(r,t,e){t["!links"].forEach(function(i){if(i[1].Target){var n=Ue(e,-1,i[1].Target.replace(/#.*$/,""),Be.HLINK);K(r,494,Nv(i,n))}}),delete t["!links"]}function r_(r,t,e,i){if(t["!comments"].length>0){var n=Ue(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Be.VML);K(r,551,Bo("rId"+n)),t["!legacy"]=n}}function i_(r,t,e,i){if(t["!autofilter"]){var n=t["!autofilter"],s=typeof n.ref=="string"?n.ref:lt(n.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,o=xr(s);o.s.r==o.e.r&&(o.e.r=xr(t["!ref"]).e.r,s=lt(o));for(var c=0;c<a.length;++c){var l=a[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==i){l.Ref="'"+e.SheetNames[i]+"'!"+s;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+s}),K(r,161,Sn(Je(s))),K(r,162)}}function n_(r,t,e){K(r,133),K(r,137,Gv(t,e)),K(r,138),K(r,134)}function s_(r,t){t["!protect"]&&K(r,535,jv(t["!protect"]))}function a_(r,t,e,i){var n=er(),s=e.SheetNames[r],a=e.Sheets[s]||{},o=s;try{e&&e.Workbook&&(o=e.Workbook.Sheets[r].CodeName||o)}catch{}var c=Je(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],K(n,129),(e.vbaraw||a["!outline"])&&K(n,147,Jx(o,a["!outline"])),K(n,148,qx(c)),n_(n,a,e.Workbook),Jv(n,a,r,t,e),Qv(n,a,r,t,e),s_(n,a),i_(n,a,e,r),Zv(n,a),t_(n,a,i),a["!margins"]&&K(n,476,Uv(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&e_(n,a),r_(n,a,r,i),K(n,130),n.end()}function o_(r,t){r.l+=10;var e=Ht(r,t-10);return{name:e}}var l_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function c_(r){return!r.Workbook||!r.Workbook.WBProps?"false":Wp(r.Workbook.WBProps.date1904)?"true":"false"}var h_="][*?/\\".split("");function Ph(r,t){if(r.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var e=!0;return h_.forEach(function(i){if(r.indexOf(i)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");e=!1}}),e}function f_(r,t,e){r.forEach(function(i,n){Ph(i);for(var s=0;s<n;++s)if(i==r[s])throw new Error("Duplicate Sheet Name: "+i);if(e){var a=t&&t[n]&&t[n].CodeName||i;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function u_(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var t=r.Workbook&&r.Workbook.Sheets||[];f_(r.SheetNames,t,!!r.vbaraw);for(var e=0;e<r.SheetNames.length;++e)Px(r.Sheets[r.SheetNames[e]],r.SheetNames[e],e)}function Lh(r){var t=[ct];t[t.length]=ie("workbook",null,{xmlns:Cn[0],"xmlns:r":Ct.r});var e=r.Workbook&&(r.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(l_.forEach(function(o){r.Workbook.WBProps[o[0]]!=null&&r.Workbook.WBProps[o[0]]!=o[1]&&(i[o[0]]=r.Workbook.WBProps[o[0]])}),r.Workbook.WBProps.CodeName&&(i.codeName=r.Workbook.WBProps.CodeName,delete i.CodeName)),t[t.length]=ie("workbookPr",null,i);var n=r.Workbook&&r.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==r.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var a={name:ze(r.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=ie("sheet",null,a)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=ie("definedName",ze(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function d_(r,t){var e={};return e.Hidden=r.read_shift(4),e.iTabID=r.read_shift(4),e.strRelID=yo(r,t-8),e.name=Ht(r),e}function p_(r,t){return t||(t=B(127)),t.write_shift(4,r.Hidden),t.write_shift(4,r.iTabID),Bo(r.strRelID,t),Tt(r.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function m_(r,t){var e={},i=r.read_shift(4);e.defaultThemeVersion=r.read_shift(4);var n=t>8?Ht(r):"";return n.length>0&&(e.CodeName=n),e.autoCompressPictures=!!(i&65536),e.backupFile=!!(i&64),e.checkCompatibility=!!(i&4096),e.date1904=!!(i&1),e.filterPrivacy=!!(i&8),e.hidePivotFieldList=!!(i&1024),e.promptedSolutions=!!(i&16),e.publishItems=!!(i&2048),e.refreshAllConnections=!!(i&262144),e.saveExternalLinkValues=!!(i&128),e.showBorderUnselectedTables=!!(i&4),e.showInkAnnotation=!!(i&32),e.showObjects=["all","placeholders","none"][i>>13&3],e.showPivotChartFilter=!!(i&32768),e.updateLinks=["userSet","never","always"][i>>8&3],e}function g_(r,t){t||(t=B(72));var e=0;return r&&r.filterPrivacy&&(e|=8),t.write_shift(4,e),t.write_shift(4,0),j0(r&&r.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function x_(r,t,e){var i=r.l+t;r.l+=4,r.l+=1;var n=r.read_shift(4),s=cm(r),a=Ix(r,0,e),o=No(r);r.l=i;var c={Name:s,Ptg:a};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function v_(r,t){K(r,143);for(var e=0;e!=t.SheetNames.length;++e){var i=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[e]&&t.Workbook.Sheets[e].Hidden||0,n={Hidden:i,iTabID:e+1,strRelID:"rId"+(e+1),name:t.SheetNames[e]};K(r,156,p_(n))}K(r,144)}function __(r,t){t||(t=B(127));for(var e=0;e!=4;++e)t.write_shift(4,0);return Tt("SheetJS",t),Tt(rs.version,t),Tt(rs.version,t),Tt("7262",t),t.length>t.l?t.slice(0,t.l):t}function y_(r,t){t||(t=B(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,r),t.write_shift(4,r);var e=120;return t.write_shift(1,e),t.length>t.l?t.slice(0,t.l):t}function w_(r,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var e=t.Workbook.Sheets,i=0,n=-1,s=-1;i<e.length;++i)!e[i]||!e[i].Hidden&&n==-1?n=i:e[i].Hidden==1&&s==-1&&(s=i);s>n||(K(r,135),K(r,158,y_(n)),K(r,136))}}function C_(r,t){var e=er();return K(e,131),K(e,128,__()),K(e,153,g_(r.Workbook&&r.Workbook.WBProps||null)),w_(e,r,t),v_(e,r,t),K(e,132),e.end()}function b_(r,t,e){return(t.slice(-4)===".bin"?C_:Lh)(r,e)}function T_(r,t,e,i,n){return(t.slice(-4)===".bin"?a_:Dh)(r,e,i,n)}function S_(r,t,e){return(t.slice(-4)===".bin"?Ug:xh)(r,e)}function E_(r,t,e){return(t.slice(-4)===".bin"?gg:dh)(r,e)}function k_(r,t,e){return(t.slice(-4)===".bin"?s1:Ch)(r,e)}function I_(r){return(r.slice(-4)===".bin"?Qg:yh)()}function F_(r,t){var e=[];return r.Props&&e.push(Sm(r.Props,t)),r.Custprops&&e.push(Em(r.Props,r.Custprops,t)),e.join("")}function O_(){return""}function A_(r,t){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(i,n){var s=[];s.push(ie("NumberFormat",null,{"ss:Format":ze(it[i.numFmtId])}));var a={"ss:ID":"s"+(21+n)};e.push(ie("Style",s.join(""),a))}),ie("Styles",e.join(""))}function Rh(r){return ie("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+Vo(r.Ref,{r:0,c:0})})}function D_(r){if(!((r||{}).Workbook||{}).Names)return"";for(var t=r.Workbook.Names,e=[],i=0;i<t.length;++i){var n=t[i];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||e.push(Rh(n)))}return ie("Names",e.join(""))}function M_(r,t,e,i){if(!r||!((i||{}).Workbook||{}).Names)return"";for(var n=i.Workbook.Names,s=[],a=0;a<n.length;++a){var o=n[a];o.Sheet==e&&(o.Name.match(/^_xlfn\./)||s.push(Rh(o)))}return s.join("")}function P_(r,t,e,i){if(!r)return"";var n=[];if(r["!margins"]&&(n.push("<PageSetup>"),r["!margins"].header&&n.push(ie("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&n.push(ie("Footer",null,{"x:Margin":r["!margins"].footer})),n.push(ie("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),n.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[e])if(i.Workbook.Sheets[e].Hidden)n.push(ie("Visible",i.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<e&&!(i.Workbook.Sheets[s]&&!i.Workbook.Sheets[s].Hidden);++s);s==e&&n.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),r["!protect"]&&(n.push(Pt("ProtectContents","True")),r["!protect"].objects&&n.push(Pt("ProtectObjects","True")),r["!protect"].scenarios&&n.push(Pt("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?n.push(Pt("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&n.push(Pt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){r["!protect"][a[0]]&&n.push("<"+a[1]+"/>")})),n.length==0?"":ie("WorksheetOptions",n.join(""),{xmlns:gr.x})}function L_(r){return r.map(function(t){var e=Bp(t.t||""),i=ie("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return ie("Comment",i,{"ss:Author":t.a})}).join("")}function R_(r,t,e,i,n,s,a){if(!r||r.v==null&&r.f==null)return"";var o={};if(r.f&&(o["ss:Formula"]="="+ze(Vo(r.f,a))),r.F&&r.F.slice(0,t.length)==t){var c=bt(r.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(r.l&&r.l.Target&&(o["ss:HRef"]=ze(r.l.Target),r.l.Tooltip&&(o["x:HRefScreenTip"]=ze(r.l.Tooltip))),e["!merges"])for(var l=e["!merges"],h=0;h!=l.length;++h)l[h].s.c!=a.c||l[h].s.r!=a.r||(l[h].e.c>l[h].s.c&&(o["ss:MergeAcross"]=l[h].e.c-l[h].s.c),l[h].e.r>l[h].s.r&&(o["ss:MergeDown"]=l[h].e.r-l[h].s.r));var f="",u="";switch(r.t){case"z":if(!i.sheetStubs)return"";break;case"n":f="Number",u=String(r.v);break;case"b":f="Boolean",u=r.v?"1":"0";break;case"e":f="Error",u=fs[r.v];break;case"d":f="DateTime",u=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||it[14]);break;case"s":f="String",u=Np(r.v||"");break}var d=wi(i.cellXfs,r,i);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=a.c+1;var g=r.v!=null?u:"",p=r.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(r.c||[]).length>0&&(p+=L_(r.c)),ie("Cell",p,o)}function N_(r,t){var e='<Row ss:Index="'+(r+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=gh(t.hpt)),t.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(e+=' ss:Hidden="1"')),e+">"}function B_(r,t,e,i){if(!r["!ref"])return"";var n=Je(r["!ref"]),s=r["!merges"]||[],a=0,o=[];r["!cols"]&&r["!cols"].forEach(function(x,E){Ho(x);var F=!!x.width,O=_a(E,x),V={"ss:Index":E+1};F&&(V["ss:Width"]=aa(O.width)),x.hidden&&(V["ss:Hidden"]="1"),o.push(ie("Column",null,V))});for(var c=Array.isArray(r),l=n.s.r;l<=n.e.r;++l){for(var h=[N_(l,(r["!rows"]||[])[l])],f=n.s.c;f<=n.e.c;++f){var u=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>l)&&!(s[a].e.c<f)&&!(s[a].e.r<l)){(s[a].s.c!=f||s[a].s.r!=l)&&(u=!0);break}if(!u){var d={r:l,c:f},g=Ge(d),p=c?(r[l]||[])[f]:r[g];h.push(R_(p,g,r,t,e,i,d))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function W_(r,t,e){var i=[],n=e.SheetNames[r],s=e.Sheets[n],a=s?M_(s,t,r,e):"";return a.length>0&&i.push("<Names>"+a+"</Names>"),a=s?B_(s,t,r,e):"",a.length>0&&i.push("<Table>"+a+"</Table>"),i.push(P_(s,t,r,e)),i.join("")}function H_(r,t){t||(t={}),r.SSF||(r.SSF=rr(it)),r.SSF&&(da(),ua(r.SSF),t.revssf=pa(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF,t.cellXfs=[],wi(t.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(F_(r,t)),e.push(O_(r,t)),e.push(""),e.push("");for(var i=0;i<r.SheetNames.length;++i)e.push(ie("Worksheet",W_(i,t,r),{"ss:Name":ze(r.SheetNames[i])}));return e[2]=A_(r,t),e[3]=D_(r,t),ct+ie("Workbook",e.join(""),{xmlns:gr.ss,"xmlns:o":gr.o,"xmlns:x":gr.x,"xmlns:ss":gr.ss,"xmlns:dt":gr.dt,"xmlns:html":gr.html})}var mo={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $_(r,t){var e=[],i=[],n=[],s=0,a,o=Vc(t0,"n"),c=Vc(r0,"n");if(r.Props)for(a=Rt(r.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?e:Object.prototype.hasOwnProperty.call(c,a[s])?i:n).push([a[s],r.Props[a[s]]]);if(r.Custprops)for(a=Rt(r.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?e:Object.prototype.hasOwnProperty.call(c,a[s])?i:n).push([a[s],r.Custprops[a[s]]]);var l=[];for(s=0;s<n.length;++s)ah.indexOf(n[s][0])>-1||ih.indexOf(n[s][0])>-1||n[s][1]!=null&&l.push(n[s]);i.length&&Ye.utils.cfb_add(t,"/SummaryInformation",o0(i,mo.SI,c,r0)),(e.length||l.length)&&Ye.utils.cfb_add(t,"/DocumentSummaryInformation",o0(e,mo.DSI,o,t0,l.length?l:null,mo.UDI))}function V_(r,t){var e=t||{},i=Ye.utils.cfb_new({root:"R"}),n="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":n="/Workbook",e.biff=8;break;case"biff5":n="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Ye.utils.cfb_add(i,n,Nh(r,e)),e.biff==8&&(r.Props||r.Custprops)&&$_(r,i),e.biff==8&&r.vbaraw&&a1(i,Ye.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),i}var U_={0:{f:Xx},1:{f:ev},2:{f:yv},3:{f:lv},4:{f:nv},5:{f:gv},6:{f:Sv},7:{f:uv},8:{f:Dv},9:{f:Av},10:{f:Fv},11:{f:Ov},12:{f:rv},13:{f:Cv},14:{f:hv},15:{f:av},16:{f:vv},17:{f:kv},18:{f:pv},19:{f:Ro},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:x_},40:{},42:{},43:{f:Sg},44:{f:bg},45:{f:Ig},46:{f:Og},47:{f:Fg},48:{},49:{f:rm},50:{},51:{f:Xg},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ig},62:{f:Tv},63:{f:Zg},64:{f:Yv},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:zv},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Zx},148:{f:Kx,p:16},151:{f:Bv},152:{},153:{f:m_},154:{},155:{},156:{f:d_},157:{},158:{},159:{T:1,f:dg},160:{T:-1},161:{T:1,f:Xi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Mv},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:zg},336:{T:-1},337:{f:Kg,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:yo},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Qm},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Wv},427:{f:Hv},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Vv},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Qx},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Rv},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:yo},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:i1},633:{T:1},634:{T:-1},635:{T:1,f:t1},636:{T:-1},637:{f:am},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:o_},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Kv},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ne(r,t,e,i){var n=t;if(!isNaN(n)){var s=i||(e||[]).length||0,a=r.next(4);a.write_shift(2,n),a.write_shift(2,s),s>0&&Mo(e)&&r.push(e)}}function z_(r,t,e,i){var n=i||(e||[]).length||0;if(n<=8224)return ne(r,t,e,n);var s=t;if(!isNaN(s)){for(var a=e.parts||[],o=0,c=0,l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;var h=r.next(4);for(h.write_shift(2,s),h.write_shift(2,l),r.push(e.slice(c,c+l)),c+=l;c<n;){for(h=r.next(4),h.write_shift(2,60),l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;h.write_shift(2,l),r.push(e.slice(c,c+l)),c+=l}}}function ds(r,t,e){return r||(r=B(7)),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,0),r.write_shift(1,0),r}function G_(r,t,e,i){var n=B(9);return ds(n,r,t),lh(e,i||"b",n),n}function X_(r,t,e){var i=B(8+2*e.length);return ds(i,r,t),i.write_shift(1,e.length),i.write_shift(e.length,e,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function j_(r,t,e,i){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?tr(Xt(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?ne(r,2,og(e,i,n)):ne(r,3,ag(e,i,n));return;case"b":case"e":ne(r,5,G_(e,i,t.v,t.t));return;case"s":case"str":ne(r,4,X_(e,i,(t.v||"").slice(0,255)));return}ne(r,1,ds(null,e,i))}function Y_(r,t,e,i){var n=Array.isArray(t),s=Je(t["!ref"]||"A1"),a,o="",c=[];if(s.e.c>255||s.e.r>16383){if(i.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=lt(s)}for(var l=s.s.r;l<=s.e.r;++l){o=Lt(l);for(var h=s.s.c;h<=s.e.c;++h){l===s.s.r&&(c[h]=Wt(h)),a=c[h]+o;var f=n?(t[l]||[])[h]:t[a];f&&j_(r,f,l,h,i)}}}function K_(r,t){var e=t||{};zr!=null&&e.dense==null&&(e.dense=zr);for(var i=er(),n=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==e.sheet&&(n=s);if(n==0&&e.sheet&&r.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return ne(i,e.biff==4?1033:e.biff==3?521:9,Wo(r,16,e)),Y_(i,r.Sheets[r.SheetNames[n]],n,e,r),ne(i,10),i.end()}function q_(r,t,e){ne(r,49,Um({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},e))}function Q_(r,t,e){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)t[n]!=null&&ne(r,1054,Xm(n,t[n],e))})}function Z_(r,t){var e=B(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),ne(r,2151,e),e=B(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),fh(Je(t["!ref"]||"A1"),e),e.write_shift(4,4),ne(r,2152,e)}function J_(r,t){for(var e=0;e<16;++e)ne(r,224,c0({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(i){ne(r,224,c0(i,0,t))})}function ey(r,t){for(var e=0;e<t["!links"].length;++e){var i=t["!links"][e];ne(r,440,eg(i)),i[1].Tooltip&&ne(r,2048,tg(i))}delete t["!links"]}function ty(r,t){if(t){var e=0;t.forEach(function(i,n){++e<=256&&i&&ne(r,125,ng(_a(n,i),n))})}}function ry(r,t,e,i,n){var s=16+wi(n.cellXfs,t,n);if(t.v==null&&!t.bf){ne(r,513,$i(e,i,s));return}if(t.bf)ne(r,6,Ex(t,e,i,n,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?tr(Xt(t.v)):t.v;ne(r,515,qm(e,i,a,s,n));break;case"b":case"e":ne(r,517,Km(e,i,t.v,s,n,t.t));break;case"s":case"str":if(n.bookSST){var o=zo(n.Strings,t.v,n.revStrings);ne(r,253,zm(e,i,o,s,n))}else ne(r,516,Gm(e,i,(t.v||"").slice(0,255),s,n));break;default:ne(r,513,$i(e,i,s))}}function iy(r,t,e){var i=er(),n=e.SheetNames[r],s=e.Sheets[n]||{},a=(e||{}).Workbook||{},o=(a.Sheets||[])[r]||{},c=Array.isArray(s),l=t.biff==8,h,f="",u=[],d=Je(s["!ref"]||"A1"),g=l?65536:16384;if(d.e.c>255||d.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,g-1)}ne(i,2057,Wo(e,16,t)),ne(i,13,Sr(1)),ne(i,12,Sr(100)),ne(i,15,Gt(!0)),ne(i,17,Gt(!1)),ne(i,16,Hi(.001)),ne(i,95,Gt(!0)),ne(i,42,Gt(!1)),ne(i,43,Gt(!1)),ne(i,130,Sr(1)),ne(i,128,Ym([0,0])),ne(i,131,Gt(!1)),ne(i,132,Gt(!1)),l&&ty(i,s["!cols"]),ne(i,512,jm(d,t)),l&&(s["!links"]=[]);for(var p=d.s.r;p<=d.e.r;++p){f=Lt(p);for(var x=d.s.c;x<=d.e.c;++x){p===d.s.r&&(u[x]=Wt(x)),h=u[x]+f;var E=c?(s[p]||[])[x]:s[h];E&&(ry(i,E,p,x,t),l&&E.l&&s["!links"].push([h,E.l]))}}var F=o.CodeName||o.name||n;return l&&ne(i,574,Vm((a.Views||[])[0])),l&&(s["!merges"]||[]).length&&ne(i,229,Jm(s["!merges"])),l&&ey(i,s),ne(i,442,hh(F,t)),l&&Z_(i,s),ne(i,10),i.end()}function ny(r,t,e){var i=er(),n=(r||{}).Workbook||{},s=n.Sheets||[],a=n.WBProps||{},o=e.biff==8,c=e.biff==5;if(ne(i,2057,Wo(r,5,e)),e.bookType=="xla"&&ne(i,135),ne(i,225,o?Sr(1200):null),ne(i,193,Fm(2)),c&&ne(i,191),c&&ne(i,192),ne(i,226),ne(i,92,Bm("SheetJS",e)),ne(i,66,Sr(o?1200:1252)),o&&ne(i,353,Sr(0)),o&&ne(i,448),ne(i,317,sg(r.SheetNames.length)),o&&r.vbaraw&&ne(i,211),o&&r.vbaraw){var l=a.CodeName||"ThisWorkbook";ne(i,442,hh(l,e))}ne(i,156,Sr(17)),ne(i,25,Gt(!1)),ne(i,18,Gt(!1)),ne(i,19,Sr(0)),o&&ne(i,431,Gt(!1)),o&&ne(i,444,Sr(0)),ne(i,61,$m(e)),ne(i,64,Gt(!1)),ne(i,141,Sr(0)),ne(i,34,Gt(c_(r)=="true")),ne(i,14,Gt(!0)),o&&ne(i,439,Gt(!1)),ne(i,218,Sr(0)),q_(i,r,e),Q_(i,r.SSF,e),J_(i,e),o&&ne(i,352,Gt(!1));var h=i.end(),f=er();o&&ne(f,140,rg()),o&&e.Strings&&z_(f,252,Hm(e.Strings,e)),ne(f,10);var u=f.end(),d=er(),g=0,p=0;for(p=0;p<r.SheetNames.length;++p)g+=(o?12:11)+(o?2:1)*r.SheetNames[p].length;var x=h.length+g+u.length;for(p=0;p<r.SheetNames.length;++p){var E=s[p]||{};ne(d,133,Wm({pos:x,hs:E.Hidden||0,dt:0,name:r.SheetNames[p]},e)),x+=t[p].length}var F=d.end();if(g!=F.length)throw new Error("BS8 "+g+" != "+F.length);var O=[];return h.length&&O.push(h),F.length&&O.push(F),u.length&&O.push(u),Mt(O)}function sy(r,t){var e=t||{},i=[];r&&!r.SSF&&(r.SSF=rr(it)),r&&r.SSF&&(da(),ua(r.SSF),e.revssf=pa(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Go(e),e.cellXfs=[],wi(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var n=0;n<r.SheetNames.length;++n)i[i.length]=iy(n,e,r);return i.unshift(ny(r,i,e)),Mt(i)}function Nh(r,t){for(var e=0;e<=r.SheetNames.length;++e){var i=r.Sheets[r.SheetNames[e]];if(!(!i||!i["!ref"])){var n=xr(i["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return sy(r,t);case 4:case 3:case 2:return K_(r,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function ay(r,t,e,i){for(var n=r["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,c=0,l=0;l<n.length;++l)if(!(n[l].s.r>e||n[l].s.c>a)&&!(n[l].e.r<e||n[l].e.c<a)){if(n[l].s.r<e||n[l].s.c<a){o=-1;break}o=n[l].e.r-n[l].s.r+1,c=n[l].e.c-n[l].s.c+1;break}if(!(o<0)){var h=Ge({r:e,c:a}),f=i.dense?(r[e]||[])[a]:r[h],u=f&&f.v!=null&&(f.h||Rp(f.w||(ni(f),f.w)||""))||"",d={};o>1&&(d.rowspan=o),c>1&&(d.colspan=c),i.editable?u='<span contenteditable="true">'+u+"</span>":f&&(d["data-t"]=f&&f.t||"z",f.v!=null&&(d["data-v"]=f.v),f.z!=null&&(d["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+f.l.Target+'">'+u+"</a>")),d.id=(i.id||"sjs")+"-"+h,s.push(ie("td",u,d))}}var g="<tr>";return g+s.join("")+"</tr>"}var oy='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ly="</body></html>";function cy(r,t,e){var i=[];return i.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function Bh(r,t){var e=t||{},i=e.header!=null?e.header:oy,n=e.footer!=null?e.footer:ly,s=[i],a=xr(r["!ref"]);e.dense=Array.isArray(r),s.push(cy(r,a,e));for(var o=a.s.r;o<=a.e.r;++o)s.push(ay(r,a,o,e));return s.push("</table>"+n),s.join("")}function Wh(r,t,e){var i=e||{};zr!=null&&(i.dense=zr);var n=0,s=0;if(i.origin!=null)if(typeof i.origin=="number")n=i.origin;else{var a=typeof i.origin=="string"?bt(i.origin):i.origin;n=a.r,s=a.c}var o=t.getElementsByTagName("tr"),c=Math.min(i.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:n,c:s}};if(r["!ref"]){var h=xr(r["!ref"]);l.s.r=Math.min(l.s.r,h.s.r),l.s.c=Math.min(l.s.c,h.s.c),l.e.r=Math.max(l.e.r,h.e.r),l.e.c=Math.max(l.e.c,h.e.c),n==-1&&(l.e.r=n=h.e.r+1)}var f=[],u=0,d=r["!rows"]||(r["!rows"]=[]),g=0,p=0,x=0,E=0,F=0,O=0;for(r["!cols"]||(r["!cols"]=[]);g<o.length&&p<c;++g){var V=o[g];if(g0(V)){if(i.display)continue;d[p]={hidden:!0}}var Z=V.children;for(x=E=0;x<Z.length;++x){var he=Z[x];if(!(i.display&&g0(he))){var D=he.hasAttribute("data-v")?he.getAttribute("data-v"):he.hasAttribute("v")?he.getAttribute("v"):Hp(he.innerHTML),Y=he.getAttribute("data-z")||he.getAttribute("z");for(u=0;u<f.length;++u){var H=f[u];H.s.c==E+s&&H.s.r<p+n&&p+n<=H.e.r&&(E=H.e.c+1-s,u=-1)}O=+he.getAttribute("colspan")||1,((F=+he.getAttribute("rowspan")||1)>1||O>1)&&f.push({s:{r:p+n,c:E+s},e:{r:p+n+(F||1)-1,c:E+s+(O||1)-1}});var X={t:"s",v:D},Q=he.getAttribute("data-t")||he.getAttribute("t")||"";D!=null&&(D.length==0?X.t=Q||"z":i.raw||D.trim().length==0||Q=="s"||(D==="TRUE"?X={t:"b",v:!0}:D==="FALSE"?X={t:"b",v:!1}:isNaN(ti(D))?isNaN(ss(D).getDate())||(X={t:"d",v:Xt(D)},i.cellDates||(X={t:"n",v:tr(X.v)}),X.z=i.dateNF||it[14]):X={t:"n",v:ti(D)})),X.z===void 0&&Y!=null&&(X.z=Y);var J="",ge=he.getElementsByTagName("A");if(ge&&ge.length)for(var He=0;He<ge.length&&!(ge[He].hasAttribute("href")&&(J=ge[He].getAttribute("href"),J.charAt(0)!="#"));++He);J&&J.charAt(0)!="#"&&(X.l={Target:J}),i.dense?(r[p+n]||(r[p+n]=[]),r[p+n][E+s]=X):r[Ge({c:E+s,r:p+n})]=X,l.e.c<E+s&&(l.e.c=E+s),E+=O}}++p}return f.length&&(r["!merges"]=(r["!merges"]||[]).concat(f)),l.e.r=Math.max(l.e.r,p-1+n),r["!ref"]=lt(l),p>=c&&(r["!fullref"]=lt((l.e.r=o.length-g+p-1+n,l))),r}function Hh(r,t){var e=t||{},i=e.dense?[]:{};return Wh(i,r,t)}function hy(r,t){return Vi(Hh(r,t),t)}function g0(r){var t="",e=fy(r);return e&&(t=e(r).getPropertyValue("display")),t||(t=r.style&&r.style.display),t==="none"}function fy(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var uy=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+as({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return ct+t}}(),x0=function(){var r=function(s){return ze(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,i=function(s,a,o){var c=[];c.push('      <table:table table:name="'+ze(a.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,h=0,f=xr(s["!ref"]||"A1"),u=s["!merges"]||[],d=0,g=Array.isArray(s);if(s["!cols"])for(h=0;h<=f.e.c;++h)c.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var p="",x=s["!rows"]||[];for(l=0;l<f.s.r;++l)p=x[l]?' table:style-name="ro'+x[l].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;l<=f.e.r;++l){for(p=x[l]?' table:style-name="ro'+x[l].ods+'"':"",c.push("        <table:table-row"+p+`>
`),h=0;h<f.s.c;++h)c.push(t);for(;h<=f.e.c;++h){var E=!1,F={},O="";for(d=0;d!=u.length;++d)if(!(u[d].s.c>h)&&!(u[d].s.r>l)&&!(u[d].e.c<h)&&!(u[d].e.r<l)){(u[d].s.c!=h||u[d].s.r!=l)&&(E=!0),F["table:number-columns-spanned"]=u[d].e.c-u[d].s.c+1,F["table:number-rows-spanned"]=u[d].e.r-u[d].s.r+1;break}if(E){c.push(e);continue}var V=Ge({r:l,c:h}),Z=g?(s[l]||[])[h]:s[V];if(Z&&Z.f&&(F["table:formula"]=ze(Dx(Z.f)),Z.F&&Z.F.slice(0,V.length)==V)){var he=xr(Z.F);F["table:number-matrix-columns-spanned"]=he.e.c-he.s.c+1,F["table:number-matrix-rows-spanned"]=he.e.r-he.s.r+1}if(!Z){c.push(t);continue}switch(Z.t){case"b":O=Z.v?"TRUE":"FALSE",F["office:value-type"]="boolean",F["office:boolean-value"]=Z.v?"true":"false";break;case"n":O=Z.w||String(Z.v||0),F["office:value-type"]="float",F["office:value"]=Z.v||0;break;case"s":case"str":O=Z.v==null?"":Z.v,F["office:value-type"]="string";break;case"d":O=Z.w||Xt(Z.v).toISOString(),F["office:value-type"]="date",F["office:date-value"]=Xt(Z.v).toISOString(),F["table:style-name"]="ce1";break;default:c.push(t);continue}var D=r(O);if(Z.l&&Z.l.Target){var Y=Z.l.Target;Y=Y.charAt(0)=="#"?"#"+Mx(Y.slice(1)):Y,Y.charAt(0)!="#"&&!Y.match(/^\w+:/)&&(Y="../"+Y),D=ie("text:a",D,{"xlink:href":Y.replace(/&/g,"&amp;")})}c.push("          "+ie("table:table-cell",ie("text:p",D,{}),F)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var h=0;h<l["!cols"].length;++h)if(l["!cols"][h]){var f=l["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Ho(f),f.ods=o;var u=l["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+u+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var h=0;h<l["!rows"].length;++h)if(l["!rows"][h]){l["!rows"][h].ods=c;var f=l["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var c=[ct],l=as({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=as({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+h+`>
`),c.push(th().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),n(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)c.push(i(a.Sheets[a.SheetNames[f]],a,f,o));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function $h(r,t){if(t.bookType=="fods")return x0(r,t);var e=So(),i="",n=[],s=[];return i="mimetype",Oe(e,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",Oe(e,i,x0(r,t)),n.push([i,"text/xml"]),s.push([i,"ContentFile"]),i="styles.xml",Oe(e,i,uy(r,t)),n.push([i,"text/xml"]),s.push([i,"StylesFile"]),i="meta.xml",Oe(e,i,ct+th()),n.push([i,"text/xml"]),s.push([i,"MetadataFile"]),i="manifest.rdf",Oe(e,i,Tm(s)),n.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",Oe(e,i,Cm(n)),e}function ca(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function dy(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):Dr(Jr(r))}function py(r,t){e:for(var e=0;e<=r.length-t.length;++e){for(var i=0;i<t.length;++i)if(r[e+i]!=t[i])continue e;return!0}return!1}function yi(r){var t=r.reduce(function(n,s){return n+s.length},0),e=new Uint8Array(t),i=0;return r.forEach(function(n){e.set(n,i),i+=n.length}),e}function my(r,t,e){var i=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,n=e/Math.pow(10,i-6176);r[t+15]|=i>>7,r[t+14]|=(i&127)<<1;for(var s=0;n>=1;++s,n/=256)r[t+s]=n&255;r[t+15]|=e>=0?0:128}function os(r,t){var e=t?t[0]:0,i=r[e]&127;e:if(r[e++]>=128&&(i|=(r[e]&127)<<7,r[e++]<128||(i|=(r[e]&127)<<14,r[e++]<128)||(i|=(r[e]&127)<<21,r[e++]<128)||(i+=(r[e]&127)*Math.pow(2,28),++e,r[e++]<128)||(i+=(r[e]&127)*Math.pow(2,35),++e,r[e++]<128)||(i+=(r[e]&127)*Math.pow(2,42),++e,r[e++]<128)))break e;return t&&(t[0]=e),i}function Ve(r){var t=new Uint8Array(7);t[0]=r&127;var e=1;e:if(r>127){if(t[e-1]|=128,t[e]=r>>7&127,++e,r<=16383||(t[e-1]|=128,t[e]=r>>14&127,++e,r<=2097151)||(t[e-1]|=128,t[e]=r>>21&127,++e,r<=268435455)||(t[e-1]|=128,t[e]=r/256>>>21&127,++e,r<=34359738367)||(t[e-1]|=128,t[e]=r/65536>>>21&127,++e,r<=4398046511103))break e;t[e-1]|=128,t[e]=r/16777216>>>21&127,++e}return t.slice(0,e)}function _n(r){var t=0,e=r[t]&127;e:if(r[t++]>=128){if(e|=(r[t]&127)<<7,r[t++]<128||(e|=(r[t]&127)<<14,r[t++]<128)||(e|=(r[t]&127)<<21,r[t++]<128))break e;e|=(r[t]&127)<<28}return e}function dt(r){for(var t=[],e=[0];e[0]<r.length;){var i=e[0],n=os(r,e),s=n&7;n=Math.floor(n/8);var a=0,o;if(n==0)break;switch(s){case 0:{for(var c=e[0];r[e[0]++]>=128;);o=r.slice(c,e[0])}break;case 5:a=4,o=r.slice(e[0],e[0]+a),e[0]+=a;break;case 1:a=8,o=r.slice(e[0],e[0]+a),e[0]+=a;break;case 2:a=os(r,e),o=r.slice(e[0],e[0]+a),e[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(i))}var l={data:o,type:s};t[n]==null?t[n]=[l]:t[n].push(l)}return t}function At(r){var t=[];return r.forEach(function(e,i){e.forEach(function(n){n.data&&(t.push(Ve(i*8+n.type)),n.type==2&&t.push(Ve(n.data.length)),t.push(n.data))})}),yi(t)}function Or(r){for(var t,e=[],i=[0];i[0]<r.length;){var n=os(r,i),s=dt(r.slice(i[0],i[0]+n));i[0]+=n;var a={id:_n(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=dt(o.data),l=_n(c[3][0].data);a.messages.push({meta:c,data:r.slice(i[0],i[0]+l)}),i[0]+=l}),(t=s[3])!=null&&t[0]&&(a.merge=_n(s[3][0].data)>>>0>0),e.push(a)}return e}function fn(r){var t=[];return r.forEach(function(e){var i=[];i[1]=[{data:Ve(e.id),type:0}],i[2]=[],e.merge!=null&&(i[3]=[{data:Ve(+!!e.merge),type:0}]);var n=[];e.messages.forEach(function(a){n.push(a.data),a.meta[3]=[{type:0,data:Ve(a.data.length)}],i[2].push({data:At(a.meta),type:2})});var s=At(i);t.push(Ve(s.length)),t.push(s),n.forEach(function(a){return t.push(a)})}),yi(t)}function gy(r,t){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var e=[0],i=os(t,e),n=[];e[0]<t.length;){var s=t[e[0]]&3;if(s==0){var a=t[e[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[e[0]],o>1&&(a|=t[e[0]+1]<<8),o>2&&(a|=t[e[0]+2]<<16),o>3&&(a|=t[e[0]+3]<<24),a>>>=0,a++,e[0]+=o}n.push(t.slice(e[0],e[0]+a)),e[0]+=a;continue}else{var c=0,l=0;if(s==1?(l=(t[e[0]]>>2&7)+4,c=(t[e[0]++]&224)<<3,c|=t[e[0]++]):(l=(t[e[0]++]>>2)+1,s==2?(c=t[e[0]]|t[e[0]+1]<<8,e[0]+=2):(c=(t[e[0]]|t[e[0]+1]<<8|t[e[0]+2]<<16|t[e[0]+3]<<24)>>>0,e[0]+=4)),n=[yi(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(n.push(n[0].slice(-c)),l-=c;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-c,-c+l))}}var h=yi(n);if(h.length!=i)throw new Error("Unexpected length: ".concat(h.length," != ").concat(i));return h}function Ar(r){for(var t=[],e=0;e<r.length;){var i=r[e++],n=r[e]|r[e+1]<<8|r[e+2]<<16;e+=3,t.push(gy(i,r.slice(e,e+n))),e+=n}if(e!==r.length)throw new Error("data is not a valid framed stream!");return yi(t)}function un(r){for(var t=[],e=0;e<r.length;){var i=Math.min(r.length-e,268435455),n=new Uint8Array(4);t.push(n);var s=Ve(i),a=s.length;t.push(s),i<=60?(a++,t.push(new Uint8Array([i-1<<2]))):i<=256?(a+=2,t.push(new Uint8Array([240,i-1&255]))):i<=65536?(a+=3,t.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(a+=4,t.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(a+=5,t.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),t.push(r.slice(e,e+i)),a+=i,n[0]=0,n[1]=a&255,n[2]=a>>8&255,n[3]=a>>16&255,e+=i}return yi(t)}function go(r,t){var e=new Uint8Array(32),i=ca(e),n=12,s=0;switch(e[0]=5,r.t){case"n":e[1]=2,my(e,n,r.v),s|=1,n+=16;break;case"b":e[1]=6,i.setFloat64(n,r.v?1:0,!0),s|=2,n+=8;break;case"s":if(t.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));e[1]=3,i.setUint32(n,t.indexOf(r.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+r.t}return i.setUint32(8,s,!0),e.slice(0,n)}function xo(r,t){var e=new Uint8Array(32),i=ca(e),n=12,s=0;switch(e[0]=3,r.t){case"n":e[2]=2,i.setFloat64(n,r.v,!0),s|=32,n+=8;break;case"b":e[2]=6,i.setFloat64(n,r.v?1:0,!0),s|=32,n+=8;break;case"s":if(t.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));e[2]=3,i.setUint32(n,t.indexOf(r.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+r.t}return i.setUint32(4,s,!0),e.slice(0,n)}function mi(r){var t=dt(r);return os(t[1][0].data)}function xy(r,t,e){var i,n,s,a;if(!((i=r[6])!=null&&i[0])||!((n=r[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=r[8])==null?void 0:s[0])==null?void 0:a.data)&&_n(r[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=ca(r[7][0].data),h=0,f=[],u=ca(r[4][0].data),d=0,g=[],p=0;p<t.length;++p){if(t[p]==null){l.setUint16(p*2,65535,!0),u.setUint16(p*2,65535);continue}l.setUint16(p*2,h,!0),u.setUint16(p*2,d,!0);var x,E;switch(typeof t[p]){case"string":x=go({t:"s",v:t[p]},e),E=xo({t:"s",v:t[p]},e);break;case"number":x=go({t:"n",v:t[p]},e),E=xo({t:"n",v:t[p]},e);break;case"boolean":x=go({t:"b",v:t[p]},e),E=xo({t:"b",v:t[p]},e);break;default:throw new Error("Unsupported value "+t[p])}f.push(x),h+=x.length,g.push(E),d+=E.length,++c}for(r[2][0].data=Ve(c);p<r[7][0].data.length/2;++p)l.setUint16(p*2,65535,!0),u.setUint16(p*2,65535,!0);return r[6][0].data=yi(f),r[3][0].data=yi(g),c}function vy(r,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=xr(e["!ref"]);i.s.r=i.s.c=0;var n=!1;i.e.c>9&&(n=!0,i.e.c=9),i.e.r>49&&(n=!0,i.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(lt(i)));var s=ha(e,{range:i,header:1}),a=["~Sh33tJ5~"];s.forEach(function(S){return S.forEach(function(T){typeof T=="string"&&a.push(T)})});var o={},c=[],l=Ye.read(t.numbers,{type:"base64"});l.FileIndex.map(function(S,T){return[S,l.FullPaths[T]]}).forEach(function(S){var T=S[0],q=S[1];if(T.type==2&&T.name.match(/\.iwa/)){var pe=T.content,be=Ar(pe),fe=Or(be);fe.forEach(function(oe){c.push(oe.id),o[oe.id]={deps:[],location:q,type:_n(oe.messages[0].meta[1][0].data)}})}}),c.sort(function(S,T){return S-T});var h=c.filter(function(S){return S>1}).map(function(S){return[S,Ve(S)]});l.FileIndex.map(function(S,T){return[S,l.FullPaths[T]]}).forEach(function(S){var T=S[0],q=S[1];if(T.name.match(/\.iwa/)){var pe=Or(Ar(T.content));pe.forEach(function(be){be.messages.forEach(function(fe){h.forEach(function(oe){be.messages.some(function(Xe){return _n(Xe.meta[1][0].data)!=11006&&py(Xe.data,oe[1])})&&o[oe[0]].deps.push(be.id)})})})}});function f(){for(var S=927262;S<2e6;++S)if(!o[S])return S;throw new Error("Too many messages")}for(var u=Ye.find(l,o[1].location),d=Or(Ar(u.content)),g,p=0;p<d.length;++p){var x=d[p];x.id==1&&(g=x)}var E=mi(dt(g.messages[0].data)[1][0].data);for(u=Ye.find(l,o[E].location),d=Or(Ar(u.content)),p=0;p<d.length;++p)x=d[p],x.id==E&&(g=x);for(E=mi(dt(g.messages[0].data)[2][0].data),u=Ye.find(l,o[E].location),d=Or(Ar(u.content)),p=0;p<d.length;++p)x=d[p],x.id==E&&(g=x);for(E=mi(dt(g.messages[0].data)[2][0].data),u=Ye.find(l,o[E].location),d=Or(Ar(u.content)),p=0;p<d.length;++p)x=d[p],x.id==E&&(g=x);var F=dt(g.messages[0].data);{F[6][0].data=Ve(i.e.r+1),F[7][0].data=Ve(i.e.c+1);var O=mi(F[46][0].data),V=Ye.find(l,o[O].location),Z=Or(Ar(V.content));{for(var he=0;he<Z.length&&Z[he].id!=O;++he);if(Z[he].id!=O)throw"Bad ColumnRowUIDMapArchive";var D=dt(Z[he].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var Y=0;Y<=i.e.c;++Y){var H=[];H[1]=H[2]=[{type:0,data:Ve(Y+420690)}],D[1].push({type:2,data:At(H)}),D[2].push({type:0,data:Ve(Y)}),D[3].push({type:0,data:Ve(Y)})}D[4]=[],D[5]=[],D[6]=[];for(var X=0;X<=i.e.r;++X)H=[],H[1]=H[2]=[{type:0,data:Ve(X+726270)}],D[4].push({type:2,data:At(H)}),D[5].push({type:0,data:Ve(X)}),D[6].push({type:0,data:Ve(X)});Z[he].messages[0].data=At(D)}V.content=un(fn(Z)),V.size=V.content.length,delete F[46];var Q=dt(F[4][0].data);{Q[7][0].data=Ve(i.e.r+1);var J=dt(Q[1][0].data),ge=mi(J[2][0].data);V=Ye.find(l,o[ge].location),Z=Or(Ar(V.content));{if(Z[0].id!=ge)throw"Bad HeaderStorageBucket";var He=dt(Z[0].messages[0].data);for(X=0;X<s.length;++X){var _e=dt(He[2][0].data);_e[1][0].data=Ve(X),_e[4][0].data=Ve(s[X].length),He[2][X]={type:He[2][0].type,data:At(_e)}}Z[0].messages[0].data=At(He)}V.content=un(fn(Z)),V.size=V.content.length;var pt=mi(Q[2][0].data);V=Ye.find(l,o[pt].location),Z=Or(Ar(V.content));{if(Z[0].id!=pt)throw"Bad HeaderStorageBucket";for(He=dt(Z[0].messages[0].data),Y=0;Y<=i.e.c;++Y)_e=dt(He[2][0].data),_e[1][0].data=Ve(Y),_e[4][0].data=Ve(i.e.r+1),He[2][Y]={type:He[2][0].type,data:At(_e)};Z[0].messages[0].data=At(He)}V.content=un(fn(Z)),V.size=V.content.length;var mt=mi(Q[4][0].data);(function(){for(var S=Ye.find(l,o[mt].location),T=Or(Ar(S.content)),q,pe=0;pe<T.length;++pe){var be=T[pe];be.id==mt&&(q=be)}var fe=dt(q.messages[0].data);{fe[3]=[];var oe=[];a.forEach(function(Et,Re){oe[1]=[{type:0,data:Ve(Re)}],oe[2]=[{type:0,data:Ve(1)}],oe[3]=[{type:2,data:dy(Et)}],fe[3].push({type:2,data:At(oe)})})}q.messages[0].data=At(fe);var Xe=fn(T),Pe=un(Xe);S.content=Pe,S.size=S.content.length})();var jt=dt(Q[3][0].data);{var $t=jt[1][0];delete jt[2];var St=dt($t.data);{var Yt=mi(St[2][0].data);(function(){for(var S=Ye.find(l,o[Yt].location),T=Or(Ar(S.content)),q,pe=0;pe<T.length;++pe){var be=T[pe];be.id==Yt&&(q=be)}var fe=dt(q.messages[0].data);{delete fe[6],delete jt[7];var oe=new Uint8Array(fe[5][0].data);fe[5]=[];for(var Xe=0,Pe=0;Pe<=i.e.r;++Pe){var Et=dt(oe);Xe+=xy(Et,s[Pe],a),Et[1][0].data=Ve(Pe),fe[5].push({data:At(Et),type:2})}fe[1]=[{type:0,data:Ve(i.e.c+1)}],fe[2]=[{type:0,data:Ve(i.e.r+1)}],fe[3]=[{type:0,data:Ve(Xe)}],fe[4]=[{type:0,data:Ve(i.e.r+1)}]}q.messages[0].data=At(fe);var Re=fn(T),Ir=un(Re);S.content=Ir,S.size=S.content.length})()}$t.data=At(St)}Q[3][0].data=At(jt)}F[4][0].data=At(Q)}g.messages[0].data=At(F);var b=fn(d),z=un(b);return u.content=z,u.size=u.content.length,l}function _y(r){return function(e){for(var i=0;i!=r.length;++i){var n=r[i];e[n[0]]===void 0&&(e[n[0]]=n[1]),n[2]==="n"&&(e[n[0]]=Number(e[n[0]]))}}}function Go(r){_y([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function yy(r,t){return t.bookType=="ods"?$h(r,t):t.bookType=="numbers"?vy(r,t):t.bookType=="xlsb"?wy(r,t):Cy(r,t)}function wy(r,t){pn=1024,r&&!r.SSF&&(r.SSF=rr(it)),r&&r.SSF&&(da(),ua(r.SSF),t.revssf=pa(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ts?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e=t.bookType=="xlsb"?"bin":"xml",i=bh.indexOf(t.bookType)>-1,n=Z0();Go(t=t||{});var s=So(),a="",o=0;if(t.cellXfs=[],wi(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",Oe(s,a,rh(r.Props,t)),n.coreprops.push(a),Ue(t.rels,2,a,Be.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],l=0;l<r.SheetNames.length;++l)(r.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(r.SheetNames[l]);r.Props.SheetNames=c}for(r.Props.Worksheets=r.Props.SheetNames.length,Oe(s,a,nh(r.Props,t)),n.extprops.push(a),Ue(t.rels,3,a,Be.EXT_PROPS),r.Custprops!==r.Props&&Rt(r.Custprops||{}).length>0&&(a="docProps/custom.xml",Oe(s,a,sh(r.Custprops,t)),n.custprops.push(a),Ue(t.rels,4,a,Be.CUST_PROPS)),o=1;o<=r.SheetNames.length;++o){var h={"!id":{}},f=r.Sheets[r.SheetNames[o-1]],u=(f||{})["!type"]||"sheet";switch(u){case"chart":default:a="xl/worksheets/sheet"+o+"."+e,Oe(s,a,T_(o-1,a,t,r,h)),n.sheets.push(a),Ue(t.wbrels,-1,"worksheets/sheet"+o+"."+e,Be.WS[0])}if(f){var d=f["!comments"],g=!1,p="";d&&d.length>0&&(p="xl/comments"+o+"."+e,Oe(s,p,k_(d,p,t)),n.comments.push(p),Ue(h,-1,"../comments"+o+"."+e,Be.CMNT),g=!0),f["!legacy"]&&g&&Oe(s,"xl/drawings/vmlDrawing"+o+".vml",wh(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Oe(s,eh(a),xn(h))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+e,Oe(s,a,E_(t.Strings,a,t)),n.strs.push(a),Ue(t.wbrels,-1,"sharedStrings."+e,Be.SST)),a="xl/workbook."+e,Oe(s,a,b_(r,a,t)),n.workbooks.push(a),Ue(t.rels,1,a,Be.WB),a="xl/theme/theme1.xml",Oe(s,a,_h(r.Themes,t)),n.themes.push(a),Ue(t.wbrels,-1,"theme/theme1.xml",Be.THEME),a="xl/styles."+e,Oe(s,a,S_(r,a,t)),n.styles.push(a),Ue(t.wbrels,-1,"styles."+e,Be.STY),r.vbaraw&&i&&(a="xl/vbaProject.bin",Oe(s,a,r.vbaraw),n.vba.push(a),Ue(t.wbrels,-1,"vbaProject.bin",Be.VBA)),a="xl/metadata."+e,Oe(s,a,I_(a)),n.metadata.push(a),Ue(t.wbrels,-1,"metadata."+e,Be.XLMETA),Oe(s,"[Content_Types].xml",J0(n,t)),Oe(s,"_rels/.rels",xn(t.rels)),Oe(s,"xl/_rels/workbook."+e+".rels",xn(t.wbrels)),delete t.revssf,delete t.ssf,s}function Cy(r,t){pn=1024,r&&!r.SSF&&(r.SSF=rr(it)),r&&r.SSF&&(da(),ua(r.SSF),t.revssf=pa(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ts?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",i=bh.indexOf(t.bookType)>-1,n=Z0();Go(t=t||{});var s=So(),a="",o=0;if(t.cellXfs=[],wi(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",Oe(s,a,rh(r.Props,t)),n.coreprops.push(a),Ue(t.rels,2,a,Be.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],l=0;l<r.SheetNames.length;++l)(r.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(r.SheetNames[l]);r.Props.SheetNames=c}r.Props.Worksheets=r.Props.SheetNames.length,Oe(s,a,nh(r.Props,t)),n.extprops.push(a),Ue(t.rels,3,a,Be.EXT_PROPS),r.Custprops!==r.Props&&Rt(r.Custprops||{}).length>0&&(a="docProps/custom.xml",Oe(s,a,sh(r.Custprops,t)),n.custprops.push(a),Ue(t.rels,4,a,Be.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,o=1;o<=r.SheetNames.length;++o){var f={"!id":{}},u=r.Sheets[r.SheetNames[o-1]],d=(u||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+e,Oe(s,a,Dh(o-1,t,r,f)),n.sheets.push(a),Ue(t.wbrels,-1,"worksheets/sheet"+o+"."+e,Be.WS[0])}if(u){var g=u["!comments"],p=!1,x="";if(g&&g.length>0){var E=!1;g.forEach(function(F){F[1].forEach(function(O){O.T==!0&&(E=!0)})}),E&&(x="xl/threadedComments/threadedComment"+o+"."+e,Oe(s,x,Jg(g,h,t)),n.threadedcomments.push(x),Ue(f,-1,"../threadedComments/threadedComment"+o+"."+e,Be.TCMNT)),x="xl/comments"+o+"."+e,Oe(s,x,Ch(g,t)),n.comments.push(x),Ue(f,-1,"../comments"+o+"."+e,Be.CMNT),p=!0}u["!legacy"]&&p&&Oe(s,"xl/drawings/vmlDrawing"+o+".vml",wh(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}f["!id"].rId1&&Oe(s,eh(a),xn(f))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+e,Oe(s,a,dh(t.Strings,t)),n.strs.push(a),Ue(t.wbrels,-1,"sharedStrings."+e,Be.SST)),a="xl/workbook."+e,Oe(s,a,Lh(r,t)),n.workbooks.push(a),Ue(t.rels,1,a,Be.WB),a="xl/theme/theme1.xml",Oe(s,a,_h(r.Themes,t)),n.themes.push(a),Ue(t.wbrels,-1,"theme/theme1.xml",Be.THEME),a="xl/styles."+e,Oe(s,a,xh(r,t)),n.styles.push(a),Ue(t.wbrels,-1,"styles."+e,Be.STY),r.vbaraw&&i&&(a="xl/vbaProject.bin",Oe(s,a,r.vbaraw),n.vba.push(a),Ue(t.wbrels,-1,"vbaProject.bin",Be.VBA)),a="xl/metadata."+e,Oe(s,a,yh()),n.metadata.push(a),Ue(t.wbrels,-1,"metadata."+e,Be.XLMETA),h.length>1&&(a="xl/persons/person.xml",Oe(s,a,e1(h,t)),n.people.push(a),Ue(t.wbrels,-1,"persons/person.xml",Be.PEOPLE)),Oe(s,"[Content_Types].xml",J0(n,t)),Oe(s,"_rels/.rels",xn(t.rels)),Oe(s,"xl/_rels/workbook."+e+".rels",xn(t.wbrels)),delete t.revssf,delete t.ssf,s}function by(r,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":e=ii(r.slice(0,12));break;case"binary":e=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function Vh(r,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return hs(t.file,Ye.write(r,{type:We?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ye.write(r,t)}function Ty(r,t){var e=rr(t||{}),i=yy(r,e);return Sy(i,e)}function Sy(r,t){var e={},i=We?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=i;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=i;break;default:throw new Error("Unrecognized type "+t.type)}var n=r.FullPaths?Ye.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):r.generate(e);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(fa(n))}return t.password&&typeof encrypt_agile<"u"?Vh(encrypt_agile(n,t.password),t):t.type==="file"?hs(t.file,n):t.type=="string"?Qn(n):n}function Ey(r,t){var e=t||{},i=V_(r,e);return Vh(i,e)}function Ur(r,t,e){e||(e="");var i=e+r;switch(t.type){case"base64":return ns(Jr(i));case"binary":return Jr(i);case"string":return r;case"file":return hs(t.file,i,"utf8");case"buffer":return We?si(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):Ur(i,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ky(r,t){switch(t.type){case"base64":return ns(r);case"binary":return r;case"string":return r;case"file":return hs(t.file,r,"binary");case"buffer":return We?si(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Qs(r,t){switch(t.type){case"string":case"base64":case"binary":for(var e="",i=0;i<r.length;++i)e+=String.fromCharCode(r[i]);return t.type=="base64"?ns(e):t.type=="string"?Qn(e):e;case"file":return hs(t.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+t.type)}}function Uh(r,t){Jd(),u_(r);var e=rr(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var i=Uh(r,e);return e.type="array",fa(i)}var n=0;if(e.sheet&&(typeof e.sheet=="number"?n=e.sheet:n=r.SheetNames.indexOf(e.sheet),!r.SheetNames[n]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return Ur(H_(r,e),e);case"slk":case"sylk":return Ur(cg.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"htm":case"html":return Ur(Bh(r.Sheets[r.SheetNames[n]],e),e);case"txt":return ky(zh(r.Sheets[r.SheetNames[n]],e),e);case"csv":return Ur(jo(r.Sheets[r.SheetNames[n]],e),e,"\uFEFF");case"dif":return Ur(hg.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"dbf":return Qs(lg.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"prn":return Ur(fg.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"rtf":return Ur(vg.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"eth":return Ur(uh.from_sheet(r.Sheets[r.SheetNames[n]],e),e);case"fods":return Ur($h(r,e),e);case"wk1":return Qs(h0.sheet_to_wk1(r.Sheets[r.SheetNames[n]],e),e);case"wk3":return Qs(h0.book_to_wk3(r,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),Qs(Nh(r,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),Ey(r,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Ty(r,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function Iy(r){if(!r.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(r.bookType=e.slice(1)),r.bookType=t[r.bookType]||r.bookType}}function Xo(r,t,e){var i=e||{};return i.type="file",i.file=t,Iy(i),Uh(r,i)}function Fy(r,t,e,i,n,s,a,o){var c=Lt(e),l=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,u=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:e,enumerable:!1})}catch{u.__rowNum__=e}else u.__rowNum__=e;if(!a||r[e])for(var d=t.s.c;d<=t.e.c;++d){var g=a?r[e][d]:r[i[d]+c];if(g===void 0||g.t===void 0){if(l===void 0)continue;s[d]!=null&&(u[s[d]]=l);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[d]!=null){if(p==null)if(g.t=="e"&&p===null)u[s[d]]=null;else if(l!==void 0)u[s[d]]=l;else if(h&&p===null)u[s[d]]=null;else continue;else u[s[d]]=h&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?p:ni(g,p,o);p!=null&&(f=!1)}}return{row:u,isempty:f}}function ha(r,t){if(r==null||r["!ref"]==null)return[];var e={t:"n",v:0},i=0,n=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},h=l.range!=null?l.range:r["!ref"];switch(l.header===1?i=1:l.header==="A"?i=2:Array.isArray(l.header)?i=3:l.header==null&&(i=0),typeof h){case"string":c=Je(h);break;case"number":c=Je(r["!ref"]),c.s.r=h;break;default:c=h}i>0&&(n=0);var f=Lt(c.s.r),u=[],d=[],g=0,p=0,x=Array.isArray(r),E=c.s.r,F=0,O={};x&&!r[E]&&(r[E]=[]);var V=l.skipHidden&&r["!cols"]||[],Z=l.skipHidden&&r["!rows"]||[];for(F=c.s.c;F<=c.e.c;++F)if(!(V[F]||{}).hidden)switch(u[F]=Wt(F),e=x?r[E][F]:r[u[F]+f],i){case 1:s[F]=F-c.s.c;break;case 2:s[F]=u[F];break;case 3:s[F]=l.header[F-c.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),o=a=ni(e,null,l),p=O[a]||0,!p)O[a]=1;else{do o=a+"_"+p++;while(O[o]);O[a]=p,O[o]=1}s[F]=o}for(E=c.s.r+n;E<=c.e.r;++E)if(!(Z[E]||{}).hidden){var he=Fy(r,c,E,u,i,s,x,l);(he.isempty===!1||(i===1?l.blankrows!==!1:l.blankrows))&&(d[g++]=he.row)}return d.length=g,d}var v0=/"/g;function Oy(r,t,e,i,n,s,a,o){for(var c=!0,l=[],h="",f=Lt(e),u=t.s.c;u<=t.e.c;++u)if(i[u]){var d=o.dense?(r[e]||[])[u]:r[i[u]+f];if(d==null)h="";else if(d.v!=null){c=!1,h=""+(o.rawNumbers&&d.t=="n"?d.v:ni(d,null,o));for(var g=0,p=0;g!==h.length;++g)if((p=h.charCodeAt(g))===n||p===s||p===34||o.forceQuotes){h='"'+h.replace(v0,'""')+'"';break}h=="ID"&&(h='"ID"')}else d.f!=null&&!d.F?(c=!1,h="="+d.f,h.indexOf(",")>=0&&(h='"'+h.replace(v0,'""')+'"')):h="";l.push(h)}return o.blankrows===!1&&c?null:l.join(a)}function jo(r,t){var e=[],i=t??{};if(r==null||r["!ref"]==null)return"";var n=Je(r["!ref"]),s=i.FS!==void 0?i.FS:",",a=s.charCodeAt(0),o=i.RS!==void 0?i.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),h="",f=[];i.dense=Array.isArray(r);for(var u=i.skipHidden&&r["!cols"]||[],d=i.skipHidden&&r["!rows"]||[],g=n.s.c;g<=n.e.c;++g)(u[g]||{}).hidden||(f[g]=Wt(g));for(var p=0,x=n.s.r;x<=n.e.r;++x)(d[x]||{}).hidden||(h=Oy(r,n,x,f,a,c,s,i),h!=null&&(i.strip&&(h=h.replace(l,"")),(h||i.blankrows!==!1)&&e.push((p++?o:"")+h)));return delete i.dense,e.join("")}function zh(r,t){t||(t={}),t.FS="	",t.RS=`
`;var e=jo(r,t);if(typeof qe>"u"||t.type=="string")return e;var i=qe.utils.encode(1200,e,"str");return"\xFF\xFE"+i}function Ay(r){var t="",e,i="";if(r==null||r["!ref"]==null)return[];var n=Je(r["!ref"]),s="",a=[],o,c=[],l=Array.isArray(r);for(o=n.s.c;o<=n.e.c;++o)a[o]=Wt(o);for(var h=n.s.r;h<=n.e.r;++h)for(s=Lt(h),o=n.s.c;o<=n.e.c;++o)if(t=a[o]+s,e=l?(r[h]||[])[o]:r[t],i="",e!==void 0){if(e.F!=null){if(t=e.F,!e.f)continue;i=e.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(e.f!=null)i=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)i=""+e.v;else if(e.t=="b")i=e.v?"TRUE":"FALSE";else if(e.w!==void 0)i="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?i="'"+e.v:i=""+e.v}}c[c.length]=t+"="+i}return c}function Gh(r,t,e){var i=e||{},n=+!i.skipHeader,s=r||{},a=0,o=0;if(s&&i.origin!=null)if(typeof i.origin=="number")a=i.origin;else{var c=typeof i.origin=="string"?bt(i.origin):i.origin;a=c.r,o=c.c}var l,h={s:{c:0,r:0},e:{c:o,r:a+t.length-1+n}};if(s["!ref"]){var f=Je(s["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),a==-1&&(a=f.e.r+1,h.e.r=a+t.length-1+n)}else a==-1&&(a=0,h.e.r=t.length-1+n);var u=i.header||[],d=0;t.forEach(function(p,x){Rt(p).forEach(function(E){(d=u.indexOf(E))==-1&&(u[d=u.length]=E);var F=p[E],O="z",V="",Z=Ge({c:o+d,r:a+x+n});l=ls(s,Z),F&&typeof F=="object"&&!(F instanceof Date)?s[Z]=F:(typeof F=="number"?O="n":typeof F=="boolean"?O="b":typeof F=="string"?O="s":F instanceof Date?(O="d",i.cellDates||(O="n",F=tr(F)),V=i.dateNF||it[14]):F===null&&i.nullError&&(O="e",F=0),l?(l.t=O,l.v=F,delete l.w,delete l.R,V&&(l.z=V)):s[Z]=l={t:O,v:F},V&&(l.z=V))})}),h.e.c=Math.max(h.e.c,o+u.length-1);var g=Lt(a);if(n)for(d=0;d<u.length;++d)s[Wt(d+o)+g]={t:"s",v:u[d]};return s["!ref"]=lt(h),s}function Dy(r,t){return Gh(null,r,t)}function ls(r,t,e){if(typeof t=="string"){if(Array.isArray(r)){var i=bt(t);return r[i.r]||(r[i.r]=[]),r[i.r][i.c]||(r[i.r][i.c]={t:"z"})}return r[t]||(r[t]={t:"z"})}return typeof t!="number"?ls(r,Ge(t)):ls(r,Ge({r:t,c:e||0}))}function My(r,t){if(typeof t=="number"){if(t>=0&&r.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=r.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Py(){return{SheetNames:[],Sheets:{}}}function Ly(r,t,e,i){var n=1;if(!e)for(;n<=65535&&r.SheetNames.indexOf(e="Sheet"+n)!=-1;++n,e=void 0);if(!e||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&r.SheetNames.indexOf(e)>=0){var s=e.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var a=s&&s[1]||e;for(++n;n<=65535&&r.SheetNames.indexOf(e=a+n)!=-1;++n);}if(Ph(e),r.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return r.SheetNames.push(e),r.Sheets[e]=t,e}function Ry(r,t,e){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var i=My(r,t);switch(r.Workbook.Sheets[i]||(r.Workbook.Sheets[i]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}r.Workbook.Sheets[i].Hidden=e}function Ny(r,t){return r.z=t,r}function Xh(r,t,e){return t?(r.l={Target:t},e&&(r.l.Tooltip=e)):delete r.l,r}function By(r,t,e){return Xh(r,"#"+t,e)}function Wy(r,t,e){r.c||(r.c=[]),r.c.push({t,a:e||"SheetJS"})}function Hy(r,t,e,i){for(var n=typeof t!="string"?t:Je(t),s=typeof t=="string"?t:lt(t),a=n.s.r;a<=n.e.r;++a)for(var o=n.s.c;o<=n.e.c;++o){var c=ls(r,a,o);c.t="n",c.F=s,delete c.v,a==n.s.r&&o==n.s.c&&(c.f=e,i&&(c.D=!0))}return r}var kr={encode_col:Wt,encode_row:Lt,encode_cell:Ge,encode_range:lt,decode_col:Lo,decode_row:Po,split_cell:tm,decode_cell:bt,decode_range:xr,format_cell:ni,sheet_add_aoa:X0,sheet_add_json:Gh,sheet_add_dom:Wh,aoa_to_sheet:Tn,json_to_sheet:Dy,table_to_sheet:Hh,table_to_book:hy,sheet_to_csv:jo,sheet_to_txt:zh,sheet_to_json:ha,sheet_to_html:Bh,sheet_to_formulae:Ay,sheet_to_row_object_array:ha,sheet_get_cell:ls,book_new:Py,book_append_sheet:Ly,book_set_sheet_visibility:Ry,cell_set_number_format:Ny,cell_set_hyperlink:Xh,cell_set_internal_link:By,cell_add_comment:Wy,sheet_set_array_formula:Hy,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var DT=rs.version;var ai=class r extends ye{constructor(){super(),this.xAxisData=[],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}}}}getChartType(){return"line"}getDefaultSeriesOptions(){return{name:"Line Chart",type:"line",smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",aggregateBy:n,sortBy:s,sortOrder:a="asc",limit:o,dateFormat:c}=t;try{let l=this.data.map(h=>({name:h[e]||"Unknown",value:parseFloat(h[i])||0,originalItem:h}));if(n){let h=new Map;l.forEach(f=>{let u=f.name;h.set(u,(h.get(u)||0)+f.value)}),l=Array.from(h.entries()).map(([f,u])=>({name:f,value:u,originalItem:null}))}s==="name"?l.sort((h,f)=>a==="asc"?h.name.localeCompare(f.name):f.name.localeCompare(h.name)):s==="value"&&l.sort((h,f)=>a==="asc"?h.value-f.value:f.value-h.value),o&&o>0&&(l=l.slice(0,o)),this.seriesOptions.data=l.map(h=>h.value),this.xAxisData.length===0&&(this.xAxisData=l.map(h=>h.name),this.setXAxisData(this.xAxisData))}catch(l){console.error("Error transforming line chart data:",l)}return this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis=j(k({},this.chartOptions.xAxis),{data:t}),this}setXAxisName(t){return this.chartOptions.xAxis=j(k({},this.chartOptions.xAxis),{name:t}),this}setYAxisName(t){return this.chartOptions.yAxis=j(k({},this.chartOptions.yAxis),{name:t}),this}setSmooth(t){return this.seriesOptions.smooth=t,this}setSymbol(t,e=6){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setLineStyle(t,e,i="solid"){return this.seriesOptions.lineStyle={width:t,color:e,type:i},this}setAreaStyle(t,e=.3){return this.seriesOptions.areaStyle={color:t,opacity:e},this}setShowSymbol(t){return this.seriesOptions.showSymbol=t,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&(this.setLineStyle(2,e[0]),this.seriesOptions.itemStyle=j(k({},this.seriesOptions.itemStyle),{color:e[0]})),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setValueFormatter(i),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setValueFormatter(e),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setValueFormatter(i),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=12){let e=[],i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=100;for(let s=0;s<Math.min(t,i.length);s++){let a=(Math.random()-.5)*20;n+=a,e.push({name:i[s],value:Math.round(n),date:i[s],category:["Revenue","Profit","Expenses"][Math.floor(Math.random()*3)]})}return this.setData(e)}setTrendAnalysisConfiguration(){return this.setSmooth(!0).setSymbol("circle",4).setLineStyle(3,"#5470c6").setAreaStyle("#5470c6",.1).setYAxisName("Value").setXAxisName("Time Period").setPredefinedPalette("finance").setTooltip("axis","{b}: {c}")}setPerformanceConfiguration(){return this.setSmooth(!1).setSymbol("diamond",6).setLineStyle(2,"#91cc75").setYAxisName("Performance Score").setXAxisName("Metrics").setPredefinedPalette("business").setTooltip("axis","{b}: {c}%")}setTimeSeriesConfiguration(){return this.setSmooth(!0).setSymbol("none",0).setLineStyle(2,"#fac858").setShowSymbol(!1).setYAxisName("Value").setXAxisName("Time").setPredefinedPalette("modern").setTooltip("axis","{b}: {c}")}build(){let t=j(k({},this.chartOptions),{series:[j(k({},this.seriesOptions),{type:"line"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>parseFloat(l.value)||0));let o=t.chartInstance.getOption(),c=j(k({},o),{series:[j(k({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating line chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isLineChart(t){return ye.isChartType(t,"line")}static createLineChartWidget(t,e){let i=r.create();return t&&i.setData(t),e&&i.setXAxisData(e),i.getWidgetBuilder()}static exportData(t){let e=[];if(t.echart_options?.series?.[0]?.data&&t.echart_options?.xAxis?.data){let i=t.echart_options.series[0].data,n=t.echart_options.xAxis.data;for(let s=0;s<i.length;s++){let a=i[s],o=n[s]||`Point ${s+1}`;e.push({Label:o,Value:a||0})}}return e}static getExportHeaders(t){return["Label","Value"]}static getExportSheetName(t){return"Line Chart Data"}};var kn=class r extends ye{constructor(){super(),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"item",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},polar:{center:["50%","50%"],radius:["30%","80%"],startAngle:0,endAngle:360},angleAxis:{type:"value",startAngle:0,endAngle:360,min:0,max:100,axisLabel:{color:"#666",fontSize:12}},radiusAxis:{type:"value",min:0,max:100,axisLabel:{color:"#666",fontSize:12}}}}getChartType(){return"line"}getDefaultSeriesOptions(){return{name:"Polar Chart",type:"line",coordinateSystem:"polar",smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.3},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setPolarCenter(t){return this.chartOptions.polar.center=t,this}setPolarRadius(t){return this.chartOptions.polar.radius=t,this}setStartAngle(t){return this.chartOptions.polar.startAngle=t,this.chartOptions.angleAxis.startAngle=t,this}setEndAngle(t){return this.chartOptions.polar.endAngle=t,this.chartOptions.angleAxis.endAngle=t,this}setAngleAxisRange(t,e){return this.chartOptions.angleAxis.min=t,this.chartOptions.angleAxis.max=e,this}setRadiusAxisRange(t,e){return this.chartOptions.radiusAxis.min=t,this.chartOptions.radiusAxis.max=e,this}setSmooth(t){return this.seriesOptions.smooth=t,this}setSymbol(t,e=6){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setLineStyle(t,e,i="solid"){return this.seriesOptions.lineStyle={width:t,color:e,type:i},this}setItemStyle(t,e,i){return this.seriesOptions.itemStyle={color:t,borderColor:e,borderWidth:i},this}setAreaStyle(t,e=.3){return this.seriesOptions.areaStyle={color:t,opacity:e},this}setGradientAreaStyle(t,e,i=.3){return this.seriesOptions.areaStyle={color:{type:"radial",x:.5,y:.5,r:.5,colorStops:[{offset:0,color:t},{offset:1,color:e}]},opacity:i},this}setShowSymbol(t){return this.seriesOptions.showSymbol=t,this}setStack(t){return this.seriesOptions.stack=t,this}setSampling(t){return this.seriesOptions.sampling=t,this}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{valueField:e="value",nameField:i="name",categoryField:n="category",sortBy:s,sortOrder:a="desc",limit:o}=t;try{let c=[],l=this.data;t.filters&&t.filters.length>0&&(l=ye.applyFilters(this.data,t.filters)),l.forEach(h=>{let f=parseFloat(h[e])||0;c.push(f)}),s==="value"&&c.sort((h,f)=>a==="asc"?h-f:f-h),o&&o>0&&(c=c.slice(0,o)),this.seriesOptions.data=c}catch(c){console.error("Error transforming polar chart data:",c)}return this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&(this.setItemStyle(e[0]),this.setLineStyle(2,e[0])),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("item",n=>`${n.seriesName}: ${i(n.value)}`),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("item",i=>`${i.seriesName}: ${e(i.value)}`),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("item",n=>`${n.seriesName}: ${i(n.value)}`),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=8){let e=[];for(let i=0;i<t;i++)e.push({value:Math.floor(Math.random()*100)+10,name:`Metric ${i+1}`,angle:360/t*i,category:["Performance","Quality","Efficiency"][Math.floor(Math.random()*3)],department:["Sales","Marketing","Operations"][Math.floor(Math.random()*3)]});return this.setData(e)}setPerformanceMetricsConfiguration(){return this.setPredefinedPalette("business").setPercentageFormatter(1).setPolarRadius(["20%","80%"]).setAreaStyle("#5470c6",.3).setSmooth(!0)}setRadarAnalysisConfiguration(){return this.setPredefinedPalette("finance").setCustomNumberFormatter(0,"en-US").setPolarRadius(["30%","90%"]).setLineStyle(3,"#91cc75","solid").setSymbol("circle",6)}set360ViewConfiguration(){return this.setPredefinedPalette("modern").setCurrencyFormatter("USD","en-US").setPolarRadius(["10%","95%"]).setStartAngle(0).setEndAngle(360).setAreaStyle("#ee6666",.4)}build(){return this.chartOptions.series=[this.seriesOptions],this.widgetBuilder.setEChartsOptions(this.chartOptions),this.widgetBuilder.build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>parseFloat(l.value)||0));let o=t.chartInstance.getOption(),c=j(k({},o),{series:[j(k({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating polar chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isPolarChart(t){return t.config?.options?.series?.[0]?.coordinateSystem==="polar"}static createPolarChartWidget(t){return new Jt().setComponent("echart").setEChartsOptions({grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"item",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},polar:{center:["50%","50%"],radius:["30%","80%"],startAngle:0,endAngle:360},angleAxis:{type:"value",startAngle:0,endAngle:360,min:0,max:100,axisLabel:{color:"#666",fontSize:12}},radiusAxis:{type:"value",min:0,max:100,axisLabel:{color:"#666",fontSize:12}},series:[{name:"Polar Chart",type:"line",coordinateSystem:"polar",data:t||[],smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.3},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}static exportData(t){if(!r.isPolarChart(t))return[];let i=t.config?.options?.series;if(!i||i.length===0)return[];let n=[];return i.forEach((s,a)=>{s.data&&s.data.forEach((o,c)=>{a===0&&(n[c]=[`Point ${c+1}`]),n[c]&&n[c].push(o||0)})}),n}static getExportHeaders(t){let i=t.config?.options?.series;return!i||i.length===0?["Angle"]:["Angle",...i.map(n=>n.name||"Series")]}static getExportSheetName(t){return`PolarChart_${(t.config?.header?.title||"Polar Chart").replace(/[^a-zA-Z0-9]/g,"_")}`}};var In=class r extends ye{constructor(){super(),this.xAxisData=[],this.multiSeriesData=[],this.colors=["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4"],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}}}}getChartType(){return"line"}getDefaultSeriesOptions(){return{name:"Stacked Area",type:"line",smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.6,origin:"auto"},stack:"total",emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}setMultiSeriesData(t){return this.multiSeriesData=t,this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{seriesField:e="series",valueField:i="value",categoryField:n="category",timeField:s="time",sortBy:a,sortOrder:o="asc",limit:c}=t;try{let l=this.data;t.filters&&t.filters.length>0&&(l=ye.applyFilters(this.data,t.filters));let h=new Map,f=new Set;l.forEach(g=>{let p=g[e]||"Default",x=g[n]||g[s]||"Unknown",E=parseFloat(g[i])||0;h.has(p)||h.set(p,new Map),h.get(p).set(x,(h.get(p).get(x)||0)+E),f.add(x)});let u=Array.from(f).sort();this.setXAxisData(u);let d=[];h.forEach((g,p)=>{let x=u.map(E=>g.get(E)||0);d.push({name:p,data:x})}),a==="total"&&d.sort((g,p)=>{let x=g.data.reduce((F,O)=>F+O,0),E=p.data.reduce((F,O)=>F+O,0);return o==="asc"?x-E:E-x}),c&&c>0&&d.splice(c),this.setMultiSeriesData(d)}catch(l){console.error("Error transforming stacked area chart data:",l)}return this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis.data=t,this}setXAxisName(t){return this.chartOptions.xAxis.name=t,this}setYAxisName(t){return this.chartOptions.yAxis.name=t,this}setSmooth(t){return this.seriesOptions.smooth=t,this}setSymbol(t,e=6){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setLineStyle(t,e,i="solid"){return this.seriesOptions.lineStyle={width:t,color:e,type:i},this}setItemStyle(t,e,i){return this.seriesOptions.itemStyle={color:t,borderColor:e,borderWidth:i},this}setAreaStyle(t,e=.6){return this.seriesOptions.areaStyle={color:t,opacity:e,origin:"auto"},this}setGradientAreaStyle(t,e,i=.6){return this.seriesOptions.areaStyle={color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:t},{offset:1,color:e}]},opacity:i,origin:"auto"},this}setShowSymbol(t){return this.seriesOptions.showSymbol=t,this}setStack(t){return this.seriesOptions.stack=t,this}setSampling(t){return this.seriesOptions.sampling=t,this}setColors(t){return this.colors=t,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&this.setColors(e),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("axis",n=>{if(!Array.isArray(n))return"";let s=`${n[0].name}<br/>`;return n.forEach(a=>{s+=`${a.seriesName}: ${i(a.value)}<br/>`}),s}),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("axis",i=>{if(!Array.isArray(i))return"";let n=`${i[0].name}<br/>`;return i.forEach(s=>{n+=`${s.seriesName}: ${e(s.value)}<br/>`}),n}),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("axis",n=>{if(!Array.isArray(n))return"";let s=`${n[0].name}<br/>`;return n.forEach(a=>{s+=`${a.seriesName}: ${i(a.value)}<br/>`}),s}),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=3,e=7){let i=[],n=["Revenue","Expenses","Profit","Investment","Savings"].slice(0,t),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].slice(0,e);for(let a of n){let o=[];for(let c=0;c<e;c++)o.push(Math.floor(Math.random()*200)+50);i.push({name:a,data:o,category:["Primary","Secondary","Tertiary"][Math.floor(Math.random()*3)]})}return this.setMultiSeriesData(i),this.setXAxisData(s),this}setFinancialAnalysisConfiguration(){return this.setPredefinedPalette("finance").setCurrencyFormatter("USD","en-US").setXAxisName("Time Period").setYAxisName("Amount").setStack("financial").setSmooth(!0)}setPerformanceMonitoringConfiguration(){return this.setPredefinedPalette("business").setPercentageFormatter(1).setXAxisName("Metrics").setYAxisName("Performance").setStack("performance").setAreaStyle("#5470c6",.5)}setTrendAnalysisConfiguration(){return this.setPredefinedPalette("modern").setCustomNumberFormatter(0,"en-US").setXAxisName("Period").setYAxisName("Value").setStack("trend").setSmooth(!1).setSymbol("circle",4)}build(){let t=[];return this.multiSeriesData.length>0?this.multiSeriesData.forEach((e,i)=>{let n=j(k({},this.seriesOptions),{name:e.name,data:e.data,itemStyle:{color:this.colors[i%this.colors.length]},areaStyle:{color:this.colors[i%this.colors.length],opacity:.6,origin:"auto"},lineStyle:{width:2,color:this.colors[i%this.colors.length],type:"solid"}});t.push(n)}):t.push(this.seriesOptions),this.chartOptions.series=t,this.widgetBuilder.setEChartsOptions(this.chartOptions),this.widgetBuilder.build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>({name:l.name||"Series",data:l.data||[],type:"line",stack:"total",areaStyle:{}})));let o=t.chartInstance.getOption(),c=j(k({},o),{series:a});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating stacked area chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isStackedAreaChart(t){let e=t.config?.options;return e?.series?.[0]?.type==="line"&&e?.series?.[0]?.areaStyle&&e?.series?.[0]?.stack}static createStackedAreaChartWidget(t,e){let i=["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4"],n=[];return t&&t.length>0&&t.forEach((a,o)=>{n.push({name:a.name,type:"line",data:a.data,smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:i[o%i.length],type:"solid"},itemStyle:{color:i[o%i.length]},areaStyle:{color:i[o%i.length],opacity:.6,origin:"auto"},stack:"total",emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}})}),new Jt().setComponent("echart").setEChartsOptions({grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:e||[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}},series:n})}static exportData(t){if(!r.isStackedAreaChart(t))return[];let e=t.config?.options,i=e?.series,n=e?.xAxis;if(!i||i.length===0)return[];let s=[];n&&(Array.isArray(n)?s=n[0]?.data||[]:n.data&&(s=n.data)),s.length===0&&i[0]?.data&&(s=i[0].data.map((o,c)=>`Point ${c+1}`));let a=[];return i.forEach((o,c)=>{o.data&&o.data.forEach((l,h)=>{c===0&&(a[h]=[s[h]||`Point ${h+1}`]),a[h]&&a[h].push(l||0)})}),a}static getExportHeaders(t){let i=t.config?.options?.series;return!i||i.length===0?["Category"]:["Category",...i.map(n=>n.name||"Series")]}static getExportSheetName(t){return`StackedAreaChart_${(t.config?.header?.title||"Stacked Area Chart").replace(/[^a-zA-Z0-9]/g,"_")}`}};var Fn=class r extends ye{constructor(){super(),this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{tooltip:{trigger:"item",formatter:"{b}: {c}"},series:[]}}getChartType(){return"treemap"}getDefaultSeriesOptions(){return{name:"Treemap Chart",type:"treemap",breadcrumb:{show:!0,top:"10%",left:"10%",right:"10%",bottom:"10%"},itemStyle:{borderColor:"#fff",borderWidth:1,gapWidth:1},label:{show:!0,formatter:"{b}",fontSize:12,color:"#333"},levels:[{itemStyle:{borderColor:"#777",borderWidth:0,gapWidth:1},label:{show:!1}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},label:{show:!0}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},label:{show:!0}}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},roam:!0,nodeClick:"zoomToNode"}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setBreadcrumb(t,e,i,n,s){return this.seriesOptions.breadcrumb={show:t,top:e,left:i,right:n,bottom:s},this}setItemStyle(t,e,i){return this.seriesOptions.itemStyle={borderColor:t,borderWidth:e,gapWidth:i},this}setLabelFormatter(t){return this.seriesOptions.label||(this.seriesOptions.label={}),this.seriesOptions.label.formatter=t,this}setLevels(t){return this.seriesOptions.levels=t,this}setRoam(t){return this.seriesOptions.roam=t,this}setNodeClick(t){return this.seriesOptions.nodeClick=t,this}setSize(t,e){return this.seriesOptions.width=t,this.seriesOptions.height=e,this}build(){let t=j(k({},this.chartOptions),{series:[j(k({},this.seriesOptions),{type:"treemap"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e,i){ye.updateData(t,e,i)}static transformToTreemapData(t,e){if(!t||t.length===0)return[];let i=e?.valueField||"value",n=e?.nameField||"name",s=e?.childrenField||"children",a=e?.maxDepth||3,o=e?.minValue||0,c=(l,h)=>{let f={name:String(l[n])||"Unknown",value:Number(l[i])||0};return f.value<o||h<a&&l[s]&&Array.isArray(l[s])&&(f.children=l[s].map(u=>c(u,h+1)).filter(u=>u.value>=o)),f};return t.map(l=>c(l,0))}static createHierarchyFromFlat(t,e){let{idField:i,parentField:n,valueField:s,nameField:a}=e,o=new Map,c=[];return t.forEach(l=>{let h={name:String(l[a])||"Unknown",value:Number(l[s])||0,children:[]};o.set(l[i],h)}),t.forEach(l=>{let h=o.get(l[i]);if(!h)return;let f=l[n];if(f&&o.has(f)){let u=o.get(f);u&&u.children&&u.children.push(h)}else c.push(h)}),c}setFinancialDisplay(t="USD",e="en-US"){this.setCurrencyFormatter(t,e);let i=new Intl.NumberFormat(e,{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0});return this.setLabelFormatter(n=>`${n.data.name}
${i.format(n.data.value)}`),this}setPercentageDisplay(t=1){return this.setPercentageFormatter(t),this.setLabelFormatter(e=>`${e.data.name}
${e.data.value.toFixed(t)}%`),this}setZoomBehavior(t=!0,e="zoomToNode",i=!0){return this.setRoam(i),e&&this.setNodeClick(e),this}setPortfolioConfiguration(){return this.setBreadcrumb(!0,"10%","10%","10%","10%").setItemStyle("#fff",1,1).setLevels([{itemStyle:{borderColor:"#777",borderWidth:0,gapWidth:1},label:{show:!1}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},label:{show:!0,formatter:`{b}
{c}%`}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},label:{show:!0,formatter:`{b}
{c}%`}}]).setEmphasis(10,0,"rgba(0, 0, 0, 0.5)").setZoomBehavior(!0,"zoomToNode",!0)}setExpenseConfiguration(){return this.setBreadcrumb(!0,"10%","10%","10%","10%").setItemStyle("#fff",1,1).setLevels([{itemStyle:{borderColor:"#777",borderWidth:0,gapWidth:1},label:{show:!1}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},label:{show:!0,formatter:"{b}\n${c}K"}},{itemStyle:{borderColor:"#555",borderWidth:5,gapWidth:1},label:{show:!0,formatter:"{b}\n${c}K"}}]).setEmphasis(10,0,"rgba(0, 0, 0, 0.5)").setZoomBehavior(!0,"zoomToNode",!0)}static isTreemapChart(t){return ye.isChartType(t,"treemap")}static createTreemapChartWidget(t){let e=new r;return t&&e.setData(t),e.widgetBuilder}static exportData(t){let e=t.echartsOptions;if(!e||!e.series||!e.series[0]||!e.series[0].data)return[];let i=e.series[0].data;return this.flattenTreemapData(i)}static getExportHeaders(t){return["Name","Value","Level"]}static getExportSheetName(t){return"Treemap Data"}static flattenTreemapData(t,e=0){let i=[];for(let n of t)i.push({name:n.name,value:n.value,level:e}),n.children&&n.children.length>0&&i.push(...this.flattenTreemapData(n.children,e+1));return i}};var On=class r extends ye{constructor(){super(),this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{tooltip:{trigger:"item",formatter:"{b}: {c}"},legend:{show:!0,orient:"vertical",left:"left",top:"middle"}}}getChartType(){return"sunburst"}getDefaultSeriesOptions(){return{name:"Sunburst Chart",type:"sunburst",radius:["20%","90%"],center:["50%","50%"],itemStyle:{borderWidth:2,borderColor:"#fff"},label:{show:!0,formatter:"{b}",position:"inside",fontSize:12,color:"#fff",rotate:"radial"},levels:[{itemStyle:{borderWidth:2,borderColor:"#777"}},{itemStyle:{borderWidth:1,borderColor:"#555"}},{itemStyle:{borderWidth:1,borderColor:"#333"}}],sort:"desc",animationDuration:1e3,animationEasing:"cubicOut"}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setRadius(t){return this.seriesOptions.radius=t,this}setCenter(t){return this.seriesOptions.center=t,this}setLevels(t){return this.seriesOptions.levels=t,this}setSort(t){return this.seriesOptions.sort=t,this}setAnimationDuration(t){return this.seriesOptions.animationDuration=t,this}setAnimationEasing(t){return this.seriesOptions.animationEasing=t,this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>0&&this.setLevels([{itemStyle:{color:e[0]}},{itemStyle:{color:e[1]||e[0]}},{itemStyle:{color:e[2]||e[0]}}]),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("item",n=>`${n.data.name}: ${i(n.data.value)}`),this}setPercentageFormatter(t=1){let e=this.createPercentageFormatter(t);return this.setTooltip("item",i=>`${i.data.name}: ${e(i.data.value)}`),this}setCustomNumberFormatter(t=0,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("item",n=>`${n.data.name}: ${i(n.data.value)}`),this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(){let t=[{name:"Technology",value:100,children:[{name:"Software",value:60,children:[{name:"Frontend",value:30},{name:"Backend",value:30}]},{name:"Hardware",value:40,children:[{name:"Servers",value:25},{name:"Devices",value:15}]}]},{name:"Marketing",value:80,children:[{name:"Digital",value:50},{name:"Traditional",value:30}]},{name:"Operations",value:70,children:[{name:"Logistics",value:40},{name:"Support",value:30}]}];return this.setData(t)}setOrganizationalStructureConfiguration(){return this.setPredefinedPalette("business").setCustomNumberFormatter(0,"en-US").setRadius(["15%","85%"]).setLabelFormatter("{b}").setSort("desc")}setBudgetAllocationConfiguration(){return this.setPredefinedPalette("finance").setCurrencyFormatter("USD","en-US").setRadius(["20%","90%"]).setLabelFormatter("{b}: {c}").setSort("desc")}setCategoryAnalysisConfiguration(){return this.setPredefinedPalette("modern").setPercentageFormatter(1).setRadius(["25%","95%"]).setLabelFormatter("{b}").setSort("desc")}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{nameField:e="name",valueField:i="value",parentField:n="parent",levelField:s="level",categoryField:a="category",sortBy:o,sortOrder:c="desc",limit:l}=t;try{let h=this.data;t.filters&&t.filters.length>0&&(h=ye.applyFilters(this.data,t.filters));let f=this.buildHierarchy(h,e,i,n,s);o==="value"&&this.sortHierarchy(f,c),l&&l>0&&f.length>l&&f.splice(l),this.seriesOptions.data=f}catch(h){console.error("Error transforming sunburst chart data:",h)}return this}buildHierarchy(t,e,i,n,s){let a=new Map,o=[];return t.forEach(c=>{let l=c[e]||"Unknown",h=parseFloat(c[i])||0,f=c[n],u={name:l,value:h,children:[]};a.set(l,u),f||o.push(u)}),t.forEach(c=>{let l=c[e]||"Unknown",h=c[n];if(h&&a.has(h)&&a.has(l)){let f=a.get(h),u=a.get(l);f.children||(f.children=[]),f.children.push(u)}}),o}sortHierarchy(t,e){t.sort((i,n)=>{let s=i.value||0,a=n.value||0;return e==="asc"?s-a:a-s}),t.forEach(i=>{i.children&&i.children.length>0&&this.sortHierarchy(i.children,e)})}build(){let t=j(k({},this.chartOptions),{series:[j(k({},this.seriesOptions),{type:"sunburst"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>({name:l.name||"Unknown",value:parseFloat(l.value)||0,children:l.children||[]})));let o=t.chartInstance.getOption(),c=j(k({},o),{series:[j(k({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating sunburst chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isSunburstChart(t){return ye.isChartType(t,"sunburst")}static createSunburstChartWidget(t){return r.create().setData(t||[]).setHeader("Sunburst Chart").setPosition({x:0,y:0,cols:4,rows:4}).getWidgetBuilder()}static exportData(t){let e=t.data||[],i=[],n=(s,a=0,o="")=>{s.forEach(c=>{i.push({Level:a,Parent:o,Name:c.name,Value:c.value||0}),c.children&&c.children.length>0&&n(c.children,a+1,c.name)})};return n(e),i}static getExportHeaders(t){return["Level","Parent","Name","Value"]}static getExportSheetName(t){return(t.config?.header?.title||"Sunburst Chart").replace(/[^a-zA-Z0-9\s]/g,"").substring(0,31)}};var An=class r extends ye{constructor(){super(),this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{tooltip:{trigger:"item",triggerOn:"mousemove",formatter:"{b}: {c}"},legend:{show:!1}}}getChartType(){return"sankey"}getDefaultSeriesOptions(){return{name:"Sankey Chart",type:"sankey",emphasis:{focus:"adjacency"},lineStyle:{color:"source",curveness:.5}}}setData(t){return this.seriesOptions.data=t.nodes,this.seriesOptions.links=t.links,super.setData(t),this}setNodeWidth(t){return this.seriesOptions.nodeWidth=t,this}setNodeGap(t){return this.seriesOptions.nodeGap=t,this}setNodeAlign(t){return this.seriesOptions.nodeAlign=t,this}setLayoutIterations(t){return this.seriesOptions.layoutIterations=t,this}setLayout(t){return this.seriesOptions.layout=t,this}setCurveness(t){return this.seriesOptions.lineStyle||(this.seriesOptions.lineStyle={}),this.seriesOptions.lineStyle.curveness=t,this}setLineColor(t){return this.seriesOptions.lineStyle||(this.seriesOptions.lineStyle={}),this.seriesOptions.lineStyle.color=t,this}setNodeColors(t){return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.color=t,this}setEmphasisFocus(t){return this.seriesOptions.emphasis||(this.seriesOptions.emphasis={}),this.seriesOptions.emphasis.focus=t,this}build(){let t=this.seriesOptions.data?.nodes,e=this.seriesOptions.data?.links,i=j(k({},this.chartOptions),{series:[j(k({},this.seriesOptions),{type:"sankey",data:t,links:e})]});return this.widgetBuilder.setEChartsOptions(i).build()}static updateData(t,e,i){t.config?.options?.series?.[0]&&(t.config.options.series[0].data=e.nodes,t.config.options.series[0].links=e.links),t.data=e,ye.updateData(t,e,i)}static transformToSankeyData(t,e){if(!t||t.length===0)return{nodes:[],links:[]};let i=e?.sourceField||"source",n=e?.targetField||"target",s=e?.valueField||"value",a=e?.aggregateBy||"sum",o=new Set;t.forEach(f=>{o.add(String(f[i])),o.add(String(f[n]))});let c=Array.from(o).map(f=>({name:f})),l=new Map;t.forEach(f=>{let u=String(f[i]),d=String(f[n]),g=Number(f[s])||1,p=`${u}->${d}`;if(l.has(p)){let x=l.get(p);l.set(p,a==="sum"?x+g:x+1)}else l.set(p,a==="sum"?g:1)});let h=Array.from(l.entries()).map(([f,u])=>{let[d,g]=f.split("->");return{source:d,target:g,value:u}});return{nodes:c,links:h}}setFinancialFlow(){return this.setNodeWidth(20).setNodeGap(8).setLayout("left").setCurveness(.5).setEmphasisFocus("adjacency").setNodeColors(["#5470c6","#91cc75","#fac858","#ee6666","#73c0de"])}setBudgetAllocation(){return this.setNodeWidth(15).setNodeGap(10).setLayout("left").setCurveness(.4).setEmphasisFocus("adjacency").setNodeColors(["#2E8B57","#4682B4","#DAA520","#DC143C","#9370DB"])}setInvestmentFlow(){return this.setNodeWidth(25).setNodeGap(12).setLayout("left").setCurveness(.3).setEmphasisFocus("adjacency").setNodeColors(["#667eea","#764ba2","#f093fb","#f5576c","#4facfe"])}setPercentageDisplay(){return this.setTooltip("item",t=>t.data.source?`${t.data.source} \u2192 ${t.data.target}<br/>Value: ${t.data.value}%`:`${t.data.name}<br/>Total: ${t.data.value||0}%`),this}setCurrencyDisplay(t="USD",e="en-US"){let i=new Intl.NumberFormat(e,{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0});return this.setTooltip("item",n=>n.data.source?`${n.data.source} \u2192 ${n.data.target}<br/>Amount: ${i.format(n.data.value)}`:`${n.data.name}<br/>Total: ${i.format(n.data.value||0)}`),this}setMinimalConfiguration(){return this.setNodeWidth(10).setNodeGap(5).setLayout("none").setCurveness(.5).setEmphasisFocus("adjacency")}static isSankeyChart(t){return t.config?.component==="echart"&&t.config?.options?.series?.[0]?.type==="sankey"}static exportData(t){let e=t.data;return!e||!e.links?[]:e.links.map(i=>({Source:i.source,Target:i.target,Value:i.value}))}static getExportHeaders(t){return["Source","Target","Value"]}static getExportSheetName(t){return(t.config?.header?.title||"Sankey Chart").replace(/[^a-zA-Z0-9\s]/g,"").substring(0,31)}};var jh=class r extends ye{constructor(){super(),this.xAxisData=[],this.filterColumn="",this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:t=>{let e=Array.isArray(t)?t[0]:t,i=e.data;return`${e.name}<br/>
                  Open: ${i[1]}<br/>
                  Close: ${i[2]}<br/>
                  Low: ${i[3]}<br/>
                  High: ${i[4]}`}},xAxis:{type:"category",data:[]},yAxis:{type:"value",scale:!0}}}getChartType(){return"candlestick"}getDefaultSeriesOptions(){return{name:"Candlestick",type:"candlestick",data:[],itemStyle:{color:"#ec0000",color0:"#00da3c",borderColor:"#8A0000",borderColor0:"#008F28",borderWidth:1}}}transformData(t={}){if(!this.data||!Array.isArray(this.data))return this;let{dateField:e="date",openField:i="open",closeField:n="close",lowField:s="low",highField:a="high",sortBy:o,sortOrder:c="asc",limit:l}=t;try{let h=[],f=[],u=this.data;if(t.filters&&t.filters.length>0&&(u=ye.applyFilters(this.data,t.filters)),u.forEach(d=>{let g=d[e],p=parseFloat(d[i])||0,x=parseFloat(d[n])||0,E=parseFloat(d[s])||0,F=parseFloat(d[a])||0;f.push(g),h.push([p,x,E,F])}),o==="date"){let d=f.map((g,p)=>({label:g,data:h[p]}));d.sort((g,p)=>{let x=new Date(g.label).getTime(),E=new Date(p.label).getTime();return c==="asc"?x-E:E-x}),f=d.map(g=>g.label),h=d.map(g=>g.data)}l&&l>0&&(f=f.slice(0,l),h=h.slice(0,l)),this.seriesOptions.data=h,this.setXAxisData(f)}catch(h){console.error("Error transforming candlestick chart data:",h)}return this}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis=j(k({},this.chartOptions.xAxis),{data:t}),this}setXAxisName(t){return this.chartOptions.xAxis=j(k({},this.chartOptions.xAxis),{name:t}),this}setYAxisName(t){return this.chartOptions.yAxis=j(k({},this.chartOptions.yAxis),{name:t}),this}setPredefinedPalette(t){let e=this.getPaletteColors(t);return e.length>=2&&(this.seriesOptions.itemStyle=j(k({},this.seriesOptions.itemStyle),{color:e[0],color0:e[1],borderColor:e[0],borderColor0:e[1]})),this}setCurrencyFormatter(t="USD",e="en-US"){let i=this.createCurrencyFormatter(t,e);return this.setTooltip("axis",n=>{let s=Array.isArray(n)?n[0]:n,a=s.data;return`${s.name}<br/>
              Open: ${i(a[1])}<br/>
              Close: ${i(a[2])}<br/>
              Low: ${i(a[3])}<br/>
              High: ${i(a[4])}`}),this}setPercentageFormatter(t=2){let e=this.createPercentageFormatter(t);return this.setTooltip("axis",i=>{let n=Array.isArray(i)?i[0]:i,s=n.data;return`${n.name}<br/>
              Open: ${e(s[1])}<br/>
              Close: ${e(s[2])}<br/>
              Low: ${e(s[3])}<br/>
              High: ${e(s[4])}`}),this}setCustomNumberFormatter(t=2,e="en-US"){let i=this.createNumberFormatter(t,e);return this.setTooltip("axis",n=>{let s=Array.isArray(n)?n[0]:n,a=s.data;return`${s.name}<br/>
              Open: ${i(a[1])}<br/>
              Close: ${i(a[2])}<br/>
              Low: ${i(a[3])}<br/>
              High: ${i(a[4])}`}),this}setBorderColors(t,e){return this.seriesOptions.itemStyle||(this.seriesOptions.itemStyle={}),this.seriesOptions.itemStyle.borderColor=t,this.seriesOptions.itemStyle.borderColor0=e,this}setFilterColumn(t){return this.filterColumn=t,this}createFilterFromChartData(){if(!this.filterColumn||!this.data)return[];let t=[...new Set(this.data.map(e=>e[this.filterColumn]))];return[{column:this.filterColumn,operator:"in",value:t}]}generateSampleData(t=30){let e=[],i=100;for(let n=0;n<t;n++){let s=new Date;s.setDate(s.getDate()-(t-n));let a=i,o=(Math.random()-.5)*10,c=Math.max(.1,a+o),l=Math.max(a,c)+Math.random()*5,h=Math.min(a,c)-Math.random()*5;e.push({date:s.toISOString().split("T")[0],open:parseFloat(a.toFixed(2)),close:parseFloat(c.toFixed(2)),high:parseFloat(l.toFixed(2)),low:parseFloat(h.toFixed(2)),volume:Math.floor(Math.random()*1e6),symbol:"SAMPLE"}),i=c}return this.setData(e)}setStockAnalysisConfiguration(){return this.setPredefinedPalette("finance").setXAxisName("Date").setYAxisName("Price").setCurrencyFormatter("USD","en-US").setTooltip("axis")}setCryptoAnalysisConfiguration(){return this.setPredefinedPalette("modern").setXAxisName("Date").setYAxisName("Price (USD)").setCurrencyFormatter("USD","en-US")}setForexAnalysisConfiguration(){return this.setPredefinedPalette("business").setXAxisName("Date").setYAxisName("Exchange Rate").setCustomNumberFormatter(4,"en-US")}build(){let t=j(k({},this.chartOptions),{series:[j(k({},this.seriesOptions),{type:"candlestick"})]});return this.widgetBuilder.setEChartsOptions(t).build()}static updateData(t,e){let n=0,s=()=>{try{if(t.chartInstance){let a=e;Array.isArray(e)&&e.length>0&&typeof e[0]=="object"&&(a=e.map(l=>[parseFloat(l.open)||0,parseFloat(l.close)||0,parseFloat(l.low)||0,parseFloat(l.high)||0]));let o=t.chartInstance.getOption(),c=j(k({},o),{series:[j(k({},o.series[0]),{data:a})]});t.chartInstance.setOption(c,!0)}else n<3&&(n++,setTimeout(s,100*n))}catch(a){console.error("Error updating candlestick chart data:",a),n<3&&(n++,setTimeout(s,100*n))}};s()}static isCandlestickChart(t){return ye.isChartType(t,"candlestick")}static exportData(t){let e=[];if(t.echart_options?.series?.[0]?.data&&t.echart_options?.xAxis?.data){let i=t.echart_options.series[0].data,n=t.echart_options.xAxis.data;i.forEach((s,a)=>{e.push({Date:n[a]||`Day ${a+1}`,Open:s[0]||0,Close:s[1]||0,Low:s[2]||0,High:s[3]||0})})}return e}static getExportHeaders(t){return["Date","Open","Close","Low","High"]}static getExportSheetName(t){return"Candlestick Chart Data"}};var ya=(()=>{let t=class t{exportDashboardToExcel(s){return kt(this,arguments,function*(i,n={}){let{filename:a=`dashboard-export-${new Date().toISOString().split("T")[0]}.xlsx`,includeHeaders:o=!0,includeTimestamp:c=!0,sheetNamePrefix:l="Widget",autoColumnWidth:h=!0,includeWidgetTitles:f=!0}=n;try{let u=kr.book_new();c&&this.addTimestampSheet(u);for(let d of i)try{yield this.exportWidgetToSheet(u,d,{includeHeaders:o,sheetNamePrefix:l,autoColumnWidth:h,includeWidgetTitles:f})}catch(g){console.error(`Error exporting widget ${d.id} to Excel:`,g)}Xo(u,a)}catch(u){throw console.error("Error exporting dashboard to Excel:",u),new Error("Failed to export dashboard to Excel")}})}exportWidgetToSheet(i,n,s){return kt(this,null,function*(){let{includeHeaders:a,sheetNamePrefix:o,autoColumnWidth:c,includeWidgetTitles:l}=s,h=this.getDataExtractor(n);if(!h){console.warn(`No data extractor found for widget type: ${n.config?.component}`);return}try{let f=h.extractData(n),u=h.getHeaders(n),d=h.getSheetName(n);if(!f||f.length===0){console.warn(`No data found for widget: ${n.id}`);let x=[[n.config?.header?.title||"Widget Data"],[],["No data available for export"],["Widget ID:",n.id],["Component:",n.config?.component||"Unknown"],["Export Time:",new Date().toLocaleString()]],E=kr.aoa_to_sheet(x);kr.book_append_sheet(i,E,d);return}let g=[];l&&n.config?.header?.title&&(g.push([n.config.header.title]),g.push([])),a&&u.length>0&&g.push(u),g=g.concat(f);let p=kr.aoa_to_sheet(g);c&&this.autoResizeColumns(p,g),kr.book_append_sheet(i,p,d)}catch(f){console.error(`Error processing widget ${n.id}:`,f);let u=[[n.config?.header?.title||"Widget Data"],[],["Error occurred during export"],["Widget ID:",n.id],["Component:",n.config?.component||"Unknown"],["Error:",f instanceof Error?f.message:String(f)],["Export Time:",new Date().toLocaleString()]],d=kr.aoa_to_sheet(u),g=this.getErrorSheetName(n);kr.book_append_sheet(i,d,g)}})}addTimestampSheet(i){let n=new Date().toLocaleString(),s=[["Dashboard Export Information"],[],["Export Date:",n],["Generated by:","MoneyPlant Dashboard"],["Total Sheets:","Multiple"],["Export Type:","Dashboard Data Export"]],a=kr.aoa_to_sheet(s);kr.book_append_sheet(i,a,"Export Info")}autoResizeColumns(i,n){if(!n||n.length===0)return;let s=Math.max(...n.map(a=>a.length));for(let a=0;a<s;a++){let o=10;for(let l of n)if(l[a]!==void 0){let h=String(l[a]);o=Math.max(o,h.length)}let c=kr.encode_col(a);i["!cols"]=i["!cols"]||[],i["!cols"][a]={width:Math.min(o+2,50)}}}getDataExtractor(i){let n=i.config?.component,s=i.config?.options?.series?.[0]?.type;return n==="echart"&&s?this.getChartDataExtractor(s):n==="table"?{extractData:a=>a.config?.options?.data||[],getHeaders:a=>a.config?.options?.columns||[],getSheetName:a=>this.getWidgetSheetName(a,"Table")}:n==="tile"?{extractData:a=>{let o=a.config?.options;return[[o?.value||"",o?.change||"",o?.changeType||"",o?.description||""]]},getHeaders:()=>["Value","Change","Type","Description"],getSheetName:a=>this.getWidgetSheetName(a,"Tile")}:this.getGenericDataExtractor()}getChartDataExtractor(i){switch(i.toLowerCase()){case"pie":return{extractData:n=>rn.exportData(n),getHeaders:n=>rn.getExportHeaders(n),getSheetName:n=>rn.getExportSheetName(n)};case"bar":return{extractData:n=>nn.exportData(n),getHeaders:n=>nn.getExportHeaders(n),getSheetName:n=>nn.getExportSheetName(n)};case"line":return{extractData:n=>ai.exportData(n),getHeaders:n=>ai.getExportHeaders(n),getSheetName:n=>ai.getExportSheetName(n)};case"scatter":return{extractData:n=>sn.exportData(n),getHeaders:n=>sn.getExportHeaders(n),getSheetName:n=>sn.getExportSheetName(n)};case"gauge":return{extractData:n=>an.exportData(n),getHeaders:n=>an.getExportHeaders(n),getSheetName:n=>an.getExportSheetName(n)};case"heatmap":return{extractData:n=>on.exportData(n),getHeaders:n=>on.getExportHeaders(n),getSheetName:n=>on.getExportSheetName(n)};case"map":return{extractData:n=>ln.exportData(n),getHeaders:n=>ln.getExportHeaders(n),getSheetName:n=>ln.getExportSheetName(n)};case"treemap":return{extractData:n=>Fn.exportData(n),getHeaders:n=>Fn.getExportHeaders(n),getSheetName:n=>Fn.getExportSheetName(n)};case"sunburst":return{extractData:n=>On.exportData(n),getHeaders:n=>On.getExportHeaders(n),getSheetName:n=>On.getExportSheetName(n)};case"sankey":return{extractData:n=>An.exportData(n),getHeaders:n=>An.getExportHeaders(n),getSheetName:n=>An.getExportSheetName(n)};default:return this.getSpecialChartDataExtractor(i)}}getSpecialChartDataExtractor(i){return{extractData:n=>{let a=n.config?.options?.series?.[0];return a?.type==="line"&&a?.areaStyle?a?.stack?In.exportData(n):Dn.exportData(n):a?.type==="line"&&a?.coordinateSystem==="polar"?kn.exportData(n):ai.exportData(n)},getHeaders:n=>{let a=n.config?.options?.series?.[0];return a?.type==="line"&&a?.areaStyle?a?.stack?In.getExportHeaders(n):Dn.getExportHeaders(n):a?.type==="line"&&a?.coordinateSystem==="polar"?kn.getExportHeaders(n):ai.getExportHeaders(n)},getSheetName:n=>{let a=n.config?.options?.series?.[0];return a?.type==="line"&&a?.areaStyle?a?.stack?In.getExportSheetName(n):Dn.getExportSheetName(n):a?.type==="line"&&a?.coordinateSystem==="polar"?kn.getExportSheetName(n):ai.getExportSheetName(n)}}}getGenericDataExtractor(){return{extractData:i=>this.extractGenericData(i),getHeaders:()=>["Property","Value"],getSheetName:i=>this.getWidgetSheetName(i,"Generic")}}extractGenericData(i){let n=[];if(n.push(["Widget ID",i.id]),n.push(["Component Type",i.config?.component||"Unknown"]),n.push(["Title",i.config?.header?.title||"Untitled"]),i.config?.options){let s=i.config.options;Object.keys(s).forEach(a=>{(typeof s[a]!="object"||s[a]===null)&&n.push([a,s[a]])})}return i.series&&i.series.length>0&&n.push(["Series Data",JSON.stringify(i.series)]),n}getWidgetSheetName(i,n){let a=(i.config?.header?.title||i.id).replace(/[^a-zA-Z0-9\s]/g,"").substring(0,20);return`${n}_${a}`}getErrorSheetName(i){return`Error_${i.id}`}exportWidgetToExcel(s){return kt(this,arguments,function*(i,n={}){let{filename:a=`${i.id}-export-${new Date().toISOString().split("T")[0]}.xlsx`,includeHeaders:o=!0,includeTimestamp:c=!0,autoColumnWidth:l=!0,includeWidgetTitles:h=!0}=n;try{let f=kr.book_new();c&&this.addTimestampSheet(f),yield this.exportWidgetToSheet(f,i,{includeHeaders:o,sheetNamePrefix:"Widget",autoColumnWidth:l,includeWidgetTitles:h}),Xo(f,a)}catch(f){throw console.error("Error exporting widget to Excel:",f),new Error("Failed to export widget to Excel")}})}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();var Uy=()=>({width:"30%",height:"100%",padding:"0px","padding-right":"2px"});function zy(r,t){if(r&1){let e=Te();U(0,"p-button",9),me("click",function(n){te(e);let s=I(2);return re(s.onDeleteWidgetClicked(n))}),G(),U(1,"p-button",10),me("click",function(){te(e);let n=I(2);return re(n.sidebarVisible=!0)}),G()}r&2&&(M("outlined",!0),A(),M("outlined",!0)("outlined",!0))}function Gy(r,t){if(r&1){let e=Te();gt(0,zy,2,3),U(1,"p-button",8,1),me("click",function(n){te(e),I();let s=_r(3);return re(s.toggle(n))}),G()}if(r&2){let e=I();xt(e.onEditMode?0:-1),A(),M("outlined",!0)}}function Xy(r,t){if(r&1&&(U(0,"div",11),Ie(1),G()),r&2){let e=I();A(),Wr(" ",e.title," Settings ")}}var Yh=(()=>{let t=class t{constructor(i){this.excelExportService=i,this.onUpdateWidget=new Ce,this.onDeleteWidget=new Ce,this.onToggleViewMode=new Ce,this.onEditMode=!0,this.currentViewMode="chart",this.sidebarVisible=!1}get title(){return this.widget?.config?.header?.title}get menuItems(){let i=[];return this.currentViewMode==="chart"?i.push({label:"Show Data",icon:"pi pi-table",command:()=>this.toggleToTableView()}):i.push({label:"Show Chart",icon:"pi pi-chart-bar",command:()=>this.toggleToChartView()}),i.push({label:"Export to Excel/CSV",icon:"pi pi-file-excel",command:()=>this.exportToExcel()}),i}onUpdateOptions(i){this.onUpdateWidget.emit(i),this.sidebarVisible=!1}onEditModeClicked(){this.onEditMode=!this.onEditMode}onDeleteWidgetClicked(i){this.onDeleteWidget.emit(this.widget)}toggleToTableView(){this.onToggleViewMode.emit({widgetId:this.widget.id,viewMode:"table"})}toggleToChartView(){this.onToggleViewMode.emit({widgetId:this.widget.id,viewMode:"chart"})}exportToExcel(){return kt(this,null,function*(){try{let i={filename:`${this.widget.id}-export.xlsx`,includeHeaders:!0,includeTimestamp:!0,autoColumnWidth:!0,includeWidgetTitles:!0};yield this.excelExportService.exportWidgetToExcel(this.widget,i)}catch(i){console.error("Error exporting widget to Excel:",i)}})}};t.\u0275fac=function(n){return new(n||t)(Ke(ya))},t.\u0275cmp=Me({type:t,selectors:[["vis-widget-header"]],inputs:{widget:"widget",onEditMode:"onEditMode",dashboardId:"dashboardId",currentViewMode:"currentViewMode"},outputs:{onUpdateWidget:"onUpdateWidget",onDeleteWidget:"onDeleteWidget",onToggleViewMode:"onToggleViewMode"},decls:7,vars:11,consts:[["menu",""],["menuButton",""],[3,"header"],["pTemplate","icons"],["appendTo","body",3,"model","popup"],["position","right",3,"visibleChange","visible","modal","appendTo"],["pTemplate","header"],[3,"onUpdate","selectedDashboardId","widget"],["type","button","icon","pi pi-ellipsis-v",1,"p-button-sm","ml-2",3,"click","outlined"],["type","button","icon","pi pi-trash",1,"p-button-sm","mr-2",3,"click","outlined"],["type","button","icon","pi pi-cog",1,"p-button-sm",3,"click","outlined"],[1,"font-bold","ml-3","mb-3","text-lg"]],template:function(n,s){if(n&1){let a=Te();U(0,"p-panel",2),ce(1,Gy,3,2,"ng-template",3),G(),xe(2,"p-menu",4,0),U(4,"p-drawer",5),_l("visibleChange",function(c){return te(a),vl(s.sidebarVisible,c)||(s.sidebarVisible=c),re(c)}),ce(5,Xy,2,1,"ng-template",6),U(6,"vis-widget-config",7),me("onUpdate",function(c){return te(a),re(s.onUpdateOptions(c))}),G()()}n&2&&(M("header",s.title),A(2),M("model",s.menuItems)("popup",!0),A(2),It(Hr(10,Uy)),xl("visible",s.sidebarVisible),M("modal",!1)("appendTo","body"),A(2),M("selectedDashboardId",s.dashboardId)("widget",s.widget))},dependencies:[Ne,Ec,lo,wr,Ws,oo,kc,di,ui,Vs,cn],styles:[".panel-button[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:end}[_nghost-%COMP%]     .p-panel .p-panel-content{display:none}[_nghost-%COMP%]     .p-panel .p-panel-header{padding:.5rem 1rem}.widget-data-panel[_ngcontent-%COMP%]{padding:1rem;max-height:400px;overflow:hidden;display:flex;flex-direction:column}.data-header[_ngcontent-%COMP%]{margin-bottom:1rem;padding-bottom:.5rem;border-bottom:1px solid #e0e0e0}.data-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.1rem;font-weight:600;color:#333}.data-info[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:#666}.data-table-container[_ngcontent-%COMP%]{flex:1;overflow:auto;border:1px solid #e0e0e0;border-radius:4px}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.875rem}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:.5rem;text-align:left;font-weight:600;border-bottom:1px solid #e0e0e0;position:sticky;top:0;z-index:1}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem;border-bottom:1px solid #f0f0f0;word-break:break-word}.data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}.data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.no-data[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#666;font-style:italic}[_nghost-%COMP%]     .p-button.p-button-sm{padding:.25rem .5rem;font-size:.875rem}"]});let r=t;return r})();var Kh=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=sr({type:r});static \u0275inj=nr({})}return r})();var wa=class{constructor(){this.widgets=[],this.filterValues=[],this.dashboardId="",this.isEditMode=!1,this.chartHeight=300,this.defaultChartHeight=400,this.containerConfig=this.getDefaultConfig()}setGridType(t){return this.containerConfig.gridType=t,this}setDisplayGrid(t){return this.containerConfig.displayGrid=t,this}setOuterMargin(t){return this.containerConfig.outerMargin=t,this}setDraggable(t,e){return this.containerConfig.draggable=k({enabled:t},e),this}setResizable(t,e){return this.containerConfig.resizable=k({enabled:t},e),this}setMaxCols(t){return this.containerConfig.maxCols=t,this}setMinCols(t){return this.containerConfig.minCols=t,this}setMaxRows(t){return this.containerConfig.maxRows=t,this}setMinRows(t){return this.containerConfig.minRows=t,this}setFixedColWidth(t){return this.containerConfig.fixedColWidth=t,this}setFixedRowHeight(t){return this.containerConfig.fixedRowHeight=t,this}setEmptyCellConfig(t){return Object.assign(this.containerConfig,t),this}setIgnoreMarginInRow(t){return this.containerConfig.ignoreMarginInRow=t,this}setMobileBreakpoint(t){return this.containerConfig.mobileBreakpoint=t,this}setWidgets(t){return this.widgets=t,this}addWidget(t){return this.widgets.push(t),this}setFilterValues(t){return this.filterValues=t,this}setDashboardId(t){return this.dashboardId=t,this}setEditMode(t){return this.isEditMode=t,this}setChartHeight(t){return this.chartHeight=t,this}setDefaultChartHeight(t){return this.defaultChartHeight=t,this}setCustomConfig(t){return this.containerConfig=k(k({},this.containerConfig),t),this}setItemResizeCallback(t){return this.containerConfig.itemResizeCallback=t,this}setItemChangeCallback(t){return this.containerConfig.itemChangeCallback=t,this}setFilterVisualization(t){return this.filterVisualization=t,this}enableFilterHighlighting(t=!0,e){let i={enableHighlighting:t,defaultFilteredOpacity:e?.filteredOpacity||.3,defaultHighlightedOpacity:e?.highlightedOpacity||1,defaultHighlightColor:e?.highlightColor||"#ff6b6b",defaultFilteredColor:e?.filteredColor||"#cccccc"};return this.setFilterVisualization(i)}build(){return{config:this.containerConfig,widgets:this.widgets,filterValues:this.filterValues,dashboardId:this.dashboardId,isEditMode:this.isEditMode,chartHeight:this.chartHeight,defaultChartHeight:this.defaultChartHeight}}getConfig(){return this.containerConfig}getWidgets(){return this.widgets}getFilterValues(){return this.filterValues}static create(){return new this}static updateConfig(t,e){return k(k({},t),e)}static calculateChartHeight(t,e,i=!1,n=400){let s=n,a=t/e,o=t*e,c=Math.log(o)/Math.log(2),l=.95,h=a<1?1/a:1;return i&&(h=h*a),Math.round(s*h*l)}static calculateMapCenter(t,e){let s=t/e,a=s>1?(s-1)*5:0,o=s<1?(1/s-1)*2:0;return[-95+a,38+o]}static calculateMapZoom(t,e){let n=t*e,s=Math.log(n)/Math.log(2),a=t/e,o=Math.abs(1-a)*.5;return 4-s*.1-o}};var oi=class r extends wa{getDefaultConfig(){return{gridType:Ae.VerticalFixed,displayGrid:pi.None,outerMargin:!0,draggable:{enabled:!1},resizable:{enabled:!1},maxCols:we.MAX_COLS,minCols:we.MIN_COLS,maxRows:we.MAX_ROWS,minRows:we.MIN_ROWS,fixedColWidth:we.FIXED_COL_WIDTH,fixedRowHeight:we.FIXED_ROW_HEIGHT,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,mobileBreakpoint:we.MOBILE_BREAKPOINT}}enableEditMode(){return this.setDraggable(!0).setResizable(!0).setEditMode(!0).setDisplayGrid(pi.Always)}disableEditMode(){return this.setDraggable(!1).setResizable(!1).setEditMode(!1).setDisplayGrid(pi.None)}setResponsive(t=we.MOBILE_BREAKPOINT){return this.setMobileBreakpoint(t)}setCompactLayout(){return this.setOuterMargin(Mi.COMPACT.OUTER_MARGIN).setFixedColWidth(Mi.COMPACT.FIXED_COL_WIDTH).setFixedRowHeight(Mi.COMPACT.FIXED_ROW_HEIGHT)}setSpaciousLayout(){return this.setOuterMargin(Mi.SPACIOUS.OUTER_MARGIN).setFixedColWidth(Mi.SPACIOUS.FIXED_COL_WIDTH).setFixedRowHeight(Mi.SPACIOUS.FIXED_ROW_HEIGHT)}setGridLayout(){return this.setDisplayGrid(pi.Always)}setFluidLayout(){return this.setGridType(Ae.VerticalFixed).setMaxCols(24).setMinCols(1)}setFixedLayout(){return this.setGridType(Ae.Fit).setMaxCols(we.MAX_COLS).setMinCols(we.MAX_COLS)}setMobileOptimized(){let t=Ga;return this.setMobileBreakpoint(t.MOBILE_BREAKPOINT).setMaxCols(t.MAX_COLS).setFixedColWidth(t.FIXED_COL_WIDTH).setFixedRowHeight(t.FIXED_ROW_HEIGHT)}setTabletOptimized(){let t=Xa;return this.setMobileBreakpoint(t.MOBILE_BREAKPOINT).setMaxCols(t.MAX_COLS).setFixedColWidth(t.FIXED_COL_WIDTH).setFixedRowHeight(t.FIXED_ROW_HEIGHT)}setDesktopOptimized(){let t=we;return this.setMaxCols(t.MAX_COLS).setFixedColWidth(t.FIXED_COL_WIDTH).setFixedRowHeight(t.FIXED_ROW_HEIGHT).setMobileBreakpoint($n.DESKTOP)}setLargeDesktopOptimized(){let t=ja;return this.setMaxCols(t.MAX_COLS).setFixedColWidth(t.FIXED_COL_WIDTH).setFixedRowHeight(t.FIXED_ROW_HEIGHT).setMobileBreakpoint(t.MOBILE_BREAKPOINT)}setGridDimensions(t,e){return this.setMaxCols(t).setMinCols(t).setMaxRows(e)}enableEmptyCellInteractions(){return this.setEmptyCellConfig({enableEmptyCellClick:!0,enableEmptyCellContextMenu:!0,enableEmptyCellDrop:!0,enableEmptyCellDrag:!0})}disableEmptyCellInteractions(){return this.setEmptyCellConfig({enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1})}setItemSizeConstraints(t=we.MIN_COLS,e=we.MAX_COLS,i=we.MIN_ROWS,n=50){return this.setMinCols(t).setMaxCols(e).setMinRows(i).setMaxRows(n)}setScreenSize(t){let e=Zl(t);return this.setMaxCols(e.MAX_COLS).setMinCols(e.MIN_COLS).setMaxRows(e.MAX_ROWS).setMinRows(e.MIN_ROWS).setFixedColWidth(e.FIXED_COL_WIDTH).setFixedRowHeight(e.FIXED_ROW_HEIGHT).setMobileBreakpoint(e.MOBILE_BREAKPOINT)}static createStandard(){return new r().setGridType(Ae.VerticalFixed).setDisplayGrid(pi.None).setOuterMargin(!0).setDraggable(!1).setResizable(!1).setMaxCols(we.MAX_COLS).setMinCols(we.MIN_COLS).setMaxRows(we.MAX_ROWS).setMinRows(we.MIN_ROWS).setFixedColWidth(we.FIXED_COL_WIDTH).setFixedRowHeight(we.FIXED_ROW_HEIGHT).setMobileBreakpoint(we.MOBILE_BREAKPOINT)}static createEditMode(){return new r().enableEditMode().setMaxCols(we.MAX_COLS).setMinCols(we.MIN_COLS).setMaxRows(we.MAX_ROWS).setMinRows(we.MIN_ROWS).setFixedColWidth(we.FIXED_COL_WIDTH).setFixedRowHeight(we.FIXED_ROW_HEIGHT).setMobileBreakpoint(we.MOBILE_BREAKPOINT)}static createMobile(){return new r().setScreenSize("MOBILE").setCompactLayout()}static createTablet(){return new r().setScreenSize("TABLET").setSpaciousLayout()}static createDesktop(){return new r().setScreenSize("DESKTOP").setSpaciousLayout()}static createLargeDesktop(){return new r().setScreenSize("LARGE_DESKTOP").setSpaciousLayout()}build(){return{config:this.containerConfig,widgets:this.widgets,filterValues:this.filterValues,dashboardId:this.dashboardId,isEditMode:this.isEditMode,chartHeight:this.chartHeight,defaultChartHeight:this.defaultChartHeight,filterVisualization:this.filterVisualization}}};var jy=["dashboardContainer"],Yy=(r,t)=>t.id;function Ky(r,t){if(r&1){let e=Te();U(0,"vis-widget-header",9),me("onUpdateWidget",function(n){te(e);let s=I(2);return re(s.onUpdateWidget(n))})("onDeleteWidget",function(n){te(e);let s=I(2);return re(s.onDeleteWidget(n))})("onToggleViewMode",function(n){te(e);let s=I(2);return re(s.onToggleViewMode(n))}),G()}if(r&2){let e=I().$implicit,i=I();M("dashboardId",i.dashboardId)("widget",e)("currentViewMode",i.getWidgetViewMode(e.id))("onEditMode",i.isEditMode)}}function qy(r,t){if(r&1){let e=Te();U(0,"gridster-item",6),me("itemResize",function(){te(e);let n=I();return re(n.updateString(n.container.editModeString))})("itemChange",function(){te(e);let n=I();return re(n.updateString(n.container.editModeString))}),gt(1,Ky,1,4,"vis-widget-header",7),U(2,"vis-widget",8),me("onDataLoad",function(n){te(e);let s=I();return re(s.onDataLoad(n))})("onUpdateFilter",function(n){te(e);let s=I();return re(s.onUpdateFilter(n))}),G()()}if(r&2){let e=t.$implicit,i=I();M("item",e.position),ke("data-widget-id",e.id),A(),xt(e.config.header?1:-1),A(),M("widget",e)("viewMode",i.getWidgetViewMode(e.id))}}var Yo=(()=>{let t=class t{constructor(){this.filterValues=[],this.container=t,this.chartHeight=300,this.defaultChartHeight=400,this.containerTouchChanged=new Ce,this.editModeStringChange=new Ce,this.changesMade=new Ce,this.filterValuesChanged=new Ce,this.availableDashboards=[],this.isEditMode=!1,this.onShowConfirmation=!1,this.onShowNewDashboardDialog=!1,this.options={},this.mergedOptions={},this.widgetViewModes=new Map,this.dashboardBuilder=oi.createStandard()}ngOnInit(){this.initializeDashboard()}initializeDashboard(){let i=this.dashboardBuilder.setWidgets(this.widgets||[]).setFilterValues(this.filterValues||[]).setDashboardId(this.dashboardId||"").setEditMode(this.isEditMode).setChartHeight(this.chartHeight).setDefaultChartHeight(this.defaultChartHeight).setCustomConfig(this.options).setItemResizeCallback(this.onWidgetResize.bind(this)).setItemChangeCallback(this.onWidgetChange.bind(this)).build();this.applyDashboardConfig(i)}applyDashboardConfig(i){this.mergedOptions=i.config,this.widgets=i.widgets,this.filterValues=i.filterValues,this.dashboardId=i.dashboardId,this.isEditMode=i.isEditMode,this.chartHeight=i.chartHeight}updateDashboardConfig(i){i.config&&(this.mergedOptions=k(k({},this.mergedOptions),i.config)),i.widgets&&(this.widgets=i.widgets),i.filterValues&&(this.filterValues=i.filterValues),i.dashboardId&&(this.dashboardId=i.dashboardId),i.isEditMode!==void 0&&(this.isEditMode=i.isEditMode),i.chartHeight&&(this.chartHeight=i.chartHeight),this.dashboardBuilder=oi.createStandard().setWidgets(this.widgets).setFilterValues(this.filterValues).setDashboardId(this.dashboardId).setEditMode(this.isEditMode).setChartHeight(this.chartHeight).setDefaultChartHeight(this.defaultChartHeight),this.applyDashboardConfig(this.dashboardBuilder.build())}enableEditMode(){this.dashboardBuilder.enableEditMode();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}disableEditMode(){this.dashboardBuilder.disableEditMode();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}setResponsive(i=640){this.dashboardBuilder.setResponsive(i);let n=this.dashboardBuilder.build();this.applyDashboardConfig(n)}setCompactLayout(){this.dashboardBuilder.setCompactLayout();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}setSpaciousLayout(){this.dashboardBuilder.setSpaciousLayout();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}setMobileOptimized(){this.dashboardBuilder.setMobileOptimized();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}setDesktopOptimized(){this.dashboardBuilder.setDesktopOptimized();let i=this.dashboardBuilder.build();this.applyDashboardConfig(i)}getCurrentConfig(){return this.dashboardBuilder.build()}getBuilder(){return this.dashboardBuilder}onDataLoad(i){return kt(this,null,function*(){this.filterValues&&this.filterValues.length>0&&this.applyFiltersToWidget(i)})}applyFiltersToWidget(i){}getFilterParams(){return this.filterValues}onUpdateWidget(i){}onWidgetResize(i,n){}onWidgetChange(i,n){t.containerTouched=!0,t.editModeString="[Edit Mode - Pending Changes]"}updateString(i){this.editModeStringChange.emit(i)}getEditModeString(i){return t.editModeString}onUpdateFilter(i){let n=this.widgets.find(o=>o.config?.component==="filter");if(!n)return;let s=k({},n);s.config?s.config.options||(s.config.options={values:[]}):s.config={options:{values:[]}};let a=s.config.options;if(a.values||(a.values=[]),Array.isArray(i))a.values=i,this.filterValues=i,i.length===0&&(this.dashboardBuilder.setFilterValues([]),this.filterValues=[]);else if(i&&i.value&&i.widget){let o=i.value,c=i.widget,h=i.filterValue;if(!h&&o&&typeof o=="object"){let f=c.config?.filterColumn||c.config?.accessor||"unknown";if(o.name)h={accessor:"category",filterColumn:f,category:o.name,value:o.value||o.name};else if(o.seriesName)h={accessor:"series",filterColumn:f,series:o.seriesName,value:o.value||o.seriesName};else{let u=Object.keys(o);if(u.length>0){let d=u[0];h={accessor:d,filterColumn:f,[d]:o[d],value:o[d]}}}c.config?.header?.title&&(h.widgetTitle=c.config.header.title),c.id&&(h.widgetId=c.id)}h&&h.accessor&&h.value&&(a.values.push(h),this.filterValues.push(h))}this.dashboardBuilder.setFilterValues(this.filterValues),this.filterValuesChanged.emit(this.filterValues)}onDashboardSelectionChanged(i){}onDeleteWidget(i){this.widgets.splice(this.widgets.indexOf(i),1)}calculateChartHeight(i,n,s=!1,a=this.defaultChartHeight){return oi.calculateChartHeight(i,n,s,a)}calculateMapCenter(i,n){return oi.calculateMapCenter(i,n)}calculateMapZoom(i,n){return oi.calculateMapZoom(i,n)}getWidgetViewMode(i){return this.widgetViewModes.get(i)||"chart"}onToggleViewMode(i){this.widgetViewModes.set(i.widgetId,i.viewMode)}};t.editModeString="",t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Me({type:t,selectors:[["vis-dashboard-container"]],viewQuery:function(n,s){if(n&1&&(et(Rs,5),et(jy,7)),n&2){let a;Se(a=Ee())&&(s.gridster=a.first),Se(a=Ee())&&(s.dashboardContainer=a.first)}},inputs:{widgets:"widgets",filterValues:"filterValues",dashboardId:"dashboardId",isEditMode:"isEditMode",options:"options"},outputs:{containerTouchChanged:"containerTouchChanged",editModeStringChange:"editModeStringChange",changesMade:"changesMade",filterValuesChanged:"filterValuesChanged"},decls:7,vars:1,consts:[["dashboardContainer",""],[1,"gridster-container"],[1,"mt-2","dashboard-gridster",3,"options"],["id","dashboard",1,"print-body"],[3,"item"],["position","bottom-right","key","br"],[3,"itemResize","itemChange","item"],[3,"dashboardId","widget","currentViewMode","onEditMode"],[3,"onDataLoad","onUpdateFilter","widget","viewMode"],[3,"onUpdateWidget","onDeleteWidget","onToggleViewMode","dashboardId","widget","currentViewMode","onEditMode"]],template:function(n,s){n&1&&(U(0,"div",1,0)(2,"gridster",2)(3,"div",3),ki(4,qy,3,5,"gridster-item",4,Yy),G()()(),xe(6,"p-toast",5)),n&2&&(A(2),M("options",s.mergedOptions),A(2),Ii(s.widgets))},dependencies:[Ne,As,Rs,hc,yc,Yh,Kh,Ms,Ds],styles:[".vis-chart-container[_ngcontent-%COMP%]{background-color:#fff;min-height:1000px;width:100%}.gridster-container[_ngcontent-%COMP%]{width:100%;height:100%}.editMode[_ngcontent-%COMP%]{color:red}.print-body[_ngcontent-%COMP%]{width:95%}@media print{#dashboard[_ngcontent-%COMP%]{width:95%;overflow-y:visible!important;position:relative}@page{size:landscape}}.vis-filter-component[_ngcontent-%COMP%]{font-size:.8rem!important;width:100%;height:40px}  .p-dropdown-custom{width:100%!important}  .p-dropdown-custom.p-dropdown .p-component{width:100%!important}.dashboard-gridster[_ngcontent-%COMP%]{background-color:var(--p-surface-50);padding:5px;height:100%!important;overflow-y:auto!important}[_nghost-%COMP%]     .no-border .p-panel-content{border:none!important;background:transparent!important}[_nghost-%COMP%]     .hide-panel-header .p-panel-header{display:none!important}"]});let r=t;return r})();var qh=`
    .p-tieredmenu {
        background: dt('tieredmenu.background');
        color: dt('tieredmenu.color');
        border: 1px solid dt('tieredmenu.border.color');
        border-radius: dt('tieredmenu.border.radius');
        min-width: 12.5rem;
    }

    .p-tieredmenu-root-list,
    .p-tieredmenu-submenu {
        margin: 0;
        padding: dt('tieredmenu.list.padding');
        list-style: none;
        outline: 0 none;
        display: flex;
        flex-direction: column;
        gap: dt('tieredmenu.list.gap');
    }

    .p-tieredmenu-submenu {
        position: absolute;
        min-width: 100%;
        z-index: 1;
        background: dt('tieredmenu.background');
        color: dt('tieredmenu.color');
        border: 1px solid dt('tieredmenu.border.color');
        border-radius: dt('tieredmenu.border.radius');
        box-shadow: dt('tieredmenu.shadow');
    }

    .p-tieredmenu-item {
        position: relative;
    }

    .p-tieredmenu-item-content {
        transition:
            background dt('tieredmenu.transition.duration'),
            color dt('tieredmenu.transition.duration');
        border-radius: dt('tieredmenu.item.border.radius');
        color: dt('tieredmenu.item.color');
    }

    .p-tieredmenu-item-link {
        cursor: pointer;
        display: flex;
        align-items: center;
        text-decoration: none;
        overflow: hidden;
        position: relative;
        color: inherit;
        padding: dt('tieredmenu.item.padding');
        gap: dt('tieredmenu.item.gap');
        user-select: none;
        outline: 0 none;
    }

    .p-tieredmenu-item-label {
        line-height: 1;
    }

    .p-tieredmenu-item-icon {
        color: dt('tieredmenu.item.icon.color');
    }

    .p-tieredmenu-submenu-icon {
        color: dt('tieredmenu.submenu.icon.color');
        margin-left: auto;
        font-size: dt('tieredmenu.submenu.icon.size');
        width: dt('tieredmenu.submenu.icon.size');
        height: dt('tieredmenu.submenu.icon.size');
    }

    .p-tieredmenu-submenu-icon:dir(rtl) {
        margin-left: 0;
        margin-right: auto;
    }

    .p-tieredmenu-item.p-focus > .p-tieredmenu-item-content {
        color: dt('tieredmenu.item.focus.color');
        background: dt('tieredmenu.item.focus.background');
    }

    .p-tieredmenu-item.p-focus > .p-tieredmenu-item-content .p-tieredmenu-item-icon {
        color: dt('tieredmenu.item.icon.focus.color');
    }

    .p-tieredmenu-item.p-focus > .p-tieredmenu-item-content .p-tieredmenu-submenu-icon {
        color: dt('tieredmenu.submenu.icon.focus.color');
    }

    .p-tieredmenu-item:not(.p-disabled) > .p-tieredmenu-item-content:hover {
        color: dt('tieredmenu.item.focus.color');
        background: dt('tieredmenu.item.focus.background');
    }

    .p-tieredmenu-item:not(.p-disabled) > .p-tieredmenu-item-content:hover .p-tieredmenu-item-icon {
        color: dt('tieredmenu.item.icon.focus.color');
    }

    .p-tieredmenu-item:not(.p-disabled) > .p-tieredmenu-item-content:hover .p-tieredmenu-submenu-icon {
        color: dt('tieredmenu.submenu.icon.focus.color');
    }

    .p-tieredmenu-item-active > .p-tieredmenu-item-content {
        color: dt('tieredmenu.item.active.color');
        background: dt('tieredmenu.item.active.background');
    }

    .p-tieredmenu-item-active > .p-tieredmenu-item-content .p-tieredmenu-item-icon {
        color: dt('tieredmenu.item.icon.active.color');
    }

    .p-tieredmenu-item-active > .p-tieredmenu-item-content .p-tieredmenu-submenu-icon {
        color: dt('tieredmenu.submenu.icon.active.color');
    }

    .p-tieredmenu-separator {
        border-block-start: 1px solid dt('tieredmenu.separator.border.color');
    }

    .p-tieredmenu-overlay {
        box-shadow: dt('tieredmenu.shadow');
    }

    .p-tieredmenu-enter-from,
    .p-tieredmenu-leave-active {
        opacity: 0;
    }

    .p-tieredmenu-enter-active {
        transition: opacity 250ms;
    }

    .p-tieredmenu-mobile .p-tieredmenu-submenu {
        position: static;
        box-shadow: none;
        border: 0 none;
        padding-inline-start: dt('tieredmenu.submenu.mobile.indent');
        padding-inline-end: 0;
    }

    .p-tieredmenu-mobile .p-tieredmenu-submenu:dir(rtl) {
        padding-inline-start: 0;
        padding-inline-end: dt('tieredmenu.submenu.mobile.indent');
    }

    .p-tieredmenu-mobile .p-tieredmenu-submenu-icon {
        transition: transform 0.2s;
        transform: rotate(90deg);
    }

    .p-tieredmenu-mobile .p-tieredmenu-item-active > .p-tieredmenu-item-content .p-tieredmenu-submenu-icon {
        transform: rotate(-90deg);
    }
`;var Qy=["sublist"],Zy=r=>({processedItem:r}),Jy=()=>({exact:!1}),ew=(r,t)=>({$implicit:r,hasSubmenu:t}),tw=r=>({display:r});function rw(r,t){if(r&1&&xe(0,"li",7),r&2){let e=I().$implicit,i=I();It(i.getItemProp(e,"style")),ve(i.cn(i.cx("separator"),i.getItemProp(e,"class"),i.getItemProp(e,"styleClass"))),ke("id",i.getItemId(e))("data-pc-section","separator")}}function iw(r,t){if(r&1&&xe(0,"span",18),r&2){let e=I(4).$implicit,i=I();ve(i.cn(i.cx("itemIcon"),i.getItemProp(e,"icon"))),M("ngStyle",i.getItemProp(e,"iconStyle")),ke("data-pc-section","icon")("tabindex",-1)}}function nw(r,t){if(r&1&&(U(0,"span"),Ie(1),G()),r&2){let e=I(4).$implicit,i=I();ve(i.cx("itemLabel")),ke("data-pc-section","label"),A(),Wr(" ",i.getItemLabel(e)," ")}}function sw(r,t){if(r&1&&xe(0,"span",19),r&2){let e=I(4).$implicit,i=I();ve(i.cx("itemLabel")),M("innerHTML",i.getItemLabel(e),li),ke("data-pc-section","label")}}function aw(r,t){if(r&1&&(U(0,"span"),Ie(1),G()),r&2){let e=I(4).$implicit,i=I();ve(i.cn(i.cx("itemBadge"),i.getItemProp(e,"badgeStyleClass"))),A(),je(i.getItemProp(e,"badge"))}}function ow(r,t){if(r&1&&(Rr(),xe(0,"svg",22)),r&2){let e=I(6);ve(e.cx("submenuIcon")),ke("data-pc-section","submenuicon")("aria-hidden",!0)}}function lw(r,t){}function cw(r,t){r&1&&ce(0,lw,0,0,"ng-template",23),r&2&&M("data-pc-section","submenuicon")("aria-hidden",!0)}function hw(r,t){if(r&1&&(vt(0),ce(1,ow,1,4,"svg",20)(2,cw,1,2,null,21),_t()),r&2){let e=I(5);A(),M("ngIf",!e.tieredMenu.submenuIconTemplate&&!e.tieredMenu._submenuIconTemplate),A(),M("ngTemplateOutlet",e.tieredMenu.submenuIconTemplate||e.tieredMenu._submenuIconTemplate)}}function fw(r,t){if(r&1&&(U(0,"a",14),ce(1,iw,1,5,"span",15)(2,nw,2,4,"span",16)(3,sw,1,4,"ng-template",null,2,or)(5,aw,2,3,"span",17)(6,hw,3,2,"ng-container",10),G()),r&2){let e=_r(4),i=I(3).$implicit,n=I();ve(n.cx("itemLink")),M("target",n.getItemProp(i,"target")),ke("href",n.getItemProp(i,"url"),_s)("data-automationid",n.getItemProp(i,"automationId"))("data-pc-section","action")("tabindex",-1),A(),M("ngIf",n.getItemProp(i,"icon")),A(),M("ngIf",n.getItemProp(i,"escape"))("ngIfElse",e),A(3),M("ngIf",n.getItemProp(i,"badge")),A(),M("ngIf",n.isItemGroup(i))}}function uw(r,t){if(r&1&&xe(0,"span",18),r&2){let e=I(4).$implicit,i=I();ve(i.cn(i.cx("itemIcon"),i.getItemProp(e,"icon"))),M("ngStyle",i.getItemProp(e,"iconStyle")),ke("data-pc-section","icon")("aria-hidden",!0)("tabindex",-1)}}function dw(r,t){if(r&1&&(U(0,"span"),Ie(1),G()),r&2){let e=I(4).$implicit,i=I();ve(i.cx("itemLabel")),ke("data-pc-section","label"),A(),Wr(" ",i.getItemLabel(e)," ")}}function pw(r,t){if(r&1&&xe(0,"span",19),r&2){let e=I(4).$implicit,i=I();ve(i.cx("itemLabel")),M("innerHTML",i.getItemLabel(e),li),ke("data-pc-section","label")}}function mw(r,t){if(r&1&&(U(0,"span"),Ie(1),G()),r&2){let e=I(4).$implicit,i=I();ve(i.cn(i.cx("itemBadge"),i.getItemProp(e,"badgeStyleClass"))),A(),je(i.getItemProp(e,"badge"))}}function gw(r,t){if(r&1&&(Rr(),xe(0,"svg",22)),r&2){let e=I(6);ve(e.cx("submenuIcon")),ke("data-pc-section","submenuicon")("aria-hidden",!0)}}function xw(r,t){}function vw(r,t){r&1&&ce(0,xw,0,0,"ng-template",23),r&2&&M("data-pc-section","submenuicon")("aria-hidden",!0)}function _w(r,t){if(r&1&&(vt(0),ce(1,gw,1,4,"svg",20)(2,vw,1,2,null,21),_t()),r&2){let e=I(5);A(),M("ngIf",!e.tieredMenu.submenuIconTemplate&&!e.tieredMenu._submenuIconTemplate),A(),M("ngTemplateOutlet",e.tieredMenu.submenuIconTemplate||e.tieredMenu._submenuIconTemplate)}}function yw(r,t){if(r&1&&(U(0,"a",24),ce(1,uw,1,6,"span",15)(2,dw,2,4,"span",16)(3,pw,1,4,"ng-template",null,2,or)(5,mw,2,3,"span",17)(6,_w,3,2,"ng-container",10),G()),r&2){let e=_r(4),i=I(3).$implicit,n=I();ve(n.cx("itemLink")),M("routerLink",n.getItemProp(i,"routerLink"))("queryParams",n.getItemProp(i,"queryParams"))("routerLinkActive","p-tieredmenu-item-link-active")("routerLinkActiveOptions",n.getItemProp(i,"routerLinkActiveOptions")||Hr(21,Jy))("target",n.getItemProp(i,"target"))("fragment",n.getItemProp(i,"fragment"))("queryParamsHandling",n.getItemProp(i,"queryParamsHandling"))("preserveFragment",n.getItemProp(i,"preserveFragment"))("skipLocationChange",n.getItemProp(i,"skipLocationChange"))("replaceUrl",n.getItemProp(i,"replaceUrl"))("state",n.getItemProp(i,"state")),ke("data-automationid",n.getItemProp(i,"automationId"))("tabindex",-1)("data-pc-section","action"),A(),M("ngIf",n.getItemProp(i,"icon")),A(),M("ngIf",n.getItemProp(i,"escape"))("ngIfElse",e),A(3),M("ngIf",n.getItemProp(i,"badge")),A(),M("ngIf",n.isItemGroup(i))}}function ww(r,t){if(r&1&&(vt(0),ce(1,fw,7,12,"a",12)(2,yw,7,22,"a",13),_t()),r&2){let e=I(2).$implicit,i=I();A(),M("ngIf",!i.getItemProp(e,"routerLink")),A(),M("ngIf",i.getItemProp(e,"routerLink"))}}function Cw(r,t){}function bw(r,t){r&1&&ce(0,Cw,0,0,"ng-template")}function Tw(r,t){if(r&1&&(vt(0),ce(1,bw,1,0,null,25),_t()),r&2){let e=I(2).$implicit,i=I();A(),M("ngTemplateOutlet",i.itemTemplate)("ngTemplateOutletContext",qr(2,ew,e.item,i.getItemProp(e,"items")))}}function Sw(r,t){if(r&1){let e=Te();U(0,"p-tieredmenusub",26),me("itemClick",function(n){te(e);let s=I(3);return re(s.itemClick.emit(n))})("itemMouseEnter",function(n){te(e);let s=I(3);return re(s.onItemMouseEnter(n))}),G()}if(r&2){let e=I(2).$implicit,i=I();M("items",e.items)("itemTemplate",i.itemTemplate)("autoDisplay",i.autoDisplay)("menuId",i.menuId)("activeItemPath",i.activeItemPath())("focusedItemId",i.focusedItemId)("ariaLabelledBy",i.getItemId(e))("level",i.level+1)("inlineStyles",ut(9,tw,i.isItemActive(e)?"flex":"none"))}}function Ew(r,t){if(r&1){let e=Te();U(0,"li",8,1)(2,"div",9),me("click",function(n){te(e);let s=I().$implicit,a=I();return re(a.onItemClick(n,s))})("mouseenter",function(n){te(e);let s=I().$implicit,a=I();return re(a.onItemMouseEnter({$event:n,processedItem:s}))}),ce(3,ww,3,2,"ng-container",10)(4,Tw,2,5,"ng-container",10),G(),ce(5,Sw,1,11,"p-tieredmenusub",11),G()}if(r&2){let e=I(),i=e.$implicit,n=e.index,s=I();ve(s.cn(s.cx("item",ut(21,Zy,i)),s.getItemProp(i,"styleClass"))),M("ngStyle",s.getItemProp(i,"style"))("tooltipOptions",s.getItemProp(i,"tooltipOptions")),ke("id",s.getItemId(i))("data-pc-section","menuitem")("data-p-highlight",s.isItemActive(i))("data-p-focused",s.isItemFocused(i))("data-p-disabled",s.isItemDisabled(i))("aria-label",s.getItemLabel(i))("aria-disabled",s.isItemDisabled(i)||void 0)("aria-haspopup",s.isItemGroup(i)&&!s.getItemProp(i,"to")?"menu":void 0)("aria-expanded",s.isItemGroup(i)?s.isItemActive(i):void 0)("aria-setsize",s.getAriaSetSize())("aria-posinset",s.getAriaPosInset(n)),A(2),ve(s.cx("itemContent")),ke("data-pc-section","content"),A(),M("ngIf",!s.itemTemplate),A(),M("ngIf",s.itemTemplate),A(),M("ngIf",s.isItemVisible(i)&&s.isItemGroup(i))}}function kw(r,t){if(r&1&&ce(0,rw,1,6,"li",5)(1,Ew,6,23,"li",6),r&2){let e=t.$implicit,i=I();M("ngIf",i.isItemVisible(e)&&i.getItemProp(e,"separator")),A(),M("ngIf",i.isItemVisible(e)&&!i.getItemProp(e,"separator"))}}var Iw=["submenuicon"],Fw=["item"],Ow=["rootmenu"],Aw=["container"],Dw=(r,t)=>({showTransitionParams:r,hideTransitionParams:t}),Mw=r=>({value:"visible",params:r});function Pw(r,t){if(r&1){let e=Te();U(0,"div",3,0),me("click",function(n){te(e);let s=I();return re(s.onOverlayClick(n))})("@overlayAnimation.start",function(n){te(e);let s=I();return re(s.onOverlayAnimationStart(n))})("@overlayAnimation.done",function(n){te(e);let s=I();return re(s.onOverlayAnimationEnd(n))}),U(2,"p-tieredMenuSub",4,1),me("itemClick",function(n){te(e);let s=I();return re(s.onItemClick(n))})("menuFocus",function(n){te(e);let s=I();return re(s.onMenuFocus(n))})("menuBlur",function(n){te(e);let s=I();return re(s.onMenuBlur(n))})("menuKeydown",function(n){te(e);let s=I();return re(s.onKeyDown(n))})("itemMouseEnter",function(n){te(e);let s=I();return re(s.onItemMouseEnter(n))}),G()()}if(r&2){let e=I();ve(e.cn(e.cx("root"),e.styleClass)),M("id",e.id)("ngStyle",e.style)("@overlayAnimation",ut(24,Mw,qr(21,Dw,e.showTransitionOptions,e.hideTransitionOptions)))("@.disabled",e.popup!==!0),ke("data-pc-section","root")("data-pc-name","tieredmenu"),A(2),M("root",!0)("items",e.processedItems)("itemTemplate",e.itemTemplate||e._itemTemplate)("menuId",e.id)("tabindex",e.disabled?-1:e.tabindex)("ariaLabel",e.ariaLabel)("ariaLabelledBy",e.ariaLabelledBy)("baseZIndex",e.baseZIndex)("autoZIndex",e.autoZIndex)("autoDisplay",e.autoDisplay)("popup",e.popup)("focusedItemId",e.focused?e.focusedItemId:void 0)("activeItemPath",e.activeItemPath())}}var Lw={submenu:({instance:r,processedItem:t})=>({display:r.isItemActive(t)?"flex":"none"})},Rw={root:({instance:r})=>["p-tieredmenu p-component",{"p-tieredmenu-overlay":r.popup,"p-tieredmenu-mobile":r.queryMatches}],start:"p-tieredmenu-start",rootList:"p-tieredmenu-root-list",item:({instance:r,processedItem:t})=>["p-tieredmenu-item",{"p-tieredmenu-item-active":r.isItemActive(t),"p-focus":r.isItemFocused(t),"p-disabled":r.isItemDisabled(t)}],itemContent:"p-tieredmenu-item-content",itemLink:"p-tieredmenu-item-link",itemIcon:"p-tieredmenu-item-icon",itemLabel:"p-tieredmenu-item-label",itemBadge:"p-menuitem-badge",submenuIcon:"p-tieredmenu-submenu-icon",submenu:"p-tieredmenu-submenu",separator:"p-tieredmenu-separator",end:"p-tieredmenu-end"},Ko=(()=>{class r extends $r{name="tieredmenu";theme=qh;classes=Rw;inlineStyles=Lw;static \u0275fac=(()=>{let e;return function(n){return(e||(e=qt(r)))(n||r)}})();static \u0275prov=Vt({token:r,factory:r.\u0275fac})}return r})();var Nw=(()=>{class r extends Cr{el;renderer;tieredMenu;items;itemTemplate;root=!1;autoDisplay;autoZIndex=!0;baseZIndex=0;popup;menuId;ariaLabel;ariaLabelledBy;level=0;focusedItemId;activeItemPath=Qt([]);tabindex=0;inlineStyles;itemClick=new Ce;itemMouseEnter=new Ce;menuFocus=new Ce;menuBlur=new Ce;menuKeydown=new Ce;sublistViewChild;_componentStyle=ht(Ko);constructor(e,i,n){super(),this.el=e,this.renderer=i,this.tieredMenu=n}positionSubmenu(){if(Qr(this.tieredMenu.platformId)){let e=this.sublistViewChild&&this.sublistViewChild.nativeElement;e&&El(e,this.level)}}getItemProp(e,i,n=null){return e&&e.item?Ha(e.item[i],n):void 0}getItemId(e){return e.item?.id??`${this.menuId}_${e.key}`}getItemKey(e){return this.getItemId(e)}getItemClass(e){return j(k({},this.getItemProp(e,"class")),{"p-tieredmenu-item":!0,"p-tieredmenu-item-active":this.isItemActive(e),"p-focus":this.isItemFocused(e),"p-disabled":this.isItemDisabled(e)})}getItemLabel(e){return this.getItemProp(e,"label")}getSeparatorItemClass(e){return j(k({},this.getItemProp(e,"class")),{"p-tieredmenu-separator":!0})}getAriaSetSize(){return this.items.filter(e=>this.isItemVisible(e)&&!this.getItemProp(e,"separator")).length}getAriaPosInset(e){return e-this.items.slice(0,e).filter(i=>{let n=this.isItemVisible(i),s=n&&this.getItemProp(i,"separator");return!n||s}).length+1}isItemVisible(e){return this.getItemProp(e,"visible")!==!1}isItemActive(e){if(this.activeItemPath())return this.positionSubmenu(),this.activeItemPath().some(i=>i.key===e.key)}isItemDisabled(e){return this.getItemProp(e,"disabled")}isItemFocused(e){return this.focusedItemId===this.getItemId(e)}isItemGroup(e){return Di(e.items)}onItemMouseEnter(e){if(this.autoDisplay){let{event:i,processedItem:n}=e;this.itemMouseEnter.emit({originalEvent:i,processedItem:n})}}onItemClick(e,i){this.getItemProp(i,"command",{originalEvent:e,item:i.item}),this.itemClick.emit({originalEvent:e,processedItem:i,isFocus:!0})}static \u0275fac=function(i){return new(i||r)(Ke(Yr),Ke(Ei),Ke(vs(()=>qo)))};static \u0275cmp=Me({type:r,selectors:[["p-tieredMenuSub"],["p-tieredmenusub"]],viewQuery:function(i,n){if(i&1&&et(Qy,7),i&2){let s;Se(s=Ee())&&(n.sublistViewChild=s.first)}},inputs:{items:"items",itemTemplate:"itemTemplate",root:[2,"root","root",Le],autoDisplay:[2,"autoDisplay","autoDisplay",Le],autoZIndex:[2,"autoZIndex","autoZIndex",Le],baseZIndex:[2,"baseZIndex","baseZIndex",lr],popup:[2,"popup","popup",Le],menuId:"menuId",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",level:[2,"level","level",lr],focusedItemId:"focusedItemId",activeItemPath:[1,"activeItemPath"],tabindex:[2,"tabindex","tabindex",lr],inlineStyles:"inlineStyles"},outputs:{itemClick:"itemClick",itemMouseEnter:"itemMouseEnter",menuFocus:"menuFocus",menuBlur:"menuBlur",menuKeydown:"menuKeydown"},features:[ar],decls:3,vars:12,consts:[["sublist",""],["listItem",""],["htmlLabel",""],["role","menu",3,"keydown","focus","blur","id","tabindex"],["ngFor","",3,"ngForOf"],["role","separator",3,"style","class",4,"ngIf"],["role","menuitem","pTooltip","",3,"ngStyle","class","tooltipOptions",4,"ngIf"],["role","separator"],["role","menuitem","pTooltip","",3,"ngStyle","tooltipOptions"],[3,"click","mouseenter"],[4,"ngIf"],[3,"items","itemTemplate","autoDisplay","menuId","activeItemPath","focusedItemId","ariaLabelledBy","level","inlineStyles","itemClick","itemMouseEnter",4,"ngIf"],["pRipple","",3,"target","class",4,"ngIf"],["pRipple","",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","class","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state",4,"ngIf"],["pRipple","",3,"target"],[3,"class","ngStyle",4,"ngIf"],[3,"class",4,"ngIf","ngIfElse"],[3,"class",4,"ngIf"],[3,"ngStyle"],[3,"innerHTML"],["data-p-icon","angle-right",3,"class",4,"ngIf"],[4,"ngTemplateOutlet"],["data-p-icon","angle-right"],[3,"data-pc-section","aria-hidden"],["pRipple","",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"itemClick","itemMouseEnter","items","itemTemplate","autoDisplay","menuId","activeItemPath","focusedItemId","ariaLabelledBy","level","inlineStyles"]],template:function(i,n){if(i&1){let s=Te();U(0,"ul",3,0),me("keydown",function(o){return te(s),re(n.menuKeydown.emit(o))})("focus",function(o){return te(s),re(n.menuFocus.emit(o))})("blur",function(o){return te(s),re(n.menuBlur.emit(o))}),ce(2,kw,2,2,"ng-template",4),G()}i&2&&(It(n.inlineStyles),ve(n.root?n.cx("rootList"):n.cx("submenu")),M("id",n.menuId+"_list")("tabindex",n.tabindex),ke("aria-label",n.ariaLabel)("aria-labelledBy",n.ariaLabelledBy)("aria-activedescendant",n.focusedItemId)("aria-orientation","vertical")("data-pc-section","menu"),A(2),M("ngForOf",n.items))},dependencies:[r,Ne,Qi,Zt,Fr,Oi,Zi,ys,ws,Ji,fi,en,Ol,at],encapsulation:2})}return r})(),qo=(()=>{class r extends Cr{overlayService;set model(e){this._model=e,this._processedItems=this.createProcessedItems(this._model||[])}get model(){return this._model}popup;style;styleClass;breakpoint="960px";autoZIndex=!0;baseZIndex=0;autoDisplay=!0;showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)";hideTransitionOptions=".1s linear";id;ariaLabel;ariaLabelledBy;disabled=!1;tabindex=0;appendTo=Qt(void 0);onShow=new Ce;onHide=new Ce;rootmenu;containerViewChild;submenuIconTemplate;itemTemplate;templates;$appendTo=Ki(()=>this.appendTo()||this.config.overlayAppendTo());container;outsideClickListener;resizeListener;scrollHandler;target;relatedTarget;visible;relativeAlign;dirty=!1;focused=!1;activeItemPath=Nr([]);number=Nr(0);focusedItemInfo=Nr({index:-1,level:0,parentKey:"",item:null});searchValue="";searchTimeout;_processedItems;_model;_componentStyle=ht(Ko);matchMediaListener;query;queryMatches;_submenuIconTemplate;_itemTemplate;get visibleItems(){let e=this.activeItemPath().find(i=>i.key===this.focusedItemInfo().parentKey);return e?e.items:this.processedItems}get processedItems(){return(!this._processedItems||!this._processedItems.length)&&(this._processedItems=this.createProcessedItems(this.model||[])),this._processedItems}get focusedItemId(){let e=this.focusedItemInfo();return e.item?.id?e.item.id:e.index!==-1?`${this.id}${Di(e.parentKey)?"_"+e.parentKey:""}_${e.index}`:null}constructor(e){super(),this.overlayService=e,Ma(()=>{let i=this.activeItemPath();Di(i)?(this.bindOutsideClickListener(),this.bindResizeListener()):(this.unbindOutsideClickListener(),this.unbindResizeListener())})}ngOnInit(){super.ngOnInit(),this.bindMatchMediaListener(),this.id=this.id||hi("pn_id_")}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"submenuicon":this._submenuIconTemplate=e.template;break;case"item":this._itemTemplate=e.template;break;default:this._itemTemplate=e.template;break}})}bindMatchMediaListener(){if(Qr(this.platformId)&&!this.matchMediaListener){let e=window.matchMedia(`(max-width: ${this.breakpoint})`);this.query=e,this.queryMatches=e.matches,this.matchMediaListener=()=>{this.queryMatches=e.matches},e.addEventListener("change",this.matchMediaListener)}}unbindMatchMediaListener(){this.matchMediaListener&&(this.query.removeEventListener("change",this.matchMediaListener),this.matchMediaListener=null)}createProcessedItems(e,i=0,n={},s=""){let a=[];return e&&e.forEach((o,c)=>{let l=(s!==""?s+"_":"")+c,h={item:o,index:c,level:i,key:l,parent:n,parentKey:s};h.items=this.createProcessedItems(o.items,i+1,h,l),a.push(h)}),a}getItemProp(e,i){return e?Ha(e[i]):void 0}getProccessedItemLabel(e){return e?this.getItemLabel(e.item):void 0}getItemLabel(e){return this.getItemProp(e,"label")}isProcessedItemGroup(e){return e&&Di(e.items)}isSelected(e){return this.activeItemPath().some(i=>i.key===e.key)}isValidSelectedItem(e){return this.isValidItem(e)&&this.isSelected(e)}isValidItem(e){return!!e&&!this.isItemDisabled(e.item)&&!this.isItemSeparator(e.item)&&this.isItemVisible(e.item)}isItemDisabled(e){return this.getItemProp(e,"disabled")}isItemVisible(e){return this.getItemProp(e,"visible")!==!1}isItemSeparator(e){return this.getItemProp(e,"separator")}isItemMatched(e){return this.isValidItem(e)&&this.getProccessedItemLabel(e).toLocaleLowerCase().startsWith(this.searchValue.toLocaleLowerCase())}isProccessedItemGroup(e){return e&&Di(e.items)}onOverlayClick(e){this.popup&&this.overlayService.add({originalEvent:e,target:this.el.nativeElement})}onItemClick(e){let{originalEvent:i,processedItem:n}=e,s=this.isProcessedItemGroup(n),a=ks(n.parent);if(this.isSelected(n)){let{index:c,key:l,level:h,parentKey:f,item:u}=n;this.activeItemPath.set(this.activeItemPath().filter(d=>l!==d.key&&l.startsWith(d.key))),this.focusedItemInfo.set({index:c,level:h,parentKey:f,item:u}),this.dirty=!0,yr(this.rootmenu.sublistViewChild.nativeElement)}else if(s)this.onItemChange(e);else{let c=a?n:this.activeItemPath().find(l=>l.parentKey==="");this.hide(i),this.changeFocusedItemIndex(i,c?c.index:-1),yr(this.rootmenu.sublistViewChild.nativeElement)}}onItemMouseEnter(e){Hn()?this.onItemChange({event:e,processedItem:e.processedItem,focus:this.autoDisplay},"hover"):this.dirty&&this.onItemChange(e,"hover")}onKeyDown(e){let i=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"ArrowLeft":this.onArrowLeftKey(e);break;case"ArrowRight":this.onArrowRightKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"Space":this.onSpaceKey(e);break;case"Enter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"PageDown":case"PageUp":case"Backspace":case"ShiftLeft":case"ShiftRight":break;default:!i&&kl(e.key)&&this.searchItems(e,e.key);break}}onArrowDownKey(e){let i=this.focusedItemInfo().index!==-1?this.findNextItemIndex(this.focusedItemInfo().index):this.findFirstFocusedItemIndex();this.changeFocusedItemIndex(e,i),e.preventDefault()}onArrowRightKey(e){let i=this.visibleItems[this.focusedItemInfo().index],n=this.isProccessedItemGroup(i),s=i?.item;n&&(this.onItemChange({originalEvent:e,processedItem:i}),this.focusedItemInfo.set({index:-1,parentKey:i.key,item:s}),this.searchValue="",this.onArrowDownKey(e)),e.preventDefault()}onArrowUpKey(e){if(e.altKey){if(this.focusedItemInfo().index!==-1){let i=this.visibleItems[this.focusedItemInfo().index];!this.isProccessedItemGroup(i)&&this.onItemChange({originalEvent:e,processedItem:i})}this.popup&&this.hide(e,!0),e.preventDefault()}else{let i=this.focusedItemInfo().index!==-1?this.findPrevItemIndex(this.focusedItemInfo().index):this.findLastFocusedItemIndex();this.changeFocusedItemIndex(e,i),e.preventDefault()}}onArrowLeftKey(e){let i=this.visibleItems[this.focusedItemInfo().index],n=this.activeItemPath().find(o=>o.key===i.parentKey);ks(i.parent)||(this.focusedItemInfo.set({index:-1,parentKey:n?n.parentKey:"",item:i.item}),this.searchValue="",this.onArrowDownKey(e));let a=this.activeItemPath().filter(o=>o.parentKey!==this.focusedItemInfo().parentKey);this.activeItemPath.set(a),e.preventDefault()}onHomeKey(e){this.changeFocusedItemIndex(e,this.findFirstItemIndex()),e.preventDefault()}onEndKey(e){this.changeFocusedItemIndex(e,this.findLastItemIndex()),e.preventDefault()}onSpaceKey(e){this.onEnterKey(e)}onEscapeKey(e){this.hide(e,!0),this.focusedItemInfo().index=this.findFirstFocusedItemIndex(),e.preventDefault()}onTabKey(e){if(this.focusedItemInfo().index!==-1){let i=this.visibleItems[this.focusedItemInfo().index];!this.isProccessedItemGroup(i)&&this.onItemChange({originalEvent:e,processedItem:i})}this.hide()}onEnterKey(e){if(this.focusedItemInfo().index!==-1){let i=Ai(this.rootmenu.el.nativeElement,`li[id="${`${this.focusedItemId}`}"]`),n=i&&Ai(i,'a[data-pc-section="action"]');if(n?n.click():i&&i.click(),!this.popup){let s=this.visibleItems[this.focusedItemInfo().index];!this.isProccessedItemGroup(s)&&(this.focusedItemInfo().index=this.findFirstFocusedItemIndex())}}e.preventDefault()}onItemChange(e,i){let{processedItem:n,isFocus:s}=e;if(ks(n))return;let{index:a,key:o,level:c,parentKey:l,items:h,item:f}=n,u=Di(h),d=this.activeItemPath().filter(g=>g.parentKey!==l&&g.parentKey!==o);u&&d.push(n),this.focusedItemInfo.set({index:a,level:c,parentKey:l,item:f}),u&&(this.dirty=!0),s&&yr(this.rootmenu.sublistViewChild.nativeElement),!(i==="hover"&&this.queryMatches)&&this.activeItemPath.set(d)}onMenuFocus(e){this.focused=!0,this.focusedItemInfo().index===-1&&this.popup}onMenuBlur(e){this.focused=!1,this.focusedItemInfo.set({index:-1,level:0,parentKey:"",item:null}),this.searchValue="",this.dirty=!1}onOverlayAnimationStart(e){switch(e.toState){case"visible":this.popup&&(this.container=e.element,this.moveOnTop(),this.onShow.emit({}),Sl(this.containerViewChild.nativeElement,{position:"absolute",top:0}),this.attrSelector&&this.container.setAttribute(this.attrSelector,""),this.appendOverlay(),this.alignOverlay(),this.bindOutsideClickListener(),this.bindResizeListener(),this.bindScrollListener(),yr(this.rootmenu.sublistViewChild.nativeElement),this.scrollInView());break;case"void":this.onOverlayHide(),this.onHide.emit({});break}}alignOverlay(){this.relativeAlign?Ss(this.container,this.target):bs(this.container,this.target),Ts(this.target)>Ts(this.container)&&(this.container.style.minWidth=Ts(this.target)+"px")}onOverlayAnimationEnd(e){switch(e.toState){case"void":ur.clear(e.element);break}}appendOverlay(){this.$appendTo()&&this.$appendTo()!=="self"&&(this.$appendTo()==="body"?this.renderer.appendChild(this.document.body,this.container):Es(this.$appendTo(),this.container))}restoreOverlayAppend(){this.container&&this.$appendTo()!=="self"&&this.renderer.appendChild(this.el.nativeElement,this.container)}moveOnTop(){this.autoZIndex&&ur.set("menu",this.container,this.baseZIndex+this.config.zIndex.menu)}hide(e,i){this.popup&&(this.onHide.emit({}),this.visible=!1),this.activeItemPath.set([]),this.focusedItemInfo.set({index:-1,level:0,parentKey:""}),i&&yr(this.relatedTarget||this.target||this.rootmenu.sublistViewChild.nativeElement),this.dirty=!1}toggle(e){this.visible?this.hide(e,!0):this.show(e)}show(e,i){this.popup&&(this.visible=!0,this.target=this.target||e.currentTarget,this.relatedTarget=e.relatedTarget||null,this.relativeAlign=e?.relativeAlign||null),this.focusedItemInfo.set({index:-1,level:0,parentKey:""}),i&&yr(this.rootmenu.sublistViewChild.nativeElement),this.cd.markForCheck()}searchItems(e,i){this.searchValue=(this.searchValue||"")+i;let n=-1,s=!1;return this.focusedItemInfo().index!==-1?(n=this.visibleItems.slice(this.focusedItemInfo().index).findIndex(a=>this.isItemMatched(a)),n=n===-1?this.visibleItems.slice(0,this.focusedItemInfo().index).findIndex(a=>this.isItemMatched(a)):n+this.focusedItemInfo().index):n=this.visibleItems.findIndex(a=>this.isItemMatched(a)),n!==-1&&(s=!0),n===-1&&this.focusedItemInfo().index===-1&&(n=this.findFirstFocusedItemIndex()),n!==-1&&this.changeFocusedItemIndex(e,n),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchValue="",this.searchTimeout=null},500),s}findLastFocusedItemIndex(){let e=this.findSelectedItemIndex();return e<0?this.findLastItemIndex():e}findLastItemIndex(){return Wa(this.visibleItems,e=>this.isValidItem(e))}findPrevItemIndex(e){let i=e>0?Wa(this.visibleItems.slice(0,e),n=>this.isValidItem(n)):-1;return i>-1?i:e}findNextItemIndex(e){let i=e<this.visibleItems.length-1?this.visibleItems.slice(e+1).findIndex(n=>this.isValidItem(n)):-1;return i>-1?i+e+1:e}findFirstFocusedItemIndex(){let e=this.findSelectedItemIndex();return e<0?this.findFirstItemIndex():e}findFirstItemIndex(){return this.visibleItems.findIndex(e=>this.isValidItem(e))}findSelectedItemIndex(){return this.visibleItems.findIndex(e=>this.isValidSelectedItem(e))}changeFocusedItemIndex(e,i){if(this.focusedItemInfo().index!==i){let n=this.focusedItemInfo();this.focusedItemInfo.set(j(k({},n),{item:this.visibleItems[i].item,index:i})),this.scrollInView()}}scrollInView(e=-1){let i=e!==-1?`${this.id}_${e}`:this.focusedItemId,n=Ai(this.rootmenu.el.nativeElement,`li[id="${i}"]`);n&&n.scrollIntoView&&n.scrollIntoView({block:"nearest",inline:"nearest"})}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new Fs(this.target,e=>{this.visible&&this.hide(e,!0)})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&(this.scrollHandler.unbindScrollListener(),this.scrollHandler=null)}bindResizeListener(){Qr(this.platformId)&&(this.resizeListener||(this.resizeListener=this.renderer.listen(this.document.defaultView,"resize",e=>{Hn()||this.hide(e,!0)})))}bindOutsideClickListener(){Qr(this.platformId)&&(this.outsideClickListener||(this.outsideClickListener=this.renderer.listen(this.document,"click",e=>{let i=this.containerViewChild&&!this.containerViewChild.nativeElement.contains(e.target),n=this.popup?!(this.target&&(this.target===e.target||this.target.contains(e.target))):!0;i&&n&&this.hide()})))}unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)}unbindResizeListener(){this.resizeListener&&(this.resizeListener(),this.resizeListener=null)}onOverlayHide(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindScrollListener(),this.cd.destroyed||(this.target=null)}ngOnDestroy(){this.popup&&(this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.container&&this.autoZIndex&&ur.clear(this.container),this.restoreOverlayAppend(),this.onOverlayHide()),this.unbindMatchMediaListener(),super.ngOnDestroy()}static \u0275fac=function(i){return new(i||r)(Ke(Is))};static \u0275cmp=Me({type:r,selectors:[["p-tieredMenu"],["p-tieredmenu"],["p-tiered-menu"]],contentQueries:function(i,n,s){if(i&1&&($e(s,Iw,4),$e(s,Fw,4),$e(s,wr,4)),i&2){let a;Se(a=Ee())&&(n.submenuIconTemplate=a.first),Se(a=Ee())&&(n.itemTemplate=a.first),Se(a=Ee())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&(et(Ow,5),et(Aw,5)),i&2){let s;Se(s=Ee())&&(n.rootmenu=s.first),Se(s=Ee())&&(n.containerViewChild=s.first)}},inputs:{model:"model",popup:[2,"popup","popup",Le],style:"style",styleClass:"styleClass",breakpoint:"breakpoint",autoZIndex:[2,"autoZIndex","autoZIndex",Le],baseZIndex:[2,"baseZIndex","baseZIndex",lr],autoDisplay:[2,"autoDisplay","autoDisplay",Le],showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",id:"id",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",disabled:[2,"disabled","disabled",Le],tabindex:[2,"tabindex","tabindex",lr],appendTo:[1,"appendTo"]},outputs:{onShow:"onShow",onHide:"onHide"},features:[Ut([Ko]),ar],decls:1,vars:1,consts:[["container",""],["rootmenu",""],[3,"id","class","ngStyle","click",4,"ngIf"],[3,"click","id","ngStyle"],[3,"itemClick","menuFocus","menuBlur","menuKeydown","itemMouseEnter","root","items","itemTemplate","menuId","tabindex","ariaLabel","ariaLabelledBy","baseZIndex","autoZIndex","autoDisplay","popup","focusedItemId","activeItemPath"]],template:function(i,n){i&1&&ce(0,Pw,4,26,"div",2),i&2&&M("ngIf",!n.popup||n.visible)},dependencies:[Ne,Zt,Oi,Nw,Zi,fi,at],encapsulation:2,data:{animation:[ci("overlayAnimation",[fr(":enter",[hr({opacity:0,transform:"scaleY(0.8)"}),cr("{{showTransitionParams}}")]),fr(":leave",[cr("{{hideTransitionParams}}",hr({opacity:0}))])])]},changeDetection:0})}return r})();var Qh=`
    .p-splitbutton {
        display: inline-flex;
        position: relative;
        border-radius: dt('splitbutton.border.radius');
    }

    .p-splitbutton-button.p-button {
        border-start-end-radius: 0;
        border-end-end-radius: 0;
        border-inline-end: 0 none;
    }

    .p-splitbutton-button.p-button:focus-visible,
    .p-splitbutton-dropdown.p-button:focus-visible {
        z-index: 1;
    }

    .p-splitbutton-button.p-button:not(:disabled):hover,
    .p-splitbutton-button.p-button:not(:disabled):active {
        border-inline-end: 0 none;
    }

    .p-splitbutton-dropdown.p-button {
        border-start-start-radius: 0;
        border-end-start-radius: 0;
    }

    .p-splitbutton .p-menu {
        min-width: 100%;
    }

    .p-splitbutton-fluid {
        display: flex;
    }

    .p-splitbutton-rounded .p-splitbutton-dropdown.p-button {
        border-start-end-radius: dt('splitbutton.rounded.border.radius');
        border-end-end-radius: dt('splitbutton.rounded.border.radius');
    }

    .p-splitbutton-rounded .p-splitbutton-button.p-button {
        border-start-start-radius: dt('splitbutton.rounded.border.radius');
        border-end-start-radius: dt('splitbutton.rounded.border.radius');
    }

    .p-splitbutton-raised {
        box-shadow: dt('splitbutton.raised.shadow');
    }
`;var Bw=["content"],Ww=["dropdownicon"],Hw=["defaultbtn"],$w=["menu"];function Vw(r,t){r&1&&ft(0)}function Uw(r,t){if(r&1){let e=Te();vt(0),U(1,"button",8),me("click",function(n){te(e);let s=I();return re(s.onDefaultButtonClick(n))}),ce(2,Vw,1,0,"ng-container",9),G(),_t()}if(r&2){let e=I();A(),ve(e.cx("pcButton")),M("severity",e.severity)("text",e.text)("outlined",e.outlined)("size",e.size)("icon",e.icon)("iconPos",e.iconPos)("disabled",e.disabled)("pAutoFocus",e.autofocus)("pTooltip",e.tooltip)("tooltipOptions",e.tooltipOptions),ke("tabindex",e.tabindex)("aria-label",(e.buttonProps==null?null:e.buttonProps.ariaLabel)||e.label),A(),M("ngTemplateOutlet",e.contentTemplate||e._contentTemplate)}}function zw(r,t){if(r&1){let e=Te();U(0,"button",10,2),me("click",function(n){te(e);let s=I();return re(s.onDefaultButtonClick(n))}),G()}if(r&2){let e=I();ve(e.cx("pcButton")),M("severity",e.severity)("text",e.text)("outlined",e.outlined)("size",e.size)("icon",e.icon)("iconPos",e.iconPos)("label",e.label)("disabled",e.buttonDisabled)("pAutoFocus",e.autofocus)("pTooltip",e.tooltip)("tooltipOptions",e.tooltipOptions),ke("tabindex",e.tabindex)("aria-label",e.buttonProps==null?null:e.buttonProps.ariaLabel)}}function Gw(r,t){if(r&1&&xe(0,"span"),r&2){let e=I();ve(e.dropdownIcon)}}function Xw(r,t){r&1&&(Rr(),xe(0,"svg",12))}function jw(r,t){}function Yw(r,t){r&1&&ce(0,jw,0,0,"ng-template")}function Kw(r,t){if(r&1&&(vt(0),ce(1,Xw,1,0,"svg",11)(2,Yw,1,0,null,9),_t()),r&2){let e=I();A(),M("ngIf",!e.dropdownIconTemplate&&!e._dropdownIconTemplate),A(),M("ngTemplateOutlet",e.dropdownIconTemplate||e._dropdownIconTemplate)}}var qw={root:({instance:r})=>["p-splitbutton p-component",{"p-splitbutton-raised":r.raised,"p-splitbutton-rounded":r.rounded,"p-splitbutton-outlined":r.outlined,"p-splitbutton-text":r.text,[`p-splitbutton-${r.size==="small"?"sm":"lg"}`]:r.size}],pcButton:"p-splitbutton-button",pcDropdown:"p-splitbutton-dropdown p-button-icon-only"},Zh=(()=>{class r extends $r{name="splitbutton";theme=Qh;classes=qw;static \u0275fac=(()=>{let e;return function(n){return(e||(e=qt(r)))(n||r)}})();static \u0275prov=Vt({token:r,factory:r.\u0275fac})}return r})();var Qw=(()=>{class r extends Cr{model;severity;raised=!1;rounded=!1;text=!1;outlined=!1;size=null;plain=!1;icon;iconPos="left";label;tooltip;tooltipOptions;styleClass;menuStyle;menuStyleClass;dropdownIcon;appendTo="body";dir;expandAriaLabel;showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)";hideTransitionOptions=".1s linear";buttonProps;menuButtonProps;autofocus;set disabled(e){this._disabled=e,this.buttonDisabled=e,this.menuButtonDisabled=e}get disabled(){return this._disabled}tabindex;menuButtonDisabled=!1;buttonDisabled=!1;onClick=new Ce;onMenuHide=new Ce;onMenuShow=new Ce;onDropdownClick=new Ce;buttonViewChild;menu;contentTemplate;dropdownIconTemplate;templates;ariaId;isExpanded=Nr(!1);_disabled;_componentStyle=ht(Zh);_contentTemplate;_dropdownIconTemplate;ngOnInit(){super.ngOnInit(),this.ariaId=hi("pn_id_")}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this._contentTemplate=e.template;break;case"dropdownicon":this._dropdownIconTemplate=e.template;break;default:this._contentTemplate=e.template;break}})}onDefaultButtonClick(e){this.onClick.emit(e),this.menu.hide()}onDropdownButtonClick(e){this.onDropdownClick.emit(e),this.menu?.toggle({currentTarget:this.el?.nativeElement,relativeAlign:this.appendTo==null})}onDropdownButtonKeydown(e){(e.code==="ArrowDown"||e.code==="ArrowUp")&&(this.onDropdownButtonClick(),e.preventDefault())}onHide(){this.isExpanded.set(!1),this.onMenuHide.emit()}onShow(){this.isExpanded.set(!0),this.onMenuShow.emit()}static \u0275fac=(()=>{let e;return function(n){return(e||(e=qt(r)))(n||r)}})();static \u0275cmp=Me({type:r,selectors:[["p-splitbutton"],["p-splitButton"],["p-split-button"]],contentQueries:function(i,n,s){if(i&1&&($e(s,Bw,4),$e(s,Ww,4),$e(s,wr,4)),i&2){let a;Se(a=Ee())&&(n.contentTemplate=a.first),Se(a=Ee())&&(n.dropdownIconTemplate=a.first),Se(a=Ee())&&(n.templates=a)}},viewQuery:function(i,n){if(i&1&&(et(Hw,5),et($w,5)),i&2){let s;Se(s=Ee())&&(n.buttonViewChild=s.first),Se(s=Ee())&&(n.menu=s.first)}},hostVars:2,hostBindings:function(i,n){i&2&&ve(n.cn(n.cx("root"),n.styleClass))},inputs:{model:"model",severity:"severity",raised:[2,"raised","raised",Le],rounded:[2,"rounded","rounded",Le],text:[2,"text","text",Le],outlined:[2,"outlined","outlined",Le],size:"size",plain:[2,"plain","plain",Le],icon:"icon",iconPos:"iconPos",label:"label",tooltip:"tooltip",tooltipOptions:"tooltipOptions",styleClass:"styleClass",menuStyle:"menuStyle",menuStyleClass:"menuStyleClass",dropdownIcon:"dropdownIcon",appendTo:"appendTo",dir:"dir",expandAriaLabel:"expandAriaLabel",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",buttonProps:"buttonProps",menuButtonProps:"menuButtonProps",autofocus:[2,"autofocus","autofocus",Le],disabled:[2,"disabled","disabled",Le],tabindex:[2,"tabindex","tabindex",lr],menuButtonDisabled:[2,"menuButtonDisabled","menuButtonDisabled",Le],buttonDisabled:[2,"buttonDisabled","buttonDisabled",Le]},outputs:{onClick:"onClick",onMenuHide:"onMenuHide",onMenuShow:"onMenuShow",onDropdownClick:"onDropdownClick"},features:[Ut([Zh]),ar],decls:8,vars:24,consts:[["defaultButton",""],["menu",""],["defaultbtn",""],[4,"ngIf","ngIfElse"],["type","button","pButton","","pRipple","",3,"click","keydown","size","severity","text","outlined","disabled"],[3,"class",4,"ngIf"],[4,"ngIf"],[3,"onHide","onShow","id","popup","model","styleClass","appendTo","showTransitionOptions","hideTransitionOptions"],["type","button","pButton","","pRipple","",3,"click","severity","text","outlined","size","icon","iconPos","disabled","pAutoFocus","pTooltip","tooltipOptions"],[4,"ngTemplateOutlet"],["type","button","pButton","","pRipple","",3,"click","severity","text","outlined","size","icon","iconPos","label","disabled","pAutoFocus","pTooltip","tooltipOptions"],["data-p-icon","chevron-down",4,"ngIf"],["data-p-icon","chevron-down"]],template:function(i,n){if(i&1){let s=Te();ce(0,Uw,3,15,"ng-container",3)(1,zw,2,15,"ng-template",null,0,or),U(3,"button",4),me("click",function(o){return te(s),re(n.onDropdownButtonClick(o))})("keydown",function(o){return te(s),re(n.onDropdownButtonKeydown(o))}),ce(4,Gw,1,2,"span",5)(5,Kw,3,2,"ng-container",6),G(),U(6,"p-tieredmenu",7,1),me("onHide",function(){return te(s),re(n.onHide())})("onShow",function(){return te(s),re(n.onShow())}),G()}if(i&2){let s=_r(2);M("ngIf",n.contentTemplate||n._contentTemplate)("ngIfElse",s),A(3),ve(n.cx("pcDropdown")),M("size",n.size)("severity",n.severity)("text",n.text)("outlined",n.outlined)("disabled",n.menuButtonDisabled),ke("aria-label",(n.menuButtonProps==null?null:n.menuButtonProps.ariaLabel)||n.expandAriaLabel)("aria-haspopup",(n.menuButtonProps==null?null:n.menuButtonProps.ariaHasPopup)||!0)("aria-expanded",(n.menuButtonProps==null?null:n.menuButtonProps.ariaExpanded)||n.isExpanded())("aria-controls",(n.menuButtonProps==null?null:n.menuButtonProps.ariaControls)||n.ariaId),A(),M("ngIf",n.dropdownIcon),A(),M("ngIf",!n.dropdownIcon),A(),It(n.menuStyle),M("id",n.ariaId)("popup",!0)("model",n.model)("styleClass",n.menuStyleClass)("appendTo",n.appendTo)("showTransitionOptions",n.showTransitionOptions)("hideTransitionOptions",n.hideTransitionOptions)}},dependencies:[Ne,Zt,Fr,Wl,qo,Bl,Al,Ji,fi,en,at],encapsulation:2,changeDetection:0})}return r})(),Jh=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=sr({type:r});static \u0275inj=nr({imports:[Qw,at,at]})}return r})();var Zw=()=>({display:"none"});function Jw(r,t){r&1&&xe(0,"i",18)}function e2(r,t){r&1&&xe(0,"i",19)}function t2(r,t){r&1&&xe(0,"div",14)}function r2(r,t){if(r&1){let e=Te();U(0,"div",11),me("click",function(){te(e);let n=I(2);return re(n.testCustomClick("subtle"))}),xe(1,"i",20),Ie(2," Subtle (40%) "),G()}}function i2(r,t){if(r&1){let e=Te();U(0,"div",11),me("click",function(){te(e);let n=I(2);return re(n.testCustomClick("medium"))}),xe(1,"i",20),Ie(2," Medium (25%) "),G()}}function n2(r,t){if(r&1){let e=Te();U(0,"div",11),me("click",function(){te(e);let n=I(2);return re(n.testCustomClick("strong"))}),xe(1,"i",20),Ie(2," Strong (10%) "),G()}}function s2(r,t){if(r&1){let e=Te();U(0,"div",10)(1,"div",11),me("click",function(){te(e);let n=I();return re(n.testCustomClick("excel"))}),ce(2,Jw,1,0,"i",12)(3,e2,1,0,"i",13),Ie(4),G(),xe(5,"div",14),U(6,"div",11),me("click",function(){te(e);let n=I();return re(n.testCustomClick("toggle"))}),xe(7,"i",15),Ie(8),G(),ce(9,t2,1,0,"div",16)(10,r2,3,0,"div",17)(11,i2,3,0,"div",17)(12,n2,3,0,"div",17),G()}if(r&2){let e=I();A(),Oa("loading",e.isExportingExcel),A(),M("ngIf",!e.isExportingExcel),A(),M("ngIf",e.isExportingExcel),A(),Wr(" ",e.isExportingExcel?"Exporting Excel...":"Export to Excel"," "),A(3),Oa("pi-eye-slash",e.isHighlightingEnabled)("pi-eye",!e.isHighlightingEnabled),A(),Wr(" ",e.isHighlightingEnabled?"Disable":"Enable"," Highlighting "),A(),M("ngIf",e.isHighlightingEnabled),A(),M("ngIf",e.isHighlightingEnabled),A(),M("ngIf",e.isHighlightingEnabled),A(),M("ngIf",e.isHighlightingEnabled)}}var KE=(()=>{let t=class t{constructor(){this.title="Dashboard",this.isHighlightingEnabled=!0,this.isExportingExcel=!1,this.onExportToExcel=new Ce,this.onToggleHighlighting=new Ce,this.onSetHighlightingPreset=new Ce,this.menuItems=[],this.showCustomMenu=!1,this.boundExportToExcel=()=>{console.log("Dashboard header: Export to Excel clicked (bound method)"),this.exportToExcel()},this.boundToggleHighlighting=()=>{console.log("Dashboard header: Toggle highlighting clicked (bound method)"),this.toggleHighlighting()},this.boundSetSubtle=()=>{console.log("Dashboard header: Set subtle preset (bound method)"),this.setHighlightingPreset("subtle")},this.boundSetMedium=()=>{console.log("Dashboard header: Set medium preset (bound method)"),this.setHighlightingPreset("medium")},this.boundSetStrong=()=>{console.log("Dashboard header: Set strong preset (bound method)"),this.setHighlightingPreset("strong")}}ngOnChanges(i){(i.isHighlightingEnabled||i.isExportingExcel)&&this.updateMenuItems()}ngOnInit(){this.updateMenuItems()}updateMenuItems(){let i=[];i.push({label:"\u{1F9EA} Simple Test",command:()=>{console.log("SIMPLE TEST CLICKED!"),alert("Simple test works!")}}),i.push({separator:!0}),i.push({label:"Export to Excel",command:()=>{console.log("EXCEL EXPORT CLICKED!"),this.exportToExcel()}}),i.push({separator:!0}),i.push({label:this.isHighlightingEnabled?"Disable Highlighting":"Enable Highlighting",command:()=>{console.log("HIGHLIGHTING TOGGLE CLICKED!"),this.toggleHighlighting()}}),this.isHighlightingEnabled&&(i.push({separator:!0}),i.push({label:"Highlighting Intensity",items:[{label:"Subtle (40%)",command:this.boundSetSubtle},{label:"Medium (25%)",command:this.boundSetMedium},{label:"Strong (10%)",command:this.boundSetStrong}]})),console.log("Menu items updated - highlighting enabled:",this.isHighlightingEnabled),console.log("Menu structure:",i),this.menuItems=i}exportToExcel(){console.log("Dashboard header: Export to Excel clicked"),this.onExportToExcel.emit()}toggleHighlighting(){console.log("Dashboard header: Toggle highlighting clicked"),this.onToggleHighlighting.emit(),setTimeout(()=>{this.updateMenuItems()},100)}setHighlightingPreset(i){console.log("Dashboard header: setHighlightingPreset called with preset:",i),this.onSetHighlightingPreset.emit(i)}onMenuButtonClick(i,n){console.log("Menu button clicked"),n.toggle(i)}onMenuShow(){console.log("Menu shown")}onMenuHide(){console.log("Menu hidden")}testMainAction(){console.log("SPLIT BUTTON MAIN ACTION CLICKED!"),alert("Split button main action works!")}toggleCustomMenu(){console.log("Custom menu toggle clicked"),this.showCustomMenu=!this.showCustomMenu}testCustomClick(i){switch(console.log("CUSTOM MENU ITEM CLICKED:",i),this.showCustomMenu=!1,i){case"test":alert("Custom test menu item works!");break;case"excel":this.exportToExcel();break;case"toggle":this.toggleHighlighting();break;case"subtle":this.setHighlightingPreset("subtle");break;case"medium":this.setHighlightingPreset("medium");break;case"strong":this.setHighlightingPreset("strong");break}}onDocumentClick(i){if(this.showCustomMenu){let n=i.target;n&&!n.closest(".custom-menu-container")&&(this.showCustomMenu=!1)}}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Me({type:t,selectors:[["vis-dashboard-header"]],hostBindings:function(n,s){n&1&&me("click",function(o){return s.onDocumentClick(o)},pl)},inputs:{title:"title",isHighlightingEnabled:"isHighlightingEnabled",isExportingExcel:"isExportingExcel"},outputs:{onExportToExcel:"onExportToExcel",onToggleHighlighting:"onToggleHighlighting",onSetHighlightingPreset:"onSetHighlightingPreset"},features:[Si],decls:11,vars:7,consts:[["menu",""],[1,"dashboard-header"],[1,"dashboard-header-left"],[1,"dashboard-title"],[1,"dashboard-header-right"],[1,"custom-menu-container"],[1,"custom-menu-button",3,"click"],[1,"pi","pi-ellipsis-v"],["class","custom-menu",4,"ngIf"],["appendTo","body",3,"onShow","onHide","model","popup"],[1,"custom-menu"],[1,"custom-menu-item",3,"click"],["class","pi pi-file-excel",4,"ngIf"],["class","pi pi-spin pi-spinner",4,"ngIf"],[1,"custom-menu-separator"],[1,"pi"],["class","custom-menu-separator",4,"ngIf"],["class","custom-menu-item",3,"click",4,"ngIf"],[1,"pi","pi-file-excel"],[1,"pi","pi-spin","pi-spinner"],[1,"pi","pi-circle"]],template:function(n,s){if(n&1){let a=Te();U(0,"div",1)(1,"div",2)(2,"h2",3),Ie(3),G()(),U(4,"div",4)(5,"div",5)(6,"button",6),me("click",function(){return te(a),re(s.toggleCustomMenu())}),xe(7,"i",7),G(),ce(8,s2,13,14,"div",8),G()()(),U(9,"p-menu",9,0),me("onShow",function(){return te(a),re(s.onMenuShow())})("onHide",function(){return te(a),re(s.onMenuHide())}),G()}n&2&&(A(3),je(s.title),A(5),M("ngIf",s.showCustomMenu),A(),It(Hr(6,Zw)),M("model",s.menuItems)("popup",!0))},dependencies:[Ne,Zt,di,Vs,cn,Jh,Gl],styles:[".dashboard-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:2px 16px;margin:4px 0;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border:1px solid #dee2e6;border-radius:8px;box-shadow:0 2px 4px #0000000d;transition:all .3s ease;position:relative;z-index:10}.dashboard-header[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #0000001a;transform:translateY(-1px)}.dashboard-header-left[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center}.dashboard-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#495057;margin:0;padding:0}.dashboard-header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;position:relative}[_nghost-%COMP%]     .p-button.p-button-sm{transition:all .2s ease;font-size:13px;position:relative;z-index:11}[_nghost-%COMP%]     .p-button.p-button-sm:hover{transform:translateY(-1px);box-shadow:0 3px 6px #0000001a}[_nghost-%COMP%]     .p-button.p-button-outlined{background:#ffffffe6}[_nghost-%COMP%]     .p-button.p-button-outlined:hover{background:#fff}[_nghost-%COMP%]     .p-menu{z-index:99999!important;box-shadow:0 8px 16px #0003!important;border:1px solid #ccc!important;background:#fff!important}[_nghost-%COMP%]     .p-menu .p-menuitem{pointer-events:auto!important;cursor:pointer!important;position:relative!important;background:transparent!important}[_nghost-%COMP%]     .p-menu .p-menuitem-link{pointer-events:auto!important;cursor:pointer!important;display:block!important;padding:12px 16px!important;color:#333!important;text-decoration:none!important;width:100%!important;background:transparent!important;border:none!important;outline:none!important}[_nghost-%COMP%]     .p-menu .p-menuitem:hover{background-color:#f0f0f0!important}[_nghost-%COMP%]     .p-menu .p-menuitem-link:hover{background-color:#f0f0f0!important;color:#000!important}[_nghost-%COMP%]     .p-menu .p-menuitem-icon{pointer-events:none!important;margin-right:8px!important}[_nghost-%COMP%]     .p-menu .p-menuitem-text{pointer-events:none!important}[_nghost-%COMP%]     .p-menu .p-separator{pointer-events:none!important;background:#eee!important;height:1px!important;margin:4px 0!important}[_nghost-%COMP%]     .p-menu .p-submenu-list{z-index:100000!important;box-shadow:0 4px 12px #00000026!important;background:#fff!important;border:1px solid #ccc!important}@media (max-width: 768px){.dashboard-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.dashboard-header-left[_ngcontent-%COMP%]{text-align:center}.dashboard-title[_ngcontent-%COMP%]{font-size:1.1rem}.dashboard-header-right[_ngcontent-%COMP%]{justify-content:center}}.custom-menu-container[_ngcontent-%COMP%]{position:relative;display:inline-block}.custom-menu-button[_ngcontent-%COMP%]{background:#ffffffe6;border:1px solid #ccc;border-radius:4px;padding:8px 12px;cursor:pointer;font-size:14px;transition:all .2s ease}.custom-menu-button[_ngcontent-%COMP%]:hover{background:#fff;transform:translateY(-1px);box-shadow:0 3px 6px #0000001a}.custom-menu[_ngcontent-%COMP%]{position:absolute;right:0;top:100%;margin-top:4px;background:#fff;border:1px solid #ccc;border-radius:4px;box-shadow:0 8px 16px #0003;z-index:99999;min-width:200px;overflow:hidden}.custom-menu-item[_ngcontent-%COMP%]{padding:12px 16px;cursor:pointer;color:#333;background:#fff;border:none;width:100%;text-align:left;font-size:14px;transition:background-color .2s ease;display:flex;align-items:center;gap:8px}.custom-menu-item[_ngcontent-%COMP%]:hover{background-color:#f0f0f0;color:#000}.custom-menu-item.loading[_ngcontent-%COMP%]{opacity:.7;cursor:wait}.custom-menu-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:16px;font-size:14px}.custom-menu-item[_ngcontent-%COMP%]   i.pi-spin[_ngcontent-%COMP%]{animation:spin 1s linear infinite}.custom-menu-separator[_ngcontent-%COMP%]{height:1px;background:#eee;margin:4px 0}"]});let r=t;return r})();var a2=["dashboardContainer"],o2=(()=>{let t=class t{constructor(i,n,s){this.cdr=i,this.excelExportService=n,this.filterService=s,this.isExportingExcel=!1,this.isUpdatingFilters=!1,this.isHighlightingEnabled=!0,this.highlightingOpacity=.25}ngOnInit(){this.initializeDashboardConfig(),this.filterSubscription=this.filterService.filterValues$.subscribe(i=>{this.updateWidgetsWithFilters(i)}),this.onChildInit()}onFilterValuesChanged(i){this.isUpdatingFilters||(this.isUpdatingFilters=!0,this.filterService.setFilterValues(i),this.isUpdatingFilters=!1)}updateWidgetsWithFilters(i){if(this.isUpdatingFilters)return;let n=i||this.filterService.getFilterValues();this.applyFiltersToDashboardData(n),this.dashboardConfig.widgets.filter(a=>a.config?.component==="echart").forEach(a=>{this.updateWidgetWithFilters(a,n)}),this.updateMetricTilesWithFilters(n),setTimeout(()=>{this.cdr.detectChanges(),setTimeout(()=>{this.cdr.detectChanges()},100)},50)}updateMetricTilesWithFilters(i){let n=this.dashboardConfig.widgets.filter(a=>a.config?.component==="tile"),s=this.createMetricTiles(this.dashboardData);n.forEach((a,o)=>{if(o<s.length){let c=s[o];a.config?.options?.updateOnDataChange!==!1&&a.config?.options&&Object.assign(a.config.options,c.config?.options)}})}applyFiltersToDashboardData(i){if(i.length===0){this.dashboardData=[...this.initialDashboardData];return}this.dashboardConfig?.filterVisualization?.enableHighlighting?this.dashboardData=[...this.initialDashboardData]:this.dashboardData=this.applyFiltersToFlatData(this.initialDashboardData,i)}applyFiltersToFlatData(i,n){return!n||n.length===0?i:i.filter(s=>n.every(a=>this.matchesFlatDataFilter(s,a)))}matchesFlatDataFilter(i,n){let s=i,a=n.value||n[n.accessor];if(n.accessor&&s.hasOwnProperty(n.accessor))return s[n.accessor]===a;let o=["category","month","type","name"];for(let c of o)if(s.hasOwnProperty(c)&&s[c]===a)return!0;return Object.values(s).includes(a)}getFilteredDataForWidgetFromOriginalData(i,n){let s=this.applyFiltersToFlatData(this.initialDashboardData,n);return this.getFilteredDataForWidget(i,s)}groupByAndSum(i,n,s){let a=i.reduce((o,c)=>{let l=c,h=l[n];o[h]||(o[h]=0);let f=Number(l[s])||0;return o[h]+=f,o},{});return Object.entries(a).map(([o,c])=>({name:o,value:c}))}groupByAndCount(i,n){let s=i.reduce((a,o)=>{let l=o[n];return a[l]||(a[l]=0),a[l]++,a},{});return Object.entries(s).map(([a,o])=>({name:a,value:o}))}groupByAndAverage(i,n,s){let a=i.reduce((o,c)=>{let l=c,h=l[n];o[h]||(o[h]={sum:0,count:0});let f=Number(l[s])||0;return o[h].sum+=f,o[h].count++,o},{});return Object.entries(a).map(([o,{sum:c,count:l}])=>({name:o,value:l>0?c/l:0}))}filterByFieldValues(i,n,s){return i.filter(a=>{let o=a;return s.includes(o[n])})}getUniqueFieldValues(i,n){let s=i.map(a=>a[n]);return[...new Set(s)]}sortByField(i,n,s=!0){return[...i].sort((a,o)=>{let c=a[n],l=o[n];return c<l?s?-1:1:c>l?s?1:-1:0})}aggregateByFields(i,n,s){let a=i.reduce((o,c)=>{let l=c,h=n.map(f=>l[f]).join("|");return o[h]||(o[h]={groupKey:h,groupValues:n.reduce((f,u)=>(f[u]=l[u],f),{}),aggregations:s.reduce((f,u)=>(f[u.field]={operation:u.operation,values:[]},f),{})}),s.forEach(f=>{let u=Number(l[f.field])||0;o[h].aggregations[f.field].values.push(u)}),o},{});return Object.values(a).map(o=>{let c=k({},o.groupValues);return Object.entries(o.aggregations).forEach(([l,h])=>{let f=h.values;switch(h.operation){case"sum":c[`${l}_sum`]=f.reduce((u,d)=>u+d,0);break;case"count":c[`${l}_count`]=f.length;break;case"avg":c[`${l}_avg`]=f.length>0?f.reduce((u,d)=>u+d,0)/f.length:0;break;case"min":c[`${l}_min`]=Math.min(...f);break;case"max":c[`${l}_max`]=Math.max(...f);break}}),c})}createHeatmapData(i,n="x",s="y",a="value"){return[]}createMultiSeriesData(i,n="category",s="x",a="y"){return[]}updateWidgetWithFilters(i,n){if(!i.config||!i.config.component)return;let s=i.config?.header?.title,a=n.some(h=>{let f=h.widgetId===i.id,u=h.widgetTitle===s;return f||u}),o=this.dashboardConfig?.filterVisualization?.enableHighlighting,c=null;if(s&&(o&&!a&&n.length>0?c=this.getFilteredDataForWidgetFromOriginalData(s,n):c=this.getFilteredDataForWidget(s)),c||(c=this.getDataByChartType(i)),!c)return;let l=c;if(o&&n.length>0&&a){let h=i.config?.options,f="other";h?.series?.[0]?.type&&(f=h.series[0].type);let u={filteredOpacity:this.dashboardConfig.filterVisualization?.defaultFilteredOpacity||.25,highlightedOpacity:this.dashboardConfig.filterVisualization?.defaultHighlightedOpacity||1,highlightColor:this.dashboardConfig.filterVisualization?.defaultHighlightColor||"#ff6b6b",filteredColor:this.dashboardConfig.filterVisualization?.defaultFilteredColor||"#e0e0e0"};l=this.filterService.applyHighlightingToEChartsData(c,n,f,u)}else n.length>0&&(Array.isArray(c)?(l=this.filterService.applyFiltersToData(c,n),l.length===0&&(l=[{name:"No data matches filter",value:0,itemStyle:{color:"#cccccc"}}])):l=c);i.config.component==="echart"&&this.updateEchartWidget(i,l)}updateEchartWidget(i,n){if(!i.config?.options)return;let s=i.config?.header?.title,a=k({},i.config.options);if(a.series&&a.series.length>0){let o=a.series[0];n&&n.length>0&&(o.data=n,a.xAxis&&a.xAxis[0]&&a.xAxis[0].data&&(a.xAxis[0].data=n.map(c=>c.name)))}i.config.options=a,this.scheduleWidgetUpdate(i)}scheduleWidgetUpdate(i){this.widgetUpdateTimeout&&clearTimeout(this.widgetUpdateTimeout),this.widgetUpdateTimeout=setTimeout(()=>{this.retryWidgetUpdate(i,0)},50)}retryWidgetUpdate(i,n){let o=i.config?.header?.title||i.id;if(!(n>=5))try{this.cdr.detectChanges(),setTimeout(()=>{this.cdr.detectChanges()},50)}catch{let l=100*Math.pow(2,n);setTimeout(()=>{this.retryWidgetUpdate(i,n+1)},l)}}getScatterChartData(i){return[]}getGaugeChartData(i){return[{name:"Progress",value:50}]}exportDashboardToExcel(){return kt(this,null,function*(){this.isExportingExcel=!0,this.cdr.detectChanges();try{yield new Promise(i=>setTimeout(i,50)),yield new Promise((i,n)=>{setTimeout(()=>kt(this,null,function*(){try{yield this.excelExportService.exportDashboardToExcel(this.dashboardConfig.widgets,{filename:`financial-dashboard-data-${new Date().toISOString().split("T")[0]}.xlsx`,includeHeaders:!0,includeTimestamp:!0,sheetNamePrefix:"Widget",autoColumnWidth:!0,includeWidgetTitles:!0}),i()}catch(s){console.error("Excel export failed:",s),n(s)}}),100)})}catch(i){console.error("Excel export error:",i)}finally{this.isExportingExcel=!1,this.cdr.detectChanges()}})}updateAllCharts(){return kt(this,null,function*(){try{let i=yield this.getUpdatedChartData();this.dashboardConfig.widgets.forEach((n,s)=>{if(n.config?.component==="echart"&&i[s]&&n.config?.options){let a=n.config.options;a.series&&a.series.forEach((o,c)=>{i[s][c]&&(o.data=i[s][c])})}})}catch{}})}getUpdatedChartData(){return kt(this,null,function*(){return yield new Promise(i=>setTimeout(i,1e3)),[{name:"Updated Data 1",value:Math.random()*100},{name:"Updated Data 2",value:Math.random()*100},{name:"Updated Data 3",value:Math.random()*100}]})}clearAllFilters(){this.isUpdatingFilters=!0;try{this.filterService.clearAllFilters()}finally{this.isUpdatingFilters=!1}}getCurrentFilters(){return this.filterService.getFilterValues()}toggleHighlightingMode(){this.isHighlightingEnabled=!this.isHighlightingEnabled,this.updateDashboardHighlightingConfig();let i=this.getCurrentFilters();this.updateWidgetsWithFilters(i),this.cdr.detectChanges()}updateHighlightingOpacity(i){this.highlightingOpacity=Math.max(.1,Math.min(1,i)),this.updateDashboardHighlightingConfig();let n=this.getCurrentFilters();this.updateWidgetsWithFilters(n),this.cdr.detectChanges()}updateDashboardHighlightingConfig(){this.dashboardConfig?.filterVisualization&&(this.dashboardConfig.filterVisualization.enableHighlighting=this.isHighlightingEnabled,this.dashboardConfig.filterVisualization.defaultFilteredOpacity=this.highlightingOpacity)}getHighlightingStatusMessage(){return this.isHighlightingEnabled?`Highlighting Mode: ON - Source widgets highlighted (${Math.round(this.highlightingOpacity*100)}% opacity), others filtered`:"Highlighting Mode: OFF - All widgets use traditional filtering"}setHighlightingPreset(i){let n;switch(i){case"subtle":n=.4;break;case"medium":n=.25;break;case"strong":n=.1;break}this.updateHighlightingOpacity(n)}populateWidgetsWithInitialData(){if(!this.dashboardConfig?.widgets)return;this.dashboardConfig.widgets.filter(n=>n.config?.component==="echart").forEach(n=>{let s=n.config?.header?.title,a=null;s&&(a=this.getFilteredDataForWidget(s)),a||(a=this.getDataByChartType(n)),a&&this.updateEchartWidget(n,a)}),this.updateMetricTilesWithFilters([]),setTimeout(()=>{this.cdr.detectChanges()},100)}ngOnDestroy(){this.widgetUpdateTimeout&&clearTimeout(this.widgetUpdateTimeout),this.filterSubscription&&this.filterSubscription.unsubscribe(),this.onChildDestroy()}};t.\u0275fac=function(n){return new(n||t)(Ke(qi),Ke(ya),Ke(ef))},t.\u0275dir=Nn({type:t,viewQuery:function(n,s){if(n&1&&(et(a2,5),et(Yo,5)),n&2){let a;Se(a=Ee())&&(s.dashboardContainer=a.first),Se(a=Ee())&&(s.dashboardContainerComponent=a.first)}}});let r=t;return r})();var ef=(()=>{let t=class t{constructor(){this.filterValuesSubject=new ka([]),this.filterEventsSubject=new ka([]),this.isUpdating=!1,this.filterValues$=this.filterValuesSubject.asObservable(),this.filterEvents$=this.filterEventsSubject.asObservable()}getFilterValues(){return this.filterValuesSubject.value}getFilterEvents(){return this.filterEventsSubject.value}addFilterValue(i,n,s){if(this.isUpdating)return;let a=this.createFilterValueFromClickData(s);if(a){a.widgetId=i,a.widgetTitle=n;let o=this.filterValuesSubject.value;if(o.some(d=>this.isSameFilter(d,a)))return;let l=[...o,a];this.debouncedUpdate(l);let h={widgetId:i,widgetTitle:n,filterValue:a,timestamp:new Date},u=[...this.filterEventsSubject.value,h];this.filterEventsSubject.next(u)}}removeFilterValue(i){if(this.isUpdating)return;let s=this.filterValuesSubject.value.filter(a=>!this.isSameFilter(a,i));this.debouncedUpdate(s)}clearAllFilters(){if(!this.isUpdating){this.isUpdating=!0;try{this.filterValuesSubject.next([]),this.filterEventsSubject.next([])}finally{this.isUpdating=!1}}}setFilterValues(i){this.isUpdating||this.debouncedUpdate(i)}debouncedUpdate(i){this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>{this.isUpdating=!0;try{this.filterValuesSubject.next(i)}finally{this.isUpdating=!1}},50)}getFiltersForWidget(i){return this.filterValuesSubject.value.filter(n=>n.widgetId===i)}getFiltersByAccessor(i){return this.filterValuesSubject.value.filter(n=>n.accessor===i||n.filterColumn===i)}hasActiveFilters(i){return this.getFiltersForWidget(i).length>0}createFilterValueFromClickData(i){if(!i||typeof i!="object")return null;let n={accessor:"unknown"};if(i.name)n={accessor:"category",category:i.name,value:i.value||i.name};else if(i.seriesName)n={accessor:"series",series:i.seriesName,value:i.value||i.seriesName};else if(i.value&&Array.isArray(i.value))n={accessor:"coordinates",x:i.value[0]?.toString(),y:i.value[1]?.toString(),value:`(${i.value[0]}, ${i.value[1]})`};else{let s=Object.keys(i);if(s.length>0){let a=s[0];n={accessor:a,[a]:i[a],value:i[a]?.toString()}}}return n.accessor!=="unknown"?n:null}isSameFilter(i,n){return JSON.stringify(i)===JSON.stringify(n)}applyFiltersToData(i,n){if(!Array.isArray(i))return console.warn("FilterService.applyFiltersToData: data is not an array, returning as-is",i),i;if(!n||n.length===0)return i;let s=n.filter(o=>{if(o.accessor==="category")return i.some(l=>l.name===o.category||l.category===o.category);let c=o.filterColumn||o.accessor;return i.some(l=>l.hasOwnProperty(c))});return s.length===0?i:i.filter(o=>s.every(c=>this.matchesFilter(o,c)))}matchesFilter(i,n){let s=n.filterColumn||n.accessor,a=!1;switch(n.accessor){case"category":a=i.name===n.category||i.category===n.category;break;case"series":a=i.seriesName===n.series||i.series===n.series;break;case"coordinates":a=i.value&&Array.isArray(i.value)&&i.value[0]?.toString()===n.x&&i.value[1]?.toString()===n.y;break;default:let o=n.filterColumn||n.accessor;a=i[o]===n[n.accessor]||i[o]?.toString()===n.value;break}return a}applyHighlightingFiltersToData(i,n,s){if(!n||n.length===0)return i.map(c=>j(k({},c),{_filterState:"normal"}));let o=k(k({},{filteredOpacity:.3,highlightedOpacity:1,highlightColor:void 0,filteredColor:"#cccccc"}),s);return i.map(c=>n.some(h=>this.matchesFilter(c,h))?j(k({},c),{_filterState:"highlighted",_visualOptions:{opacity:o.highlightedOpacity,color:o.highlightColor}}):j(k({},c),{_filterState:"filtered",_visualOptions:{opacity:o.filteredOpacity,color:o.filteredColor}}))}applyHighlightingToEChartsData(i,n,s="other",a){if(!n||n.length===0)return i;let c=k(k({},{filteredOpacity:.3,highlightedOpacity:1,highlightColor:void 0,filteredColor:"#cccccc"}),a);return s==="pie"?i.map((l,h)=>n.some(u=>this.matchesPieSliceFilter(l,u))?j(k({},l),{itemStyle:j(k({},l.itemStyle),{opacity:c.highlightedOpacity,borderWidth:3,borderColor:c.highlightColor||"#ff6b6b"})}):j(k({},l),{itemStyle:j(k({},l.itemStyle),{opacity:c.filteredOpacity,color:c.filteredColor})})):s==="bar"?i.map(l=>n.some(f=>this.matchesBarDataFilter(l,f))?j(k({},l),{itemStyle:j(k({},l.itemStyle),{opacity:c.highlightedOpacity,borderWidth:2,borderColor:c.highlightColor||"#ff6b6b"})}):j(k({},l),{itemStyle:j(k({},l.itemStyle),{opacity:c.filteredOpacity,color:c.filteredColor})})):i}matchesPieSliceFilter(i,n){if(!i||!n)return!1;if(i.name&&n.value){let s=i.name.toString().toLowerCase(),a=n.value.toString().toLowerCase();if(s===a)return!0}if(i.name&&n.category){let s=i.name.toString().toLowerCase(),a=n.category.toString().toLowerCase();if(s===a)return!0}return!1}matchesBarDataFilter(i,n){return!i||!n?!1:i.name&&n.category?i.name.toString().toLowerCase()===n.category.toString().toLowerCase():i.name&&n.value?i.name.toString().toLowerCase()===n.value.toString().toLowerCase():!1}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();var tf=class r{constructor(){this.widgetBuilder=new Jt().setId(tn()).setComponent("tile"),this.tileOptions=this.getDefaultTileOptions(),this.styleOptions=this.getDefaultStyleOptions(),this.layoutOptions=this.getDefaultLayoutOptions(),this.customData={}}static create(){return new r}static createFromData(t){return new r().setData(t).setValue(t.value).setChange(t.change||"").setChangeType(t.changeType||"neutral").setDescription(t.description||"").setIcon(t.icon||"fas fa-chart-bar").setColor(t.color||"#6b7280").setBackgroundColor(t.backgroundColor||"").setHeader(t.title||"").setSubHeader(t.subtitle||"")}getDefaultTileOptions(){return{value:"",change:"",changeType:"neutral",icon:"fas fa-chart-bar",color:"#6b7280",description:"",updateOnDataChange:!0}}getDefaultStyleOptions(){return{color:"#6b7280",backgroundColor:"",borderColor:"",borderWidth:0,borderRadius:8,padding:"1.5rem",margin:"0",fontSize:"1rem",fontWeight:"normal",textAlign:"left",iconSize:"2rem",iconColor:"inherit",backgroundOpacity:1}}getDefaultLayoutOptions(){return{width:"100%",height:"100%",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",gap:"1rem"}}setData(t){return this.customData=k(k({},this.customData),t),this.widgetBuilder.setData(this.customData),this}setValue(t){let e=String(t);return this.tileOptions.value=e,this.customData.value=e,this}setChange(t){return this.tileOptions.change=t,this.customData.change=t,this}setChangeType(t){return this.tileOptions.changeType=t,this.customData.changeType=t,this}setDescription(t){return this.tileOptions.description=t,this.customData.description=t,this}setHeader(t,e){return this.widgetBuilder.setHeader(t,e),this.customData.title=t,this}setSubHeader(t){return this.customData.subtitle=t,this}setHeaders(t,e,i){return this.setHeader(t,i),e&&this.setSubHeader(e),this}setColor(t){return this.tileOptions.color=t,this.styleOptions.color=t,this}setBackgroundColor(t){return this.styleOptions.backgroundColor=t,this.customData.backgroundColor=t,this}setBackgroundOpacity(t){return this.styleOptions.backgroundOpacity=t,this.customData.backgroundOpacity=t,this}setUpdateOnDataChange(t){return this.tileOptions.updateOnDataChange=t,this.customData.updateOnDataChange=t,this}setIcon(t){return this.tileOptions.icon=t,this.customData.icon=t,this}setIconSize(t){return this.styleOptions.iconSize=t,this}setIconColor(t){return this.styleOptions.iconColor=t,this}setBorder(t,e=1,i=8){return this.styleOptions.borderColor=t,this.styleOptions.borderWidth=e,this.styleOptions.borderRadius=i,this}setPadding(t){return this.styleOptions.padding=t,this}setMargin(t){return this.styleOptions.margin=t,this}setFont(t,e="normal"){return this.styleOptions.fontSize=t,this.styleOptions.fontWeight=e,this}setTextAlign(t){return this.styleOptions.textAlign=t,this}setStyle(t){return this.styleOptions=k(k({},this.styleOptions),t),this}setPosition(t){return this.widgetBuilder.setPosition(t),this}setSize(t,e){return this.layoutOptions.width=t,this.layoutOptions.height=e,this}setMinSize(t,e){return this.layoutOptions.minWidth=t,this.layoutOptions.minHeight=e,this}setMaxSize(t,e){return this.layoutOptions.maxWidth=t,this.layoutOptions.maxHeight=e,this}setFlexDirection(t){return this.layoutOptions.flexDirection=t,this}setJustifyContent(t){return this.layoutOptions.justifyContent=t,this}setAlignItems(t){return this.layoutOptions.alignItems=t,this}setGap(t){return this.layoutOptions.gap=t,this}setLayout(t){return this.layoutOptions=k(k({},this.layoutOptions),t),this}setAccessor(t){return this.tileOptions.accessor=t,this}setTileOptions(t){return this.tileOptions=k(k({},this.tileOptions),t),this}setEvents(t){return t&&this.widgetBuilder.setEvents(t),this}setInitialState(t){return this.widgetBuilder.setInitialState(t),this}setState(t){return this.widgetBuilder.setState(t),this}setProperty(t,e){return this.customData[t]=e,this}setProperties(t){return this.customData=k(k({},this.customData),t),this}build(){let t=j(k(k({},this.tileOptions),this.customData),{style:this.styleOptions,layout:this.layoutOptions});return this.widgetBuilder.setTileOptions(t),this.widgetBuilder.build()}getTileOptions(){return k({},this.tileOptions)}getStyleOptions(){return k({},this.styleOptions)}getLayoutOptions(){return k({},this.layoutOptions)}getCustomData(){return k({},this.customData)}getWidgetBuilder(){return this.widgetBuilder}static updateData(t,e){if(r.isTileWidget(t)){let i=t.config?.options;i&&(Object.assign(i,e),t.data=k(k({},t.data),e))}}static isTileWidget(t){return t.config?.component==="tile"}static createTileWidget(t){let e=new Jt().setId(tn()).setComponent("tile");if(t){let i=k({change:t.change||"",changeType:t.changeType||"neutral",icon:t.icon||"fas fa-chart-bar",color:t.color||"#6b7280",description:t.description||"",title:t.title||"",subtitle:t.subtitle||"",backgroundColor:t.backgroundColor||""},t);e.setTileOptions(i)}else e.setTileOptions({value:"",change:"",changeType:"neutral",icon:"fas fa-chart-bar",color:"#6b7280",description:""});return e}static exportData(t){if(!r.isTileWidget(t))return[];let e=t.config?.options;return e?[[e.title||t.config?.header?.title||"Metric",e.value||"",e.change||"",e.changeType||"neutral",e.description||"",e.subtitle||""]]:[]}static getExportHeaders(t){return["Title","Value","Change","Change Type","Description","Subtitle"]}static getExportSheetName(t){return`Tile_${(t.config?.header?.title||"Tile").replace(/[^a-zA-Z0-9]/g,"_")}`}static createMetricTile(t,e,i,n="fas fa-chart-line",s="#10b981"){return r.create().setValue(t).setChange(e).setChangeType("positive").setDescription(i).setIcon(n).setColor(s)}static createWarningTile(t,e,i,n="fas fa-exclamation-triangle",s="#ef4444"){return r.create().setValue(t).setChange(e).setChangeType("negative").setDescription(i).setIcon(n).setColor(s)}static createNeutralTile(t,e,i="fas fa-chart-bar",n="#6b7280"){return r.create().setValue(t).setChange("0%").setChangeType("neutral").setDescription(e).setIcon(i).setColor(n)}static createFinancialTile(t,e,i,n="$",s="fas fa-dollar-sign"){let a=`${n}${t.toLocaleString()}`,o=e>0?"positive":e<0?"negative":"neutral",c=`${e>0?"+":""}${e.toFixed(1)}%`,l=e>0?"#10b981":e<0?"#ef4444":"#6b7280";return r.create().setValue(a).setChange(c).setChangeType(o).setDescription(i).setIcon(s).setColor(l)}static createPercentageTile(t,e,i="fas fa-percentage",n="#3b82f6"){let s=t>0?"positive":t<0?"negative":"neutral",a=`${t>0?"+":""}${t.toFixed(1)}%`,o=t>0?"#10b981":t<0?"#ef4444":n;return r.create().setValue(`${t.toFixed(1)}%`).setChange(a).setChangeType(s).setDescription(e).setIcon(i).setColor(o)}static createInfoTile(t,e,i,n="fas fa-info-circle",s="#3b82f6"){return r.create().setValue(e).setDescription(i).setIcon(n).setColor(s)}static createStatusTile(t,e,i=!0,n="fas fa-circle",s="#10b981"){let a=i?s:"#6b7280",o=i?n:"fas fa-circle";return r.create().setValue(e).setDescription(t).setIcon(o).setColor(a).setChangeType(i?"positive":"neutral")}};var Dn=class r extends ye{constructor(){super(),this.xAxisData=[],this.seriesOptions=this.getDefaultSeriesOptions()}static create(){return new r}getDefaultOptions(){return{grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}}}}getChartType(){return"line"}getDefaultSeriesOptions(){return{name:"Area Chart",type:"line",smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.3,origin:"auto"},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}}setData(t){return this.seriesOptions.data=t,super.setData(t),this}setXAxisData(t){return this.xAxisData=t,this.chartOptions.xAxis.data=t,this}setXAxisName(t){return this.chartOptions.xAxis.name=t,this}setYAxisName(t){return this.chartOptions.yAxis.name=t,this}setSmooth(t){return this.seriesOptions.smooth=t,this}setSymbol(t,e=6){return this.seriesOptions.symbol=t,this.seriesOptions.symbolSize=e,this}setLineStyle(t,e,i="solid"){return this.seriesOptions.lineStyle={width:t,color:e,type:i},this}setItemStyle(t,e,i){return this.seriesOptions.itemStyle={color:t,borderColor:e,borderWidth:i},this}setAreaStyle(t,e=.3){return this.seriesOptions.areaStyle={color:t,opacity:e,origin:"auto"},this}setGradientAreaStyle(t,e,i=.3){return this.seriesOptions.areaStyle={color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:t},{offset:1,color:e}]},opacity:i,origin:"auto"},this}setShowSymbol(t){return this.seriesOptions.showSymbol=t,this}setStack(t){return this.seriesOptions.stack=t,this}setSampling(t){return this.seriesOptions.sampling=t,this}build(){return this.chartOptions.series=[this.seriesOptions],this.widgetBuilder.setEChartsOptions(this.chartOptions),this.widgetBuilder.build()}static updateData(t,e,i){if(r.isAreaChart(t)){let n=t.config?.options;n?.series&&n.series.length>0&&(n.series[0].data=e)}ye.updateData(t,e,i)}static transformToAreaData(t,e){if(!t||t.length===0)return{data:[]};let i=e?.valueField||"value",n=e?.nameField||"name",s=e?.xAxisField||n;if(e?.multiSeries){let o=e.seriesNameField||"series",c=new Map;t.forEach(h=>{let f=h[o]||"Series 1";c.has(f)||c.set(f,[]),c.get(f).push({name:String(h[n])||"Unknown",value:Number(h[i])||0})});let l=Array.from(c.values())[0]||[];return{data:l,xAxisData:l.map(h=>h.name)}}return{data:t.map(o=>({name:String(o[n])||"Unknown",value:Number(o[i])||0})),xAxisData:t.map(o=>String(o[s])||"Unknown")}}setFinancialTrend(t="USD",e="en-US"){return this.setCurrencyFormatter(t,e),this.setSmooth(!0).setSymbol("circle",6).setLineStyle(3,"#5470c6","solid").setGradientAreaStyle("#5470c6","#91cc75",.4)}setPerformanceMonitoring(){return this.setSmooth(!0).setSampling("average").setShowSymbol(!1).setLineStyle(1,"#ff6b6b","solid").setGradientAreaStyle("#ff6b6b","#4ecdc4",.3)}static addRandomVariation(t,e=25){return t.map(i=>j(k({},i),{value:Math.max(0,i.value+(Math.random()-.5)*2*(i.value*e/100))}))}static isAreaChart(t){let e=t.config?.options;return e?.series?.[0]?.type==="line"&&e?.series?.[0]?.areaStyle}static createAreaChartWidget(t,e){return new Jt().setComponent("echart").setEChartsOptions({grid:{containLabel:!0,top:"15%",left:"10%",right:"10%",bottom:"15%"},tooltip:{trigger:"axis",formatter:"{b}: {c}"},legend:{show:!0,orient:"horizontal",left:"center",bottom:"10"},xAxis:{type:"category",data:e||[],nameLocation:"middle",axisLabel:{rotate:0,color:"#666"}},yAxis:{type:"value",nameLocation:"middle",axisLabel:{color:"#666"}},series:[{name:"Area Chart",type:"line",data:t||[],smooth:!1,symbol:"circle",symbolSize:6,showSymbol:!0,lineStyle:{width:2,color:"#5470c6",type:"solid"},itemStyle:{color:"#5470c6"},areaStyle:{color:"#5470c6",opacity:.3,origin:"auto"},emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}static exportData(t){if(!r.isAreaChart(t))return[];let e=t.config?.options,i=e?.series,n=e?.xAxis;if(!i||i.length===0)return[];let s=[];n&&(Array.isArray(n)?s=n[0]?.data||[]:n.data&&(s=n.data)),s.length===0&&i[0]?.data&&(s=i[0].data.map((o,c)=>`Point ${c+1}`));let a=[];return i.forEach((o,c)=>{o.data&&o.data.forEach((l,h)=>{c===0&&(a[h]=[s[h]||`Point ${h+1}`]),a[h]&&a[h].push(l||0)})}),a}static getExportHeaders(t){let i=t.config?.options?.series;return!i||i.length===0?["Category"]:["Category",...i.map(n=>n.name||"Series")]}static getExportSheetName(t){return`AreaChart_${(t.config?.header?.title||"Area Chart").replace(/[^a-zA-Z0-9]/g,"_")}`}};export{Jt as a,ye as b,rn as c,nn as d,sn as e,an as f,on as g,ln as h,Dn as i,kn as j,Fn as k,On as l,An as m,jh as n,ya as o,oi as p,Yo as q,KE as r,o2 as s,ef as t,tf as u};
