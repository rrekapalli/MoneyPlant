<div class="gridster-container" (scroll)="onDashboardScroll($event)">
  <gridster class="mt-2 dashboard-gridster" [options]="options">
    <div id="dashboard" class="print-body" [style.height.px]="totalDashboardHeight * 50">
      @for (item of visibleWidgets; track item.id; let i = $index) {

        <gridster-item 
            [item]="item.position" 
            (itemResize)="updateString('[Edit Mode - Pending Changes]')"
            (itemChange)="updateString('[Edit Mode - Pending Changes]')">

            @if (item.config.header) {
              <vis-widget-header 
                  [dashboardId]="dashboardId" 
                  [widget]="item" 
                  (onUpdateWidget)="onUpdateWidget($event)"
                  (onDeleteWidget)="onDeleteWidget($event)" 
                  [onEditMode]="isEditMode"/>
            }

            <vis-widget 
                [widget]="item" 
                (onDataLoad)="onDataLoad($event)" 
                (onUpdateFilter)="onUpdateFilter($event)"/>

        </gridster-item>

      }
    </div>
  </gridster>
</div>

<!-- Virtual Scrolling Status -->
<div class="virtual-scroll-status" *ngIf="widgets.length > visibleWidgets.length">
  Showing {{ visibleWidgets.length }} of {{ widgets.length }} widgets
</div>

<!-- Toast Message -->
<p-toast position="bottom-right" key="br" />
